!function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=4)}([function(e,t){e.exports=jQuery},function(e,t){e.exports=sourceMappedStackTrace},,,function(e,t,n){"use strict";n.r(t),n.d(t,"scout",(function(){return O})),n.d(t,"App",(function(){return E})),n.d(t,"ErrorHandler",(function(){return H})),n.d(t,"RemoteApp",(function(){return q})),n.d(t,"Extension",(function(){return X})),n.d(t,"TypeDescriptor",(function(){return Z})),n.d(t,"ObjectFactory",(function(){return te})),n.d(t,"LoadingSupport",(function(){return oe})),n.d(t,"SimpleLoadingSupport",(function(){return fe})),n.d(t,"ModelAdapter",(function(){return de})),n.d(t,"Widget",(function(){return ve})),n.d(t,"widgets",(function(){return me})),n.d(t,"Composite",(function(){return Ce})),n.d(t,"NullWidget",(function(){return Fe})),n.d(t,"NullWidgetAdapter",(function(){return Le})),n.d(t,"arrays",(function(){return rt})),n.d(t,"Call",(function(){return at})),n.d(t,"clipboard",(function(){return ct})),n.d(t,"colorSchemes",(function(){return dt})),n.d(t,"EventDelegator",(function(){return vt})),n.d(t,"dates",(function(){return Et})),n.d(t,"defaultValues",(function(){return Mt})),n.d(t,"events",(function(){return Nt})),n.d(t,"files",(function(){return Wt})),n.d(t,"Device",(function(){return Kt})),n.d(t,"DoubleClickSupport",(function(){return Yt})),n.d(t,"DragAndDropHandler",(function(){return Zt})),n.d(t,"dragAndDrop",(function(){return rn})),n.d(t,"Event",(function(){return sn})),n.d(t,"EventSupport",(function(){return ln})),n.d(t,"fonts",(function(){return vn})),n.d(t,"icons",(function(){return gn})),n.d(t,"inspector",(function(){return _n})),n.d(t,"locales",(function(){return En})),n.d(t,"logging",(function(){return Xn})),n.d(t,"NullLogger",(function(){return Zn})),n.d(t,"mimeTypes",(function(){return sr})),n.d(t,"models",(function(){return ur})),n.d(t,"numbers",(function(){return pr})),n.d(t,"RoundingMode",(function(){return dr})),n.d(t,"objects",(function(){return Pr})),n.d(t,"polyfills",(function(){return Rr})),n.d(t,"PromiseCreator",(function(){return Er})),n.d(t,"promises",(function(){return Dr})),n.d(t,"Range",(function(){return Fr})),n.d(t,"Status",(function(){return Br})),n.d(t,"DefaultStatus",(function(){return Wr})),n.d(t,"ParsingFailedStatus",(function(){return Xr})),n.d(t,"ValidationFailedStatus",(function(){return no})),n.d(t,"CachedElement",(function(){return oo})),n.d(t,"PlainTextEncoder",(function(){return so})),n.d(t,"HtmlEncoder",(function(){return lo})),n.d(t,"strings",(function(){return Wn})),n.d(t,"styles",(function(){return To})),n.d(t,"TreeSet",(function(){return Po})),n.d(t,"URL",(function(){return xo})),n.d(t,"filters",(function(){return Eo})),n.d(t,"HAlign",(function(){return Do})),n.d(t,"aggregation",(function(){return jo})),n.d(t,"webstorage",(function(){return Ho})),n.d(t,"cookies",(function(){return No})),n.d(t,"ajax",(function(){return Uo})),n.d(t,"AjaxCall",(function(){return ei})),n.d(t,"AjaxError",(function(){return ti})),n.d(t,"LookupCall",(function(){return ri})),n.d(t,"LookupRow",(function(){return ii})),n.d(t,"RestLookupCall",(function(){return pi})),n.d(t,"RemoteLookupCall",(function(){return _i})),n.d(t,"RemoteLookupRequest",(function(){return ki})),n.d(t,"QueryBy",(function(){return Si})),n.d(t,"StaticLookupCall",(function(){return Di})),n.d(t,"PrepopulatedLookupCall",(function(){return Ii})),n.d(t,"HierarchicalLookupResultBuilder",(function(){return Hi})),n.d(t,"Code",(function(){return Wi})),n.d(t,"CodeType",(function(){return Gi})),n.d(t,"codes",(function(){return Qi})),n.d(t,"CodeLookupCall",(function(){return ss})),n.d(t,"BackgroundJobPollingStatus",(function(){return as})),n.d(t,"BackgroundJobPollingSupport",(function(){return us})),n.d(t,"BusyIndicator",(function(){return bs})),n.d(t,"RemoteEvent",(function(){return ms})),n.d(t,"Locale",(function(){return _s})),n.d(t,"PropertyChangeEventFilter",(function(){return ks})),n.d(t,"Reconnector",(function(){return Os})),n.d(t,"ResponseQueue",(function(){return Cs})),n.d(t,"Session",(function(){return xs})),n.d(t,"UserAgent",(function(){return Es})),n.d(t,"WidgetEventTypeFilter",(function(){return As})),n.d(t,"Dimension",(function(){return $s})),n.d(t,"Insets",(function(){return Bs})),n.d(t,"Point",(function(){return Is})),n.d(t,"Rectangle",(function(){return Hs})),n.d(t,"graphics",(function(){return qs})),n.d(t,"HtmlEnvironment",(function(){return Xs})),n.d(t,"AbstractLayout",(function(){return Zs})),n.d(t,"HtmlComponent",(function(){return ea})),n.d(t,"LayoutConstants",(function(){return ta})),n.d(t,"LayoutValidator",(function(){return ra})),n.d(t,"LogicalGrid",(function(){return ia})),n.d(t,"LogicalGridConfig",(function(){return aa})),n.d(t,"LogicalGridData",(function(){return ua})),n.d(t,"LogicalGridLayout",(function(){return ba})),n.d(t,"LogicalGridLayoutConfig",(function(){return ga})),n.d(t,"LogicalGridLayoutInfo",(function(){return wa})),n.d(t,"AbstractGrid",(function(){return Ra})),n.d(t,"HorizontalGrid",(function(){return ja})),n.d(t,"VerticalSmartGrid",(function(){return Va})),n.d(t,"LogicalGridMatrix",(function(){return za})),n.d(t,"LogicalGridMatrixCell",(function(){return Ua})),n.d(t,"LogicalGridMatrixCursor",(function(){return Ya})),n.d(t,"HorizontalGridMatrix",(function(){return nl})),n.d(t,"VerticalGridMatrix",(function(){return ul})),n.d(t,"ColumnLayout",(function(){return vl})),n.d(t,"NullLayout",(function(){return Sl})),n.d(t,"RowLayout",(function(){return El})),n.d(t,"SingleLayout",(function(){return Ml})),n.d(t,"FlexboxLayout",(function(){return zl})),n.d(t,"FlexboxLayoutData",(function(){return Ul})),n.d(t,"SimpleTabBoxController",(function(){return ql})),n.d(t,"SimpleTabBox",(function(){return nu})),n.d(t,"SimpleTabBoxLayout",(function(){return uu})),n.d(t,"SimpleTabViewContentLayout",(function(){return bu})),n.d(t,"keys",(function(){return Ou})),n.d(t,"Key",(function(){return Cu})),n.d(t,"keyStrokeModifier",(function(){return Ru})),n.d(t,"VirtualKeyStrokeEvent",(function(){return Eu})),n.d(t,"KeyStrokeManager",(function(){return Au})),n.d(t,"KeyStrokeContext",(function(){return $u})),n.d(t,"InputFieldKeyStrokeContext",(function(){return Vu})),n.d(t,"KeyStroke",(function(){return zu})),n.d(t,"RangeKeyStroke",(function(){return Ju})),n.d(t,"ContextMenuKeyStroke",(function(){return ic})),n.d(t,"ClickActiveElementKeyStroke",(function(){return pc})),n.d(t,"FocusAdjacentElementKeyStroke",(function(){return _c})),n.d(t,"CloseKeyStroke",(function(){return Pc})),n.d(t,"AbortKeyStroke",(function(){return $c})),n.d(t,"TabItemKeyStroke",(function(){return Vc})),n.d(t,"Accordion",(function(){return Jc})),n.d(t,"AccordionAdapter",(function(){return rf})),n.d(t,"AccordionLayout",(function(){return pf})),n.d(t,"BoxButtons",(function(){return yf})),n.d(t,"Carousel",(function(){return Sf})),n.d(t,"CarouselLayout",(function(){return Ef})),n.d(t,"Cell",(function(){return Af})),n.d(t,"CollapseHandle",(function(){return Hf})),n.d(t,"FocusManager",(function(){return Vf})),n.d(t,"FocusContext",(function(){return zf})),n.d(t,"focusUtils",(function(){return Uf})),n.d(t,"FocusRule",(function(){return Kf})),n.d(t,"GlassPane",(function(){return th})),n.d(t,"DeferredGlassPaneTarget",(function(){return rh})),n.d(t,"GlassPaneRenderer",(function(){return ih})),n.d(t,"IFrame",(function(){return dh})),n.d(t,"Scrollbar",(function(){return Sh})),n.d(t,"scrollbars",(function(){return Lh})),n.d(t,"VirtualScrolling",(function(){return Nh})),n.d(t,"Splitter",(function(){return Xh})),n.d(t,"DateFormatPatternType",(function(){return Jh})),n.d(t,"DateFormatPatternDefinition",(function(){return Qh})),n.d(t,"DateFormat",(function(){return tp})),n.d(t,"DecimalFormat",(function(){return rp})),n.d(t,"TextMap",(function(){return ip})),n.d(t,"texts",(function(){return bp})),n.d(t,"Tooltip",(function(){return Tp})),n.d(t,"TooltipSupport",(function(){return Pp})),n.d(t,"tooltips",(function(){return xp})),n.d(t,"WidgetTooltip",(function(){return Mp})),n.d(t,"Action",(function(){return Up})),n.d(t,"ActionAdapter",(function(){return ed})),n.d(t,"ActionKeyStroke",(function(){return ld})),n.d(t,"Box",(function(){return cd})),n.d(t,"Label",(function(){return md})),n.d(t,"LabelAdapter",(function(){return Cd})),n.d(t,"Popup",(function(){return Id})),n.d(t,"PopupAdapter",(function(){return Ud})),n.d(t,"PopupLayout",(function(){return Qd})),n.d(t,"PopupManager",(function(){return ay})),n.d(t,"PopupManagerAdapter",(function(){return py})),n.d(t,"PopupWithHead",(function(){return wy})),n.d(t,"PopupWithHeadLayout",(function(){return xy})),n.d(t,"TouchPopup",(function(){return Iy})),n.d(t,"TouchPopupLayout",(function(){return Uy})),n.d(t,"WidgetPopup",(function(){return tv})),n.d(t,"WidgetPopupAdapter",(function(){return av})),n.d(t,"WidgetPopupLayout",(function(){return yv})),n.d(t,"MobilePopup",(function(){return Sv})),n.d(t,"MobilePopupAdapter",(function(){return Ev})),n.d(t,"MobilePopupLayout",(function(){return Iv})),n.d(t,"DatePicker",(function(){return Uv})),n.d(t,"DatePickerPopup",(function(){return eb})),n.d(t,"DatePickerPopupLayout",(function(){return lb})),n.d(t,"DatePickerTouchPopup",(function(){return vb})),n.d(t,"DatePickerTouchPopupLayout",(function(){return Sb})),n.d(t,"Group",(function(){return Db})),n.d(t,"GroupAdapter",(function(){return Mb})),n.d(t,"GroupLayout",(function(){return zb})),n.d(t,"GroupToggleCollapseKeyStroke",(function(){return Jb})),n.d(t,"Icon",(function(){return im})),n.d(t,"IconDesc",(function(){return lm})),n.d(t,"Image",(function(){return vm})),n.d(t,"ImageLayout",(function(){return Om})),n.d(t,"Notification",(function(){return Am})),n.d(t,"NotificationAdapter",(function(){return Hm})),n.d(t,"menus",(function(){return zm})),n.d(t,"MenuDestinations",(function(){return Gm})),n.d(t,"Menu",(function(){return eg})),n.d(t,"EllipsisMenu",(function(){return lg})),n.d(t,"MenuAdapter",(function(){return dg})),n.d(t,"MenuKeyStroke",(function(){return kg})),n.d(t,"MenuExecKeyStroke",(function(){return Eg})),n.d(t,"MenuItemsOrder",(function(){return Ag})),n.d(t,"ComboMenu",(function(){return Lg})),n.d(t,"ComboMenuAdapter",(function(){return Gg})),n.d(t,"ContextMenuPopup",(function(){return Qg})),n.d(t,"ContextMenuPopupLayout",(function(){return a_})),n.d(t,"MenuNavigationKeyStroke",(function(){return y_})),n.d(t,"MenuNavigationExecKeyStroke",(function(){return k_})),n.d(t,"MenuExecByNumberKeyStroke",(function(){return E_})),n.d(t,"MenuNavigationDownKeyStroke",(function(){return M_})),n.d(t,"MenuNavigationUpKeyStroke",(function(){return z_})),n.d(t,"SubCloseKeyStroke",(function(){return Z_})),n.d(t,"menuNavigationKeyStrokes",(function(){return Q_})),n.d(t,"ButtonAdapterMenu",(function(){return lw})),n.d(t,"FormFieldMenu",(function(){return vw})),n.d(t,"FormFieldMenuAdapter",(function(){return Ow})),n.d(t,"MenuBox",(function(){return Aw})),n.d(t,"MenuBoxLayout",(function(){return Lw})),n.d(t,"MenuBar",(function(){return Yw})),n.d(t,"MenuBarLayout",(function(){return ok})),n.d(t,"MenuBarLeftKeyStroke",(function(){return fk})),n.d(t,"MenuBarRightKeyStroke",(function(){return mk})),n.d(t,"MenuBarPopup",(function(){return Pk})),n.d(t,"MenubarBox",(function(){return Bk})),n.d(t,"MenubarBoxLayout",(function(){return Wk})),n.d(t,"Calendar",(function(){return Zk})),n.d(t,"CalendarAdapter",(function(){return sS})),n.d(t,"CalendarComponent",(function(){return dS})),n.d(t,"CalendarComponentAdapter",(function(){return _S})),n.d(t,"CalendarListComponent",(function(){return kS})),n.d(t,"CalendarLayout",(function(){return xS})),n.d(t,"CalendarModeMenu",(function(){return BS})),n.d(t,"CalendarModesMenu",(function(){return zS})),n.d(t,"DateRange",(function(){return US})),n.d(t,"YearPanel",(function(){return eO})),n.d(t,"Lifecycle",(function(){return nO})),n.d(t,"Planner",(function(){return fO})),n.d(t,"PlannerAdapter",(function(){return gO})),n.d(t,"PlannerHeader",(function(){return CO})),n.d(t,"PlannerLayout",(function(){return FO})),n.d(t,"PlannerMenuItemsOrder",(function(){return LO})),n.d(t,"FileChooser",(function(){return KO})),n.d(t,"FileChooserAdapter",(function(){return tT})),n.d(t,"FileChooserController",(function(){return rT})),n.d(t,"FileInput",(function(){return fT})),n.d(t,"Route",(function(){return pT})),n.d(t,"router",(function(){return gT})),n.d(t,"Slider",(function(){return PT})),n.d(t,"SliderAdapter",(function(){return FT})),n.d(t,"SliderLayout",(function(){return HT})),n.d(t,"Mode",(function(){return qT})),n.d(t,"ModeAdapter",(function(){return eC})),n.d(t,"ModeSelector",(function(){return uC})),n.d(t,"ModeSelectorLayout",(function(){return bC})),n.d(t,"Form",(function(){return CC})),n.d(t,"FormAdapter",(function(){return $C})),n.d(t,"FormGrid",(function(){return NC})),n.d(t,"FormLayout",(function(){return qC})),n.d(t,"FormMenuActionKeyStroke",(function(){return tP})),n.d(t,"FormMenu",(function(){return uP})),n.d(t,"FormMenuAdapter",(function(){return yP})),n.d(t,"FormMenuPopup",(function(){return OP})),n.d(t,"FormMenuPopupLayout",(function(){return AP})),n.d(t,"FormLifecycle",(function(){return HP})),n.d(t,"CancelMenu",(function(){return qP})),n.d(t,"CloseMenu",(function(){return nR})),n.d(t,"OkMenu",(function(){return cR})),n.d(t,"ResetMenu",(function(){return mR})),n.d(t,"SaveMenu",(function(){return CR})),n.d(t,"DialogLayout",(function(){return jR})),n.d(t,"ResponsiveManager",(function(){return MR})),n.d(t,"ResponsiveHandler",(function(){return LR})),n.d(t,"GroupBoxResponsiveHandler",(function(){return qR})),n.d(t,"DesktopResponsiveHandler",(function(){return nx})),n.d(t,"TileOverviewForm",(function(){return cx})),n.d(t,"TileOverviewFormAdapter",(function(){return vx})),n.d(t,"Table",(function(){return Cx})),n.d(t,"TableAdapter",(function(){return $x})),n.d(t,"TableCompactHandler",(function(){return Bx})),n.d(t,"TableRow",(function(){return Ix})),n.d(t,"TableMatrix",(function(){return Nx})),n.d(t,"TableFooter",(function(){return Xx})),n.d(t,"TableFooterLayout",(function(){return rE})),n.d(t,"TableInfoFilterTooltip",(function(){return fE})),n.d(t,"TableInfoLoadTooltip",(function(){return gE})),n.d(t,"TableInfoSelectionTooltip",(function(){return PE})),n.d(t,"TableHeader",(function(){return BE})),n.d(t,"TableHeaderMenu",(function(){return UE})),n.d(t,"TableHeaderMenuLayout",(function(){return eD})),n.d(t,"TableHeaderMenuGroup",(function(){return lD})),n.d(t,"TableHeaderMenuButton",(function(){return vD})),n.d(t,"TableHeaderMenuButtonKeyStroke",(function(){return SD})),n.d(t,"TableLayout",(function(){return DD})),n.d(t,"TableSelectionHandler",(function(){return FD})),n.d(t,"TableTileGridMediator",(function(){return VD})),n.d(t,"TableTileGridMediatorAdapter",(function(){return YD})),n.d(t,"TableRowDetail",(function(){return oA})),n.d(t,"TableRowTileMapping",(function(){return cA})),n.d(t,"TableRowTileMappingAdapter",(function(){return vA})),n.d(t,"TableTooltip",(function(){return OA})),n.d(t,"TableUpdateBuffer",(function(){return CA})),n.d(t,"TileTableHeaderGroupByLookupCall",(function(){return $A})),n.d(t,"TileTableHeaderSortByLookupCall",(function(){return VA})),n.d(t,"comparators",(function(){return GA})),n.d(t,"Column",(function(){return qA})),n.d(t,"ColumnOptimalWidthMeasurer",(function(){return XA})),n.d(t,"AlphanumericSortingStringColumn",(function(){return nF})),n.d(t,"BeanColumn",(function(){return cF})),n.d(t,"BooleanColumn",(function(){return mF})),n.d(t,"CompactColumn",(function(){return TF})),n.d(t,"CompactBean",(function(){return xF})),n.d(t,"CompactLine",(function(){return DF})),n.d(t,"CompactLineBlock",(function(){return FF})),n.d(t,"DateColumn",(function(){return NF})),n.d(t,"IconColumn",(function(){return YF})),n.d(t,"NumberColumn",(function(){return r$})),n.d(t,"SmartColumn",(function(){return f$})),n.d(t,"TableControlActionKeyStroke",(function(){return m$})),n.d(t,"TableControl",(function(){return P$})),n.d(t,"TableControlAdapter",(function(){return $$})),n.d(t,"TableControlAdapterMenu",(function(){return W$})),n.d(t,"AggregateTableControl",(function(){return Z$})),n.d(t,"AggregateTableControlAdapter",(function(){return ij})),n.d(t,"FormTableControl",(function(){return dj})),n.d(t,"FormTableControlAdapter",(function(){return _j})),n.d(t,"FormTableControlLayout",(function(){return Pj})),n.d(t,"CellEditorPopup",(function(){return Bj})),n.d(t,"CellEditorPopupLayout",(function(){return Wj})),n.d(t,"CellEditorCancelEditKeyStroke",(function(){return Xj})),n.d(t,"CellEditorCompleteEditKeyStroke",(function(){return rB})),n.d(t,"CellEditorTabKeyStroke",(function(){return fB})),n.d(t,"AbstractTableNavigationKeyStroke",(function(){return gB})),n.d(t,"TableControlCloseKeyStroke",(function(){return CB})),n.d(t,"TableCopyKeyStroke",(function(){return FB})),n.d(t,"TableNavigationCollapseKeyStroke",(function(){return VB})),n.d(t,"TableNavigationExpandKeyStroke",(function(){return JB})),n.d(t,"TableSelectAllKeyStroke",(function(){return iM})),n.d(t,"TableStartCellEditKeyStroke",(function(){return dM})),n.d(t,"TableRefreshKeyStroke",(function(){return SM})),n.d(t,"TableToggleRowKeyStroke",(function(){return DM})),n.d(t,"TableNavigationUpKeyStroke",(function(){return LM})),n.d(t,"TableNavigationDownKeyStroke",(function(){return KM})),n.d(t,"TableNavigationHomeKeyStroke",(function(){return tI})),n.d(t,"TableNavigationEndKeyStroke",(function(){return uI})),n.d(t,"TableNavigationPageUpKeyStroke",(function(){return bI})),n.d(t,"TableNavigationPageDownKeyStroke",(function(){return TI})),n.d(t,"TableFocusFilterFieldKeyStroke",(function(){return AI})),n.d(t,"TableFilter",(function(){return $I})),n.d(t,"TableUserFilter",(function(){return NI})),n.d(t,"ColumnUserFilter",(function(){return YI})),n.d(t,"DateColumnUserFilter",(function(){return rL})),n.d(t,"NumberColumnUserFilter",(function(){return fL})),n.d(t,"TextColumnUserFilter",(function(){return gL})),n.d(t,"TableTextUserFilter",(function(){return PL})),n.d(t,"TileTableHierarchyFilter",(function(){return jL})),n.d(t,"KeyTableFilter",(function(){return VL})),n.d(t,"TextTableFilter",(function(){return YL})),n.d(t,"TimePicker",(function(){return rH})),n.d(t,"TimePickerPopup",(function(){return fH})),n.d(t,"TimePickerPopupLayout",(function(){return gH})),n.d(t,"TimePickerTouchPopup",(function(){return PH})),n.d(t,"TimePickerTouchPopupLayout",(function(){return jH})),n.d(t,"Tree",(function(){return KH})),n.d(t,"TreeAdapter",(function(){return tN})),n.d(t,"TreeNode",(function(){return rN})),n.d(t,"TreeLayout",(function(){return cN})),n.d(t,"LazyNodeFilter",(function(){return hN})),n.d(t,"TreeBreadcrumbFilter",(function(){return dN})),n.d(t,"AbstractTreeNavigationKeyStroke",(function(){return kN})),n.d(t,"TreeSpaceKeyStroke",(function(){return EN})),n.d(t,"TreeNavigationUpKeyStroke",(function(){return IN})),n.d(t,"TreeNavigationDownKeyStroke",(function(){return UN})),n.d(t,"TreeNavigationEndKeyStroke",(function(){return eV})),n.d(t,"TreeCollapseAllKeyStroke",(function(){return lV})),n.d(t,"TreeCollapseOrDrillUpKeyStroke",(function(){return vV})),n.d(t,"TreeExpandOrDrillDownKeyStroke",(function(){return TV})),n.d(t,"CompactTree",(function(){return FV})),n.d(t,"CompactTreeNode",(function(){return HV})),n.d(t,"AbstractCompactTreeControlKeyStroke",(function(){return qV})),n.d(t,"CompactTreeUpKeyStroke",(function(){return tW})),n.d(t,"CompactTreeDownKeyStroke",(function(){return lW})),n.d(t,"CompactTreeLeftKeyStroke",(function(){return yW})),n.d(t,"CompactTreeRightKeyStroke",(function(){return kW})),n.d(t,"fields",(function(){return TW})),n.d(t,"AppLinkKeyStroke",(function(){return FW})),n.d(t,"FieldStatus",(function(){return VW})),n.d(t,"FormField",(function(){return ZW})),n.d(t,"FormFieldAdapter",(function(){return sz})),n.d(t,"FormFieldLayout",(function(){return dz})),n.d(t,"StatusMenuMapping",(function(){return kz})),n.d(t,"StatusMenuMappingAdapter",(function(){return Rz})),n.d(t,"GridData",(function(){return Ez})),n.d(t,"CompositeField",(function(){return Iz})),n.d(t,"CompositeFieldAdapter",(function(){return zz})),n.d(t,"ValueField",(function(){return Qz})),n.d(t,"ValueFieldAdapter",(function(){return aG})),n.d(t,"BasicField",(function(){return yG})),n.d(t,"BasicFieldAdapter",(function(){return wG})),n.d(t,"WidgetField",(function(){return xG})),n.d(t,"WidgetFieldAdapter",(function(){return jG})),n.d(t,"WidgetFieldLayout",(function(){return WG})),n.d(t,"LookupBox",(function(){return JG})),n.d(t,"LookupBoxLayout",(function(){return oU})),n.d(t,"TreeVisitResult",(function(){return iU})),n.d(t,"FormController",(function(){return aU})),n.d(t,"MessageBox",(function(){return yU})),n.d(t,"MessageBoxAdapter",(function(){return SU})),n.d(t,"MessageBoxController",(function(){return TU})),n.d(t,"MessageBoxes",(function(){return PU})),n.d(t,"MessageBoxLayout",(function(){return $U})),n.d(t,"CopyKeyStroke",(function(){return NU})),n.d(t,"AccordionField",(function(){return YU})),n.d(t,"AccordionFieldAdapter",(function(){return tK})),n.d(t,"BeanField",(function(){return uK})),n.d(t,"BeanFieldAdapter",(function(){return bK})),n.d(t,"BrowserField",(function(){return TK})),n.d(t,"BrowserFieldAdapter",(function(){return FK})),n.d(t,"BrowserFieldLayout",(function(){return NK})),n.d(t,"Button",(function(){return JK})),n.d(t,"ButtonLayout",(function(){return iq})),n.d(t,"ButtonAdapter",(function(){return pq})),n.d(t,"ButtonKeyStroke",(function(){return kq})),n.d(t,"CalendarField",(function(){return xq})),n.d(t,"CalendarFieldAdapter",(function(){return jq})),n.d(t,"CarouselField",(function(){return Vq})),n.d(t,"CheckBoxField",(function(){return Jq})),n.d(t,"CheckBoxFieldAdapter",(function(){return rY})),n.d(t,"CheckBoxToggleKeyStroke",(function(){return fY})),n.d(t,"ClipboardField",(function(){return _Y})),n.d(t,"ClipboardFieldAdapter",(function(){return CY})),n.d(t,"ColorField",(function(){return FY})),n.d(t,"ColorFieldAdapter",(function(){return LY})),n.d(t,"DatePredictionFailedStatus",(function(){return GY})),n.d(t,"DateField",(function(){return eX})),n.d(t,"DateFieldAdapter",(function(){return lX})),n.d(t,"DateTimeCompositeLayout",(function(){return vX})),n.d(t,"FileChooserButton",(function(){return OX})),n.d(t,"FileChooserButtonAdapter",(function(){return AX})),n.d(t,"FileChooserField",(function(){return HX})),n.d(t,"FileChooserFieldAdapter",(function(){return qX})),n.d(t,"FileChooserFieldBrowseKeyStroke",(function(){return nJ})),n.d(t,"FileChooserFieldDeleteKeyStroke",(function(){return cJ})),n.d(t,"GroupBox",(function(){return gJ})),n.d(t,"GroupBoxGridConfig",(function(){return CJ})),n.d(t,"GroupBoxAdapter",(function(){return $J})),n.d(t,"GroupBoxLayout",(function(){return VJ})),n.d(t,"GroupBoxMenuItemsOrder",(function(){return zJ})),n.d(t,"HtmlField",(function(){return ZJ})),n.d(t,"HtmlFieldAdapter",(function(){return sZ})),n.d(t,"ImageField",(function(){return dZ})),n.d(t,"ImageFieldAdapter",(function(){return kZ})),n.d(t,"ImageFieldLayout",(function(){return EZ})),n.d(t,"LabelField",(function(){return IZ})),n.d(t,"LabelFieldAdapter",(function(){return UZ})),n.d(t,"ListBox",(function(){return eQ})),n.d(t,"ListBoxAdapter",(function(){return sQ})),n.d(t,"ListBoxLayout",(function(){return hQ})),n.d(t,"lookupField",(function(){return dQ})),n.d(t,"LookupFieldAdapter",(function(){return wQ})),n.d(t,"ModeSelectorField",(function(){return xQ})),n.d(t,"ModeSelectorFieldAdapter",(function(){return MQ})),n.d(t,"NumberField",(function(){return GQ})),n.d(t,"NumberFieldAdapter",(function(){return QQ})),n.d(t,"Calculator",(function(){return t0})),n.d(t,"IntegerField",(function(){return c0})),n.d(t,"PlaceholderField",(function(){return b0})),n.d(t,"PlaceholderFieldAdapter",(function(){return S0})),n.d(t,"PlannerField",(function(){return E0})),n.d(t,"PlannerFieldAdapter",(function(){return B0})),n.d(t,"RadioButton",(function(){return G0})),n.d(t,"RadioButtonLayout",(function(){return Q0})),n.d(t,"RadioButtonAdapter",(function(){return i1})),n.d(t,"RadioButtonGroup",(function(){return y1})),n.d(t,"RadioButtonGroupAdapter",(function(){return S1})),n.d(t,"RadioButtonGroupGridConfig",(function(){return E1})),n.d(t,"RadioButtonGroupLayout",(function(){return I1})),n.d(t,"RadioButtonGroupLeftOrUpKeyStroke",(function(){return G1})),n.d(t,"RadioButtonGroupRightOrDownKeyStroke",(function(){return Z1})),n.d(t,"RadioButtonKeyStroke",(function(){return s2})),n.d(t,"SequenceBox",(function(){return d2})),n.d(t,"SequenceBoxGridConfig",(function(){return w2})),n.d(t,"SequenceBoxLayout",(function(){return x2})),n.d(t,"SequenceBoxAdapter",(function(){return M2})),n.d(t,"SliderField",(function(){return G2})),n.d(t,"SmartField",(function(){return e3})),n.d(t,"SmartFieldAdapter",(function(){return l3})),n.d(t,"SmartFieldLayout",(function(){return v3})),n.d(t,"SmartFieldCancelKeyStroke",(function(){return T3})),n.d(t,"SmartFieldPopup",(function(){return F3})),n.d(t,"SmartFieldTouchPopup",(function(){return N3})),n.d(t,"SmartFieldPopupLayout",(function(){return Y3})),n.d(t,"SmartFieldMultiline",(function(){return r5})),n.d(t,"SmartFieldMultilineAdapter",(function(){return u5})),n.d(t,"SmartFieldMultilineLayout",(function(){return b5})),n.d(t,"ProposalField",(function(){return T5})),n.d(t,"ProposalFieldAdapter",(function(){return D5})),n.d(t,"ProposalTreeNode",(function(){return L5})),n.d(t,"ProposalChooser",(function(){return K5})),n.d(t,"ProposalChooserLayout",(function(){return e4})),n.d(t,"TableProposalChooser",(function(){return a4})),n.d(t,"TableLayoutResetter",(function(){return u4})),n.d(t,"TreeProposalChooser",(function(){return v4})),n.d(t,"TreeLayoutResetter",(function(){return m4})),n.d(t,"SplitBox",(function(){return P4})),n.d(t,"SplitBoxAdapter",(function(){return j4})),n.d(t,"SplitBoxCollapseKeyStroke",(function(){return V4})),n.d(t,"SplitBoxFirstCollapseKeyStroke",(function(){return Y4})),n.d(t,"SplitBoxSecondCollapseKeyStroke",(function(){return n6})),n.d(t,"SplitBoxLayout",(function(){return u6})),n.d(t,"StringField",(function(){return g6})),n.d(t,"StringFieldLayout",(function(){return P6})),n.d(t,"StringFieldAdapter",(function(){return j6})),n.d(t,"StringFieldEnterKeyStroke",(function(){return W6})),n.d(t,"StringFieldCtrlEnterKeyStroke",(function(){return J6})),n.d(t,"TabBox",(function(){return s9})),n.d(t,"TabAreaLeftKeyStroke",(function(){return p9})),n.d(t,"TabAreaRightKeyStroke",(function(){return _9})),n.d(t,"TabBoxAdapter",(function(){return R9})),n.d(t,"TabBoxHeaderLayout",(function(){return B9})),n.d(t,"TabBoxHeader",(function(){return G9})),n.d(t,"Tab",(function(){return e8})),n.d(t,"TabArea",(function(){return u8})),n.d(t,"TabAreaLayout",(function(){return b8})),n.d(t,"TabBoxLayout",(function(){return T8})),n.d(t,"TabItem",(function(){return F8})),n.d(t,"TabItemAdapter",(function(){return L8})),n.d(t,"TabItemLayout",(function(){return U8})),n.d(t,"TableField",(function(){return t7})),n.d(t,"TableFieldAdapter",(function(){return a7})),n.d(t,"TagChooserPopup",(function(){return y7})),n.d(t,"TagChooserPopupLayout",(function(){return S7})),n.d(t,"TagField",(function(){return D7})),n.d(t,"TagFieldAdapter",(function(){return L7})),n.d(t,"TagFieldCancelKeyStroke",(function(){return q7})),n.d(t,"TagFieldEnterKeyStroke",(function(){return nee})),n.d(t,"TagFieldDeleteKeyStroke",(function(){return cee})),n.d(t,"TagFieldNavigationKeyStroke",(function(){return mee})),n.d(t,"TagFieldOpenPopupKeyStroke",(function(){return Cee})),n.d(t,"TagFieldLayout",(function(){return Fee})),n.d(t,"TagFieldContainerLayout",(function(){return Hee})),n.d(t,"TileField",(function(){return qee})),n.d(t,"TileFieldAdapter",(function(){return ete})),n.d(t,"TreeBox",(function(){return lte})),n.d(t,"TreeBoxAdapter",(function(){return dte})),n.d(t,"TreeBoxLayout",(function(){return _te})),n.d(t,"TreeField",(function(){return Pte})),n.d(t,"TreeFieldAdapter",(function(){return Fte})),n.d(t,"WizardProgressField",(function(){return Nte})),n.d(t,"WizardProgressFieldAdapter",(function(){return Yte})),n.d(t,"WizardProgressFieldLayout",(function(){return rne})),n.d(t,"WrappedFormField",(function(){return hne})),n.d(t,"WrappedFormFieldAdapter",(function(){return mne})),n.d(t,"Switch",(function(){return Cne})),n.d(t,"TagBar",(function(){return $ne})),n.d(t,"TagBarLayout",(function(){return Nne})),n.d(t,"TagBarOverflowPopup",(function(){return Yne})),n.d(t,"Tile",(function(){return rre})),n.d(t,"TileAdapter",(function(){return ure})),n.d(t,"TileGrid",(function(){return gre})),n.d(t,"TileGridAdapter",(function(){return Pre})),n.d(t,"TileGridGridConfig",(function(){return $re})),n.d(t,"TileGridLayout",(function(){return Vre})),n.d(t,"TileGridLayoutConfig",(function(){return Xre})),n.d(t,"TileGridSelectionHandler",(function(){return Zre})),n.d(t,"HtmlTile",(function(){return soe})),n.d(t,"HtmlTileAdapter",(function(){return hoe})),n.d(t,"BeanTile",(function(){return _oe})),n.d(t,"BeanTileAdapter",(function(){return Roe})),n.d(t,"TileAccordion",(function(){return Moe})),n.d(t,"TileAccordionAdapter",(function(){return Goe})),n.d(t,"TileAccordionSelectionHandler",(function(){return Zoe})),n.d(t,"TileGridSelectKeyStroke",(function(){return aie})),n.d(t,"TileGridSelectAllKeyStroke",(function(){return vie})),n.d(t,"TileGridSelectLeftKeyStroke",(function(){return Oie})),n.d(t,"TileGridSelectRightKeyStroke",(function(){return Aie})),n.d(t,"TileGridSelectDownKeyStroke",(function(){return Hie})),n.d(t,"TileGridSelectUpKeyStroke",(function(){return qie})),n.d(t,"TileGridSelectFirstKeyStroke",(function(){return nse})),n.d(t,"TileGridSelectLastKeyStroke",(function(){return cse})),n.d(t,"RemoteTileFilter",(function(){return hse})),n.d(t,"WidgetTile",(function(){return wse})),n.d(t,"WidgetTileAdapter",(function(){return Pse})),n.d(t,"PlaceholderTile",(function(){return jse})),n.d(t,"FormFieldTile",(function(){return Wse})),n.d(t,"FormFieldTileAdapter",(function(){return Yse})),n.d(t,"TileButton",(function(){return rae})),n.d(t,"TileTableField",(function(){return hae})),n.d(t,"Desktop",(function(){return kae})),n.d(t,"DesktopAdapter",(function(){return Eae})),n.d(t,"DesktopLogo",(function(){return Lae})),n.d(t,"DesktopLayout",(function(){return Uae})),n.d(t,"DesktopTabBoxController",(function(){return Qae})),n.d(t,"DisableBrowserF5ReloadKeyStroke",(function(){return sle})),n.d(t,"PopupWindow",(function(){return lle})),n.d(t,"OpenUriHandler",(function(){return cle})),n.d(t,"DesktopBench",(function(){return _le})),n.d(t,"BenchColumn",(function(){return Ele})),n.d(t,"BenchRowLayoutData",(function(){return Ile})),n.d(t,"BenchColumnLayoutData",(function(){return Hle})),n.d(t,"DesktopTabSelectKeyStroke",(function(){return Yle})),n.d(t,"DisableBrowserTabSwitchingKeyStroke",(function(){return rue})),n.d(t,"DesktopHeader",(function(){return hue})),n.d(t,"HeaderTabBoxController",(function(){return wue})),n.d(t,"DesktopHeaderLayout",(function(){return Rue})),n.d(t,"DesktopNavigation",(function(){return Iue})),n.d(t,"DesktopNavigationHandle",(function(){return Uue})),n.d(t,"DesktopNavigationLayout",(function(){return Que})),n.d(t,"ShrinkNavigationKeyStroke",(function(){return ace})),n.d(t,"EnlargeNavigationKeyStroke",(function(){return yce})),n.d(t,"DesktopNotification",(function(){return Sce})),n.d(t,"DesktopNotificationAdapter",(function(){return xce})),n.d(t,"OfflineDesktopNotification",(function(){return Mce})),n.d(t,"PopupBlockerHandler",(function(){return Lce})),n.d(t,"PopupBlockerDesktopNotification",(function(){return Kce})),n.d(t,"DesktopToolBox",(function(){return tfe})),n.d(t,"ViewButtonActionKeyStroke",(function(){return ufe})),n.d(t,"ViewButton",(function(){return bfe})),n.d(t,"ViewButtonAdapter",(function(){return Sfe})),n.d(t,"ViewButtonBox",(function(){return Afe})),n.d(t,"ViewButtonBoxLayout",(function(){return Lfe})),n.d(t,"ViewMenuOpenKeyStroke",(function(){return Kfe})),n.d(t,"ViewMenuPopup",(function(){return nhe})),n.d(t,"ViewMenuPopupLayout",(function(){return che})),n.d(t,"ViewMenuTab",(function(){return mhe})),n.d(t,"Page",(function(){return Che})),n.d(t,"PageWithNodes",(function(){return Fhe})),n.d(t,"PageWithTable",(function(){return Nhe})),n.d(t,"PageTileButton",(function(){return Yhe})),n.d(t,"PageTileGrid",(function(){return ope})),n.d(t,"PageTileGridSelectKeyStroke",(function(){return ppe})),n.d(t,"AutoLeafPageWithNodes",(function(){return wpe})),n.d(t,"SimpleTab",(function(){return Epe})),n.d(t,"DesktopTab",(function(){return Ipe})),n.d(t,"SimpleTabArea",(function(){return Upe})),n.d(t,"SimpleTabAreaLayout",(function(){return ede})),n.d(t,"DetailTableTreeFilter",(function(){return nde})),n.d(t,"Outline",(function(){return fde})),n.d(t,"OutlineAdapter",(function(){return _de})),n.d(t,"OutlineMediator",(function(){return kde})),n.d(t,"OutlineLayout",(function(){return Ede})),n.d(t,"OutlineViewButton",(function(){return Ide})),n.d(t,"OutlineViewButtonAdapter",(function(){return Gde})),n.d(t,"OutlineTileField",(function(){return Zde})),n.d(t,"OutlineTileFieldAdapter",(function(){return oye})),n.d(t,"PageLayout",(function(){return fye})),n.d(t,"SearchOutline",(function(){return gye})),n.d(t,"SearchOutlineAdapter",(function(){return Pye})),n.d(t,"SearchOutlineLayout",(function(){return jye})),n.d(t,"NavigateButton",(function(){return Wye})),n.d(t,"NavigateDownButton",(function(){return Zye})),n.d(t,"NavigateUpButton",(function(){return sve})),n.d(t,"OutlineKeyStrokeContext",(function(){return dve})),n.d(t,"OutlineNavigateToTopKeyStroke",(function(){return kve})),n.d(t,"OutlineOverview",(function(){return Eve})),n.d(t,"TileOutlineOverview",(function(){return Ive})),n.d(t,"DesktopFormController",(function(){return Kve})),n.d(t,"FilterFieldsGroupBox",(function(){return tbe})),n.d(t,"Resizable",(function(){return obe})),n.d(t,"UnsavedFormChangesForm",(function(){return hbe})),n.d(t,"UnsavedFormsLookupCall",(function(){return gbe})),n.d(t,"TileTableHeaderBox",(function(){return Rbe})),n.d(t,"LoginApp",(function(){return Bbe})),n.d(t,"LoginBox",(function(){return Gbe})),n.d(t,"LogoutApp",(function(){return Qbe})),n.d(t,"LogoutBox",(function(){return ame})),n.d(t,"BreadcrumbItem",(function(){return yme})),n.d(t,"BreadcrumbItemAdapter",(function(){return wme})),n.d(t,"BreadcrumbBar",(function(){return xme})),n.d(t,"BreadcrumbBarLayout",(function(){return Ime})),n.d(t,"BreadcrumbBarAdapter",(function(){return zme})),n.d(t,"BreadcrumbBarField",(function(){return Jme})),n.d(t,"BreadcrumbBarFieldAdapter",(function(){return rge}));var r={};n.r(r),n.d(r,"nvl",(function(){return u})),n.d(r,"assertParameter",(function(){return c})),n.d(r,"assertProperty",(function(){return f})),n.d(r,"isOneOf",(function(){return h})),n.d(r,"create",(function(){return p})),n.d(r,"prepareDOM",(function(){return d})),n.d(r,"installGlobalMouseDownInterceptor",(function(){return y})),n.d(r,"installSyntheticActiveStateHandler",(function(){return v})),n.d(r,"widget",(function(){return b})),n.d(r,"adapter",(function(){return m})),n.d(r,"getSession",(function(){return g})),n.d(r,"exportAdapter",(function(){return _})),n.d(r,"reloadPage",(function(){return w})),n.d(r,"addObjectFactories",(function(){return k})),n.d(r,"cloneShallow",(function(){return S})),n.d(r,"default",(function(){return O}));var o={};n.r(o),n.d(o,"scout",(function(){return O})),n.d(o,"App",(function(){return E})),n.d(o,"ErrorHandler",(function(){return H})),n.d(o,"RemoteApp",(function(){return q})),n.d(o,"Extension",(function(){return X})),n.d(o,"TypeDescriptor",(function(){return Z})),n.d(o,"ObjectFactory",(function(){return te})),n.d(o,"LoadingSupport",(function(){return oe})),n.d(o,"SimpleLoadingSupport",(function(){return fe})),n.d(o,"ModelAdapter",(function(){return de})),n.d(o,"Widget",(function(){return ve})),n.d(o,"widgets",(function(){return me})),n.d(o,"Composite",(function(){return Ce})),n.d(o,"NullWidget",(function(){return Fe})),n.d(o,"NullWidgetAdapter",(function(){return Le})),n.d(o,"arrays",(function(){return rt})),n.d(o,"Call",(function(){return at})),n.d(o,"clipboard",(function(){return ct})),n.d(o,"colorSchemes",(function(){return dt})),n.d(o,"EventDelegator",(function(){return vt})),n.d(o,"dates",(function(){return Et})),n.d(o,"defaultValues",(function(){return Mt})),n.d(o,"events",(function(){return Nt})),n.d(o,"files",(function(){return Wt})),n.d(o,"Device",(function(){return Kt})),n.d(o,"DoubleClickSupport",(function(){return Yt})),n.d(o,"DragAndDropHandler",(function(){return Zt})),n.d(o,"dragAndDrop",(function(){return rn})),n.d(o,"Event",(function(){return sn})),n.d(o,"EventSupport",(function(){return ln})),n.d(o,"fonts",(function(){return vn})),n.d(o,"icons",(function(){return gn})),n.d(o,"inspector",(function(){return _n})),n.d(o,"locales",(function(){return En})),n.d(o,"logging",(function(){return Xn})),n.d(o,"NullLogger",(function(){return Zn})),n.d(o,"mimeTypes",(function(){return sr})),n.d(o,"models",(function(){return ur})),n.d(o,"numbers",(function(){return pr})),n.d(o,"RoundingMode",(function(){return dr})),n.d(o,"objects",(function(){return Pr})),n.d(o,"polyfills",(function(){return Rr})),n.d(o,"PromiseCreator",(function(){return Er})),n.d(o,"promises",(function(){return Dr})),n.d(o,"Range",(function(){return Fr})),n.d(o,"Status",(function(){return Br})),n.d(o,"DefaultStatus",(function(){return Wr})),n.d(o,"ParsingFailedStatus",(function(){return Xr})),n.d(o,"ValidationFailedStatus",(function(){return no})),n.d(o,"CachedElement",(function(){return oo})),n.d(o,"PlainTextEncoder",(function(){return so})),n.d(o,"HtmlEncoder",(function(){return lo})),n.d(o,"strings",(function(){return Wn})),n.d(o,"styles",(function(){return To})),n.d(o,"TreeSet",(function(){return Po})),n.d(o,"URL",(function(){return xo})),n.d(o,"filters",(function(){return Eo})),n.d(o,"HAlign",(function(){return Do})),n.d(o,"aggregation",(function(){return jo})),n.d(o,"webstorage",(function(){return Ho})),n.d(o,"cookies",(function(){return No})),n.d(o,"ajax",(function(){return Uo})),n.d(o,"AjaxCall",(function(){return ei})),n.d(o,"AjaxError",(function(){return ti})),n.d(o,"LookupCall",(function(){return ri})),n.d(o,"LookupRow",(function(){return ii})),n.d(o,"RestLookupCall",(function(){return pi})),n.d(o,"RemoteLookupCall",(function(){return _i})),n.d(o,"RemoteLookupRequest",(function(){return ki})),n.d(o,"QueryBy",(function(){return Si})),n.d(o,"StaticLookupCall",(function(){return Di})),n.d(o,"PrepopulatedLookupCall",(function(){return Ii})),n.d(o,"HierarchicalLookupResultBuilder",(function(){return Hi})),n.d(o,"Code",(function(){return Wi})),n.d(o,"CodeType",(function(){return Gi})),n.d(o,"codes",(function(){return Qi})),n.d(o,"CodeLookupCall",(function(){return ss})),n.d(o,"BackgroundJobPollingStatus",(function(){return as})),n.d(o,"BackgroundJobPollingSupport",(function(){return us})),n.d(o,"BusyIndicator",(function(){return bs})),n.d(o,"RemoteEvent",(function(){return ms})),n.d(o,"Locale",(function(){return _s})),n.d(o,"PropertyChangeEventFilter",(function(){return ks})),n.d(o,"Reconnector",(function(){return Os})),n.d(o,"ResponseQueue",(function(){return Cs})),n.d(o,"Session",(function(){return xs})),n.d(o,"UserAgent",(function(){return Es})),n.d(o,"WidgetEventTypeFilter",(function(){return As})),n.d(o,"Dimension",(function(){return $s})),n.d(o,"Insets",(function(){return Bs})),n.d(o,"Point",(function(){return Is})),n.d(o,"Rectangle",(function(){return Hs})),n.d(o,"graphics",(function(){return qs})),n.d(o,"HtmlEnvironment",(function(){return Xs})),n.d(o,"AbstractLayout",(function(){return Zs})),n.d(o,"HtmlComponent",(function(){return ea})),n.d(o,"LayoutConstants",(function(){return ta})),n.d(o,"LayoutValidator",(function(){return ra})),n.d(o,"LogicalGrid",(function(){return ia})),n.d(o,"LogicalGridConfig",(function(){return aa})),n.d(o,"LogicalGridData",(function(){return ua})),n.d(o,"LogicalGridLayout",(function(){return ba})),n.d(o,"LogicalGridLayoutConfig",(function(){return ga})),n.d(o,"LogicalGridLayoutInfo",(function(){return wa})),n.d(o,"AbstractGrid",(function(){return Ra})),n.d(o,"HorizontalGrid",(function(){return ja})),n.d(o,"VerticalSmartGrid",(function(){return Va})),n.d(o,"LogicalGridMatrix",(function(){return za})),n.d(o,"LogicalGridMatrixCell",(function(){return Ua})),n.d(o,"LogicalGridMatrixCursor",(function(){return Ya})),n.d(o,"HorizontalGridMatrix",(function(){return nl})),n.d(o,"VerticalGridMatrix",(function(){return ul})),n.d(o,"ColumnLayout",(function(){return vl})),n.d(o,"NullLayout",(function(){return Sl})),n.d(o,"RowLayout",(function(){return El})),n.d(o,"SingleLayout",(function(){return Ml})),n.d(o,"FlexboxLayout",(function(){return zl})),n.d(o,"FlexboxLayoutData",(function(){return Ul})),n.d(o,"SimpleTabBoxController",(function(){return ql})),n.d(o,"SimpleTabBox",(function(){return nu})),n.d(o,"SimpleTabBoxLayout",(function(){return uu})),n.d(o,"SimpleTabViewContentLayout",(function(){return bu})),n.d(o,"keys",(function(){return Ou})),n.d(o,"Key",(function(){return Cu})),n.d(o,"keyStrokeModifier",(function(){return Ru})),n.d(o,"VirtualKeyStrokeEvent",(function(){return Eu})),n.d(o,"KeyStrokeManager",(function(){return Au})),n.d(o,"KeyStrokeContext",(function(){return $u})),n.d(o,"InputFieldKeyStrokeContext",(function(){return Vu})),n.d(o,"KeyStroke",(function(){return zu})),n.d(o,"RangeKeyStroke",(function(){return Ju})),n.d(o,"ContextMenuKeyStroke",(function(){return ic})),n.d(o,"ClickActiveElementKeyStroke",(function(){return pc})),n.d(o,"FocusAdjacentElementKeyStroke",(function(){return _c})),n.d(o,"CloseKeyStroke",(function(){return Pc})),n.d(o,"AbortKeyStroke",(function(){return $c})),n.d(o,"TabItemKeyStroke",(function(){return Vc})),n.d(o,"Accordion",(function(){return Jc})),n.d(o,"AccordionAdapter",(function(){return rf})),n.d(o,"AccordionLayout",(function(){return pf})),n.d(o,"BoxButtons",(function(){return yf})),n.d(o,"Carousel",(function(){return Sf})),n.d(o,"CarouselLayout",(function(){return Ef})),n.d(o,"Cell",(function(){return Af})),n.d(o,"CollapseHandle",(function(){return Hf})),n.d(o,"FocusManager",(function(){return Vf})),n.d(o,"FocusContext",(function(){return zf})),n.d(o,"focusUtils",(function(){return Uf})),n.d(o,"FocusRule",(function(){return Kf})),n.d(o,"GlassPane",(function(){return th})),n.d(o,"DeferredGlassPaneTarget",(function(){return rh})),n.d(o,"GlassPaneRenderer",(function(){return ih})),n.d(o,"IFrame",(function(){return dh})),n.d(o,"Scrollbar",(function(){return Sh})),n.d(o,"scrollbars",(function(){return Lh})),n.d(o,"VirtualScrolling",(function(){return Nh})),n.d(o,"Splitter",(function(){return Xh})),n.d(o,"DateFormatPatternType",(function(){return Jh})),n.d(o,"DateFormatPatternDefinition",(function(){return Qh})),n.d(o,"DateFormat",(function(){return tp})),n.d(o,"DecimalFormat",(function(){return rp})),n.d(o,"TextMap",(function(){return ip})),n.d(o,"texts",(function(){return bp})),n.d(o,"Tooltip",(function(){return Tp})),n.d(o,"TooltipSupport",(function(){return Pp})),n.d(o,"tooltips",(function(){return xp})),n.d(o,"WidgetTooltip",(function(){return Mp})),n.d(o,"Action",(function(){return Up})),n.d(o,"ActionAdapter",(function(){return ed})),n.d(o,"ActionKeyStroke",(function(){return ld})),n.d(o,"Box",(function(){return cd})),n.d(o,"Label",(function(){return md})),n.d(o,"LabelAdapter",(function(){return Cd})),n.d(o,"Popup",(function(){return Id})),n.d(o,"PopupAdapter",(function(){return Ud})),n.d(o,"PopupLayout",(function(){return Qd})),n.d(o,"PopupManager",(function(){return ay})),n.d(o,"PopupManagerAdapter",(function(){return py})),n.d(o,"PopupWithHead",(function(){return wy})),n.d(o,"PopupWithHeadLayout",(function(){return xy})),n.d(o,"TouchPopup",(function(){return Iy})),n.d(o,"TouchPopupLayout",(function(){return Uy})),n.d(o,"WidgetPopup",(function(){return tv})),n.d(o,"WidgetPopupAdapter",(function(){return av})),n.d(o,"WidgetPopupLayout",(function(){return yv})),n.d(o,"MobilePopup",(function(){return Sv})),n.d(o,"MobilePopupAdapter",(function(){return Ev})),n.d(o,"MobilePopupLayout",(function(){return Iv})),n.d(o,"DatePicker",(function(){return Uv})),n.d(o,"DatePickerPopup",(function(){return eb})),n.d(o,"DatePickerPopupLayout",(function(){return lb})),n.d(o,"DatePickerTouchPopup",(function(){return vb})),n.d(o,"DatePickerTouchPopupLayout",(function(){return Sb})),n.d(o,"Group",(function(){return Db})),n.d(o,"GroupAdapter",(function(){return Mb})),n.d(o,"GroupLayout",(function(){return zb})),n.d(o,"GroupToggleCollapseKeyStroke",(function(){return Jb})),n.d(o,"Icon",(function(){return im})),n.d(o,"IconDesc",(function(){return lm})),n.d(o,"Image",(function(){return vm})),n.d(o,"ImageLayout",(function(){return Om})),n.d(o,"Notification",(function(){return Am})),n.d(o,"NotificationAdapter",(function(){return Hm})),n.d(o,"menus",(function(){return zm})),n.d(o,"MenuDestinations",(function(){return Gm})),n.d(o,"Menu",(function(){return eg})),n.d(o,"EllipsisMenu",(function(){return lg})),n.d(o,"MenuAdapter",(function(){return dg})),n.d(o,"MenuKeyStroke",(function(){return kg})),n.d(o,"MenuExecKeyStroke",(function(){return Eg})),n.d(o,"MenuItemsOrder",(function(){return Ag})),n.d(o,"ComboMenu",(function(){return Lg})),n.d(o,"ComboMenuAdapter",(function(){return Gg})),n.d(o,"ContextMenuPopup",(function(){return Qg})),n.d(o,"ContextMenuPopupLayout",(function(){return a_})),n.d(o,"MenuNavigationKeyStroke",(function(){return y_})),n.d(o,"MenuNavigationExecKeyStroke",(function(){return k_})),n.d(o,"MenuExecByNumberKeyStroke",(function(){return E_})),n.d(o,"MenuNavigationDownKeyStroke",(function(){return M_})),n.d(o,"MenuNavigationUpKeyStroke",(function(){return z_})),n.d(o,"SubCloseKeyStroke",(function(){return Z_})),n.d(o,"menuNavigationKeyStrokes",(function(){return Q_})),n.d(o,"ButtonAdapterMenu",(function(){return lw})),n.d(o,"FormFieldMenu",(function(){return vw})),n.d(o,"FormFieldMenuAdapter",(function(){return Ow})),n.d(o,"MenuBox",(function(){return Aw})),n.d(o,"MenuBoxLayout",(function(){return Lw})),n.d(o,"MenuBar",(function(){return Yw})),n.d(o,"MenuBarLayout",(function(){return ok})),n.d(o,"MenuBarLeftKeyStroke",(function(){return fk})),n.d(o,"MenuBarRightKeyStroke",(function(){return mk})),n.d(o,"MenuBarPopup",(function(){return Pk})),n.d(o,"MenubarBox",(function(){return Bk})),n.d(o,"MenubarBoxLayout",(function(){return Wk})),n.d(o,"Calendar",(function(){return Zk})),n.d(o,"CalendarAdapter",(function(){return sS})),n.d(o,"CalendarComponent",(function(){return dS})),n.d(o,"CalendarComponentAdapter",(function(){return _S})),n.d(o,"CalendarListComponent",(function(){return kS})),n.d(o,"CalendarLayout",(function(){return xS})),n.d(o,"CalendarModeMenu",(function(){return BS})),n.d(o,"CalendarModesMenu",(function(){return zS})),n.d(o,"DateRange",(function(){return US})),n.d(o,"YearPanel",(function(){return eO})),n.d(o,"Lifecycle",(function(){return nO})),n.d(o,"Planner",(function(){return fO})),n.d(o,"PlannerAdapter",(function(){return gO})),n.d(o,"PlannerHeader",(function(){return CO})),n.d(o,"PlannerLayout",(function(){return FO})),n.d(o,"PlannerMenuItemsOrder",(function(){return LO})),n.d(o,"FileChooser",(function(){return KO})),n.d(o,"FileChooserAdapter",(function(){return tT})),n.d(o,"FileChooserController",(function(){return rT})),n.d(o,"FileInput",(function(){return fT})),n.d(o,"Route",(function(){return pT})),n.d(o,"router",(function(){return gT})),n.d(o,"Slider",(function(){return PT})),n.d(o,"SliderAdapter",(function(){return FT})),n.d(o,"SliderLayout",(function(){return HT})),n.d(o,"Mode",(function(){return qT})),n.d(o,"ModeAdapter",(function(){return eC})),n.d(o,"ModeSelector",(function(){return uC})),n.d(o,"ModeSelectorLayout",(function(){return bC})),n.d(o,"Form",(function(){return CC})),n.d(o,"FormAdapter",(function(){return $C})),n.d(o,"FormGrid",(function(){return NC})),n.d(o,"FormLayout",(function(){return qC})),n.d(o,"FormMenuActionKeyStroke",(function(){return tP})),n.d(o,"FormMenu",(function(){return uP})),n.d(o,"FormMenuAdapter",(function(){return yP})),n.d(o,"FormMenuPopup",(function(){return OP})),n.d(o,"FormMenuPopupLayout",(function(){return AP})),n.d(o,"FormLifecycle",(function(){return HP})),n.d(o,"CancelMenu",(function(){return qP})),n.d(o,"CloseMenu",(function(){return nR})),n.d(o,"OkMenu",(function(){return cR})),n.d(o,"ResetMenu",(function(){return mR})),n.d(o,"SaveMenu",(function(){return CR})),n.d(o,"DialogLayout",(function(){return jR})),n.d(o,"ResponsiveManager",(function(){return MR})),n.d(o,"ResponsiveHandler",(function(){return LR})),n.d(o,"GroupBoxResponsiveHandler",(function(){return qR})),n.d(o,"DesktopResponsiveHandler",(function(){return nx})),n.d(o,"TileOverviewForm",(function(){return cx})),n.d(o,"TileOverviewFormAdapter",(function(){return vx})),n.d(o,"Table",(function(){return Cx})),n.d(o,"TableAdapter",(function(){return $x})),n.d(o,"TableCompactHandler",(function(){return Bx})),n.d(o,"TableRow",(function(){return Ix})),n.d(o,"TableMatrix",(function(){return Nx})),n.d(o,"TableFooter",(function(){return Xx})),n.d(o,"TableFooterLayout",(function(){return rE})),n.d(o,"TableInfoFilterTooltip",(function(){return fE})),n.d(o,"TableInfoLoadTooltip",(function(){return gE})),n.d(o,"TableInfoSelectionTooltip",(function(){return PE})),n.d(o,"TableHeader",(function(){return BE})),n.d(o,"TableHeaderMenu",(function(){return UE})),n.d(o,"TableHeaderMenuLayout",(function(){return eD})),n.d(o,"TableHeaderMenuGroup",(function(){return lD})),n.d(o,"TableHeaderMenuButton",(function(){return vD})),n.d(o,"TableHeaderMenuButtonKeyStroke",(function(){return SD})),n.d(o,"TableLayout",(function(){return DD})),n.d(o,"TableSelectionHandler",(function(){return FD})),n.d(o,"TableTileGridMediator",(function(){return VD})),n.d(o,"TableTileGridMediatorAdapter",(function(){return YD})),n.d(o,"TableRowDetail",(function(){return oA})),n.d(o,"TableRowTileMapping",(function(){return cA})),n.d(o,"TableRowTileMappingAdapter",(function(){return vA})),n.d(o,"TableTooltip",(function(){return OA})),n.d(o,"TableUpdateBuffer",(function(){return CA})),n.d(o,"TileTableHeaderGroupByLookupCall",(function(){return $A})),n.d(o,"TileTableHeaderSortByLookupCall",(function(){return VA})),n.d(o,"comparators",(function(){return GA})),n.d(o,"Column",(function(){return qA})),n.d(o,"ColumnOptimalWidthMeasurer",(function(){return XA})),n.d(o,"AlphanumericSortingStringColumn",(function(){return nF})),n.d(o,"BeanColumn",(function(){return cF})),n.d(o,"BooleanColumn",(function(){return mF})),n.d(o,"CompactColumn",(function(){return TF})),n.d(o,"CompactBean",(function(){return xF})),n.d(o,"CompactLine",(function(){return DF})),n.d(o,"CompactLineBlock",(function(){return FF})),n.d(o,"DateColumn",(function(){return NF})),n.d(o,"IconColumn",(function(){return YF})),n.d(o,"NumberColumn",(function(){return r$})),n.d(o,"SmartColumn",(function(){return f$})),n.d(o,"TableControlActionKeyStroke",(function(){return m$})),n.d(o,"TableControl",(function(){return P$})),n.d(o,"TableControlAdapter",(function(){return $$})),n.d(o,"TableControlAdapterMenu",(function(){return W$})),n.d(o,"AggregateTableControl",(function(){return Z$})),n.d(o,"AggregateTableControlAdapter",(function(){return ij})),n.d(o,"FormTableControl",(function(){return dj})),n.d(o,"FormTableControlAdapter",(function(){return _j})),n.d(o,"FormTableControlLayout",(function(){return Pj})),n.d(o,"CellEditorPopup",(function(){return Bj})),n.d(o,"CellEditorPopupLayout",(function(){return Wj})),n.d(o,"CellEditorCancelEditKeyStroke",(function(){return Xj})),n.d(o,"CellEditorCompleteEditKeyStroke",(function(){return rB})),n.d(o,"CellEditorTabKeyStroke",(function(){return fB})),n.d(o,"AbstractTableNavigationKeyStroke",(function(){return gB})),n.d(o,"TableControlCloseKeyStroke",(function(){return CB})),n.d(o,"TableCopyKeyStroke",(function(){return FB})),n.d(o,"TableNavigationCollapseKeyStroke",(function(){return VB})),n.d(o,"TableNavigationExpandKeyStroke",(function(){return JB})),n.d(o,"TableSelectAllKeyStroke",(function(){return iM})),n.d(o,"TableStartCellEditKeyStroke",(function(){return dM})),n.d(o,"TableRefreshKeyStroke",(function(){return SM})),n.d(o,"TableToggleRowKeyStroke",(function(){return DM})),n.d(o,"TableNavigationUpKeyStroke",(function(){return LM})),n.d(o,"TableNavigationDownKeyStroke",(function(){return KM})),n.d(o,"TableNavigationHomeKeyStroke",(function(){return tI})),n.d(o,"TableNavigationEndKeyStroke",(function(){return uI})),n.d(o,"TableNavigationPageUpKeyStroke",(function(){return bI})),n.d(o,"TableNavigationPageDownKeyStroke",(function(){return TI})),n.d(o,"TableFocusFilterFieldKeyStroke",(function(){return AI})),n.d(o,"TableFilter",(function(){return $I})),n.d(o,"TableUserFilter",(function(){return NI})),n.d(o,"ColumnUserFilter",(function(){return YI})),n.d(o,"DateColumnUserFilter",(function(){return rL})),n.d(o,"NumberColumnUserFilter",(function(){return fL})),n.d(o,"TextColumnUserFilter",(function(){return gL})),n.d(o,"TableTextUserFilter",(function(){return PL})),n.d(o,"TileTableHierarchyFilter",(function(){return jL})),n.d(o,"KeyTableFilter",(function(){return VL})),n.d(o,"TextTableFilter",(function(){return YL})),n.d(o,"TimePicker",(function(){return rH})),n.d(o,"TimePickerPopup",(function(){return fH})),n.d(o,"TimePickerPopupLayout",(function(){return gH})),n.d(o,"TimePickerTouchPopup",(function(){return PH})),n.d(o,"TimePickerTouchPopupLayout",(function(){return jH})),n.d(o,"Tree",(function(){return KH})),n.d(o,"TreeAdapter",(function(){return tN})),n.d(o,"TreeNode",(function(){return rN})),n.d(o,"TreeLayout",(function(){return cN})),n.d(o,"LazyNodeFilter",(function(){return hN})),n.d(o,"TreeBreadcrumbFilter",(function(){return dN})),n.d(o,"AbstractTreeNavigationKeyStroke",(function(){return kN})),n.d(o,"TreeSpaceKeyStroke",(function(){return EN})),n.d(o,"TreeNavigationUpKeyStroke",(function(){return IN})),n.d(o,"TreeNavigationDownKeyStroke",(function(){return UN})),n.d(o,"TreeNavigationEndKeyStroke",(function(){return eV})),n.d(o,"TreeCollapseAllKeyStroke",(function(){return lV})),n.d(o,"TreeCollapseOrDrillUpKeyStroke",(function(){return vV})),n.d(o,"TreeExpandOrDrillDownKeyStroke",(function(){return TV})),n.d(o,"CompactTree",(function(){return FV})),n.d(o,"CompactTreeNode",(function(){return HV})),n.d(o,"AbstractCompactTreeControlKeyStroke",(function(){return qV})),n.d(o,"CompactTreeUpKeyStroke",(function(){return tW})),n.d(o,"CompactTreeDownKeyStroke",(function(){return lW})),n.d(o,"CompactTreeLeftKeyStroke",(function(){return yW})),n.d(o,"CompactTreeRightKeyStroke",(function(){return kW})),n.d(o,"fields",(function(){return TW})),n.d(o,"AppLinkKeyStroke",(function(){return FW})),n.d(o,"FieldStatus",(function(){return VW})),n.d(o,"FormField",(function(){return ZW})),n.d(o,"FormFieldAdapter",(function(){return sz})),n.d(o,"FormFieldLayout",(function(){return dz})),n.d(o,"StatusMenuMapping",(function(){return kz})),n.d(o,"StatusMenuMappingAdapter",(function(){return Rz})),n.d(o,"GridData",(function(){return Ez})),n.d(o,"CompositeField",(function(){return Iz})),n.d(o,"CompositeFieldAdapter",(function(){return zz})),n.d(o,"ValueField",(function(){return Qz})),n.d(o,"ValueFieldAdapter",(function(){return aG})),n.d(o,"BasicField",(function(){return yG})),n.d(o,"BasicFieldAdapter",(function(){return wG})),n.d(o,"WidgetField",(function(){return xG})),n.d(o,"WidgetFieldAdapter",(function(){return jG})),n.d(o,"WidgetFieldLayout",(function(){return WG})),n.d(o,"LookupBox",(function(){return JG})),n.d(o,"LookupBoxLayout",(function(){return oU})),n.d(o,"TreeVisitResult",(function(){return iU})),n.d(o,"FormController",(function(){return aU})),n.d(o,"MessageBox",(function(){return yU})),n.d(o,"MessageBoxAdapter",(function(){return SU})),n.d(o,"MessageBoxController",(function(){return TU})),n.d(o,"MessageBoxes",(function(){return PU})),n.d(o,"MessageBoxLayout",(function(){return $U})),n.d(o,"CopyKeyStroke",(function(){return NU})),n.d(o,"AccordionField",(function(){return YU})),n.d(o,"AccordionFieldAdapter",(function(){return tK})),n.d(o,"BeanField",(function(){return uK})),n.d(o,"BeanFieldAdapter",(function(){return bK})),n.d(o,"BrowserField",(function(){return TK})),n.d(o,"BrowserFieldAdapter",(function(){return FK})),n.d(o,"BrowserFieldLayout",(function(){return NK})),n.d(o,"Button",(function(){return JK})),n.d(o,"ButtonLayout",(function(){return iq})),n.d(o,"ButtonAdapter",(function(){return pq})),n.d(o,"ButtonKeyStroke",(function(){return kq})),n.d(o,"CalendarField",(function(){return xq})),n.d(o,"CalendarFieldAdapter",(function(){return jq})),n.d(o,"CarouselField",(function(){return Vq})),n.d(o,"CheckBoxField",(function(){return Jq})),n.d(o,"CheckBoxFieldAdapter",(function(){return rY})),n.d(o,"CheckBoxToggleKeyStroke",(function(){return fY})),n.d(o,"ClipboardField",(function(){return _Y})),n.d(o,"ClipboardFieldAdapter",(function(){return CY})),n.d(o,"ColorField",(function(){return FY})),n.d(o,"ColorFieldAdapter",(function(){return LY})),n.d(o,"DatePredictionFailedStatus",(function(){return GY})),n.d(o,"DateField",(function(){return eX})),n.d(o,"DateFieldAdapter",(function(){return lX})),n.d(o,"DateTimeCompositeLayout",(function(){return vX})),n.d(o,"FileChooserButton",(function(){return OX})),n.d(o,"FileChooserButtonAdapter",(function(){return AX})),n.d(o,"FileChooserField",(function(){return HX})),n.d(o,"FileChooserFieldAdapter",(function(){return qX})),n.d(o,"FileChooserFieldBrowseKeyStroke",(function(){return nJ})),n.d(o,"FileChooserFieldDeleteKeyStroke",(function(){return cJ})),n.d(o,"GroupBox",(function(){return gJ})),n.d(o,"GroupBoxGridConfig",(function(){return CJ})),n.d(o,"GroupBoxAdapter",(function(){return $J})),n.d(o,"GroupBoxLayout",(function(){return VJ})),n.d(o,"GroupBoxMenuItemsOrder",(function(){return zJ})),n.d(o,"HtmlField",(function(){return ZJ})),n.d(o,"HtmlFieldAdapter",(function(){return sZ})),n.d(o,"ImageField",(function(){return dZ})),n.d(o,"ImageFieldAdapter",(function(){return kZ})),n.d(o,"ImageFieldLayout",(function(){return EZ})),n.d(o,"LabelField",(function(){return IZ})),n.d(o,"LabelFieldAdapter",(function(){return UZ})),n.d(o,"ListBox",(function(){return eQ})),n.d(o,"ListBoxAdapter",(function(){return sQ})),n.d(o,"ListBoxLayout",(function(){return hQ})),n.d(o,"lookupField",(function(){return dQ})),n.d(o,"LookupFieldAdapter",(function(){return wQ})),n.d(o,"ModeSelectorField",(function(){return xQ})),n.d(o,"ModeSelectorFieldAdapter",(function(){return MQ})),n.d(o,"NumberField",(function(){return GQ})),n.d(o,"NumberFieldAdapter",(function(){return QQ})),n.d(o,"Calculator",(function(){return t0})),n.d(o,"IntegerField",(function(){return c0})),n.d(o,"PlaceholderField",(function(){return b0})),n.d(o,"PlaceholderFieldAdapter",(function(){return S0})),n.d(o,"PlannerField",(function(){return E0})),n.d(o,"PlannerFieldAdapter",(function(){return B0})),n.d(o,"RadioButton",(function(){return G0})),n.d(o,"RadioButtonLayout",(function(){return Q0})),n.d(o,"RadioButtonAdapter",(function(){return i1})),n.d(o,"RadioButtonGroup",(function(){return y1})),n.d(o,"RadioButtonGroupAdapter",(function(){return S1})),n.d(o,"RadioButtonGroupGridConfig",(function(){return E1})),n.d(o,"RadioButtonGroupLayout",(function(){return I1})),n.d(o,"RadioButtonGroupLeftOrUpKeyStroke",(function(){return G1})),n.d(o,"RadioButtonGroupRightOrDownKeyStroke",(function(){return Z1})),n.d(o,"RadioButtonKeyStroke",(function(){return s2})),n.d(o,"SequenceBox",(function(){return d2})),n.d(o,"SequenceBoxGridConfig",(function(){return w2})),n.d(o,"SequenceBoxLayout",(function(){return x2})),n.d(o,"SequenceBoxAdapter",(function(){return M2})),n.d(o,"SliderField",(function(){return G2})),n.d(o,"SmartField",(function(){return e3})),n.d(o,"SmartFieldAdapter",(function(){return l3})),n.d(o,"SmartFieldLayout",(function(){return v3})),n.d(o,"SmartFieldCancelKeyStroke",(function(){return T3})),n.d(o,"SmartFieldPopup",(function(){return F3})),n.d(o,"SmartFieldTouchPopup",(function(){return N3})),n.d(o,"SmartFieldPopupLayout",(function(){return Y3})),n.d(o,"SmartFieldMultiline",(function(){return r5})),n.d(o,"SmartFieldMultilineAdapter",(function(){return u5})),n.d(o,"SmartFieldMultilineLayout",(function(){return b5})),n.d(o,"ProposalField",(function(){return T5})),n.d(o,"ProposalFieldAdapter",(function(){return D5})),n.d(o,"ProposalTreeNode",(function(){return L5})),n.d(o,"ProposalChooser",(function(){return K5})),n.d(o,"ProposalChooserLayout",(function(){return e4})),n.d(o,"TableProposalChooser",(function(){return a4})),n.d(o,"TableLayoutResetter",(function(){return u4})),n.d(o,"TreeProposalChooser",(function(){return v4})),n.d(o,"TreeLayoutResetter",(function(){return m4})),n.d(o,"SplitBox",(function(){return P4})),n.d(o,"SplitBoxAdapter",(function(){return j4})),n.d(o,"SplitBoxCollapseKeyStroke",(function(){return V4})),n.d(o,"SplitBoxFirstCollapseKeyStroke",(function(){return Y4})),n.d(o,"SplitBoxSecondCollapseKeyStroke",(function(){return n6})),n.d(o,"SplitBoxLayout",(function(){return u6})),n.d(o,"StringField",(function(){return g6})),n.d(o,"StringFieldLayout",(function(){return P6})),n.d(o,"StringFieldAdapter",(function(){return j6})),n.d(o,"StringFieldEnterKeyStroke",(function(){return W6})),n.d(o,"StringFieldCtrlEnterKeyStroke",(function(){return J6})),n.d(o,"TabBox",(function(){return s9})),n.d(o,"TabAreaLeftKeyStroke",(function(){return p9})),n.d(o,"TabAreaRightKeyStroke",(function(){return _9})),n.d(o,"TabBoxAdapter",(function(){return R9})),n.d(o,"TabBoxHeaderLayout",(function(){return B9})),n.d(o,"TabBoxHeader",(function(){return G9})),n.d(o,"Tab",(function(){return e8})),n.d(o,"TabArea",(function(){return u8})),n.d(o,"TabAreaLayout",(function(){return b8})),n.d(o,"TabBoxLayout",(function(){return T8})),n.d(o,"TabItem",(function(){return F8})),n.d(o,"TabItemAdapter",(function(){return L8})),n.d(o,"TabItemLayout",(function(){return U8})),n.d(o,"TableField",(function(){return t7})),n.d(o,"TableFieldAdapter",(function(){return a7})),n.d(o,"TagChooserPopup",(function(){return y7})),n.d(o,"TagChooserPopupLayout",(function(){return S7})),n.d(o,"TagField",(function(){return D7})),n.d(o,"TagFieldAdapter",(function(){return L7})),n.d(o,"TagFieldCancelKeyStroke",(function(){return q7})),n.d(o,"TagFieldEnterKeyStroke",(function(){return nee})),n.d(o,"TagFieldDeleteKeyStroke",(function(){return cee})),n.d(o,"TagFieldNavigationKeyStroke",(function(){return mee})),n.d(o,"TagFieldOpenPopupKeyStroke",(function(){return Cee})),n.d(o,"TagFieldLayout",(function(){return Fee})),n.d(o,"TagFieldContainerLayout",(function(){return Hee})),n.d(o,"TileField",(function(){return qee})),n.d(o,"TileFieldAdapter",(function(){return ete})),n.d(o,"TreeBox",(function(){return lte})),n.d(o,"TreeBoxAdapter",(function(){return dte})),n.d(o,"TreeBoxLayout",(function(){return _te})),n.d(o,"TreeField",(function(){return Pte})),n.d(o,"TreeFieldAdapter",(function(){return Fte})),n.d(o,"WizardProgressField",(function(){return Nte})),n.d(o,"WizardProgressFieldAdapter",(function(){return Yte})),n.d(o,"WizardProgressFieldLayout",(function(){return rne})),n.d(o,"WrappedFormField",(function(){return hne})),n.d(o,"WrappedFormFieldAdapter",(function(){return mne})),n.d(o,"Switch",(function(){return Cne})),n.d(o,"TagBar",(function(){return $ne})),n.d(o,"TagBarLayout",(function(){return Nne})),n.d(o,"TagBarOverflowPopup",(function(){return Yne})),n.d(o,"Tile",(function(){return rre})),n.d(o,"TileAdapter",(function(){return ure})),n.d(o,"TileGrid",(function(){return gre})),n.d(o,"TileGridAdapter",(function(){return Pre})),n.d(o,"TileGridGridConfig",(function(){return $re})),n.d(o,"TileGridLayout",(function(){return Vre})),n.d(o,"TileGridLayoutConfig",(function(){return Xre})),n.d(o,"TileGridSelectionHandler",(function(){return Zre})),n.d(o,"HtmlTile",(function(){return soe})),n.d(o,"HtmlTileAdapter",(function(){return hoe})),n.d(o,"BeanTile",(function(){return _oe})),n.d(o,"BeanTileAdapter",(function(){return Roe})),n.d(o,"TileAccordion",(function(){return Moe})),n.d(o,"TileAccordionAdapter",(function(){return Goe})),n.d(o,"TileAccordionSelectionHandler",(function(){return Zoe})),n.d(o,"TileGridSelectKeyStroke",(function(){return aie})),n.d(o,"TileGridSelectAllKeyStroke",(function(){return vie})),n.d(o,"TileGridSelectLeftKeyStroke",(function(){return Oie})),n.d(o,"TileGridSelectRightKeyStroke",(function(){return Aie})),n.d(o,"TileGridSelectDownKeyStroke",(function(){return Hie})),n.d(o,"TileGridSelectUpKeyStroke",(function(){return qie})),n.d(o,"TileGridSelectFirstKeyStroke",(function(){return nse})),n.d(o,"TileGridSelectLastKeyStroke",(function(){return cse})),n.d(o,"RemoteTileFilter",(function(){return hse})),n.d(o,"WidgetTile",(function(){return wse})),n.d(o,"WidgetTileAdapter",(function(){return Pse})),n.d(o,"PlaceholderTile",(function(){return jse})),n.d(o,"FormFieldTile",(function(){return Wse})),n.d(o,"FormFieldTileAdapter",(function(){return Yse})),n.d(o,"TileButton",(function(){return rae})),n.d(o,"TileTableField",(function(){return hae})),n.d(o,"Desktop",(function(){return kae})),n.d(o,"DesktopAdapter",(function(){return Eae})),n.d(o,"DesktopLogo",(function(){return Lae})),n.d(o,"DesktopLayout",(function(){return Uae})),n.d(o,"DesktopTabBoxController",(function(){return Qae})),n.d(o,"DisableBrowserF5ReloadKeyStroke",(function(){return sle})),n.d(o,"PopupWindow",(function(){return lle})),n.d(o,"OpenUriHandler",(function(){return cle})),n.d(o,"DesktopBench",(function(){return _le})),n.d(o,"BenchColumn",(function(){return Ele})),n.d(o,"BenchRowLayoutData",(function(){return Ile})),n.d(o,"BenchColumnLayoutData",(function(){return Hle})),n.d(o,"DesktopTabSelectKeyStroke",(function(){return Yle})),n.d(o,"DisableBrowserTabSwitchingKeyStroke",(function(){return rue})),n.d(o,"DesktopHeader",(function(){return hue})),n.d(o,"HeaderTabBoxController",(function(){return wue})),n.d(o,"DesktopHeaderLayout",(function(){return Rue})),n.d(o,"DesktopNavigation",(function(){return Iue})),n.d(o,"DesktopNavigationHandle",(function(){return Uue})),n.d(o,"DesktopNavigationLayout",(function(){return Que})),n.d(o,"ShrinkNavigationKeyStroke",(function(){return ace})),n.d(o,"EnlargeNavigationKeyStroke",(function(){return yce})),n.d(o,"DesktopNotification",(function(){return Sce})),n.d(o,"DesktopNotificationAdapter",(function(){return xce})),n.d(o,"OfflineDesktopNotification",(function(){return Mce})),n.d(o,"PopupBlockerHandler",(function(){return Lce})),n.d(o,"PopupBlockerDesktopNotification",(function(){return Kce})),n.d(o,"DesktopToolBox",(function(){return tfe})),n.d(o,"ViewButtonActionKeyStroke",(function(){return ufe})),n.d(o,"ViewButton",(function(){return bfe})),n.d(o,"ViewButtonAdapter",(function(){return Sfe})),n.d(o,"ViewButtonBox",(function(){return Afe})),n.d(o,"ViewButtonBoxLayout",(function(){return Lfe})),n.d(o,"ViewMenuOpenKeyStroke",(function(){return Kfe})),n.d(o,"ViewMenuPopup",(function(){return nhe})),n.d(o,"ViewMenuPopupLayout",(function(){return che})),n.d(o,"ViewMenuTab",(function(){return mhe})),n.d(o,"Page",(function(){return Che})),n.d(o,"PageWithNodes",(function(){return Fhe})),n.d(o,"PageWithTable",(function(){return Nhe})),n.d(o,"PageTileButton",(function(){return Yhe})),n.d(o,"PageTileGrid",(function(){return ope})),n.d(o,"PageTileGridSelectKeyStroke",(function(){return ppe})),n.d(o,"AutoLeafPageWithNodes",(function(){return wpe})),n.d(o,"SimpleTab",(function(){return Epe})),n.d(o,"DesktopTab",(function(){return Ipe})),n.d(o,"SimpleTabArea",(function(){return Upe})),n.d(o,"SimpleTabAreaLayout",(function(){return ede})),n.d(o,"DetailTableTreeFilter",(function(){return nde})),n.d(o,"Outline",(function(){return fde})),n.d(o,"OutlineAdapter",(function(){return _de})),n.d(o,"OutlineMediator",(function(){return kde})),n.d(o,"OutlineLayout",(function(){return Ede})),n.d(o,"OutlineViewButton",(function(){return Ide})),n.d(o,"OutlineViewButtonAdapter",(function(){return Gde})),n.d(o,"OutlineTileField",(function(){return Zde})),n.d(o,"OutlineTileFieldAdapter",(function(){return oye})),n.d(o,"PageLayout",(function(){return fye})),n.d(o,"SearchOutline",(function(){return gye})),n.d(o,"SearchOutlineAdapter",(function(){return Pye})),n.d(o,"SearchOutlineLayout",(function(){return jye})),n.d(o,"NavigateButton",(function(){return Wye})),n.d(o,"NavigateDownButton",(function(){return Zye})),n.d(o,"NavigateUpButton",(function(){return sve})),n.d(o,"OutlineKeyStrokeContext",(function(){return dve})),n.d(o,"OutlineNavigateToTopKeyStroke",(function(){return kve})),n.d(o,"OutlineOverview",(function(){return Eve})),n.d(o,"TileOutlineOverview",(function(){return Ive})),n.d(o,"DesktopFormController",(function(){return Kve})),n.d(o,"FilterFieldsGroupBox",(function(){return tbe})),n.d(o,"Resizable",(function(){return obe})),n.d(o,"UnsavedFormChangesForm",(function(){return hbe})),n.d(o,"UnsavedFormsLookupCall",(function(){return gbe})),n.d(o,"TileTableHeaderBox",(function(){return Rbe})),n.d(o,"LoginApp",(function(){return Bbe})),n.d(o,"LoginBox",(function(){return Gbe})),n.d(o,"LogoutApp",(function(){return Qbe})),n.d(o,"LogoutBox",(function(){return ame})),n.d(o,"BreadcrumbItem",(function(){return yme})),n.d(o,"BreadcrumbItemAdapter",(function(){return wme})),n.d(o,"BreadcrumbBar",(function(){return xme})),n.d(o,"BreadcrumbBarLayout",(function(){return Ime})),n.d(o,"BreadcrumbBarAdapter",(function(){return zme})),n.d(o,"BreadcrumbBarField",(function(){return Jme})),n.d(o,"BreadcrumbBarFieldAdapter",(function(){return rge})),n.d(o,"default",(function(){return _ge}));var i=n(0),s=n.n(i),a=null,l={};function u(){for(var e,t=0;t<arguments.length&&null==(e=t<0||arguments.length<=t?void 0:arguments[t]);t++);return e}function c(e,t,n){if(Pr.isNullOrUndefined(t))throw new Error("Missing required parameter '"+e+"'");if(n&&!(t instanceof n))throw new Error("Parameter '"+e+"' has wrong type");return t}function f(e,t,n){var r=e[t];if(Pr.isNullOrUndefined(r))throw new Error("Missing required property '"+t+"'");if(n&&!(r instanceof n))throw new Error("Property '"+t+"' has wrong type");return r}function h(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];if(0===n.length)return!1;var o=n;return 1===n.length&&Array.isArray(n[0])&&(o=n[0]),-1!==o.indexOf(e)}function p(e,t,n){return te.get().create(e,t,n)}function d(e){if(e=e||document,s()("noscript",e).remove(),s()("scout-text",e).remove(),s()("scout-version",e).remove(),s()("body",e).addDeviceClass(),Kt.get().browser===Kt.Browser.CHROME){var t='<meta name="google" content="notranslate" />',n=s()("head > title",e);0===n.length?s()("head",e).append(t):n.after(t)}}function y(e){e.addEventListener("mousedown",(function(e){Qz.invokeValueFieldAboutToBlurByMouseDown(e.target||e.srcElement)}),!0)}function v(e){Kt.get().requiresSyntheticActiveState()&&(a=[],s()(e).on("mousedown",(function(e){for(var t=s()(e.target);t.length;)a.push(t.addClass("active")),t=t.parent()})).on("mouseup",(function(){a.forEach((function(e){e.removeClass("active")})),a=[]})))}function b(e,t){if(Pr.isNullOrUndefined(e))return null;var n=e;if("string"==typeof e||"number"==typeof e){var r=scout.getSession(t);if(r)return e=Wn.asString(e),r.root.widget(e)}return me.get(n)}function m(e,t){if(Pr.isNullOrUndefined(e))return null;var n=scout.getSession(t);return n&&n.modelAdapterRegistry?n.modelAdapterRegistry[e]:null}function g(e){var t=E.get().sessions;if(!t)return null;if(Pr.isNullOrUndefined(e))return t[0];for(var n=0;n<t.length;n++){var r=t[n];if(r.partId==e)return r}return null}function _(e,t){var n=scout.getSession(t);if(n&&n.modelAdapterRegistry){var r=n.getModelAdapter(e);if(!r)return null;var o=i(e);return function e(t,r){var o,s;t.widget._widgetProperties.forEach((function(t){var a=r[t];if(a)if(Array.isArray(a)){var l=[];a.forEach((function(t){o=n.getModelAdapter(t),s=i(t),e(o,s),l.push(s)})),r[t]=l}else o=n.getModelAdapter(a),s=i(a),e(o,s),r[t]=s})),r=t.exportAdapterData(r)}(r,o),o.type="model",o}function i(e){var t=n.getAdapterData(e);return t=s.a.extend(!0,{},t)}}function w(e){function t(){u(e.clearBody,!0)&&s()("body").html(""),setTimeout((function(){e.redirectUrl?window.location.href=e.redirectUrl:window.location.reload()}))}(e=e||{}).schedule?setTimeout(t):t()}function k(e){l=s.a.extend(l,e)}function S(e,t,n){c("template",e);var r=Object.create(Object.getPrototypeOf(e));if(Object.getOwnPropertyNames(e).forEach((function(t){r[t]=e[t]})),t)for(var o in t)r[o]=t[o];return u(n,!0)&&(r.id=te.get().createUniqueId()),void 0===r.cloneOf&&(r.cloneOf=e),r}var O={nvl:u,assertParameter:c,assertProperty:f,isOneOf:h,create:p,prepareDOM:d,installGlobalMouseDownInterceptor:y,installSyntheticActiveStateHandler:v,widget:b,adapter:m,getSession:g,exportAdapter:_,reloadPage:w,addObjectFactories:k,objectFactories:l,cloneShallow:S};function T(e){return function(e){if(Array.isArray(e))return C(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return C(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return C(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function C(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function P(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var R=null,x=[],E=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.events=this._createEventSupport(),this.initialized=!1,this.sessions=[],x.forEach((function(e){this.addListener(e)}),this),x=[],R=this,this.errorHandler=this._createErrorHandler()}var t,n,r;return t=e,r=[{key:"addListener",value:function(e,t){var n={type:e,func:t};return R?R.events.addListener(n):x.push(n),n}},{key:"get",value:function(){return R}}],(n=[{key:"init",value:function(e){return e=e||{},this._prepare(e).then(this._bootstrap.bind(this,e.bootstrap)).then(this._init.bind(this,e)).then(this._initDone.bind(this,e)).catch(this._fail.bind(this,e))}},{key:"_prepare",value:function(e){var t=this;return this._prepareLogging(e).done((function(){t._prepareEssentials(e),t._prepareDone(e)}))}},{key:"_prepareEssentials",value:function(e){Rr.install(window),te.get().init()}},{key:"_prepareDone",value:function(e){this.trigger("prepare",{options:e}),s.a.log.isDebugEnabled()&&s.a.log.debug("App prepared")}},{key:"_prepareLogging",value:function(e){return Xn.bootstrap()}},{key:"_bootstrap",value:function(e){e=e||{};var t=[];return this._doBootstrap(e).forEach((function(e){Array.isArray(e)?t.concat(e):e&&t.push(e)})),s.a.promiseAll(t).done(this._bootstrapDone.bind(this,e)).catch(this._bootstrapFail.bind(this,e))}},{key:"_doBootstrap",value:function(e){return[Kt.get().bootstrap(),vn.bootstrap(e.fonts),En.bootstrap(e.localesUrl),bp.bootstrap(e.textsUrl),Qi.bootstrap(e.codesUrl)]}},{key:"_bootstrapDone",value:function(e){Ho.removeItemFromSessionStorage("scout:timeoutPageReload"),this.trigger("bootstrap",{options:e}),s.a.log.isDebugEnabled()&&s.a.log.debug("App bootstrapped")}},{key:"_bootstrapFail",value:function(e,t,n,r,o){if(s.a.log.isInfoEnabled()&&s.a.log.info("App bootstrap failed"),s.a.isJqXHR(t)){if(this._isSessionTimeoutStatus(t.status)){var i=o?o.url:"";return void this._handleBootstrapTimeoutError(t,i)}}else if(Pr.isPlainObject(t)&&t.error&&t.error.code===xs.JsonResponseError.SESSION_TIMEOUT)return void this._handleBootstrapTimeoutError(t.error,t.url);var a=Pr.argumentsToArray(arguments).slice(1);return s.a.rejectedPromise.apply(s.a,T(a))}},{key:"_isSessionTimeoutStatus",value:function(e){return 401===e}},{key:"_handleBootstrapTimeoutError",value:function(e,t){if(s.a.log.isInfoEnabled()&&s.a.log.info("Timeout error for resource "+t+". Reloading page..."),Ho.getItemFromSessionStorage("scout:timeoutPageReload"))throw s.a.log.isWarnEnabled()&&s.a.log.warn("Prevented automatic reload, startup will likely fail",e,t),Ho.removeItemFromSessionStorage("scout:timeoutPageReload"),new Error("Resource "+t+" could not be loaded due to a session timeout, even after a page reload");Ho.setItemToSessionStorage("scout:timeoutPageReload",!0),O.reloadPage()}},{key:"_init",value:function(e){if(e=e||{},this._checkBrowserCompability(e))return this._initVersion(e),this._prepareDOM(),this._installErrorHandler(),this._installGlobalMouseDownInterceptor(),this._installSyntheticActiveStateHandler(),this._ajaxSetup(),this._installExtensions(),this._load(e).then(this._loadSessions.bind(this,e.session))}},{key:"_load",value:function(e){return s.a.resolvedPromise()}},{key:"_checkBrowserCompability",value:function(e){var t=Kt.get(),n=this;return s.a.log.isInfoEnabled()&&s.a.log.info("Detected browser "+t.browser+" version "+t.browserVersion),!(O.nvl(e.checkBrowserCompatibility,!0)&&!t.isSupportedBrowser()&&(s()(".scout").each((function(){var t=s()(this).appendDiv(),r=Pr.valueCopy(e);r.checkBrowserCompatibility=!1,t.load("unsupported-browser.html",(function(){t.find("button").on("click",(function(){t.remove(),n._init(r)}))}))})),1))}},{key:"_initVersion",value:function(e){this.version=O.nvl(this.version,e.version,s()("scout-version").data("value"))}},{key:"_prepareDOM",value:function(){O.prepareDOM(document)}},{key:"_installGlobalMouseDownInterceptor",value:function(){O.installGlobalMouseDownInterceptor(document)}},{key:"_installSyntheticActiveStateHandler",value:function(){O.installSyntheticActiveStateHandler(document)}},{key:"_installErrorHandler",value:function(){window.onerror=this.errorHandler.windowErrorHandler}},{key:"_createErrorHandler",value:function(){return O.create("ErrorHandler")}},{key:"_ajaxSetup",value:function(){var e=this._ajaxDefaults();e&&s.a.ajaxSetup(e)}},{key:"_ajaxDefaults",value:function(){return{beforeSend:this._beforeAjaxCall.bind(this)}}},{key:"_beforeAjaxCall",value:function(e){e.setRequestHeader("X-Scout-Correlation-Id",pr.correlationId()),e.setRequestHeader("X-Requested-With","XMLHttpRequest")}},{key:"_loadSessions",value:function(e){var t=this;e=e||{};var n=[];return s()(".scout").each((function(r,o){var i=s()(o);e.portletPartId=e.portletPartId||i.data("partid")||"0";var a=t._loadSession(i,e);n.push(a)})),s.a.promiseAll(n)}},{key:"_loadSession",value:function(e,t){var n=this;t.locale=t.locale||this._loadLocale(),t.$entryPoint=e;var r=this._createSession(t);this.sessions.push(r);var o=this._createDesktop(r.root);return this.trigger("desktopReady",{desktop:o}),r.render((function(){r._renderDesktop(),r.layoutValidator.validate(),r.focusManager.validateFocus(),r.ready=!0,n.trigger("sessionReady",{session:r}),s.a.log.isInfoEnabled()&&s.a.log.info("Session initialized. Detected "+Kt.get())})),s.a.resolvedPromise()}},{key:"_createSession",value:function(e){return O.create("Session",e,{ensureUniqueId:!1})}},{key:"_createDesktop",value:function(e){return O.create("Desktop",{parent:e})}},{key:"_loadLocale",value:function(){return En.getNavigatorLocale()}},{key:"_initDone",value:function(e){this.initialized=!0,this.trigger("init",{options:e}),s.a.log.isInfoEnabled()&&s.a.log.info("App initialized")}},{key:"_fail",value:function(e,t){for(var n,r=arguments.length,o=new Array(r>2?r-2:0),i=2;i<r;i++)o[i-2]=arguments[i];return s.a.log.error("App initialization failed."),(n=this.errorHandler).handle.apply(n,[t].concat(o)).then((function(e){var n=s()("body").appendDiv("startup-error");return n.appendDiv("startup-error-title").text("The application could not be started"),e.message&&n.appendDiv("startup-error-message").text(e.message),s.a.rejectedPromise.apply(s.a,[t].concat(o))}))}},{key:"_installExtensions",value:function(){}},{key:"_createEventSupport",value:function(){return new ln}},{key:"trigger",value:function(e,t){(t=t||{}).source=this,this.events.trigger(e,t)}},{key:"one",value:function(e,t){this.events.one(e,t)}},{key:"on",value:function(e,t){return this.events.on(e,t)}},{key:"off",value:function(e,t){this.events.off(e,t)}},{key:"addListener",value:function(e){this.events.addListener(e)}},{key:"removeListener",value:function(e){this.events.removeListener(e)}},{key:"when",value:function(e){return this.events.when(e)}}])&&P(t.prototype,n),r&&P(t,r),e}(),D=n(1),A=n.n(D);function F(e){return function(e){if(Array.isArray(e))return j(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return j(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return j(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function j(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function B(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var M,I,L,H=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.logError=!0,this.displayError=!0,this.sendError=!1,this.windowErrorHandler=this._onWindowError.bind(this)}var t,n,r;return t=e,(n=[{key:"init",value:function(e){s.a.extend(this,e)}},{key:"_onWindowError",value:function(e,t,n,r,o){try{if(o instanceof Error)this.handle(o).catch((function(e){console.error("Error in global JavaScript error handler",e)}));else{var i=e+" at "+t+":"+n+"\n(Code J00)";this.handleErrorInfo({code:"J00",message:e,log:i})}}catch(r){throw new Error("Error in global JavaScript error handler: "+r.message+" (original error: "+e+" at "+t+":"+n+")")}}},{key:"handle",value:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var o=e;return e&&0===n.length&&("[object Arguments]"===String(e)?(o=e[0],n=F(e).slice(1)):Array.isArray(e)&&(o=e[0],n=e.slice(1))),this.analyzeError.apply(this,[o].concat(F(n))).then(this.handleErrorInfo.bind(this))}},{key:"analyzeError",value:function(e){for(var t={code:null,message:null,stack:null,mappedStack:null,debugInfo:null,log:null,error:e},n=arguments.length,r=new Array(n>1?n-1:0),o=1;o<n;o++)r[o-1]=arguments[o];return this._analyzeError.apply(this,[t].concat(r))}},{key:"_analyzeError",value:function(e){var t=this,n=e.error;if(n instanceof Error)return this.mapStack(n.stack).catch((function(t){return e.mappingError=t.message+"\n"+t.error.message+"\n"+t.error.stack,null})).then((function(n){return e.mappedStack=n,t._analyzeRegularError(e),e}));if(s.a.isJqXHR(n)||Array.isArray(n)&&s.a.isJqXHR(n[0])||n instanceof ti){for(var r=arguments.length,o=new Array(r>1?r-1:0),i=1;i<r;i++)o[i-1]=arguments[i];return this._analyzeAjaxError.apply(this,[e].concat(o)),s.a.resolvedPromise(e)}return n?(this._analyzeOtherError(e),s.a.resolvedPromise(e)):(this._analyzeNoError(e),s.a.resolvedPromise(e))}},{key:"_analyzeRegularError",value:function(e){var t=e.error;e.code=this.getJsErrorCode(t),e.message=String(t.message||t),t.stack&&(e.stack=String(t.stack)),t.debugInfo&&(e.debugInfo=t.debugInfo);var n=e.mappedStack||e.stack,r=[];n&&-1!==n.indexOf(e.message)||r.push(e.message),n&&r.push(n),e.mappingError&&r.push(e.mappingError),e.debugInfo&&r.push("----- Additional debug information: -----\n"+e.debugInfo),e.log=rt.format(r,"\n")}},{key:"_analyzeAjaxError",value:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var o,i,s,a=e.error;a instanceof ti?(o=a.jqXHR,i=a.errorThrown,s=a.requestOptions):(o=(n=rt.ensure(a).concat(n))[0],i=n[2],s=n[3]);var l=s?Wn.join(" ",s.type,s.url):"",u=o.status?Wn.join(" ",o.status,i):"Connection error";e.code="X"+(o.status||"0"),e.message="AJAX call"+Wn.box(' "',l,'"')+" failed"+Wn.box(" [",u,"]"),e.log=e.message,o.responseText&&(e.debugInfo="Response text:\n"+o.responseText,e.log+="\n"+e.debugInfo)}},{key:"_analyzeOtherError",value:function(e){var t=e.error,n="string"==typeof t||"number"==typeof t?String(t):null;if(e.code="P4",e.message=n||"Unexpected error",!n)try{n=JSON.stringify(t)}catch(e){n=String(t)}e.log="Unexpected error: "+n}},{key:"_analyzeNoError",value:function(e){e.code="P3",e.message="Unknown error",e.log="Unexpected error (no reason provided)"}},{key:"mapStack",value:function(e){var t=s.a.Deferred();try{A.a.mapStackTrace(e,(function(e){t.resolve(rt.format(e,"\n"))}))}catch(e){return s.a.rejectedPromise({message:"Exception mapping failed",error:e})}return t.promise()}},{key:"handleErrorInfo",value:function(t){if(this.logError&&t.log){s.a.log.error(t.log);var n=e.CONSOLE_OUTPUT;s.a.log instanceof Zn&&(n=!1),n&&window&&window.console&&(window.console.error?window.console.error(t.log):window.console.log&&window.console.log(t.log))}if(E.get().sessions.length>0){var r=E.get().sessions[0];this.displayError&&this._showMessageBox(r,t.message,t.code,t.log),this.sendError&&this._sendErrorMessage(r,t.log)}return t}},{key:"getJsErrorCode",value:function(e){if(e){if("EvalError"===e.name)return"E1";if("InternalError"===e.name)return"I2";if("RangeError"===e.name)return"A3";if("ReferenceError"===e.name)return"R4";if("SyntaxError"===e.name)return"S5";if("TypeError"===e.name)return"T6";if("URIError"===e.name)return"U7"}return"J0"}},{key:"_showMessageBox",value:function(e,t,n,r){var o={header:e.optText("ui.UnexpectedProblem","Internal UI Error"),body:Wn.join("\n\n",e.optText("ui.InternalUiErrorMsg",t," ("+e.optText("ui.ErrorCodeX","Code "+n,n)+")"),e.optText("ui.UiInconsistentMsg","")),yesButtonText:e.optText("ui.Reload","Reload"),yesButtonAction:O.reloadPage,noButtonText:e.optText("ui.Ignore","Ignore"),hiddenText:r};e.showFatalMessage(o,n)}},{key:"_sendErrorMessage",value:function(e,t){e.sendLogRequest(t)}}])&&B(t.prototype,n),r&&B(t,r),e}();function N(e){return(N="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function V(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function W(e,t,n){return(W="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=K(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function z(e,t){return(z=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function G(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=K(e);if(t){var o=K(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return U(this,n)}}function U(e,t){return!t||"object"!==N(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function K(e){return(K=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}L=!0,(I="CONSOLE_OUTPUT")in(M=H)?Object.defineProperty(M,I,{value:L,enumerable:!0,configurable:!0,writable:!0}):M[I]=L;var q=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&z(e,t)}(i,e);var t,n,r,o=G(i);function i(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(e=o.call(this)).remote=!0,e}return t=i,(n=[{key:"_doBootstrap",value:function(e){return W(K(i.prototype),"_doBootstrap",this).call(this,e).concat([this._doBootstrapDefaultValues()])}},{key:"_doBootstrapDefaultValues",value:function(){Mt.bootstrap()}},{key:"_createErrorHandler",value:function(){return O.create("ErrorHandler",{sendError:!0})}},{key:"_loadSession",value:function(e,t){(t=t||{}).$entryPoint=e;var n=this._createSession(t);return E.get().sessions.push(n),n.start()}},{key:"_fail",value:function(e,t){s.a.log.error("App initialization failed",t);for(var n=arguments.length,r=new Array(n>2?n-2:0),o=2;o<n;o++)r[o-2]=arguments[o];return s.a.rejectedPromise.apply(s.a,[t].concat(r))}}])&&V(t.prototype,n),r&&V(t,r),i}(E);function Y(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var X=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,r=[{key:"install",value:function(e){e.forEach((function(e){O.create(e)}))}}],(n=[{key:"extend",value:function(e,t){var n=e[t],r=this;e[t]=function(){return r.extended=this,r.next=n.bind(this),r[t].apply(r,arguments)}}}])&&Y(t.prototype,n),r&&Y(t,r),e}();function J(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Z=function(){function e(t,n,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.typeDescriptor=t,this.objectType=n,this.modelVariant=r}var t,n,r;return t=e,r=[{key:"newInstance",value:function(t,n){return e.parse(t).createInstance(n)}},{key:"parse",value:function(t){var n=null,r=null;if(Wn.contains(t,te.MODEL_VARIANT_SEPARATOR)){var o=t.split(te.MODEL_VARIANT_SEPARATOR);n=i(o[0]),r=i(o[1]),rt.empty(r.namespaces)&&!rt.empty(n.namespaces)&&(r.namespaces=n.namespaces)}else n=i(t);return new e(t,n,r);function i(e){var t=[];if(Wn.contains(e,te.NAMESPACE_SEPARATOR)){var n=e.split(te.NAMESPACE_SEPARATOR);t=n.slice(0,n.length-1),e=rt.last(n)}return function(e,t){return{name:e,namespaces:O.nvl(t,[]),toString:function(){var n=t.slice();return n.push(e),Wn.join(te.NAMESPACE_SEPARATOR,n)}}}(e,t)}}}],(n=[{key:"createInstance",value:function(t){var n,r,o,i=window.scout;if(this.modelVariant?(o=this.modelVariant.name+this.objectType.name,r=this.modelVariant.namespaces):(o=this.objectType.name,r=this.objectType.namespaces),r.length)for(i=window,n=0;n<r.length;n++)if(!(i=i[r[n]]))throw this.error('Could not resolve namespace "'+r[n]+'"');if(!i[o]){if(t.variantLenient&&this.modelVariant)return new e(this.typeDescriptor,this.objectType,null).createInstance(t);throw this.error('Could not find "'+o+'" in namespace "'+r.join(".")+'"')}return new i[o](t.model)}},{key:"error",value:function(e){return new Error('Failed to create object for objectType "'+this.typeDescriptor+'": '+e)}}])&&J(t.prototype,n),r&&J(t,r),e}();function Q(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ee(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var te=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.uniqueIdSeqNo=0,this._registry={}}var t,n,r;return t=e,r=[{key:"get",value:function(){return ne}},{key:"_set",value:function(e){ne=e}}],(n=[{key:"_createObjectByType",value:function(e,t){if("string"!=typeof e)throw new Error("missing or invalid object type");t=t||{};var n=this._registry[e];if(n){var r=n(t.model);if(!r)throw new Error('Failed to create object for objectType "'+e+'": Factory function did not return a valid object');return r}return Z.newInstance(e,t)}},{key:"create",value:function(e,t,n){if("string"==typeof e)n=n||{};else{if(!Pr.isPlainObject(e))throw new Error("Invalid arguments");if(n=t||{},!(t=e).objectType)throw new Error('Missing mandatory property "objectType" on model');e=t.objectType}n.model=t;var r=this._createObjectByType(e,n);return Pr.isFunction(r.init)&&(t&&(void 0===t.id&&O.nvl(n.ensureUniqueId,!0)&&(t.id=this.createUniqueId()),t.objectType=e),r.init(t)),void 0===r.id&&O.nvl(n.ensureUniqueId,!0)&&(r.id=this.createUniqueId()),void 0===r.objectType&&(r.objectType=e),r}},{key:"createUniqueId",value:function(){return"ui"+(++this.uniqueIdSeqNo).toString()}},{key:"register",value:function(e,t){s.a.log.isDebugEnabled()&&s.a.log.debug("(ObjectFactory) registered create-function for objectType "+e),this._registry[e]=t}},{key:"unregister",value:function(e){s.a.log.isDebugEnabled()&&s.a.log.debug("(ObjectFactory) unregistered objectType "+e),delete this._registry[e]}},{key:"get",value:function(e){return this._registry[e]}},{key:"init",value:function(){for(var e in O.objectFactories)O.objectFactories.hasOwnProperty(e)&&this.register(e,O.objectFactories[e])}}])&&Q(t.prototype,n),r&&Q(t,r),e}();ee(te,"NAMESPACE_SEPARATOR","."),ee(te,"MODEL_VARIANT_SEPARATOR",":");var ne=new te;function re(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var oe=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),O.assertParameter("widget",t.widget),this.widget=t.widget,this.options$Container=t.$container,this.loadingIndicatorDelay=O.nvl(t.loadingIndicatorDelay,250),this._$loadingIndicator=null,this._loadingIndicatorTimeoutId=null}var t,n,r;return t=e,(n=[{key:"setLoadingIndicatorDelay",value:function(e){this.loadingIndicatorDelay=e}},{key:"_ensure$Container",value:function(){Pr.isFunction(this.options$Container)?this.$container=this.options$Container():this.options$Container?this.$container=this.options$Container:this.$container=this.widget.$container}},{key:"renderLoading",value:function(){clearTimeout(this._loadingIndicatorTimeoutId),this._ensure$Container(),this.widget.isLoading()?this.loadingIndicatorDelay&&!this.widget.rendering?this._loadingIndicatorTimeoutId=setTimeout(this._renderLoadingIndicator.bind(this),this.loadingIndicatorDelay):this._renderLoadingIndicator():this._removeLoadingIndicator()}},{key:"_renderLoadingIndicator",value:function(){this._$loadingIndicator||!this.widget.rendered&&!this.widget.rendering||(this.$container.addClass("loading"),this._$loadingIndicator=this.$container.appendDiv("loading-indicator"))}},{key:"_removeLoadingIndicator",value:function(){var e=this;this._$loadingIndicator&&this._$loadingIndicator.fadeOutAndRemove((function(){e._$loadingIndicator=null,e.widget.rendered&&(e.$container.removeClass("loading"),e.widget.invalidateLayoutTree())}))}},{key:"remove",value:function(){this._$loadingIndicator&&(this._$loadingIndicator.remove(),this._$loadingIndicator=null)}}])&&re(t.prototype,n),r&&re(t,r),e}();function ie(e){return(ie="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function se(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ae(e,t){return(ae=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function le(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=ce(e);if(t){var o=ce(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return ue(this,n)}}function ue(e,t){return!t||"object"!==ie(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function ce(e){return(ce=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var fe=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ae(e,t)}(i,e);var t,n,r,o=le(i);function i(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),o.call(this,e)}return t=i,(n=[{key:"_renderLoadingIndicator",value:function(){(this.widget.rendered||this.widget.rendering)&&this.$container.addClass("loading")}},{key:"_removeLoadingIndicator",value:function(){(this.widget.rendered||this.widget.rendering)&&this.$container.removeClass("loading")}}])&&se(t.prototype,n),r&&se(t,r),i}(oe);function he(e){return(he="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function pe(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var de=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.id=null,this.objectType=null,this.initialized=!1,this.attached=!1,this.destroyed=!1,this.widget=null,this._enabledBeforeOffline=!0,this._remoteProperties=[],this._widgetListener=null,this._propertyChangeEventFilter=new ks,this._widgetEventTypeFilter=new As,this.events=new ln,this.session=null}var t,n,r;return t=e,r=[{key:"modifyWidgetPrototype",value:function(){E.get().remote&&Pr.replacePrototypeFunction(ve,"_createChild",(function(e){return e instanceof ve?e:this.modelAdapter&&"string"==typeof e?this.session.getOrCreateWidget(e,this):this._createChildOrig(e)}),!0)}}],(n=[{key:"init",value:function(e){this._init(e),this.initialized=!0}},{key:"_init",value:function(e){O.assertParameter("id",e.id),O.assertParameter("session",e.session),s.a.extend(this,e),this.session.registerModelAdapter(this)}},{key:"destroy",value:function(){this._detachWidget(),this.widget.destroy(),this.widget=null,this.session.unregisterModelAdapter(this),this.destroyed=!0}},{key:"createWidget",value:function(e,t){var n=this._initModel(e,t);return this.widget=this._createWidget(n),this._attachWidget(),this._postCreateWidget(),this.widget}},{key:"_postCreateWidget",value:function(){}},{key:"_initModel",value:function(e,t){var n=this.session.adapterExportEnabled;return e=s.a.extend(n,{},e),Mt.applyTo(e),e.parent=t,e.owner=t,e.modelAdapter=this,e.global&&(e.owner=this.session.getModelAdapter("1").widget),this._initProperties(e),e}},{key:"_initProperties",value:function(e){}},{key:"_createWidget",value:function(e){var t=O.create(e);return t._addCloneProperties(["modelClass","classId"]),t}},{key:"_attachWidget",value:function(){this._widgetListener||(this._widgetListener={func:this._onWidgetEventInternal.bind(this)},this.widget.addListener(this._widgetListener),this.attached=!0,this.events.trigger("attach"))}},{key:"_detachWidget",value:function(){this._widgetListener&&(this.widget.removeListener(this._widgetListener),this._widgetListener=null,this.attached=!1,this.events.trigger("detach"))}},{key:"goOffline",value:function(){this.widget.visitChildren((function(e){e.modelAdapter&&e.modelAdapter._goOffline()}))}},{key:"_goOffline",value:function(){}},{key:"goOnline",value:function(){this.widget.visitChildren((function(e){e.modelAdapter&&e.modelAdapter._goOnline()}))}},{key:"_goOnline",value:function(){}},{key:"isRemoteProperty",value:function(e){return this._remoteProperties.indexOf(e)>-1}},{key:"_addRemoteProperties",value:function(e){this._addProperties("_remoteProperties",e)}},{key:"_removeRemoteProperties",value:function(e){this._removeProperties("_remoteProperties",e)}},{key:"_addProperties",value:function(e,t){Array.isArray(t)?this[e]=this[e].concat(t):this[e].push(t)}},{key:"_removeProperties",value:function(e,t){t=rt.ensure(t),rt.removeAll(this[e],t)}},{key:"_send",value:function(e,t,n){var r={};arguments.length>2&&(null!==n&&"object"===he(n)?r=n:(r.delay=arguments[2],r.coalesce=arguments[3],r.showBusyIndicator=arguments[4])),n=r;var o=new ms(this.id,e,t);void 0!==n.coalesce&&(o.coalesce=n.coalesce),void 0!==n.showBusyIndicator&&(o.showBusyIndicator=n.showBusyIndicator),void 0!==n.newRequest&&(o.newRequest=n.newRequest),this.session.sendEvent(o,n.delay)}},{key:"_sendProperty",value:function(e,t){var n={};n[e]=t,this._send("property",n)}},{key:"addFilterForWidgetEvent",value:function(e){this._widgetEventTypeFilter.addFilter(e)}},{key:"addFilterForWidgetEventType",value:function(e){this._widgetEventTypeFilter.addFilterForEventType(e)}},{key:"addFilterForProperties",value:function(e){this._propertyChangeEventFilter.addFilterForProperties(e)}},{key:"addFilterForPropertyName",value:function(e){this._propertyChangeEventFilter.addFilterForPropertyName(e)}},{key:"_isPropertyChangeEventFiltered",value:function(e,t){return t instanceof ve&&(t=t.id),this._propertyChangeEventFilter.filter(e,t)}},{key:"_isWidgetEventFiltered",value:function(e){return this._widgetEventTypeFilter.filter(e)}},{key:"resetEventFilters",value:function(){this._propertyChangeEventFilter.reset(),this._widgetEventTypeFilter.reset()}},{key:"_onWidgetPropertyChange",value:function(e){var t=e.propertyName,n=e.newValue;this._isPropertyChangeEventFiltered(t,n)||this.isRemoteProperty(t)&&(n=this._prepareRemoteProperty(t,n),this._callSendProperty(t,n))}},{key:"_prepareRemoteProperty",value:function(e,t){return t&&this.widget.isWidgetProperty(e)?Array.isArray(t)?t.map((function(e){return e.modelAdapter.id})):t.modelAdapter.id:t}},{key:"_callSendProperty",value:function(e,t){var n="_send"+Wn.toUpperCaseFirstLetter(e);this[n]?this[n](t):this._sendProperty(e,t)}},{key:"_onWidgetDestroy",value:function(){this.destroy()}},{key:"_onWidgetEventInternal",value:function(e){this._isWidgetEventFiltered(e)||this._onWidgetEvent(e)}},{key:"_onWidgetEvent",value:function(e){"destroy"===e.type?this._onWidgetDestroy(e):"propertyChange"===e.type&&this._onWidgetPropertyChange(e)}},{key:"_syncPropertiesOnPropertyChange",value:function(e){this._orderPropertyNamesOnSync(e).forEach((function(t){var n=e[t],r="_sync"+Wn.toUpperCaseFirstLetter(t);this[r]?this[r](n):this.widget.callSetter(t,n)}),this)}},{key:"_orderPropertyNamesOnSync",value:function(e){return Object.keys(e)}},{key:"_createPropertySortFunc",value:function(e){return function(t,n){var r=e.indexOf(t),o=e.indexOf(n);return r>-1&&o>-1?r-o:r>-1?-1:o>-1?1:GA.TEXT.compare(t,n)}}},{key:"onModelEvent",value:function(e){e&&("property"===e.type?this.onModelPropertyChange(e):this.onModelAction(e))}},{key:"onModelPropertyChange",value:function(e){this.addFilterForProperties(e.properties),this._syncPropertiesOnPropertyChange(e.properties)}},{key:"onModelAction",value:function(e){"scrollToTop"===e.type?this.widget.scrollToTop({animate:e.animate}):"reveal"===e.type?this.widget.reveal({animate:e.animate}):s.a.log.warn('Model action "'+e.type+'" is not supported by model-adapter '+this.objectType)}},{key:"toString",value:function(){return"ModelAdapter[objectType="+this.objectType+" id="+this.id+"]"}},{key:"exportAdapterData",value:function(e){var t=e.modelClass;if(t){var n=Math.max(0,t.lastIndexOf("$")+1,t.lastIndexOf(".")+1);e.id=t.substring(n)}return delete e.owner,delete e.classId,delete e.modelClass,e}}])&&pe(t.prototype,n),r&&pe(t,r),e}();function ye(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}E.addListener("bootstrap",de.modifyWidgetPrototype);var ve=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.id=null,this.objectType=null,this.session=null,this.owner=null,this.parent=null,this.children=[],this.initialized=!1,this.cloneOf=null,this.rendering=!1,this.removing=!1,this.removalPending=!1,this.rendered=!1,this.attached=!1,this.destroyed=!1,this.destroying=!1,this.enabled=!0,this.enabledComputed=!0,this.inheritAccessibility=!0,this.disabledStyle=e.DisabledStyle.DEFAULT,this.visible=!0,this.focused=!1,this.loading=!1,this.cssClass=null,this.scrollTop=null,this.scrollLeft=null,this.$parent=null,this.$container=null,this.htmlComp=null,this.animateRemoval=!1,this.animateRemovalClass="animate-remove",this._widgetProperties=[],this._cloneProperties=["visible","enabled","inheritAccessibility","cssClass"],this.eventDelegators=[],this._preserveOnPropertyChangeProperties=[],this._postRenderActions=[],this._focusInListener=this._onFocusIn.bind(this),this._parentDestroyHandler=this._onParentDestroy.bind(this),this._parentRemovingWhileAnimatingHandler=this._onParentRemovingWhileAnimating.bind(this),this._scrollHandler=this._onScroll.bind(this),this.events=this._createEventSupport(),this.events.registerSubTypePredicate("propertyChange",(function(e,t){return e.propertyName===t})),this.loadingSupport=this._createLoadingSupport(),this.keyStrokeContext=this._createKeyStrokeContext(),this.logicalGrid=null,this.trackFocus=!1,this._$lastFocusedElement=null,this._storedFocusedWidget=null,this._glassPaneContributions=[]}var t,n,r;return t=e,r=[{key:"cssClassAsArray",value:function(e){var t=[],n=e||"";return(n=n.trim()).length>0&&(t=n.split(" ")),t}}],(n=[{key:"init",value:function(e){var t=this._jsonModel();t&&(e=s.a.extend({},t,e)),e=e||{},e=this._prepareModel(e),this._init(e),this._initKeyStrokeContext(),this.recomputeEnabled(),this.initialized=!0,this.trigger("init")}},{key:"_prepareModel",value:function(e){return e}},{key:"_init",value:function(e){var t=this;if(!e.parent)throw new Error("Parent expected: "+this);if(this.setOwner(e.owner||e.parent),this.setParent(e.parent),this.session=e.session||this.parent.session,!this.session)throw new Error("Session expected: "+this);this._eachProperty(e,(function(e,n,r){void 0!==n&&(r&&(n=t._prepareWidgetProperty(e,n)),t._initProperty(e,n))})),this._setCssClass(this.cssClass),this._setLogicalGrid(this.logicalGrid),this._setEnabled(this.enabled)}},{key:"_initProperty",value:function(e,t){this[e]=t}},{key:"_jsonModel",value:function(){}},{key:"_createChildren",value:function(e){if(!e)return null;if(!Array.isArray(e))return this._createChild(e);var t=[];return e.forEach((function(e,n){t[n]=this._createChild(e)}),this),t}},{key:"_createChild",value:function(t){if(t instanceof e)return t;if("string"==typeof t){var n=this.widget(t);if(!n)throw new Error("Referenced widget not found: "+t);return n}return t.parent=this,O.create(t)}},{key:"_initKeyStrokeContext",value:function(){this.keyStrokeContext&&(this.keyStrokeContext.$scopeTarget=function(){return this.$container}.bind(this),this.keyStrokeContext.$bindTarget=function(){return this.$container}.bind(this))}},{key:"destroy",value:function(){var e=this;if(!this.destroyed){if(this.destroying=!0,this.rendered&&(this.animateRemoval||this._isRemovalPrevented()))return this.one("remove",(function(){e.destroy()})),void this.remove();this._destroyChildren(this.children.slice().reverse()),this.remove(),this._destroy(),this.owner._removeChild(this),this.owner=null,this.parent._removeChild(this),this.parent.off("destroy",this._parentDestroyHandler),this.parent=null,this.destroying=!1,this.destroyed=!0,this.trigger("destroy")}}},{key:"_destroy",value:function(){}},{key:"_destroyChildren",value:function(e){e&&(e=rt.ensure(e)).forEach((function(e,t){this._destroyChild(e)}),this)}},{key:"_destroyChild",value:function(e){e.owner===this&&e.destroy()}},{key:"render",value:function(e){if(s.a.log.isTraceEnabled()&&s.a.log.trace("Rendering widget: "+this),!this.initialized)throw new Error("Not initialized: "+this);if(this.rendered)throw new Error("Already rendered: "+this);if(this.destroyed)throw new Error("Widget is destroyed: "+this);this.rendering=!0,this.$parent=e||this.parent.$container,this._render(),this._renderProperties(),this._renderInspectorInfo(),this._linkWithDOM(),this.session.keyStrokeManager.installKeyStrokeContext(this.keyStrokeContext),this.rendering=!1,this.rendered=!0,this.attached=!0,this.trigger("render"),this.restoreFocus(),this._postRender()}},{key:"_render",value:function(){}},{key:"_renderProperties",value:function(){this._renderCssClass(),this._renderEnabled(),this._renderVisible(),this._renderTrackFocus(),this._renderFocused(),this._renderLoading(),this._renderScrollTop(),this._renderScrollLeft()}},{key:"_postRender",value:function(){var e=this._postRenderActions;this._postRenderActions=[],e.forEach((function(e){e()}))}},{key:"remove",value:function(){this.rendered&&!this._isRemovalPrevented()&&(this.animateRemoval?this._removeAnimated():this._removeInternal())}},{key:"_isRemovalPrevented",value:function(){return this._isRemovalPending()}},{key:"_isRemovalPending",value:function(){if(this.removalPending)return!0;var e=this.parent;if(!e||e.removing||e.rendering)return!1;for(;e;){if(e.removalPending)return!0;e=e.parent}return!1}},{key:"_removeInternal",value:function(){this.rendered&&(s.a.log.isTraceEnabled()&&s.a.log.trace("Removing widget: "+this),this.removing=!0,this.removalPending=!1,this.trigger("removing"),this.$container&&this.$container.off("focusin",this._focusInListener),this._$lastFocusedElement&&(this._storedFocusedWidget=O.widget(this._$lastFocusedElement),this._$lastFocusedElement=null),this.children.slice().reverse().forEach((function(e){e.parent===this&&e.remove()}),this),this.rendered&&(this._cleanup(),this._remove(),this.$parent=null,this.rendered=!1,this.attached=!1,this.removing=!1,this.trigger("remove")))}},{key:"_removeAnimated",value:function(){var e=this;Kt.get().supportsCssAnimation()&&this.$container&&!this.$container.isDisplayNone()?(this.session.desktop.destroyPopupsFor(this),this.removalPending=!0,setTimeout((function(){if(e.rendered){if(!e.animateRemovalClass)throw new Error("Missing animate removal class. Cannot remove animated.");e.$container.isVisible()&&e.$container.isEveryParentVisible()?(e.$container.addClass(e.animateRemovalClass),e.$container.oneAnimationEnd((function(){e._removeInternal()}))):e._removeInternal()}})),this.parent.one("removing",this._parentRemovingWhileAnimatingHandler)):this._removeInternal()}},{key:"_onParentRemovingWhileAnimating",value:function(){this._removeInternal()}},{key:"_renderInspectorInfo",value:function(){this.session.inspector&&_n.applyInfo(this)}},{key:"_linkWithDOM",value:function(){this.$container&&this.$container.data("widget",this)}},{key:"_cleanup",value:function(){this.parent.off("removing",this._parentRemovingWhileAnimatingHandler),this.session.keyStrokeManager.uninstallKeyStrokeContext(this.keyStrokeContext),this.loadingSupport&&this.loadingSupport.remove(),this._uninstallScrollbars(),this.$container&&this.session.layoutValidator.cleanupInvalidComponents(this.$container)}},{key:"_remove",value:function(){this.$container&&(this.$container.remove(),this.$container=null)}},{key:"setOwner",value:function(e){O.assertParameter("owner",e),e!==this.owner&&(this.owner&&this.owner._removeChild(this),this.owner=e,this.owner._addChild(this))}},{key:"setParent",value:function(e){var t=this;if(O.assertParameter("parent",e),e!==this.parent){if(this.rendered&&!e.rendered&&(s.a.log.isInfoEnabled()&&s.a.log.info("rendered child "+this+" is added to not rendered parent "+e+". Removing child.",new Error("origin")),this.remove()),this.parent){if(this.parent._isRemovalPending())return void this.parent.one("remove",(function(){t.setParent(e)}));this.parent.off("destroy",this._parentDestroyHandler),this.parent.off("removing",this._parentRemovingWhileAnimatingHandler),this.parent!==this.owner&&this.parent._removeChild(this)}var n=this.parent;this.parent=e,this.parent._addChild(this),this.trigger("hierarchyChange",{oldParent:n,parent:e}),this.initialized&&this.recomputeEnabled(this.parent.enabledComputed),this.parent.one("destroy",this._parentDestroyHandler)}}},{key:"_addChild",value:function(e){s.a.log.isTraceEnabled()&&s.a.log.trace("addChild("+e+") to "+this),rt.pushSet(this.children,e)}},{key:"_removeChild",value:function(e){s.a.log.isTraceEnabled()&&s.a.log.trace("removeChild("+e+") from "+this),rt.remove(this.children,e)}},{key:"ancestors",value:function(){for(var e=[],t=this.parent;t;)e.push(t),t=t.parent;return e}},{key:"isOrHas",value:function(e){return e===this||this.has(e)}},{key:"has",value:function(e){for(;e;){if(e.parent===this)return!0;e=e.parent}return!1}},{key:"getForm",value:function(){return CC.findForm(this)}},{key:"findNonWrappedForm",value:function(){return CC.findNonWrappedForm(this)}},{key:"findDesktop",value:function(){return this.session.desktop?this.session.desktop:this.findParent((function(e){return e instanceof kae}))}},{key:"setEnabled",value:function(e,t,n){this.setProperty("enabled",e),e&&t&&this.parent&&this.parent.setEnabled(!0,!0,!1),n&&this.visitChildren((function(t){t.setEnabled(e)}))}},{key:"_setEnabled",value:function(e){this._setProperty("enabled",e),this.initialized&&this.recomputeEnabled()}},{key:"recomputeEnabled",value:function(e){void 0===e&&(e=!0,this.parent&&this.parent.initialized&&void 0!==this.parent.enabledComputed&&(e=this.parent.enabledComputed));var t=this._computeEnabled(this.inheritAccessibility,e);this._updateEnabledComputed(t)}},{key:"_updateEnabledComputed",value:function(e,t){if(this.enabledComputed!==e||void 0!==t){this.setProperty("enabledComputed",e),this.rendered&&this._renderEnabled();var n=O.nvl(t,e);this.children.forEach((function(e){e.inheritAccessibility&&e.recomputeEnabled(n)}))}}},{key:"_computeEnabled",value:function(e,t){return this.enabled&&(!e||t)}},{key:"_renderEnabled",value:function(){this.$container&&(this.$container.setEnabled(this.enabledComputed),this._renderDisabledStyle())}},{key:"setInheritAccessibility",value:function(e){this.setProperty("inheritAccessibility",e)}},{key:"_setInheritAccessibility",value:function(e){this._setProperty("inheritAccessibility",e),this.initialized&&this.recomputeEnabled()}},{key:"setDisabledStyle",value:function(e){this.setProperty("disabledStyle",e),this.children.forEach((function(t){t.setDisabledStyle(e)}))}},{key:"_renderDisabledStyle",value:function(){this._renderDisabledStyleInternal(this.$container)}},{key:"_renderDisabledStyleInternal",value:function(t){t&&(this.enabledComputed?t.removeClass("read-only"):t.toggleClass("read-only",this.disabledStyle===e.DisabledStyle.READ_ONLY))}},{key:"setVisible",value:function(e){this.setProperty("visible",e)}},{key:"isVisible",value:function(){return this.visible}},{key:"_renderVisible",value:function(){this.$container&&(this.$container.setVisible(this.isVisible()),this.invalidateParentLogicalGrid())}},{key:"isEveryParentVisible",value:function(){for(var e=this.parent;e;){if(!e.isVisible())return!1;e=e.parent}return!0}},{key:"setFocused",value:function(e){this.setProperty("focused",e)}},{key:"_renderFocused",value:function(){this.$container&&this.$container.toggleClass("focused",this.focused)}},{key:"_setCssClass",value:function(e){this.rendered&&this._removeCssClass(),this._setProperty("cssClass",e)}},{key:"_removeCssClass",value:function(){this.$container&&this.$container.removeClass(this.cssClass)}},{key:"_renderCssClass",value:function(){this.$container&&this.$container.addClass(this.cssClass)}},{key:"setCssClass",value:function(e){this.setProperty("cssClass",e)}},{key:"addCssClass",value:function(t){var n=this.cssClassAsArray();e.cssClassAsArray(t).forEach((function(e){n.indexOf(e)>=0||n.push(e)}),this),this.setProperty("cssClass",rt.format(n," "))}},{key:"removeCssClass",value:function(t){var n=this.cssClassAsArray(),r=e.cssClassAsArray(t);rt.removeAll(n,r)&&this.setProperty("cssClass",rt.format(n," "))}},{key:"toggleCssClass",value:function(e,t){t?this.addCssClass(e):this.removeCssClass(e)}},{key:"cssClassAsArray",value:function(){return e.cssClassAsArray(this.cssClass)}},{key:"_createLoadingSupport",value:function(){return null}},{key:"setLoading",value:function(e){this.setProperty("loading",e)}},{key:"isLoading",value:function(){return this.loading}},{key:"_renderLoading",value:function(){this.loadingSupport&&this.loadingSupport.renderLoading()}},{key:"pack",value:function(){if(this.rendered&&!this.removing){if(!this.htmlComp)throw new Error("Function expects a htmlComp property");this.htmlComp.pack()}}},{key:"invalidateLayout",value:function(){if(this.rendered&&!this.removing){if(!this.htmlComp)throw new Error("Function expects a htmlComp property");this.htmlComp.invalidateLayout()}}},{key:"validateLayout",value:function(){if(this.rendered&&!this.removing){if(!this.htmlComp)throw new Error("Function expects a htmlComp property");this.htmlComp.validateLayout()}}},{key:"revalidateLayout",value:function(){if(this.rendered&&!this.removing){if(!this.htmlComp)throw new Error("Function expects a htmlComp property");this.htmlComp.revalidateLayout()}}},{key:"invalidateLayoutTree",value:function(e){if(this.rendered&&!this.removing){if(!this.htmlComp)throw new Error("Function expects a htmlComp property");this.htmlComp.invalidateLayoutTree(e)}}},{key:"validateLayoutTree",value:function(){if(this.rendered&&!this.removing){if(!this.htmlComp)throw new Error("Function expects a htmlComp property");this.htmlComp.validateLayoutTree()}}},{key:"revalidateLayoutTree",value:function(e){if(this.rendered&&!this.removing){if(!this.htmlComp)throw new Error("Function expects a htmlComp property");this.htmlComp.revalidateLayoutTree(e)}}},{key:"setLayoutData",value:function(e){if(this.rendered){if(!this.htmlComp)throw new Error("Function expects a htmlComp property");this.htmlComp.layoutData=e}}},{key:"validateLogicalGrid",value:function(){this.logicalGrid&&this.logicalGrid.validate(this)}},{key:"invalidateLogicalGrid",value:function(e){this.initialized&&this.logicalGrid&&(this.logicalGrid.setDirty(!0),O.nvl(e,!0)&&this.invalidateLayoutTree())}},{key:"invalidateParentLogicalGrid",value:function(e){if(this.parent.invalidateLogicalGrid(!1),this.rendered&&this.htmlComp&&O.nvl(e,!0)){var t=this.htmlComp.getParent();t&&t.invalidateLayoutTree()}}},{key:"revalidateLogicalGrid",value:function(e){this.invalidateLogicalGrid(e),this.validateLogicalGrid()}},{key:"setLogicalGrid",value:function(e){this.setProperty("logicalGrid",e)}},{key:"_setLogicalGrid",value:function(e){"string"==typeof e&&(e=O.create(e)),this._setProperty("logicalGrid",e),this.invalidateLogicalGrid()}},{key:"_createEventSupport",value:function(){return new ln}},{key:"trigger",value:function(e,t){(t=t||{}).source=this,this.events.trigger(e,t)}},{key:"one",value:function(e,t){this.events.one(e,t)}},{key:"on",value:function(e,t){return this.events.on(e,t)}},{key:"off",value:function(e,t){this.events.off(e,t)}},{key:"addListener",value:function(e){this.events.addListener(e)}},{key:"removeListener",value:function(e){this.events.removeListener(e)}},{key:"when",value:function(e){return this.events.when(e)}},{key:"entryPoint",value:function(){var e=O.nvl(this.$container,this.parent.$container);if(!e||!e.length)throw new Error("Cannot resolve entryPoint, $element.length is 0 or undefined");return e.entryPoint()}},{key:"window",value:function(e){var t=this.$container||this.$parent;return t?t.window(e):e?null:s()(null)}},{key:"document",value:function(e){var t=this.$container||this.$parent;return t?t.document(e):e?null:s()(null)}},{key:"attach",value:function(){!this.attached&&this.rendered&&(this._attach(),this._installFocusContext(),this.restoreFocus(),this.attached=!0,this._postAttach(),this._onAttach(),this._triggerChildrenOnAttach(this))}},{key:"_attach",value:function(){}},{key:"_postAttach",value:function(){}},{key:"_triggerChildrenOnAttach",value:function(e){this.children.forEach((function(t){t._onAttach(),t._triggerChildrenOnAttach(e)}))}},{key:"_onAttach",value:function(){this.rendered&&this._renderOnAttach()}},{key:"_renderOnAttach",value:function(){this._renderScrollTop(),this._renderScrollLeft()}},{key:"detach",value:function(){this.rendering&&this._postRenderActions.push(this.detach.bind(this)),this.attached&&this.rendered&&!this._isRemovalPending()&&(this._beforeDetach(),this._onDetach(),this._triggerChildrenOnDetach(this),this._detach(),this.attached=!1)}},{key:"_beforeDetach",value:function(e){if(this.$container){var t=this.$container.document(!0).activeElement,n=this.$container.isOrHas(t),r=this.session.focusManager;r.isFocusContextInstalled(this.$container)?this._uninstallFocusContext():n&&r.validateFocus(Eo.outsideFilter(this.$container))}}},{key:"_triggerChildrenOnDetach",value:function(){this.children.forEach((function(e){e._onDetach(),e._triggerChildrenOnDetach(parent)}))}},{key:"_onDetach",value:function(){this.rendered&&this._renderOnDetach()}},{key:"_renderOnDetach",value:function(){}},{key:"_detach",value:function(){}},{key:"_uninstallFocusContext",value:function(){}},{key:"_installFocusContext",value:function(){}},{key:"_createKeyStrokeContext",value:function(){return null}},{key:"updateKeyStrokes",value:function(e,t){this.unregisterKeyStrokes(t),this.registerKeyStrokes(e)}},{key:"registerKeyStrokes",value:function(e){this.keyStrokeContext.registerKeyStrokes(e)}},{key:"unregisterKeyStrokes",value:function(e){this.keyStrokeContext.unregisterKeyStrokes(e)}},{key:"triggerPropertyChange",value:function(e,t,n){O.assertParameter("propertyName",e);var r=new sn({propertyName:e,oldValue:t,newValue:n});return this.trigger("propertyChange",r),r}},{key:"_setProperty",value:function(e,t){O.assertParameter("propertyName",e);var n=this[e];Pr.equals(n,t)||(this[e]=t,this.triggerPropertyChange(e,n,t).defaultPrevented&&(this[e]=n))}},{key:"setProperty",value:function(e,t){Pr.equals(this[e],t)||(t=this._prepareProperty(e,t),this.rendered&&this._callRemoveProperty(e),this._callSetProperty(e,t),this.rendered&&this._callRenderProperty(e))}},{key:"_prepareProperty",value:function(e,t){return this.isWidgetProperty(e)?this._prepareWidgetProperty(e,t):t}},{key:"_prepareWidgetProperty",value:function(e,t){t=this._createChildren(t);var n=this[e];return n&&Array.isArray(t)&&(n=rt.diff(n,t)),this.isPreserveOnPropertyChangeProperty(e)||(this._destroyChildren(n),this.link(t)),t}},{key:"_callRemoveProperty",value:function(e){if(this.isWidgetProperty(e)&&!this.isPreserveOnPropertyChangeProperty(e)){var t=this[e];if(t){var n="_remove"+Wn.toUpperCaseFirstLetter(e);this[n]?this[n]():this._internalRemoveWidgets(t)}}}},{key:"_internalRemoveWidgets",value:function(e){(e=rt.ensure(e)).forEach((function(e){e.remove()}))}},{key:"_callSetProperty",value:function(e,t){var n="_set"+Wn.toUpperCaseFirstLetter(e);this[n]?this[n](t):this._setProperty(e,t)}},{key:"_callRenderProperty",value:function(e){var t="_render"+Wn.toUpperCaseFirstLetter(e);this[t]&&this[t]()}},{key:"link",value:function(e){e&&(e=rt.ensure(e)).forEach((function(e,t){e.setParent(this)}),this)}},{key:"glassPaneTargets",value:function(e){var t=function(e){return rt.flatMap(this._glassPaneContributions,(function(t){var n=t(e);return n?rt.ensure(n):[]})).concat(this._glassPaneTargets(e))}.bind(this);return this.rendered?t(e):rh.createFor(this,t.bind(this,e))}},{key:"_glassPaneTargets",value:function(e){return[this.$container].concat(this.session.desktop.getPopupsFor(this).reduce((function(e,t){return e.concat(t.glassPaneTargets())}),[]))}},{key:"addGlassPaneContribution",value:function(e){this._glassPaneContributions.push(e),this.trigger("glassPaneContributionAdded",{contribution:e})}},{key:"removeGlassPaneContribution",value:function(e){rt.remove(this._glassPaneContributions,e),this.trigger("glassPaneContributionRemoved",{contribution:e})}},{key:"toString",value:function(){var e="";return e+="id="+this.id,e+=" objectType="+this.objectType,e+=" rendered="+this.rendered,this.$container&&(e+=" $container="+qs.debugOutput(this.$container)),"Widget["+e.trim()+"]"}},{key:"ancestorsToString",value:function(e){var t="",n=this.ancestors();return e=O.nvl(e,-1),n.some((function(r,o){return e>-1&&o>=e||(o>0&&o<n.length-1&&(t+="\n"),t+=r.toString(),!1)})),t}},{key:"resolveTextKeys",value:function(e){e.forEach((function(e){bp.resolveTextProperty(this,e)}),this)}},{key:"resolveIconIds",value:function(e){e.forEach((function(e){gn.resolveIconProperty(this,e)}),this)}},{key:"resolveConsts",value:function(e){e.forEach((function(e){Pr.resolveConstProperty(this,e)}),this)}},{key:"_addWidgetProperties",value:function(e){this._addProperties("_widgetProperties",e)}},{key:"isWidgetProperty",value:function(e){return this._widgetProperties.indexOf(e)>-1}},{key:"_addCloneProperties",value:function(e){this._addProperties("_cloneProperties",e)}},{key:"isCloneProperty",value:function(e){return this._cloneProperties.indexOf(e)>-1}},{key:"_addPreserveOnPropertyChangeProperties",value:function(e){this._addProperties("_preserveOnPropertyChangeProperties",e)}},{key:"isPreserveOnPropertyChangeProperty",value:function(e){return this._preserveOnPropertyChangeProperties.indexOf(e)>-1}},{key:"_addProperties",value:function(e,t){(t=rt.ensure(t)).forEach((function(t){if(this[e].indexOf(t)>-1)throw new Error(e+" already contains the property "+t);this[e].push(t)}),this)}},{key:"_eachProperty",value:function(e,t){var n,r,o;for(n in e)this._widgetProperties.indexOf(n)>-1||t(n,r=e[n]);for(o=0;o<this._widgetProperties.length;o++)void 0!==(r=e[n=this._widgetProperties[o]])&&t(n,r,!0)}},{key:"_removeWidgetProperties",value:function(e){Array.isArray(e)?rt.removeAll(this._widgetProperties,e):rt.remove(this._widgetProperties,e)}},{key:"cloneAndMirror",value:function(e){return this.clone(e,{delegateAllPropertiesToClone:!0})}},{key:"original",value:function(){for(var e=this;e.cloneOf;)e=e.cloneOf;return e}},{key:"clone",value:function(e,t){var n,r;return e=e||{},t=t||{},r=Pr.extractProperties(this,e,this._cloneProperties),n=O.create(this.objectType,r),n.cloneOf=this,this._mirror(n,t),this.logicalGrid?n.setLogicalGrid(this.logicalGrid.objectType):n.setLogicalGrid(null),n}},{key:"_deepCloneProperties",value:function(e,t,n){var r=this;if(!t)return e;(t=rt.ensure(t)).forEach((function(t){var o=r[t],i=null;if(void 0===o)throw new Error("Property '"+t+"' is undefined. Deep copy not possible.");i=r._widgetProperties.indexOf(t)>-1?Array.isArray(o)?o.map((function(t){return t.clone({parent:e},n)})):o.clone({parent:e},n):Array.isArray(o)?o.map((function(e){return e})):o,e[t]=i}))}},{key:"mirror",value:function(e,t){if(!(t=t||this.cloneOf))throw new Error("No target for mirroring.");this._mirror(t,e)}},{key:"_mirror",value:function(e,t){var n=this,r=rt.find(this.eventDelegators,(function(t){return t.clone===e}));if(r)throw new Error("_mirror can only be called on not mirrored widgets. call unmirror first.");t=t||{},r={clone:e,originalToClone:vt.create(this,e,{delegateProperties:t.delegatePropertiesToClone,delegateAllProperties:t.delegateAllPropertiesToClone}),cloneToOriginal:vt.create(e,this,{delegateProperties:t.delegatePropertiesToOriginal,delegateAllProperties:t.delegateAllPropertiesToOriginal,excludeProperties:t.excludePropertiesToOriginal,delegateEvents:t.delegateEventsToOriginal})},this.eventDelegators.push(r),e.one("destroy",(function(){n._unmirror(e)}))}},{key:"unmirror",value:function(e){if(!(e=e||this.cloneOf))throw new Error("No target for unmirroring.");this._unmirror(e)}},{key:"_unmirror",value:function(e){var t=rt.findIndex(this.eventDelegators,(function(t){return t.clone===e})),n=t>-1?this.eventDelegators.splice(t,1)[0]:null;n&&(n.originalToClone&&n.originalToClone.destroy(),n.cloneToOriginal&&n.cloneToOriginal.destroy())}},{key:"_onParentDestroy",value:function(e){this.destroyed||this.setParent(this.owner)}},{key:"callSetter",value:function(e,t){var n="set"+Wn.toUpperCaseFirstLetter(e);this[n]?this[n](t):this.setProperty(e,t)}},{key:"widget",value:function(e){return t(this)?this:this.findChild(t);function t(t){if(t.id===e)return t}}},{key:"nearestWidget",value:function(e,t){if(this.id===e)return this;for(var n=this.children.slice();n.length;){var r=n.shift();if(r.id===e)return r;if(t)for(var o=0;o<r.children.length;o++){var i=r.children[o];i.parent===r&&n.push(i)}}return null}},{key:"findParent",value:function(e){for(var t=this.parent;t;){if(e(t))return t;t=t.parent}return t}},{key:"findChild",value:function(e){var t=null;return this.visitChildren((function(n){if(e(n))return t=n,!0})),t}},{key:"setTrackFocus",value:function(e){this.setProperty("trackFocus",e)}},{key:"_renderTrackFocus",value:function(){this.$container&&(this.trackFocus?this.$container.on("focusin",this._focusInListener):this.$container.off("focusin",this._focusInListener))}},{key:"restoreFocus",value:function(){this._$lastFocusedElement?this.session.focusManager.requestFocus(this._$lastFocusedElement):this._storedFocusedWidget&&(this._storedFocusedWidget.focus(),this._storedFocusedWidget=null)}},{key:"_onFocusIn",value:function(e){if(!this.rendering){var t=s()(e.target);this.$container.has(t)&&(this._$lastFocusedElement=t)}}},{key:"focus",value:function(){return this.rendered?this.session.focusManager.requestFocus(this.getFocusableElement()):(this.session.layoutValidator.schedulePostValidateFunction(this.focus.bind(this)),!1)}},{key:"focusAndPreventDefault",value:function(e){return!!this.focus()&&(e.preventDefault(),!0)}},{key:"isFocused",value:function(){return this.rendered&&Uf.isActiveElement(this.getFocusableElement())}},{key:"isFocusable",value:function(){if(!this.rendered||!this.visible)return!1;var e=this.getFocusableElement();return!!e&&s.a.ensure(e).is(":focusable")}},{key:"getFocusableElement",value:function(){return this.rendered&&this.$container?this.$container[0]:null}},{key:"_installScrollbars",value:function(e){var t=this.get$Scrollable();if(!t)throw new Error("Scrollable is not defined, cannot install scrollbars");if(!t.data("scrollable")){e=e||{};var n={parent:this};e=s.a.extend({},n,e),Lh.install(t,e),t.on("scroll",this._scrollHandler)}}},{key:"_uninstallScrollbars",value:function(){var e=this.get$Scrollable();e&&e.data("scrollable")&&(Lh.uninstall(e,this.session),e.off("scroll",this._scrollHandler),this.removing||(0===e[0].scrollTop&&(this.scrollTop=null),0===e[0].scrollLeft&&(this.scrollLeft=null)))}},{key:"_onScroll",value:function(){var e=this.get$Scrollable();this.scrollTop=e[0].scrollTop,this.scrollLeft=e[0].scrollLeft}},{key:"setScrollTop",value:function(e){this.getDelegateScrollable()?this.getDelegateScrollable().setScrollTop(e):this.scrollTop!==e&&(this.scrollTop=e,this.rendered&&this._renderScrollTop())}},{key:"_renderScrollTop",value:function(){var e=this.get$Scrollable();e&&null!==this.scrollTop&&(this.rendering||this.htmlComp&&!this.htmlComp.layouted&&!this.htmlComp.layouting?this.session.layoutValidator.schedulePostValidateFunction(this._renderScrollTop.bind(this)):Lh.scrollTop(e,this.scrollTop))}},{key:"setScrollLeft",value:function(e){this.getDelegateScrollable()?this.getDelegateScrollable().setScrollLeft(e):this.scrollLeft!==e&&(this.scrollLeft=e,this.rendered&&this._renderScrollLeft())}},{key:"_renderScrollLeft",value:function(){var e=this.get$Scrollable();e&&null!==this.scrollLeft&&(this.rendering||this.htmlComp&&!this.htmlComp.layouted&&!this.htmlComp.layouting?this.session.layoutValidator.schedulePostValidateFunction(this._renderScrollLeft.bind(this)):Lh.scrollLeft(e,this.scrollLeft))}},{key:"get$Scrollable",value:function(){return this.$container}},{key:"getDelegateScrollable",value:function(){return null}},{key:"scrollToTop",value:function(e){if(this.getDelegateScrollable())this.getDelegateScrollable().scrollToTop();else{var t=this.get$Scrollable();t&&(this.rendered?Lh.scrollTop(t,0,e):this.session.layoutValidator.schedulePostValidateFunction(this.scrollToTop.bind(this)))}}},{key:"scrollToBottom",value:function(e){if(this.getDelegateScrollable())this.getDelegateScrollable().scrollToBottom();else{var t=this.get$Scrollable();t&&(this.rendered?Lh.scrollToBottom(t,e):this.session.layoutValidator.schedulePostValidateFunction(this.scrollToBottom.bind(this)))}}},{key:"reveal",value:function(e){if(this.rendered){var t=this.$container.scrollParent();0!==t.length&&Lh.scrollTo(t,this.$container,e)}}},{key:"visitChildren",value:function(e){for(var t=0;t<this.children.length;t++){var n=this.children[t];if(n.parent===this){var r=e(n);if(!0===r||r===iU.TERMINATE)return iU.TERMINATE;if(r!==iU.SKIP_SUBTREE&&(!0===(r=n.visitChildren(e))||r===iU.TERMINATE))return iU.TERMINATE}}}},{key:"isAttachedAndRendered",value:function(){return(this.rendered||this.rendering)&&this.$container.isAttached()}}])&&ye(t.prototype,n),r&&ye(t,r),e}();!function(e,t,n){t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}(ve,"DisabledStyle",{DEFAULT:0,READ_ONLY:1});var be=0;var me={createUniqueId:function(e){return(e=e||"sc")+be++},findFirstFocusableWidget:function(e,t){return!!(!t||t.rendered&&t.visible)&&rt.find(e,(function(e){return e.isFocusable()}))},get:function(e){for(e=s.a.ensure(e);e&&e.length>0;){var t=e.data("widget");if(t)return t;e=e.parent()}return null},uniqueIdSeqNo:be,updateFirstLastMarker:function(e){e.filter((function(e,t,n){return e.rendered&&e.isVisible()})).forEach((function(e,t,n){e.$container.toggleClass("first",0===t),e.$container.toggleClass("last",t===n.length-1)}))}};function ge(e){return(ge="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function we(e,t,n){return(we="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Te(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function ke(e,t){return(ke=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Se(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Te(e);if(t){var o=Te(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Oe(this,n)}}function Oe(e,t){return!t||"object"!==ge(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Te(e){return(Te=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Ce=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ke(e,t)}(i,e);var t,n,r,o=Se(i);function i(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(e=o.call(this)).widgets=[],e._addWidgetProperties(["widgets"]),e}return t=i,(n=[{key:"_render",value:function(){this.$container=this.$parent.appendDiv(),this.htmlComp=ea.install(this.$container,this.session)}},{key:"_renderProperties",value:function(){we(Te(i.prototype),"_renderProperties",this).call(this),this._renderWidgets()}},{key:"setWidgets",value:function(e){this.setProperty("widgets",e)}},{key:"_renderWidgets",value:function(){this.widgets.forEach((function(e){e.render()}),this),this.invalidateLayoutTree()}}])&&_e(t.prototype,n),r&&_e(t,r),i}(ve);function Pe(e){return(Pe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Re(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function xe(e,t){return(xe=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Ee(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ae(e);if(t){var o=Ae(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return De(this,n)}}function De(e,t){return!t||"object"!==Pe(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Ae(e){return(Ae=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Fe=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&xe(e,t)}(i,e);var t,n,r,o=Ee(i);function i(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(e=o.call(this))._addWidgetProperties(["childWidget"]),e}return t=i,(n=[{key:"setChildWidget",value:function(e){this.setProperty("childWidget",e)}}])&&Re(t.prototype,n),r&&Re(t,r),i}(ve);function $e(e){return($e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function je(e,t){return(je=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Be(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ie(e);if(t){var o=Ie(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Me(this,n)}}function Me(e,t){return!t||"object"!==$e(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Ie(e){return(Ie=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Le=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&je(e,t)}(n,e);var t=Be(n);function n(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),t.call(this)}return n}(de);function He(e){return(He="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ne(e){return function(e){if(Array.isArray(e))return Ve(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return Ve(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Ve(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ve(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function We(e){return null==e?[]:Array.isArray(e)?e:[e]}function ze(e,t){var n=!1;if(!t||0===t.length)return!1;for(var r=e.length-1;r>=0;r--)t.indexOf(e[r])>-1&&(e.splice(r,1),n=!0);return n}function Ge(e,t,n){Ue(e,[t],n)}function Ue(e,t,n){t=We(t),e.splice.apply(e,Ne([n,0].concat(t)))}function Ke(e,t){return e=We(e),(t=We(t)).every((function(t){return e.indexOf(t)>=0}))}function qe(e){return!Array.isArray(e)||0===e.length}function Ye(e,t){t=We(t),e.push.apply(e,Ne(t))}function Xe(e,t,n){if(!e||!t)return-1;for(var r=0;r<e.length;r++)if(t.call(n,e[r],r,e))return r;return-1}function Je(e,t,n){var r=Ze(e,t,n);return-1===r?null:e[r]}function Ze(e,t,n){if(!e||!n||t>=e.length)return-1;t<0&&(t=0);for(var r=t;r<e.length;r++){if(n(e[r],r))return r}return-1}function Qe(e,t,n){var r=et(e,t,n);return-1===r?null:e[r]}function et(e,t,n){if(!e||!n||t<0)return-1;t>=e.length&&(t=e.length-1);for(var r=t;r>=0;r--){if(n(e[r],r))return r}return-1}function tt(e,t,n){if(!e||0===e.length)return"";for(var r="",o=0;o<e.length;o++){var i=e[o];t&&o>0&&o<e.length&&(r+=t),n&&(i=Wn.encode(i)),r+=i}return r}function nt(e,t){for(var n=0;n<e.length;n++)if(e[n][0]===t[0])return n}var rt={$indexOf:nt,$remove:function(e,t){var n=nt(e,t);n>=0&&e.splice(n,1)},containsAll:Ke,containsAny:function(e,t){return e=We(e),(t=We(t)).some((function(t){return e.indexOf(t)>=0}))},diff:function(e,t){var n=e.slice();return ze(n,t),n},eachSibling:function(e,t,n){if(e&&n)for(var r=0;r<e.length;r++){var o=e[r];o!==t&&n(o,r)}},empty:qe,ensure:We,equals:function(e,t){if(e===t)return!0;if(!(e&&0!==e.length||t&&0!==t.length))return!0;if(!e||!t)return!1;if(e.length!==t.length)return!1;for(var n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0},equalsIgnoreOrder:function(e,t){return e===t||(!(e&&0!==e.length||t&&0!==t.length)||!(!e||!t)&&(e.length===t.length&&Ke(e,t)))},find:function(e,t,n){var r=Xe(e,t,n);return-1===r?null:e[r]},findFrom:function(e,t,n,r){return r?Qe(e,t,n):Je(e,t,n)},findFromForward:Je,findFromReverse:Qe,findIndex:Xe,findIndexFrom:function(e,t,n,r){return r?et(e,t,n):Ze(e,t,n)},findIndexFromForward:Ze,findIndexFromReverse:et,first:function(e){return Array.isArray(e)?e[0]:e},flatMap:function(e,t){var n=[];return e.forEach((function(e){Ye(n,t(e))})),n},flattenRec:function e(t,n){return We(t).reduce((function(t,r){return t.push(r),r&&n&&(t=t.concat(e(n(r),n))),t}),[])},format:tt,formatEncoded:function(e,t){return tt(e,t,!0)},greater:function(e,t){var n=0,r=0;return e&&(n=e.length),t&&(r=t.length),n>r},hasElements:function(e){return!qe(e)},init:function(e,t){for(var n=[],r=0;r<e;r++)n[r]=t;return n},insert:Ge,insertAll:Ue,insertSorted:function(e,t,n){for(var r=0,o=e.length-1;r<=o;){var i=r+Math.floor((o-r)/2),s=n(e[i],t);if(s<0)r=i+1;else{if(!(s>0)){for(r=i+1;r<e.length&&0===n(e[r],t);)r++;break}o=i-1}}e.splice(r,0,t)},last:function(e){return Array.isArray(e)?e[e.length-1]:e},max:function(e){if(null==e)return Math.max(e);var t=e.filter(Pr.isNumber);return Math.max.apply(Math,Ne(t))},min:function(e){if(null==e)return Math.min(e);var t=e.filter(Pr.isNumber);return Math.min.apply(Math,Ne(t))},move:function(e,t,n){var r=e.splice(t,1)[0];Ge(e,r,n)},pushAll:Ye,pushIfDefined:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];n=n.filter((function(e){return null!=e})),e&&n.length&&e.push.apply(e,Ne(n))},pushSet:function(e,t){t&&-1===e.indexOf(t)&&e.push(t)},remove:function(e,t){if(e){var n=e.indexOf(t);if(-1!==n)return e.splice(n,1),!0}return!1},removeAll:ze,replace:function(e,t,n){var r=e.indexOf(t);return-1!==r&&(e[r]=n),r},union:function(e,t){var n=[],r={};return e=We(e),t=We(t),e.forEach((function(e){var t=e;"object"===He(e)&&(t=e.id),r[t]=e,n.push(e)})),t.forEach((function(e){var t=e;"object"===He(e)&&(t=e.id),t in r||n.push(e)})),n},randomElement:function(e){if(e){if(!Array.isArray(e))return e;if(e.length)return e[Math.floor(Math.random()*e.length)]}}};function ot(e){return function(e){if(Array.isArray(e))return it(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return it(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return it(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function it(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function st(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var at=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.retryIntervals=[],this.minCallDuration=500,this.callCounter=0,this.deferred=s.a.Deferred(),this.aborted=!1,this.pendingCall=null,this.type=null,this.name=null,this.uniqueName=null,this.logPrefix="",this.result=null}var t,n,r;return t=e,(n=[{key:"init",value:function(t){s.a.extend(this,t),"number"==typeof this.maxRetries?this.retryIntervals=rt.init(this.maxRetries,0):(this.retryIntervals=this.retryIntervals?this.retryIntervals.slice():[],this.maxRetries=this.retryIntervals.length),this.uniqueName=O.nvl(this.type,"call")+"-"+e.GLOBAL_SEQ+++Wn.box(" ",this.name,""),this.initialized=!0}},{key:"_checkInitialized",value:function(){if(!this.initialized)throw new Error("Not initialized")}},{key:"_updateLogPrefix",value:function(){this.logPrefix=this.callCounter+"/"+(this.maxRetries+1)+" ["+this.uniqueName+"] "}},{key:"_resolve",value:function(){var e;s.a.log.isTraceEnabled()&&s.a.log.trace(this.logPrefix+"[RESOLVE]"),(e=this.deferred).resolve.apply(e,ot(rt.ensure(this.result)))}},{key:"_reject",value:function(){var e;s.a.log.isTraceEnabled()&&s.a.log.trace(this.logPrefix+"[REJECT]"),(e=this.deferred).reject.apply(e,ot(rt.ensure(this.result)))}},{key:"_setResult",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.result=t}},{key:"call",value:function(){return this._checkInitialized(),this._call(),this.deferred.promise()}},{key:"abort",value:function(){this._checkInitialized(),this._abort()}},{key:"_call",value:function(){var e=this;if(this.aborted)throw new Error("Call is aborted");this.callTimeoutId=null,this.callStartTimestamp=Date.now(),this.callCounter++,this._updateLogPrefix(),this.pendingCall=this._callImpl().always((function(){e.pendingCall=null})).done(this._setResultDone.bind(this)).done(this._onCallDone.bind(this)).fail(this._setResultFail.bind(this)).fail(this._onCallFail.bind(this))}},{key:"_callImpl",value:function(){throw new Error("Missing implementation: _callImpl()")}},{key:"_setResultDone",value:function(){this._setResult.apply(this,arguments)}},{key:"_setResultFail",value:function(){this._setResult.apply(this,arguments)}},{key:"_onCallDone",value:function(){this._resolve()}},{key:"_onCallFail",value:function(){if(this.aborted)return s.a.log.isTraceEnabled()&&s.a.log.trace(this.logPrefix+"Call aborted"),void this._reject();var e=this._nextRetryImpl.apply(this,arguments);if("number"!=typeof e)return s.a.log.isTraceEnabled()&&s.a.log.trace(this.logPrefix+"No retries remaining"),void this._reject();var t=Date.now()-this.callStartTimestamp,n=Math.max(this.minCallDuration-t,0),r=e+n;s.a.log.isTraceEnabled()&&s.a.log.trace(this.logPrefix+"Try again in "+r+" ms..."),this.callTimeoutId=setTimeout(this._call.bind(this),r)}},{key:"_nextRetryImpl",value:function(){return!!this.retryIntervals.length&&this.retryIntervals.shift()}},{key:"_abort",value:function(){if(this.aborted=!0,this.callTimeoutId)return s.a.log.isTraceEnabled()&&s.a.log.trace(this.logPrefix+"Cancelled scheduled retry"),clearTimeout(this.callTimeoutId),this.callTimeoutId=null,void this._reject();this._abortImpl()}},{key:"_abortImpl",value:function(){this.pendingCall&&"function"==typeof this.pendingCall.abort&&this.pendingCall.abort()}}])&&st(t.prototype,n),r&&st(t,r),e}();function lt(e){return new Br({message:e.text("ui.CopyToClipboardSuccessStatus"),severity:Br.Severity.INFO})}function ut(e,t){O.assertParameter("parent",e),O.create("DesktopNotification",{parent:e,closable:!1,duration:1234,status:t||lt(e.session)}).show()}!function(e,t,n){t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}(at,"GLOBAL_SEQ",0);var ct={copyText:function(e){O.assertParameter("options",e),e.parent&&!e.session&&(e.session=e.parent.session),O.assertProperty(e,"session");var t=function(e){if(navigator.clipboard)return navigator.clipboard.writeText(e.text);var t=e.parent&&e.parent.rendered?e.parent.document(!0):document,n=t.createElement("textarea");n.style.position="fixed",n.style.opacity="0.0",n.value=e.text,t.body.appendChild(n);var r=s()(n);e.session.focusManager.installFocusContext(r,Kf.AUTO),n.select();var o=s.a.Deferred();try{t.execCommand("copy")?o.resolve():o.reject()}catch(e){o.reject(e)}finally{e.session.focusManager.uninstallFocusContext(r),t.body.removeChild(n)}return o.promise()}(e);return e.parent&&O.nvl(e.showNotification,!0)?(function(e,t){var n=lt(e.parent.session);t.catch((function(){var t;t=e.parent.session,n=new Br({message:t.text("ui.CopyToClipboardFailedStatus"),severity:Br.Severity.WARNING})})).then((function(){ut(e.parent,n)}))}(e,t),null):t},showNotification:ut};function ft(e){return(ft="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var ht={DEFAULT:"default",ALTERNATIVE:"alternative",RAINBOW:"rainbow"};function pt(e,t){var n={};return e&&"object"===ft(e)?n=e:"string"==typeof e&&(Wn.startsWith(e,ht.DEFAULT)?n.scheme=ht.DEFAULT:Wn.startsWith(e,ht.ALTERNATIVE)?n.scheme=ht.ALTERNATIVE:Wn.startsWith(e,ht.RAINBOW)?n.scheme=ht.RAINBOW:n.scheme=Wn.removeSuffix(e,"-inverted"),n.inverted=Wn.endsWith(e,"-inverted")),Pr.isNullOrUndefined(t)||(n.tile=t),n}var dt={ColorSchemeId:ht,ensureColorScheme:pt,toggleColorSchemeClasses:function(e,t){e&&t&&(t=pt(t),e.toggleClass("color-alternative",t.scheme===dt.ColorSchemeId.ALTERNATIVE),e.toggleClass("color-rainbow",t.scheme===dt.ColorSchemeId.RAINBOW),e.toggleClass("inverted",!!t.inverted),e.toggleClass("tile",!!t.tile))},getCssClasses:function(e){var t=[];return e?((e=pt(e)).scheme===dt.ColorSchemeId.ALTERNATIVE?t.push("color-alternative"):e.scheme===dt.ColorSchemeId.RAINBOW?t.push("color-rainbow"):e.scheme&&t.push(e.scheme),e.inverted&&t.push("inverted"),e.tile&&t.push("tile"),t):t}};function yt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var vt=function(){function e(t,n,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),r=r||{},this.source=t,this.target=n,this.callSetter=O.nvl(r.callSetter,!0),this.delegateProperties=r.delegateProperties||[],this.excludeProperties=r.excludeProperties||[],this.delegateEvents=r.delegateEvents||[],this.delegateAllProperties=!!r.delegateAllProperties,this.delegateAllEvents=!!r.delegateAllEvents,this._mirrorListener=null,this._destroyHandler=null,this._installSourceListener()}var t,n,r;return t=e,r=[{key:"equalsProperty",value:function(e,t,n){var r=t[e];return Array.isArray(n)&&Array.isArray(r)?rt.equals(n,r):Pr.equals(r,n)}},{key:"create",value:function(t,n,r){return r.delegateProperties&&r.delegateProperties.length>0||r.delegateEvents&&r.delegateEvents.length>0||r.delegateAllProperties||r.delegateAllEvents?new e(t,n,r):null}}],(n=[{key:"destroy",value:function(){this._uninstallSourceListener()}},{key:"_installSourceListener",value:function(){if(this._mirrorListener)throw new Error("source listeners already installed.");this._mirrorListener={func:this._onSourceEvent.bind(this)},this.source.events.addListener(this._mirrorListener),this._destroyHandler=this._uninstallSourceListener.bind(this),this.source.on("destroy",this._destroyHandler),this.target.on("destroy",this._destroyHandler)}},{key:"_uninstallSourceListener",value:function(){this._mirrorListener&&(this.source.events.removeListener(this._mirrorListener),this._mirrorListener=null),this._destroyHandler&&(this.source.off("destroy",this._destroyHandler),this.target.off("destroy",this._destroyHandler),this._destroyHandler=null)}},{key:"_onSourceEvent",value:function(e){"propertyChange"===e.type?this._onSourcePropertyChange(e):(this.delegateAllEvents||this.delegateEvents.indexOf(e.type)>-1)&&this.target.trigger(e.type,e)}},{key:"_onSourcePropertyChange",value:function(t){if(!(this.excludeProperties.indexOf(t.propertyName)>-1)&&(this.delegateAllProperties||this.delegateProperties.indexOf(t.propertyName)>-1)){if(e.equalsProperty(t.propertyName,this.target,t.newValue))return;this.callSetter?this.target.callSetter(t.propertyName,t.newValue):this.target.trigger(t.type,t)}}}])&&yt(t.prototype,n),r&&yt(t,r),e}();function bt(e){return(bt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function mt(e,t,n,r){var o=new Date(e.getTime());return t&&(o.setFullYear(e.getFullYear()+t),St(o,e)!==12*t&&o.setDate(0)),n&&(o.setMonth(e.getMonth()+n),St(o,e)!==n+12*t&&o.setDate(0)),r&&o.setDate(e.getDate()+r),o}function gt(e,t){var n=t-e.getDay();return n<=0&&(n+=7),mt(e,0,0,n)}function _t(e,t){var n=t-e.getDay();return n>=0&&(n-=7),mt(e,0,0,n)}function wt(e,t,n){return n>0?gt(e,t):_t(e,t)}function kt(e,t){return wt(e,1,t)}function St(e,t){var n=e.getMonth(),r=t.getMonth(),o=e.getFullYear(),i=t.getFullYear(),s=n-r;return o===i?s:12*(o-i)+s}function Ot(e,t){if(e&&"number"==typeof t){var n=new Date(e.valueOf());return 4!==n.getDay()&&(n.getDay()<t&&n.setDate(n.getDate()-7),n.setDate(n.getDate()-n.getDay()+4)),n}}function Tt(e,t){if(e&&"number"==typeof t){var n=new Date(e.valueOf());return n.getDay()!==t&&n.setDate(n.getDate()-(n.getDay()+7-t)%7),n}}function Ct(e){if(!e)return null;var t,n="1970",r="01",o="01",i="00",s="00",a="00",l="000",u=!1,c=/^(\d{4})-(\d{2})-(\d{2}) (\d{2}):(\d{2}):(\d{2})\.(\d{3})(Z?)$/.exec(e);if(null!==c)n=c[1],r=c[2],o=c[3],i=c[4],s=c[5],a=c[6],l=c[7],u="Z"===c[8];else if(null!==(c=/^(\d{4})-(\d{2})-(\d{2})(Z?)$/.exec(e)))n=c[1],r=c[2],o=c[3],u="Z"===c[4];else{if(null===(c=/^(\d{2}):(\d{2}):(\d{2})\.(\d{3})(Z?)$/.exec(e)))throw new Error("Unparsable date: "+e);i=c[1],s=c[2],a=c[3],l=c[4],u="Z"===c[5]}return u?(t=new Date(Date.UTC(n,r-1,o,i,s,a,l)),n<100&&t.setUTCFullYear(n)):(t=new Date(n,r-1,o,i,s,a,l),n<100&&t.setFullYear(n)),t}function Pt(e,t,n,r){if(!e)return null;var o,i,s;void 0===n&&(n=!0),void 0===r&&(r=!0),t?(o=Wn.padZeroLeft(e.getUTCFullYear(),4)+"-"+Wn.padZeroLeft(e.getUTCMonth()+1,2)+"-"+Wn.padZeroLeft(e.getUTCDate(),2),i=Wn.padZeroLeft(e.getUTCHours(),2)+":"+Wn.padZeroLeft(e.getUTCMinutes(),2)+":"+Wn.padZeroLeft(e.getUTCSeconds(),2)+"."+Wn.padZeroLeft(e.getUTCMilliseconds(),3),s="Z"):(o=Wn.padZeroLeft(e.getFullYear(),4)+"-"+Wn.padZeroLeft(e.getMonth()+1,2)+"-"+Wn.padZeroLeft(e.getDate(),2),i=Wn.padZeroLeft(e.getHours(),2)+":"+Wn.padZeroLeft(e.getMinutes(),2)+":"+Wn.padZeroLeft(e.getSeconds(),2)+"."+Wn.padZeroLeft(e.getMilliseconds(),3),s="");var a="";return n&&(a+=o,r&&(a+=" ")),r&&(a+=i),a+=s}function Rt(e,t){if(!e&&!t)return 0;if(!e)return-1;if(!t)return 1;var n=e.getTime()-t.getTime();return n<-1?-1:n>1?1:n}function xt(e,t){return e&&(O.nvl(t,!0)&&(e=new Date(e.getTime())),e.setHours(0,0,0,0)),e}var Et={ceil:function(e,t,n){var r,o,i=O.nvl(t,30);return e&&(O.nvl(n,!0)&&(e=new Date(e.getTime())),e.setSeconds(0,0),o=parseInt((e.getMinutes()+i)/i)*i,r=e.getHours(),o>=60&&(r++,o=0),r>23&&(r=0,e.setDate(e.getDate()+1)),e.setHours(r,o)),e},combineDateTime:function(e,t){var n=new Date;return n.setHours(0,0,0,0),n.setFullYear(1970,0,1),e&&n.setFullYear(e.getFullYear(),e.getMonth(),e.getDate()),t&&(n.setHours(O.nvl(t.getHours(),0)),n.setMinutes(O.nvl(t.getMinutes(),0)),n.setSeconds(O.nvl(t.getSeconds(),0)),n.setMilliseconds(O.nvl(t.getMilliseconds(),0))),n},compare:Rt,compareDays:function(e,t){return(xt(e)-xt(t)-6e4*(e.getTimezoneOffset()-t.getTimezoneOffset()))/864e5},compareMonths:St,create:function(e){if(e){var t=/^(\d{4})(?:-(\d{2})(?:-(\d{2})(?: (\d{2})(?::(\d{2})(?::(\d{2})(?:\.(\d{3}))?(Z?))?)?)?)?)?/.exec(e);if(null===t)throw new Error("Unparsable date: "+e);return"Z"===t[8]?new Date(Date.UTC(t[1],(t[2]||1)-1,t[3]||1,t[4]||0,t[5]||0,t[6]||0,t[7]||0)):new Date(t[1],(t[2]||1)-1,t[3]||1,t[4]||0,t[5]||0,t[6]||0,t[7]||0)}},ensure:function(e){return e?e instanceof Date?e:Ct(e):e},ensureMonday:function(e,t){return 1===e.getDay()?e:kt(e,t)},equals:function(e,t){return 0===Rt(e,t)},firstDayOfWeek:Tt,format:function(e,t,n){return new tp(t,n).format(e)},formatDateTime:function(e,t){return new tp(t,t.dateFormatPatternDefault+" "+t.timeFormatPatternDefault).format(e)},isLeapYear:function(e){return null!=e&&29===new Date(e,1,29).getDate()},isSameDay:function(e,t){return!(!e||!t)&&(e.getFullYear()===t.getFullYear()&&e.getMonth()===t.getMonth()&&e.getDate()===t.getDate())},isSameMonth:function(e,t){return!(!e||!t)&&0===St(e,t)},isSameTime:function(e,t){return!(!e||!t)&&(e.getHours()===t.getHours()&&e.getMinutes()===t.getMinutes()&&e.getSeconds()===t.getSeconds())},newDate:function(){return new Date},orderWeekdays:function(e,t){for(var n=[],r=0;r<7;r++)n[r]=e[(r+t)%7];return n},parseJsonDate:Ct,shift:mt,shiftTime:function(e,t,n,r,o){var i=new Date(e.getTime());return t&&i.setHours(e.getHours()+t),n&&i.setMinutes(e.getMinutes()+n),r&&i.setSeconds(e.getSeconds()+r),o&&i.setMilliseconds(e.getMilliseconds()+o),i},shiftToNextDayOfType:gt,shiftToNextDayAndDate:function(e,t,n){var r=new Date(e.getTime());for(n<r.getDate()&&r.setMonth(r.getMonth()+1),r.setDate(n);r.getDay()!==t||r.getDate()!==n;)(r=mt(r,0,1,0)).setDate(n);return r},shiftToNextOrPrevDayOfType:wt,shiftToNextOrPrevMonday:kt,shiftToPreviousDayOfType:_t,timestamp:function(e,t){var n=e||new Date;return t?Wn.padZeroLeft(n.getUTCFullYear(),4)+Wn.padZeroLeft(n.getUTCMonth()+1,2)+Wn.padZeroLeft(n.getUTCDate(),2)+Wn.padZeroLeft(n.getUTCHours(),2)+Wn.padZeroLeft(n.getUTCMinutes(),2)+Wn.padZeroLeft(n.getUTCSeconds(),2)+Wn.padZeroLeft(n.getUTCMilliseconds(),3):Wn.padZeroLeft(n.getFullYear(),4)+Wn.padZeroLeft(n.getMonth()+1,2)+Wn.padZeroLeft(n.getDate(),2)+Wn.padZeroLeft(n.getHours(),2)+Wn.padZeroLeft(n.getMinutes(),2)+Wn.padZeroLeft(n.getSeconds(),2)+Wn.padZeroLeft(n.getMilliseconds(),3)},toJsonDate:Pt,toJsonDateRange:function(e){return{from:Pt(e.from),to:Pt(e.to)}},trunc:xt,weekInYear:function(e,t){if(e){var n=1;"object"===bt(t)?void 0!==t.symbols&&void 0!==t.symbols.firstDayOfWeek?n=t.symbols.firstDayOfWeek:void 0!==t.decimalFormatSymbols&&void 0!==t.decimalFormatSymbols.firstDayOfWeek&&(n=t.decimalFormatSymbols.firstDayOfWeek):"number"==typeof t&&(n=t);var r=Ot(e,n),o=new Date(r.getFullYear(),0,4),i=Tt(o,n);e.getTime()<i.getTime()&&(o=new Date(r.getFullYear()-1,0,4));var s=Ot(o,n),a=(r.getTime()-s.getTime())/864e5;return 1+Math.round(a/7)}}};function Dt(e){return(Dt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var At={},Ft={};function $t(e){Ft={},At=e.defaults||{},jt(e.objectTypeHierarchy||{},void 0,Ft),Object.keys(At).forEach((function(e){Ft[e]||(Ft[e]=[e])}),this)}function jt(e,t,n){if(e){if(!n)throw new Error("Argument 'targetMap' must not be null");Object.keys(e).forEach((function(r){var o=[r];if(t&&(o=o.concat(t)),"object"===Dt(e[r])&&jt(e[r],o,n),n[r])throw new Error("Object type '"+r+"' has ambiguous parent object types.");n[r]=o}),this)}}function Bt(e,t){void 0!==e&&void 0!==t&&Object.keys(t).forEach((function(n){var r=n;if(Wn.startsWith(n,"~")&&(r=n.substring(1)),void 0===e[r])e[r]=Pr.valueCopy(t[r]);else if(Pr.isPlainObject(e[r])&&Pr.isPlainObject(t[n]))Bt(e[r],t[n]);else if(Array.isArray(e[r])&&Pr.isPlainObject(t[n]))for(var o=e[r],i=0;i<o.length;i++)Pr.isPlainObject(o[i])&&Bt(o[i],t[n])}),this)}var Mt={applyTo:function e(t,n){if(Array.isArray(t))for(var r=0;r<t.length;r++)e(t[r],n);else"object"===Dt(t)&&(n=n||t.objectType)&&function(e,t){var n=Ft[t];if(!n){t=Z.parse(t).objectType.toString(),n=Ft[t]}if(!n)return;for(var r=0;r<n.length;r++){var o=n[r];Bt(e,At[o])}}(t,n)},bootstrap:function(e){return e=e||{},e=s.a.extend({},{url:"defaultValues"},e),s.a.ajaxJson(e.url).done($t.bind(this))},init:$t};function It(e,t,n,r){return(r=r||"")&&(r="."+r),e?t+r:n+r}function Lt(e){return e&&Wn.startsWith(e.type,"touch")}function Ht(e,t){if("function"==typeof Event){var n=new t.constructor(t.type,t);e.dispatchEvent(n)||t.preventDefault()}}var Nt={addPropagationListener:function(e,t,n,r){(n=rt.ensure(n)).forEach((function(n){e.addEventListener(n,(function(e){r&&!r(e)||Ht(t,e)}))}))},fixTouchEvent:function(e){if(Lt(e)){var t=e.touches||(e.originalEvent?e.originalEvent.touches:null),n=t?t[0]:null;n&&(e.pageX=Math.round(n.pageX),e.pageY=Math.round(n.pageY))}},isTouchEvent:Lt,onScrollStartEndDuringTouch:function(e,t,n){var r,o=!1,i=!1,s=function(e){o||(t(),o=!0),clearTimeout(r),l()},a=function(e){i=!0,l()};function l(){clearTimeout(r),r=setTimeout((function(){i&&(e.off("scroll",s),e.document().off("touchend touchcancel",a),n())}),50)}e.on("scroll",s),e.document().one("touchend touchcancel",a)},pageX:function(e){return Pr.isNullOrUndefined(e.pageX)?e.originalEvent.touches[0].pageX:e.pageX},pageY:function(e){return Pr.isNullOrUndefined(e.pageY)?e.originalEvent.touches[0].pageY:e.pageY},passiveOptions:function(){var e=!1;return Kt.get().supportsPassiveEventListener()&&(e={passive:!0}),e},propagateEvent:Ht,touchOrMouse:It,touchdown:function(e,t){return It(e,"touchstart","mousedown",t)},touchendcancel:function(e,t){return It(e,"touchend touchcancel","mouseup",t)},touchmove:function(e,t){return It(e,"touchmove","mousemove",t)}};var Vt,Wt={fileListToArray:function(e){for(var t=[],n=0;n<e.length;n++)t.push(e[n]);return t},validateMaximumUploadSize:function(e,t){return 0===(e=rt.ensure(e)).length||null==t||e.reduce((function(e,t){return e+t.size}),0)<=t}};function zt(e){return(zt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Gt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Ut(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Kt=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.userAgent=t.userAgent,this.features={},this.system=e.System.UNKNOWN,this.type=e.Type.DESKTOP,this.browser=e.Browser.UNKNOWN,this.browserVersion=0,this.scrollbarWidth=0,this.userAgent&&(this._parseSystem(),this._parseSystemVersion(),this._parseBrowser(),this._parseBrowserVersion())}var t,n,r;return t=e,r=[{key:"get",value:function(){return Vt}}],(n=[{key:"bootstrap",value:function(){var e=[];return this.scrollbarWidth=this._detectScrollbarWidth(),this.type=this._detectType(this.userAgent),this._needsFastClick()?e.push(this._loadFastClickDeferred()):this.isIos()&&this._installActiveHandler(),this._needsIPhoneRotationHack()&&this._fixIPhoneRotationBug(),e}},{key:"_needsFastClick",value:function(){return!(!this.isIos()||this.systemVersion>=9.3&&!this.isStandalone()&&this.browser!==e.Browser.UNKNOWN)}},{key:"_loadFastClickDeferred",value:function(){return this._loadScriptDeferred("fastclick-1.0.6.js",(function(){FastClick.attach(document.body),s.a.log.isInfoEnabled()&&s.a.log.info("FastClick script loaded and attached")}))}},{key:"_loadScriptDeferred",value:function(e,t){return s.a.injectScript(e).done(t)}},{key:"_installActiveHandler",value:function(){document.addEventListener("touchstart",(function(){}),!1)}},{key:"_needsIPhoneRotationHack",value:function(){return s.a.log.isDebugEnabled()&&s.a.log.debug("Activating iPhone rotation workaround."),this.isIphone()&&!this.isStandalone()&&"hidden"===s()(document.body).css("overflow")}},{key:"_fixIPhoneRotationBug",value:function(){s.a.log.isDebugEnabled()&&s.a.log.debug("Enabling iPhone rotation workaround.");var t=this.orientation(),n=0,r=document.documentElement;function o(){setTimeout((function(){r.scrollTop=0,++n<8&&o()}),50)}window.addEventListener("resize",(function(r){var i=e.get().orientation();t!==i&&(t=i,n=0,o())}))}},{key:"orientation",value:function(){return window.innerHeight>window.innerWidth?"portrait":"landscape"}},{key:"hasOnScreenKeyboard",value:function(){var e=this;return this.supportsFeature("_onScreenKeyboard",(function(){return e.isIos()||e.isAndroid()||e.isWindowsTabletMode()}))}},{key:"isScrollWidthIncludingPadding",value:function(){return this.isInternetExplorer()||this.isFirefox()||this.isEdge()}},{key:"isCustomEllipsisTooltipPossible",value:function(){return this.browser!==e.Browser.SAFARI}},{key:"isIos",value:function(){return e.System.IOS===this.system}},{key:"isEdge",value:function(){return e.Browser.EDGE===this.browser}},{key:"cssClassForEdge",value:function(){return this.isEdge()?"ms-edge":""}},{key:"cssClassForIphone",value:function(){return this.isIphone()?"iphone":""}},{key:"isIphone",value:function(){return this.userAgent.indexOf("iPhone")>-1}},{key:"isInternetExplorer",value:function(){return e.Browser.INTERNET_EXPLORER===this.browser}},{key:"isFirefox",value:function(){return e.Browser.FIREFOX===this.browser}},{key:"isChrome",value:function(){return e.Browser.CHROME===this.browser}},{key:"isIosPlatform",value:function(){return/iPad|iPhone|iPod/.test(navigator.platform)}},{key:"isAndroid",value:function(){return e.System.ANDROID===this.system}},{key:"isWindowsTabletMode",value:function(){return e.System.WINDOWS===this.system&&this.systemVersion>=10&&0===this.scrollbarWidth}},{key:"isStandalone",value:function(){return!!window.navigator.standalone}},{key:"isSupportedBrowser",value:function(t,n){t=O.nvl(t,this.browser),n=O.nvl(n,this.browserVersion);var r=e.Browser;return!(t===r.INTERNET_EXPLORER&&n<11||t===r.CHROME&&n<40||t===r.FIREFOX&&n<35||t===r.SAFARI&&n<8)}},{key:"_detectType",value:function(t){return e.System.ANDROID===this.system?t.indexOf("Mobile")>-1?e.Type.MOBILE:e.Type.TABLET:e.System.IOS===this.system?t.indexOf("iPad")>-1?e.Type.TABLET:e.Type.MOBILE:this.isWindowsTabletMode()?e.Type.TABLET:e.Type.DESKTOP}},{key:"_parseSystem",value:function(){var t=this.userAgent;t.indexOf("iPhone")>-1||t.indexOf("iPad")>-1?this.system=e.System.IOS:t.indexOf("Android")>-1?this.system=e.System.ANDROID:t.indexOf("Windows")>-1&&(this.system=e.System.WINDOWS)}},{key:"_parseSystemVersion",value:function(){var t,n=e.System,r=this.userAgent;this.system===n.IOS?(t=/ OS ([0-9]+\.?[0-9]*)/,r=r.replace(/_/g,".")):this.system===n.WINDOWS&&(t=/Windows NT ([0-9]+\.?[0-9]*)/),t&&(this.systemVersion=this._parseVersion(r,t))}},{key:"_parseBrowser",value:function(){var t=this.userAgent;t.indexOf("Firefox")>-1?this.browser=e.Browser.FIREFOX:t.indexOf("MSIE")>-1||t.indexOf("Trident")>-1?this.browser=e.Browser.INTERNET_EXPLORER:t.indexOf("Edge")>-1?this.browser=e.Browser.EDGE:t.indexOf("Chrome")>-1?this.browser=e.Browser.CHROME:t.indexOf("Safari")>-1&&(this.browser=e.Browser.SAFARI)}},{key:"_parseBrowserVersion",value:function(){var t,n=e.Browser,r=this.userAgent;this.browser===n.INTERNET_EXPLORER?t=r.indexOf("MSIE")>-1?/MSIE ([0-9]+\.?[0-9]*)/:/rv:([0-9]+\.?[0-9]*)/:this.browser===n.EDGE?t=/Edge\/([0-9]+\.?[0-9]*)/:this.browser===n.SAFARI?t=/Version\/([0-9]+\.?[0-9]*)/:this.browser===n.FIREFOX?t=/Firefox\/([0-9]+\.?[0-9]*)/:this.browser===n.CHROME&&(t=/Chrome\/([0-9]+\.?[0-9]*)/),t&&(this.browserVersion=this._parseVersion(r,t))}},{key:"_parseVersion",value:function(e,t){var n=t.exec(e);if(Array.isArray(n)&&2===n.length)return parseFloat(n[1])}},{key:"supportsFeature",value:function(e,t){return void 0===this.features[e]&&(this.features[e]=t(e)),this.features[e]}},{key:"supportsOnlyTouch",value:function(){return this.supportsFeature("_onlyTouch",this.hasOnScreenKeyboard.bind(this))}},{key:"supportsTouch",value:function(){return this.supportsFeature("_touch",(function(e){return"ontouchstart"in window||window.TouchEvent||window.DocumentTouch&&document instanceof window.DocumentTouch}))}},{key:"supportsFile",value:function(){return!!window.File}},{key:"supportsFileConstructor",value:function(){return"function"==typeof File}},{key:"supportsCssAnimation",value:function(){return this.supportsCssProperty("animation")}},{key:"supportsHistoryApi",value:function(){return!(!window.history||!window.history.pushState)}},{key:"supportsCssGradient",value:function(){return this.supportsFeature("gradient",this.checkCssValue.bind(this,"backgroundImage","linear-gradient(to left, #000 0%, #000 50%, transparent 50%, transparent 100% )",(function(e){return(e+"").indexOf("gradient")>0})))}},{key:"supportsInternationalization",value:function(){return window.Intl&&"object"===zt(window.Intl)}},{key:"supportsDownloadInSameWindow",value:function(){return e.Browser.FIREFOX!==this.browser}},{key:"supportsWebcam",value:function(){return this.supportsFeature("_webcam",(function(e){var t=Pr.optProperty(navigator,"mediaDevices","getUserMedia");return Pr.isFunction(t)}))}},{key:"hasPrettyScrollbars",value:function(){var e=this;return this.supportsFeature("_prettyScrollbars",(function(t){return 0===e.scrollbarWidth}))}},{key:"canHideScrollbars",value:function(){var e=this;return this.supportsFeature("_canHideScrollbars",(function(t){return 0===e._detectScrollbarWidth("hybrid-scrollable")}))}},{key:"supportsCopyFromDisabledInputFields",value:function(){return e.Browser.FIREFOX!==this.browser}},{key:"loosesFocusIfPseudoElementIsRemoved",value:function(){return e.Browser.FIREFOX===this.browser}},{key:"supportsCssProperty",value:function(t){return this.supportsFeature(t,(function(t){if(void 0!==document.body.style[t])return!0;t=t.charAt(0).toUpperCase()+t.slice(1);for(var n=0;n<e.VENDOR_PREFIXES.length;n++)if(void 0!==document.body.style[e.VENDOR_PREFIXES[n]+t])return!0;return!1}))}},{key:"supportsGeolocation",value:function(){return!!navigator.geolocation}},{key:"requiresSyntheticActiveState",value:function(){return this.isFirefox()}},{key:"supportsPassiveEventListener",value:function(){return this.supportsFeature("_passiveEventListener",(function(e){var t=!1;try{var n=Object.defineProperty({},"passive",{get:function(){return t=!0,!1}});window.addEventListener("test",n,n),window.removeEventListener("test",n,n)}catch(e){t=!1}return t}))}},{key:"checkCssValue",value:function(t,n,r){if(void 0===document.body.style[t])return!1;var o=document.createElement("div");if(o.style[t]=n,r(o.style[t]))return!0;t=t.charAt(0).toUpperCase()+t.slice(1);for(var i=0;i<e.VENDOR_PREFIXES.length;i++){var s=e.VENDOR_PREFIXES[i]+t;if(void 0!==document.body.style[s]&&(o.style[s]=n,r(o.style[s])))return!0}return!1}},{key:"hasTableCellZoomBug",value:function(){return this.browser===e.Browser.CHROME}},{key:"_detectScrollbarWidth",value:function(e){var t=s()("body").appendDiv(e).attr("id","MeasureScrollbar").css("width",50).css("height",50).css("overflow-y","scroll"),n=t[0],r=n.offsetWidth-n.clientWidth;return t.remove(),r}},{key:"toString",value:function(){return"scout.Device[system="+this.system+" browser="+this.browser+" browserVersion="+this.browserVersion+" type="+this.type+" scrollbarWidth="+this.scrollbarWidth+" features="+JSON.stringify(this.features)+"]"}}])&&Gt(t.prototype,n),r&&Gt(t,r),e}();function qt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}Ut(Kt,"VENDOR_PREFIXES",["Webkit","Moz","O","ms","Khtml"]),Ut(Kt,"Browser",{UNKNOWN:"Unknown",FIREFOX:"Firefox",CHROME:"Chrome",INTERNET_EXPLORER:"InternetExplorer",EDGE:"Edge",SAFARI:"Safari"}),Ut(Kt,"System",{UNKNOWN:"Unknown",IOS:"IOS",ANDROID:"ANDROID",WINDOWS:"WINDOWS"}),Ut(Kt,"Type",{DESKTOP:"DESKTOP",TABLET:"TABLET",MOBILE:"MOBILE"}),E.addListener("prepare",(function(){Vt||(Vt=O.create("Device",{userAgent:navigator.userAgent}))}));var Yt=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),t=t||{},this._lastPosX=null,this._lastPosY=null,this._lastTimestamp=null,this._maxDoubleClickInterval=t.maxDoubleClickInterval||500,this._maxDoubleClickDistance=t.maxDoubleClickDistance||10,this._doubleClicked=!1}var t,n,r;return t=e,(n=[{key:"mousedown",value:function(e){if(e&&"mousedown"===e.type){var t=O.nvl(e.pageX,0),n=O.nvl(e.pageY,0),r=Date.now(),o=!1;void 0!==this._lastTimestamp&&r-this._lastTimestamp<=this._maxDoubleClickInterval&&Math.max(Math.abs(t-this._lastPosX),Math.abs(n-this._lastPosY))<=this._maxDoubleClickDistance&&(o=!0),this._lastPosX=t,this._lastPosY=n,this._lastTimestamp=r,this._doubleClicked=o}}},{key:"doubleClicked",value:function(){return this._doubleClicked}}])&&qt(t.prototype,n),r&&qt(t,r),e}();function Xt(e){return(Xt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Jt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Zt=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),t=t||{},this.additionalDropProperties=null,this.allowedTypes=null,this.dropMaximumSize=null,this.target=null,this.onDrop=null,s.a.extend(this,t),this.supportedScoutTypes=rt.ensure(t.supportedScoutTypes),this._onDragEnterHandler=this._onDragEnter.bind(this),this._onDragOverHandler=this._onDragOver.bind(this),this._onDropHandler=this._onDrop.bind(this)}var t,n,r;return t=e,(n=[{key:"install",value:function(e,t){if(this.$element)throw new Error("Already installed.");this.selector=t,this.$element=e,this.$element.on("dragenter",this.selector,this._onDragEnterHandler).on("dragover",this.selector,this._onDragOverHandler).on("drop",this.selector,this._onDropHandler)}},{key:"uninstall",value:function(){this.$element.off("dragenter",this.selector,this._onDragEnterHandler).off("dragover",this.selector,this._onDragOverHandler).off("drop",this.selector,this._onDropHandler),this.$element=null,this.selector=null}},{key:"_onDragEnter",value:function(e){this._onDragEnterOrOver(e)}},{key:"_onDragOver",value:function(e){this._onDragEnterOrOver(e)}},{key:"_onDragEnterOrOver",value:function(e){e.originalEvent.dataTransfer.dropEffect="copy",rn.verifyDataTransferTypesScoutTypes(e,this.supportedScoutTypes,this.dropType())}},{key:"_onDrop",value:function(e){if(this.supportedScoutTypes.indexOf(rn.SCOUT_TYPES.FILE_TRANSFER)>=0&&(this.dropType()&rn.SCOUT_TYPES.FILE_TRANSFER)===rn.SCOUT_TYPES.FILE_TRANSFER&&rn.dataTransferTypesContainsScoutTypes(e.originalEvent.dataTransfer,rn.SCOUT_TYPES.FILE_TRANSFER)){if(!(this.onDrop&&e.originalEvent.dataTransfer.files instanceof FileList))return;var t=Wt.fileListToArray(e.originalEvent.dataTransfer.files);if(rt.empty(t))return;try{this.validateFiles(t)}catch(e){return void this._validationFailed(t,e)}e.stopPropagation(),e.preventDefault();var n={originalEvent:e,files:t};this.onDrop(n)}}},{key:"validateFiles",value:function(e){if(this.dropMaximumSize){var t=this.dropMaximumSize();if(!Wt.validateMaximumUploadSize(e,t))throw{title:this.target.session.text("ui.FileSizeLimitTitle"),message:this.target.session.text("ui.FileSizeLimit",t/1024/1024)}}}},{key:"_validationFailed",value:function(e,t){s.a.log.isDebugEnabled()&&s.a.log.debug("File validation failed",t);var n="",r="Invalid files";"object"===Xt(t)&&(n=t.title||n,r=t.message||r),PU.createOk(this.target).withSeverity(Br.Severity.ERROR).withHeader(n).withBody(r).buildAndOpen()}},{key:"uploadFiles",value:function(e){e.length>=1&&this.target.session.uploadFiles(this.target,e,this.additionalDropProperties?this.additionalDropProperties(event):void 0,this.dropMaximumSize?this.dropMaximumSize():void 0,this.allowedTypes?this.allowedTypes():void 0)}}])&&Jt(t.prototype,n),r&&Jt(t,r),e}(),Qt={FILE_TRANSFER:1,JAVA_ELEMENT_TRANSFER:2,TEXT_TRANSFER:4,IMAGE_TRANSFER:8};function en(e){var t=[];return(e=rt.ensure(e)).indexOf(Qt.FILE_TRANSFER)>=0&&t.push("Files"),t}function tn(e,t){return!!nn(e.originalEvent.dataTransfer,t)&&(e.stopPropagation(),e.preventDefault(),!0)}function nn(e,t){if(t=rt.ensure(t),e&&e.types){if(Array.isArray(e.types)&&rt.containsAny(e.types,t))return!0;if(e.types.contains)return t.some((function(t){return e.types.contains(t)}))}return!1}var rn={DEFAULT_DROP_MAXIMUM_SIZE:52428800,SCOUT_TYPES:Qt,dataTransferTypesContains:nn,dataTransferTypesContainsScoutTypes:function(e,t){return nn(e,en(t=rt.ensure(t)))},handler:function(e,t){return(t=t||{}).target=e,new Zt(t)},scoutTypeToDragTypeMapping:en,verifyDataTransferTypes:tn,verifyDataTransferTypesScoutTypes:function(e,t,n){t=rt.ensure(t);var r=[];void 0!==n?t.forEach((function(e){(n&e)===e&&rt.pushAll(r,en(t))})):r=en(t),Array.isArray(r)&&r.length>0&&tn(e,r)}};function on(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var sn=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.defaultPrevented=!1,s.a.extend(this,t)}var t,n,r;return t=e,(n=[{key:"preventDefault",value:function(){this.defaultPrevented=!0}}])&&on(t.prototype,n),r&&on(t,r),e}();function an(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var ln=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._eventListeners=[],this._subTypePredicates=Pr.createMap()}var t,n,r;return t=e,(n=[{key:"_assertFunc",value:function(e){if(!e)throw new Error("Missing callback function")}},{key:"on",value:function(e,t,n){this._assertFunc(t);var r={type:e,func:t,origFunc:n};return this.addListener(r),r}},{key:"one",value:function(e,t){var n=this;return this._assertFunc(t),this.on(e,(function r(o){n.off(e,r),t(o)}),t)}},{key:"off",value:function(e,t){if(e||t)for(var n=this._eventListeners.length-1;n>=0;n--){var r=this._eventListeners[n],o=t===r.func||t===r.origFunc,i=e===r.type;(t&&e?o&&i:t?o:i)&&this._eventListeners.splice(n,1)}}},{key:"when",value:function(e){var t=s.a.Deferred();return this.one(e,t.resolve.bind(t)),t.promise()}},{key:"addListener",value:function(e){this._eventListeners.push(e)}},{key:"removeListener",value:function(e){rt.remove(this._eventListeners,e)}},{key:"count",value:function(e,t){var n=0;return this._eventListeners.forEach((function(r){e&&e!==r.type||t&&t!==r.func||n++})),n}},{key:"trigger",value:function(e,t){(t=t||{}).type=e;for(var n=this._eventListeners.slice(),r=0;r<n.length;r++){var o=n[r];o.type&&!this._typeMatches(t,o.type)||o.func(t)}}},{key:"_typeMatches",value:function(e,t){for(var n=e.type,r=t.split(" "),o=0;o<r.length;o++){if(n===r[o])return!0;if(this._subTypeMatches(e,r[o]))return!0}return!1}},{key:"_subTypeMatches",value:function(e,t){if(t.indexOf(":")<0)return!1;var n=t.split(":"),r=n[0],o=n[1],i=this._subTypePredicates[r];return i?i(e,o):void 0}},{key:"registerSubTypePredicate",value:function(e,t){O.assertParameter("type",e),O.assertParameter("predicate",t),this._subTypePredicates[e]=t}}])&&an(t.prototype,n),r&&an(t,r),e}(),un=s.a.Deferred(),cn=!0;var fn="monospace",hn="ABC abc 123 .,_ LlIi1 oO0 !#@  ";function pn(e){var t=(e=e||{}).fonts||[];if(Array.isArray(t)||(t=[t]),e.onComplete){var n=[];if(t.forEach((function(t){if("string"==typeof t){var r=Wn.splitMax(t,"|",3).map((function(e){return e.trim()}));t={family:r[0],style:r[1],testString:r[2]}}t.family=t.family||"",t.style=t.style||"",t.testString=t.testString||e.testString||hn;var o=t.testFonts||e.testFonts||fn,i=s()("body").appendDiv("font-preloader").text(t.testString).css("display","block").css("visibility","hidden").css("position","absolute").css("top",0).css("left",0).css("width","auto").css("height","auto").css("margin",0).css("padding",0).css("white-space","nowrap").css("line-height","normal").css("font-variant","normal").css("font-size","20em").css("font-family",o),a=dn(i);if(i.data("original-size",a),i.data("font-family",t.family),i.css("font-family","'"+t.family+"',"+o),t.style){var l=(i.attr("style")||"").trim(),u=(";"===l.substr(-1)?"":";")+(l?" ":"");i.attr("style",l+u+t.style)}dn(i)!==a?i.remove():n.push(i)})),0!==n.length){var r,o,i=l,a=O.nvl(e.timeout,12e3);a&&a>=0&&(o=setTimeout((function(){clearTimeout(r),l(!1)}),a),i=function(){clearTimeout(o),l(!0)}),function e(t,o){var i=n.length;for(;i--;){var s=n[i];dn(s)!==s.data("original-size")&&(n.splice(i,1),s.remove())}if(0===n.length)return void o(!0);r=setTimeout((function(){t<1e3&&(t*=1.2),e(t,o)}),t)}(50,i)}else l(!0)}function l(t){e.onComplete(t,n.map((function(e){return e.data("font-family")})))}}function dn(e){var t=qs.size(e,{exact:!0});return t.width+"x"+t.height}function yn(){for(var e=[],t=document.styleSheets,n=0;n<t.length;n++){var r=t[n];try{r.cssRules}catch(e){s.a.log.info("Skipped automatic font detection for style sheet "+r.href+' (access blocked by browser). Use the bootstrap argument "fonts" to manually list fonts to pre-load.');continue}for(var o=0;o<r.cssRules.length;o++){var i=r.cssRules[o];if(i.type===window.CSSRule.FONT_FACE_RULE){var a=i.style,l=a.getPropertyValue("font-family"),u=a.getPropertyValue("font-weight"),c=a.getPropertyValue("font-style"),f=a.getPropertyValue("font-variant"),h=a.getPropertyValue("font-stretch");if(l){l=l.replace(/^["']|["']$/g,"");var p=[];u&&"normal"!==u&&p.push("font-weight:"+u),c&&"normal"!==c&&p.push("font-style:"+c),f&&"normal"!==f&&p.push("font-variant:"+f),h&&"normal"!==h&&p.push("font-stretch:"+h);var d={family:l};p.length&&(d.style=p.join(";")),e.push(d)}}}}return e}var vn={TEST_FONTS:fn,TEST_STRING:hn,TEST_TIMEOUT:12e3,autoDetectFonts:yn,bootstrap:function(e){return 0===(e=e||yn()).length?(cn=!0,s.a.resolvedPromise()):(cn=!1,pn({fonts:e,onComplete:function(e,t){!e&&t&&t.length&&s.a.log.warn("Timeout ocurred while pre-loading the following fonts:\n\n- "+t.join("\n- ")+'\n\nRendering will now continue, but font measurements may be inaccurate. To prevent unnecessary startup delays and layout problems, check the @font-face definitions and the referenced "src" URLs or programmatically add additional font-specific characters to TEST_STRING before calling app.init().'),cn=!0,un.resolve()}}),s.a.resolvedPromise())},loadingComplete:cn,measureSize:dn,preload:pn,preloader:function(){return un.promise()}},bn=/\${iconId:([a-zA-Z0-9_.]*)}/;function mn(e){var t,n=bn.exec(e);return n&&2===n.length&&(1===(t=n[1].split(".")).length?e=scout.icons[t]:2===t.length?e=window[t[0]].icons[t[1]]:s.a.log.warn("Invalid iconId: "+e)),e}var gn={ANGLE_DOUBLE_DOWN_BOLD:"font:",ANGLE_DOUBLE_LEFT:"font:",ANGLE_DOUBLE_LEFT_BOLD:"font:",ANGLE_DOUBLE_RIGHT:"font:",ANGLE_DOUBLE_RIGHT_BOLD:"font:",ANGLE_DOUBLE_UP_BOLD:"font:",ANGLE_DOWN:"font:",ANGLE_DOWN_BOLD:"font:",ANGLE_LEFT:"font:",ANGLE_LEFT_BOLD:"font:",ANGLE_RIGHT:"font:",ANGLE_RIGHT_BOLD:"font:",ANGLE_UP:"font:",ANGLE_UP_BOLD:"font:",ARROW_RIGHT_BOLD:"font:",AVG:"font:",AVG_BOLD:"font:",BOLD:"font:",CALENDAR:"font:",CALENDAR_BOLD:"font:",CARET_DOWN:"font:",CARET_LEFT:"font:",CARET_RIGHT:"font:",CARET_UP:"font:",CATEGORY:"font:",CATEGORY_SOLID:"font:",CHART:"font:",CHECKED_BOLD:"font:",CHEVRON_DOWN_BOLD:"font:",CHEVRON_LEFT_BOLD:"font:",CHEVRON_RIGHT_BOLD:"font:",CHEVRON_UP_BOLD:"font:",CIRCLE_BOLD:"font:",CLOCK_BOLD:"font:",COLLAPSE:"font:",ELLIPSIS_V:"font:",ELLIPSIS_V_BOLD:"font:",EXCLAMATION_MARK:"font:",EXCLAMATION_MARK_CIRCLE:"font:",FILE_SOLID:"font:",FOLDER:"font:",FOLDER_BOLD:"font:",GEAR:"font:",GRAPH_SOLID:"font:",GROUP:"font:",GROUP_PLUS:"font:",ICON_ID_REGEX:bn,INFO:"font:",ITALIC:"font:",LIGHTBULB_OFF:"font:",LIGHTBULB_ON:"font:",LIST:"font:",LIST_OL:"font:",LIST_OL_BOLD:"font:",LIST_UL:"font:",LIST_UL_BOLD:"font:",LONG_ARROW_DOWN:"font:",LONG_ARROW_DOWN_BOLD:"font:",LONG_ARROW_DOWN_PLUS:"font:",LONG_ARROW_LEFT_BOLD:"font:",LONG_ARROW_RIGHT_BOLD:"font:",LONG_ARROW_UP:"font:",LONG_ARROW_UP_BOLD:"font:",LONG_ARROW_UP_PLUS:"font:",MAX:"font:",MAX_BOLD:"font:",MENU_BOLD:"font:",MIN:"font:",MINUS:"font:",MINUS_BOLD:"font:",MIN_BOLD:"font:",EXPAND_ALL:"font:",COLLAPSE_ALL:"font:",PENCIL:"font:",PENCIL_BOLD:"font:",PENCIL_SOLID:"font:",PERSON_SOLID:"font:",PLUS:"font:",PLUS_BOLD:"font:",REMOVE:"font:",REMOVE_BOLD:"font:",ROTATE_LEFT_BOLD:"font:",ROTATE_RIGHT_BOLD:"font:",SEARCH:"font:",SEARCH_BOLD:"font:",SQUARE_BOLD:"font:",STAR:"font:",STAR_BOLD:"font:",STAR_MARKED:"font:",STAR_SOLID:"font:",STRIKETHROUGH:"font:",SUM:"font:",SUM_BOLD:"font:",TABLE_SORT_ASC:"font:↑",TABLE_SORT_DESC:"font:↓",TARGET:"font:",UNDERLINE:"font:",VERTICAL_DOTS:"font:",WORLD:"font:",parseIconId:function(e){var t=new lm;if(Wn.startsWith(e,"font:"))if(t.iconType=lm.IconType.FONT_ICON,e=e.substr(5),1===Wn.countCodePoints(e))t.font=lm.DEFAULT_FONT,t.iconCharacter=e;else{var n=e.split(" ");t.font=n[0],t.iconCharacter=n[1]}else t.iconType=lm.IconType.BITMAP,t.iconUrl=e;return t},resolveIconId:mn,resolveIconProperty:function(e,t){var n=e[t=t||"iconId"],r=mn(n);r!==n&&(e[t]=r)}};var _n={applyInfo:function(e,t){e&&(t=t||e.$container)&&(t.toggleAttr("data-id",!!e.id,e.id),t.toggleAttr("data-modelclass",!!e.modelClass,e.modelClass),t.toggleAttr("data-classid",!!e.classId,e.classId))}},wn={};function kn(e,t){if(t&&t.error)throw{error:t.error,url:e};Sn(t)}function Sn(e){e.forEach((function(e){wn[e.languageTag]=new _s(e)}),this)}function On(e){return wn[e]}function Tn(e){var t;return bp.createOrderedLanguageTags(e).some((function(e){return!!(t=On(e))}),this),t||null}function Cn(){return navigator.language||navigator.userLanguage}function Pn(){return Pr.values(wn)}function Rn(e){return O.assertParameter("language",e),rt.find(Pn(),(function(t){if(t.language===e)return t}),this)}function xn(e){return e?e.split("-"):[]}var En={bootstrap:function(e){return(e?s.a.ajaxJson(e):s.a.resolvedPromise([])).then(kn.bind(this,e))},findFirstForLanguage:Rn,get:Tn,getAll:Pn,getAllLanguageTags:function(){return Object.keys(wn)},getNavigatorLanguage:Cn,getNavigatorLocale:function(){var e=Cn();if(!e)return s.a.log.warn("Browser returned no language. Using default locale."),new _s;var t=Tn(e);return t||(s.a.log.isInfoEnabled()&&s.a.log.info("Locale for languageTag "+e+" not found. Trying to load best match."),(t=Rn(xn(e)[0]))?t:(s.a.log.isInfoEnabled()&&s.a.log.info("Still no matching locale for languageTag "+e+" found. Using default locale."),new _s))},has:function(e,t){return(t=O.nvl(t,!1))?!!On(e):!!Tn(e)},init:Sn,localesMap:wn,splitLanguageTag:xn},Dn=null,An=null;function Fn(e){return null!=e&&("string"==typeof(e=Hn(e))&&0!==e.length&&!/^\s*$/.test(e))}function $n(e){return!Fn(e)}function jn(e,t){if(null==e)return e;if("number"!=typeof t||t<1)return"";for(var n="",r=0;r<t;r++)n+=e;return n}function Bn(e,t){return null!=e&&null!=t&&(e=Hn(e),0===(t=Hn(t)).length||0!==e.length&&e.substr(0,t.length)===t)}function Mn(e,t){return null!=e&&null!=t&&(e=Hn(e),0===(t=Hn(t)).length||0!==e.length&&e.substr(-t.length)===t)}function In(e){return Dn||(Dn=new lo),Dn.encode(e)}function Ln(e,t){if(null==e)return e;var n="";return Fn(e=Hn(e))&&(n=e.charAt(0)[t]()+e.slice(1)),n}function Hn(e){return null==e||"string"==typeof e||e instanceof String?e:String(e)}function Nn(e){return $n(e)?null:e}function Vn(e,t,n){return e=Nn(e),t=Nn(t),!e&&!t||!(!e||!t)&&(n?e.toLowerCase()===t.toLowerCase():e===t)}var Wn={asString:Hn,box:function(e,t,n){e=Hn(e),t=Hn(t),n=Hn(n);var r="";return Fn(t)&&(e&&(r+=e),r+=t,n&&(r+=n)),r},contains:function(e,t){return!!e&&e.indexOf(t)>-1},count:function(e,t){return e&&null!=t?(e=Hn(e),t=Hn(t),e.split(t).length-1):0},countCodePoints:function(e){return e.replace(/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,"_").length},empty:$n,encode:In,endsWith:Mn,equals:Vn,equalsIgnoreCase:function(e,t){return Vn(e,t,!0)},hasText:Fn,insertAt:function(e,t,n){return e?(e=Hn(e),(t=Hn(t))&&("number"==typeof n||n instanceof Number)&&n>=0?e.substr(0,n)+t+e.substr(n):e):e},join:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var o=n;n[0]&&Pr.isArray(n[0])&&(o=n[0]),e=Hn(e);for(var i="",s=0;s<o.length;s++){var a=Hn(o[s]);a&&(i&&e&&(i+=e),i+=a)}return i},lowercaseFirstLetter:function(e){return Ln(e,"toLowerCase")},nl2br:function(e,t){return e?(e=Hn(e),(t=O.nvl(t,!0))&&(e=In(e)),e.replace(/\n/g,"<br>").replace(/\r/g,"")):e},nullIfEmpty:Nn,nvl:function(e){if(arguments.length>1)throw new Error("strings.nvl only accepts one argument. Use scout.nvl if you need to handle multiple arguments");return O.nvl(e,"")},padZeroLeft:function(e,t){return null==(e=Hn(e))||"number"!=typeof t||t<1||(e+"").length>=t?e:(jn("0",t)+e).slice(-t)},plainText:function(e,t){return An||(An=new so),An.encode(e,t)},quote:function(e){return null==e?e:(e=Hn(e)).replace(/[.*+?^${}()|[\]\\]/g,"\\$&")},removePrefix:function(e,t){var n=e;return Bn(e,t)&&(n=e.substring(t.length)),n},removeSuffix:function(e,t){var n=e;return Mn(e,t)&&(n=e.substring(0,e.length-t.length)),n},repeat:jn,splitMax:function(e,t,n){if(null==e)return[];e=Hn(e),t=Hn(t),n=Number(n);var r=e.split(t);if(isNaN(n)||n<=0||n>=r.length)return r;var o=r.slice(0,n-1),i=r.slice(n-1).join(t);return o.push(i),o},startsWith:Bn,toUpperCaseFirstLetter:function(e){return e.substring(0,1).toUpperCase()+e.substring(1)},truncateText:function(e,t,n){if(e&&t&&n&&t>0&&n(e).width>t){if(n(e=e.trim()).width<=t)return e;for(var r=e.length,o=0;o+1<r;){var i=Math.round((r+o)/2);n(e.slice(0,i)+"...").width>t?r=i:o=i}return e.slice(0,o).trim()+"..."}return e},uppercaseFirstLetter:function(e){return Ln(e,"toUpperCase")}},zn="trace",Gn=!1,Un=[];function Kn(e,t){e=O.nvl(e,zn),log4javascript.setShowStackTraces(true);var n=log4javascript.getDefaultLogger();n.setLevel(qn(e)),s.a.log=n,Gn=!0,t?n.getEffectiveAppenders().forEach((function(e){e.setUseDocumentWrite(!1)})):n.removeAllAppenders(),Un.forEach((function(e){Yn(e.factoryName,e.options)}),this),Un=[]}function qn(e){if(e)switch(e=e.toLowerCase()){case"trace":return log4javascript.Level.TRACE;case"debug":return log4javascript.Level.DEBUG;case"info":return log4javascript.Level.INFO;case"warn":return log4javascript.Level.WARN;case"error":return log4javascript.Level.ERROR;case"fatal":return log4javascript.Level.FATAL}}function Yn(e,t){if(Gn){var n=O.create(e,t);s.a.log.addAppender(n.create())}else Un.push({factoryName:e,options:t})}var Xn={DEFAULT_LEVEL:zn,addAppender:Yn,bootstrap:function(e){var t=new xo,n=t.getParameter("logging"),r=t.getParameter("logLevel"),o=!(!(e=O.nvl(e,{})).enabled&&!n),i=!(!e.showPopup&&!n),a=Wn.nvl(e.resourceUrl);return s.a.log=new Zn,o?window.log4javascript?(Kn(r,i),s.a.resolvedPromise()):s.a.injectScript(a+"log4javascript-1.4.9/log4javascript.js").done(Kn.bind(this,r,i)):s.a.resolvedPromise()},initLog4Javascript:Kn,initialized:Gn,parseLevel:qn,showStackTraces:true};function Jn(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Zn=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,(n=[{key:"trace",value:function(){}},{key:"debug",value:function(){}},{key:"info",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._log("info",t)}},{key:"warn",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._log("warn",t)}},{key:"error",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._log("error",t)}},{key:"fatal",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._log("fatal",t)}},{key:"isEnabledFor",value:function(){return!1}},{key:"isTraceEnabled",value:function(){return!1}},{key:"isDebugEnabled",value:function(){return!1}},{key:"isInfoEnabled",value:function(){return!1}},{key:"isWarnEnabled",value:function(){return!1}},{key:"isErrorEnabled",value:function(){return!1}},{key:"isFatalEnabled",value:function(){return!1}},{key:"_log",value:function(e,t){var n=Pr.optProperty(window,"console");if(n){var r=n["fatal"===e?"error":e];if(r){t.length>0&&(t[0]=this._formatTime()+" ["+e.toUpperCase()+"] "+t[0]);try{r.apply(n,t)}catch(e){}}}}},{key:"_formatTime",value:function(){var e=new Date;return Wn.padZeroLeft(e.getHours(),2)+":"+Wn.padZeroLeft(e.getMinutes(),2)+":"+Wn.padZeroLeft(e.getSeconds(),2)+"."+Wn.padZeroLeft(e.getMilliseconds(),3)}}])&&Jn(t.prototype,n),r&&Jn(t,r),e}(),Qn="text/plain",er="text/html",tr="text/css",nr="text/javascript",rr="application/json",or="application/javascript",ir="application/zip";var sr={APPLICATION_JAVASCRIPT:or,APPLICATION_JSON:rr,APPLICATION_ZIP:ir,IMAGE_GIF:"image/gif",IMAGE_JPEG:"image/jpeg",IMAGE_JPG:"image/jpg",IMAGE_PNG:"image/png",JAVASCRIPT:"application/javascript",JSON:"application/json",TEXT_CSS:tr,TEXT_HTML:er,TEXT_JAVASCRIPT:nr,TEXT_PLAIN:Qn,ZIP:"application/zip",isJavaScript:function(e){return O.isOneOf(e,nr,or)},isTextMimeType:function(e){return O.isOneOf(e,Qn,er,tr,nr,or,rr)}},ar={};function lr(e){return function(e,t){var n=ar[e];if(!n)throw new Error("No model map entry found for id '"+e+"'");if(O.nvl(n.type,"model")!==t)throw new Error("Model '"+e+"' is not of type '"+t+"'");return s.a.extend(!0,{},n)}(e,"extension")}var ur={init:function(e){ar=e},extend:function(e,t){return"string"==typeof e&&(e=lr(e)),"function"==typeof e&&(e=e()),O.assertParameter("extensions",e.extensions),e.extensions.forEach((function(n){var r,o=O.assertParameter("operation",n.operation),i=O.assertParameter("target",n.target);if(!(r=i.root?t:Pr.findChildObjectByKey(t,"id",i.id)))throw new Error("Extension target not found: [extension: "+e.id+", target: "+i.id+"]");if("appendTo"===o)s.a.extend(r,n.extension);else if("insert"===o){r[i.property]=r[i.property]||[];var a=r[i.property],l=rt.ensure(n.extension);!function(e,t){var n=e.before||e.after;n&&e.groupWithTarget&&t.forEach((function(e){e.groupedWith=n}))}(i,l);var u=function(e,t){var n=t.length;e.before?-1===(n=rt.findIndex(t,(function(t){return t.id===e.before||t.groupedWith===e.before})))&&(n=t.length):e.after&&(-1===(n=rt.findIndex(t,(function(t){return t.id===e.after||t.groupedWith===e.after})))?n=t.length:n++);s.a.isNumeric(e.index)&&(n=e.index);return n}(i,a);rt.insertAll(a,l,u)}})),t},get:function(e,t){var n=e();return t&&(n.parent=t),n},getExtension:lr,modelMap:ar};var cr=1;function fr(e,t){if(null==e||!t)return e;var n=e?e<0?-1:1:0,r=Math.abs(t);e=Math.abs(e);var o,i=Wn.asString(e);return-1!==i.indexOf("e")&&(i=e.toFixed(20)),t<0?(o=(i=Wn.repeat("0",r)+i).split(".",2),i=1===o.length?i.substr(0,i.length-r)+"."+i.substr(i.length-r):o[0].substr(0,o[0].length-r)+"."+o[0].substr(o[0].length-r)+o[1]):t>0&&2===(o=(i+=Wn.repeat("0",r)).split(".",2)).length&&(i=o[0]+o[1].substr(0,r)+"."+o[1].substr(r)),i=i.replace(/^0*(\d)/g,"$1"),Number(i)*n}function hr(e){return"number"==typeof e&&!isNaN(e)}var pr={correlationId:function(e){e=e||11;for(var t="abcdefghjkmnpqrstuvwxyzABCDEFGHJKMNPQRSTUVWXYZ",n="23456789",r="",o=0;o<e;o++)r+=(o+1)%3==0?n[Math.floor(Math.random()*n.length)]:t[Math.floor(Math.random()*t.length)];return r+"/"+cr++},ensure:function(e){return Pr.isNullOrUndefined(e)?e:Number(e)},isNumber:hr,isInteger:function(e){return hr(e)&&isFinite(e)&&Math.floor(e)===e},randomId:function(e){e=e||8;for(var t="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789",n="",r=0;r<e;r++)n+=t[Math.floor(Math.random()*t.length)];return n},round:function(e,t,n){if(null==e)return e;switch(e=fr(e,n=n||0),t){case dr.UP:e=e<0?-Math.ceil(Math.abs(e)):Math.ceil(e);break;case dr.DOWN:e=e<0?-Math.floor(Math.abs(e)):Math.floor(e);break;case dr.CEILING:e=Math.ceil(e);break;case dr.FLOOR:e=Math.floor(e);break;case dr.HALF_DOWN:e=e<0?Math.round(e):-Math.round(-e);break;default:e=e<0?-Math.round(Math.abs(e)):Math.round(e)}return fr(e,-n)},shiftDecimalPoint:fr,toBase62:function(e){if(void 0!==e){for(var t,n="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789".split(""),r="";e>=1;)r=n[e-62*(t=Math.floor(e/62))]+r,e=t;return r}}},dr={UP:"UP",DOWN:"DOWN",CEILING:"CEILING",FLOOR:"FLOOR",HALF_UP:"HALF_UP",HALF_DOWN:"HALF_DOWN",HALF_EVEN:"HALF_EVEN",UNNECESSARY:"UNNECESSARY"};function yr(e){return(yr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var vr=/\${const:([^}]*)}/;function br(e){return"object"===yr(e)&&!gr(e)&&!Array.isArray(e)}function mr(e){return"string"==typeof e}function gr(e){return null==e}function _r(e){return s.a.isFunction(e)}function wr(e){return Array.isArray(e)}function kr(e,t){var n=[];if(e)for(var r in"function"!=typeof e.hasOwnProperty&&(t=!0),e)(t||e.hasOwnProperty(r))&&n.push(e[r]);return n}function Sr(e,t){return e===t||!!(e&&t&&e.equals&&t.equals)&&e.equals(t)}function Or(e,t){var n=e[t];if(!n||"function"!=typeof n)throw new Error("Function '"+t+"' does not exist on object. Check if it has been renamed or moved. Object: "+e);return n}function Tr(e){return e?Array.prototype.slice.call(e):[]}function Cr(e,t){if(!mr(e))return e;var n=vr.exec(e);if(n&&2===n.length){for(var r=n[1].split("."),o=t||window,i=0;i<r.length;i++)if(void 0===(o=o[r[i]]))return window.console.log("Failed to resolve constant '"+n[1]+"', object is undefined"),e;return o}return e}var Pr={CONST_REGEX:vr,argumentsToArray:Tr,checkFunctionOverrides:function(){var e=["ModelAdapter.init","ModelAdapter._init","Calendar.init"],t=["Legend:","[!] Function includes super call, and parent function uses arguments"," ~  Function includes super call, but parent function does not use arguments","    Function does not include super call","","Wrong number of arguments:"],n=["Different argument names:"];for(var r in O)if(O.hasOwnProperty(r)){var o=O[r];if("function"==typeof o&&o.parent)for(var i in o.prototype)if(o.prototype.hasOwnProperty(i)){var s=o.prototype[i];if("constructor"!==i&&o.prototype.hasOwnProperty(i)&&"function"==typeof s)for(var a=g(s),l=o.parent;l;){var u=l.prototype[i];if(l.prototype.hasOwnProperty(i)&&"function"==typeof u){for(var c=g(u),f=!1,h=0;h<c.length;h++)if(a.length<h||a[h]!==c[h]){f=!0;break}var p=r+"."+i;if(f&&-1===e.indexOf(p)){var d=p+"("+a.join(", ")+") does not correctly override "+_(u)+"."+i+"("+c.join(", ")+")",y=null!==s.toString().match(new RegExp("scout."+Wn.quote(r)+".parent.prototype."+Wn.quote(i)+".call\\(")),v=!1;if(y)for(var b=0;b<c.length;b++){var m=u.toString().match(new RegExp("[^.\\w]"+Wn.quote(c[b])+"[^\\w]","g"));if(null!==m&&m.length>1){v=!0;break}}d=(y?v?"[!]":" ~ ":"   ")+" "+d,a.length!==c.length?t.push(d):n.push(d)}}l=l.parent}}}return t.push(""),t.concat(n);function g(e){if("function"!=typeof e)throw new Error("Argument is not a function: "+e);var t=e.toString().replace(/\/\*.*?\*\/|\/\/.*$/gm,"").match(/^function[^(]*\((.*?)\)/m),n=[];return null!==t&&t[1].split(",").forEach((function(e,t){(e=e.trim()).length>0&&n.push(e)})),n}function _(e){for(var t in O)if(O.hasOwnProperty(t)){var n=O[t];if("function"==typeof n)for(var r in n.prototype)if(n.prototype.hasOwnProperty(r)){var o=n.prototype[r];if("constructor"!==r&&n.prototype.hasOwnProperty(r)&&"function"==typeof o&&o===e)return t}}return""}},copyOwnProperties:function(e,t,n){var r;for(r in n=rt.ensure(n),e)!Object.prototype.hasOwnProperty.call(e,r)||0!==n.length&&-1===n.indexOf(r)||(t[r]=e[r]);return t},copyProperties:function(e,t,n){var r;for(r in n=rt.ensure(n),e)0!==n.length&&-1===n.indexOf(r)||(t[r]=e[r]);return t},countOwnProperties:function(e){if(!Object.getPrototypeOf(e))return Object.keys(e).length;var t=0;for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t++;return t},createMap:function(e){var t=Object.create(null);return e&&s.a.extend(t,e),t},equals:Sr,equalsRecursive:function e(t,n){var r;if(br(t)&&br(n)){if(_r(t.equals)&&_r(n.equals))return t.equals(n);var o=Object.keys(t),i=Object.keys(n);if(!rt.equalsIgnoreOrder(o,i))return!1;for(r=0;r<o.length;r++)if(!e(t[o[r]],n[o[r]]))return!1;return!0}if(wr(t)&&wr(n)){if(t.length!==n.length)return!1;for(r=0;r<t.length;r++)if(!e(t[r],n[r]))return!1;return!0}return t===n},extractProperties:function(e,t,n){return n.forEach((function(n){void 0===t[n]&&(t[n]=e[n])})),t},findChildObjectByKey:function e(t,n,r){if(null==t||"object"!==yr(t))return null;if(t[n]===r)return t;var o;if(Array.isArray(t))for(var i=0;i<t.length;i++)if(o=e(t[i],n,r))return o;for(var s in t)if(Object.prototype.hasOwnProperty.call(t,s)&&(o=e(t[s],n,r)))return o;return null},forEachArgument:function(e,t){return Tr(e).forEach(t)},isArray:wr,isEmpty:function(e){if(br(e))return 0===Object.keys(e).length},isFunction:_r,isNullOrUndefined:gr,isNumber:function(e){return null!==e&&!isNaN(e)&&isFinite(e)&&!isNaN(parseFloat(e))},isPlainObject:br,isString:mr,keyByValue:function(e,t){return Object.keys(e)[kr(e).indexOf(t)]},mandatoryFunction:Or,optProperty:function(e){if(!e)return null;for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var o=n.length;if(0===o)return e;if(1===o)return e[n[0]];for(var i=0;i<o-1;i++)if(!(e=e[n[i]]))return null;return e[n[o-1]]},propertiesEquals:function(e,t,n){var r,o;for(r=0;r<n.length;r++)if(!Sr(e[o=n[r]],t[o]))return!1;return!0},replacePrototypeFunction:function(e,t,n,r){var o=e.prototype;Or(o,t),r&&(o[t+"Orig"]=o[t]),o[t]=n},resolveConst:Cr,resolveConstProperty:function(e,t){O.assertProperty(t,"property"),O.assertProperty(t,"constType");var n=e[t.property],r=Cr(n,t.constType);n!==r&&(e[t.property]=r)},someOwnProperties:function(e,t){return rt.ensure(t).some((function(t){return Object.prototype.hasOwnProperty.call(e,t)}))},someProperties:function(e,t){return rt.ensure(t).some((function(t){return t in e}))},valueCopy:function e(t){if(null==t||"object"!==yr(t))return t;var n;if(Array.isArray(t)){n=[];for(var r=0;r<t.length;r++)n[r]=e(t[r]);return n}for(var o in n={},t)Object.prototype.hasOwnProperty.call(t,o)&&(n[o]=e(t[o]));return n},values:kr};var Rr={install:function(e){!function(e){e.Math.sign||Object.defineProperty(e.Math,"sign",{value:function(e){return 0===(e=+e)||isNaN(e)?e:e>0?1:-1}})}(e)}};function xr(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Er=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.results=[],this.error=null,this.items=t,this.currentItem=0,this.aborted=!1}var t,n,r;return t=e,(n=[{key:"hasNext",value:function(){return!this.error&&!this.aborted&&this.currentItem<this.items.length}},{key:"next",value:function(){var e=this,t=this.currentItem;return this.createPromise().done((function(){for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];e._addResults.apply(e,[t,r])})).fail(function(){this.error=arguments.length>0?arguments:new Error("Promise execution failed")}.bind(this))}},{key:"createPromise",value:function(){if(this.currentItem>=this.items.length)throw new Error("items out of bounds");var e=this._createPromise();return this.currentItem++,e}},{key:"_createPromise",value:function(){return this.items[this.currentItem]()}},{key:"_addResults",value:function(e,t){0===t.length?t=void 0:1===t.length&&(t=t[0]),this.results[e]=t}},{key:"abort",value:function(){this.aborted=!0}}])&&xr(t.prototype,n),r&&xr(t,r),e}();var Dr={groupwise:function(e,t){var n=s.a.Deferred();return i(t),n.promise();function r(){setTimeout(i.bind(this,t))}function o(){n.reject.apply(n,t.error)}function i(t){if(t.hasNext()){for(var i=[];i.length<e&&t.hasNext();)i.push(t.next());s.a.promiseAll(i,!0).done(r).fail(o)}else n.resolve.apply(n,t.results)}},oneByOne:function(e){var t=s.a.Deferred();return o(e),t.promise();function n(){setTimeout(o.bind(this,e))}function r(){t.reject.apply(t,e.error)}function o(e){e.hasNext()?e.next().done(n).fail(r):t.resolve.apply(t,e.results)}},parallel:function(e,t,n){n=n||0;var r=s.a.Deferred(),o=0;return l(t),r.promise();function i(){o--,setTimeout(l.bind(this,t),n)}function a(){r.reject.apply(r,t.error)}function l(t){if("pending"===r.state()){for(;t.hasNext()&&o<e;)o++,t.next().done(i).fail(a);0===o&&r.resolve.apply(r,[t.results])}}}};function Ar(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Fr=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.from=t,this.to=n}var t,n,r;return t=e,(n=[{key:"equals",value:function(e){return this.from===e.from&&this.to===e.to}},{key:"subtract",value:function(t){if(0===t.size())return[new e(this.from,this.to)];if(this.from>=t.from&&this.to<=t.to)return[new e(0,0)];if(t.from>=this.from&&t.to<=this.to){var n=new e(this.from,t.from),r=new e(t.to,this.to);return 0===n.size()?[r]:0===r.size()?[n]:[n,r]}return t.from>this.from&&t.from<this.to?[new e(this.from,t.from)]:this.from>t.from&&this.from<t.to?[new e(t.to,this.to)]:[new e(this.from,this.to)]}},{key:"subtractAll",value:function(t){for(var n=t.shift(),r=[this],o=[];n;)r.forEach(i.bind(n)),r=o,o=[],n=t.shift();function i(e){rt.pushAll(o,e.subtract(n))}return 0===(r=r.filter((function(e){return e.size()>0}))).length&&r.push(new e(0,0)),r}},{key:"shrink",value:function(t){return 0===t.size()?new e(this.from,this.to):this.from>=t.from&&this.to<=t.to?new e(0,0):t.from>=this.from&&t.to<=this.to?new e(this.from,t.to):t.from>=this.from&&t.from<this.to?new e(this.from,t.from):this.from>t.from&&this.from<t.to?new e(t.to,this.to):t.to<this.from?new e(this.from-t.size()-1,this.to-t.size()-1):new e(this.from,this.to)}},{key:"union",value:function(t){if(this.to<t.from||t.to<this.from){var n=new e(this.from,this.to),r=new e(t.from,t.to);return 0===n.size()?[r]:0===r.size()?[n]:[n,r]}return[new e(Math.min(this.from,t.from),Math.max(this.to,t.to))]}},{key:"add",value:function(t){if(this.to<t.from||t.to<this.from){var n=new e(this.from,this.to),r=new e(t.from,t.to);if(0===n.size())return r;if(0===r.size())return n;throw new Error("Range to add has to border on the existing range. "+this+", "+t)}return new e(Math.min(this.from,t.from),Math.max(this.to,t.to))}},{key:"intersect",value:function(t){return this.to<=t.from||t.to<=this.from?new e(0,0):new e(Math.max(this.from,t.from),Math.min(this.to,t.to))}},{key:"size",value:function(){return this.to-this.from}},{key:"contains",value:function(e){return this.from<=e&&e<this.to}},{key:"toString",value:function(){return"scout.Range[from="+(null===this.from?"null":this.from)+" to="+(null===this.to?"null":this.to)+"]"}}])&&Ar(t.prototype,n),r&&Ar(t,r),e}();function $r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function jr(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Br=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.message=null,this.severity=e.Severity.ERROR,this.code=0,this.children=null,this.deletable=!0,s.a.extend(this,t),"string"==typeof this.severity&&(this.severity=e.Severity[this.severity.toUpperCase()]),t&&t.children&&Array.isArray(t.children)&&(this.children=t.children.map((function(t){return e.ensure(t)})))}var t,n,r;return t=e,r=[{key:"clone",value:function(e){return e?e.clone():null}},{key:"cssClassForSeverity",value:function(t){var n,r=e.Severity;switch(t){case r.OK:n="ok";break;case r.INFO:n="info";break;case r.WARNING:n="warning";break;case r.ERROR:n="error"}return n}},{key:"animateStatusMessage",value:function(e,t){if(Wn.endsWith(t,"...")){for(var n=e.makeSpan("ellipsis"),r=0;r<3;r++)n.append(e.makeSpan("animate-dot delay-"+r,"."));t=t.substring(0,t.length-3),e.empty().text(t).append(n)}else e.text(t)}},{key:"ensure",value:function(t){return t?t instanceof e?t:(t.objectType||(t.objectType="Status"),te.get().create(t)):t}},{key:"ok",value:function(t){return new e(e.ensureModel(t,e.Severity.OK))}},{key:"info",value:function(t){return new e(e.ensureModel(t,e.Severity.INFO))}},{key:"warning",value:function(t){return new e(e.ensureModel(t,e.Severity.WARNING))}},{key:"error",value:function(t){return new e(e.ensureModel(t,e.Severity.ERROR))}},{key:"ensureModel",value:function(e,t){return e="string"==typeof e?{message:e}:e||{},s.a.extend({},e,{severity:t})}},{key:"asFlatList",value:function(t){if(!t)return[];var n=[];return t.hasChildren()?t.children.forEach((function(t){rt.pushAll(n,e.asFlatList(t))})):n.push(t),n}},{key:"classForName",value:function(t){return{Status:e,DefaultStatus:Wr,ParsingFailedStatus:Xr,ValidationFailedStatus:no}[t]}}],(n=[{key:"cssClass",value:function(){return e.cssClassForSeverity(this.severity)}},{key:"isValid",value:function(){return this.severity===e.Severity.OK||this.severity===e.Severity.INFO}},{key:"isError",value:function(){return this.severity===e.Severity.ERROR}},{key:"isWarning",value:function(){return this.severity===e.Severity.WARNING}},{key:"isInfo",value:function(){return this.severity===e.Severity.INFO}},{key:"isOk",value:function(){return this.severity===e.Severity.OK}},{key:"asFlatList",value:function(){return e.asFlatList(this)}},{key:"clone",value:function(){return new e(s.a.extend({},this))}},{key:"equals",value:function(t){return t instanceof e&&!!Pr.equalsRecursive(this.children,t.children)&&Pr.propertiesEquals(this,t,["severity","message","invalidDate","invalidTime"])}},{key:"containsStatus",value:function(e){return this.containsStatusByPredicate((function(t){return t instanceof e}))}},{key:"containsStatusByPredicate",value:function(e){return this.asFlatList().some(e)}},{key:"addStatus",value:function(e){this.hasChildren()?this.children.push(e):this.children=[e],this._updateProperties()}},{key:"removeAllStatus",value:function(e){this.removeAllStatusByPredicate((function(t){return t instanceof e}))}},{key:"removeAllStatusByPredicate",value:function(e){this.hasChildren()&&(this.children.forEach((function(t){t.removeAllStatusByPredicate(e)})),this.children=this.children.filter((function(t){return!t.deletable||!e(t)})),this._updateProperties())}},{key:"_updateProperties",value:function(){if(!this.hasChildren())return this.message=null,this.severity=e.Severity.OK,void(this.code=0);var t=this.asFlatList().sort((function(e,t){return n(t)-n(e);function n(e){var t=1;return e instanceof Xr?t=4:e instanceof no&&(t=2),t*e.severity}}))[0];this.message=t.message,this.severity=t.severity,this.code=t.code}},{key:"hasChildren",value:function(){return!!(this.children&&this.children.length>0)}},{key:"ensureChildren",value:function(){if(Pr.isArray(this.children))return this.clone();var e=this.clone();return e.children=[this],e._updateProperties(),e}}])&&$r(t.prototype,n),r&&$r(t,r),e}();function Mr(e){return(Mr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ir(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Lr(e,t){return(Lr=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Hr(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Vr(e);if(t){var o=Vr(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Nr(this,n)}}function Nr(e,t){return!t||"object"!==Mr(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Vr(e){return(Vr=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}jr(Br,"Severity",{OK:1,INFO:256,WARNING:65536,ERROR:16777216}),jr(Br,"SEVERITY_CSS_CLASSES","error warning info ok");var Wr=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Lr(e,t)}(i,e);var t,n,r,o=Hr(i);function i(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),o.call(this,e)}return t=i,r=[{key:"error",value:function(e){return new i(Br.ensureModel(e,Br.Severity.ERROR))}},{key:"warning",value:function(e){return new i(Br.ensureModel(e,Br.Severity.WARNING))}},{key:"info",value:function(e){return new i(Br.ensureModel(e,Br.Severity.INFO))}}],(n=null)&&Ir(t.prototype,n),r&&Ir(t,r),i}(Br);function zr(e){return(zr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Gr(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Ur(e,t){return(Ur=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Kr(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Yr(e);if(t){var o=Yr(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return qr(this,n)}}function qr(e,t){return!t||"object"!==zr(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Yr(e){return(Yr=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Xr=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ur(e,t)}(i,e);var t,n,r,o=Kr(i);function i(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),o.call(this,e)}return t=i,r=[{key:"error",value:function(e){return new i(Br.ensureModel(e,Br.Severity.ERROR))}}],(n=null)&&Gr(t.prototype,n),r&&Gr(t,r),i}(Br);function Jr(e){return(Jr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Zr(e,t){return(Zr=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Qr(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=to(e);if(t){var o=to(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return eo(this,n)}}function eo(e,t){return!t||"object"!==Jr(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function to(e){return(to=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var no=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Zr(e,t)}(n,e);var t=Qr(n);function n(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),t.call(this,e)}return n}(Br);function ro(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var oo=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.tagName=t,this.cachedElement=null}var t,n,r;return t=e,(n=[{key:"get",value:function(){return this.cachedElement||(this.cachedElement=document.createElement(this.tagName)),this.cachedElement}}])&&ro(t.prototype,n),r&&ro(t,r),e}();function io(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var so=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.cache=new oo("textarea")}var t,n,r;return t=e,(n=[{key:"encode",value:function(e,t){if(t=t||{},!e)return e;e=(e=(e=(e=(e=(e=Wn.asString(e)).replace(/<br>|<br\/>|<\/p>|<p\/>|<\/div>|<\/li>|<\/tr>/gi,"\n")).replace(/<\/td>/gi," ")).replace(/<[^>]+>/gi,"")).replace(/^[ ]+/gm,"")).replace(/[ ]+$/gm,""),t.compact&&(e=e.replace(/\n{3,}/gm,"\n\n")),t.trim&&(e=e.trim());var n=this.cache.get();return n.innerHTML=e,n.value}}])&&io(t.prototype,n),r&&io(t,r),e}();function ao(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var lo=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.cache=new oo("div")}var t,n,r;return t=e,(n=[{key:"encode",value:function(e){if(!e)return e;var t=this.cache.get();return t.textContent=e,t.innerHTML}}])&&ao(t.prototype,n),r&&ao(t,r),e}();function uo(e){return function(e){if(Array.isArray(e))return co(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return co(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return co(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function co(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var fo={},ho=null;function po(e,t,n){var r=ho;r||((r=window.document.createElement("div")).style.display="none",window.document.body.appendChild(r),ho=r);var o=r.style.cssText;n=s.a.extend(!0,{},n,{display:""}),Object.keys(n).sort().forEach((function(e){r.style[e]=n[e]}));var i=r.style.cssText;r.style.display="none";var a=r.style.cssText;r.style.cssText=o;var l=rt.ensure(e),u=i?[].concat(uo(l),[i]):l,c=fo[u];t=(t=rt.ensure(t)).map((function(e){return{name:e,nameCamelCase:e.replace(/-(.)/g,(function(e,t){return t.toUpperCase()}))}})),c||yo(u,c={});var f=t.filter((function(e){return!(e.nameCamelCase in c)}));if(0===f.length)return c;r.className=l[0];for(var h=1;h<l.length;h++){var p=r.children[0];p||((p=window.document.createElement("div")).style.display="none",r.appendChild(p)),(r=p).className=l[h]}r.style.cssText=a;var d=window.getComputedStyle(r);f.forEach((function(e){c[e.nameCamelCase]=d[e.name]})),r.style.cssText=o,r=ho;do{r.className="",r=r.children[0]}while(r);return c}function yo(e,t){fo[e]=t}var vo={red:0,green:0,blue:0},bo={red:255,green:255,blue:255};function mo(e){if(e){var t=e.replace(/\s/g,"").match(/^rgba?\((\d+),(\d+),(\d+),?(\d+(\.\d+)?)?/i);if(null!==t)return{red:parseInt(t[1],10),green:parseInt(t[2],10),blue:parseInt(t[3],10),alpha:parseFloat(O.nvl(t[4],1))}}}function go(e,t,n,r){if("string"==typeof e&&(e=mo(e)),"string"==typeof n&&(n=mo(n)),e||n)return t=O.nvl(t,0),r=O.nvl(r,0),e||(e=vo,t=0),n||(n=vo,r=0),0===t&&0===r?"rgb(0,0,0)":"rgb("+pr.round((t*e.red+r*n.red)/(t+r))+","+pr.round((t*e.green+r*n.green)/(t+r))+","+pr.round((t*e.blue+r*n.blue)/(t+r))+")"}function _o(e){var t={};if(Wn.hasText(e))for(var n=e.split(/[-_,/.;]/),r=0;r<n.length;r++){var o=n[r].toUpperCase();"NULL"===o||"0"===o||"PLAIN"===o||("BOLD"===o?t.bold=!0:"ITALIC"===o?t.italic=!0:/^\d+$/.test(o)?t.size=o:"NULL"!==o&&(t.name=n[r]))}return t}function wo(e){if(!e)return"";var t="";return/^[A-Fa-f0-9]{3}([A-Fa-f0-9]{3})?$/.test(e)?t="#"+e:/^[A-Za-z0-9().,%-]+$/.test(e)&&(t=e),t}function ko(e,t,n){n=n||"";var r="";e&&(r=wo(e[Wn.lowercaseFirstLetter(n+"ForegroundColor")]));t&&t.css("color",r);var o="";return r&&(o+="color: "+r+"; "),o}function So(e,t,n){n=n||"";var r="";e&&(r=wo(e[Wn.lowercaseFirstLetter(n+"BackgroundColor")]));t&&t.css("background-color",r);var o="";return r&&(o+="background-color: "+r+"; "),o}function Oo(e,t,n){n=n||"";var r="",o="",i="",s="";if(e){var a=_o(e[Wn.lowercaseFirstLetter(n+"Font")]);a.bold&&(r="bold"),a.italic&&(o="italic"),a.size&&(i=a.size+"pt"),a.name&&(s=a.name)}t&&t.css("font-weight",r).css("font-style",o).css("font-size",i).css("font-family",s);var l="";return r&&(l+="font-weight: "+r+"; "),o&&(l+="font-style: "+o+"; "),i&&(l+="font-size: "+i+"; "),s&&(l+="font-family: "+s+"; "),l}var To={RGB_BLACK:vo,RGB_WHITE:bo,clearCache:function(){fo={}},darkerColor:function(e,t){var n=mo(e);if(n)return t=O.nvl(t,.2),go(vo,t,n,1-t)},get:po,getFirstOpaqueBackgroundColor:function(e){if(e)for(var t=e.document(!0);e&&e.length&&t!==e[0];){var n=e.css("background-color"),r=mo(n);if(r&&1===r.alpha)return n;e=e.parent()}},getSize:function(e,t,n,r){var o=po(e,t)[n];return"auto"===o?r:s.a.pxToNumber(o)},hexToRgb:function(e){if(e){var t=0,n=0,r=0,o=255;return 4!==e.length&&5!==e.length||(t="0x"+e[1]+e[1],n="0x"+e[2]+e[2],r="0x"+e[3]+e[3],5===e.length&&(o="0x"+e[4]+e[4])),7!==e.length&&9!==e.length||(t="0x"+e[1]+e[2],n="0x"+e[3]+e[4],r="0x"+e[5]+e[6],9===e.length&&(o="0x"+e[7]+e[8])),"rgba("+ +t+","+ +n+","+ +r+","+(o=+(o/255).toFixed(3))+")"}},legacyBackgroundColor:So,legacyFont:Oo,legacyForegroundColor:ko,legacyStyle:function(e,t,n){var r="";return r+=ko(e,t,n),r+=So(e,t,n),r+=Oo(e,t,n)},lighterColor:function(e,t){var n=mo(e);if(n)return t=O.nvl(t,.2),go(bo,t,n,1-t)},mergeRgbColors:go,modelToCssColor:wo,parseFontSpec:_o,put:yo,rgb:mo,styleMap:fo,_getElement:function(){return ho}};function Co(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Po=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.array=[],this.properties=Pr.createMap()}var t,n,r;return t=e,(n=[{key:"add",value:function(e){this.contains(e)||(this.array.push(e),this.array.sort(),this.properties[e]=!0)}},{key:"size",value:function(){return this.array.length}},{key:"contains",value:function(e){return e in this.properties}},{key:"last",value:function(){return this.array[this.array.length-1]}}])&&Co(t.prototype,n),r&&Co(t,r),e}();function Ro(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var xo=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),void 0===t&&(t=window.location.href);var n=/^([^?#]*)(?:\?([^#]*))?(?:#(.*))?$/.exec(t||"");this.baseUrlRaw=n[1],this.queryPartRaw=n[2],this.hashPartRaw=n[3],this.parameterMap=e._parse(this.queryPartRaw)}var t,n,r;return t=e,r=[{key:"_sorter",value:function(e,t){return null===e?-1:null===t?1:e.toString().localeCompare(t)}},{key:"_formatQueryParam",value:function(e,t){var n=encodeURIComponent(e);return null!=t&&(n+="="+encodeURIComponent(t)),n}},{key:"_addToMap",value:function(e,t,n){if(void 0===e)throw new Error("Argument 'map' must not be null");if(void 0===t)throw new Error("Argument 'key' must not be null");if(t in e){var r=e[t];Array.isArray(r)?r.push(n):e[t]=[r,n]}else e[t]=n}},{key:"_parse",value:function(t){for(var n,r,o,i=(t||"").replace(/\+/g," "),s=/([^&=]+)(=?)([^&]*)/g,a={};n=s.exec(i);)r=decodeURIComponent(n[1]),""===(o=decodeURIComponent(n[3]))&&"="!==n[2]&&(o=null),e._addToMap(a,r,o);return a}}],(n=[{key:"hasParameter",value:function(e){return this.parameterMap.hasOwnProperty(e)}},{key:"getParameter",value:function(t){if("string"!=typeof t)throw new Error("Illegal argument type: "+t);var n=this.parameterMap[t];return Array.isArray(n)?n.sort(e._sorter):n}},{key:"removeParameter",value:function(e){if("string"!=typeof e)throw new Error("Illegal argument type: "+e);return delete this.parameterMap[e],this}},{key:"setParameter",value:function(e,t){if("string"!=typeof e)throw new Error("Illegal argument type: "+e);if(""!==e)return this.parameterMap[e]=t,this}},{key:"addParameter",value:function(t,n){if("string"!=typeof t)throw new Error("Illegal argument type: "+t);if(""!==t)return e._addToMap(this.parameterMap,t,n),this}},{key:"toString",value:function(t){var n=this,r=this.baseUrlRaw;if(Object.keys(this.parameterMap).length){var o=(t=t||{}).sorter||e._sorter;if(t.alwaysFirst||t.alwaysLast){t.alwaysFirst=rt.ensure(t.alwaysFirst),t.alwaysLast=rt.ensure(t.alwaysLast);var i=o;o=function(e,n){var r=t.alwaysFirst.indexOf(e),o=t.alwaysFirst.indexOf(n),s=t.alwaysLast.indexOf(e),a=t.alwaysLast.indexOf(n);return-1!==r?-1===o?-1:r-o:-1!==o?1:-1!==s?-1===a?1:s-a:-1!==a?-1:i(e,n)}}r+="?"+Object.keys(this.parameterMap).sort(o).map((function(t){var r=n.getParameter(t);return Array.isArray(r)?r.map((function(n,o){return e._formatQueryParam(t,r[o])})).join("&"):e._formatQueryParam(t,r)})).join("&")}return this.hashPartRaw&&(r+="#"+this.hashPartRaw),r}},{key:"clone",value:function(){return new e(this.toString())}}])&&Ro(t.prototype,n),r&&Ro(t,r),e}();var Eo={ensure:function(e){return e?Array.isArray(e)?e:[e]:[]},notSameFilter:function(e){return e=e instanceof s.a?e[0]:e,function(){return this!==e}},outsideFilter:function(e){return e=e instanceof s.a?e[0]:e,function(){return this!==e&&!s.a.contains(e,this)}},returnFalse:function(){return!1},returnTrue:function(){return!0}},Do={LEFT:"left",RIGHT:"right",CENTER:"center"};var Ao=gn.SUM_BOLD;var Fo=gn.AVG_BOLD;var $o=gn.MIN_BOLD;var jo={avgFinish:function(e){if(e.count&&e.count>0)return 1*e.sum/e.count},avgStart:function(){return{sum:0,count:0}},avgStep:function(e,t){return"number"==typeof t&&(e.sum+=t,e.count+=1),e},avgSymbol:Fo,maxFinish:function(e){return e},maxStart:function(){return null},maxStep:function(e,t){return"number"==typeof t&&("number"==typeof e?t>e&&(e=t):e=t),e},maxSymbol:gn.MAX_BOLD,minFinish:function(e){return e},minStart:function(){return null},minStep:function(e,t){return"number"==typeof t&&("number"==typeof e?t<e&&(e=t):e=t),e},minSymbol:$o,sumFinish:function(e){return e},sumStart:function(){return null},sumStep:function(e,t){return"number"==typeof t&&(e=(e||0)+t),e},sumSymbol:Ao};function Bo(e,t){if(e)try{return e.getItem(t)}catch(e){s.a.log.error('Error while reading "'+t+'" from web storage: '+e)}}function Mo(e,t,n){if(e)try{return e.setItem(t,n)}catch(e){s.a.log.error('Error while storing "'+t+'" in web storage: '+e)}}function Io(e,t){if(e)try{return e.removeItem(t)}catch(e){s.a.log.error('Error while removing "'+t+'" from web storage: '+e)}}function Lo(e){if(e)try{return e.clear()}catch(e){s.a.log.error("Error while clearing web storage: "+e)}}var Ho={clear:Lo,clearSessionStorage:function(){try{return Lo(sessionStorage)}catch(e){s.a.log.error("Error while clearing session storage: "+e)}},clearLocalStorage:function(){try{return Lo(localStorage)}catch(e){s.a.log.error("Error while clearing local storage: "+e)}},getItem:Bo,getItemFromSessionStorage:function(e){try{return Bo(sessionStorage,e)}catch(t){s.a.log.error('Error while reading "'+e+'" from session storage: '+t)}},getItemFromLocalStorage:function(e){try{return Bo(localStorage,e)}catch(t){s.a.log.error('Error while reading "'+e+'" from local storage: '+t)}},removeItem:Io,removeItemFromSessionStorage:function(e){try{return Io(sessionStorage,e)}catch(t){s.a.log.error('Error while removing "'+e+'" from session storage: '+t)}},removeItemFromLocalStorage:function(e){try{return Io(localStorage,e)}catch(t){s.a.log.error('Error while removing "'+e+'" from local storage: '+t)}},setItem:Mo,setItemToSessionStorage:function(e,t){try{return Mo(sessionStorage,e,t)}catch(t){s.a.log.error('Error while storing "'+e+'" in session storage: '+t)}},setItemToLocalStorage:function(e,t){try{return Mo(localStorage,e,t)}catch(t){s.a.log.error('Error while storing "'+e+'" in local storage: '+t)}}};var No={get:function(e,t){for(var n=e+"=",r=(t=t||document).cookie.split(";"),o=0;o<r.length;o++){var i=r[o].trim();if(0===i.indexOf(n))return i.substring(n.length)}return null},set:function(e,t,n,r){var o=e+"="+(t=O.nvl(t,""));if((n=O.nvl(n,-1))>-1){var i=new Date;i.setTime(i.getTime()+1e3*n),o+=";max-age="+n+";expires="+i}r&&(o+=";path="+r),document.cookie=o}};function Vo(e){return zo(e).call()}function Wo(e){return Go(e).call()}function zo(e){return Go(s.a.extend({},{type:"POST",dataType:"json",contentType:"application/json; charset=UTF-8"},e))}function Go(e){var t=s.a.extend({},{cache:!1},e);return O.create("AjaxCall",{ajaxOptions:t},{ensureUniqueId:!1})}var Uo={createCall:Go,createCallJson:zo,call:Wo,callJson:Vo,get:function(e,t){return Wo(s.a.extend({},{url:e,type:"GET"},t))},getJson:function(e,t){return Vo(s.a.extend({},{url:e,type:"GET"},t))},post:function(e,t,n){return Wo(s.a.extend({},{url:e,type:"POST",data:t},n))},postJson:function(e,t,n){return t&&"string"!=typeof t&&(t=JSON.stringify(t)),Vo(s.a.extend({},{url:e,type:"POST",data:t},n))},put:function(e,t,n){return Wo(s.a.extend({},{url:e,type:"PUT",data:t},n))},putJson:function(e,t,n){return t&&"string"!=typeof t&&(t=JSON.stringify(t)),Vo(s.a.extend({},{url:e,type:"PUT",data:t},n))},remove:function(e,t){return Wo(s.a.extend({},{url:e,type:"DELETE"},t))},removeJson:function(e,t){return Vo(s.a.extend({},{url:e,type:"DELETE"},t))}};function Ko(e){return(Ko="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function qo(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Yo(e,t,n){return(Yo="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Qo(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function Xo(e,t){return(Xo=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Jo(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Qo(e);if(t){var o=Qo(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Zo(this,n)}}function Zo(e,t){return!t||"object"!==Ko(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Qo(e){return(Qo=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var ei=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Xo(e,t)}(i,e);var t,n,r,o=Jo(i);function i(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(e=o.call(this)).type="ajax",e.ajaxOptions=null,e}return t=i,r=[{key:"isOfflineError",value:function(e,t,n,r){return!e.status||e.status>=12e3||502===e.status||503===e.status||504===e.status}}],(n=[{key:"init",value:function(e){if(!e)throw new Error('Missing argument "model"');if(!e.ajaxOptions)throw new Error('Missing model property "ajaxOptions"');e.name||(e.name=e.ajaxOptions.url),Yo(Qo(i.prototype),"init",this).call(this,e)}},{key:"_callImpl",value:function(){return 1!==this.callCounter&&(this.ajaxOptions.url=new xo(this.ajaxOptions.url).setParameter("retry",this.callCounter-1).toString({alwaysLast:["retry"]})),s.a.log.isTraceEnabled()&&s.a.log.trace(this.logPrefix+(1===this.callCounter?"--- ":"")+this.ajaxOptions.type+' "'+this.ajaxOptions.url+'"'+(1===this.callCounter?" ---":"")),s.a.ajax(this.ajaxOptions)}},{key:"_setResultFail",value:function(e,t,n){this._setResult(new ti({jqXHR:e,textStatus:t,errorThrown:n,requestOptions:this.ajaxOptions}))}},{key:"_onCallDone",value:function(e,t,n){s.a.log.isTraceEnabled()&&s.a.log.trace(this.logPrefix+"AJAX success"),Yo(Qo(i.prototype),"_onCallDone",this).call(this,e,t,n)}},{key:"_onCallFail",value:function(e,t,n){s.a.log.isTraceEnabled()&&s.a.log.trace(this.logPrefix+"AJAX fail: type="+t+", httpStatus="+e.status+(n?' "'+n+'"':"")),Yo(Qo(i.prototype),"_onCallFail",this).call(this,e,t,n)}},{key:"_nextRetryImpl",value:function(e,t,n){return i.isOfflineError(e,t,n,this.request)?Yo(Qo(i.prototype),"_nextRetryImpl",this).call(this):(s.a.log.isTraceEnabled()&&s.a.log.trace(this.logPrefix+"Unexpected HTTP error"),!1)}}])&&qo(t.prototype,n),r&&qo(t,r),i}(at);var ti=function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.jqXHR=null,this.textStatus=null,this.errorThrown=null,this.requestOptions=null,s.a.extend(this,t)};function ni(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var ri=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.session=null,this.hierarchical=!1,this.loadIncremental=!1,this.batch=!1,this.queryBy=null,this.searchText=null,this.key=null,this.keys=null,this.parentKey=null,this.active=null}var t,n,r;return t=e,r=[{key:"ensure",value:function(t,n){return t instanceof e||(Pr.isPlainObject(t)?(t.session=n,t=O.create(t)):"string"==typeof t&&(t=O.create(t,{session:n}))),t}},{key:"firstLookupRow",value:function(e){return e&&Pr.isArray(e.lookupRows)?0===e.lookupRows.length?null:e.lookupRows[0]:null}}],(n=[{key:"init",value:function(e){O.assertParameter("session",e.session),this._init(e)}},{key:"_init",value:function(e){s.a.extend(this,e)}},{key:"setLoadIncremental",value:function(e){this.loadIncremental=e}},{key:"setHierarchical",value:function(e){this.hierarchical=e}},{key:"setBatch",value:function(e){this.batch=e}},{key:"textByKey",value:function(e){return Pr.isNullOrUndefined(e)?s.a.resolvedPromise(""):this._textByKey(e)}},{key:"_textByKey",value:function(t){return this.cloneForKey(t).execute().then((function(t){var n=e.firstLookupRow(t);return n?n.text:""}))}},{key:"textsByKeys",value:function(e){return rt.empty(e)?s.a.resolvedPromise({}):this._textsByKeys(e)}},{key:"_textsByKeys",value:function(e){return this.cloneForKeys(e).execute().then((function(e){if(!e||!Pr.isArray(e.lookupRows))return{};var t={};return e.lookupRows.forEach((function(e){t[e.key]=e.text})),t}))}},{key:"getAll",value:function(){return this.queryBy=Si.ALL,this._getAll()}},{key:"_getAll",value:function(){throw new Error("getAll() not implemented")}},{key:"getByText",value:function(e){return this.queryBy=Si.TEXT,this.searchText=e,this._getByText(e)}},{key:"_getByText",value:function(e){throw new Error("getByText() not implemented")}},{key:"getByKey",value:function(e){return this.queryBy=Si.KEY,this.key=e,this._getByKey(e)}},{key:"_getByKey",value:function(e){throw new Error("getByKey() not implemented")}},{key:"getByKeys",value:function(e){return this.queryBy=Si.KEYS,this.keys=e,this._getByKeys(e)}},{key:"_getByKeys",value:function(e){throw new Error("getByKeys() not implemented")}},{key:"getByRec",value:function(e){return this.queryBy=Si.REC,this.parentKey=e,Pr.isNullOrUndefined(e)?this._emptyRecResult(e):this._getByRec(e)}},{key:"_emptyRecResult",value:function(e){return s.a.resolvedPromise({queryBy:Si.REC,rec:e,lookupRows:[]})}},{key:"_getByRec",value:function(e){throw new Error("getByRec() not implemented")}},{key:"execute",value:function(){if(Si.KEY===this.queryBy)return this._getByKey(this.key);if(Si.ALL===this.queryBy)return this._getAll();if(Si.KEYS===this.queryBy)return this._getByKeys(this.keys);if(Si.TEXT===this.queryBy)return this._getByText(this.searchText);if(Si.REC===this.queryBy)return Pr.isNullOrUndefined(this.parentKey)?this._emptyRecResult(this.parentKey):this._getByRec(this.parentKey);throw new Error("cannot execute a non-clone LookupCall. Use one of the cloneFor*-methods before executing.")}},{key:"clone",value:function(e){return O.cloneShallow(this,e,!0)}},{key:"cloneForAll",value:function(){return this.clone({queryBy:Si.ALL})}},{key:"cloneForText",value:function(e){return this.clone({queryBy:Si.TEXT,searchText:e})}},{key:"cloneForKey",value:function(e){return this.clone({queryBy:Si.KEY,key:e})}},{key:"cloneForKeys",value:function(e){return this.clone({queryBy:Si.KEYS,keys:e})}},{key:"cloneForRec",value:function(e){return this.clone({queryBy:Si.REC,parentKey:e})}},{key:"abort",value:function(){}}])&&ni(t.prototype,n),r&&ni(t,r),e}();function oi(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var ii=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.key=null,this.text=null,this.parentKey=null,this.enabled=!0,this.active=!0,this.additionalTableRowData=null,this.cssClass=null,this.iconId=null,this.tooltipText=null,this.backgroundColor=null,this.foregroundColor=null,this.font=null}var t,n,r;return t=e,(n=[{key:"init",value:function(e){s.a.extend(this,e)}},{key:"setKey",value:function(e){this.key=e}},{key:"setText",value:function(e){this.text=e}},{key:"setParentKey",value:function(e){this.parentKey=e}},{key:"setCssClass",value:function(e){this.cssClass=e}},{key:"setAdditionalTableRowData",value:function(e){this.additionalTableRowData=e}},{key:"setIconId",value:function(e){this.iconId=e}},{key:"setTooltipText",value:function(e){this.tooltipText=e}},{key:"setBackgroundColor",value:function(e){this.backgroundColor=e}},{key:"setForegroundColor",value:function(e){this.foregroundColor=e}},{key:"setFont",value:function(e){this.font=e}},{key:"toString",value:function(){return"scout.LookupRow[key="+this.key+" text="+this.text+"]"}}])&&oi(t.prototype,n),r&&oi(t,r),e}();function si(e){return(si="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ai(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function li(e,t,n){return(li="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=hi(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function ui(e,t){return(ui=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function ci(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=hi(e);if(t){var o=hi(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return fi(this,n)}}function fi(e,t){return!t||"object"!==si(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function hi(e){return(hi=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var pi=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ui(e,t)}(i,e);var t,n,r,o=ci(i);function i(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(e=o.call(this)).resourceUrl=null,e.maxTextLength=null,e.restriction=null,e._restriction=null,e._ajaxCall=null,e._deferred=null,e.batch=!0,e}return t=i,(n=[{key:"addRestriction",value:function(e,t){this._restriction||(this._restriction={}),this._restriction[e]=t}},{key:"_getAll",value:function(){return this._call()}},{key:"_getByText",value:function(e){return this.addRestriction("text",e),this._call()}},{key:"_getByKey",value:function(e){return this.addRestriction("ids",rt.ensure(e)),this._call()}},{key:"_getByKeys",value:function(e){return this.addRestriction("ids",rt.ensure(e)),this._call()}},{key:"cloneForAll",value:function(){var e=li(hi(i.prototype),"cloneForAll",this).call(this);return e.addRestriction("active",!0),e}},{key:"cloneForText",value:function(e){var t=li(hi(i.prototype),"cloneForText",this).call(this,e);return t.addRestriction("active",!0),t}},{key:"_acceptLookupRow",value:function(e){return!0}},{key:"_createLookupRowFromDo",value:function(e){var t=s.a.extend({},e);if(t.key=t.id,delete t.id,t.parentKey=t.parentId,delete t.parentId,delete t._type,this.maxTextLength){var n=t.text;n.length>this.maxTextLength&&(t.text=n.substr(0,this.maxTextLength)+"...",t.tooltipText=n)}return O.create("LookupRow",t)}},{key:"_call",value:function(){var e=this;return this._deferred=s.a.Deferred(),this._ajaxCall=this._createAjaxCall(),this._ajaxCall.call().then((function(t,n,r){var o=rt.ensure(t?t.rows:null).filter(e._acceptLookupRow.bind(e)).map(e._createLookupRowFromDo.bind(e));e._deferred.resolve({queryBy:e.queryBy,text:e.searchText,key:e.key,lookupRows:o})})).catch((function(t){e._deferred.resolve({queryBy:e.queryBy,text:e.searchText,key:e.key,lookupRows:[],exception:e.session.text("ErrorWhileLoadingData")})})),this._deferred.promise()}},{key:"abort",value:function(){this._deferred.reject({canceled:!0}),this._ajaxCall.abort(),li(hi(i.prototype),"abort",this).call(this)}},{key:"_getCallUrl",value:function(){return this.resourceUrl}},{key:"_createAjaxCall",value:function(){var e=this._getCallUrl(),t={type:"POST",data:this.restriction||this._restriction?JSON.stringify(s.a.extend({},this.restriction,this._restriction)):null,dataType:"json",contentType:"application/json; charset=UTF-8",cache:!1,url:e,timeout:0};return O.create("AjaxCall",{ajaxOptions:t,name:"RestLookupCall",retryIntervals:[100,500,500,500]},{ensureUniqueId:!1})}}])&&ai(t.prototype,n),r&&ai(t,r),i}(ri);function di(e){return(di="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function yi(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function vi(e,t){return(vi=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function bi(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=gi(e);if(t){var o=gi(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return mi(this,n)}}function mi(e,t){return!t||"object"!==di(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function gi(e){return(gi=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var _i=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&vi(e,t)}(i,e);var t,n,r,o=bi(i);function i(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(t=o.call(this)).adapter=e,t.deferred=null,t}return t=i,(n=[{key:"_getAll",value:function(){return this._newDeferred(new ki(Si.ALL)),this.adapter.sendLookup(Si.ALL),this.deferred.promise()}},{key:"_getByText",value:function(e){return this._newDeferred(new ki(Si.TEXT,e)),this.adapter.sendLookup(Si.TEXT,e),this.deferred.promise()}},{key:"_getByKey",value:function(e){return this._newDeferred(new ki(Si.KEY,e)),this.adapter.sendLookup(Si.KEY,e),this.deferred.promise()}},{key:"_getByRec",value:function(e){return this._newDeferred(new ki(Si.REC,e)),this.adapter.sendLookup(Si.REC,e),this.deferred.promise()}},{key:"resolveLookup",value:function(e){if(this._belongsToLatestRequest(e)){var t=rt.ensure(e.lookupRows).map((function(e){return O.create("LookupRow",e)}));e.lookupRows=t,this.deferred.resolve(e)}else s.a.log.isTraceEnabled()&&s.a.log.trace("(RemoteLookupCall#resolveLookup) ignore lookupResult. Does not belong to latest request",Pr.optProperty(this.deferred,"requestParameter"))}},{key:"_belongsToLatestRequest",value:function(e){if(!this.deferred)return!1;var t=e.queryBy.toLowerCase(),n=e[t],r=new ki(e.queryBy,n);return this.deferred.requestParameter.equals(r)}},{key:"_newDeferred",value:function(e){this.deferred&&this.deferred.reject({canceled:!0}),this.deferred=s.a.Deferred(),this.deferred.requestParameter=e}}])&&yi(t.prototype,n),r&&yi(t,r),i}(ri);function wi(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var ki=function(){function e(t,n){if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),!Si.hasOwnProperty(t))throw new Error("Invalid enum value");this.requestType=t,this.requestData=n}var t,n,r;return t=e,(n=[{key:"equals",value:function(t){return!!(t&&t instanceof e)&&Pr.propertiesEquals(this,t,["requestType","requestData"])}}])&&wi(t.prototype,n),r&&wi(t,r),e}(),Si={ALL:"ALL",TEXT:"TEXT",KEY:"KEY",KEYS:"KEYS",REC:"REC"};function Oi(e){return(Oi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ti(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Ci(e,t,n){return(Ci="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Ei(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function Pi(e,t){return(Pi=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Ri(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ei(e);if(t){var o=Ei(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return xi(this,n)}}function xi(e,t){return!t||"object"!==Oi(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Ei(e){return(Ei=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Di=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Pi(e,t)}(i,e);var t,n,r,o=Ri(i);function i(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(e=o.call(this)).delay=0,e.data=null,e.active=!0,e}return t=i,(n=[{key:"_init",value:function(e){Ci(Ei(i.prototype),"_init",this).call(this,e),this.data||(this.data=this._data())}},{key:"refreshData",value:function(e){this.data=void 0===e?this._data():e}},{key:"_getAll",value:function(){var e=s.a.Deferred();return setTimeout(this._queryByAll.bind(this,e),this.delay),e.promise()}},{key:"_queryByAll",value:function(e){e.resolve({queryBy:Si.ALL,lookupRows:this._lookupRowsByAll()})}},{key:"_lookupRowsByAll",value:function(){return this.data.slice(0,i.MAX_ROW_COUNT+1).map(this._dataToLookupRow,this).filter(this._filterActiveLookupRow,this)}},{key:"_filterActiveLookupRow",value:function(e){return!!Pr.isNullOrUndefined(this.active)||this.active===O.nvl(e.active,!0)}},{key:"_getByText",value:function(e){var t=s.a.Deferred();return setTimeout(this._queryByText.bind(this,t,e),this.delay),t.promise()}},{key:"_queryByText",value:function(e,t){var n=this._lookupRowsByText(t);this.hierarchical||e.resolve({queryBy:Si.TEXT,text:t,lookupRows:n});var r=new Hi(this);(this.loadIncremental?s.a.resolvedPromise(n):r.addChildLookupRows(n)).then((function(e){return r.addParentLookupRows(e)})).done((function(n){e.resolve({queryBy:Si.TEXT,text:t,lookupRows:n})})).fail((function(e){throw e}))}},{key:"_lookupRowsByText",value:function(e){return this.data.filter((function(t){return Wn.startsWith(t[1].toLowerCase(),e.toLowerCase())})).map(this._dataToLookupRow,this).filter(this._filterActiveLookupRow,this)}},{key:"_getByKey",value:function(e){var t=s.a.Deferred();return setTimeout(this._queryByKey.bind(this,t,e),this.delay),t.promise()}},{key:"_queryByKey",value:function(e,t){var n=this._lookupRowByKey(t);n?e.resolve({queryBy:Si.KEY,lookupRows:[n]}):e.reject()}},{key:"_lookupRowByKey",value:function(e){var t=rt.find(this.data,(function(t){return t[0]===e}));return t?this._dataToLookupRow(t):null}},{key:"_getByRec",value:function(e){var t=s.a.Deferred();return setTimeout(this._queryByRec.bind(this,t,e),this.delay),t.promise()}},{key:"_queryByRec",value:function(e,t){e.resolve({queryBy:Si.REC,rec:t,lookupRows:this._lookupRowsByRec(t)})}},{key:"_lookupRowsByRec",value:function(e){var t=this;return this.data.reduce((function(n,r){return r[2]===e&&n.push(t._dataToLookupRow(r)),n}),[]).filter(this._filterActiveLookupRow,this)}},{key:"setDelay",value:function(e){this.delay=e}},{key:"_dataToLookupRow",value:function(e){return O.create("LookupRow",{key:e[0],text:e[1],parentKey:e[2]})}},{key:"_data",value:function(){return[]}}])&&Ti(t.prototype,n),r&&Ti(t,r),i}(ri);function Ai(e){return(Ai="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Fi(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function $i(e,t){return($i=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function ji(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Mi(e);if(t){var o=Mi(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Bi(this,n)}}function Bi(e,t){return!t||"object"!==Ai(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Mi(e){return(Mi=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}!function(e,t,n){t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}(Di,"MAX_ROW_COUNT",100);var Ii=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&$i(e,t)}(i,e);var t,n,r,o=ji(i);function i(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(e=o.call(this)).lookupRows=[],e}return t=i,(n=[{key:"setLookupRows",value:function(e){this.lookupRows=rt.ensure(e)}},{key:"_filterActiveLookupRow",value:function(e){return!!O.nvl(e.active,!0)}},{key:"_getAll",value:function(){var e=s.a.Deferred();return setTimeout(this._queryByAll.bind(this,e)),e.promise()}},{key:"_queryByAll",value:function(e){e.resolve({queryBy:Si.ALL,lookupRows:this._lookupRowsByAll()})}},{key:"_lookupRowsByAll",value:function(){return this.lookupRows.filter(this._filterActiveLookupRow,this).slice(0,i.MAX_ROW_COUNT+1)}},{key:"_getByText",value:function(e){var t=s.a.Deferred();return setTimeout(this._queryByText.bind(this,t,e)),t.promise()}},{key:"_queryByText",value:function(e,t){e.resolve({queryBy:Si.TEXT,text:t,lookupRows:this._lookupRowsByText(t)})}},{key:"_lookupRowsByText",value:function(e){var t=String(O.nvl(e,"")).trim().toLowerCase();return this.lookupRows.filter((function(e){return Wn.startsWith(O.nvl(e.text,"").toLowerCase(),t)})).filter(this._filterActiveLookupRow,this).slice(0,i.MAX_ROW_COUNT+1)}},{key:"_getByKey",value:function(e){var t=s.a.Deferred();return setTimeout(this._queryByKey.bind(this,t,e)),t.promise()}},{key:"_queryByKey",value:function(e,t){var n=this._lookupRowByKey(t);n?e.resolve({queryBy:Si.KEY,lookupRows:[n]}):e.reject()}},{key:"_lookupRowByKey",value:function(e){return rt.find(this.lookupRows,(function(t){return t.key===e}))}},{key:"_getByRec",value:function(e){var t=s.a.Deferred();return setTimeout(this._queryByRec.bind(this,t,e)),t.promise()}},{key:"_queryByRec",value:function(e,t){e.resolve({queryBy:Si.REC,rec:t,lookupRows:this._lookupRowsByRec(t)})}},{key:"_lookupRowsByRec",value:function(e){return this.lookupRows.reduce((function(t,n){return n.parentKey===e&&t.push(n),t}),[]).filter(this._filterActiveLookupRow,this).slice(0,i.MAX_ROW_COUNT+1)}}])&&Fi(t.prototype,n),r&&Fi(t,r),i}(ri);function Li(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}!function(e,t,n){t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}(Ii,"MAX_ROW_COUNT",100);var Hi=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),O.assertParameter("lookupCall",t),this.lookupCall=t,this._lookupRowMap={}}var t,n,r;return t=e,(n=[{key:"addParentLookupRows",value:function(e){var t=this;this._fillMap(e);var n=e.map(this._addParent.bind(this));return s.a.promiseAll(n).then((function(){return Pr.values(t._lookupRowMap)}))}},{key:"_addParent",value:function(e){var t=this,n=e.parentKey;return n?this._lookupRowMap.hasOwnProperty(n)?(e=this._lookupRowMap[n],this._addParent(e)):this.lookupCall.cloneForKey(n).execute().then((function(e){var n=ri.firstLookupRow(e);return t._lookupRowMap[n.key]=n,t._addParent(n)})):s.a.resolvedPromise()}},{key:"_fillMap",value:function(e){var t=this;e.forEach((function(e){t._lookupRowMap[e.key]=e}))}},{key:"addChildLookupRows",value:function(e){var t=this;this._fillMap(e);var n=e.map(this._addChildren.bind(this));return s.a.promiseAll(n).then((function(){return Pr.values(t._lookupRowMap)}))}},{key:"_addChildren",value:function(e){var t=this;return this.lookupCall.cloneForRec(e.key).execute().then((function(e){if(e.lookupRows.length)return t.addChildLookupRows(e.lookupRows)}))}}])&&Li(t.prototype,n),r&&Li(t,r),e}();function Ni(e){return(Ni="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Vi(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Wi=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.active,this.id,this.parent,this.children=[],this.sortCode}var t,n,r;return t=e,(n=[{key:"init",value:function(e){if(O.assertParameter("id",e.id),this.active=e.active,this.id=e.id,this.sortCode=e.sortCode,this._text=e.text,this.modelClass=e.modelClass,e.texts){if(this._text)throw new Error("Either set texts or text property, not both.");var t=Qi.registerTexts(this,e.texts);this._text=bp.buildKey(t)}}},{key:"text",value:function(e){var t=e;return"object"===Ni(e)&&(t=e.languageTag),bp.resolveText(this._text,t)}},{key:"visitChildren",value:function(e){for(var t=0;t<this.children.length;t++){var n=this.children[t],r=e(n);if(!0===r||r===iU.TERMINATE)return iU.TERMINATE;if(r!==iU.SKIP_SUBTREE&&(!0===(r=n.visitChildren(e))||r===iU.TERMINATE))return iU.TERMINATE}}}])&&Vi(t.prototype,n),r&&Vi(t,r),e}();function zi(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Gi=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.id,this.codes=[],this.codeMap={}}var t,n,r;return t=e,r=[{key:"ensure",value:function(t){return t?t instanceof e?t:O.create("CodeType",t):t}}],(n=[{key:"init",value:function(e){if(O.assertParameter("id",e.id),this.id=e.id,this.modelClass=e.modelClass,e.codes)for(var t=0;t<e.codes.length;t++)this._initCode(e.codes[t])}},{key:"_initCode",value:function(e,t){var n=O.create(e);if(this.add(n,t),e.children)for(var r=0;r<e.children.length;r++)this._initCode(e.children[r],n)}},{key:"add",value:function(e,t){this.codes.push(e),this.codeMap[e.id]=e,t&&(t.children.push(e),e.parent=t)}},{key:"get",value:function(e){var t=this.optGet(e);if(!t)throw new Error("No code found for id="+e);return t}},{key:"optGet",value:function(e){return this.codeMap[e]}},{key:"getCodes",value:function(e){if(e){for(var t=[],n=0;n<this.codes.length;n++)this.codes[n].parent||t.push(this.codes[n]);return t}return this.codes}},{key:"visit",value:function(e){for(var t=this.codes.filter((function(e){return!e.parent})),n=0;n<t.length;n++){var r=t[n],o=e(r);if(!0===o||o===iU.TERMINATE)return iU.TERMINATE;if(o!==iU.SKIP_SUBTREE&&(!0===(o=r.visitChildren(e))||o===iU.TERMINATE))return iU.TERMINATE}}}])&&zi(t.prototype,n),r&&zi(t,r),e}(),Ui={};function Ki(e,t){if(t&&t.error)throw{error:t.error,url:e};qi(t)}function qi(e){e=e||{},Object.keys(e).forEach((function(t){Yi(e[t])}),this)}function Yi(e){(e=rt.ensure(e)).forEach((function(e){e=Gi.ensure(e),Ui[e.id]=e}),this)}function Xi(e,t){var n,r;if(2===t.length)n=t[0],r=t[1];else{var o=t[0].split(" ");if(2!==o.length)throw new Error('Invalid string. Must have format "[CodeType.id] [Code.id]"');n=o[0],r=o[1]}return O.assertParameter("codeTypeId",n),O.assertParameter("codeId",r),Ji(n)[e](r)}function Ji(e,t){var n=Ui[e];if(!t&&!n)throw new Error("No CodeType found for id="+e);return n}function Zi(e){return"__code."+e.id}var Qi={add:Yi,bootstrap:function(e){return(e?s.a.ajaxJson(e):s.a.resolvedPromise({})).then(Ki.bind(this,e))},codeType:Ji,defaultLanguage:"en",generateTextKey:Zi,get:function(e,t){return Xi("get",Pr.argumentsToArray(arguments))},init:qi,optGet:function(e,t){return Xi("optGet",Pr.argumentsToArray(arguments))},registerTexts:function(e,t){var n=Zi(e);for(var r in bp.get("default").remove(n),t){var o=t[r];r&&"en"===r&&(r="default"),bp.get(r).add(n,o)}return n},registry:Ui,remove:function(e){(e=rt.ensure(e)).forEach((function(e){var t;t="string"==typeof e?e:e.id,delete Ui[t]}),this)}};function es(e){return(es="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ts(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ns(e,t){return(ns=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function rs(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=is(e);if(t){var o=is(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return os(this,n)}}function os(e,t){return!t||"object"!==es(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function is(e){return(is=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var ss=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ns(e,t)}(i,e);var t,n,r,o=rs(i);function i(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(e=o.call(this)).codeType=null,e}return t=i,(n=[{key:"_lookupRowByKey",value:function(e){var t=Qi.codeType(this.codeType,!0);return t?this._createLookupRow(t.optGet(e)):null}},{key:"_lookupRowsByAll",value:function(){return this._collectLookupRows()}},{key:"_lookupRowsByText",value:function(e){return this._collectLookupRows((function(t){var n=t.text||"";return Wn.startsWith(n.toLowerCase(),e.toLowerCase())}))}},{key:"_lookupRowsByRec",value:function(e){return this._collectLookupRows((function(t){return t.parentKey===e}))}},{key:"_collectLookupRows",value:function(e){var t=this,n=Qi.codeType(this.codeType,!0);if(!n)return[];var r=[];return n.visit((function(n){var o=t._createLookupRow(n);e&&!e(o)||r.push(o)})),r}},{key:"_createLookupRow",value:function(e){return e?O.create("LookupRow",{key:e.id,text:e.text(this.session.locale),parentKey:e.parent&&e.parent.id}):null}}])&&ts(t.prototype,n),r&&ts(t,r),i}(Di),as={STOPPED:"stopped",RUNNING:"running",FAILURE:"failure"};function ls(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var us=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.enabled=!!t,this.status=as.STOPPED}var t,n,r;return t=e,(n=[{key:"setFailed",value:function(){this.status=as.FAILURE}},{key:"setRunning",value:function(){this.status=as.RUNNING}},{key:"setStopped",value:function(){this.status=as.STOPPED}},{key:"isFailed",value:function(){return this.status===as.FAILURE}},{key:"isRunning",value:function(){return this.status===as.RUNNING}},{key:"isStopped",value:function(){return this.status===as.STOPPED}}])&&ls(t.prototype,n),r&&ls(t,r),e}();function cs(e){return(cs="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function fs(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function hs(e,t,n){return(hs="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=vs(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function ps(e,t){return(ps=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function ds(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=vs(e);if(t){var o=vs(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return ys(this,n)}}function ys(e,t){return!t||"object"!==cs(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function vs(e){return(vs=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var bs=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ps(e,t)}(i,e);var t,n,r,o=ds(i);function i(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(e=o.call(this)).cancellable=!0,e.showTimeout=2500,e.label=null,e.details=null,e}return t=i,(n=[{key:"_createKeyStrokeContext",value:function(){return new $u}},{key:"_initKeyStrokeContext",value:function(){var e=this;hs(vs(i.prototype),"_initKeyStrokeContext",this).call(this),this.keyStrokeContext.registerKeyStroke([new pc(this,[Ou.SPACE,Ou.ENTER]),new Pc(this,(function(){return e.$cancelButton}))])}},{key:"_init",value:function(e){hs(vs(i.prototype),"_init",this).call(this,e),this.label=O.nvl(this.label,this.session.text("ui.PleaseWait_"))}},{key:"render",value:function(e){e=e||this.entryPoint(),hs(vs(i.prototype),"render",this).call(this,e)}},{key:"_render",value:function(){var e=this;this.$container=this.$parent.appendDiv("busyindicator invisible");var t=this.$container.appendDiv("drag-handle");if(this.$container.draggable(t),this.$content=this.$container.appendDiv("busyindicator-content"),this.$label=this.$content.appendDiv("busyindicator-label"),this.$details=this.$content.appendDiv("busyindicator-details"),this.cancellable){this.$buttons=this.$container.appendDiv("busyindicator-buttons");var n=new yf(this.$buttons);this.$cancelButton=n.addButton({text:this.session.text("Cancel"),onClick:this._onCancelClick.bind(this)}),this.$cancelButton.css("width","100%")}else this.$content.addClass("no-buttons");this._renderLabel(),this._renderDetails(),this.$container.addClass("calc-helper"),this.$container.css("min-width",this.$container.width()),this.$container.removeClass("calc-helper"),this._position(),this._busyIndicatorTimeoutId=setTimeout((function(){e.$container.removeClass("invisible").addClassForAnimation("animate-open"),e.session.focusManager.validateFocus()}),this.showTimeout),this._glassPaneRenderer=new ih(this),this._glassPaneRenderer.renderGlassPanes(),this._glassPaneRenderer.eachGlassPane((function(e){e.addClass("busy")}))}},{key:"_postRender",value:function(){hs(vs(i.prototype),"_postRender",this).call(this),this.session.focusManager.installFocusContext(this.$container,Kf.AUTO)}},{key:"_remove",value:function(){clearTimeout(this._busyIndicatorTimeoutId),this._glassPaneRenderer.eachGlassPane((function(e){e.removeClass("busy")})),this._glassPaneRenderer.removeGlassPanes(),this.session.focusManager.uninstallFocusContext(this.$container),hs(vs(i.prototype),"_remove",this).call(this)}},{key:"setLabel",value:function(e){this.setProperty("label",e)}},{key:"_renderLabel",value:function(){this.$label.text(this.label||"")}},{key:"setDetails",value:function(e){this.setProperty("details",e)}},{key:"_renderDetails",value:function(){this.$details.html(Wn.nl2br(this.details)).setVisible(!!this.details)}},{key:"_position",value:function(){this.$container.cssMarginLeft(-this.$container.outerWidth()/2)}},{key:"close",value:function(){this.$cancelButton&&this.session.focusManager.requestFocus(this.$cancelButton)&&(this.$cancelButton.focus(),this.$cancelButton.click())}},{key:"_onCancelClick",value:function(e){this.trigger("cancel",e)}},{key:"cancelled",value:function(){this.rendered&&(this.$label.addClass("cancelled"),this.$buttons.remove(),this.$content.addClass("no-buttons"))}}])&&fs(t.prototype,n),r&&fs(t,r),i}(ve);var ms=function e(t,n,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),O.assertParameter("target",t),O.assertParameter("type",n),s.a.extend(this,r),this.target=t,this.type=n};function gs(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var _s=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),t=O.nvl(t,e.DEFAULT),this.languageTag=t.languageTag;var n=En.splitLanguageTag(this.languageTag);this.language=n[0],this.country=n[1],this.displayLanguage=t.displayLanguage,this.displayCountry=t.displayCountry,this.decimalFormatPatternDefault=t.decimalFormatPatternDefault,this.decimalFormatSymbols=t.decimalFormatSymbols,this.decimalFormatPatternDefault&&this.decimalFormatSymbols&&(this.decimalFormat=new rp(t)),this.dateFormatPatternDefault=t.dateFormatPatternDefault,this.dateFormatSymbols=t.dateFormatSymbols,this.timeFormatPatternDefault=t.timeFormatPatternDefault,this.dateFormatPatternDefault&&this.dateFormatSymbols&&(this.dateFormat=new tp(t))}var t,n,r;return t=e,r=[{key:"ensure",value:function(t){return t?t instanceof e?t:new e(t):t}}],(n=null)&&gs(t.prototype,n),r&&gs(t,r),e}();function ws(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}!function(e,t,n){t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}(_s,"DEFAULT",{languageTag:"en-US",decimalFormatPatternDefault:"#,##0.###",dateFormatPatternDefault:"MM/dd/yyyy",timeFormatPatternDefault:"h:mm a",decimalFormatSymbols:{decimalSeparator:".",groupingSeparator:",",minusSign:"-"},dateFormatSymbols:{months:["January","February","March","April","May","June","July","August","September","October","November","December"],monthsShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],weekdays:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],weekdaysShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],am:"AM",pm:"PM"}});var ks=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._filterProperties={},this._propertiesFilter=this._propertiesFilter.bind(this),this.filters=[this._propertiesFilter]}var t,n,r;return t=e,(n=[{key:"addFilterForProperties",value:function(e){Pr.copyProperties(e,this._filterProperties)}},{key:"addFilter",value:function(e){this.filters.push(e)}},{key:"filter",value:function(e,t){return this.filters.some((function(n){return n(e,t)}))}},{key:"addFilterForPropertyName",value:function(e){this.filters.push((function(t,n){return t===e}))}},{key:"_propertiesFilter",value:function(e,t){if(!this._filterProperties.hasOwnProperty(e))return!1;var n=this._filterProperties[e];return Pr.equals(n,t)}},{key:"reset",value:function(){this._filterProperties={},this.filters=[this._propertiesFilter]}}])&&ws(t.prototype,n),r&&ws(t,r),e}();function Ss(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Os=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.session=t,this.started=!1,this.initialDelay=1e3,this.interval=3e3,this.minPingDuration=1e3}var t,n,r;return t=e,(n=[{key:"start",value:function(){this.started||(s.a.log.isTraceEnabled()&&s.a.log.trace("[ajax reconnector] start"),this.started=!0,this._schedulePing(this.initialDelay))}},{key:"stop",value:function(){this.started=!1}},{key:"_schedulePing",value:function(e){s.a.log.isTraceEnabled()&&s.a.log.trace("[ajax reconnector] schedule ping() in "+e+" ms"),setTimeout(this._ping.bind(this),e)}},{key:"_ping",value:function(){this.session.onReconnecting();var e=this.session.defaultAjaxOptions({ping:!0});s.a.log.isTraceEnabled()&&s.a.log.trace("[ajax reconnector] "+e.type+' "'+e.url+'"'),this.pingStartTimestamp=Date.now(),s.a.ajax(e).done(this._onPingDone.bind(this)).fail(this._onPingFail.bind(this))}},{key:"_onPingDone",value:function(e,t,n){s.a.log.isTraceEnabled()&&s.a.log.trace("[ajax reconnector] ping success -> connection re-established!"),this.session.onReconnectingSucceeded(),this.stop()}},{key:"_onPingFail",value:function(e,t,n){var r=function(){s.a.log.isTraceEnabled()&&s.a.log.trace("[ajax reconnector] ping failed"),this.session.onReconnectingFailed(),this._schedulePing(this.interval)}.bind(this),o=Date.now()-this.pingStartTimestamp;o<this.minPingDuration?setTimeout(r,this.minPingDuration-o):r()}}])&&Ss(t.prototype,n),r&&Ss(t,r),e}();function Ts(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Cs=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.session=t,this.queue=[],this.lastProcessedSequenceNo=0,this.nextExpectedSequenceNo=1,this.force=!1,this.forceTimeoutId=null}var t,n,r;return t=e,(n=[{key:"add",value:function(e){var t=e&&e["#"];if(!(t&&t<=this.lastProcessedSequenceNo))if(t&&e.combined&&(this.lastProcessedSequenceNo=Math.max(t-1,this.lastProcessedSequenceNo),this.nextExpectedSequenceNo=Math.max(t,this.nextExpectedSequenceNo)),t&&0!==this.queue.length){for(var n=[],r=e,o=0;o<this.queue.length;o++){var i=this.queue[o];i["#"]&&(r&&i["#"]>t&&(n.push(e),r=null),i["#"]<=this.lastProcessedSequenceNo)||n.push(i)}r&&n.push(r),this.queue=n}else this.queue.push(e)}},{key:"process",value:function(e){e&&this.add(e);for(var t=!0,n=!1,r=[],o=0;o<this.queue.length;o++){var i=this.queue[o],s=i["#"];if(s&&(!this.nextExpectedSequenceNo||this.force||n||(n=this.nextExpectedSequenceNo!==s),n))r.push(i);else{var a=this.session.processJsonResponseInternal(i);e&&i===e&&(t=a),s&&(this.lastProcessedSequenceNo=s,this.nextExpectedSequenceNo=s+1)}}return this.queue=r,this._checkTimeout(),t}},{key:"size",value:function(){return this.queue.length}},{key:"_checkTimeout",value:function(){var t=this;0===this.queue.length?(clearTimeout(this.forceTimeoutId),this.forceTimeoutId=null):this.forceTimeoutId||(this.forceTimeoutId=setTimeout((function(){try{for(var n="[",r=0;r<t.queue.length;r++)r>0&&(n+=", "),n+=Wn.box("#",t.queue[r]["#"])||"<none>";n+="]",t.session.sendLogRequest("Expected response #"+t.nextExpectedSequenceNo+" still missing after "+e.FORCE_TIMEOUT+" ms. Forcing response queue to process "+t.size()+" elements: "+n)}catch(e){}t.force=!0;try{t.process()}finally{t.force=!1,t.forceTimeoutId=null}}),e.FORCE_TIMEOUT))}},{key:"prepareRequest",value:function(e){e["#ACK"]=this.lastProcessedSequenceNo}},{key:"prepareHttpRequest",value:function(e){e.headers=e.headers||{},e.headers["X-Scout-#ACK"]=this.lastProcessedSequenceNo}}])&&Ts(t.prototype,n),r&&Ts(t,r),e}();function Ps(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Rs(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}!function(e,t,n){t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}(Cs,"FORCE_TIMEOUT",1e4);var xs=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.$entryPoint=null,this.partId=0,this.url=new xo,this.userAgent=new Es({deviceType:Kt.get().type,touch:Kt.get().supportsOnlyTouch(),standalone:Kt.get().isStandalone()}),this.locale=null,this.textMap=new ip,this.ready=!1,this.unloading=!1,this.unloaded=!1,this.loggedOut=!1,this.inspector=!1,this.persistent=!1,this.desktop=null,this.layoutValidator=new ra,this.focusManager=null,this.keyStrokeManager=null,this.uiSessionId=null,this.clientSessionId=this._getClientSessionIdFromStorage(),this.forceNewClientSession=!1,this.remoteUrl="json",this.unloadUrl="unload",this.modelAdapterRegistry={},this.ajaxCalls=[],this.asyncEvents=[],this.responseQueue=new Cs(this),this.requestsPendingCounter=0,this.suppressErrors=!1,this.requestTimeoutCancel=5e3,this.requestTimeoutPoll=75e3,this.requestTimeoutPing=5e3,this.backgroundJobPollingSupport=new us(!0),this.reconnector=new Os(this),this.processingEvents=!1,this.adapterExportEnabled=!1,this._adapterDataCache={},this._busy=!1,this._busyIndicator=null,this._busyIndicatorTimeoutId=null,this._deferred=null,this._fatalMessagesOnScreen={},this._retryRequest=null,this._queuedRequest=null,this.requestSequenceNo=0,this.rootAdapter=new de,this.rootAdapter.init({session:this,id:"1",objectType:"RootAdapter"});var t=new Fe;t.session=this,t.initialized=!0,this.root=this.rootAdapter.createWidget({session:this,id:"1",objectType:"NullWidget"},t),this.events=this._createEventSupport()}var t,n,r;return t=e,(n=[{key:"init",value:function(e){var t=e||{};if(!t.$entryPoint)throw new Error("$entryPoint is not defined");this.$entryPoint=t.$entryPoint,this.partId=O.nvl(t.portletPartId,this.partId),this.forceNewClientSession=O.nvl(this.url.getParameter("forceNewClientSession"),t.forceNewClientSession),this.forceNewClientSession?this.clientSessionId=null:this.clientSessionId=O.nvl(t.clientSessionId,this.clientSessionId),this.userAgent=O.nvl(t.userAgent,this.userAgent),this.suppressErrors=O.nvl(t.suppressErrors,this.suppressErrors),t.locale&&(this.locale=_s.ensure(t.locale),this.textMap=bp.get(this.locale.languageTag)),!1===t.backgroundJobPollingEnabled&&(this.backgroundJobPollingSupport.enabled=!1),s.a.extend(this.reconnector,t.reconnectorOptions),this.ajaxCallOptions=t.ajaxCallOptions,"true"!==this.url.getParameter("debug")&&"true"!==this.url.getParameter("inspector")||(this.inspector=!0),"true"===this.url.getParameter("adapterExportEnabled")&&(this.adapterExportEnabled=!0),this.focusManager=new Vf({session:this,active:t.focusManagerActive}),this.keyStrokeManager=O.create("KeyStrokeManager",{session:this})}},{key:"_throwError",value:function(e){if(!this.suppressErrors)throw new Error(e)}},{key:"unregisterModelAdapter",value:function(e){delete this.modelAdapterRegistry[e.id]}},{key:"registerModelAdapter",value:function(e){if(void 0===e.id)throw new Error("modelAdapter.id must be defined");this.modelAdapterRegistry[e.id]=e}},{key:"getModelAdapter",value:function(e){return this.modelAdapterRegistry[e]}},{key:"getWidget",value:function(e){if(!e)return null;if("string"!=typeof e)throw new Error("typeof adapterId must be string");var t=this.getModelAdapter(e);return t?t.widget:null}},{key:"getOrCreateWidget",value:function(e,t,n){if(!e)return null;if("string"!=typeof e)throw new Error("typeof adapterId must be string");var r=this.getWidget(e);if(r)return r;var o=this._getAdapterData(e);if(!o){if(O.nvl(n,!0))throw new Error("no adapterData found for adapterId="+e);return null}return this.createModelAdapter(o).createWidget(o,t)}},{key:"createModelAdapter",value:function(e){var t=e.objectType,n={},r=Z.parse(t);r.modelVariant?(t=r.objectType.toString()+"Adapter"+te.MODEL_VARIANT_SEPARATOR+r.modelVariant.toString(),n.variantLenient=!0):t=r.objectType.toString()+"Adapter";var o={id:e.id,session:this},i=O.create(t,o,n);return s.a.log.isTraceEnabled()&&s.a.log.trace("created new adapter "+i),i}},{key:"sendEvent",value:function(e,t){var n=this;t=t||0,this.asyncEvents=this._coalesceEvents(this.asyncEvents,e),this.asyncEvents.push(e),this._asyncDelay=Math.min(t,O.nvl(this._asyncDelay,t)),clearTimeout(this._sendTimeoutId),this._sendTimeoutId=setTimeout((function(){n._sendTimeoutId=null,n._asyncDelay=null,n.areRequestsPending()||n._sendNow()}),this._asyncDelay)}},{key:"_sendStartupRequest",value:function(){var e=this._newRequest({startup:!0});this.partId&&(e.partId=this.partId),this.clientSessionId&&(e.clientSessionId=this.clientSessionId),E.get().version&&(e.version=E.get().version),e.userAgent=this.userAgent,e.sessionStartupParams=this._createSessionStartupParams();var t=this.defaultAjaxOptions(e);return s.a.ajax(t).catch(function(t,n,r){this._setApplicationLoading(!1),this._processErrorResponse(t,n,r,e);for(var o=arguments.length,i=new Array(o>3?o-3:0),a=3;a<o;a++)i[a-3]=arguments[a];return s.a.rejectedPromise.apply(s.a,[t,n,r].concat(i))}.bind(this)).then(function(e){if(this._processStartupResponse(e),e.error)return s.a.rejectedPromise(e)}.bind(this))}},{key:"_createSessionStartupParams",value:function(){var e={url:this.url.baseUrlRaw,geolocationServiceAvailable:Kt.get().supportsGeolocation()},t=this.url.parameterMap;for(var n in t)e[n]=t[n];return e}},{key:"_processStartupResponse",value:function(e){if(e.error)this._processErrorJsonResponse(e.error);else{if(Ho.removeItemFromSessionStorage("scout:versionMismatch"),!e.startupData)throw new Error("Missing startupData");if(this.persistent=e.startupData.persistent,this.clientSessionId=e.startupData.clientSessionId,this._storeClientSessionIdInStorage(this.clientSessionId),this.uiSessionId=e.startupData.uiSessionId,s()(window).on("beforeunload."+this.uiSessionId,this._onWindowBeforeUnload.bind(this)).on("unload."+this.uiSessionId,this._onWindowUnload.bind(this)),e.startupData.reloadPage)O.reloadPage();else{e.startupData.inspector&&(this.inspector=!0),this.requestTimeoutPoll=1e3*(e.startupData.pollingInterval+15),this.modelAdapterRegistry[this.uiSessionId]=this,e.adapterData&&this._copyAdapterData(e.adapterData),this.locale=new _s(e.startupData.locale),this.textMap=bp.get(this.locale.languageTag),this.textMap.addAll(e.startupData.textMap);var t=this._getAdapterData(e.startupData.clientSession);this.desktop=this.getOrCreateWidget(t.desktop,this.rootAdapter.widget);var n=function(){if(this._renderDesktop(),e.events){this.processingEvents=!0;try{this._processEvents(e.events)}finally{this.processingEvents=!1}}this.layoutValidator.validate(),this.focusManager.validateFocus(),this._resumeBackgroundJobPolling(),this.ready=!0,s.a.log.isInfoEnabled()&&s.a.log.info("Session initialized. Detected "+Kt.get()),s.a.log.isDebugEnabled()&&(s.a.log.isDebugEnabled()&&s.a.log.debug("size of _adapterDataCache after session has been initialized: "+Pr.countOwnProperties(this._adapterDataCache)),s.a.log.isDebugEnabled()&&s.a.log.debug("size of modelAdapterRegistry after session has been initialized: "+Pr.countOwnProperties(this.modelAdapterRegistry)))}.bind(this);this.render(n)}}}},{key:"_storeClientSessionIdInStorage",value:function(e){var t="scout:clientSessionId";Ho.removeItemFromSessionStorage(t),Ho.removeItemFromLocalStorage(t),this.persistent?Ho.setItemToLocalStorage(t,e):Ho.setItemToSessionStorage(t,e)}},{key:"_getClientSessionIdFromStorage",value:function(){var e="scout:clientSessionId",t=Ho.getItemFromSessionStorage(e);return t||(t=Ho.getItemFromLocalStorage(e)),t}},{key:"render",value:function(e){vn.loadingComplete?e():vn.preloader().then(e)}},{key:"_sendUnloadRequest",value:function(){var e=this._newRequest({unload:!0,showBusyIndicator:!1});this._sendRequest(e)}},{key:"_sendNow",value:function(){if(0!==this.asyncEvents.length){var e=[];this.asyncEvents.some((function(t,n){return!!(t.newRequest&&e.length>0)||(e.push(t),!1)}));var t=this._newRequest({events:e});t.showBusyIndicator=t.events.some((function(e){return O.nvl(e.showBusyIndicator,!0)})),this.responseQueue.prepareRequest(t),this._sendRequest(t),this.asyncEvents=this.asyncEvents.slice(e.length)}}},{key:"_coalesceEvents",value:function(e,t){if(!t.coalesce)return e;var n=s.a.negate(t.coalesce).bind(t);return e.filter(n)}},{key:"_sendRequest",value:function(e){if(e&&!this.loggedOut)if(!this.offline||e.unload)if(e.unload&&navigator.sendBeacon)navigator.sendBeacon(this.unloadUrl+"/"+this.uiSessionId,"");else{var t=this.defaultAjaxOptions(e),n=O.nvl(e.showBusyIndicator,!0);e.unload&&(t.async=!1),this._performUserAjaxRequest(t,n,e)}else this._handleSendWhenOffline(e)}},{key:"_handleSendWhenOffline",value:function(e){var t=this;e.events&&(this._queuedRequest?this._queuedRequest.events?(e.events.forEach((function(e){t._queuedRequest.events=t._coalesceEvents(t._queuedRequest.events,e)})),this._queuedRequest.events=this._queuedRequest.events.concat(e.events)):this._queuedRequest.events=e.events:this._queuedRequest=e,this.layoutValidator.validate())}},{key:"defaultAjaxOptions",value:function(e){e=e||this._newRequest();var t={type:"POST",dataType:"json",contentType:"application/json; charset=UTF-8",cache:!1,url:this._decorateUrl(this.remoteUrl,e),data:this._requestToJson(e),timeout:0};return e.cancel&&(t.timeout=this.requestTimeoutCancel),e.ping&&(t.timeout=this.requestTimeoutPing),e.pollForBackgroundJobs&&(t.timeout=this.requestTimeoutPoll),t}},{key:"_decorateUrl",value:function(e,t){var n=null;return t.unload?n="unload":t.pollForBackgroundJobs?n="poll":t.ping?n="ping":t.cancel?n="cancel":t.log?n="log":t.syncResponseQueue&&(n="sync"),n&&(e=new xo(e).addParameter(n).toString()),e}},{key:"_getRequestName",value:function(e,t){if(e){if(e.unload)return"unload";if(e.pollForBackgroundJobs)return"pollForBackgroundJobs";if(e.ping)return"ping";if(e.cancel)return"cancel";if(e.log)return"log";if(e.syncResponseQueue)return"syncResponseQueue"}return t}},{key:"_requestToJson",value:function(e){return JSON.stringify(e,(function(t,n){return this===e&&"showBusyIndicator"===t||this instanceof ms&&O.isOneOf(t,"showBusyIndicator","coalesce","newRequest")?void 0:n}))}},{key:"_callAjax",value:function(e){var t=O.create("AjaxCall",s.a.extend({retryIntervals:[100,500,500,500]},e,this.ajaxCallOptions),{ensureUniqueId:!1});return this.registerAjaxCall(t),t.call().always(this.unregisterAjaxCall.bind(this,t))}},{key:"_performUserAjaxRequest",value:function(e,t,n){t&&this.setBusy(!0),this.setRequestPending(!0);var r=null,o=!1;this._callAjax({ajaxOptions:e,request:n,name:this._getRequestName(n,"user request")}).done(function(e){try{t&&!this.areBusyIndicatedEventsQueued()&&this.setBusy(!1),o=this.responseQueue.process(e)}catch(e){r=r||e}}.bind(this)).fail(function(e){try{t&&this.setBusy(!1),this._processErrorResponse(e.jqXHR,e.textStatus,e.errorThrown,n)}catch(e){r=r||e}}.bind(this)).always(function(e,t,n){if(this.setRequestPending(!1),o){if(this._resumeBackgroundJobPolling(),this._fireRequestFinished(e),this._retryRequest){var i=this._retryRequest;this._retryRequest=null,this.responseQueue.prepareRequest(i),this._sendRequest(i)}else if(this._queuedRequest){var s=this._queuedRequest;this._queuedRequest=null,this.responseQueue.prepareRequest(s),this._sendRequest(s)}this._sendTimeoutId||this._sendNow()}else this.setBusy(!1);if(this.layoutValidator.validate(),r)throw r}.bind(this))}},{key:"registerAjaxCall",value:function(e){this.ajaxCalls.push(e)}},{key:"unregisterAjaxCall",value:function(e){rt.remove(this.ajaxCalls,e)}},{key:"interruptAllAjaxCalls",value:function(){this.ajaxCalls.slice().forEach((function(e){e.pendingCall&&e.pendingCall.abort()}))}},{key:"abortAllAjaxCalls",value:function(){this.ajaxCalls.slice().forEach((function(e){e.abort()}))}},{key:"_resumeBackgroundJobPolling",value:function(){this.backgroundJobPollingSupport.enabled&&this.backgroundJobPollingSupport.status!==as.RUNNING&&(s.a.log.isInfoEnabled()&&s.a.log.info("Resume background jobs polling request, status was="+this.backgroundJobPollingSupport.status),this._pollForBackgroundJobs())}},{key:"_pollForBackgroundJobs",value:function(){this.backgroundJobPollingSupport.setRunning();var e=this._newRequest({pollForBackgroundJobs:!0});this.responseQueue.prepareRequest(e);var t=this.defaultAjaxOptions(e);this._callAjax({ajaxOptions:t,request:e,name:this._getRequestName(e,"request")}).done(function(e){if(e.error)s.a.log.warn("Polling request failed. Interrupt polling until the next user-initiated request succeeds"),this.backgroundJobPollingSupport.setFailed(),this.areRequestsPending()?this.responseQueue.add(e):this.responseQueue.process(e);else if(e.sessionTerminated)s.a.log.info("Session terminated, stopped polling for background jobs"),this.backgroundJobPollingSupport.setStopped(),!this.loggedOut&&e.redirectUrl&&this.logout(e.redirectUrl);else try{this.areRequestsPending()?this.responseQueue.add(e):(this.responseQueue.process(e),this.layoutValidator.validate()),setTimeout(this._pollForBackgroundJobs.bind(this))}catch(e){throw this.backgroundJobPollingSupport.setFailed(),e}}.bind(this)).fail(function(t){this.backgroundJobPollingSupport.setFailed(),this._processErrorResponse(t.jqXHR,t.textStatus,t.errorThrown,e)}.bind(this))}},{key:"processJsonResponseInternal",value:function(e){var t=!1;return e.error?this._processErrorJsonResponse(e.error):(this._processSuccessResponse(e),t=!0),t}},{key:"_processSuccessResponse",value:function(e){if(e.adapterData&&this._copyAdapterData(e.adapterData),e.events){this.processingEvents=!0;try{this._processEvents(e.events)}finally{this.processingEvents=!1}}if(s.a.log.isDebugEnabled()){var t=Pr.countOwnProperties(this._adapterDataCache);s.a.log.trace("size of _adapterDataCache after response has been processed: "+t),t=Pr.countOwnProperties(this.modelAdapterRegistry),s.a.log.trace("size of modelAdapterRegistry after response has been processed: "+t)}}},{key:"_copyAdapterData",value:function(e){var t,n=0;for(t in e)this._adapterDataCache[t]=e[t],n++;n>0&&s.a.log.isTraceEnabled()&&s.a.log.trace("Stored "+n+" properties in adapterDataCache")}},{key:"_processErrorResponse",value:function(e,t,n,r){if(s.a.log.error("errorResponse: status="+e.status+", textStatus="+t+", errorThrown="+n),ei.isOfflineError(e,t,n,r)){if(this.ready)return this.goOffline(),void(!r||r.pollForBackgroundJobs||this._retryRequest||(this._retryRequest=r));n=n||this.optText("ui.ConnectionInterrupted","Connection interrupted")}var o={header:this.optText("ui.NetworkError","Network error"),body:Wn.join(" ",e.status||"",n),yesButtonText:this.optText("ui.Reload","Reload"),yesButtonAction:function(){O.reloadPage()},noButtonText:this.ready?this.optText("ui.Ignore","Ignore"):null};this.showFatalMessage(o,e.status+".net")}},{key:"_processErrorJsonResponse",value:function(t){if(t.code===e.JsonResponseError.VERSION_MISMATCH){if(!Ho.getItemFromSessionStorage("scout:versionMismatch"))return Ho.setItemToSessionStorage("scout:versionMismatch","yes"),void O.reloadPage();Ho.removeItemFromSessionStorage("scout:versionMismatch")}if(!this.loggedOut){var n={header:this.optText("ui.ServerError","Server error")+" ("+this.optText("ui.ErrorCodeX","Code "+t.code,t.code)+")",body:t.message,yesButtonText:this.optText("ui.Reload","Reload"),yesButtonAction:function(){O.reloadPage()}};t.code===e.JsonResponseError.STARTUP_FAILED?(n.header=t.message,n.body=null,n.yesButtonText="Retry"):t.code===e.JsonResponseError.SESSION_TIMEOUT?(n.header=this.optText("ui.SessionTimeout",n.header),n.body=this.optText("ui.SessionExpiredMsg",n.body)):t.code===e.JsonResponseError.UI_PROCESSING?(n.header=this.optText("ui.UnexpectedProblem",n.header),n.body=Wn.join("\n\n",this.optText("ui.InternalProcessingErrorMsg",n.body," ("+this.optText("ui.ErrorCodeX","Code 20","20")+")"),this.optText("ui.UiInconsistentMsg","")),n.noButtonText=this.optText("ui.Ignore","Ignore")):t.code===e.JsonResponseError.UNSAFE_UPLOAD&&(n.header=this.optText("ui.UnsafeUpload",n.header),n.body=this.optText("ui.UnsafeUploadMsg",n.body),n.yesButtonText=this.optText("ui.Ok","Ok"),n.yesButtonAction=function(){}),this.showFatalMessage(n,t.code)}}},{key:"_fireRequestFinished",value:function(e){if(this._deferred){if(e.events)for(var t=0;t<e.events.length;t++)this._deferredEventTypes.push(e.events[t].type);0===this.requestsPendingCounter&&(this._deferred.resolve(this._deferredEventTypes),this._deferred=null,this._deferredEventTypes=null)}}},{key:"showFatalMessage",value:function(e,t){var n=this;if(t){if(this._fatalMessagesOnScreen[t])return;this._fatalMessagesOnScreen[t]=!0}this._setApplicationLoading(!1),e=e||{};var r={session:this,parent:this.desktop||new Fe,iconId:e.iconId,severity:O.nvl(e.severity,Br.Severity.ERROR),header:e.header,body:e.body,hiddenText:e.hiddenText,yesButtonText:e.yesButtonText,noButtonText:e.noButtonText,cancelButtonText:e.cancelButtonText},o=O.create("MessageBox",r),i=e.entryPoint||this.$entryPoint;o.on("action",(function(r){delete n._fatalMessagesOnScreen[t],o.destroy();var i=r.option;"yes"===i&&e.yesButtonAction?e.yesButtonAction.apply(n):"no"===i&&e.noButtonAction?e.noButtonAction.apply(n):"cancel"===i&&e.cancelButtonAction&&e.cancelButtonAction.apply(n)})),o.render(i)}},{key:"uploadFiles",value:function(t,n,r,o,i){var a=new FormData,l=[];if(r&&s.a.each(r,(function(e,t){a.append(e,t)})),s.a.each(n,(function(t,n){if(!i||0===i.length||O.isOneOf(n.type,i)){var r=O.nvl(n.scoutName,n.name,e.EMPTY_UPLOAD_FILENAME);a.append("files",n,r),l.push(n)}})),o=O.nvl(o,fT.DEFAULT_MAXIMUM_UPLOAD_SIZE),!Wt.validateMaximumUploadSize(l,o)){var u={header:this.text("ui.FileSizeLimitTitle"),body:this.text("ui.FileSizeLimit",o/1024/1024),yesButtonText:this.optText("Ok","Ok")};return this.showFatalMessage(u),!1}var c={type:"POST",url:"upload/"+this.uiSessionId+"/"+t.id,cache:!1,processData:!1,contentType:!1,data:a};a.polyfill&&a.applyToAjaxOptions(c),this.responseQueue.prepareHttpRequest(c);var f=!this.areRequestsPending();return this._performUserAjaxRequest(c,f),!0}},{key:"goOffline",value:function(){var e=this;this.offline||(this.offline=!0,this.abortAllAjaxCalls(),setTimeout((function(){e.unloading||e.unloaded||(e.rootAdapter.goOffline(),e.reconnector.start())}),100))}},{key:"goOnline",value:function(){this.offline=!1,this.rootAdapter.goOnline();var e=this._newRequest({syncResponseQueue:!0});this.responseQueue.prepareRequest(e),this._sendRequest(e)}},{key:"onReconnecting",value:function(){this.desktop&&this.desktop.onReconnecting()}},{key:"onReconnectingSucceeded",value:function(){this.desktop&&this.desktop.onReconnectingSucceeded(),this.goOnline()}},{key:"onReconnectingFailed",value:function(){this.desktop&&this.desktop.onReconnectingFailed()}},{key:"listen",value:function(){return this._deferred||(this._deferred=s.a.Deferred(),this._deferredEventTypes=[]),this._deferred}},{key:"onRequestsDone",value:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];function o(){e.apply(this,n)}this.areRequestsPending()||this.areEventsQueued()?this.listen().done(o):e.apply(this,n)}},{key:"onEventsProcessed",value:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];function o(){e.apply(this,n)}this.processingEvents?this.one("eventsProcessed",o):o()}},{key:"areEventsQueued",value:function(){return this.asyncEvents.length>0}},{key:"areBusyIndicatedEventsQueued",value:function(){return this.asyncEvents.some((function(e){return O.nvl(e.showBusyIndicator,!0)}))}},{key:"areResponsesQueued",value:function(){return this.responseQueue.size()>0}},{key:"areRequestsPending",value:function(){return this.requestsPendingCounter>0}},{key:"setRequestPending",value:function(e){e?this.requestsPendingCounter++:this.requestsPendingCounter--,this.inspector&&this.$entryPoint.toggleAttr("data-request-pending",e,"true")}},{key:"setBusy",value:function(e){e?(this._busy||this._renderBusy(),this._busy=!0):(this._busy&&this._removeBusy(),this._busy=!1)}},{key:"_renderBusy",value:function(){var e=this;null!==this._busyIndicatorTimeoutId&&void 0!==this._busyIndicatorTimeoutId||(this._busyIndicatorTimeoutId=setTimeout((function(){e._busyIndicator||e.desktop&&e.desktop.rendered&&(e._busyIndicator=O.create("BusyIndicator",{parent:e.desktop}),e._busyIndicator.on("cancel",e._onCancelProcessing.bind(e)),e._busyIndicator.render(e.$entryPoint))}),500))}},{key:"_removeBusy",value:function(){clearTimeout(this._busyIndicatorTimeoutId),this._busyIndicatorTimeoutId=null,this._busyIndicator&&(this._busyIndicator.destroy(),this._busyIndicator=null)}},{key:"_onCancelProcessing",value:function(e){var t=this._busyIndicator;t&&(t.off("cancel"),setTimeout((function(){t.cancelled()}),100),this._sendCancelRequest())}},{key:"_sendCancelRequest",value:function(){var e=this._newRequest({cancel:!0,showBusyIndicator:!1});this._sendRequest(e)}},{key:"sendLogRequest",value:function(e){var t=this._newRequest({log:!0,message:e});this.currentEvent&&(t.event={target:this.currentEvent.target,type:this.currentEvent.type}),s.a.ajax(this.defaultAjaxOptions(t))}},{key:"_newRequest",value:function(e){var t=s.a.extend({uiSessionId:this.uiSessionId},e);return t.log||t.syncResponseQueue||(t["#"]=this.requestSequenceNo++),t}},{key:"_setApplicationLoading",value:function(e){var t=this;e?this._applicationLoadingTimeoutId=setTimeout((function(){t.desktop&&t.desktop.rendered||t._renderApplicationLoading()}),200):(clearTimeout(this._applicationLoadingTimeoutId),this._applicationLoadingTimeoutId=null,this._removeApplicationLoading())}},{key:"_renderApplicationLoading",value:function(){var e=s()("body").appendDiv("application-loading-root").addClass("application-loading-root").fadeIn();e.appendDiv("application-loading01").hide().fadeIn(),e.appendDiv("application-loading02").hide().fadeIn()}},{key:"_removeApplicationLoading",value:function(){var e=s()("body").children(".application-loading-root");e.addClass("application-loading-root-fadeout"),Kt.get().supportsCssAnimation()?e.oneAnimationEnd((function(){e.remove()})):e.remove()}},{key:"_processEvents",value:function(e){for(var t=0;t<e.length;){var n=e[t];this.currentEvent=n;var r=this.getModelAdapter(n.target);r?(e.splice(t,1),t=0,s.a.log.isDebugEnabled()&&s.a.log.debug("Processing event '"+n.type+"' for adapter with ID "+n.target),r.onModelEvent(n),r.resetEventFilters()):(s.a.log.isDebugEnabled()&&s.a.log.debug("Postponing '"+n.type+"' for adapter with ID "+n.target),t++)}if(this.currentEvent=null,e.length)throw new Error("Could not resolve event targets: ["+e.map((function(e){var t="target: "+e.target+", type: "+e.type;return e.properties&&(t+=", properties: "+Object.keys(e.properties)),'"'+t+'"'}),this).join(", ")+"]");this.trigger("eventsProcessed")}},{key:"start",value:function(){return s.a.log.isInfoEnabled()&&s.a.log.info("Session starting..."),this._setApplicationLoading(!0),this._sendStartupRequest()}},{key:"onModelEvent",value:function(e){"localeChanged"===e.type?this._onLocaleChanged(e):"logout"===e.type?this._onLogout(e):"disposeAdapter"===e.type?this._onDisposeAdapter(e):"reloadPage"===e.type?this._onReloadPage(e):s.a.log.warn('Model action "'+e.type+'" is not supported by UI session')}},{key:"resetEventFilters",value:function(){}},{key:"_onLocaleChanged",value:function(e){var t=new _s(e.locale),n=new ip(e.textMap);this.switchLocale(t,n)}},{key:"switchLocale",value:function(e,t){O.assertParameter("locale",e,_s),this.locale=e,this.textMap=bp.get(e.languageTag),t&&Pr.copyOwnProperties(t,this.textMap),this.trigger("localeSwitch",{locale:this.locale})}},{key:"_renderDesktop",value:function(){this.desktop.render(this.$entryPoint),this.desktop.invalidateLayoutTree(!1),this._setApplicationLoading(!1)}},{key:"_onLogout",value:function(e){this.logout(e.redirectUrl)}},{key:"logout",value:function(e){if(this.loggedOut=!0,this.forceNewClientSession)this.desktop.$container.window(!0).close();else{var t=new xo;t.removeParameter("dl"),t.removeParameter("i"),Ho.setItemToSessionStorage("scout:loginUrl",t.toString()),setTimeout((function(){O.reloadPage({redirectUrl:e})}))}}},{key:"_onDisposeAdapter",value:function(e){var t=this.getModelAdapter(e.adapter);t&&t.destroy()}},{key:"_onReloadPage",value:function(e){O.reloadPage({clearBody:!1})}},{key:"_onWindowBeforeUnload",value:function(){var e=this;s.a.log.isInfoEnabled()&&s.a.log.info("Session before unloading..."),this.unloading=!0,setTimeout((function(){e.unloading=!1}),200)}},{key:"_onWindowUnload",value:function(){s.a.log.isInfoEnabled()&&s.a.log.info("Session unloading..."),this.unloaded=!0,this.desktop&&this.desktop.formController&&this.desktop.formController.closePopupWindows(),this.loggedOut||this._sendUnloadRequest(),this.loggedOut&&this.persistent&&Ho.removeItemFromLocalStorage("scout:clientSessionId")}},{key:"_getAdapterData",value:function(e){var t=this._adapterDataCache[e];return!this.adapterExportEnabled&&delete this._adapterDataCache[e],t}},{key:"getAdapterData",value:function(e){return this._adapterDataCache[e]}},{key:"text",value:function(e){for(var t,n=arguments.length,r=new Array(n>1?n-1:0),o=1;o<n;o++)r[o-1]=arguments[o];return(t=this.textMap).get.apply(t,[e].concat(r))}},{key:"optText",value:function(e,t){for(var n,r=arguments.length,o=new Array(r>2?r-2:0),i=2;i<r;i++)o[i-2]=arguments[i];return(n=this.textMap).optGet.apply(n,[e,t].concat(o))}},{key:"textExists",value:function(e){return this.textMap.exists(e)}},{key:"_createEventSupport",value:function(){return new ln}},{key:"trigger",value:function(e,t){(t=t||{}).source=this,this.events.trigger(e,t)}},{key:"one",value:function(e,t){this.events.one(e,t)}},{key:"on",value:function(e,t){return this.events.on(e,t)}},{key:"off",value:function(e,t){this.events.off(e,t)}},{key:"addListener",value:function(e){this.events.addListener(e)}},{key:"removeListener",value:function(e){this.events.removeListener(e)}},{key:"when",value:function(e){return this.events.when(e)}}])&&Ps(t.prototype,n),r&&Ps(t,r),e}();Rs(xs,"JsonResponseError",{STARTUP_FAILED:5,SESSION_TIMEOUT:10,UI_PROCESSING:20,UNSAFE_UPLOAD:30,VERSION_MISMATCH:40}),Rs(xs,"EMPTY_UPLOAD_FILENAME","*empty*");var Es=function e(t){if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),!(t=t||{}).deviceType)throw new Error("deviceType needs to be defined");this.deviceType=t.deviceType,this.touch=O.nvl(t.touch,!1),this.standalone=O.nvl(t.standalone,!1)};function Ds(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var As=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.filters=[]}var t,n,r;return t=e,(n=[{key:"addFilter",value:function(e){this.filters.push(e)}},{key:"addFilterForEventType",value:function(e){this.filters.push((function(t){return t.type===e}))}},{key:"filter",value:function(e){return this.filters.some((function(t){return t(e)}))}},{key:"reset",value:function(){this.filters=[]}}])&&Ds(t.prototype,n),r&&Ds(t,r),e}();function Fs(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var $s=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),t instanceof e?(this.width=t.width,this.height=t.height):(this.width=t||0,this.height=n||0)}var t,n,r;return t=e,(n=[{key:"toString",value:function(){return"Dimension[width="+this.width+" height="+this.height+"]"}},{key:"equals",value:function(e){return!!e&&this.width===e.width&&this.height===e.height}},{key:"clone",value:function(){return new e(this.width,this.height)}},{key:"subtract",value:function(t){return new e(this.width-t.horizontal(),this.height-t.vertical())}},{key:"add",value:function(t){return new e(this.width+t.horizontal(),this.height+t.vertical())}},{key:"floor",value:function(){return new e(Math.floor(this.width),Math.floor(this.height))}},{key:"ceil",value:function(){return new e(Math.ceil(this.width),Math.ceil(this.height))}}])&&Fs(t.prototype,n),r&&Fs(t,r),e}();function js(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Bs=function(){function e(t,n,r,o){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),t instanceof e?(this.top=t.top,this.right=t.right,this.bottom=t.bottom,this.left=t.left):(this.top=t||0,this.right=n||0,this.bottom=r||0,this.left=o||0)}var t,n,r;return t=e,(n=[{key:"toString",value:function(){return"Insets[top="+this.top+" right="+this.right+" bottom="+this.bottom+" left="+this.left+"]"}},{key:"equals",value:function(e){return this.top===e.top&&this.right===e.right&&this.bottom===e.bottom&&this.left===e.left}},{key:"clone",value:function(){return new e(this.top,this.right,this.bottom,this.left)}},{key:"horizontal",value:function(){return this.right+this.left}},{key:"vertical",value:function(){return this.top+this.bottom}},{key:"floor",value:function(){return new e(Math.floor(this.top),Math.floor(this.right),Math.floor(this.bottom),Math.floor(this.left))}},{key:"ceil",value:function(){return new e(Math.ceil(this.top),Math.ceil(this.right),Math.ceil(this.bottom),Math.ceil(this.left))}}])&&js(t.prototype,n),r&&js(t,r),e}();function Ms(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Is=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),t instanceof e?(this.x=t.x,this.y=t.y):(this.x=t||0,this.y=n||0)}var t,n,r;return t=e,(n=[{key:"toString",value:function(){return"Point[x="+this.x+" y="+this.y+"]"}},{key:"equals",value:function(e){return!!e&&this.x===e.x&&this.y===e.y}},{key:"clone",value:function(){return new e(this.x,this.y)}},{key:"add",value:function(t){return new e(this.x+t.x,this.y+t.y)}},{key:"subtract",value:function(t){return new e(this.x-t.x,this.y-t.y)}},{key:"floor",value:function(){return new e(Math.floor(this.x),Math.floor(this.y))}},{key:"ceil",value:function(){return new e(Math.ceil(this.x),Math.ceil(this.y))}}])&&Ms(t.prototype,n),r&&Ms(t,r),e}();function Ls(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Hs=function(){function e(t,n,r,o){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),t instanceof e?(this.x=t.x,this.y=t.y,this.width=t.width,this.height=t.height):(this.x=t||0,this.y=n||0,this.width=r||0,this.height=o||0)}var t,n,r;return t=e,(n=[{key:"toString",value:function(){return"Rectangle[x="+this.x+" y="+this.y+" width="+this.width+" height="+this.height+"]"}},{key:"equals",value:function(e){return!!e&&this.x===e.x&&this.y===e.y&&this.width===e.width&&this.height===e.height}},{key:"clone",value:function(){return new e(this.x,this.y,this.width,this.height)}},{key:"center",value:function(){return new Is(this.x+this.width/2,this.y+this.height/2)}},{key:"right",value:function(){return this.x+this.width}},{key:"bottom",value:function(){return this.y+this.height}},{key:"contains",value:function(e,t){return t>=this.y&&t<this.y+this.height&&e>=this.x&&e<this.x+this.width}},{key:"intersects",value:function(e){return!!e&&e.width>0&&e.height>0&&this.width>0&&this.height>0&&e.x<this.right()&&e.right()>this.x&&e.y<this.bottom()&&e.bottom()>this.y}},{key:"subtract",value:function(t){return new e(this.x+t.left,this.y+t.top,this.width-t.horizontal(),this.height-t.vertical())}},{key:"subtractFromDimension",value:function(e){return new scout.Rectangle(this.x,this.y,this.width-e.horizontal(),this.height-e.vertical())}},{key:"translate",value:function(t,n){return new e(this.x+t,this.y+n,this.width,this.height)}},{key:"point",value:function(){return new Is(this.x,this.y)}},{key:"dimension",value:function(){return new $s(this.width,this.height)}},{key:"union",value:function(t){var n=this.width,r=this.height;if(n<0||r<0)return new e(t.x,t.y,t.width,t.height);var o=t.width,i=t.height;if(o<0||i<0)return new e(this.x,this.y,this.width,this.height);var s=this.x,a=this.y;n+=s,r+=a;var l=t.x,u=t.y;return s>l&&(s=l),a>u&&(a=u),n<(o+=l)&&(n=o),r<(i+=u)&&(r=i),r-=a,(n-=s)>Number.MAX_VALUE&&(n=Number.MAX_VALUE),r>Number.MAX_VALUE&&(r=Number.MAX_VALUE),new e(s,a,n,r)}},{key:"floor",value:function(){return new e(Math.floor(this.x),Math.floor(this.y),Math.floor(this.width),Math.floor(this.height))}},{key:"ceil",value:function(){return new e(Math.ceil(this.x),Math.ceil(this.y),Math.ceil(this.width),Math.ceil(this.height))}}])&&Ls(t.prototype,n),r&&Ls(t,r),e}();function Ns(e,t){if(!e[0]||e.isDisplayNone())return new $s(0,0);t="boolean"==typeof t?{includeMargin:t}:t||{};var n={includeMargin:!1,useCssSize:!1,widthHint:void 0,heightHint:void 0,restoreScrollPositions:!0};if((t=s.a.extend({},n,t)).animateClasses&&t.animateClasses.length>0)return Ws(e,t);var r=e.attr("style"),o=e.scrollLeft(),i=e.scrollTop();t.restoreScrollPositions&&Lh.storeScrollPositions(e);var a={width:t.useCssSize?"":O.nvl(t.widthHint,"auto"),height:t.useCssSize?"":O.nvl(t.heightHint,"auto")};Kt.get().isInternetExplorer()&&"flex"===e.css("display")&&(a.position="fixed"),e.css(a);var l=e[0].getBoundingClientRect(),u=new $s(l.width,l.height);return t.includeMargin&&(u.width+=e.cssMarginX(),u.height+=e.cssMarginY()),e.attrOrRemove("style",r),e.scrollLeft(o),e.scrollTop(i),t.restoreScrollPositions&&Lh.restoreScrollPositions(e),Vs(u,t)}function Vs(e,t){return O.nvl(t.exact,!1)||(e.width=Math.ceil(e.width),e.height=Math.ceil(e.height)),e}function Ws(e,t){var n=rt.ensure(t.animateClasses);if(n=n.filter((function(t){return e.hasClass(t)})),(t=s.a.extend({},t)).animateClasses=null,0===n.length)return Ns(e,t);n=rt.format(n," ");var r=e.clone().removeClass(n).appendTo(e.parent()),o=Ns(r,t);return r.remove(),o}function zs(e,t){if(!e[0]||e.isDisplayNone())return new $s(0,0);t="boolean"==typeof t?{includeMargin:t}:t||{};var n=e[0].getBoundingClientRect(),r=new $s(n.width,n.height);return O.nvl(t.includeMargin,!1)&&(r.width+=e.cssMarginX(),r.height+=e.cssMarginY()),O.nvl(t.exact,!1)||(r.width=Math.ceil(r.width),r.height=Math.ceil(r.height)),r}function Gs(e,t){t="boolean"==typeof t?{includeMargin:t}:t||{};var n,r=["top","right","bottom","left"],o=[0,0,0,0],i=O.nvl(t.includeMargin,!1),s=O.nvl(t.includePadding,!0),a=O.nvl(t.includeBorder,!0);for(n=0;n<r.length;n++)i&&(o[n]+=e.cssPxValue("margin-"+r[n])),s&&(o[n]+=e.cssPxValue("padding-"+r[n])),a&&(o[n]+=e.cssPxValue("border-"+r[n]+"-width"));return new Bs(o[0],o[1],o[2],o[3])}function Us(e,t,n){var r=zs(e,n);return new Hs(t.left,t.top,r.width,r.height)}var Ks,qs={borders:function(e){return Gs(e,{includeMargin:!1,includePadding:!1,includeBorder:!0})},bounds:function(e,t){return Us(e,e.position(),t)},cssBounds:function(e){return new Hs(e.cssLeft(),e.cssTop(),e.cssWidth(),e.cssHeight())},cssMaxSize:function(e){return new $s(e.cssMaxWidth(),e.cssMaxHeight())},cssMinSize:function(e){return new $s(e.cssMinWidth(),e.cssMinHeight())},cssSize:function(e){return new $s(e.cssWidth(),e.cssHeight())},debugOutput:function(e){if(!e)return"$comp is undefined";if(0===(e=s.a.ensure(e)).length)return"$comp doesn\t match any elements";var t="";if(e.attr("id")&&(t+="id="+e.attr("id")),e.attr("class")&&(t+=" class="+e.attr("class")),e.attr("data-modelclass")&&(t+=" data-modelclass="+e.attr("data-modelclass")),0===t.length){var n=O.nvl(e.html(),"");n.length>30&&(n=n.substring(0,30)+"..."),t=n}return e.isAttached()||(t+=" attached=false"),"Element["+t.trim()+"]"},exactPrefSize:Vs,insets:Gs,location:function(e){return new Is(e.cssLeft(),e.cssTop())},margins:function(e){return Gs(e,{includeMargin:!0,includePadding:!1,includeBorder:!1})},offset:function(e){var t=e.offset();return new Is(t.left,t.top)},offsetBounds:function(e,t){return Us(e,e.offset(),t)},paddings:function(e){return Gs(e,{includeMargin:!1,includePadding:!0,includeBorder:!1})},position:function(e){var t=e.position();return new Is(t.left,t.top)},prefSize:Ns,prefSizeWithoutAnimation:Ws,setBounds:function(e,t,n,r,o){var i=t instanceof Hs?t:new Hs(t,n,r,o);e.cssLeft(i.x).cssTop(i.y).cssWidth(i.width).cssHeight(i.height)},setLocation:function(e,t,n){var r=t instanceof Is?t:new Is(t,n);e.cssLeft(r.x).cssTop(r.y)},setMargins:function(e,t){e.css({marginLeft:t.left,marginRight:t.right,marginTop:t.top,marginBottom:t.bottom})},setSize:function(e,t,n){var r=t instanceof $s?t:new $s(t,n);e.cssWidth(r.width).cssHeight(r.height)},size:zs};function Ys(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Xs=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.formRowHeight=30,this.formRowGap=10,this.formColumnWidth=420,this.formColumnGap=32,this.smallColumnGap=4,this.fieldLabelWidth=140,this.fieldMandatoryIndicatorWidth=8,this.fieldStatusWidth=20,this.events=new ln}var t,n,r;return t=e,r=[{key:"get",value:function(){return Ks}}],(n=[{key:"init",value:function(e){e=e?" "+e:"",this.formRowHeight=To.getSize("html-env-logical-grid-row"+e,"height","height",this.formRowHeight),this.formRowGap=To.getSize("html-env-logical-grid-row"+e,"margin-bottom","marginBottom",this.formRowGap),this.formColumnWidth=To.getSize("html-env-logical-grid-column"+e,"width","width",this.formColumnWidth),this.formColumnGap=To.getSize("html-env-logical-grid-column"+e,"margin-right","marginRight",this.formColumnGap),this.smallColumnGap=To.getSize("html-env-logical-grid-column"+e,"margin-left","marginLeft",this.smallColumnGap),this.fieldLabelWidth=To.getSize("html-env-field-label"+e,"width","width",this.fieldLabelWidth),this.fieldMandatoryIndicatorWidth=To.getSize("html-env-field-mandatory-indicator"+e,"width","width",this.fieldMandatoryIndicatorWidth),this.fieldStatusWidth=To.getSize("html-env-field-status"+e,"width","width",this.fieldStatusWidth);var t={source:this};this.events.trigger("propertyChange",t)}},{key:"on",value:function(e,t){return this.events.on(e,t)}},{key:"off",value:function(e,t){return this.events.off(e,t)}}])&&Ys(t.prototype,n),r&&Ys(t,r),e}();function Js(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}E.addListener("prepare",(function(){Ks||(Ks=O.create("HtmlEnvironment")).init()}));var Zs=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.animateClasses=[]}var t,n,r;return t=e,(n=[{key:"invalidate",value:function(){}},{key:"layout",value:function(e){}},{key:"_revertSizeHintsAdjustments",value:function(e,t){var n=ea.get(e);t.widthHint&&(t.widthHint+=n.insets().horizontal()),t.heightHint&&(t.heightHint+=n.insets().vertical())}},{key:"preferredLayoutSize",value:function(e,t){return t=s.a.extend({},t),this.animateClasses.length>0&&(t.animateClasses=this.animateClasses),this._revertSizeHintsAdjustments(e,t),qs.prefSize(e,t)}}])&&Js(t.prototype,n),r&&Js(t,r),e}();function Qs(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var ea=function(){function e(t,n){if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),!n)throw new Error("session must be defined for "+this.debug());this.$comp=t,this.layout=new Sl,this.layoutData=null,this.valid=!1,this.validateRoot=!1,this.layouted=!1,this.layouting=!1,this.suppressInvalidate=!1,this.suppressValidate=!1,this.pixelBasedSizing=!0,this.sizeCached=null,this.prefSizeCached={},this.session=n,this.scrollable=!1}var t,n,r;return t=e,r=[{key:"install",value:function(t,n){if(!t)throw new Error('Missing argument "$comp"');if(!n)throw new Error('Missing argument "session"');var r=new e(t,n);return t.data("htmlComponent",r),r}},{key:"get",value:function(e){var t=this.optGet(e);if(!t){var n="";throw e&&(n="\nClass: "+e.attr("class"),n+="\nId: "+e.attr("id"),n+="\nAttached: "+e.isAttached()),new Error('data "htmlComponent" is undefined.'+n)}return t}},{key:"optGet",value:function(e){return e&&e.data("htmlComponent")}}],(n=[{key:"getParent",value:function(){var t=this.$comp.parent();return 0===t.length?null:e.optGet(t)}},{key:"isDescendantOf",value:function(t){for(var n=this.$comp.parent();n.length>0;){if(e.optGet(n)===t)return!0;n=n.parent()}return!1}},{key:"availableSize",value:function(e){e=e||{};var t=this.size({exact:e.exact});if(this.scrollable){var n=this.prefSize({widthHint:t.width,removeMarginFromHints:!1});n.height>t.height&&(t.height=n.height)}return t}},{key:"invalidateLayout",value:function(e){this.valid=!1,this.prefSizeCached={},this.layout&&this.layout.invalidate(e)}},{key:"validateLayout",value:function(){if(!this.layout)throw new Error("Called layout() but component has no layout");return!!this.valid||!this.suppressValidate&&!this.layouting&&!!this._checkValidationPossible()&&(this.layouting=!0,this.layout.layout(this.$comp),this.layouting=!1,this.layouted=!0,this.sizeCached=this.size({exact:!0}),this.valid=!0,!0)}},{key:"_checkValidationPossible",value:function(){if(!this.isAttachedAndVisible())return!1;if(this.$comp.hasAnimationClass())return this._validateLayoutAfterAnimation(this.$comp),!1;var e=this.getParent();if(!e||!e.layouting){var t=!0,n=null;if(this.$comp.parents().each((function(){var e=s()(this);return e.isVisible()?!e.hasAnimationClass()||(n=e,!1):(t=!1,!1)})),!t)return!1;if(n)return this._validateLayoutAfterAnimation(n),!1}return!0}},{key:"_validateLayoutAfterAnimation",value:function(e){e.oneAnimationEnd(this.validateLayout.bind(this))}},{key:"revalidateLayout",value:function(){this.invalidateLayout(),this.validateLayout()}},{key:"invalidateLayoutTree",value:function(e){this.suppressInvalidate||(O.nvl(e,!0)?this.session.layoutValidator.invalidateTree(this):(this.invalidateLayout(),this.session.layoutValidator.invalidate(this)))}},{key:"validateLayoutTree",value:function(){this.suppressValidate||this.session.layoutValidator.validate()}},{key:"revalidateLayoutTree",value:function(e){this.suppressInvalidate||(this.invalidateLayoutTree(e),this.validateLayoutTree())}},{key:"isValidateRoot",value:function(){return!!this.validateRoot||!(!this.layoutData||!this.layoutData.isValidateRoot)&&this.layoutData.isValidateRoot()}},{key:"setLayout",value:function(e){this.layout=e,e.cssClass&&this.$comp.addClass(e.cssClass)}},{key:"prefSize",value:function(e){if(!this.isVisible())return new $s(0,0);e="boolean"==typeof e?{includeMargin:e}:s.a.extend({},e);var t=O.nvl(e.includeMargin,!1);if(e.includeMargin=null,!this.layout)throw new Error("Called prefSize() but component has no layout");var n=this.computePrefSizeKey(e),r=this.prefSizeCached[n];if(!s.a.isEmptyObject(r))return s.a.log.isTraceEnabled()&&s.a.log.trace("(HtmlComponent#prefSize) "+this.debug()+" widthHint="+e.widthHint+" heightHint="+e.heightHint+" prefSizeCached="+r),t&&(r=r.add(this.margins())),r.clone();var o=this.cssMinSize(),i=this.cssMaxSize();(e.widthHint||e.heightHint)&&this._adjustSizeHintsForPrefSize(e,o,i);var a=this.layout.preferredLayoutSize(this.$comp,e);return this._adjustPrefSizeWithMinMaxSize(a,o,i),this.prefSizeCached[n]=a,s.a.log.isTraceEnabled()&&s.a.log.trace("(HtmlComponent#prefSize) "+this.debug()+" widthHint="+e.widthHint+" heightHint="+e.heightHint+" prefSize="+a),t&&(a=a.add(this.margins())),a.clone()}},{key:"computePrefSizeKey",value:function(e){return"wHint"+O.nvl(e.widthHint,"-1")+"hHint"+O.nvl(e.heightHint,"-1")+"wOnly"+O.nvl(e.widthOnly,"-1")}},{key:"_adjustSizeHintsForPrefSize",value:function(e,t,n){var r=O.nvl(e.removeMarginFromHints,!0),o=O.nvl(e.removeInsetsFromHints,!0);if(e.removeMarginFromHints=null,e.removeInsetsFromHints=null,e.widthHint||e.heightHint){var i=r?this.margins():new Bs,s=o?this.insets():new Bs;e.widthHint&&(e.widthHint-=i.horizontal(),e.widthHint=Math.max(e.widthHint,t.width),e.widthHint=Math.min(e.widthHint,n.width),e.widthHint-=s.horizontal()),e.heightHint&&(e.heightHint-=i.vertical(),e.heightHint=Math.max(e.heightHint,t.height),e.heightHint=Math.min(e.heightHint,n.height),e.heightHint-=s.vertical())}}},{key:"_adjustPrefSizeWithMinMaxSize",value:function(e,t,n){t=t||this.cssMinSize(),n=n||this.cssMaxSize(),e.height=Math.max(e.height,t.height),e.height=Math.min(e.height,n.height),e.width=Math.max(e.width,t.width),e.width=Math.min(e.width,n.width)}},{key:"insets",value:function(e){return qs.insets(this.$comp,e)}},{key:"margins",value:function(){return qs.margins(this.$comp)}},{key:"borders",value:function(){return qs.borders(this.$comp)}},{key:"cssMinSize",value:function(){return qs.cssMinSize(this.$comp)}},{key:"cssMaxSize",value:function(){return qs.cssMaxSize(this.$comp)}},{key:"size",value:function(e){return qs.size(this.$comp,e)}},{key:"setSize",value:function(e){if(this.isAttachedAndVisible()){var t=this.sizeCached;e.equals(t)||this.invalidateLayout(),this.pixelBasedSizing&&qs.setSize(this.$comp,e),this.validateLayout()}}},{key:"bounds",value:function(e){return qs.bounds(this.$comp,e)}},{key:"position",value:function(){return qs.position(this.$comp)}},{key:"offsetBounds",value:function(e){return qs.offsetBounds(this.$comp,e)}},{key:"offset",value:function(){return qs.offset(this.$comp)}},{key:"setLocation",value:function(e){qs.setLocation(this.$comp,e)}},{key:"location",value:function(){return qs.location(this.$comp)}},{key:"setBounds",value:function(e){if(this.isAttachedAndVisible()){var t=this.sizeCached;e.dimension().equals(t)||this.invalidateLayout(),this.pixelBasedSizing&&qs.setBounds(this.$comp,e),this.validateLayout()}}},{key:"pack",value:function(){var e=this.prefSize();this.setSize(e)}},{key:"isAttached",value:function(){return this.$comp.isAttached()&&this.$comp.window(!0)}},{key:"isVisible",value:function(){return this.$comp.isVisible()}},{key:"isAttachedAndVisible",value:function(){return this.isAttached()&&this.isVisible()}},{key:"debug",value:function(){return qs.debugOutput(this.$comp)}}])&&Qs(t.prototype,n),r&&Qs(t,r),e}(),ta={MIN:0,PREF:1,MAX:2,EPS:1e-6};function na(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var ra=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._invalidComponents=[],this._validateTimeoutId=null,this._postValidateFunctions=[]}var t,n,r;return t=e,(n=[{key:"invalidateTree",value:function(e){for(var t,n=e,r=e;n;){if((e=n).invalidateLayout(r),e.isValidateRoot()){t=e;break}n=e.getParent()}n||(t=e),this.invalidate(t)}},{key:"invalidate",value:function(e){var t=0;this._invalidComponents.indexOf(e)>=0||(this._invalidComponents.forEach((function(n,r){n.isDescendantOf(e)||t++}),this),rt.insert(this._invalidComponents,e,t)),this._scheduleValidation()}},{key:"_scheduleValidation",value:function(){var e=this;null===this._validateTimeoutId&&(this._validateTimeoutId=setTimeout((function(){e.validate()})))}},{key:"validate",value:function(){clearTimeout(this._validateTimeoutId),this._validateTimeoutId=null,this._invalidComponents.slice().forEach((function(e){e.validateLayout()&&rt.remove(this._invalidComponents,e)}),this),this._postValidateFunctions.slice().forEach((function(e){e(),rt.remove(this._postValidateFunctions,e)}),this)}},{key:"cleanupInvalidComponents",value:function(e){this._invalidComponents.slice().forEach((function(t){t.$comp.closest(e).length>0&&rt.remove(this._invalidComponents,t)}),this)}},{key:"schedulePostValidateFunction",value:function(e){e&&this._postValidateFunctions.push(e)}}])&&na(t.prototype,n),r&&na(t,r),e}();function oa(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var ia=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),t=t||{},this.dirty=!0,this.gridConfig=t.gridConfig||null,this._setGridConfig(this.gridConfig)}var t,n,r;return t=e,(n=[{key:"setDirty",value:function(e){this.dirty=e}},{key:"setGridConfig",value:function(e){this._setGridConfig(e)}},{key:"_setGridConfig",value:function(e){!e||e instanceof aa||(e=O.create("LogicalGridConfig",e)),this.gridConfig=e}},{key:"validate",value:function(e){this.dirty&&(this._validate(e),this.setDirty(!1))}}])&&oa(t.prototype,n),r&&oa(t,r),e}();function sa(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var aa=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.widget=null}var t,n,r;return t=e,(n=[{key:"setWidget",value:function(e){this.widget=e}},{key:"getGridColumnCount",value:function(){return this.widget.gridColumnCount}},{key:"getGridWidgets",value:function(){return this.widget.widgets}}])&&sa(t.prototype,n),r&&sa(t,r),e}();function la(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var ua=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.gridx=0,this.gridy=0,this.gridw=1,this.gridh=1,this.weightx=0,this.weighty=0,this.useUiWidth=!1,this.useUiHeight=!1,this.widthHint=0,this.heightHint=0,this.horizontalAlignment=-1,this.verticalAlignment=-1,this.fillHorizontal=!0,this.fillVertical=!0,t instanceof e?Pr.copyProperties(t,this):t instanceof ve&&(this.widget=t)}var t,n,r;return t=e,(n=[{key:"validate",value:function(){if(this.widget){var e=this.widget.gridData;this.gridx=e.x,this.gridy=e.y,this.gridw=e.w,this.gridh=e.h,this.weightx=e.weightX,this.weighty=e.weightY,this.weightx<0&&(this.weightx=Math.max(1,this.gridw)),this.weighty<0&&(this.weighty=this._inheritWeightY()),this.useUiWidth=e.useUiWidth,this.useUiHeight=e.useUiHeight,this.horizontalAlignment=e.horizontalAlignment,this.verticalAlignment=e.verticalAlignment,this.fillHorizontal=e.fillHorizontal,this.fillVertical=e.fillVertical,this.widthHint=e.widthInPixel,this.heightHint=e.heightInPixel,this.widget.labelVisible&&this.widget.$label&&this.widget.labelPosition===ZW.LabelPosition.TOP?this.logicalRowHeightAddition=qs.prefSize(this.widget.$label,!0).height:this.logicalRowHeightAddition=0}}},{key:"_inheritWeightY",value:function(){var e=this._inheritWeightYRec(this.widget);if(null===e){var t=this.widget.gridData;e=t.weightY>=0?t.weightY:t.h>=2?t.h:0}return e}},{key:"_inheritWeightYRec",value:function(e){var t=!1,n=0;if(e.validateLogicalGrid(),e instanceof Iz){var r,o,i,s=e.getFields();for(r=0;r<s.length;r++)if((i=s[r]).isVisible()){var a=i.gridData;a.weightY<0?null!==(o=this._inheritWeightYRec(i))&&(t=!0,n+=o):(t=!0,n+=a.weightY)}}else n=e.gridData.h>=2?e.gridData.h:0,t=!0;return t?n:null}},{key:"isValidateRoot",value:function(){return!this.useUiHeight&&!this.useUiWidth&&this.fillVertical&&this.fillHorizontal}}])&&la(t.prototype,n),r&&la(t,r),e}();function ca(e){return(ca="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function fa(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ha(e,t){return(ha=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function pa(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=va(e);if(t){var o=va(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return da(this,n)}}function da(e,t){return!t||"object"!==ca(t)&&"function"!=typeof t?ya(e):t}function ya(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function va(e){return(va=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var ba=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ha(e,t)}(i,e);var t,n,r,o=pa(i);function i(e,t){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(n=o.call(this)).cssClass="logical-grid-layout",n.validityBasedOnContainerSize=new $s,n.valid=!1,n.widget=e,n.info=null,n._initDefaults(),n.layoutConfig=ga.ensure(t||{}),n.layoutConfig.applyToLayout(ya(n)),n.htmlPropertyChangeHandler=n._onHtmlEnvironmentPropertyChange.bind(ya(n)),Xs.get().on("propertyChange",n.htmlPropertyChangeHandler),n.widget.one("remove",(function(){Xs.get().off("propertyChange",n.htmlPropertyChangeHandler)})),n}return t=i,(n=[{key:"_initDefaults",value:function(){var e=Xs.get();this.hgap=e.formColumnGap,this.vgap=e.formRowGap,this.columnWidth=e.formColumnWidth,this.rowHeight=e.formRowHeight,this.minWidth=0}},{key:"_onHtmlEnvironmentPropertyChange",value:function(){this._initDefaults(),this.layoutConfig.applyToLayout(this),this.widget.invalidateLayoutTree(),this.widget.invalidateLogicalGrid()}},{key:"validateLayout",value:function(e,t){var n=this,r=[],o=[];function i(e){this._validateGridData(e)&&(r.push(e.$comp),o.push(e.layoutData))}this.widget.logicalGrid?(this.widget.validateLogicalGrid(),this.widget.logicalGrid.gridConfig.getGridWidgets().forEach((function(e){e.rendered&&(e.htmlComp?i.call(this,e.htmlComp):s.a.log.isWarnEnabled()&&s.a.log.warn("(LogicalGridLayout#validateLayout) no htmlComp found, widget cannot be layouted. Widget: "+e))}),this)):e.children().each((function(e,t){var r=s()(t),o=ea.optGet(r);o&&i.call(n,o)})),this.info=new wa({$components:r,cons:o,hgap:this.hgap,vgap:this.vgap,rowHeight:this.rowHeight,columnWidth:this.columnWidth,widthHint:t.widthHint,heightHint:t.heightHint,widthOnly:t.widthOnly}),s.a.log.isTraceEnabled()&&s.a.log.trace("(LogicalGridLayout#validateLayout) $container="+ea.get(e).debug())}},{key:"_validateGridData",value:function(e){var t=e.$comp,n=t.data("widget");if(n?n.isVisible():t.isVisible())return e.layoutData.validate(),!0}},{key:"layout",value:function(e){this._layout(e)}},{key:"_layout",value:function(e){var t=ea.get(e),n=t.availableSize(),r=t.insets();this.validateLayout(e,{widthHint:n.width-r.horizontal(),heightHint:n.height-r.vertical()}),this.minWidth>0&&n.width<this.minWidth&&(n.width=this.minWidth),s.a.log.isTraceEnabled()&&s.a.log.trace("(LogicalGridLayout#layout) container "+t.debug()+" size="+n+" insets="+r);var o,i,a,l,u,c,f,h,p,d,y=this._layoutCellBounds(n,r);for(c=0;c<this.info.$components.length;c++)u=this.info.$components[c],f=ea.get(u),o=y[(h=this.info.gridDatas[c]).gridy][h.gridx],i=y[h.gridy+h.gridh-1][h.gridx+h.gridw-1],a=o.union(i),d=f.margins(),a.width-=d.horizontal(),a.height-=d.vertical(),h.fillHorizontal&&h.fillVertical||(l=this.info.compSize[c],!h.fillHorizontal&&l.width<a.width&&(p=a.width-l.width,a.width=l.width,0===h.horizontalAlignment?a.x+=Math.ceil(p/2):h.horizontalAlignment>0&&(a.x+=p)),!h.fillVertical&&l.height<a.height&&(p=a.height-l.height,0===h.heightHint?a.height=l.height:a.height=h.heightHint,0===h.verticalAlignment?a.y+=Math.ceil(p/2):h.verticalAlignment>0&&(a.y+=p))),s.a.log.isTraceEnabled()&&s.a.log.trace("(LogicalGridLayout#layout) comp="+f.debug()+" bounds="+a),f.setBounds(a)}},{key:"_layoutCellBounds",value:function(e,t){return this.info.layoutCellBounds(e,t)}},{key:"preferredLayoutSize",value:function(e,t){this.validateLayout(e,t);var n,r,o,i=ta.PREF,s=new $s,a=0;for(n=0;n<this.info.cols;n++)r=this.info.width[n][i],a>0&&(s.width+=this.hgap),s.width+=r,a++;for(a=0,n=0;n<this.info.rows;n++)o=this.info.height[n][i],a>0&&(s.height+=this.vgap),s.height+=o,a++;var l=ea.get(e).insets();return s.width+=l.horizontal(),s.height+=l.vertical(),s}}])&&fa(t.prototype,n),r&&fa(t,r),i}(Zs);function ma(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var ga=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._extend(t)}var t,n,r;return t=e,r=[{key:"ensure",value:function(t){return t?t instanceof e?t:new e(t):t}}],(n=[{key:"_extend",value:function(e){(e=e||{}).hgap>-1&&(this.hgap=e.hgap),e.vgap>-1&&(this.vgap=e.vgap),e.columnWidth>-1&&(this.columnWidth=e.columnWidth),e.rowHeight>-1&&(this.rowHeight=e.rowHeight),e.minWidth>-1&&(this.minWidth=e.minWidth)}},{key:"clone",value:function(){return new e(this)}},{key:"applyToLayout",value:function(e){e.layoutConfig=this,null!==this.hgap&&void 0!==this.hgap&&(e.hgap=this.hgap),null!==this.vgap&&void 0!==this.vgap&&(e.vgap=this.vgap),null!==this.columnWidth&&void 0!==this.columnWidth&&(e.columnWidth=this.columnWidth),null!==this.rowHeight&&void 0!==this.rowHeight&&(e.rowHeight=this.rowHeight),null!==this.minWidth&&void 0!==this.minWidth&&(e.minWidth=this.minWidth)}}])&&ma(t.prototype,n),r&&ma(t,r),e}();function _a(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var wa=function(){function e(t){var n,r,o,i;for(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.gridDatas=[],this.$components=null,this.cols=0,this.compSize=[],this.rows=0,this.width=[],this.widthHints=[],this.height=[],this.weightX=[],this.weightY=[],this.hgap=0,this.vgap=0,this.rowHeight=0,this.columnWidth=0,this.cellBounds=[],this.widthHint=null,this.widthOnly=!1,s.a.extend(this,t),n=0;n<this.cons.length;n++)this.gridDatas[n]=new ua(this.cons[n]);if(0!==this.$components.length){var a=new Po,l=new Po;for(n=0;n<this.gridDatas.length;n++){for((r=this.gridDatas[n]).gridx<0&&(r.gridx=0),r.gridy<0&&(r.gridy=0),r.gridw<1&&(r.gridw=1),r.gridh<1&&(r.gridh=1),o=r.gridx;o<r.gridx+r.gridw;o++)a.add(o);for(i=r.gridy;i<r.gridy+r.gridh;i++)l.add(i)}for(o=a.last();o>=0;o--)if(!a.contains(o))for(n=0;n<this.gridDatas.length;n++)(r=this.gridDatas[n]).gridx>o&&r.gridx--;for(i=l.last();i>=0;i--)if(!l.contains(i))for(n=0;n<this.gridDatas.length;n++)(r=this.gridDatas[n]).gridy>i&&r.gridy--;this.cols=a.size(),this.rows=l.size(),s.a.log.isTraceEnabled()&&s.a.log.trace("(LogicalGridLayoutInfo#CTOR) $components.length="+this.$components.length+" usedCols="+this.cols+" usedRows="+this.rows),this._initializeInfo()}}var t,n,r;return t=e,(n=[{key:"_initializeInfo",value:function(){for(var e=this.$components.length,t=[],n=0;n<e;n++){var r=this.$components[n],o=this.gridDatas[n];o.gridx<0&&(o.gridx=0),o.gridy<0&&(o.gridy=0),o.gridw<1&&(o.gridw=1),o.gridh<1&&(o.gridh=1),o.gridx>=this.cols&&(o.gridx=this.cols-1),o.gridy>=this.rows&&(o.gridy=this.rows-1),o.gridx+o.gridw-1>=this.cols&&(o.gridw=this.cols-o.gridx),o.gridy+o.gridh>=this.rows&&(o.gridh=this.rows-o.gridy);var i=new $s(0,0);o.widthHint>0?i.width=o.widthHint:!o.useUiWidth&&o.fillHorizontal||(i=this.uiSizeInPixel(r,o)),o.heightHint>0?i.height=o.heightHint:!o.useUiHeight&&o.fillVertical||t.push({cons:o,$comp:r,index:n}),this.compSize[n]=i}if(this._initializeColumns(),this.widthOnly)this.height=rt.init(this.rows,[0,0,0]);else{if(this.widthHint&&t.length>0){var s=Math.max(0,(this.cols-1)*this.hgap);this.widthHints=this.layoutSizes(this.widthHint-s,this.width,this.weightX)}t.forEach((function(e){var t=e.$comp,n=e.cons,r=this.widthHintForGridData(n);n.fillHorizontal||(r=Math.min(r,this.compSize[e.index].width)),this.compSize[e.index]=this.uiSizeInPixel(t,n,{widthHint:r})}),this),this._initializeRows()}}},{key:"_initializeColumns",value:function(){var e,t,n,r,o,i=this.compSize,s=i.length,a=rt.init(this.cols,0),l=rt.init(this.cols,!1);for(e=0;e<s;e++)if(1===(o=this.gridDatas[e]).gridw)for(r=o.widthHint>0?o.widthHint:o.useUiWidth?i[e].width:this.logicalWidthInPixel(o),r=Math.floor(r),t=o.gridx;t<o.gridx+o.gridw&&t<this.cols;t++)a[t]=Math.max(a[t],r),0===o.weightx&&(l[t]=!0);for(e=0;e<s;e++)if((o=this.gridDatas[e]).gridw>1){var u=o.gridw,c=0,f=void 0;for(t=o.gridx;t<o.gridx+o.gridw&&t<this.cols;t++)l[t]||(c+=a[t]);if((f=o.widthHint>0?o.widthHint-c-(u-1)*this.hgap:o.useUiWidth?i[e].width-c-(u-1)*this.hgap:this.logicalWidthInPixel(o)-c-(u-1)*this.hgap)>0){var h=Math.floor((f+c)/u),p=(f+c)%u,d=-1;for(t=o.gridx;t<o.gridx+o.gridw&&t<this.cols;t++)d=t,l[t]||(a[t]=Math.max(h,a[t])),0===o.weightx&&(l[t]=!0);d>-1&&(a[d]+=p)}}var y=ta;for(e=0;e<this.cols;e++)this.width[e]=[],l[e]?(this.width[e][y.MIN]=a[e],this.width[e][y.PREF]=a[e],this.width[e][y.MAX]=a[e]):(this.width[e][y.MIN]=0,this.width[e][y.PREF]=a[e],this.width[e][y.MAX]=10240);for(e=0;e<this.cols;e++)if(l[e])this.weightX[e]=0;else{var v=0,b=0;for(n=0;n<s;n++)(o=this.gridDatas[n]).weightx>0&&o.gridx<=e&&e<=o.gridx+o.gridw-1&&(v+=o.weightx/o.gridw,b++);this.weightX[e]=b>0?v/b:0}var m=0;for(e=0;e<this.cols;e++)m+=this.weightX[e];if(m>=1e-6){var g=1/m;for(e=0;e<this.cols;e++)this.weightX[e]=this.weightX[e]*g}}},{key:"_initializeRows",value:function(){var e,t,n,r,o,i=this.compSize,s=i.length,a=rt.init(this.rows,0),l=rt.init(this.rows,!1);for(e=0;e<s;e++)if(1===(o=this.gridDatas[e]).gridh)for(r=o.heightHint>0?o.heightHint:o.useUiHeight?i[e].height:this.logicalHeightInPixel(o),r=Math.floor(r),t=o.gridy;t<o.gridy+o.gridh&&t<this.rows;t++)a[t]=Math.max(a[t],r),0===o.weighty&&(l[t]=!0);for(e=0;e<s;e++)if((o=this.gridDatas[e]).gridh>1){var u=o.gridh,c=0,f=void 0;for(t=o.gridy;t<o.gridy+o.gridh&&t<this.rows;t++)l[t]||(c+=a[t]);if((f=o.heightHint>0?o.heightHint-c-(u-1)*this.vgap:o.useUiHeight?i[e].height-c-(u-1)*this.vgap:this.logicalHeightInPixel(o)-c-(u-1)*this.vgap)>0){var h=Math.floor((f+c)/u),p=(f+c)%u,d=-1;for(t=o.gridy;t<o.gridy+o.gridh&&t<this.rows;t++)d=t,l[t]||(a[t]=Math.max(h,a[t])),0===o.weighty&&(l[t]=!0);d>-1&&(a[d]+=p)}}var y=ta;for(e=0;e<this.rows;e++)this.height[e]=[],l[e]?(this.height[e][y.MIN]=a[e],this.height[e][y.PREF]=a[e],this.height[e][y.MAX]=a[e]):(this.height[e][y.MIN]=0,this.height[e][y.PREF]=a[e],this.height[e][y.MAX]=10240);for(e=0;e<this.rows;e++)if(l[e])this.weightY[e]=0;else{var v=0,b=0;for(n=0;n<s;n++)(o=this.gridDatas[n]).weighty>0&&o.gridy<=e&&e<=o.gridy+o.gridh-1&&(v+=o.weighty/o.gridh,b++);this.weightY[e]=b>0?v/b:0}var m=0;for(e=0;e<this.rows;e++)m+=this.weightY[e];if(m>=1e-6){var g=1/m;for(e=0;e<this.rows;e++)this.weightY[e]=this.weightY[e]*g}}},{key:"layoutCellBounds",value:function(e,t){var n=this.layoutSizes(e.width-t.horizontal()-Math.max(0,(this.cols-1)*this.hgap),this.width,this.weightX),r=this.layoutSizes(e.height-t.vertical()-Math.max(0,(this.rows-1)*this.vgap),this.height,this.weightY);this.cellBounds=rt.init(this.rows,null);var o,i,s,a=t.top;for(o=0;o<this.rows;o++){for(i=t.left,this.cellBounds[o]=rt.init(this.cols,null),s=0;s<this.cols;s++)this.cellBounds[o][s]=new Hs(i,a,n[s],r[o]),i+=n[s],i+=this.hgap;a+=r[o],a+=this.vgap}return this.cellBounds}},{key:"layoutSizes",value:function(e,t,n){var r,o=rt.init(t.length,0);if(e<=0){for(r=0;r<t.length;r++)o[r]=t[r][ta.MIN];return o}var i=0,s=rt.init(n.length,0),a=0;for(r=0;r<t.length;r++)o[r]=t[r][ta.PREF],i+=o[r],s[r]=n[r],s[r]<ta.EPS&&(t[r][ta.MAX]>t[r][ta.MIN]?s[r]=1:s[r]=0),a+=s[r];if(a>0)for(r=0;r<s.length;r++)s[r]=s[r]/a;var l=e-i;if(Math.abs(l)>0){var u,c=rt.init(s.length,0);if(l>0)for(u=!0;l>0&&u;)for(u=!1,r=0;r<o.length&&l>0;r++)s[r]>0&&o[r]<t[r][ta.MAX]&&(u=!0,c[r]+=s[r],c[r]>0&&(c[r]-=1,o[r]+=1,l-=1));else for(u=!0;l<0&&u;)for(u=!1,r=0;r<o.length&&l<0;r++)s[r]>0&&o[r]>t[r][ta.MIN]&&(u=!0,c[r]+=s[r],c[r]>0&&(c[r]-=1,o[r]-=1,l+=1))}return o}},{key:"logicalWidthInPixel",value:function(e){var t=e.gridw;return this.columnWidth*t+this.hgap*Math.max(0,t-1)}},{key:"logicalHeightInPixel",value:function(e){var t=e.gridh,n=e.logicalRowHeightAddition||0;return this.rowHeight*t+this.vgap*Math.max(0,t-1)+n}},{key:"uiSizeInPixel",value:function(e,t,n){var r=ea.get(e);return r.prefSize(n).add(r.margins())}},{key:"widthHintForGridData",value:function(e){if(0===this.widthHints.length)return null;for(var t=(e.gridw-1)*this.hgap,n=e.gridx;n<e.gridx+e.gridw;n++)t+=this.widthHints[n];return t}}])&&_a(t.prototype,n),r&&_a(t,r),e}();function ka(e){return(ka="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Sa(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Oa(e,t){return(Oa=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Ta(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Pa(e);if(t){var o=Pa(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Ca(this,n)}}function Ca(e,t){return!t||"object"!==ka(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Pa(e){return(Pa=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Ra=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Oa(e,t)}(i,e);var t,n,r,o=Ta(i);function i(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(t=o.call(this,e)).gridRows=0,t.gridColumns=0,t}return t=i,r=[{key:"getGridDataFromHints",value:function(e,t){var n=Ez.createFromHints(e,t);return n.w=Math.min(t,n.w),n}}],(n=[{key:"_validate",value:function(e){this.gridRows=0,this.gridConfig.setWidget(e),this.gridColumns=this.gridConfig.getGridColumnCount();var t=0,n=0,r=[];this.gridConfig.getGridWidgets().forEach((function(e){if(e.isVisible()){r.push(e);var o=e.gridDataHints;o&&o.x>=0&&o.y>=0?t++:n++}else{var i=Ez.createFromHints(e,1);e.gridData=i}})),t>0&&0===n?this.layoutAllStatic(r):this.layoutAllDynamic(r)}},{key:"layoutAllStatic",value:function(e){var t=[];e.forEach((function(e){t.push(Ez.createFromHints(e,1))}));var n=t.reduce((function(e,t){var n=t.x+t.w;return n>e?n:e}),1),r=t.reduce((function(e,t){var n=t.y+t.h;return n>e?n:e}),0);e.forEach((function(e){e.gridData=Ez.createFromHints(e,n)})),this.gridRows=r,this.gridColumns=n}},{key:"layoutAllDynamic",value:function(e){}},{key:"getGridColumnCount",value:function(){return this.gridColumns}},{key:"getGridRowCount",value:function(){return this.gridRows}}])&&Sa(t.prototype,n),r&&Sa(t,r),i}(ia);function xa(e){return(xa="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ea(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Da(e,t){return(Da=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Aa(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=$a(e);if(t){var o=$a(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Fa(this,n)}}function Fa(e,t){return!t||"object"!==xa(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function $a(e){return($a=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var ja=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Da(e,t)}(i,e);var t,n,r,o=Aa(i);function i(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),o.call(this,e)}return t=i,(n=[{key:"layoutAllDynamic",value:function(e){var t=new nl(this.getGridColumnCount());t.computeGridData(e),this.gridRows=t.getRowCount()}}])&&Ea(t.prototype,n),r&&Ea(t,r),i}(Ra);function Ba(e){return(Ba="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ma(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Ia(e,t){return(Ia=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function La(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Na(e);if(t){var o=Na(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Ha(this,n)}}function Ha(e,t){return!t||"object"!==Ba(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Na(e){return(Na=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Va=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ia(e,t)}(i,e);var t,n,r,o=La(i);function i(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),o.call(this,e)}return t=i,(n=[{key:"layoutAllDynamic",value:function(e){var t=this,n=0;e.forEach((function(e){var r=Ra.getGridDataFromHints(e,t.getGridColumnCount());n+=r.w*r.h}));for(var r=Math.floor((n+this.getGridColumnCount()-1)/this.getGridColumnCount()),o=new ul(this.getGridColumnCount(),r);!o.computeGridData(e);)o.resetAll(this.getGridColumnCount(),++r);e.forEach((function(e){e.gridData=o.getGridData(e)})),this.gridRows=o.getRowCount()}}])&&Ma(t.prototype,n),r&&Ma(t,r),i}(Ra);function Wa(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var za=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._cursor=t,this._assignedCells=[]}var t,n,r;return t=e,(n=[{key:"getColumnCount",value:function(){return this._cursor.columnCount}},{key:"getRowCount",value:function(){return this._cursor.rowCount}},{key:"_setAssignedCell",value:function(e,t){this._assignedCells[e.x]||(this._assignedCells[e.x]=[]),this._assignedCells[e.x][e.y]=t}},{key:"_getAssignedCell",value:function(e){return this._assignedCells[e.x]?this._assignedCells[e.x][e.y]:null}},{key:"_nextFree",value:function(e,t){if(!this._cursor.increment())return!1;var n=this._cursor.currentIndex();return!!this._isAllCellFree(n.x,n.y,e,t)||(this._getAssignedCell(n)||this._setAssignedCell(n,new Ua),this._nextFree(e,t))}},{key:"_isAllCellFree",value:function(e,t,n,r){return!(e+n>this._cursor.startX+this._cursor.columnCount||t+r>this._cursor.startY+this._cursor.rowCount)&&this._assignedCells.slice(e,e+n).every((function(e){return(e||[]).slice(t,t+r).every((function(e){return!e}))}))}},{key:"toString",value:function(){for(var e="----Group Box Grid Matrix [orientation="+this._cursor.orientation+", columnCount="+this.getColumnCount()+", rowCount="+this.getRowCount()+"]--------------\n",t=new Ya(0,0,this.getColumnCount(),this.getRowCount(),this._cursor.orientation);t.increment();){var n=this._getAssignedCell(t.currentIndex());e+="cell["+t.currentIndex().x+", "+t.currentIndex().y+"] ",n?n.widget?e+=n.widget+(n.widget?", ["+n.widget.label+"]":""):e+="Placeholder":e+="NULL",e+="\n"}return e}}])&&Wa(t.prototype,n),r&&Wa(t,r),e}();function Ga(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Ua=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.widget=t,this.data=n}var t,n,r;return t=e,(n=[{key:"isEmpty",value:function(){return!this.widget}}])&&Ga(t.prototype,n),r&&Ga(t,r),e}();function Ka(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function qa(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Ya=function(){function e(t,n,r,o,i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.startX=t,this.startY=n,this.columnCount=r,this.rowCount=o,this.orientation=i,this.reset()}var t,n,r;return t=e,(n=[{key:"reset",value:function(){this._currentIndex={x:-1,y:-1}}},{key:"currentIndex",value:function(){return{x:this._currentIndex.x,y:this._currentIndex.y}}},{key:"increment",value:function(){return this._currentIndex.x<0||this._currentIndex.y<0?(this._currentIndex.x=this.startX,this._currentIndex.y=this.startY):this.orientation===e.HORIZONTAL?(this._currentIndex.x++,this._currentIndex.x>=this.startX+this.columnCount&&(this._currentIndex.x=this.startX,this._currentIndex.y++)):(this._currentIndex.y++,this._currentIndex.y>=this.startY+this.rowCount&&(this._currentIndex.y=this.startY,this._currentIndex.x++)),!(this._currentIndex.x>=this.startX+this.columnCount||this._currentIndex.y>=this.startY+this.rowCount)}},{key:"decrement",value:function(){return!(this._currentIndex.x<0||this._currentIndex.y<0||(this._currentIndex.x>=this.startX+this.columnCount||this._currentIndex.y>=this.startY+this.rowCount?(this._currentIndex.x=this.startX+this.columnCount-1,this._currentIndex.y=this.startY+this.rowCount-1):this.orientation===e.HORIZONTAL?(this._currentIndex.x--,this._currentIndex.x<this.startX&&(this._currentIndex.x=this.startX+this.columnCount-1,this._currentIndex.y--)):(this._currentIndex.y--,this._currentIndex.y<this.startY&&(this._currentIndex.y=this.startY+this.rowCount-1,this._currentIndex.x--)),this._currentIndex.x<this.startX||this._currentIndex.y<this.startY))}},{key:"toString",value:function(){var e=[];return e.push("MatrixCursor ["),e.push("orientation="+this.orientation),e.push(", startX="+this.startX),e.push(", startY="+this.startY),e.push(", columnCount="+this.columnCount),e.push(", currentIndex="+this._currentIndex.x+", "+this._currentIndex.y),e.push("]"),e.join("")}}])&&Ka(t.prototype,n),r&&Ka(t,r),e}();function Xa(e){return(Xa="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ja(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Za(e,t){return(Za=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Qa(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=tl(e);if(t){var o=tl(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return el(this,n)}}function el(e,t){return!t||"object"!==Xa(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function tl(e){return(tl=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}qa(Ya,"HORIZONTAL",0),qa(Ya,"VERTICAL",1);var nl=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Za(e,t)}(i,e);var t,n,r,o=Qa(i);function i(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(t=o.call(this,new Ya(0,0,e,Number.MAX_SAFE_INTEGER,Ya.HORIZONTAL))).rowCount=0,t}return t=i,(n=[{key:"computeGridData",value:function(e){var t=this;return e.forEach((function(e){var n=Ez.createFromHints(e,t.getColumnCount()),r=new Ez(n);r.w=Math.min(n.w,t.getColumnCount()),t._add(e,n,r),e.gridData=r})),this._cursor.rowCount=this.rowCount,!0}},{key:"_add",value:function(e,t,n){this._nextFree(n.w,n.h);var r=this._cursor.currentIndex();if(n.w<=this.getColumnCount()-r.x){n.x=r.x,n.y=r.y;for(var o=r.x;o<r.x+n.w;o++)for(var i=r.y;i<r.y+n.h;i++)this._setAssignedCell({x:o,y:i},new Ua(e,n));this.rowCount=r.y+n.h}else this._setAssignedCell(this._cursor.currentIndex(),new Ua),this._add(e,t,n)}}])&&Ja(t.prototype,n),r&&Ja(t,r),i}(za);function rl(e){return(rl="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ol(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function il(e,t){return(il=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function sl(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=ll(e);if(t){var o=ll(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return al(this,n)}}function al(e,t){return!t||"object"!==rl(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function ll(e){return(ll=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var ul=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&il(e,t)}(i,e);var t,n,r,o=sl(i);function i(e,t,n,r){var s;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(s=o.call(this,new Ya(n||0,r||0,e,t,Ya.VERTICAL)))._widgets=[],s._widgetGridDatas=[],s}return t=i,(n=[{key:"resetAll",value:function(e,t){this._widgetGridDatas=[],this._assignedCells=[],this._widgetIndexes=[],this._cursor=new Ya(this._cursor.startX,this._cursor.startY,e,t,Ya.VERTICAL)}},{key:"computeGridData",value:function(e){var t=this;return this._widgets=e,e.every((function(e,n){return t._widgetGridDatas[n]=Ra.getGridDataFromHints(e,t._cursor.columnCount),t._add(e,t._widgetGridDatas[n])}))}},{key:"getGridData",value:function(e){return this._widgetGridDatas[this._widgets.indexOf(e)]}},{key:"_addAssignedCells",value:function(e){var t=this;e.forEach((function(e,n){e&&e.forEach((function(e,r){e&&t._setAssignedCell({x:n,y:r},e)}))}))}},{key:"_getAssignedCells",value:function(){return this._assignedCells}},{key:"_add",value:function(e,t){var n=this._cursor.currentIndex();if(t.w>1){for(var r=n.x,o=n.y;r+t.w>this._cursor.startX+this._cursor.columnCount;)r--,o=this._cursor.rowCount-1;this._reorganizeGridAbove(r,o,t.w)}if(!this._nextFree(t.w,t.h))return!1;n=this._cursor.currentIndex(),t.x=n.x,t.y=n.y;for(var i=n.x;i<n.x+t.w;i++)for(var s=n.y;s<n.y+t.h;s++)this._setAssignedCell({x:i,y:s},new Ua(e,t));return!0}},{key:"_reorganizeGridAbove",value:function(e,t,n){for(var r,o=this,s=[],a=[],l=function(e,t,n){a[e]||(a[e]=[]),a[e][t]=n},u={x:e,y:0,w:n,h:t+1},c=t,f=0,h=!0,p=t;p>=0&&h;p--)for(var d=e;d<e+n&&h;d++){var y={x:d,y:p},v=this._getAssignedCell(y);if(v&&!v.isEmpty()){var b=v.data;this._horizontalMatchesOrOverlaps(u,b)?h=!1:this._horizontalOverlapsOnSide(u,b)?(l(y.x,y.y,v),f++,c=Math.min(y.y,c)):(this._setAssignedCell(y,null),r=v.widget,-1===s.indexOf(r)&&s.push(r),f++,c=Math.min(y.y,c))}}if(0!==s.length){s.sort((function(e,t){return o._widgets.indexOf(e)<o._widgets.indexOf(t)?-1:1})),u.y=c;var m=new i(u.w,Math.floor((f+u.w-1)/u.w),u.x,u.y);for(m._addAssignedCells(a);!m.computeGridData(s);)m.resetAll(m.getColumnCount(),m.getRowCount()+1);this._cursor.reset(),this._addAssignedCells(m._getAssignedCells()),m._widgetGridDatas.forEach((function(e,t){o._widgetGridDatas[o._widgets.indexOf(m._widgets[t])]=e}))}}},{key:"_horizontalMatchesOrOverlaps",value:function(e,t){return e.x>=t.x&&e.x+e.w<=t.x+t.w}},{key:"_horizontalOverlapsOnSide",value:function(e,t){return e.x>t.x||e.x+e.w<t.x+t.w}}])&&ol(t.prototype,n),r&&ol(t,r),i}(za);function cl(e){return(cl="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function fl(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function hl(e,t){return(hl=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function pl(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=yl(e);if(t){var o=yl(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return dl(this,n)}}function dl(e,t){return!t||"object"!==cl(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function yl(e){return(yl=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var vl=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&hl(e,t)}(i,e);var t,n,r,o=pl(i);function i(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),e=e||{},(t=o.call(this)).stretch=O.nvl(e.stretch,!0),t.useCssWidth=O.nvl(e.useCssWidth,!1),t}return t=i,(n=[{key:"layout",value:function(e){var t=this,n=ea.get(e),r=n.availableSize().subtract(n.insets());e.children().each((function(e,n){var o=s()(n),i=ea.optGet(o);if(i&&o.isVisible()){var a=i.prefSize({useCssSize:!0});t.stretch&&(a.height=r.height-i.margins().vertical()),i.layoutData&&i.layoutData.widthHint&&(a.width=i.layoutData.widthHint),t.useCssWidth?(i.$comp.cssHeight(a.height),i.revalidateLayout()):i.setSize(a)}}))}},{key:"preferredLayoutSize",value:function(e,t){var n=new $s,r=ea.get(e),o={useCssSize:!0};return e.children().each((function(e,t){var r=s()(t),i=ea.optGet(r);if(i&&r.isVisible()){var a=i.prefSize(o);i.layoutData&&i.layoutData.widthHint&&(a.width=i.layoutData.widthHint),a=a.add(i.margins()),n.width=n.width+a.width,n.height=Math.max(n.height,a.height)}})),n=n.add(r.insets())}}])&&fl(t.prototype,n),r&&fl(t,r),i}(Zs);function bl(e){return(bl="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ml(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function gl(e,t){return(gl=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function _l(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=kl(e);if(t){var o=kl(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return wl(this,n)}}function wl(e,t){return!t||"object"!==bl(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function kl(e){return(kl=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Sl=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&gl(e,t)}(i,e);var t,n,r,o=_l(i);function i(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),o.call(this)}return t=i,(n=[{key:"layout",value:function(e){e.children().each((function(){var e=ea.optGet(s()(this));e&&e.revalidateLayout()}))}}])&&ml(t.prototype,n),r&&ml(t,r),i}(Zs);function Ol(e){return(Ol="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Tl(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Cl(e,t){return(Cl=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Pl(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=xl(e);if(t){var o=xl(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Rl(this,n)}}function Rl(e,t){return!t||"object"!==Ol(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function xl(e){return(xl=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var El=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Cl(e,t)}(i,e);var t,n,r,o=Pl(i);function i(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),e=e||{},(t=o.call(this)).pixelBasedSizing=O.nvl(e.pixelBasedSizing,!0),t.stretch=O.nvl(e.stretch,!0),t}return t=i,(n=[{key:"layout",value:function(e){var t=this,n=ea.get(e),r=n.availableSize().subtract(n.insets());e.children().each((function(e,n){var o=s()(n),i=ea.optGet(o);if(i&&o.isVisible())if(t.pixelBasedSizing){var a=i.prefSize({widthHint:r.width});t.stretch&&(a.width=r.width-i.margins().horizontal()),i.setSize(a)}else i.validateLayout()}))}},{key:"preferredLayoutSize",value:function(e,t){var n=new $s,r=ea.get(e),o=0;return e.children().each((function(e,r){var i=s()(r),a=ea.optGet(i);if(a&&i.isVisible()){var l=a.prefSize(t).add(a.margins());o=Math.max(l.width,o),n.height+=l.height,n.width=o}})),n=n.add(r.insets())}}])&&Tl(t.prototype,n),r&&Tl(t,r),i}(Zs);function Dl(e){return(Dl="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Al(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Fl(e,t){return(Fl=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function $l(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Bl(e);if(t){var o=Bl(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return jl(this,n)}}function jl(e,t){return!t||"object"!==Dl(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Bl(e){return(Bl=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Ml=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Fl(e,t)}(i,e);var t,n,r,o=$l(i);function i(e,t){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(n=o.call(this))._htmlChild=e,t=t||{},n.exact=scout.nvl(t.exact,!1),n}return t=i,(n=[{key:"layout",value:function(e){var t=ea.get(e),n=t.availableSize({exact:this.exact}).subtract(t.insets()),r=this._htmlChild;r||(r=this._getHtmlSingleChild(e)),r&&r.setSize(n)}},{key:"preferredLayoutSize",value:function(e,t){var n=this._htmlChild;return n||(n=this._getHtmlSingleChild(e)),n?n.prefSize(t).add(qs.insets(e)):new $s(1,1)}},{key:"_getHtmlSingleChild",value:function(e){var t=null;return e.children().each((function(e,n){var r=ea.optGet(s()(n));if(r)return t=r,!1})),t}}])&&Al(t.prototype,n),r&&Al(t,r),i}(Zs);function Il(e){return(Il="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ll(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Hl(e,t){return(Hl=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Nl(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Wl(e);if(t){var o=Wl(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Vl(this,n)}}function Vl(e,t){return!t||"object"!==Il(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Wl(e){return(Wl=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var zl=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Hl(e,t)}(i,e);var t,n,r,o=Nl(i);function i(e,t){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(n=o.call(this)).childrenLayoutDatas=[],n.cacheKey=null,n.setCacheKey(t),e===i.Direction.ROW?(n.preferredLayoutSize=n.preferredLayoutSizeRow,n._getDimensionValue=n._getWidth,n._layoutFromLayoutData=n._layoutFromLayoutDataRow):(n.preferredLayoutSize=n.preferredLayoutSizeColumn,n._getDimensionValue=n._getHeight,n._layoutFromLayoutData=n._layoutFromLayoutDataColumn),n}return t=i,(n=[{key:"setCacheKey",value:function(e){this.cacheKey=e,this.cacheKey&&this.cacheKey.length>0&&this.cacheKey.unshift("scout.flexboxLayout")}},{key:"_readCache",value:function(e){if(this.cacheKey&&0!==this.cacheKey.length&&!(e<2)){var t,n=this.cacheKey.slice(),r=Ho.getItemFromLocalStorage(n[0]),o=1;for(n.push(""+e),r&&(t=JSON.parse(r));t&&o<n.length;)t=t[n[o]],o++;return t}}},{key:"_writeCache",value:function(e,t){if(this.cacheKey&&0!==this.cacheKey.length&&!(e<2)){var n,r,o=this.cacheKey.slice(),i=Ho.getItemFromLocalStorage(o[0]),s=1;for(o.push(""+e),r=n=i?JSON.parse(i):{};s<o.length-1;)r[o[s]]||(r[o[s]]={}),r=r[o[s]],s++;r[o[s]]=t,Ho.setItemToLocalStorage(o[0],JSON.stringify(n))}}},{key:"_computeCacheKey",value:function(e){if(this.cacheKey&&!(e<2))return this.cacheKey+"-"+e}},{key:"layout",value:function(e){var t,n=this._getChildren(e),r=ea.get(e),o=r.availableSize({exact:!0});o=o.subtract(r.insets()),(t=n.filter((function(e){return e.layoutData.diff}))[0])?this._layoutDelta(n,t,o):this._layoutComponents(n,o)}},{key:"_getChildren",value:function(e){var t=[];return e.children().each((function(){var e=ea.optGet(s()(this));e&&t.push(e)})),t=t.sort((function(e,t){return(e.layoutData.order||0)-(t.layoutData.order||0)}))}},{key:"reset",value:function(){this.childrenLayoutDatas.forEach((function(e){e.sizePx=0,e.initialPx=0,e.diff=null})),this.childrenLayoutDatas=[]}},{key:"_layoutDelta",value:function(e,t,n){this.ensureInitialValues(e,n);var r,o,i=t.layoutData.diff,s=e.slice(0,e.indexOf(t)).reverse(),a=e.slice(e.indexOf(t)+1);function l(e,t,n){return e.reduce((function(e,t){return 0!==e&&(e=t.layoutData.acceptDelta(e,n)),e}),t)}r=l(s,i,!1),o=-l(a,-i,!1),0!=(i=Math.sign(i)*Math.min(Math.abs(i-r),Math.abs(i-o)))&&(l(s,i,!0),l(a,-i,!0)),this._layoutFromLayoutDataWithCache(e,n)}},{key:"_layoutComponents",value:function(e,t){var n=this.ensureInitialValues(e,t);n<0?this._adjust(e,n,(function(e){return e.shrink})):n>0&&this._adjust(e,n,(function(e){return e.grow})),this._layoutFromLayoutDataWithCache(e,t)}},{key:"_adjust",value:function(e,t,n){var r,o,i=e.map((function(e){return e.layoutData})).filter((function(e){return 0===e.acceptDelta(Math.sign(t))}));i.length<1||(r=i.reduce((function(e,t){return e+n(t)}),0),o=t/r,t=i.reduce((function(e,t){return t.acceptDelta(o*n(t),!0)}),t),Math.abs(t)>.2&&this._adjust(e,t,n))}},{key:"_getPreferredSize",value:function(e){return e.prefSize({useCssSize:!0}).add(e.margins())}},{key:"ensureInitialValues",value:function(e,t){var n=this,r=this._getDimensionValue(t),o=0,i=0,s=e.map((function(e){return e.layoutData})),a=this._readCache(e.length)||[];e.forEach((function(e,t){var r=e.layoutData;r.sizePx?o+=r.sizePx:r.initial<0?(r.initialPx=n._getDimensionValue(n._getPreferredSize(e)),o+=r.initialPx):r.relative?i+=r.initial:(r.initialPx=r.initial,o+=r.initialPx)}));var l=(r-o)/i;return s.filter((function(e){return e.relative&&e.initial>-1&&!e.sizePx})).reduce((function(e,t){return t.initialPx=Math.max(30,l*t.initial),e-t.initialPx}),r-o),s.reduce((function(e,t,o){return t.sizePx||(a[o]?t.sizePx=t.validate(Math.round(r*a[o])):t.sizePx=t.initialPx),n.childrenLayoutDatas.push(t),e-t.sizePx}),r)}},{key:"_layoutFromLayoutDataWithCache",value:function(e,t){this._cacheSizes(e,t),this._layoutFromLayoutData(e,t)}},{key:"_cacheSizes",value:function(e,t){var n,r=this._getDimensionValue(t);n=e.map((function(e){return e.layoutData.sizePx/r})),this._writeCache(e.length,n)}},{key:"preferredLayoutSizeColumn",value:function(e,t){var n=this;return this._getChildren(e).reduce((function(e,t){var r=n._getPreferredSize(t);return e.width=Math.max(r.width,e.width),e.height+=r.height,e}),new $s(0,0))}},{key:"preferredLayoutSizeRow",value:function(e,t){var n=this;return this._getChildren(e).reduce((function(e,t){var r=n._getPreferredSize(t);return e.height=Math.max(r.height,e.height),e.width+=r.width,e}),new $s(0,0))}},{key:"_getWidth",value:function(e){return e.width}},{key:"_getHeight",value:function(e){return e.height}},{key:"_layoutFromLayoutDataRow",value:function(e,t){e.reduce((function(e,n){var r=n.margins(),o=n.insets(),i=n.layoutData.sizePx,s=new Hs(e-o.left-r.left,0,i+o.left+o.right,t.height);return n.setBounds(s),e+i}),0)}},{key:"_layoutFromLayoutDataColumn",value:function(e,t){e.reduce((function(e,n){var r=n.margins(),o=n.insets(),i=n.layoutData.sizePx,s=new Hs(0,e-o.top-r.top,t.width,i+o.top+o.bottom);return n.setBounds(s),e+i}),0)}}])&&Ll(t.prototype,n),r&&Ll(t,r),i}(Zs);function Gl(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}!function(e,t,n){t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}(zl,"Direction",{COLUMN:0,ROW:1});var Ul=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._prepare(),this.relative=!0,this.grow=1,this.shrink=1,this.initial=1,this.order=0,s.a.extend(this,t),this.sizePx,this.initialPx,this.delta}var t,n,r;return t=e,r=[{key:"fixed",value:function(t){var n=new e;return n.relative=!1,n.initial=t||-1,n.grow=0,n.shrink=0,n}}],(n=[{key:"_prepare",value:function(){}},{key:"withOrder",value:function(e){return this.order=e,this}},{key:"acceptDelta",value:function(e,t){return e>0?this._grow(e,t):this._shrink(e,t)}},{key:"validate",value:function(e){return 0===this.grow&&(e=Math.min(this.initialPx,e)),0===this.shrink&&(e=Math.max(this.initialPx,e)),e}},{key:"_grow",value:function(e,t){var n,r=0;return this.grow>0?r=e:this.initialPx>this.sizePx&&(r=this.initialPx-this.sizePx),n=Math.min(e,r),t&&(this.sizePx=this.sizePx+n),e-n}},{key:"_shrink",value:function(e,t){var n,r=0;return this.shrink>0?r=20-this.sizePx:this.initialPx<this.sizePx&&(r=this.initialPx-this.sizePx),n=Math.max(e,r),t&&(this.sizePx=this.sizePx+n),e-n}}])&&Gl(t.prototype,n),r&&Gl(t,r),e}();function Kl(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var ql=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.tabBox=null,this._viewAddHandler=this._onViewAdd.bind(this),this._viewRemoveHandler=this._onViewRemove.bind(this),this._viewActivateHandler=this._onViewActivate.bind(this),this._viewDeactivateHandler=this._onViewDeactivate.bind(this),this.tabArea=null,this._viewTabSelectHandler=this._onViewTabSelect.bind(this)}var t,n,r;return t=e,r=[{key:"hasViewTab",value:function(e){return Pr.someProperties(e,["title","subTitle","iconId"])}}],(n=[{key:"init",value:function(e){s.a.extend(this,e)}},{key:"install",value:function(e,t){this.uninstall(),this.tabBox=O.assertParameter("tabBox",e),this.tabArea=O.assertParameter("tabArea",t||this.tabBox.tabArea),this._installListeners()}},{key:"uninstall",value:function(){this._uninstallListeners()}},{key:"_installListeners",value:function(){this.tabBox.on("viewAdd",this._viewAddHandler),this.tabBox.on("viewRemove",this._viewRemoveHandler),this.tabBox.on("viewActivate",this._viewActivateHandler),this.tabBox.on("viewDeactivate",this._viewDeactivateHandler),this.tabArea.on("tabSelect",this._viewTabSelectHandler)}},{key:"_uninstallListeners",value:function(){this.tabBox&&(this.tabBox.off("viewAdd",this._viewAddHandler),this.tabBox.off("viewRemove",this._viewRemoveHandler),this.tabBox.off("viewActivate",this._viewActivateHandler),this.tabBox.off("viewDeactivate",this._viewDeactivateHandler)),this.tabArea&&this.tabArea.off("tabSelect",this._viewTabSelectHandler)}},{key:"_onViewAdd",value:function(t){var n,r,o=t.view,i=t.siblingView;e.hasViewTab(o)&&!(n=this._getTab(o))&&this._shouldCreateTabForView(o)&&(r=this._getTab(i),n=this._createTab(o),this.tabArea.addTab(n,r))}},{key:"_shouldCreateTabForView",value:function(e){return!0}},{key:"_onViewRemove",value:function(e){var t=e.view;if(t){var n=this._getTab(t);n&&this.tabArea.destroyTab(n)}}},{key:"_onViewActivate",value:function(e){var t=this._getTab(e.view);this.tabArea.selectTab(t)}},{key:"_onViewDeactivate",value:function(e){var t=this._getTab(e.view);this.tabArea.deselectTab(t)}},{key:"_onViewTabSelect",value:function(e){if(e.viewTab){var t=e.viewTab.view;this.tabBox.activateView(t)}}},{key:"_createTab",value:function(e){return O.create("SimpleTab",{parent:this.tabArea,view:e})}},{key:"_getTab",value:function(e){if(e){var t=null;return this.tabArea.getTabs().some((function(n){return n.view===e&&(t=n,!0)})),t}}},{key:"getTabs",value:function(){return this.tabArea.getTabs()}}])&&Kl(t.prototype,n),r&&Kl(t,r),e}();function Yl(e){return(Yl="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Xl(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Jl(e,t,n){return(Jl="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=tu(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function Zl(e,t){return(Zl=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Ql(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=tu(e);if(t){var o=tu(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return eu(this,n)}}function eu(e,t){return!t||"object"!==Yl(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function tu(e){return(tu=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var nu=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Zl(e,t)}(i,e);var t,n,r,o=Ql(i);function i(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(e=o.call(this))._addWidgetProperties(["tabArea"]),e.tabArea=null,e.viewStack=[],e.currentView=null,e.controller=null,e._removeViewInProgress=0,e}return t=i,(n=[{key:"_init",value:function(e){Jl(tu(i.prototype),"_init",this).call(this,e),this.cssClass=e.cssClass,this.tabArea||(this.tabArea=O.create("SimpleTabArea",{parent:this})),this.controller||(this.controller=O.create("SimpleTabBoxController")),this.controller.install(this,this.tabArea),this._viewDestroyedHandler=this._onViewDestroyed.bind(this)}},{key:"_keyStrokeBindTarget",value:function(){return this.$container}},{key:"_render",value:function(){this.$container=this.$parent.appendDiv("simple-tab-box"),this.cssClass&&this.$container.addClass(this.cssClass),this.htmlComp=ea.install(this.$container,this.session),this.htmlComp.setLayout(new uu(this)),this.htmlComp.layoutData=this.layoutData,this.$viewContent=this.$container.appendDiv("tab-content"),this.viewContent=ea.install(this.$viewContent,this.session),this.viewContent.setLayout(new bu(this))}},{key:"_renderProperties",value:function(){Jl(tu(i.prototype),"_renderProperties",this).call(this),this._renderTabArea(),this._renderView(this.currentView)}},{key:"_renderTabArea",value:function(){this.tabArea.render(),this.$tabArea=this.tabArea.$container,this.tabArea.attached&&this.$tabArea.insertBefore(this.$viewContent)}},{key:"_renderView",value:function(e){e&&(e.rendered||(e.render(this.$viewContent),e.$container.addClass("view"),e.validateRoot=!0))}},{key:"postRender",value:function(){this.viewStack.length>0&&!this.currentView&&this.activateView(this.viewStack[this.viewStack.length-1])}},{key:"activateView",value:function(e){e!==this.currentView&&(this.currentView&&(this.currentView.detach(),this.trigger("viewDeactivate",{view:this.currentView}),this.currentView=null),this.rendered&&this._renderView(e),e&&!e.attached&&e.attach(),this.currentView=e,this.trigger("viewActivate",{view:e}),this.revalidateLayout())}},{key:"setLayoutData",value:function(e){Jl(tu(i.prototype),"setLayoutData",this).call(this,e),this.layoutData=e}},{key:"getLayoutData",value:function(){return this.layoutData}},{key:"revalidateLayout",value:function(){this.rendered&&(this.viewContent.invalidateLayoutTree(),this.viewContent.validateLayoutTree())}},{key:"addView",value:function(e,t){var n=O.nvl(t,!0),r=this._addToViewStack(e,n);e.setTrackFocus(!0),e.setParent(this),this.trigger("viewAdd",{view:e,siblingView:r}),n&&this.activateView(e)}},{key:"_addToViewStack",value:function(e,t){var n,r=this.viewStack.indexOf(e);if(r>-1)return this.viewStack[r-1];if(!ql.hasViewTab(e))return this.viewStack.unshift(e),this._addDestroyListener(e),n;if(!this.currentView||!t)return n=this.viewStack[this.viewStack.length-1],this.viewStack.push(e),this._addDestroyListener(e),n;var o=this.viewStack.indexOf(this.currentView);return n=this.viewStack[o],this.viewStack.splice(o+1,0,e),n}},{key:"_addDestroyListener",value:function(e){e.one("destroy",this._viewDestroyedHandler)}},{key:"_removeDestroyListener",value:function(e){e.off("destroy",this._viewDestroyedHandler)}},{key:"_onViewDestroyed",value:function(e){var t=e.source;rt.remove(this.viewStack,t),this.currentView===t&&(this.rendered&&t.remove(),this.currentView=null)}},{key:"removeView",value:function(e,t){if(e){e.setTrackFocus(!1),t=O.nvl(t,!0);var n,r=this.viewStack.indexOf(e);this.currentView===e&&(this.currentView=null),r>-1&&(t&&(r-1>=0?n=this.viewStack[r-1]:r+1<this.viewStack.length&&(n=this.viewStack[r+1])),this.viewStack.splice(r,1),e.rendered&&(this._removeViewInProgress++,e.remove(),this._removeViewInProgress--),this.trigger("viewRemove",{view:e}),0===this._removeViewInProgress&&(n&&this.activateView(n),this.rendered&&(this.viewContent.invalidateLayoutTree(),this.viewContent.validateLayoutTree())))}}},{key:"getController",value:function(){return this.controller}},{key:"viewCount",value:function(){return this.viewStack.length}},{key:"hasViews",value:function(){return this.viewStack.length>0}},{key:"hasView",value:function(e){return this.viewStack.filter((function(t){return t===e})).length>0}},{key:"getViews",value:function(e){return this.viewStack.filter((function(t){return!e||e===t.displayViewId}))}}])&&Xl(t.prototype,n),r&&Xl(t,r),i}(ve);function ru(e){return(ru="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ou(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function iu(e,t){return(iu=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function su(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=lu(e);if(t){var o=lu(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return au(this,n)}}function au(e,t){return!t||"object"!==ru(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function lu(e){return(lu=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var uu=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&iu(e,t)}(i,e);var t,n,r,o=su(i);function i(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(t=o.call(this)).tabBox=e,t}return t=i,(n=[{key:"layout",value:function(e){var t,n,r,o=ea.get(e),i=ea.get(this.tabBox.$viewContent);t=o.availableSize({exact:!0}).subtract(o.insets()),r=this._layoutTabArea(t),(n=t.subtract(i.margins())).height-=r.height,i.setSize(n)}},{key:"_layoutTabArea",value:function(e){if(!this.tabBox.rendered)return new $s(0,0);var t=ea.get(this.tabBox.$tabArea),n=t.prefSize(),r=t.margins(),o=new $s(e.width,n.height+r.top+r.bottom);return t.setSize(o),o}},{key:"preferredLayoutSize",value:function(e,t){t=t||{};var n=ea.get(e),r=ea.get(this.tabBox.$viewContent),o=ea.get(this.tabBox.$tabArea),i=new $s,s=new $s;return t.heightHint=null,o.isVisible()&&(i=o.prefSize().add(o.margins())),s=r.prefSize(t).add(n.insets()).add(r.margins()),new $s(Math.max(i.width,s.width),s.height+i.height)}}])&&ou(t.prototype,n),r&&ou(t,r),i}(Zs);function cu(e){return(cu="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function fu(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function hu(e,t){return(hu=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function pu(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=yu(e);if(t){var o=yu(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return du(this,n)}}function du(e,t){return!t||"object"!==cu(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function yu(e){return(yu=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var vu,bu=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&hu(e,t)}(i,e);var t,n,r,o=pu(i);function i(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(t=o.call(this)).tabBox=e,t}return t=i,(n=[{key:"layout",value:function(e){var t=this.tabBox.currentView;if(t&&t.rendered&&t.htmlComp){var n=ea.get(e),r=n.availableSize({exact:!0}).subtract(n.insets()).subtract(t.htmlComp.margins());t.htmlComp.setSize(r)}}},{key:"preferredLayoutSize",value:function(e){var t=this.tabBox.currentView;if(!t||!t.rendered||!t.htmlComp)return new $s;var n=ea.get(e);return t.htmlComp.prefSize().add(n.insets()).add(t.htmlComp.margins())}}])&&fu(t.prototype,n),r&&fu(t,r),i}(Zs);function mu(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var gu={BACKSPACE:8,TAB:9,ENTER:13,SHIFT:16,CTRL:17,ALT:18,PAUSE:19,CAPS_LOCK:20,ESC:27,ESCAPE:27,PAGE_UP:33,PAGE_DOWN:34,END:35,HOME:36,LEFT:37,UP:38,RIGHT:39,DOWN:40,SPACE:32,PRINT_SCREEN:44,INSERT:45,DELETE:46,0:48,1:49,2:50,3:51,4:52,5:53,6:54,7:55,8:56,9:57,A:65,B:66,C:67,D:68,E:69,F:70,G:71,H:72,I:73,J:74,K:75,L:76,M:77,N:78,O:79,P:80,Q:81,R:82,S:83,T:84,U:85,V:86,W:87,X:88,Y:89,Z:90,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,WIN_LEFT:91,WIN_RIGHT:92,SELECT:93,NUMPAD_0:96,NUMPAD_1:97,NUMPAD_2:98,NUMPAD_3:99,NUMPAD_4:100,NUMPAD_5:101,NUMPAD_6:102,NUMPAD_7:103,NUMPAD_8:104,NUMPAD_9:105,MULTIPLY:106,ADD:107,SUBTRACT:109,DECIMAL_POINT:110,DIVIDE:111,NUM_LOCK:144,SCROLL_LOCK:145,SEMICOLON:186,DASH:189,COMMA:188,POINT:190,FORWARD_SLASH:191,OPEN_BRACKET:219,BACK_SLASH:220,CLOSE_BRACKET:221,SINGLE_QUOTE:222,ANGULAR_BRACKET:226,codesToKeys:{8:"Backspace",9:"Tab",13:"Enter",16:"SHIFT",17:"CTRL",18:"ALT",19:"PAUSE",20:"Caps lock",27:"Esc",33:"Page up",34:"Page down",35:"End",36:"Home",37:"Left",38:"UP",39:"Right",40:"Down",32:"Space",44:"Print screen",45:"Insert",46:"Delete",48:"0",49:"1",50:"2",51:"3",52:"4",53:"5",54:"6",55:"7",56:"8",57:"9",65:"A",66:"B",67:"C",68:"D",69:"E",70:"F",71:"G",72:"H",73:"I",74:"J",75:"K",76:"L",77:"M",78:"N",79:"O",80:"P",81:"Q",82:"R",83:"S",84:"T",85:"U",86:"V",87:"W",88:"X",89:"Y",90:"Z",91:"WIN_LEFT",92:"WIN_RIGHT",93:"SELECT",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",96:"NUMPAD_0",97:"NUMPAD_1",98:"NUMPAD_2",99:"NUMPAD_3",100:"NUMPAD_4",101:"NUMPAD_5",102:"NUMPAD_6",103:"NUMPAD_7",104:"NUMPAD_8",105:"NUMPAD_9",106:"MULTIPLY",107:"+",109:"SUBTRACT",110:"DECIMAL_POINT",111:"/",144:"Num lock",145:"Scroll lock",186:"ü",189:"-",188:",",190:".",191:"§",219:"'",220:"ä",221:"^",222:"ö",226:"<"},browserMap:(vu={},mu(vu,Kt.Browser.FIREFOX,{226:60}),mu(vu,Kt.Browser.SAFARI,{226:188,ctrl:{226:192}}),vu),browserMapReverse:{},forBrowser:function(e,t){return gu.mapKey(gu.browserMap,e,t)},fromBrowser:function(e){return gu.mapKey(gu.browserMapReverse,e)},mapKey:function(e,t,n){var r=e[Kt.get().browser];return r&&n&&(r=r[n]),r&&r.hasOwnProperty(t)?r[t]:t}};for(var _u in gu.browserMap){var wu={},ku=gu.browserMap[_u];for(var Su in ku){wu[ku[Su]]=parseInt(Su,10)}gu.browserMapReverse[_u]=wu}var Ou=gu;function Tu(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Cu=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.keyStroke=t,this.which=n,this.ctrl=t.ctrl,this.alt=t.alt,this.shift=t.shift,this.keyStrokeMode=t.keyStrokeMode}var t,n,r;return t=e,(n=[{key:"render",value:function(e,t){return this.$drawingArea=this.keyStroke.renderKeyBox(e,t),!!this.$drawingArea}},{key:"remove",value:function(){this.keyStroke.removeKeyBox(this.$drawingArea),this.$drawingArea=null}},{key:"toKeyStrokeString",value:function(){var e="";this.ctrl&&(e+="Ctrl-"),this.alt&&(e+="Alt-"),this.shift&&(e+="Shift-");var t=Ou.codesToKeys[this.which];return void 0===t&&(t=this.which),e+=t}}])&&Tu(t.prototype,n),r&&Tu(t,r),e}();function Pu(e,t,n){if(!((n&e)>0))return(t&e)>0}var Ru={ALT:16,ALT_UNDEFINED:32,CTRL:1,CTRL_UNDEFINED:2,NONE:0,SHIFT:4,SHIFT_UNDEFINED:8,isAlt:function(e){return Pu(e,16,32)},isCtrl:function(e){return Pu(e,1,2)},isShift:function(e){return Pu(e,4,8)},toModifierBitMask:function(e){var t=0;return t|=e.ctrlKey?1:0,t|=e.altKey?16:0,t|=e.shiftKey?4:0}};function xu(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Eu=function(){function e(t,n,r,o,i,s){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.which=t,this.ctrlKey=n,this.metaKey=!1,this.altKey=r,this.shiftKey=o,this.target=s,this.type=i,this._propagationStopped=!1,this._immediatePropagationStopped=!1,this._defaultPrevented=!1}var t,n,r;return t=e,(n=[{key:"stopPropagation",value:function(){this._propagationStopped=!0}},{key:"stopImmediatePropagation",value:function(){this._immediatePropagationStopped=!0}},{key:"preventDefault",value:function(){this._defaultPrevented=!0}},{key:"isPropagationStopped",value:function(){return this._propagationStopped}},{key:"isImmediatePropagationStopped",value:function(){return this._immediatePropagationStopped}},{key:"isDefaultPrevented",value:function(){return this._defaultPrevented}},{key:"isAnyPropagationStopped",value:function(){return this._propagationStopped||this._immediatePropagationStopped}}])&&xu(t.prototype,n),r&&xu(t,r),e}();function Du(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Au=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.session=null,this.helpKeyStroke=zu.parseKeyStroke("F1"),this.swallowF1=!0,this._helpRendered=!1,this._renderedKeys=[],this.events=this._createEventSupport(),this.filters=[]}var t,n,r;return t=e,(n=[{key:"init",value:function(e){this.session=e.session,this.installTopLevelKeyStrokeHandlers(this.session.$entryPoint)}},{key:"installTopLevelKeyStrokeHandlers",value:function(e){var t=e.window(!0),n=function(e){return e.which!==Ou.F1},r=function(e){return e.which!==Ou.BACKSPACE};this.swallowF1&&e.keydown(n).keyup(n),e.keydown(r).keyup(r),"onhelp"in t&&(t.onhelp=Eo.returnFalse)}},{key:"installKeyStrokeContext",value:function(e){if(e&&!e._handler){if(!e.$getBindTarget())throw new Error("missing bind-target for KeyStrokeContext: "+e);e._handler=this._onKeyEvent.bind(this,e),e._handler.$target=e.$getBindTarget(),e._handler.$target.on("keydown",e._handler),e._handler.$target.on("keyup",e._handler)}}},{key:"uninstallKeyStrokeContext",value:function(e){e&&e._handler&&(e._handler.$target.off("keydown",e._handler),e._handler.$target.off("keyup",e._handler),e._handler.$target=null,e._handler=null)}},{key:"_renderKeys",value:function(e,t){var n=t.originalEvent.keyStrokeContexts||[],r=[];e.keyStrokes.filter((function(e){var t=e.renderingHints.render;return"function"==typeof t?t.call(e):t})).forEach((function(o){o.enabledByFilter=this._filter(o);var i=(o.field?o.field.$container:null)||e.$getScopeTarget();o.keys().forEach((function(s){var a=new Eu(s.which,s.ctrl,s.alt,s.shift,s.keyStrokeMode,t.target);r.indexOf(s.toKeyStrokeString())<0&&e.accept(a)&&o.accept(a)&&!this._isPreventedByDescendantContext(s,t.target,n)&&(s.render(i,a)&&this._renderedKeys.push(s),a.isImmediatePropagationStopped()&&r.push(s.toKeyStrokeString()))}),this)}),this),n.push(e),t.originalEvent.keyStrokeContexts=n}},{key:"_isPreventedByDescendantContext",value:function(e,t,n){var r=new Eu(e.which,e.ctrl,e.alt,e.shift,e.keyStrokeMode,t);return n.some((function(e){return e.accept(r),!!r.isAnyPropagationStopped()||e.keyStrokes.some((function(e){return e.accept(r),r.isAnyPropagationStopped()}),this)}),this)}},{key:"_handleKeyStrokeEvent",value:function(e,t){e.accept(t)&&(e.keyStrokes.length<1||(t.which>=96&&t.which<=105&&(t.which=t.which-48),e.keyStrokes.slice().some((function(n){return!!n.accept(t)&&(this.invokeAcceptInputOnActiveValueField(n,e)&&Qz.invokeValueFieldAcceptInput(t.target),!this._filter(n)||(this.trigger("keyStroke",{keyStroke:n,keyStrokeContext:e}),n.invokeHandle(t),t.isImmediatePropagationStopped()))}),this)))}},{key:"_filter",value:function(e){for(var t=0;t<this.filters.length;t++)if(!this.filters[t].filter(e))return!1;return!0}},{key:"invokeAcceptInputOnActiveValueField",value:function(e,t){return!e.preventInvokeAcceptInputOnActiveValueField&&(e.invokeAcceptInputOnActiveValueField||t.invokeAcceptInputOnActiveValueField)}},{key:"_isHelpKeyStroke",value:function(e){return zu.acceptEvent(this.helpKeyStroke,e)}},{key:"_installHelpDisposeListener",value:function(e){var t,n=s()(e.currentTarget),r=n.window(),o=n.entryPoint();return t=function(){o.off("keyup",t),r.off("blur",t),this._helpRendered=!1,this._renderedKeys.forEach((function(e){e.remove()})),this._renderedKeys=[]}.bind(this),o.on("keyup",t),r.on("blur",t),!1}},{key:"_onKeyEvent",value:function(e,t){if(this.session.focusManager.isElementCovertByGlassPane(e.$getScopeTarget())){var n=s.a.grep(e.keyStrokes,(function(e){return e.keyStrokeFirePolicy===Up.KeyStrokeFirePolicy.ALWAYS}));if(0===n.length)return;(e=e.clone()).keyStrokes=n}this._isHelpKeyStroke(t)?!t.originalEvent.renderingHelp&&this._helpRendered||(t.originalEvent.renderingHelp=!0,this._helpRendered=!0,this._installHelpDisposeListener(t),this._renderKeys(e,t)):this._handleKeyStrokeEvent(e,t)}},{key:"addFilter",value:function(e){rt.pushSet(this.filters,e)}},{key:"removeFilter",value:function(e){rt.remove(this.filters,e)}},{key:"_createEventSupport",value:function(){return new ln}},{key:"trigger",value:function(e,t){(t=t||{}).source=this,this.events.trigger(e,t)}},{key:"one",value:function(e,t){this.events.one(e,t)}},{key:"on",value:function(e,t){return this.events.on(e,t)}},{key:"off",value:function(e,t){this.events.off(e,t)}},{key:"addListener",value:function(e){this.events.addListener(e)}},{key:"removeListener",value:function(e){this.events.removeListener(e)}}])&&Du(t.prototype,n),r&&Du(t,r),e}();function Fu(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var $u=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.$bindTarget=null,this.$scopeTarget=null,this.keyStrokes=[],this.stopPropagationInterceptors=[],this._stopPropagationKeys={},this.invokeAcceptInputOnActiveValueField=!1,t=t||{},s.a.extend(this,t)}var t,n,r;return t=e,(n=[{key:"registerStopPropagationKeys",value:function(e,t){this._stopPropagationKeys[e]=this._stopPropagationKeys[e]||[],rt.pushAll(this._stopPropagationKeys[e],t)}},{key:"registerStopPropagationInterceptor",value:function(e){this.stopPropagationInterceptors.push(e)}},{key:"accept",value:function(e){return!!this._accept(e)&&(this._applyPropagationFlags(e),!0)}},{key:"_applyPropagationFlags",value:function(e){var t=Ru.toModifierBitMask(e),n=this._stopPropagationKeys[t];n&&O.isOneOf(e.which,n)&&e.stopPropagation(),this.stopPropagationInterceptors.forEach((function(t){t(e)}),this)}},{key:"_accept",value:function(e){return!0}},{key:"registerKeyStroke",value:function(e){this.registerKeyStrokes(e)}},{key:"registerKeyStrokes",value:function(e){rt.ensure(e).map(this._resolveKeyStroke,this).filter((function(e){return-1===this.keyStrokes.indexOf(e)}),this).forEach((function(e){this.keyStrokes.push(e),e.field&&!e.destroyListener&&(e.destroyListener=function(t){this.unregisterKeyStroke(e),e.destroyListener=null}.bind(this),e.field.one("destroy",e.destroyListener))}),this)}},{key:"unregisterKeyStroke",value:function(e){this.unregisterKeyStrokes(e)}},{key:"unregisterKeyStrokes",value:function(e){rt.ensure(e).map(this._resolveKeyStroke,this).forEach((function(e){rt.remove(this.keyStrokes,e)&&e.field&&e.destroyListener&&(e.field.off("destroy",e.destroyListener),e.destroyListener=null)}),this)}},{key:"_resolveKeyStroke",value:function(e){if(e instanceof zu)return e;if(e instanceof Up)return e.actionKeyStroke;throw new Error("unsupported keystroke: "+e)}},{key:"$getBindTarget",value:function(){return"function"==typeof this.$bindTarget?this.$bindTarget():this.$bindTarget}},{key:"$getScopeTarget",value:function(){return"function"==typeof this.$scopeTarget?this.$scopeTarget():this.$scopeTarget}},{key:"clone",value:function(){return new e(Pr.copyOwnProperties(this,{}))}}])&&Fu(t.prototype,n),r&&Fu(t,r),e}();function ju(e){return(ju="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Bu(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Mu(e,t,n){return(Mu="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Nu(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function Iu(e,t){return(Iu=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Lu(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Nu(e);if(t){var o=Nu(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Hu(this,n)}}function Hu(e,t){return!t||"object"!==ju(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Nu(e){return(Nu=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Vu=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Iu(e,t)}(i,e);var t,n,r,o=Lu(i);function i(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(e=o.call(this)).invokeAcceptInputOnActiveValueField=!0,e.registerStopPropagationKeys(Ru.CTRL,[Ou.A,Ou.C,Ou.Y,Ou.V,Ou.Z,Ou.RIGHT,Ou.BACKSPACE,Ou.LEFT,Ou.HOME,Ou.END,Ou.NUMPAD_4,Ou.NUMPAD_6]),e.registerStopPropagationKeys(Ru.CTRL|Ru.SHIFT,[Ou.RIGHT,Ou.BACKSPACE,Ou.LEFT,Ou.HOME,Ou.END,Ou.NUMPAD_4,Ou.NUMPAD_6]),e.registerStopPropagationKeys(Ru.SHIFT,[Ou.RIGHT,Ou.BACKSPACE,Ou.LEFT,Ou.HOME,Ou.END,Ou.NUMPAD_4,Ou.NUMPAD_6]),e.registerStopPropagationKeys(Ru.NONE,[Ou.SEMICOLON,Ou.DASH,Ou.COMMA,Ou.POINT,Ou.FORWARD_SLASH,Ou.OPEN_BRACKET,Ou.BACK_SLASH,Ou.CLOSE_BRACKET,Ou.SINGLE_QUOTE,Ou.MULTIPLY,Ou.ADD,Ou.SUBTRACT,Ou.DECIMAL_POINT,Ou.DIVIDE,Ou.NUMPAD_0,Ou.NUMPAD_1,Ou.NUMPAD_2,Ou.NUMPAD_3,Ou.NUMPAD_4,Ou.NUMPAD_5,Ou.NUMPAD_6,Ou.NUMPAD_7,Ou.NUMPAD_8,Ou.NUMPAD_9,Ou.MULTIPLY,Ou.END,Ou.HOME,Ou.RIGHT,Ou.BACKSPACE,Ou.LEFT,Ou.DELETE,Ou.SPACE]),e}return t=i,(n=[{key:"_applyPropagationFlags",value:function(e){Mu(Nu(i.prototype),"_applyPropagationFlags",this).call(this,e),e.isPropagationStopped()||this._isInputField(e.target)&&(this._isLetterKeyStroke(e)||this._isNumberKeyStroke(e))&&e.stopPropagation()}},{key:"_isInputField",value:function(e){if(e&&e.isContentEditable)return!0;var t=s()(e);return t.is("input:text")||t.is("input:file")||t.is("textarea")}},{key:"_isNumberKeyStroke",value:function(e){return!e.ctrlKey&&e.which>=Ou[0]&&e.which<=Ou[9]}},{key:"_isLetterKeyStroke",value:function(e){return!e.ctrlKey&&e.which>=Ou.A&&e.which<=Ou.Z}}])&&Bu(t.prototype,n),r&&Bu(t,r),i}($u);function Wu(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var zu=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.field=null,this.which=[],this.ctrl=!1,this.alt=!1,this.shift=!1,this.preventDefault=!0,this.stopPropagation=!1,this.stopImmediatePropagation=!1,this.keyStrokeMode=e.Mode.DOWN,this.repeatable=!1,this._handleExecuted=!1,this.keyStrokeFirePolicy=Up.KeyStrokeFirePolicy.ACCESSIBLE_ONLY,this.enabledByFilter=!0,this.renderingHints={render:function(){return!this.field||void 0===this.field.rendered||this.field.rendered}.bind(this),gap:4,offset:4,hAlign:Do.LEFT,text:null,$drawingArea:function(e,t){return e}},this.invokeAcceptInputOnActiveValueField=!1,this.preventInvokeAcceptInputOnActiveValueField=!1}var t,n,r;return t=e,r=[{key:"parseKeyStroke",value:function(e){if(!e)return null;var t={alt:!1,ctrl:!1,shift:!1,which:[]};return e.split("-").forEach((function(e){if("alternate"===e||"alt"===e)t.alt=!0;else if("control"===e||"ctrl"===e)t.ctrl=!0;else if("shift"===e)t.shift=!0;else{var n=Ou[e.toUpperCase()];t.which=n&&[n]}})),t}},{key:"acceptEvent",value:function(t,n){return!!t&&e.acceptModifiers(t,n)&&O.isOneOf(n.which,t.which)}},{key:"acceptModifiers",value:function(t,n){return e._acceptModifier(t.ctrl,n.ctrlKey||n.metaKey)&&e._acceptModifier(t.alt,n.altKey)&&e._acceptModifier(t.shift,n.shiftKey)}},{key:"_acceptModifier",value:function(e,t){return void 0===e||e===t}}],(n=[{key:"parseAndSetKeyStroke",value:function(t){this.alt=!1,this.ctrl=!1,this.shift=!1,this.which=[],t&&s.a.extend(this,e.parseKeyStroke(t))}},{key:"accept",value:function(e){return!!this._isEnabled()&&!!this._accept(e)&&(this._applyPropagationFlags(e),e.type===this.keyStrokeMode)}},{key:"handle",value:function(e){throw new Error("keystroke event not handled: "+e)}},{key:"invokeHandle",value:function(t){if(this.repeatable)this.handle(t);else if(!this._handleExecuted&&(this.handle(t),t.type===e.Mode.DOWN)){this._handleExecuted=!0;var n=s()(t.target).window(),r=this,o={handleEvent:function(e){r._handleExecuted=!1,n[0].removeEventListener("keyup",this,!0)}};n[0].addEventListener("keyup",o,!0)}}},{key:"_isEnabled",value:function(){if(this.field){if(void 0!==this.field.visible&&!this.field.visible)return!1;if(void 0!==this.field.enabled&&!this.field.enabled)return!1}return!0}},{key:"_accept",value:function(t){return e.acceptEvent(this,t)}},{key:"_applyPropagationFlags",value:function(e){this.stopPropagation&&e.stopPropagation(),this.stopImmediatePropagation&&e.stopImmediatePropagation(),this.preventDefault&&e.preventDefault()}},{key:"keys",value:function(){return this.which.map((function(e){return new Cu(this,e)}),this)}},{key:"renderKeyBox",value:function(e,t){if(!(e=this.renderingHints.$drawingArea(e,t))||!e.length)return null;var n=this._renderKeyBox(e,t.which);return this._postRenderKeyBox(e,n),e}},{key:"_renderKeyBox",value:function(e,t){var n=s()(".key-box",e),r=this.renderingHints.text||Ou.codesToKeys[Ou.fromBrowser(t)],o=this.renderingHints.hAlign===Do.RIGHT?"right":"left",i=this.renderingHints.offset;if((n=n.filter((function(){return"right"===o?s()(this).hasClass("right"):!s()(this).hasClass("right")}))).length>0){var a=n.first();i=this.renderingHints.hAlign===Do.RIGHT?e.outerWidth()-a.position().left+this.renderingHints.gap:a.position().left+this.renderingHints.gap+a.outerWidth()}this.shift&&(r="Shift "+r),this.alt&&(r="Alt "+r),this.ctrl&&(r="Ctrl "+r);var l=e.css("position");if("absolute"===l||"relative"===l||"static"===l&&n.length>0)return c.call(this,i);var u=e.position();if(u)return c.call(this,u.left+i);function c(t){return e.prependDiv("key-box",r).css(o,t+"px").toggleClass("disabled",!this.enabledByFilter).addClass(o)}s.a.log.warn("(keys#drawSingleKeyBoxItem) pos is undefined. $parent="+e)}},{key:"_postRenderKeyBox",value:function(e){}},{key:"removeKeyBox",value:function(e){e&&(s()(".key-box",e).remove(),s()(".key-box-additional",e).remove())}}])&&Wu(t.prototype,n),r&&Wu(t,r),e}();function Gu(e){return(Gu="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Uu(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Ku(e,t){return(Ku=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function qu(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Xu(e);if(t){var o=Xu(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Yu(this,n)}}function Yu(e,t){return!t||"object"!==Gu(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Xu(e){return(Xu=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}!function(e,t,n){t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}(zu,"Mode",{UP:"keyup",DOWN:"keydown"});var Ju=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ku(e,t)}(i,e);var t,n,r,o=qu(i);function i(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(e=o.call(this)).ranges=[],e}return t=i,(n=[{key:"registerRange",value:function(e,t){this.ranges.push({from:e,to:t})}},{key:"_accept",value:function(e){return(e.ctrlKey||e.metaKey)===this.ctrl&&e.altKey===this.alt&&e.shiftKey===this.shift&&this.ranges.some((function(t){return e.which>=this._getRangeFrom(t)&&e.which<=this._getRangeTo(t)}),this)}},{key:"keys",value:function(){var e=[];return this.ranges.forEach((function(t){for(var n=this._getRangeFrom(t),r=this._getRangeTo(t),o=n;o<=r;o++)e.push(new Cu(this,o))}),this),e}},{key:"_getRangeFrom",value:function(e){return"function"==typeof e.from?e.from():e.from}},{key:"_getRangeTo",value:function(e){return"function"==typeof e.to?e.to():e.to}}])&&Uu(t.prototype,n),r&&Uu(t,r),i}(zu);function Zu(e){return(Zu="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Qu(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ec(e,t){return(ec=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function tc(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=oc(e);if(t){var o=oc(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return nc(this,n)}}function nc(e,t){return!t||"object"!==Zu(t)&&"function"!=typeof t?rc(e):t}function rc(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function oc(e){return(oc=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var ic=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ec(e,t)}(i,e);var t,n,r,o=tc(i);function i(e,t,n){var r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(r=o.call(this))._contextFunction=t,r._bindObject=n||rc(r),r.field=e,r.renderingHints.render=!1,r.which=[Ou.SELECT],r.ctrl=!1,r.shift=!1,r.stopPropagation=!0,r}return t=i,(n=[{key:"handle",value:function(e){this._contextFunction.call(this._bindObject,e)}}])&&Qu(t.prototype,n),r&&Qu(t,r),i}(zu);function sc(e){return(sc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ac(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function lc(e,t,n){return(lc="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=hc(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function uc(e,t){return(uc=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function cc(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=hc(e);if(t){var o=hc(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return fc(this,n)}}function fc(e,t){return!t||"object"!==sc(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function hc(e){return(hc=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var pc=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&uc(e,t)}(i,e);var t,n,r,o=cc(i);function i(e,t){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(n=o.call(this)).field=e,n.which=t,n.stopPropagation=!0,n.renderingHints.render=!0,n.renderingHints.$drawingArea=function(e,t){return t._$activeElement},n}return t=i,(n=[{key:"_accept",value:function(e){return!!lc(hc(i.prototype),"_accept",this).call(this,e)&&(e._$activeElement=this.field.$container.activeElement(),!0)}},{key:"handle",value:function(e){e._$activeElement.trigger({type:"click",which:1})}}])&&ac(t.prototype,n),r&&ac(t,r),i}(zu);function dc(e){return(dc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function yc(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function vc(e,t){return(vc=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function bc(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=gc(e);if(t){var o=gc(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return mc(this,n)}}function mc(e,t){return!t||"object"!==dc(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function gc(e){return(gc=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var _c=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&vc(e,t)}(i,e);var t,n,r,o=bc(i);function i(e,t){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(n=o.call(this)).session=e,n.field=t,n.which=[Ou.LEFT,Ou.RIGHT],n.renderingHints.render=!1,n.stopPropagation=!0,n.keyStrokeMode=zu.Mode.DOWN,n}return t=i,(n=[{key:"handle",value:function(e){var t=this.field.$container.activeElement(!0),n=this.field.$container.find(":focusable");switch(e.which){case Ou.RIGHT:t===n.last()[0]?this.session.focusManager.requestFocus(n.first()):this.session.focusManager.requestFocus(n[n.index(t)+1]);break;case Ou.LEFT:t===n.first()[0]?this.session.focusManager.requestFocus(n.last()):this.session.focusManager.requestFocus(n[n.index(t)-1])}}}])&&yc(t.prototype,n),r&&yc(t,r),i}(zu);function wc(e){return(wc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function kc(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Sc(e,t){return(Sc=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Oc(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Cc(e);if(t){var o=Cc(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Tc(this,n)}}function Tc(e,t){return!t||"object"!==wc(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Cc(e){return(Cc=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Pc=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Sc(e,t)}(i,e);var t,n,r,o=Oc(i);function i(e,t){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(n=o.call(this)).field=e,n.which=[Ou.ESC],n.renderingHints.render=!0,n.stopPropagation=!0,n.renderingHints={render:!!t,$drawingArea:t},n}return t=i,(n=[{key:"handle",value:function(e){this.field.close()}}])&&kc(t.prototype,n),r&&kc(t,r),i}(zu);function Rc(e){return(Rc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function xc(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Ec(e,t){return(Ec=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Dc(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Fc(e);if(t){var o=Fc(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Ac(this,n)}}function Ac(e,t){return!t||"object"!==Rc(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Fc(e){return(Fc=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var $c=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ec(e,t)}(i,e);var t,n,r,o=Dc(i);function i(e,t){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),o.call(this,e,t)}return t=i,(n=[{key:"handle",value:function(e){this.field.abort()}}])&&xc(t.prototype,n),r&&xc(t,r),i}(Pc);function jc(e){return(jc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Bc(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Mc(e,t){return(Mc=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Ic(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Nc(e);if(t){var o=Nc(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Lc(this,n)}}function Lc(e,t){return!t||"object"!==jc(t)&&"function"!=typeof t?Hc(e):t}function Hc(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Nc(e){return(Nc=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Vc=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Mc(e,t)}(i,e);var t,n,r,o=Ic(i);function i(e,t){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(n=o.call(this)).field=t,n.parseAndSetKeyStroke(e),n.renderingHints.offset=16,n.renderingHints.hAlign=Do.RIGHT,n.renderingHints.$drawingArea=function(e,t){return this.field.$tabContainer}.bind(Hc(n)),n}return t=i,(n=[{key:"handle",value:function(e){this.field.parent.setSelectedTab(this.field)}}])&&Bc(t.prototype,n),r&&Bc(t,r),i}(zu);function Wc(e){return(Wc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function zc(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Gc(e,t,n){return(Gc="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Xc(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function Uc(e,t){return(Uc=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Kc(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Xc(e);if(t){var o=Xc(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return qc(this,n)}}function qc(e,t){return!t||"object"!==Wc(t)&&"function"!=typeof t?Yc(e):t}function Yc(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Xc(e){return(Xc=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Jc=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Uc(e,t)}(i,e);var t,n,r,o=Kc(i);function i(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(e=o.call(this)).comparator=null,e.collapseStyle=null,e.exclusiveExpand=!0,e.groups=[],e.scrollable=!0,e.$container=null,e.htmlComp=null,e._addWidgetProperties(["groups"]),e._groupPropertyChangeHandler=e._onGroupPropertyChange.bind(Yc(e)),e}return t=i,(n=[{key:"_init",value:function(e){Gc(Xc(i.prototype),"_init",this).call(this,e),this._initGroups(this.groups),this._setExclusiveExpand(this.exclusiveExpand)}},{key:"_createLoadingSupport",value:function(){return new oe({widget:this})}},{key:"_render",value:function(){this.$container=this.$parent.appendDiv("accordion"),this.htmlComp=ea.install(this.$container,this.session),this.htmlComp.setLayout(this._createLayout())}},{key:"_createLayout",value:function(){return new pf}},{key:"_renderProperties",value:function(){Gc(Xc(i.prototype),"_renderProperties",this).call(this),this._renderScrollable(),this._renderGroups()}},{key:"insertGroup",value:function(e){this.insertGroups([e])}},{key:"insertGroups",value:function(e){e=rt.ensure(e),this.setGroups(this.groups.concat(e))}},{key:"deleteGroup",value:function(e){this.deleteGroups([e])}},{key:"deleteGroups",value:function(e){e=rt.ensure(e);var t=this.groups.slice();rt.removeAll(t,e),this.setGroups(t)}},{key:"deleteAllGroups",value:function(){this.setGroups([])}},{key:"_initGroups",value:function(e){this.groups.forEach((function(e){this._initGroup(e)}),this)}},{key:"setGroups",value:function(e){if(e=rt.ensure(e),!Pr.equals(this.groups,e)){e=this._createChildren(e);var t=rt.diff(this.groups,e),n=rt.diff(e,this.groups);this._deleteGroups(t),this._insertGroups(n),this._sort(e),this._updateGroupOrder(e),this._setProperty("groups",e),n.length>0&&this._updateExclusiveExpand(),this.rendered&&(this._updateFirstLastMarker(),this.invalidateLayoutTree())}}},{key:"_insertGroups",value:function(e){e.forEach((function(e){this._insertGroup(e)}),this)}},{key:"_insertGroup",value:function(e){this._initGroup(e),this.rendered&&this._renderGroup(e)}},{key:"_initGroup",value:function(e){e.setParent(this),e.on("propertyChange",this._groupPropertyChangeHandler),null!==this.collapseStyle&&e.setCollapseStyle(this.collapseStyle),this.setProperty("collapseStyle",e.collapseStyle)}},{key:"_renderGroup",value:function(e){e.render()}},{key:"_deleteGroups",value:function(e){e.forEach((function(e){this._deleteGroup(e)}),this)}},{key:"_deleteGroup",value:function(e){e.off("propertyChange",this._groupPropertyChangeHandler),e.owner===this?e.destroy():this.rendered&&e.remove()}},{key:"_renderGroups",value:function(){this.groups.forEach((function(e){this._renderGroup(e)}),this),this._updateFirstLastMarker(),this.invalidateLayoutTree()}},{key:"setComparator",value:function(e){this.comparator!==e&&(this.comparator=e)}},{key:"sort",value:function(){var e=this.groups.slice();this._sort(e),this._updateGroupOrder(e),this._setProperty("groups",e)}},{key:"_sort",value:function(e){null!==this.comparator&&e.sort(this.comparator)}},{key:"_updateGroupOrder",value:function(e){if(this.rendered){var t=!1;e.forEach((function(e,n){(this.groups[n]!==e||t)&&(t=!0,e.$container.appendTo(this.$container))}),this)}}},{key:"_updateFirstLastMarker",value:function(){me.updateFirstLastMarker(this.groups)}},{key:"setScrollable",value:function(e){this.setProperty("scrollable",e)}},{key:"_renderScrollable",value:function(){this.scrollable?this._installScrollbars({axis:"y"}):this._uninstallScrollbars(),this.$container.toggleClass("scrollable",this.scrollable),this.invalidateLayoutTree()}},{key:"getFocusableElement",value:function(){var e=me.findFirstFocusableWidget(this.groups,this);return e?e.getFocusableElement():null}},{key:"setExclusiveExpand",value:function(e){this.setProperty("exclusiveExpand",e)}},{key:"_setExclusiveExpand",value:function(e){this._setProperty("exclusiveExpand",e),this._updateExclusiveExpand()}},{key:"_updateExclusiveExpand",value:function(){if(this.exclusiveExpand){var e=rt.find(this.groups,(function(e){return e.visible&&!e.collapsed}));this._collapseOthers(e)}}},{key:"setCollapseStyle",value:function(e){this.groups.forEach((function(t){t.setCollapseStyle(e)})),this.setProperty("collapseStyle",e)}},{key:"_collapseOthers",value:function(e){e&&e.collapsible&&this.groups.forEach((function(t){t!==e&&t.collapsible&&t.setCollapsed(!0)}))}},{key:"_onGroupPropertyChange",value:function(e){"collapsed"===e.propertyName?this._onGroupCollapsedChange(e):"visible"===e.propertyName&&this._updateFirstLastMarker()}},{key:"_onGroupCollapsedChange",value:function(e){!e.newValue&&this.exclusiveExpand&&this._collapseOthers(e.source)}}])&&zc(t.prototype,n),r&&zc(t,r),i}(ve);function Zc(e){return(Zc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Qc(e,t){return(Qc=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function ef(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=nf(e);if(t){var o=nf(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return tf(this,n)}}function tf(e,t){return!t||"object"!==Zc(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function nf(e){return(nf=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var rf=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Qc(e,t)}(n,e);var t=ef(n);function n(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),t.call(this)}return n}(de);function of(e){return(of="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function sf(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function af(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function lf(e,t,n){return(lf="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=hf(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function uf(e,t){return(uf=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function cf(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=hf(e);if(t){var o=hf(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return ff(this,n)}}function ff(e,t){return!t||"object"!==of(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function hf(e){return(hf=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var pf=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&uf(e,t)}(i,e);var t,n,r,o=cf(i);function i(){return sf(this,i),o.apply(this,arguments)}return t=i,(n=[{key:"layout",value:function(e){lf(hf(i.prototype),"layout",this).call(this,e),Lh.update(e,!0)}}])&&af(t.prototype,n),r&&af(t,r),i}(El);function df(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var yf=function(){function e(t,n){if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),!t)throw new Error("Missing $parent");t.addClass("box-buttons"),this._$parent=t,this._onClickHandler=n,this._$buttons=[]}var t,n,r;return t=e,(n=[{key:"addButton",value:function(e){e=e||{};var t=this._$parent.appendDiv().text(e.text).addClass("box-button").unfocusable().setEnabled(O.nvl(e.enabled,!0));if(e.needsClick&&t.addClass("needsclick"),Kt.get().supportsOnlyTouch()||t.attr("tabindex",e.tabIndex||"0"),e.onClick){var n=e.onClick;t.on("click",(function(e){s.a.suppressEventIfDisabled(e)||n(e)}))}else this._onClickHandler&&t.on("click",this._onClick.bind(this));return t.data("buttonOption",e.option),this._$buttons.push(t),t}},{key:"_onClick",value:function(e){var t=s()(e.target);s.a.suppressEventIfDisabled(e,t)||this._onClickHandler(e,t.data("buttonOption"))}},{key:"updateButtonWidths",value:function(e){var t=[];this._$buttons.forEach((function(e){e.isVisible()&&t.push(e)}));var n=t.length>0;this._$parent.toggleClass("empty",!n),e=e||this._$parent.width();var r=Math.floor(e/t.length);t.forEach((function(n,o){o===t.length-1?r=e:e-=r,n.outerWidth(r)}))}},{key:"buttonCount",value:function(){return this._$buttons.length}}])&&df(t.prototype,n),r&&df(t,r),e}();function vf(e){return(vf="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function bf(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function mf(e,t,n){return(mf="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=kf(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function gf(e,t){return(gf=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function _f(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=kf(e);if(t){var o=kf(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return wf(this,n)}}function wf(e,t){return!t||"object"!==vf(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function kf(e){return(kf=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Sf=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&gf(e,t)}(i,e);var t,n,r,o=_f(i);function i(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(e=o.call(this))._addWidgetProperties(["widgets"]),e.statusEnabled=!0,e.statusItemHtml="&bull;",e.currentItem=0,e.moveThreshold=.25,e.widgets=[],e.$carouselFilmstrip,e.$carouselItems=[],e.$carouselStatus,e.$carouselStatusItems=[],e.positionX=0,e}return t=i,(n=[{key:"_init",value:function(e){mf(kf(i.prototype),"_init",this).call(this,e),this._setGridData(this.gridData),this.widgets=rt.ensure(this.widgets)}},{key:"_setGridData",value:function(e){this._setProperty("gridData",new Ez(e))}},{key:"_render",value:function(){this.$container=this.$parent.appendDiv("carousel"),this.htmlComp=ea.install(this.$container,this.session),this.htmlComp.setLayout(new Ef(this)),this.$carouselFilmstrip=this.$container.appendDiv("carousel-filmstrip"),this._registerCarouselFilmstripEventListeners(),this.htmlCompFilmstrip=ea.install(this.$carouselFilmstrip,this.session)}},{key:"_remove",value:function(){this._removeStatus(),mf(kf(i.prototype),"_remove",this).call(this)}},{key:"_renderProperties",value:function(){mf(kf(i.prototype),"_renderProperties",this).call(this),this._renderWidgets(),this._renderCurrentItem(),this._renderStatusEnabled()}},{key:"setStatusEnabled",value:function(e){this.setProperty("statusEnabled",e)}},{key:"_renderStatusEnabled",value:function(){this.statusEnabled?(this._renderStatus(),this._renderStatusItems(),this._renderCurrentStatusItem()):this._removeStatus(),this.invalidateLayoutTree()}},{key:"_renderStatus",value:function(){this.$carouselStatus||(this.$carouselStatus=this.$container.appendDiv("carousel-status"),this.htmlCompStatus=ea.install(this.$carouselStatus,this.session))}},{key:"_removeStatus",value:function(){this.$carouselStatus&&(this.$carouselStatus.remove(),this.$carouselStatus=null)}},{key:"_renderStatusItems",value:function(){var e=this;this.$carouselStatus&&(this.$carouselStatusItems=[],this.$carouselStatus.empty(),this.$carouselItems.forEach((function(){var t=e.$carouselStatus.appendDiv("status-item");t.html(e.statusItemHtml),e.$carouselStatusItems.push(t)})))}},{key:"_renderCurrentStatusItem",value:function(){var e=this;this.$carouselStatus&&this.$carouselStatusItems.forEach((function(t,n){t.toggleClass("current-item",n===e.currentItem)}))}},{key:"recalcTransformation",value:function(){this.positionX=this.currentItem*this.$container.width()*-1,this.$carouselFilmstrip.css({transform:"translateX("+this.positionX+"px)"})}},{key:"setCurrentItem",value:function(e){this.setProperty("currentItem",e)}},{key:"_renderCurrentItem",value:function(){this._renderItemsInternal(void 0,!1),this._renderCurrentStatusItem(),this.invalidateLayoutTree()}},{key:"_renderItemsInternal",value:function(e,t){e=e||this.currentItem,t||this.widgets.forEach((function(t,n){t.rendered&&(n<e-1||n>e+1)&&t.remove()}),this);for(var n=Math.max(e-1,0);n<Math.min(e+2,this.widgets.length);n++){var r=this.widgets[n];r.rendered||(r.render(this.$carouselItems[n]),r.htmlComp.revalidateLayout())}}},{key:"setWidgets",value:function(e){this.setProperty("widgets",e)}},{key:"_renderWidgets",value:function(){this.$carouselFilmstrip.empty(),this.$carouselItems=this.widgets.map((function(e){var t=this.$carouselFilmstrip.appendDiv("carousel-item");return ea.install(t,this.session).setLayout(new Ml),e.cssClassAsArray().forEach((function(e){t.addClass(e+"-carousel-item")})),t}),this),this._renderStatusItems(),this.setCurrentItem(0)}},{key:"_registerCarouselFilmstripEventListeners",value:function(){var e=this,t=this.$carouselFilmstrip.window();this.$carouselFilmstrip.on("mousedown touchstart",(function(n){var r=Nt.pageX(n),o=e.positionX,i=e.$container.width()-e.$carouselFilmstrip.width(),s=e.$container.width();t.on("mousemove.carouselDrag touchmove.carouselDrag",(function(t){var n=Nt.pageX(t),a=o+(n-r);if(a!==e.positionX&&a<=0&&a>=i){e.$carouselFilmstrip.css({transform:"translateX("+a+"px)"}),e.positionX=a;var l=a/s*-1;e._renderItemsInternal(a<o?Math.floor(l):Math.ceil(l),!0)}})),t.on("mouseup.carouselDrag touchend.carouselDrag touchcancel.carouselDrag",(function(n){t.off(".carouselDrag");var r=e.positionX%s,i=e.currentItem;e.positionX<o&&r/s<0-e.moveThreshold?i=Math.ceil(e.positionX/s*-1):e.positionX>o&&r/s>=e.moveThreshold-1&&(i=Math.floor(e.positionX/s*-1)),e.setCurrentItem(i),0!==r&&(e.positionX=i*s*-1,e.recalcTransformation())}))}))}}])&&bf(t.prototype,n),r&&bf(t,r),i}(ve);function Of(e){return(Of="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Tf(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Cf(e,t){return(Cf=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Pf(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=xf(e);if(t){var o=xf(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Rf(this,n)}}function Rf(e,t){return!t||"object"!==Of(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function xf(e){return(xf=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Ef=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Cf(e,t)}(i,e);var t,n,r,o=Pf(i);function i(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(t=o.call(this)).carousel=e,t}return t=i,(n=[{key:"layout",value:function(e){this.carousel.recalcTransformation();var t=this.carousel.htmlComp.availableSize().subtract(this.carousel.htmlComp.insets()).subtract(this.carousel.htmlCompFilmstrip.margins()),n=this.carousel.htmlComp.availableSize().subtract(this.carousel.htmlComp.insets()).subtract(this.carousel.htmlCompFilmstrip.margins());if(this.carousel.statusEnabled&&this.carousel.htmlCompStatus){var r=this.carousel.htmlCompStatus.size().add(this.carousel.htmlCompStatus.margins());t.height-=r.height,n.height-=r.height}var o=this.carousel.$carouselItems;t.width=o.length*t.width,this.carousel.htmlCompFilmstrip.setSize(t),o.forEach((function(e){ea.get(e).setSize(n)}))}},{key:"preferredLayoutSize",value:function(e){var t=this.carousel.currentItem,n=new $s(1,1);return t<this.carousel.$carouselItems.length&&t>=0&&(n=ea.get(this.carousel.$carouselItems[t]).prefSize()),n.height+=this.carousel.htmlCompStatus.size().height,n}}])&&Tf(t.prototype,n),r&&Tf(t,r),i}(Zs);function Df(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Af=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.cssClass=null,this.editable=null,this.errorStatus=null,this.horizontalAlignment=null,this.htmlEnabled=null,this.iconId=null,this.mandatory=null,this._cachedEncodedText=null,this.text=null,this.value=null,this.tooltipText=null,this.sortCode=null}var t,n,r;return t=e,(n=[{key:"init",value:function(e){this._init(e)}},{key:"_init",value:function(e){s.a.extend(this,e)}},{key:"update",value:function(e){this.setText(e.text),s.a.extend(this,e)}},{key:"setEditable",value:function(e){this.editable=e}},{key:"setMandatory",value:function(e){this.mandatory=e}},{key:"setHorizontalAlignment",value:function(e){this.horizontalAlignment=e}},{key:"setValue",value:function(e){this.value=e}},{key:"setErrorStatus",value:function(e){this.errorStatus=e}},{key:"setText",value:function(e){var t=this.text;this.text=e,t!==this.text&&(this._cachedEncodedText=null)}},{key:"setIconId",value:function(e){this.iconId=e}},{key:"encodedText",value:function(){return this._cachedEncodedText||(this._cachedEncodedText=Wn.encode(this.text)),this._cachedEncodedText}},{key:"setCssClass",value:function(e){this.cssClass=e}},{key:"setSortCode",value:function(e){this.sortCode=e}}])&&Df(t.prototype,n),r&&Df(t,r),e}();function Ff(e){return(Ff="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function $f(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function jf(e,t,n){return(jf="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Lf(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function Bf(e,t){return(Bf=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Mf(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Lf(e);if(t){var o=Lf(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return If(this,n)}}function If(e,t){return!t||"object"!==Ff(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Lf(e){return(Lf=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Hf=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Bf(e,t)}(i,e);var t,n,r,o=Mf(i);function i(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(e=o.call(this)).leftVisible=!0,e.rightVisible=!0,e.horizontalAlignment=i.HorizontalAlignment.LEFT,e}return t=i,(n=[{key:"_render",value:function(){this.$container=this.$parent.appendDiv("collapse-handle"),this.$container.on("mousedown",this._onMouseDown.bind(this)),this.$left=this.$container.appendDiv("collapse-handle-body left"),this.$right=this.$container.appendDiv("collapse-handle-body right")}},{key:"_renderProperties",value:function(){jf(Lf(i.prototype),"_renderProperties",this).call(this),this._renderLeftVisible(),this._renderRightVisible(),this._renderHorizontalAlignment()}},{key:"setHorizontalAlignment",value:function(e){this.setProperty("horizontalAlignment",e)}},{key:"_renderHorizontalAlignment",value:function(){this.$container.removeClass("left-aligned right-aligned"),this.horizontalAlignment===i.HorizontalAlignment.LEFT?this.$container.addClass("left-aligned"):this.horizontalAlignment===i.HorizontalAlignment.RIGHT&&this.$container.addClass("right-aligned")}},{key:"setLeftVisible",value:function(e){this.setProperty("leftVisible",e)}},{key:"_renderLeftVisible",value:function(){this.$left.setVisible(this.leftVisible),this._updateVisibilityClasses()}},{key:"setRightVisible",value:function(e){this.setProperty("rightVisible",e)}},{key:"_renderRightVisible",value:function(){this.$right.setVisible(this.rightVisible),this._updateVisibilityClasses()}},{key:"_updateVisibilityClasses",value:function(){var e=this.leftVisible&&this.rightVisible;this.$container.toggleClass("both-visible",e),this.$left.toggleClass("both-visible",e),this.$right.toggleClass("both-visible",e),this.$container.toggleClass("one-visible",(this.leftVisible||this.rightVisible)&&!e)}},{key:"_onLeftMouseDown",value:function(e){this.trigger("action",{left:!0})}},{key:"_onRightMouseDown",value:function(e){this.trigger("action",{right:!0})}},{key:"_onMouseDown",value:function(e){var t=e.target;this.$left.isOrHas(t)?this.trigger("action",{left:!0}):this.$right.isOrHas(t)?this.trigger("action",{right:!0}):this.$container.hasClass("one-visible")&&this.trigger("action",{left:this.leftVisible,right:this.rightVisible})}}])&&$f(t.prototype,n),r&&$f(t,r),i}(ve);function Nf(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}!function(e,t,n){t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}(Hf,"HorizontalAlignment",{LEFT:"left",RIGHT:"right"});var Vf=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e);var n={active:!Kt.get().supportsOnlyTouch(),restrictedFocusGain:!Kt.get().supportsOnlyTouch()};if(s.a.extend(this,n,t),!this.session)throw new Error("Session expected");this._focusContexts=[],this._glassPaneTargets=[],this._glassPaneDisplayParents=[],this._glassPaneRenderers=[];var r=this.session.$entryPoint,o=r.data("partid")||"0";r.attr("tabindex",o),this.restrictedFocusGain&&this.installTopLevelMouseHandlers(r),this.installFocusContext(r,Kf.AUTO)}var t,n,r;return t=e,(n=[{key:"installTopLevelMouseHandlers",value:function(e){var t=this;e.on("mousedown",(function(e){return t._acceptFocusChangeOnMouseDown(s()(e.target))?t._handleIEEvent(e):e.preventDefault(),!0}))}},{key:"_handleIEEvent",value:function(e){if(Kt.get().isInternetExplorer()){var t,n=s()(e.target);if(n.is(".table-cell")||n.closest(".table-cell").length>0)return this.requestFocus(n.closest(".table")),void e.preventDefault();if(n.is(".tree-node")||n.closest(".tree-node").length>0)return this.requestFocus(n.closest(".tree")),void e.preventDefault();var r=n.css("user-select"),o="div:not(.desktop),[tabindex]:not([tabindex=-1]),radio,a[href],area[href],input:not([disabled]),select:not([disabled]),textarea:not([disabled]),button:not([disabled]),iframe";0!==n.not(o).length&&0===n.closest('[contenteditable="true"]').length&&r&&"none"===r&&((t=n.closest(o))&&this.requestFocus(t.get(0)),e.preventDefault())}}},{key:"activate",value:function(e){this.active!==e&&(this.active=e,s.a.log.isDebugEnabled()&&s.a.log.isDebugEnabled()&&s.a.log.debug("Focus manager active: "+this.active),this.active&&this.validateFocus())}},{key:"installFocusContext",value:function(e,t){var n=this.evaluateFocusRule(e,t),r=new zf(e,this);return Kf.PREPARE!==t&&r.ready(),this._pushIfAbsendElseMoveTop(r),n&&r.validateAndSetFocus(n),r}},{key:"evaluateFocusRule",value:function(e,t){return!t||O.isOneOf(t,Kf.AUTO,Kf.PREPARE)?this.findFirstFocusableElement(e):t===Kf.NONE?null:t}},{key:"uninstallFocusContext",value:function(e,t){t=s.a.extend({},{preventScroll:!0},t);var n=this.getFocusContext(e);if(n){var r=Eo.outsideFilter(n.$container);rt.remove(this._focusContexts,n),n.dispose();var o=this._findActiveContext();o&&o.validateAndSetFocus(o.lastValidFocusedElement,r,t)}}},{key:"isFocusContextInstalled",value:function(e){return!!this.getFocusContext(e)}},{key:"activateFocusContext",value:function(e){var t=e;e instanceof zf||(t=this.getFocusContext(e)),t&&!this.isElementCovertByGlassPane(t.$container)&&(this._pushIfAbsendElseMoveTop(t),this.validateFocus())}},{key:"isElementCovertByGlassPane",value:function(e,t){var n=this._glassPaneTargets;return t&&(n=this._glassPaneTargets.filter(t)),!!n.length&&(this._glassPaneDisplayParents.indexOf(O.widget(e))>=0||n.some((function(t){return 0!==s()(e).closest(t).length})))}},{key:"registerGlassPaneTarget",value:function(e){this._glassPaneTargets.push(e),this.validateFocus()}},{key:"registerGlassPaneDisplayParent",value:function(e){this._glassPaneDisplayParents.push(e)}},{key:"registerGlassPaneRenderer",value:function(e){this._glassPaneRenderers.push(e)}},{key:"unregisterGlassPaneTarget",value:function(e){rt.$remove(this._glassPaneTargets,e),this.validateFocus()}},{key:"unregisterGlassPaneDisplayParent",value:function(e){rt.remove(this._glassPaneDisplayParents,e)}},{key:"unregisterGlassPaneRenderer",value:function(e){rt.remove(this._glassPaneRenderers,e)}},{key:"rerenderGlassPanes",value:function(){this._glassPaneRenderers.slice().forEach((function(e){e.removeGlassPanes(),e.renderGlassPanes()}))}},{key:"validateFocus",value:function(e){var t=this._findActiveContext();t&&t.validateFocus(e)}},{key:"requestFocusIfReady",value:function(e,t){return this.requestFocus(e,t,!0)}},{key:"requestFocus",value:function(e,t,n){if(!(e=e instanceof s.a?e[0]:e))return!1;var r=this._findFocusContextFor(e);if(r){if(n&&!r.prepared)return!1;r.validateAndSetFocus(e,t)}return Uf.isActiveElement(e)}},{key:"findFirstFocusableElement",value:function(e,t){var n,r,o,i,a,l,u,c,f,h=e.entryPoint(),p=e.find(":focusable").addBack(":focusable").not(h).filter(t||Eo.returnTrue);for(i=0;i<p.length;i++)if(a=p[i],l=s()(a),!this.isElementCovertByGlassPane(a)&&!(l.is(".prevent-initial-focus")||l.closest(".prevent-initial-focus").length>0))if(n||l.hasClass("button")||l.hasClass("menu-item")||(n=a),!r&&l.is(".default-menu")&&(r=a),u=l.parents(".menubar"),c=l.parents(".tab-box-header"),f=l.parents(".box-buttons"),(u.length>0||c.length>0||f.length>0)&&!o&&(l.hasClass("button")||l.hasClass("menu-item")))o=a;else if(!u.length&&!c.length&&!f.length&&"function"==typeof a.focus)return a;if(r)return r;if(o){if(o!==n&&n){var d=s()(o).parents(".tab-box-header"),y=s()(n);if(s()(n).parents(".tab-box-header").length>0&&d.length>0&&y.is(".tab-item"))return n}return o}return n}},{key:"_findActiveContext",value:function(){return rt.last(this._focusContexts)}},{key:"getFocusContext",value:function(e){return rt.find(this._focusContexts,(function(t){return t.$container===e}))}},{key:"_findFocusContextFor",value:function(e){e=s.a.ensure(e);var t=null,n=Number.MAX_VALUE;return this._focusContexts.forEach((function(r){r.$container.isOrHas(e)&&e.parentsUntil(r.$container).length<n&&(t=r)})),t}},{key:"_acceptFocusChangeOnMouseDown",value:function(e){return!(e.hasClass("glasspane")||this.isElementCovertByGlassPane(e)||!Uf.isFocusableByMouse(e)||!e.is(":focusable")&&!Uf.isSelectableText(e)&&!Uf.containsParentFocusableByMouse(e,e.entryPoint()))}},{key:"_pushIfAbsendElseMoveTop",value:function(e){rt.remove(this._focusContexts,e),this._focusContexts.push(e)}}])&&Nf(t.prototype,n),r&&Nf(t,r),e}();function Wf(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var zf=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.$container=t,this.focusManager=n,this.lastValidFocusedElement=null,this.focusedElement=null,this.prepared=!1,this._keyDownListener=this._onKeyDown.bind(this),this._focusInListener=this._onFocusIn.bind(this),this._focusOutListener=this._onFocusOut.bind(this),this._unfocusableListener=this._onUnfocusable.bind(this),this._removeListener=this._onRemove.bind(this)}var t,n,r;return t=e,(n=[{key:"ready",value:function(){this.prepared||(this.$container.on("keydown",this._keyDownListener).on("focusin",this._focusInListener).on("focusout",this._focusOutListener).on("hide disable",this._unfocusableListener),this.prepared=!0,this.lastValidFocusedElement&&this.restoreFocus())}},{key:"dispose",value:function(){this.prepared&&(this.$container.off("keydown",this._keyDownListener).off("focusin",this._focusInListener).off("focusout",this._focusOutListener).off("hide disable",this._unfocusableListener),s()(this.focusedElement).off("remove",this._removeListener))}},{key:"_onKeyDown",value:function(e){if(e.which===Ou.TAB){var t,n=this.$container.activeElement(!0),r=this.$container.find(":tabbable:visible"),o=r.first()[0],i=r.last()[0],a=r.index(n);if(e.shiftKey?!i||n!==o&&n!==this.$container[0]?a>0&&(t=r.get(a-1)):(s.a.suppressEvent(e),this.validateAndSetFocus(i),t=i):!o||n!==i&&n!==this.$container[0]?a<r.length-1&&(t=r.get(a+1)):(s.a.suppressEvent(e),this.validateAndSetFocus(o),t=o),!t)return;var l=s()(t),u=qs.offsetBounds(l),c=l.scrollParent();Lh.isLocationInView(new Is(u.x,u.y),c)||Lh.scrollTo(c,l)}}},{key:"_onFocusIn",value:function(e){s()(e.target).on("remove",this._removeListener),this.focusedElement=e.target,e.target!==this.$container.entryPoint(!0)&&(this.focusManager._pushIfAbsendElseMoveTop(this),this.validateAndSetFocus(e.target),e.stopPropagation())}},{key:"_onFocusOut",value:function(e){s()(e.target).off("remove",this._removeListener),this.focusedElement=null,e.stopPropagation()}},{key:"_onRemove",value:function(e){this.validateAndSetFocus(null,Eo.notSameFilter(e.target)),e.stopPropagation()}},{key:"_onUnfocusable",value:function(e){s()(e.target).isOrHas(this.lastValidFocusedElement)&&(this.validateAndSetFocus(null,Eo.notSameFilter(e.target)),e.stopPropagation())}},{key:"validateAndSetFocus",value:function(e,t,n){e&&!s.a.contains(this.$container[0],e)&&(e=null);var r=null;r=!e||t&&!t.call(e)?this.focusManager.findFirstFocusableElement(this.$container,t):e,this.lastValidFocusedElement=r,this._focus(r,n)}},{key:"validateFocus",value:function(e){this.validateAndSetFocus(this.lastValidFocusedElement,e)}},{key:"restoreFocus",value:function(){this.lastValidFocusedElement&&this._focus(this.lastValidFocusedElement)}},{key:"_focus",value:function(e,t){if(t=t||{},this.focusManager.active&&this.prepared){if(this.focusManager.isElementCovertByGlassPane(e)){var n=this.$container.activeElement(!0);if(e&&(!n||!this.focusManager.isElementCovertByGlassPane(n)))return!1;e=null}(e=e||this.$container.entryPoint(!0)).focus||(e=this.$container.entryPoint(!0)),Uf.isActiveElement(e)||(e.focus({preventScroll:scout.nvl(t.preventScroll,!1)}),s.a.log.isDebugEnabled()&&s.a.log.debug("Focus set to "+qs.debugOutput(e)))}}}])&&Wf(t.prototype,n),r&&Wf(t,r),e}();function Gf(e){var t=s()(e);return!t.hasClass("unfocusable")&&!t.closest(".unfocusable").length}var Uf={containsParentFocusableByMouse:function(e,t){return s()(e).parents(":focusable").not(t).filter((function(){return Gf(this)})).length>0},isActiveElement:function(e){return!!e&&(e instanceof s.a?(t=e.activeElement(!0),e=e[0]):t=(e instanceof Document?e:e.ownerDocument).activeElement,t===e);var t},isFocusableByMouse:Gf,isSelectableText:function(e){for(var t=s()(e),n=t;"auto"===n.css("user-select");)if((n=n.parent()).is("body"))return!1;return"none"!==n.css("user-select")&&(!!t.is("input[disabled][type=text], textarea[disabled]")||t.text().trim().length>0)}},Kf={AUTO:"auto",NONE:"none",PREPARE:"prepare"};function qf(e){return(qf="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Yf(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Xf(e,t,n){return(Xf="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=eh(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function Jf(e,t){return(Jf=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Zf(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=eh(e);if(t){var o=eh(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Qf(this,n)}}function Qf(e,t){return!t||"object"!==qf(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function eh(e){return(eh=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var th=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Jf(e,t)}(i,e);var t,n,r,o=Zf(i);function i(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),o.call(this)}return t=i,(n=[{key:"_render",value:function(){this.$container=this.$parent.appendDiv("glasspane").on("mousedown",this._onMouseDown.bind(this)),Kt.get().supportsOnlyTouch()&&this.$container.addClass("needsclick"),this.$parent.addClass("glasspane-parent");var e=this.$parent.css("position");O.isOneOf(e,"relative","absolute")||this.$parent.css("position","relative"),this.session.focusManager.registerGlassPaneTarget(this.$parent)}},{key:"_remove",value:function(){this.$parent.removeClass("glasspane-parent"),this.session.focusManager.unregisterGlassPaneTarget(this.$parent),Xf(eh(i.prototype),"_remove",this).call(this)}},{key:"_onMouseDown",value:function(e){s.a.suppressEvent(e)}}])&&Yf(t.prototype,n),r&&Yf(t,r),i}(ve);function nh(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var rh=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.$glassPaneTargets,this.glassPaneRenderer}var t,n,r;return t=e,r=[{key:"createFor",value:function(t,n){if(t.rendered)throw new Error("Don't call this function if widget is already rendered.");var r=new e,o=function(e){var t=n();r.ready(t)};return t.one("render",o),t.one("destroy",(function(){t.off("render",o)})),[r]}}],(n=[{key:"ready",value:function(e){this.$glassPaneTargets=e,this.renderWhenReady()}},{key:"rendererReady",value:function(e){this.glassPaneRenderer=e,this.renderWhenReady()}},{key:"removeGlassPaneRenderer",value:function(e){this.glassPaneRenderer===e&&(this.glassPaneRenderer=null)}},{key:"renderWhenReady",value:function(){var e=this;this.glassPaneRenderer&&this.$glassPaneTargets&&this.$glassPaneTargets.length>0&&this.$glassPaneTargets.forEach((function(t){e.glassPaneRenderer.renderGlassPane(t)}))}}])&&nh(t.prototype,n),r&&nh(t,r),e}();function oh(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var ih=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._widget=t,this.session=t.session,this._enabled=O.nvl(n,!0),this._$glassPanes=[],this._deferredGlassPanes=[],this._resolvedDisplayParent=null,this._registeredDisplayParent=null,this._displayParentRenderHandler=this._onDisplayParentRender.bind(this),this._glassPaneRemoveHandler=this._onGlassPaneRemove.bind(this),this._glassPaneRendererRegistered=!1}var t,n,r;return t=e,(n=[{key:"renderGlassPanes",value:function(){this.findGlassPaneTargets().forEach((function(e){e instanceof rh?(e.rendererReady(this),this._deferredGlassPanes.push(e)):this.renderGlassPane(e)}),this),this._glassPaneRendererRegistered||(this.session.focusManager.registerGlassPaneRenderer(this),this._glassPaneRendererRegistered=!0)}},{key:"renderGlassPane",value:function(e){if(!(e=s.a.ensure(e),this._widget.$container&&this._widget.$container[0]===e[0]||this._$glassPanes.some((function(t){return t.parent()[0]===e[0]})))){var t=e.appendDiv("glasspane").on("mousedown",this._onMouseDown.bind(this));this._adjustGlassPaneSize(t,e),Kt.get().supportsOnlyTouch()&&t.addClass("needsclick"),t.window(!0).popupWindow&&t.addClass("dark"),this._$glassPanes.push(t),this.session.focusManager.registerGlassPaneTarget(e),t.one("remove",this._glassPaneRemoveHandler),this._registerDisplayParent()}}},{key:"_adjustGlassPaneSize",value:function(e,t){var n=-t.cssBorderTopWidth(),r=-t.cssBorderBottomWidth(),o=-t.cssBorderLeftWidth(),i=-t.cssBorderRightWidth();t.children().each((function(e,t){var a=s()(t);n=Math.min(n,(a.cssTop()||0)+(a.cssMarginTop()||0)),r=Math.min(r,(a.cssBottom()||0)+(a.cssMarginBottom()||0)),o=Math.min(o,(a.cssLeft()||0)+(a.cssMarginLeft()||0)),i=Math.min(i,(a.cssRight()||0)+(a.cssMarginRight()||0))})),e.cssTop(n).cssBottom(r).cssLeft(o).cssRight(i)}},{key:"removeGlassPanes",value:function(){this._$glassPanes.slice().forEach((function(e){this._removeGlassPane(e)}),this),this._deferredGlassPanes.forEach((function(e){e.removeGlassPaneRenderer(this)}),this),this._deferredGlassPanes=[],this._unregisterDisplayParent(),this.session.focusManager.unregisterGlassPaneRenderer(this),this._glassPaneRendererRegistered=!1}},{key:"_removeGlassPane",value:function(e){var t=e.parent();e.off("remove",this._glassPaneRemoveHandler),e.remove(),rt.$remove(this._$glassPanes,e),t.removeClass("no-hover"),this.session.focusManager.unregisterGlassPaneTarget(t)}},{key:"eachGlassPane",value:function(e){this._$glassPanes.forEach((function(t){e(t)}))}},{key:"findGlassPaneTargets",value:function(){if(!this._enabled)return[];var e=this._resolveDisplayParent();return e&&e.glassPaneTargets?e.glassPaneTargets(this._widget):[]}},{key:"_resolveDisplayParent",value:function(){return this._resolvedDisplayParent||(this._resolvedDisplayParent=this._widget.displayParent||this.session.desktop),this._resolvedDisplayParent}},{key:"_registerDisplayParent",value:function(){this._resolvedDisplayParent||this._resolveDisplayParent(),this._resolvedDisplayParent&&(this._registeredDisplayParent||(this.session.focusManager.registerGlassPaneDisplayParent(this._resolvedDisplayParent),this._registeredDisplayParent=this._resolvedDisplayParent,this._registeredDisplayParent.on("render",this._displayParentRenderHandler)))}},{key:"_unregisterDisplayParent",value:function(){this._registeredDisplayParent&&(this.session.focusManager.unregisterGlassPaneDisplayParent(this._registeredDisplayParent),this._registeredDisplayParent.off("render",this._displayParentRenderHandler),this._registeredDisplayParent=null)}},{key:"_onMouseDown",value:function(e){var t=null,n=this._resolveDisplayParent();if(n._onGlassPaneMouseDown&&n._onGlassPaneMouseDown(this._widget,s()(e.target)),this._widget instanceof CC&&this._widget.isView()){var r=this.session.desktop.bench.getViewTab(this._widget);r&&((t=r.$container).isVisible()||(t=t.siblings(".overflow-tab-item")))}else this._widget.$container&&(t=this._widget.$container);if(t){var o=this._widget.$container.children(".glasspane");o.length?o.trigger("mousedown"):t.addClassForAnimation("animate-modality-highlight",{classesToRemove:"animate-modality-highlight animate-open"})}s.a.suppressEvent(e)}},{key:"_onDisplayParentRender",value:function(e){this.renderGlassPanes()}},{key:"_onGlassPaneRemove",value:function(e){var t=s()(e.target);this._removeGlassPane(t)}}])&&oh(t.prototype,n),r&&oh(t,r),e}();function sh(e){return(sh="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ah(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function lh(e,t,n){return(lh="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=ph(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function uh(e,t){return(uh=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function ch(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=ph(e);if(t){var o=ph(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return fh(this,n)}}function fh(e,t){return!t||"object"!==sh(t)&&"function"!=typeof t?hh(e):t}function hh(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ph(e){return(ph=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var dh=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&uh(e,t)}(i,e);var t,n,r,o=ch(i);function i(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(e=o.call(this)).location=null,e.sandboxEnabled=!0,e.sandboxPermissions=null,e.scrollBarEnabled=!0,e.trackLocation=!1,e.wrapIframe=Kt.get().isIosPlatform(),e.$iframe=null,e._loadHandler=e._onLoad.bind(hh(e)),e}return t=i,(n=[{key:"_render",value:function(){var e="iframe "+Kt.get().cssClassForIphone();this.wrapIframe?(this.$container=this.$parent.appendDiv("iframe-wrapper"),this.$iframe=this.$container.appendElement("<iframe>",e)):(this.$iframe=this.$parent.appendElement("<iframe>",e),this.$container=this.$iframe),this.htmlComp=ea.install(this.$container,this.session)}},{key:"_renderProperties",value:function(){lh(ph(i.prototype),"_renderProperties",this).call(this),this._renderScrollBarEnabled(),this._renderSandboxEnabled(),this._renderLocation(),this._renderTrackLocation()}},{key:"setLocation",value:function(e){this.setProperty("location",e)}},{key:"_renderLocation",value:function(){var e=this.location||"about:blank";this.$iframe.attr("src",e)}},{key:"setTrackLocation",value:function(e){this.setProperty("trackLocation",e)}},{key:"_renderTrackLocation",value:function(e){this.trackLocation?this.$iframe.on("load",this._loadHandler):this.$iframe.off("load",this._loadHandler)}},{key:"_onLoad",value:function(e){if(this.rendered&&this.trackLocation){var t=this.$iframe[0].contentDocument;if(!t)return;var n=t.location.href;"about:blank"===n&&(n=null),this._setProperty("location",n)}}},{key:"setScrollBarEnabled",value:function(e){this.setProperty("scrollBarEnabled",e)}},{key:"_renderScrollBarEnabled",value:function(){this.$container.toggleClass("no-scrolling",!this.scrollBarEnabled),this.$iframe.attr("scrolling",this.scrollBarEnabled?"yes":"no"),this.rendered&&this._renderLocation()}},{key:"setSandboxEnabled",value:function(e){this.setProperty("sandboxEnabled",e)}},{key:"_renderSandboxEnabled",value:function(){this.sandboxEnabled?this._renderSandboxPermissions():(this.$iframe.removeAttr("sandbox"),this.$iframe.removeAttr("security")),this.rendered&&this._renderLocation()}},{key:"setSandboxPermissions",value:function(e){this.setProperty("sandboxPermissions",e)}},{key:"_renderSandboxPermissions",value:function(){this.sandboxEnabled&&(this.$iframe.attr("sandbox",O.nvl(this.sandboxPermissions,"")),this.rendered&&this._renderLocation())}}])&&ah(t.prototype,n),r&&ah(t,r),i}(ve);function yh(e){return(yh="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function vh(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function bh(e,t,n){return(bh="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=kh(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function mh(e,t){return(mh=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function gh(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=kh(e);if(t){var o=kh(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return _h(this,n)}}function _h(e,t){return!t||"object"!==yh(t)&&"function"!=typeof t?wh(e):t}function wh(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function kh(e){return(kh=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Sh=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&mh(e,t)}(i,e);var t,n,r,o=gh(i);function i(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(e=o.call(this)).$container=null,e.$thumb=null,e.$thumbHandle=null,e.axis="y",e.borderless=!1,e.mouseWheelNeedsShift=!1,e._scrollSize=null,e._offsetSize=null,e._dim="Height",e._dir="top",e._dirReverse="bottom",e._scrollDir="scrollTop",e._thumbClipping=new Bs(0,0,0,0),e._onScrollHandler=e._onScroll.bind(wh(e)),e._onScrollWheelHandler=e._onScrollWheel.bind(wh(e)),e._onScrollbarMouseDownHandler=e._onScrollbarMouseDown.bind(wh(e)),e._onTouchStartHandler=e._onTouchStart.bind(wh(e)),e._onThumbMouseDownHandler=e._onThumbMouseDown.bind(wh(e)),e._onDocumentMousemoveHandler=e._onDocumentMousemove.bind(wh(e)),e._onDocumentMouseUpHandler=e._onDocumentMouseUp.bind(wh(e)),e._onAncestorScrollOrResizeHandler=e.update.bind(wh(e)),e._fixScrollbarHandler=e._fixScrollbar.bind(wh(e)),e._unfixScrollbarHandler=e._unfixScrollbar.bind(wh(e)),e}return t=i,(n=[{key:"_render",value:function(){var e=this;this._ensureParentPosition(),this.$container=this.$parent.appendDiv("scrollbar").addClass(this.axis+"-axis"),this._$thumb=this.$container.appendDiv("scrollbar-thumb").addClass(this.axis+"-axis"),this._$thumbHandle=this._$thumb.appendDiv("scrollbar-thumb-handle").addClass(this.axis+"-axis"),this.borderless&&this.$container.addClass("borderless"),this._dim="x"===this.axis?"Width":"Height",this._dir="x"===this.axis?"left":"top",this._dirReverse="x"===this.axis?"right":"bottom",this._scrollDir="x"===this.axis?"scrollLeft":"scrollTop";var t=this.$parent.data("scrollbars");if(!t)throw new Error('Data "scrollbars" missing in '+qs.debugOutput(this.$parent)+"\nAncestors: "+this.ancestorsToString(1));this.$parent.on("DOMMouseScroll mousewheel",this._onScrollWheelHandler).on("scroll",this._onScrollHandler).onPassive("touchstart",this._onTouchStartHandler),t.forEach((function(t){t.on("scrollStart",e._fixScrollbarHandler),t.on("scrollEnd",e._unfixScrollbarHandler)})),this.$container.on("mousedown",this._onScrollbarMouseDownHandler),this._$thumb.on("mousedown",this._onThumbMouseDownHandler),this._$ancestors=this.$container.parents("div").on("scroll resize",this._onAncestorScrollOrResizeHandler)}},{key:"_remove",value:function(){var e=this,t=this.$parent.data("scrollbars");this.$parent.off("DOMMouseScroll mousewheel",this._onScrollWheelHandler).off("scroll",this._onScrollHandler).offPassive("touchstart",this._onTouchStartHandler),t.forEach((function(t){t.off("scrollStart",e._fixScrollbarHandler),t.off("scrollEnd",e._unfixScrollbarHandler)})),this.$container.off("mousedown",this._onScrollbarMouseDownHandler),this._$thumb.off("mousedown","",this._onThumbMouseDownHandler),this._$ancestors.off("scroll resize",this._onAncestorScrollOrResizeHandler),this._$ancestors=null,bh(kh(i.prototype),"_remove",this).call(this)}},{key:"_renderOnAttach",value:function(){bh(kh(i.prototype),"_renderOnAttach",this).call(this),this._ensureParentPosition()}},{key:"_ensureParentPosition",value:function(){if(this.$parent&&this.$parent.isAttached()){var e=this.$parent.css("position");O.isOneOf(e,"relative","absolute")||this.$parent.css("position","relative")}}},{key:"scroll",value:function(e){var t=Math.max(0,this.$parent[this._scrollDir]());this._scrollToAbsolutePoint(t+e)}},{key:"_scrollToAbsolutePoint",value:function(e){var t=Math.min(this._scrollSize-this._offsetSize+1,Math.max(0,Math.round(e)));this.$parent[this._scrollDir](t)}},{key:"update",value:function(){if(this.rendered){var e=this.$container["cssMargin"+this.axis.toUpperCase()](),t=this.$parent[this._scrollDir](),n=this.$parent.scrollLeft(),r=this.$parent.scrollTop();this.reset(),this._offsetSize=this.$parent[0]["offset"+this._dim],this._scrollSize=this.$parent[0]["scroll"+this._dim];var o=Math.max(this._offsetSize*this._offsetSize/this._scrollSize-e,25),i=this._offsetSize-o-e;this._$thumb.css(this._dim.toLowerCase(),o);var s=t/(this._scrollSize-this._offsetSize)*i;this._$thumb.css(this._dir,s),this._offsetSize+1>=this._scrollSize?this.$container.css("display","none"):(this.$container.css("display",""),this._isContainerTooSmallForThumb()?this._$thumb.addClass("container-too-small-for-thumb"):this._$thumb.removeClass("container-too-small-for-thumb")),this._clipWhenOverlappingAncestor(),this.$container.cssRight(-1*n),this.$container.cssBottom(-1*r)}}},{key:"_resetClipping",value:function(){"y"===this.axis?this._$thumb.css("width","").css("left",""):this._$thumb.css("height","").css("top",""),this._$thumb.removeClass("clipped-left clipped-right clipped-top clipped-bottom"),this._thumbClipping=new Bs(0,0,0,0)}},{key:"_clipWhenOverlappingAncestor",value:function(){if(this._resetClipping(),"fixed"===this.$container.css("position")){var e=qs.offsetBounds(this._$thumb),t=e.width,n=e.height,r=e.x+e.width,o=e.y+e.height,i=0,a=0,l=r,u=o;this.$container.parents("div").each((function(){var e=s()(this),t=qs.offsetBounds(e);if("visible"!==e.css("overflow-x")){t.x>i&&(i=t.x);var n=t.x+t.width;n<l&&(l=n)}if("visible"!==e.css("overflow-y")){t.y>a&&(a=t.y);var r=t.y+t.height;r<u&&(u=r)}}));var c=0,f=0,h=0,p=0;i>e.x&&(t-=c=i-e.x,this._$thumb.css("width",t).css("left",qs.bounds(this._$thumb).x+c).addClass("clipped-left")),a>e.y&&(n-=h=a-e.y,this._$thumb.css("height",n).css("top",qs.bounds(this._$thumb).y+h).addClass("clipped-top")),r>l&&(f=r-l,this._$thumb.css("width",t-f).addClass("clipped-right")),o>u&&(p=o-u,this._$thumb.css("height",n-p).addClass("clipped-bottom")),this._thumbClipping=new Bs(h,f,p,c)}}},{key:"reset",value:function(){this._$thumb.css(this._dim.toLowerCase(),0),this.$container.cssRight(0),this.$container.cssBottom(0)}},{key:"_onScroll",value:function(e){this.update()}},{key:"_onTouchStart",value:function(e){var t=this;Nt.onScrollStartEndDuringTouch(this.$parent,(function(){t.rendered&&t.$container.css("opacity",0)}),(function(){t.rendered&&t.$container.css("opacity","")}))}},{key:"_onScrollWheel",value:function(e){if(!this.$container.isVisible())return!0;if(e.ctrlKey)return!0;if(this.mouseWheelNeedsShift!==e.shiftKey)return!0;var t=(e=e.originalEvent||this.$container.window(!0).event.originalEvent).wheelDelta?-e.wheelDelta/2:20*e.detail;return this.notifyBeforeScroll(),this.scroll(t),this.notifyAfterScroll(),!1}},{key:"_onScrollbarMouseDown",value:function(e){this.notifyBeforeScroll();var t,n=this.$container[this._dim.toLowerCase()](),r=this.$container.offset()[this._dir],o=("x"===this.axis?e.pageX:e.pageY)-r;if(this._isContainerTooSmallForThumb())t=Math.min(1,Math.max(0,o/n)),this._scrollToAbsolutePoint(t*this._scrollSize-Math.round(this._offsetSize/2));else{var i=this._$thumb["outer"+this._dim](!0),s=Math.round(i/2),a=1/(n-Math.round(i/2)-s)*(o-s);t=Math.min(1,Math.max(0,a)),this._scrollToAbsolutePoint(t*(this._scrollSize-this._offsetSize))}this.notifyAfterScroll()}},{key:"_onThumbMouseDown",value:function(e){if(this._isContainerTooSmallForThumb())return!0;this.notifyBeforeScroll();var t=("x"===this.axis?this._thumbClipping.horizontal():this._thumbClipping.vertical())+this._$thumb["outer"+this._dim](!0),n="x"===this.axis?this._thumbClipping.left:this._thumbClipping.top,r=this._$thumb.offset()[this._dir]+Math.floor(t/2)-n,o=Math.round(("x"===this.axis?e.pageX:e.pageY)-r);return this._$thumb.addClass("scrollbar-thumb-move"),this._$thumb.document().on("mousemove",{thumbCenterOffset:o},this._onDocumentMousemoveHandler).one("mouseup",this._onDocumentMouseUpHandler),!1}},{key:"_onDocumentMousemove",value:function(e){if(this.rendered){var t=e.data.thumbCenterOffset,n=("x"===this.axis?this._thumbClipping.horizontal():this._thumbClipping.vertical())+this._$thumb["outer"+this._dim](!0),r=this.$container[this._dim.toLowerCase()]()-n,o=this.$container.offset()[this._dir]+n/2,i=Math.min(r,Math.max(0,("x"===this.axis?e.pageX:e.pageY)-o-t)),s=Math.min(1,Math.max(0,i/r))*(this._scrollSize-this._offsetSize);this._scrollToAbsolutePoint(s)}}},{key:"_onDocumentMouseUp",value:function(e){return s()(e.currentTarget).off("mousemove",this._onDocumentMousemoveHandler),this.rendered&&this._$thumb.removeClass("scrollbar-thumb-move"),this.notifyAfterScroll(),!1}},{key:"notifyBeforeScroll",value:function(){this.trigger("scrollStart")}},{key:"notifyAfterScroll",value:function(){this.trigger("scrollEnd")}},{key:"_fixScrollbar",value:function(){Lh.fix(this.$container),this.update()}},{key:"_unfixScrollbar",value:function(){Lh.unfix(this.$container,null,!0),this.update()}},{key:"_isContainerTooSmallForThumb",value:function(){return this._$thumb["outer"+this._dim](!0)>=this.$container[this._dim.toLowerCase()]()}}])&&vh(t.prototype,n),r&&vh(t,r),i}(ve),Oh={};function Th(e){if(e)return Oh[e]||[];var t=[];return Pr.values(Oh).forEach((function(e){rt.pushAll(t,e)})),t}function Ch(e,t){if(Oh[e]){if(Oh[e].indexOf(t)>-1)return;Oh[e].push(t)}else Oh[e]=[t];s.a.log.isTraceEnabled()&&s.a.log.trace("Scrollable added: "+t.attr("class")+". New length: "+Oh[e].length)}function Ph(e,t){var n=0;if(!Oh[e])throw new Error("scrollable could not be removed. Potential memory leak. "+t.attr("class"));if(n=Oh[e].length,rt.$remove(Oh[e],t),s.a.log.isTraceEnabled()&&s.a.log.trace("Scrollable removed: "+t.attr("class")+". New length: "+Oh[e].length),n===Oh[e].length)throw new Error("scrollable could not be removed. Potential memory leak. "+t.attr("class"))}function Rh(e,t){Kt.get().isIos()?setTimeout(xh.bind(this,e,t)):xh(e,t)}function xh(e,t){s.a.log.isTraceEnabled()&&s.a.log.trace("use native scrollbars for container "+qs.debugOutput(e)),"x"===t.axis?e.css("overflow-x","auto").css("overflow-y","hidden"):"y"===t.axis?e.css("overflow-x","hidden").css("overflow-y","auto"):e.css("overflow","auto"),e.css("-webkit-overflow-scrolling","touch")}function Eh(e,t){s.a.log.isTraceEnabled()&&s.a.log.trace("installing JS-scrollbars for container "+qs.debugOutput(e));var n,r=rt.ensure(e.data("scrollbars"));if(r.forEach((function(e){e.destroy()})),r=[],"both"===t.axis){var o=s.a.extend({},t);o.axis="y",n=O.create("Scrollbar",s.a.extend({},o)),r.push(n),o.axis="x",o.mouseWheelNeedsShift=!0,n=O.create("Scrollbar",s.a.extend({},o)),r.push(n)}else n=O.create("Scrollbar",s.a.extend({},t)),r.push(n);e.data("scrollbars",r),r.forEach((function(t){t.render(e),t.update()}))}function Dh(e,t){if(e&&e.data("scrollable")){var n=e.data("scrollbars");n?t?Ah(n):e.data("scrollbarUpdatePending")||(setTimeout((function(){Ah(n),e.removeData("scrollbarUpdatePending")}),0),e.data("scrollbarUpdatePending",!0)):Kt.get().isIos()&&function(e){if(e.data("scrollbarUpdatePending"))return;function t(){var t=qs.size(e).subtract(qs.insets(e,{includePadding:!1,includeBorder:!0}));e[0].scrollHeight===t.height&&e[0].scrollWidth===t.width?e.css("-webkit-overflow-scrolling",""):e.css("-webkit-overflow-scrolling","touch")}setTimeout((function(){t(),e.removeData("scrollbarUpdatePending")})),e.data("scrollbarUpdatePending",!0)}(e)}}function Ah(e){e.forEach((function(e){e.rendered&&e.reset()})),e.forEach((function(e){e.rendered&&e.update()}))}function Fh(e){return s.a.extend({},{animate:!1,stop:!0},e)}function $h(e,t,n){n=Fh(n);var r=Bh(e,"y");if(r&&r.notifyBeforeScroll(),n.stop&&e.stop("scroll"),!n.animate)return e.scrollTop(t),void(r&&r.notifyAfterScroll());!function(e,t){e.animate({scrollTop:t},{queue:"scroll"}).dequeue("scroll")}(e,t),e.promise("scroll").always((function(){r&&r.notifyAfterScroll()}))}function jh(e,t,n){n=Fh(n);var r=Bh(e,"x");if(r&&r.notifyBeforeScroll(),n.stop&&e.stop("scroll"),!n.animate)return e.scrollLeft(t),void(r&&r.notifyAfterScroll());!function(e,t){e.animate({scrollLeft:t},{queue:"scroll"}).dequeue("scroll")}(e,t),e.promise("scroll").always((function(){r&&r.notifyAfterScroll()}))}function Bh(e,t){var n=e.data("scrollbars")||[];return rt.find(n,(function(e){return e.axis===t}))}function Mh(e){e.css({position:"absolute",left:"",top:"",width:"",height:""})}function Ih(e,t,n,r){var o=0;return e.forEach((function(e){e.height?o+=e.height:o+=r,n(e)&&t(e).length>0&&(o+=Ih(t(e),t,n,r))})),o}var Lh={ensureExpansionVisible:function(e){var t=e.isExpanded(e.element),n=e.getChildren(e.element),r=e.$element.position().top,o=e.element.height,i=e.$scrollable.scrollTop();if(t){if(t&&n.length>0){var s=e.$scrollable.height(),a=r+(Ih(n,e.getChildren,e.isExpanded,e.defaultChildHeight)+1.5*o),l=i+Math.min(a-s,r-o);l>i&&$h(e.$scrollable,l,{animate:!0,stop:!1})}}else if(r<o){var u=Math.max(i-(o-r),0);$h(e.$scrollable,u,{animate:!0})}if(n.length>0){var c=Math.max(e.element.level-3,0)*e.nodePaddingLevel;jh(e.$scrollable,c,{animate:!0,stop:!1})}},fix:function(e){if(e.isVisible()&&"fixed"!==e.css("position")){var t=e[0].getBoundingClientRect();e.css("position","fixed").cssLeft(t.left-e.cssMarginLeft()).cssTop(t.top-e.cssMarginTop()).cssWidth(t.width).cssHeight(t.height)}},getScrollables:Th,install:function(e,t){(t=Fh(t)).axis=t.axis||"both";var n=O.nvl(t.nativeScrollbars,Kt.get().hasPrettyScrollbars()),r=O.nvl(t.hybridScrollbars,Kt.get().canHideScrollbars()&&!(Kt.get().isInternetExplorer()&&!Kt.get().supportsTouch()));n?Rh(e,t):r?(e.addClass("hybrid-scrollable"),Rh(e,t),Eh(e,t)):(e.css("overflow","hidden"),Eh(e,t));var o=ea.optGet(e);return o&&(o.scrollable=!0),e.data("scrollable",!0),Ch(t.session||t.parent.session,e),e},isHybridScrolling:function(e){return e.hasClass("hybrid-scrollable")},isJsScrolling:function(e){return!!e.data("scrollbars")},isLocationInView:function(e,t){return!t||0===t.length||qs.offsetBounds(t).contains(e.x,e.y)},isNativeScrolling:function(e){return O.isOneOf("auto",e.css("overflow"),e.css("overflow-x"),e.css("overflow-y"))},offScroll:function(e){var t=e.$scrollParents;if(!t)throw new Error("$scrollParents are not defined");for(var n=0;n<t.length;n++){t[n].off("scroll",e)}},onScroll:function(e,t){t.$scrollParents=[],e.scrollParents().each((function(){var e=s()(this);e.on("scroll",t),t.$scrollParents.push(e)}))},opacity:function(e,t){if(e&&e.data("scrollable")){var n=e.data("scrollbars");n&&n.forEach((function(e){e.rendered&&e.$container.css("opacity",t)}))}},pushScrollable:Ch,removeScrollable:Ph,reset:function(e){var t=e.data("scrollbars");t&&t.forEach((function(e){e.reset()}))},restoreScrollPositions:function(e,t){var n,r,o=Th(t);o&&o.forEach((function(t){e.isOrHas(t[0])&&((n=t.data("scrollTop"))&&(t.scrollTop(n),t.removeData("scrollTop")),(r=t.data("scrollLeft"))&&(t.scrollLeft(r),t.removeData("scrollLeft")),Dh(t),s.a.log.isTraceEnabled()&&s.a.log.trace("Restored scroll position for "+t.attr("class")+". Top: "+n+". Left: "+r))}))},scrollHorizontalTo:function(e,t,n){var r,o=e.width(),i=qs.bounds(t,!0),s=i.x,a=i.width;s<0?jh(e,e.scrollLeft()+s,n):s+a>o&&(r=Math.ceil(e.scrollLeft()+s+a-o),jh(e,r,n))},scrollLeft:jh,scrollTo:function(e,t,n){var r,o=e.height(),i=qs.offsetBounds(t),s=qs.offsetBounds(e),a=i.y-s.y-4,l=0,u=i.height+8,c=a+u,f=(n="string"==typeof n?{align:n}:Fh(n)).align;"center"===(f=f?f.toLowerCase():a<0?"top":c>o?"bottom":void 0)?r=e.scrollTop()+a-Math.max(0,(o-u)/2):"top"===f?r=e.scrollTop()+a:"bottom"===f&&(l=a-((r=Math.ceil(e.scrollTop()+c-o))-e.scrollTop()))<0&&(r+=l),r&&$h(e,r,n)},scrollToBottom:function(e,t){$h(e,e[0].scrollHeight-e[0].offsetHeight,t)},scrollTop:$h,scrollbar:Bh,setVisible:function(e,t){if(e&&e.data("scrollable")){var n=e.data("scrollbars");n&&n.forEach((function(e){e.rendered&&e.$container.setVisible(t)}))}},storeScrollPositions:function(e,t){var n,r,o=Th(t);o&&o.forEach((function(t){e.isOrHas(t[0])&&(n=t.scrollTop(),t.data("scrollTop",n),r=t.scrollLeft(),t.data("scrollLeft",t.scrollLeft()),s.a.log.isTraceEnabled()&&s.a.log.trace("Stored scroll position for "+t.attr("class")+". Top: "+n+". Left: "+r))}))},unfix:function(e,t,n){if(clearTimeout(t),!n)return setTimeout((function(){Mh(e)}),50);Mh(e)},uninstall:function(e,t){if(e.data("scrollable")){var n=e.data("scrollbars");n&&n.forEach((function(e){e.destroy()})),Ph(t,e),e.removeData("scrollable"),e.css("overflow",""),e.removeClass("hybrid-scrollable"),e.removeData("scrollbars");var r=ea.optGet(e);r&&(r.scrollable=!1)}},update:Dh};function Hh(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Nh=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.enabled=!0,this.minRowHeight=0,this.scrollHandler=null,this.viewRangeSize=new Fr,this.widget=null,this.$scrollable=null,s.a.extend(this,t)}var t,n,r;return t=e,(n=[{key:"setEnabled",value:function(e){this.enabled=e}},{key:"set$Scrollable",value:function(e){this.$scrollable!==e&&(this.$scrollable=e)}},{key:"setMinRowHeight",value:function(e){if(this.minRowHeight!==e){if(!pr.isNumber(e))throw new Error("minRowHeight is not a number: "+e);this.minRowHeight=e,this.widget.rendered&&this.setViewRangeSize(this.calculateViewRangeSize())}}},{key:"setViewRangeSize",value:function(e,t){this.viewRangeSize!==e&&(this.viewRangeSize=e,this.widget.rendered&&O.nvl(t,!0)&&this._renderViewPort())}},{key:"calculateViewRangeSize",value:function(){if(!this.enabled||0===this.$scrollable.length)return this.rowCount();if(0===this.minRowHeight)throw new Error("Cannot calculate view range with rowHeight = 0");return 2*Math.ceil(this.$scrollable.height()/this.minRowHeight)}},{key:"calculateCurrentViewRange",value:function(){if(!this.enabled)return this.maxViewRange();if(0===this.viewRangeSize)return new Fr(0,0);var e;if(0===this.$scrollable.length)return this.maxViewRange();var t=this.$scrollable[0].scrollTop,n=this.$scrollable[0].scrollHeight-this.$scrollable[0].clientHeight,r=this.widget.$container[0].getBoundingClientRect(),o=this.$scrollable[0].getBoundingClientRect();return r.height>0&&(r.bottom<o.top||r.top>o.bottom)?new Fr(0,0):(e=0===n?0:this._rowIndexAtScrollTop(t),this.calculateViewRangeForRowIndex(e))}},{key:"maxViewRange",value:function(){return new Fr(0,this.rowCount())}},{key:"calculateViewRangeForRowIndex",value:function(e){if(!this.enabled)return this.maxViewRange();var t=new Fr,n=Math.floor(this.viewRangeSize/4);return t.from=Math.max(e-n,0),t.to=Math.min(t.from+this.viewRangeSize,this.rowCount()),this.viewRangeSize-t.size()>0&&(t.from=Math.max(t.to-this.viewRangeSize,0)),t}},{key:"_rowIndexAtScrollTop",value:function(e){var t=0,n=this.rowCount(),r=n-1;this.widget.$container[0]!==this.$scrollable[0]&&(t=e+(this.widget.$container.offset().top-this.$scrollable.offset().top));for(var o=0;o<n;o++)if(e<(t+=this.rowHeight(o))){r=o;break}return r}},{key:"rowHeight",value:function(e){throw new Error("Function has to be provided by widget")}},{key:"rowCount",value:function(){throw new Error("Function has to be provided by widget")}},{key:"_renderViewPort",value:function(){var e=this.calculateCurrentViewRange();this._renderViewRange(e)}},{key:"_renderViewRangeForRowIndex",value:function(e){var t=this.calculateViewRangeForRowIndex(e);this._renderViewRange(t)}},{key:"_renderViewRange",value:function(e){throw new Error("Function has to be provided by widget")}}])&&Hh(t.prototype,n),r&&Hh(t,r),e}();function Vh(e){return(Vh="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Wh(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function zh(e,t,n){return(zh="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Yh(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function Gh(e,t){return(Gh=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Uh(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Yh(e);if(t){var o=Yh(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Kh(this,n)}}function Kh(e,t){return!t||"object"!==Vh(t)&&"function"!=typeof t?qh(e):t}function qh(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Yh(e){return(Yh=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Xh=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Gh(e,t)}(i,e);var t,n,r,o=Uh(i);function i(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(e=o.call(this)).splitHorizontal=!0,e.$anchor=null,e.$root=null,e.position=null,e.orientation="top",e.layoutData=null,e._cursorOffset=0,e._mouseDownHandler=e._onMouseDown.bind(qh(e)),e._$window=null,e._$body=null,e}return t=i,(n=[{key:"_init",value:function(e){zh(Yh(i.prototype),"_init",this).call(this,e),this.setPosition(this.position)}},{key:"_render",value:function(){this.$container=this.$parent.appendDiv("splitter").addClass(this.splitHorizontal?"x-axis":"y-axis"),this.htmlComp=ea.install(this.$container,this.session),this._$window=this.$parent.window(),this._$body=this.$parent.body()}},{key:"_renderProperties",value:function(){zh(Yh(i.prototype),"_renderProperties",this).call(this),this._renderPosition()}},{key:"_renderEnabled",value:function(){zh(Yh(i.prototype),"_renderEnabled",this).call(this),this.enabledComputed?this.$container.on("mousedown",this._mouseDownHandler):this.$container.off("mousedown",this._mouseDownHandler)}},{key:"_renderVisible",value:function(){zh(Yh(i.prototype),"_renderVisible",this).call(this),this.initialized&&this._renderPosition()}},{key:"setLayoutData",value:function(e){zh(Yh(i.prototype),"setLayoutData",this).call(this,e),this.layoutData=e}},{key:"getLayoutData",value:function(){return this.layoutData}},{key:"setPosition",value:function(e){return s.a.isNumeric(e)||(e=this._derivePositionFromAnchor()),e!==this.position&&this._setPosition(e),e}},{key:"_derivePositionFromAnchor",value:function(){if(!this.$anchor)return null;var e=qs.offsetBounds(this.$anchor,{exact:!0});return this.splitHorizontal?e.x+e.width:e.y+e.height}},{key:"_setPosition",value:function(e){if(s.a.isNumeric(e)&&e!==this.position){this.position=e;var t={position:e};this.trigger("positionChange",t),this.rendered&&this._renderPosition()}}},{key:"_renderPosition",value:function(){if(null!==this.position&&this.visible){var e=qs.size(this.$container,!0);if(this.splitHorizontal){var t=this.position-e.width/2;"right"===this.orientation?this.$container.cssRight(t):this.$container.cssLeft(t)}else{var n=this.position-e.height/2;"bottom"===this.orientation?this.$container.cssBottom(n):this.$container.cssTop(n)}}}},{key:"_onMouseDown",value:function(e){var t=qs.margins(this.$container),n=qs.offsetBounds(this.$container);n.x-=t.left,n.y-=t.top,n.width+=t.horizontal(),n.height+=t.vertical();var r=n.center();this._$window.on("mousemove.splitter",this._onMouseMove.bind(this)).one("mouseup",this._onMouseUp.bind(this)),this._$body.addClass(this.splitHorizontal?"col-resize":"row-resize"),s()("iframe").addClass("dragging-in-progress"),this._cursorOffset={left:r.x-e.pageX,top:r.y-e.pageY},this.trigger("moveStart",{position:this._getSplitterPosition(e)}),e.preventDefault()}},{key:"_getSplitterPosition",value:function(e){var t=qs.offsetBounds(this.$root||this.$parent);if(this.splitHorizontal){var n=e.pageX+this._cursorOffset.left-t.x;return"right"===this.orientation?t.width-n:n}var r=e.pageY+this._cursorOffset.top-t.y;return"bottom"===this.orientation?t.height-r:r}},{key:"_onMouseMove",value:function(e){var t={position:this._getSplitterPosition(e),defaultPrevented:!1,preventDefault:function(){this.defaultPrevented=!0},setPosition:function(e){this.position=e}};this.trigger("move",t),t.defaultPrevented||this._setPosition(t.position)}},{key:"_onMouseUp",value:function(e){this._$window.off("mousemove.splitter"),this._$body.removeClass(this.splitHorizontal?"col-resize":"row-resize"),s()("iframe").removeClass("dragging-in-progress"),this.trigger("moveEnd",{position:this.position})}}])&&Wh(t.prototype,n),r&&Wh(t,r),i}(ve),Jh={YEAR:"year",MONTH:"month",WEEK_IN_YEAR:"week_in_year",DAY_IN_MONTH:"day_in_month",WEEKDAY:"weekday",HOUR_24:"hour_24",HOUR_12:"hour_12",AM_PM:"am_pm",MINUTE:"minute",SECOND:"second",MILLISECOND:"millisecond",TIMEZONE:"timezone"};function Zh(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Qh=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),t=t||{},this.type=t.type,this.terms=t.terms,this.dateFormat=t.dateFormat,this.formatFunction=t.formatFunction&&t.formatFunction.bind(this),this.parseRegExp=t.parseRegExp,this.applyMatchFunction=t.applyMatchFunction&&t.applyMatchFunction.bind(this),this.parseFunction=t.parseFunction&&t.parseFunction.bind(this)}var t,n,r;return t=e,(n=[{key:"createFormatFunction",value:function(e){return function(t){if(this.formatFunction){var n=this.formatFunction(t,e);void 0!==n&&(t.formattedString+=n)}}.bind(this)}},{key:"createParseFunction",value:function(e){return function(t){var n,r,o,i=!1;return this.parseRegExp&&(n=this.parseRegExp.exec(t.inputString))&&(this.applyMatchFunction&&this.applyMatchFunction(t,n[1],e),o=n[1],t.inputString=n[2],i=!0),!i&&this.parseFunction&&null!==(o=this.parseFunction(t,e))&&(i=!0),i&&(r=this.terms[0],this.terms.length>1&&this.terms.some((function(e){return e.length===o.length&&(r=e,!0)})),t.parsedPattern+=r),i}.bind(this)}},{key:"accept",value:function(e){if(e)for(var t=0;t<this.terms.length;t++)if(e===this.terms[t])return this.terms[t];return null}}])&&Zh(t.prototype,n),r&&Zh(t,r),e}();function ep(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var tp=function(){function e(t,n,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),r=r||{},this.locale=t,O.assertParameter("locale",this.locale),this.pattern=n||t.dateFormatPatternDefault,O.assertParameter("pattern",this.pattern),this.symbols=t.dateFormatSymbols,this.symbols.firstDayOfWeek=1,this.symbols.weekdaysOrdered=Et.orderWeekdays(this.symbols.weekdays,this.symbols.firstDayOfWeek),this.symbols.weekdaysShortOrdered=Et.orderWeekdays(this.symbols.weekdaysShort,this.symbols.firstDayOfWeek),this.symbols.monthsToNumber,this.symbols.monthsShortToNumber,this.lenient=O.nvl(r.lenient,!0),this._terms=[],this._formatFunctions=[],this._parseFunctions=[],this._analyzeFunctions=[],this._patternDefinitions=[new Qh({type:Jh.YEAR,terms:["yyyy"],dateFormat:this,formatFunction:function(e,t){return Wn.padZeroLeft(e.inputDate.getFullYear(),4).slice(-4)},parseRegExp:/^(\d{4})(.*)$/,applyMatchFunction:function(e,t,n){e.matchInfo.year=t,e.dateInfo.year=Number(t)}}),new Qh({type:Jh.YEAR,terms:["yyy","yy","y"],dateFormat:this,formatFunction:function(e,t){var n=String(e.inputDate.getFullYear()),r=e.exactLength?t.length:2;return 1===r?n.slice(-r):Wn.padZeroLeft(n,r).slice(-r)},parseRegExp:/^(\d{1,3})(.*)$/,applyMatchFunction:function(e,t,n){if(3===t.length)return e.dateInfo.year=Number(t),void(e.matchInfo.year=t);var r=(e.startDate||new Date).getFullYear(),o=Number(Wn.padZeroLeft(r,4).substr(0,2)+Wn.padZeroLeft(t,2)),i=o-r;i<=-50?o+=100:i>50&&(o-=100),e.dateInfo.year=o,e.matchInfo.year=t}}),new Qh({type:Jh.MONTH,terms:["MMMM"],dateFormat:this,formatFunction:function(e,t){return this.dateFormat.symbols.months[e.inputDate.getMonth()]},parseFunction:function(e,t){var n,r,o;for(n=0;n<this.dateFormat.symbols.months.length;n++)if((r=this.dateFormat.symbols.months[n])&&(o=new RegExp("^("+Wn.quote(r)+")(.*)$","i").exec(e.inputString)))return e.dateInfo.month=n,e.matchInfo.month=o[1],e.inputString=o[2],o[1];if(e.analyze)for(n=0;n<this.dateFormat.symbols.months.length;n++)if(r=this.dateFormat.symbols.months[n],o=new RegExp("^("+Wn.quote(e.inputString)+")(.*)$","i").exec(r))return e.dateInfo.month=n,e.matchInfo.month=r,e.inputString="",o[1];return null}}),new Qh({type:Jh.MONTH,terms:["MMM"],dateFormat:this,formatFunction:function(e,t){return this.dateFormat.symbols.monthsShort[e.inputDate.getMonth()]},parseFunction:function(e,t){var n,r,o;for(n=0;n<this.dateFormat.symbols.monthsShort.length;n++)if((r=this.dateFormat.symbols.monthsShort[n])&&(o=new RegExp("^("+Wn.quote(r)+")(.*)$","i").exec(e.inputString)))return e.dateInfo.month=n,e.matchInfo.month=o[1],e.inputString=o[2],o[1];if(e.analyze)for(n=0;n<this.dateFormat.symbols.monthsShort.length;n++)if(r=this.dateFormat.symbols.monthsShort[n],o=new RegExp("^("+Wn.quote(e.inputString)+")(.*)$","i").exec(r))return e.dateInfo.month=n,e.matchInfo.month=r,e.inputString="",o[1];return null}}),new Qh({type:Jh.MONTH,terms:["MM"],dateFormat:this,formatFunction:function(e,t){return Wn.padZeroLeft(e.inputDate.getMonth()+1,2)},parseRegExp:/^(\d{2})(.*)$/,applyMatchFunction:function(e,t,n){var r=Number(t);e.dateInfo.month=r-1,e.matchInfo.month=t},parseFunction:function(e,t){if(e.analyze&&"0"===e.inputString){var n=this.dateFormat._dateInfoToDate(e.dateInfo);if(!n)return null;var r=n.getMonth();return r>=9&&(r=0,void 0===e.dateInfo.year?e.dateInfo.year=Number(n.getFullYear())+1:e.dateInfo.year=e.dateInfo.year+1),e.dateInfo.month=r,e.matchInfo.month=Wn.padZeroLeft(String(r+1),2),e.inputString="","0"}return null}}),new Qh({type:Jh.MONTH,terms:["M"],dateFormat:this,formatFunction:function(e,t){return String(e.inputDate.getMonth()+1)},parseRegExp:/^(\d{1,2})(.*)$/,applyMatchFunction:function(e,t,n){var r=Number(t);e.dateInfo.month=r-1,e.matchInfo.month=t}}),new Qh({type:Jh.WEEK_IN_YEAR,terms:["ww"],dateFormat:this,formatFunction:function(e,t){return Wn.padZeroLeft(Et.weekInYear(e.inputDate),2)},parseRegExp:/^(\d{2})(.*)$/,applyMatchFunction:function(e,t,n){e.matchInfo.week=t,e.hints.weekInYear=Number(t)}}),new Qh({type:Jh.WEEK_IN_YEAR,terms:["w"],dateFormat:this,formatFunction:function(e,t){return String(Et.weekInYear(e.inputDate))},parseRegExp:/^(\d{1,2})(.*)$/,applyMatchFunction:function(e,t,n){e.matchInfo.week=t,e.hints.weekInYear=Number(t)}}),new Qh({type:Jh.DAY_IN_MONTH,terms:["dd"],dateFormat:this,formatFunction:function(e,t){return Wn.padZeroLeft(e.inputDate.getDate(),2)},parseRegExp:/^(\d{2})(.*)$/,applyMatchFunction:function(e,t,n){e.dateInfo.day=Number(t),e.matchInfo.day=t},parseFunction:function(e,t){return e.analyze&&"0"===e.inputString?(e.dateInfo.day=1,e.matchInfo.day="01",e.inputString="","0"):null}}),new Qh({type:Jh.DAY_IN_MONTH,terms:["d"],dateFormat:this,formatFunction:function(e,t){return String(e.inputDate.getDate())},parseRegExp:/^(\d{1,2})(.*)$/,applyMatchFunction:function(e,t,n){e.dateInfo.day=Number(t),e.matchInfo.day=t}}),new Qh({type:Jh.WEEKDAY,terms:["EEEE"],dateFormat:this,formatFunction:function(e,t){return this.dateFormat.symbols.weekdays[e.inputDate.getDay()]},parseFunction:function(e,t){var n,r,o;for(n=0;n<this.dateFormat.symbols.weekdays.length;n++)if((r=this.dateFormat.symbols.weekdays[n])&&(o=new RegExp("^("+Wn.quote(r)+")(.*)$","i").exec(e.inputString)))return e.matchInfo.weekday=o[1],e.hints.weekday=n,e.inputString=o[2],o[1];if(e.analyze)for(n=0;n<this.dateFormat.symbols.weekdays.length;n++)if(r=this.dateFormat.symbols.weekdays[n],o=new RegExp("^("+Wn.quote(e.inputString)+")(.*)$","i").exec(r))return e.matchInfo.weekday=r,e.hints.weekday=n,e.inputString="",o[1];return null}}),new Qh({type:Jh.WEEKDAY,terms:["EEE","EE","E"],dateFormat:this,formatFunction:function(e,t){return this.dateFormat.symbols.weekdaysShort[e.inputDate.getDay()]},parseFunction:function(e,t){var n,r,o;for(n=0;n<this.dateFormat.symbols.weekdaysShort.length;n++)if((r=this.dateFormat.symbols.weekdaysShort[n])&&(o=new RegExp("^("+Wn.quote(r)+")(.*)$","i").exec(e.inputString)))return e.matchInfo.weekday=o[1],e.hints.weekday=n,e.inputString=o[2],o[1];if(e.analyze)for(n=0;n<this.dateFormat.symbols.weekdaysShort.length;n++)if(r=this.dateFormat.symbols.weekdaysShort[n],o=new RegExp("^("+Wn.quote(e.inputString)+")(.*)$","i").exec(r))return e.matchInfo.weekday=r,e.hints.weekday=n,e.inputString="",o[1];return null}}),new Qh({type:Jh.HOUR_24,terms:["HH"],dateFormat:this,formatFunction:function(e,t){return Wn.padZeroLeft(e.inputDate.getHours(),2)},parseRegExp:/^(\d{2})(.*)$/,applyMatchFunction:function(e,t,n){e.dateInfo.hours=Number(t),e.matchInfo.hours=t}}),new Qh({type:Jh.HOUR_24,terms:["H"],dateFormat:this,formatFunction:function(e,t){return String(e.inputDate.getHours())},parseRegExp:/^(\d{1,2})(.*)$/,applyMatchFunction:function(e,t,n){e.dateInfo.hours=Number(t),e.matchInfo.hours=t}}),new Qh({type:Jh.HOUR_12,terms:["hh"],dateFormat:this,formatFunction:function(e,t){return e.inputDate.getHours()%12==0?"12":Wn.padZeroLeft(e.inputDate.getHours()%12,2)},parseRegExp:/^(10|11|12|0[1-9])(.*)$/,applyMatchFunction:function(e,t,n){e.dateInfo.hours=Number(t)+(e.hints.pm?12:0),e.matchInfo.hours=t},parseFunction:function(e,t){return e.analyze&&"0"===e.inputString?(e.dateInfo.hours=1,e.matchInfo.hours="01",e.inputString="",e.inputString):null}}),new Qh({type:Jh.HOUR_12,terms:["h"],dateFormat:this,formatFunction:function(e,t){return e.inputDate.getHours()%12==0?"12":String(e.inputDate.getHours()%12)},parseRegExp:/^(10|11|12|0?[1-9])(.*)$/,applyMatchFunction:function(e,t,n){e.dateInfo.hours=Number(t)+(e.hints.pm?12:0),e.matchInfo.hours=t}}),new Qh({type:Jh.AM_PM,terms:["a"],dateFormat:this,formatFunction:function(e,t){return e.inputDate.getHours()<12?this.dateFormat.symbols.am:this.dateFormat.symbols.pm},parseFunction:function(e,t){var n=new RegExp("^("+Wn.quote(this.dateFormat.symbols.am)+")(.*)$","i"),r=n.exec(e.inputString);if(e.matchInfo.ampm=null,r)return e.matchInfo.ampm=r[1],e.inputString=r[2],e.hints.am=!0,e.dateInfo.hours=e.dateInfo.hours%12,r[1];if(r=(n=new RegExp("^("+Wn.quote(this.dateFormat.symbols.pm)+")(.*)$","i")).exec(e.inputString))return e.matchInfo.ampm=r[1],e.inputString=r[2],e.hints.pm=!0,e.dateInfo.hours=e.dateInfo.hours%12+12,r[1];if(e.analyze){if(r=(n=new RegExp("^("+Wn.quote(e.inputString)+")(.*)$","i")).exec(this.dateFormat.symbols.am))return e.matchInfo.ampm=this.dateFormat.symbols.am,e.inputString="",e.hints.am=!0,e.dateInfo.hours=e.dateInfo.hours%12,r[1];if(r=n.exec(this.dateFormat.symbols.pm))return e.matchInfo.ampm=this.dateFormat.symbols.pm,e.inputString="",e.hints.pm=!0,e.dateInfo.hours=e.dateInfo.hours%12+12,r[1]}return null}}),new Qh({type:Jh.MINUTE,terms:["mm"],dateFormat:this,formatFunction:function(e,t){return Wn.padZeroLeft(e.inputDate.getMinutes(),2)},parseRegExp:/^(\d{2})(.*)$/,applyMatchFunction:function(e,t,n){e.dateInfo.minutes=Number(t),e.matchInfo.minutes=t},parseFunction:function(e,t){if(e.analyze&&O.isOneOf(e.inputString,"0","1","2","3","4","5")){var n=e.inputString+"0";return e.dateInfo.minutes=Number(n),e.matchInfo.minutes=n,e.inputString="",e.inputString}return null}}),new Qh({type:Jh.MINUTE,terms:["m"],dateFormat:this,formatFunction:function(e,t){return String(e.inputDate.getMinutes())},parseRegExp:/^(\d{1,2})(.*)$/,applyMatchFunction:function(e,t,n){e.dateInfo.minutes=Number(t),e.matchInfo.minutes=t}}),new Qh({type:Jh.SECOND,terms:["ss"],dateFormat:this,formatFunction:function(e,t){return Wn.padZeroLeft(e.inputDate.getSeconds(),2)},parseRegExp:/^(\d{2})(.*)$/,applyMatchFunction:function(e,t,n){e.dateInfo.seconds=Number(t),e.matchInfo.seconds=t}}),new Qh({type:Jh.SECOND,terms:["s"],dateFormat:this,formatFunction:function(e,t){return String(e.inputDate.getSeconds())},parseRegExp:/^(\d{1,2})(.*)$/,applyMatchFunction:function(e,t,n){e.dateInfo.seconds=Number(t),e.matchInfo.seconds=t}}),new Qh({type:Jh.MILLISECOND,terms:["SSS"],dateFormat:this,formatFunction:function(e,t){return Wn.padZeroLeft(e.inputDate.getMilliseconds(),3)},parseRegExp:/^(\d{3})(.*)$/,applyMatchFunction:function(e,t,n){e.dateInfo.milliseconds=Number(t),e.matchInfo.milliseconds=t}}),new Qh({type:Jh.MILLISECOND,terms:["S"],dateFormat:this,formatFunction:function(e,t){return String(e.inputDate.getMilliseconds())},parseRegExp:/^(\d{1,3})(.*)$/,applyMatchFunction:function(e,t,n){e.dateInfo.milliseconds=Number(t),e.matchInfo.milliseconds=t}}),new Qh({type:Jh.TIMEZONE,terms:["Z"],dateFormat:this,formatFunction:function(e,t){var n=Math.abs(e.inputDate.getTimezoneOffset());return(n!==e.inputDate.getTimezoneOffset()?"-":"+")+Wn.padZeroLeft(Math.floor(n/60),2)+Wn.padZeroLeft(n%60,2)},parseRegExp:/^([+|-]\d{4})(.*)$/,applyMatchFunction:function(e,t,n){var r=60*Number(t.substr(1,2))+Number(t.substr(3,2));"-"===t.charAt(0)&&(r*=-1),e.dateInfo.timezone=r,e.matchInfo.timezone=t}})],this._patternLibrary={};for(var o=0;o<this._patternDefinitions.length;o++){var i=this._patternDefinitions[o],s=i.type;s&&(this._patternLibrary[s]||(this._patternLibrary[s]=[]),this._patternLibrary[s].push(i))}this._compile()}var t,n,r;return t=e,r=[{key:"ensure",value:function(t,n){return n?n instanceof e?n:new e(t,n):n}}],(n=[{key:"_compile",value:function(){var e,t,n,r,o,i,s,a,l;for(o=/(.)\1*/g;i=o.exec(this.pattern);){for(s=i[0],this._terms.push(s),a=!1,e=0;e<this._patternDefinitions.length;e++){var u=(r=this._patternDefinitions[e]).accept(s);if(u){if(this._formatFunctions.push(r.createFormatFunction(u)),this._parseFunctions.push(r.createParseFunction(u)),l=[r.createParseFunction(u)],this.lenient)for(n=this._patternLibrary[r.type],t=0;t<n.length;t++)n[t]!==r&&l.push(n[t].createParseFunction(u));this._analyzeFunctions.push(l),a=!0;break}}if(!a){this._formatFunctions.push(this._createConstantStringFormatFunction(s));var c=this._createConstantStringParseFunction(s);this._parseFunctions.push(c),this._analyzeFunctions.push([c])}}}},{key:"_createConstantStringFormatFunction",value:function(e){return function(t){t.formattedString+=e}}},{key:"_createConstantStringParseFunction",value:function(e){return function(t){return Wn.startsWith(t.inputString,e)?(t.inputString=t.inputString.substr(e.length),t.parsedPattern+=e,!0):t.analyze}}},{key:"format",value:function(e,t){if(!e)return"";var n=this._createFormatContext(e);n.exactLength=O.nvl(t,!1);for(var r=0;r<this._formatFunctions.length;r++)(0,this._formatFunctions[r])(n);return n.formattedString}},{key:"analyze",value:function(e,t){var n=this._createAnalyzeInfo(e);if(!e)return n;var r=this._createParseContext(e);r.analyze=!0,r.startDate=t;for(var o="",i=0;i<this._terms.length;i++)if(r.inputString.length>0){for(var s=this._analyzeFunctions[i],a=!1,l=0;l<s.length;l++)if((0,s[l])(r)){a=!0;break}if(!a)return n.error=!0,n;o=r.parsedPattern}else r.parsedPattern+=this._terms[i];if(r.inputString.length>0)return n.error=!0,n;t=this._prepareStartDate(t);var u=r.hints.weekday,c=r.dateInfo.day;void 0!==u&&(t=void 0!==c&&c<=31?Et.shiftToNextDayAndDate(t,u,c):Et.shiftToNextDayOfType(t,u));var f=this._dateInfoToDate(r.dateInfo,t,r.hints);return n.dateInfo=r.dateInfo,n.matchInfo=r.matchInfo,n.hints=r.hints,n.parsedPattern=r.parsedPattern,n.matchedPattern=o,n.predictedDate=f,n.error=!f,n}},{key:"parse",value:function(e,t){if(!e)return null;var n=this._createParseContext(e);n.startDate=t;for(var r=0;r<this._parseFunctions.length;r++){if(!(0,this._parseFunctions[r])(n))return null;if(0===n.inputString.length)break}if(n.inputString.length>0)return null;var o=this._dateInfoToDate(n.dateInfo,t);return o?void 0!==n.hints.weekday&&o.getDay()!==n.hints.weekday?null:o:null}},{key:"_dateInfoToDate",value:function(e,t,n){if(!e)return null;t=this._prepareStartDate(t);var r=new Date(1970,0,1),o=O.nvl(e.day,t.getDate()),i=O.nvl(e.month,t.getMonth()),s=O.nvl(e.year,t.getFullYear());if(e.day&&!e.month&&(31===e.day?O.isOneOf(i,[0,2,4,6,7,9,11])||(i+=1):e.day>=29&&1===i&&(e.day>29||!Et.isLeapYear(s))&&(i+=1)),!e.day&&e.month){var a=Et.shift(new Date(s,e.month+1,1),0,0,-1);o=Math.min(a.getDate(),t.getDate())}return r.setFullYear(s,i,o),r.setHours(O.nvl(e.hours,t.getHours()),O.nvl(e.minutes,t.getMinutes()),O.nvl(e.seconds,t.getSeconds()),O.nvl(e.milliseconds,t.getMilliseconds())),l(r.getFullYear(),e.year)&&l(r.getMonth(),e.month)&&l(r.getDate(),e.day)&&l(r.getHours(),e.hours)&&l(r.getMinutes(),e.minutes)&&l(r.getSeconds(),e.seconds)&&l(r.getMilliseconds(),e.milliseconds)&&l(r.getDay(),Pr.optProperty(n,"weekday"))?(pr.isNumber(e.timezone)&&r.setMinutes(r.getMinutes()-r.getTimezoneOffset()+e.timezone),r):null;function l(e,t){return Pr.isNullOrUndefined(t)||t===e}}},{key:"_prepareStartDate",value:function(e){return e?new Date(e.getTime()):Et.trunc(new Date)}},{key:"_createFormatContext",value:function(e){return{inputDate:e,formattedString:"",exactLength:!1}}},{key:"_createParseContext",value:function(e){return{inputString:e,dateInfo:{},matchInfo:{},hints:{},parsedPattern:"",analyze:!1,startDate:null}}},{key:"_createAnalyzeInfo",value:function(e){return{inputString:e,dateInfo:{},matchInfo:{},hints:{},parsedPattern:"",matchedPattern:"",predictedDate:null,error:!1}}}])&&ep(t.prototype,n),r&&ep(t,r),e}();function np(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var rp=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.positivePrefix="",this.positiveSuffix="",this.negativePrefix=t.decimalFormatSymbols.minusSign,this.negativeSuffix="",this.groupingChar=t.decimalFormatSymbols.groupingSeparator,this.lenientGroupingChars="'´`’·    ",this.groupLength=0,this.decimalSeparatorChar=t.decimalFormatSymbols.decimalSeparator,this.zeroBefore=1,this.zeroAfter=0,this.allAfter=0,"string"==typeof n&&(this.pattern=n),n=n||{},this.pattern=this.pattern||n.pattern||t.decimalFormatPatternDefault,this.multiplier=n.multiplier||1,this.roundingMode=n.roundingMode||dr.HALF_UP;var r=e.PATTERN_SYMBOLS,o=this.pattern.split(r.patternSeparator),i=u(o[0]);if(this.positivePrefix=i.prefix,this.positiveSuffix=i.suffix,o.length>1){var s=u(o[1]);this.negativePrefix=s.prefix,this.negativeSuffix=s.suffix,this.pattern=o[0]}else-1!==this.positivePrefix.indexOf(r.minusSign)||-1!==this.positiveSuffix.indexOf(r.minusSign)?(this.negativePrefix=this.positivePrefix.replace(r.minusSign,t.decimalFormatSymbols.minusSign),this.negativeSuffix=this.positiveSuffix.replace(r.minusSign,t.decimalFormatSymbols.minusSign),this.positivePrefix=this.positivePrefix.replace(r.minusSign,""),this.positiveSuffix=this.positiveSuffix.replace(r.minusSign,"")):(this.negativePrefix=this.positivePrefix+this.negativePrefix,this.negativeSuffix=this.negativeSuffix+this.positiveSuffix);var a=this.pattern.indexOf(r.decimalSeparator);-1===a&&(a=this.pattern.length);var l=this.pattern.lastIndexOf(r.groupingSeparator,a);function u(e){var t={prefix:"",suffix:""},n=r.digit+r.zeroDigit+r.decimalSeparator+r.groupingSeparator,o=new RegExp("^(.*?)["+n+"].*$"),i=o.exec(e);return null!==i&&(t.prefix=i[1].replace(new RegExp("'([^']+)'","g"),"$1")),null!==(i=(o=new RegExp("^.*["+n+"](.*?)$")).exec(e))&&(t.suffix=i[1].replace(new RegExp("'([^']+)'","g"),"$1")),t}l>0&&(this.groupLength=a-l-1),this.pattern=this.pattern.replace(new RegExp("["+r.groupingSeparator+"]","g"),""),o=this.pattern.split(r.decimalSeparator),this.zeroBefore=Wn.count(o[0],r.zeroDigit),o.length>1&&(this.zeroAfter=Wn.count(o[1],r.zeroDigit),this.allAfter=this.zeroAfter+Wn.count(o[1],r.digit))}var t,n,r;return t=e,r=[{key:"ensure",value:function(t,n){return n?n instanceof e?n:new e(t,n):n}}],(n=[{key:"parse",value:function(e,t){if(Wn.empty(e))return null;var n=this.normalize(e),r=(t=t||Number)(n);if(isNaN(r))throw new Error(e+" is not a number (NaN)");return 1!==this.multiplier&&(r/=this.multiplier),r}},{key:"format",value:function(e,t){if(t=O.nvl(t,!0),null==e)return null;var n=this.positivePrefix,r=this.positiveSuffix;t&&1!==this.multiplier&&(e*=this.multiplier),e=this.round(e);var o="";if(this.allAfter){for(var i=(o=e.toFixed(this.allAfter).split(".")[1]).length-1;i>this.zeroAfter-1&&"0"===o[i];i--)o=o.slice(0,-1);o&&(o=this.decimalSeparatorChar+o)}e<0&&(n=this.negativePrefix,r=this.negativeSuffix,e=-e);var s=Math.floor(e);if(s=0===s?"":String(s),s=Wn.padZeroLeft(s,this.zeroBefore),this.groupLength)for(var a=s.length-this.groupLength;a>0;a-=this.groupLength)s=s.substr(0,a)+this.groupingChar+s.substr(a);return n+s+o+r}},{key:"round",value:function(e,t){return t=O.nvl(t,!0),null==e?null:(t&&1!==this.multiplier&&(e*=this.multiplier),e=pr.round(e,this.roundingMode,this.allAfter),t&&1!==this.multiplier&&(e/=this.multiplier),e)}},{key:"normalize",value:function(e){return e?e.replace(new RegExp("["+this.groupingChar+this.lenientGroupingChars+"]","g"),"").replace(new RegExp("["+this.decimalSeparatorChar+"]","g"),".").replace(/\s/g,""):e}}])&&np(t.prototype,n),r&&np(t,r),e}();function op(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}!function(e,t,n){t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}(rp,"PATTERN_SYMBOLS",{digit:"#",zeroDigit:"0",decimalSeparator:".",groupingSeparator:",",minusSign:"-",patternSeparator:";"});var ip=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.map=t||{}}var t,n,r;return t=e,(n=[{key:"get",value:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var o;if(!this._exists(e))return this.parent?(o=this.parent).get.apply(o,[e].concat(n)):"[undefined text: "+e+"]";var i=n.length,s=this.map[e];if(0===i)return s;for(var a=0;a<i;a++)s=s.replace(new RegExp("\\{"+a+"\\}","g"),n[a]);return s}},{key:"optGet",value:function(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),o=2;o<n;o++)r[o-2]=arguments[o];var i;return this._exists(e)?this.get.apply(this,[e].concat(r)):this.parent?(i=this.parent).optGet.apply(i,[e,t].concat(r)):t}},{key:"exists",value:function(e){return!!this._exists(e)||!!this.parent&&this.parent.exists(e)}},{key:"_exists",value:function(e){return this.map.hasOwnProperty(e)}},{key:"add",value:function(e,t){this.map[e]=t}},{key:"addAll",value:function(t){t&&(t instanceof e&&(t=t.map),Pr.copyOwnProperties(t,this.map))}},{key:"setParent",value:function(e){this.parent=e}},{key:"remove",value:function(e){delete this.map[e]}}])&&op(t.prototype,n),r&&op(t,r),e}();!function(e,t,n){t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}(ip,"TEXT_KEY_REGEX",/\${textKey:([a-zA-Z0-9.]*)}/);var sp=/\${textKey:([^}]*)}/,ap={};function lp(e,t){if(t&&t.error)throw{error:t.error,url:e};up(t)}function up(e){Object.keys(e).forEach((function(t){hp(t).addAll(e[t])}),this)}function cp(e){var t;fp(e).forEach((function(e){var n=pp(e);n||dp(e,n=new ip),t&&t.setParent(n),t=n}),this)}function fp(e){var t=[],n=e.lastIndexOf("-");for(t.push(e);n>=0;)e=e.substring(0,n),t.push(e),n=e.lastIndexOf("-");return"default"!==e&&t.push("default"),t}function hp(e){var t=pp(e);if(t)return t;if(cp(e),!(t=pp(e)))throw new Error("Texts missing for the language tag "+e);return t}function pp(e){return ap[e]}function dp(e,t){ap[e]=t}function yp(e){var t=sp.exec(e);return t&&2===t.length?t[1]:e}function vp(e,t){var n=yp(e);return n!==e?hp(t).get(n):e}var bp={TEXT_KEY_REGEX:sp,bootstrap:function(e){var t=this;if(!e)return s.a.resolvedPromise({});var n=[];return rt.ensure(e).forEach((function(e){return n.push(s.a.ajaxJson(e).then(lp.bind(t,e)))})),s.a.promiseAll(n)},buildKey:function(e){return"${textKey:"+e+"}"},createOrderedLanguageTags:fp,get:hp,init:up,link:cp,put:dp,readFromDOM:function(){var e={};return s()("scout-text").each((function(){var t=s()(this).data("key"),n=s()(this).data("value");e[t]=n})),e},resolveKey:yp,resolveText:vp,resolveTextProperty:function(e,t,n){t=t||"text",n=e.session||n;var r=e[t],o=vp(r,n.locale.languageTag);o!==r&&(e[t]=o)},textsByLocale:ap};function mp(e){return(mp="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function gp(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function _p(e,t,n){return(_p="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Op(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function wp(e,t){return(wp=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function kp(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Op(e);if(t){var o=Op(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Sp(this,n)}}function Sp(e,t){return!t||"object"!==mp(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Op(e){return(Op=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Tp=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&wp(e,t)}(i,e);var t,n,r,o=kp(i);function i(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(e=o.call(this)).text=null,e.arrowPosition=25,e.arrowPositionUnit="%",e.windowPaddingX=10,e.windowPaddingY=5,e.origin=null,e.originRelativeToParent=!1,e.$anchor=null,e.autoRemove=!0,e.tooltipPosition="top",e.scrollType="position",e.htmlEnabled=!1,e.$content=null,e.menus=[],e._addWidgetProperties(["menus"]),e._openLater=!1,e}return t=i,r=[{key:"computeHypotenuse",value:function(e){return Math.sqrt(Math.pow(e,2)+Math.pow(e,2))}}],(n=[{key:"render",value:function(e){var t=e||this.entryPoint();if(!t||!t.length||!t.isAttached())return this._openLater=!0,void(this.$parent=t);_p(Op(i.prototype),"render",this).call(this,t)}},{key:"_render",value:function(){this.$container=this.$parent.appendDiv("tooltip").data("tooltip",this),this.cssClass&&this.$container.addClass(this.cssClass),this.$arrow=this.$container.appendDiv("tooltip-arrow"),this.$content=this.$container.appendDiv("tooltip-content"),this._renderText(),this._renderSeverity(),this._renderMenus(),this.autoRemove&&(this._mouseDownHandler=this._onDocumentMouseDown.bind(this),this.$container.document(!0).addEventListener("mousedown",this._mouseDownHandler,!0),this._keydownHandler=this._onDocumentKeyDown.bind(this),this.$container.document().on("keydown",this._keydownHandler)),this.$anchor&&this.scrollType&&(this._anchorScrollHandler=this._onAnchorScroll.bind(this),Lh.onScroll(this.$anchor,this._anchorScrollHandler)),this.dialog=null;for(var e=this.parent;e;){if(e instanceof CC&&e.isDialog()){this.dialog=e;break}e=e.parent}this.dialog&&(this._moveHandler=this.position.bind(this),this.dialog.on("move",this._moveHandler))}},{key:"_postRender",value:function(){_p(Op(i.prototype),"_postRender",this).call(this),this.position()}},{key:"_remove",value:function(){this._mouseDownHandler&&(this.$container.document(!0).removeEventListener("mousedown",this._mouseDownHandler,!0),this._mouseDownHandler=null),this._keydownHandler&&(this.$container.document().off("keydown",this._keydownHandler),this._keydownHandler=null),this._anchorScrollHandler&&(Lh.offScroll(this._anchorScrollHandler),this._anchorScrollHandler=null),this._moveHandler&&(this.dialog&&this.dialog.off("move",this._moveHandler),this._moveHandler=null),this.dialog=null,this.$menus=null,_p(Op(i.prototype),"_remove",this).call(this)}},{key:"_onAttach",value:function(){_p(Op(i.prototype),"_onAttach",this).call(this),this._openLater&&!this.rendered&&(this._openLater=!1,this.render())}},{key:"_renderOnDetach",value:function(){this._openLater=!0,this.remove(),_p(Op(i.prototype),"_onDetach",this).call(this)}},{key:"_isRemovalPrevented",value:function(){return!1}},{key:"setText",value:function(e){this.setProperty("text",e)}},{key:"setSeverity",value:function(e){this.setProperty("severity",e)}},{key:"_renderText",value:function(){var e=this.text||"";this.htmlEnabled?this.$content.html(e):this.$content.html(Wn.nl2br(e)),this.$content.setVisible(!!e),this.$container.toggleClass("no-text",!e),this.rendering||this.position()}},{key:"_renderSeverity",value:function(){this.$container.removeClass(Br.SEVERITY_CSS_CLASSES),this.$container.addClass(Br.cssClassForSeverity(this.severity))}},{key:"setMenus",value:function(e){e=rt.ensure(e),this.setProperty("menus",e)}},{key:"_renderMenus",value:function(){var e=0,t=this.menus;t.length>0&&!this.$menus?this.$menus=this.$container.appendDiv("tooltip-menus"):0===t.length&&this.$menus&&(this.$menus.remove(),this.$menus=null),t.forEach((function(t){var n=0;t.render(this.$menus),t.iconId&&(n=t.get$Icon().outerWidth(!0),e=Math.max(n,e))}),this),e>0&&t.forEach((function(t){t.iconId?t.$text.cssPaddingLeft(e-t.get$Icon().outerWidth(!0)):t.$text.cssPaddingLeft(e)}),this),this.rendering||this.position()}},{key:"position",value:function(){var e,t,n,r,o,s,a,l,u,c,f,h,p;if(s=this.origin?(l=this.origin).x:(l=qs.offsetBounds(this.$anchor)).x+l.width/2,a=l.y,this.$anchor&&(p=Lh.isLocationInView(l,this.$anchor.scrollParent()),this.$container.setVisible(p)),!this.originRelativeToParent){var d=this.$parent.offset();s-=d.left,a-=d.top}f=this.$arrow.outerWidth(),n=i.computeHypotenuse(f)/2,c=this.$container.outerHeight(),u=this.$container.outerWidth(),h=this.arrowPosition,"%"===this.arrowPositionUnit&&(h=u*this.arrowPosition/100),e=a-c-n,r=(t=s-h)+u+this.windowPaddingX-this.$parent.width(),o=e-this.windowPaddingY,r>0&&(h=s-(t-=r)),this.$arrow.removeClass("arrow-top arrow-bottom"),"bottom"===this.tooltipPosition||o<0?(this.$arrow.addClass("arrow-top"),e=a+l.height+n):this.$arrow.addClass("arrow-bottom"),h=Math.min(h,this.$container.outerWidth()-n),h=Math.max(h,n),this.$arrow.cssLeft(h),this.$container.cssLeft(t).cssTop(e),this.menus.forEach((function(e){e.popup&&e.popup.position()}),this)}},{key:"_onAnchorScroll",value:function(e){this.rendered&&("position"===this.scrollType?this.position():"remove"===this.scrollType&&this.destroy())}},{key:"_onDocumentMouseDown",value:function(e){if(!this.rendered)return!1;this._isMouseDownOutside(e)&&this._onMouseDownOutside(e)}},{key:"_isMouseDownOutside",value:function(e){var t=s()(e.target),n=O.widget(t);return!this.isOrHas(n)&&this.$anchor&&!this.$anchor.isOrHas(t[0])&&!this.session.focusManager.isElementCovertByGlassPane(this.$container[0])}},{key:"_onMouseDownOutside",value:function(){this.destroy()}},{key:"_onDocumentKeyDown",value:function(e){O.isOneOf(e.which,Ou.CTRL,Ou.SHIFT,Ou.ALT,Ou.NUM_LOCK,Ou.CAPS_LOCK,Ou.SCROLL_LOCK,Ou.WIN_LEFT,Ou.WIN_RIGHT,Ou.SELECT,Ou.PAUSE,Ou.PRINT_SCREEN)||this.destroy()}}])&&gp(t.prototype,n),r&&gp(t,r),i}(ve);function Cp(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Pp=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e);var n={selector:null,delay:xp.DEFAULT_TOOLTIP_DELAY,text:void 0,nativeTooltip:!1};t=s.a.extend({},n,t),this._options=t,this._mouseEnterHandler=this._onMouseEnter.bind(this),this._mouseLeaveHandler=this._onMouseLeave.bind(this),this._tooltip=null,this._tooltipTimeoutId=null}var t,n,r;return t=e,(n=[{key:"install",value:function(e){e.data("tooltipSupport")||e.on("mouseenter",this._options.selector,this._mouseEnterHandler).on("mouseleave",this._options.selector,this._mouseLeaveHandler).data("tooltipSupport",this)}},{key:"uninstall",value:function(e){e.removeData("tooltipSupport").off("mouseleave",this._options.selector,this._mouseLeaveHandler).off("mouseenter",this._options.selector,this._mouseEnterHandler),this._destroyTooltip()}},{key:"update",value:function(e,t){s.a.extend(this._options,t),this._tooltip&&this._showTooltip(e)}},{key:"cancel",value:function(e){clearTimeout(this._tooltipTimeoutId)}},{key:"close",value:function(){this._destroyTooltip()}},{key:"_onMouseEnter",value:function(e){var t=s()(e.currentTarget);if(this._options.nativeTooltip){var n=this._text(t);t.attr("title",n)}else clearTimeout(this._tooltipTimeoutId),this._tooltipTimeoutId=setTimeout(this._showTooltip.bind(this,t),this._options.delay)}},{key:"_onMouseLeave",value:function(e){this._destroyTooltip()}},{key:"_destroyTooltip",value:function(){clearTimeout(this._tooltipTimeoutId),this._tooltip&&(this._tooltip.destroy(),this._tooltip=null)}},{key:"_text",value:function(e){var t=this._options.text||e.data("tooltipText");return s.a.isFunction(t)&&(t=t(e)),t}},{key:"_htmlEnabled",value:function(e){var t=this._options.htmlEnabled||e.data("htmlEnabled");return s.a.isFunction(t)&&(t=t(e)),O.nvl(t,!1)}},{key:"_showTooltip",value:function(e){if(e&&e.isAttached()){var t=this._text(e);if(t){var n=this._htmlEnabled(e);if(this._tooltip&&this._tooltip.rendered)this._tooltip.setText(t),this._tooltip.setSeverity(this._options.severity),this._tooltip.setMenus(this._options.menus);else{var r=s.a.extend({},this._options,{$anchor:this._options.$anchor||e,text:t,htmlEnabled:n});this._tooltip=O.create("Tooltip",r),this._tooltip.render(r.$parent)}}}}}])&&Cp(t.prototype,n),r&&Cp(t,r),e}();function Rp(e,t){var n=e.data("tooltipSupport");n?n.update(e,t):(n=new Pp(t)).install(e)}var xp={DEFAULT_TOOLTIP_DELAY:600,LONG_TOOLTIP_DELAY:2e3,cancel:function(e){var t=e.data("tooltipSupport");t&&t.cancel(e)},close:function(e){var t=e.data("tooltipSupport");t&&t.close()},find:function(e){var t,n,r,o=[];for(t=s()(".tooltip",e.document(!0)),n=0;n<t.length;n++)r=t.eq(n).data("tooltip"),e.has(r.$anchor).length>0&&o.push(r);return o},install:Rp,installForEllipsis:function(e,t){var n={text:function(e){if(e.isContentTruncated())return e.text()},nativeTooltip:!Kt.get().isCustomEllipsisTooltipPossible()};Rp(e,t=s.a.extend({},n,t))},uninstall:function(e){var t=e.data("tooltipSupport");t&&t.uninstall(e)},update:function(e,t){var n=e.data("tooltipSupport");n&&n.update(e,t)}};function Ep(e){return(Ep="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Dp(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Ap(e,t,n){return(Ap="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Bp(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function Fp(e,t){return(Fp=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function $p(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Bp(e);if(t){var o=Bp(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return jp(this,n)}}function jp(e,t){return!t||"object"!==Ep(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Bp(e){return(Bp=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Mp=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Fp(e,t)}(i,e);var t,n,r,o=$p(i);function i(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(e=o.call(this)).$widgetContainer=null,e.widget=null,e._addWidgetProperties(["widget"]),e.keyStrokeStopPropagationInterceptor=function(e){O.isOneOf(e.which,Ou.ESC,Ou.ENTER)||e.stopPropagation()},e.withFocusContext=!0,e.initialFocus=function(){return Kf.AUTO},e.focusableContainer=!1,e}return t=i,(n=[{key:"_createKeyStrokeContext",value:function(){return new $u}},{key:"_initKeyStrokeContext",value:function(){Ap(Bp(i.prototype),"_initKeyStrokeContext",this).call(this),this.keyStrokeStopPropagationInterceptor&&this.keyStrokeContext.registerStopPropagationInterceptor(this.keyStrokeStopPropagationInterceptor)}},{key:"_render",value:function(){Ap(Bp(i.prototype),"_render",this).call(this),this.$container.addClass("widget-tooltip"),this.$widgetContainer=this.$container.appendDiv("tooltip-widget-container")}},{key:"_renderProperties",value:function(){Ap(Bp(i.prototype),"_renderProperties",this).call(this),this._renderWidget()}},{key:"_remove",value:function(){this._removeWidget(),Ap(Bp(i.prototype),"_remove",this).call(this)}},{key:"setWidget",value:function(e){this.setProperty("widget",e)}},{key:"_renderWidget",value:function(){this.widget&&(this.widget.render(this.$widgetContainer),this.widget.$container.addClass("widget"),this.widget.pack()),this.$widgetContainer.setVisible(!!this.widget),this.rendering||this.position(),this.withFocusContext&&this.widget&&this.session.focusManager.installFocusContext(this.$widgetContainer,this.initialFocus())}},{key:"_removeWidget",value:function(){this.widget&&(this.session.focusManager.uninstallFocusContext(this.$widgetContainer),this.widget.remove())}}])&&Dp(t.prototype,n),r&&Dp(t,r),i}(Tp);function Ip(e){return(Ip="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Lp(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Hp(e,t,n){return(Hp="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=zp(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function Np(e,t){return(Np=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Vp(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=zp(e);if(t){var o=zp(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Wp(this,n)}}function Wp(e,t){return!t||"object"!==Ip(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function zp(e){return(zp=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Gp(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Up=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Np(e,t)}(i,e);var t,n,r,o=Vp(i);function i(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(e=o.call(this)).actionStyle=i.ActionStyle.DEFAULT,e.compact=!1,e.iconId=null,e.horizontalAlignment=-1,e.keyStroke=null,e.keyStrokeFirePolicy=i.KeyStrokeFirePolicy.ACCESSIBLE_ONLY,e.selected=!1,e.preventDoubleClick=!1,e.tabbable=!1,e.text=null,e.textPosition=i.TextPosition.DEFAULT,e.textVisible=!0,e.toggleAction=!1,e.tooltipText=null,e.showTooltipWhenSelected=!0,e._doubleClickSupport=new Yt,e._addCloneProperties(["actionStyle","horizontalAlignment","iconId","selected","preventDoubleClick","tabbable","text","textPosition","tooltipText","toggleAction"]),e}return t=i,(n=[{key:"_createKeyStrokeContext",value:function(){return new $u}},{key:"_init",value:function(e){Hp(zp(i.prototype),"_init",this).call(this,e),this.actionKeyStroke=this._createActionKeyStroke(),this.resolveConsts([{property:"actionStyle",constType:i.ActionStyle},{property:"textPosition",constType:i.TextPosition},{property:"keyStrokeFirePolicy",constType:i.KeyStrokeFirePolicy}]),this.resolveTextKeys(["text","tooltipText"]),this.resolveIconIds(["iconId"]),this._setKeyStroke(this.keyStroke)}},{key:"_render",value:function(){var e=this;this.$container=this.$parent.appendDiv("action").on("mousedown",(function(t){return e._doubleClickSupport.mousedown(t)})).on("click",this._onClick.bind(this)),this.htmlComp=ea.install(this.$container,this.session),this.htmlComp.setLayout(this._createLayout())}},{key:"_createLayout",value:function(){return new Sl}},{key:"_renderProperties",value:function(){Hp(zp(i.prototype),"_renderProperties",this).call(this),this._renderText(),this._renderTextPosition(),this._renderIconId(),this._renderTooltipText(),this._renderKeyStroke(),this._renderSelected(),this._renderTabbable(),this._renderCompact()}},{key:"_remove",value:function(){this._removeText(),this._removeIconId(),Hp(zp(i.prototype),"_remove",this).call(this)}},{key:"setText",value:function(e){this.setProperty("text",e)}},{key:"_renderText",value:function(){var e=this.text||"";e&&this.textVisible?(this.$text||(this.$text=this.$container.appendSpan("content text"),ea.install(this.$text,this.session)),this.$text.text(e)):this._removeText()}},{key:"setTextPosition",value:function(e){this.setProperty("textPosition",e)}},{key:"_renderTextPosition",value:function(){this.$container.toggleClass("bottom-text",this.textPosition===i.TextPosition.BOTTOM),this.invalidateLayoutTree()}},{key:"_removeText",value:function(){this.$text&&(this.$text.remove(),this.$text=null)}},{key:"setIconId",value:function(e){this.setProperty("iconId",e)}},{key:"_renderIconId",value:function(){var e=this,t=this.iconId||"";t?this.icon?this.icon.setIconDesc(t):(this.icon=O.create("Icon",{parent:this,iconDesc:t,prepend:!0}),this.icon.one("destroy",(function(){e.icon=null})),this.icon.render()):this._removeIconId()}},{key:"get$Icon",value:function(){return this.icon?this.icon.$container:s()()}},{key:"_removeIconId",value:function(){this.icon&&this.icon.destroy()}},{key:"_renderEnabled",value:function(){Hp(zp(i.prototype),"_renderEnabled",this).call(this),this.rendered&&(this._updateTooltip(),this._renderTabbable())}},{key:"setTooltipText",value:function(e){this.setProperty("tooltipText",e)}},{key:"_renderTooltipText",value:function(){this._updateTooltip()}},{key:"_updateTooltip",value:function(){this._shouldInstallTooltip()?xp.install(this.$container,this._configureTooltip()):xp.uninstall(this.$container)}},{key:"_shouldInstallTooltip",value:function(){var e=this.tooltipText&&this.enabledComputed;return!this.showTooltipWhenSelected&&this.selected&&(e=!1),e}},{key:"_renderTabbable",value:function(){this.$container.setTabbable(this.tabbable&&this.enabledComputed&&!Kt.get().supportsOnlyTouch())}},{key:"_renderCompact",value:function(){this.$container.toggleClass("compact",this.compact),this.invalidateLayoutTree()}},{key:"setTooltipPosition",value:function(e){this.setProperty("tooltipPosition",e)}},{key:"_configureTooltip",value:function(){return{parent:this,text:this.tooltipText,$anchor:this.$container,arrowPosition:50,arrowPositionUnit:"%",tooltipPosition:this.tooltipPosition}}},{key:"doAction",value:function(){return!!this.prepareDoAction()&&(this.isToggleAction()&&this.setSelected(!this.selected),this._doAction(),!0)}},{key:"toggle",value:function(){this.isToggleAction()&&this.setSelected(!this.selected)}},{key:"setToggleAction",value:function(e){this.setProperty("toggleAction",e)}},{key:"isToggleAction",value:function(){return this.toggleAction}},{key:"prepareDoAction",value:function(){return!(!this.enabledComputed||!this.visible)}},{key:"_doAction",value:function(){this.trigger("action")}},{key:"setSelected",value:function(e){this.setProperty("selected",e)}},{key:"_renderSelected",value:function(){this.$container.toggleClass("selected",this.selected),this.rendered&&this._updateTooltip()}},{key:"setKeyStroke",value:function(e){this.setProperty("keyStroke",e)}},{key:"_setKeyStroke",value:function(e){this.actionKeyStroke.parseAndSetKeyStroke(e),this._setProperty("keyStroke",e)}},{key:"_renderKeyStroke",value:function(){var e=this.keyStroke;void 0===e?this.$container.removeAttr("data-shortcut"):this.$container.attr("data-shortcut",e)}},{key:"setTabbable",value:function(e){this.setProperty("tabbable",e)}},{key:"setTextVisible",value:function(e){this.textVisible!==e&&(this._setProperty("textVisible",e),this.rendered&&this._renderText())}},{key:"setCompact",value:function(e){this.compact!==e&&(this.compact=e,this.rendered&&this._renderCompact())}},{key:"setHorizontalAlignment",value:function(e){this.setProperty("horizontalAlignment",e)}},{key:"_createActionKeyStroke",value:function(){return new ld(this)}},{key:"setPreventDoubleClick",value:function(e){this.setProperty("preventDoubleClick",e)}},{key:"_allowMouseEvent",value:function(e){return!(1!==e.which||"click"===e.type&&this.preventDoubleClick&&this._doubleClickSupport.doubleClicked())}},{key:"_onClick",value:function(e){this._allowMouseEvent(e)&&(xp.cancel(this.$container),this.doAction())}},{key:"setActionStyle",value:function(e){this.setProperty("actionStyle",e)}}])&&Lp(t.prototype,n),r&&Lp(t,r),i}(ve);function Kp(e){return(Kp="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function qp(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Yp(e,t,n){return(Yp="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Qp(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function Xp(e,t){return(Xp=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Jp(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Qp(e);if(t){var o=Qp(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Zp(this,n)}}function Zp(e,t){return!t||"object"!==Kp(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Qp(e){return(Qp=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}Gp(Up,"ActionStyle",{DEFAULT:0,BUTTON:1}),Gp(Up,"TextPosition",{DEFAULT:"default",BOTTOM:"bottom"}),Gp(Up,"KeyStrokeFirePolicy",{ACCESSIBLE_ONLY:0,ALWAYS:1});var ed=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Xp(e,t)}(i,e);var t,n,r,o=Jp(i);function i(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(e=o.call(this))._addRemoteProperties(["selected"]),e}return t=i,(n=[{key:"_goOffline",value:function(){this._enabledBeforeOffline=this.widget.enabled,this.widget.setEnabled(!1)}},{key:"_goOnline",value:function(){this.widget.setEnabled(this._enabledBeforeOffline)}},{key:"_onWidgetAction",value:function(e){this.widget.isToggleAction()||this._send("action")}},{key:"_onWidgetEvent",value:function(e){"action"===e.type?this._onWidgetAction(e):Yp(Qp(i.prototype),"_onWidgetEvent",this).call(this,e)}}])&&qp(t.prototype,n),r&&qp(t,r),i}(de);function td(e){return(td="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function nd(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function rd(e,t,n){return(rd="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=ad(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function od(e,t){return(od=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function id(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=ad(e);if(t){var o=ad(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return sd(this,n)}}function sd(e,t){return!t||"object"!==td(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function ad(e){return(ad=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var ld=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&od(e,t)}(i,e);var t,n,r,o=id(i);function i(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(t=o.call(this)).field=e,t.parseAndSetKeyStroke(e.keyStroke),t.keyStrokeFirePolicy=e.keyStrokeFirePolicy,t.stopPropagation=!0,t.stopImmediatePropagation=!0,t}return t=i,(n=[{key:"_isEnabled",value:function(){return!!this.which.length&&rd(ad(i.prototype),"_isEnabled",this).call(this)}},{key:"handle",value:function(e){this.field.doAction()}}])&&nd(t.prototype,n),r&&nd(t,r),i}(zu);function ud(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var cd=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.$parent=null}var t,n,r;return t=e,(n=[{key:"render",value:function(e){this.$parent=e,this._render(),this.rendered=!0}},{key:"remove",value:function(){this.$container.remove(),this.$container=null,this.rendered=!1}},{key:"_render",value:function(){this.$container=s()("<div>").addClass("box").appendTo(this.$parent),this.$wrapper=s()("<div>").addClass("wrapper").appendTo(this.$container),this.$content=s()("<div>").addClass("box-content").appendTo(this.$wrapper),this.logoUrl&&(this.$header=this.$content.appendDiv("header"),this.$logo=s()("<img>").addClass("logo").attr("src",this.logoUrl).appendTo(this.$header))}}])&&ud(t.prototype,n),r&&ud(t,r),e}();function fd(e){return(fd="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function hd(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function pd(e,t,n){return(pd="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=bd(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function dd(e,t){return(dd=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function yd(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=bd(e);if(t){var o=bd(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return vd(this,n)}}function vd(e,t){return!t||"object"!==fd(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function bd(e){return(bd=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var md=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&dd(e,t)}(i,e);var t,n,r,o=yd(i);function i(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(e=o.call(this)).value=null,e.htmlEnabled=!1,e.scrollable=!1,e}return t=i,(n=[{key:"_createKeyStrokeContext",value:function(){return new $u}},{key:"_initKeyStrokeContext",value:function(){pd(bd(i.prototype),"_initKeyStrokeContext",this).call(this),this.keyStrokeContext.registerKeyStroke(new FW(this,this._onAppLinkAction))}},{key:"_init",value:function(e){pd(bd(i.prototype),"_init",this).call(this,e),this.resolveTextKeys(["value"])}},{key:"_render",value:function(){this.$container=this.$parent.appendDiv(),this.htmlComp=ea.install(this.$container,this.session)}},{key:"_renderProperties",value:function(){pd(bd(i.prototype),"_renderProperties",this).call(this),this._renderValue(),this._renderScrollable()}},{key:"setValue",value:function(e){this.setProperty("value",e)}},{key:"_renderValue",value:function(){var e=this.value||"";this.htmlEnabled?(this.$container.html(e),this.$container.find(".app-link").on("click",this._onAppLinkAction.bind(this)),this.$container.find("img").on("load",this._onImageLoad.bind(this)).on("error",this._onImageError.bind(this))):this.$container.html(Wn.nl2br(e)),this.rendered&&(this._uninstallScrollbars(),this._renderScrollable()),this.invalidateLayoutTree()}},{key:"setHtmlEnabled",value:function(e){this.setProperty("htmlEnabled",e)}},{key:"_renderHtmlEnabled",value:function(){this._renderValue()}},{key:"setScrollable",value:function(e){this.setProperty("scrollable",e)}},{key:"_renderScrollable",value:function(){this.scrollable?this._installScrollbars():this._uninstallScrollbars()}},{key:"_onAppLinkAction",value:function(e){var t=s()(e.delegateTarget).data("ref");this.triggerAppLinkAction(t)}},{key:"triggerAppLinkAction",value:function(e){this.trigger("appLinkAction",{ref:e})}},{key:"_onImageLoad",value:function(e){this.invalidateLayoutTree()}},{key:"_onImageError",value:function(e){this.invalidateLayoutTree()}}])&&hd(t.prototype,n),r&&hd(t,r),i}(ve);function gd(e){return(gd="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _d(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function wd(e,t,n){return(wd="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Td(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function kd(e,t){return(kd=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Sd(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Td(e);if(t){var o=Td(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Od(this,n)}}function Od(e,t){return!t||"object"!==gd(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Td(e){return(Td=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Cd=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&kd(e,t)}(i,e);var t,n,r,o=Sd(i);function i(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),o.call(this)}return t=i,(n=[{key:"_onWidgetAppLinkAction",value:function(e){this._send("appLinkAction",{ref:e.ref})}},{key:"_onWidgetEvent",value:function(e){"appLinkAction"===e.type?this._onWidgetAppLinkAction(e):wd(Td(i.prototype),"_onWidgetEvent",this).call(this,e)}}])&&_d(t.prototype,n),r&&_d(t,r),i}(de);function Pd(e){return(Pd="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Rd(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function xd(e,t,n){return(xd="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=$d(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function Ed(e,t){return(Ed=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Dd(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=$d(e);if(t){var o=$d(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Ad(this,n)}}function Ad(e,t){return!t||"object"!==Pd(t)&&"function"!=typeof t?Fd(e):t}function Fd(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function $d(e){return($d=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function jd(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Bd,Md,Id=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ed(e,t)}(i,e);var t,n,r,o=Dd(i);function i(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(e=o.call(this))._documentMouseDownHandler=null,e._anchorScrollHandler=null,e._anchorLocationChangeHandler=null,e._popupOpenHandler=null,e._glassPaneRenderer=null,e.anchorBounds=null,e.animateOpening=!1,e.animateResize=!1,e.anchor=null,e.$anchor=null,e.windowPaddingX=10,e.windowPaddingY=5,e.withGlassPane=!1,e.withFocusContext=!0,e.initialFocus=function(){return Kf.AUTO},e.focusableContainer=!1,e.horizontalAlignment=i.Alignment.LEFTEDGE,e.verticalAlignment=i.Alignment.BOTTOM,e.calculatedHorizontalAlignment=e.horizontalAlignment,e.calculatedVerticalAlignment=e.verticalAlignment,e.horizontalSwitch=!1,e.verticalSwitch=!0,e.trimWidth=!1,e.trimHeight=!0,e.scrollType="remove",e.windowResizeType=null,e.boundToAnchor=!0,e.withArrow=!1,e.closeOnAnchorMouseDown=!0,e.closeOnMouseDownOutside=!0,e.closeOnOtherPopupOpen=!0,e._openLater=!1,e.$arrow=null,e.$arrowOverlay=null,e._windowResizeHandler=e._onWindowResize.bind(Fd(e)),e._anchorRenderHandler=e._onAnchorRender.bind(Fd(e)),e._addWidgetProperties(["anchor"]),e._addPreserveOnPropertyChangeProperties(["anchor"]),e}return t=i,(n=[{key:"_init",value:function(e){xd($d(i.prototype),"_init",this).call(this,e),e.location&&(this.anchorBounds=new Hs(e.location.x,e.location.y,0,0)),this.withGlassPane&&(this._glassPaneRenderer=new ih(this)),this._setAnchor(this.anchor)}},{key:"_createKeyStrokeContext",value:function(){return new $u}},{key:"_initKeyStrokeContext",value:function(){xd($d(i.prototype),"_initKeyStrokeContext",this).call(this),this.keyStrokeContext.registerKeyStroke(this._createCloseKeyStroke())}},{key:"_createCloseKeyStroke",value:function(){return new Pc(this)}},{key:"_createLayout",value:function(){return new Qd(this)}},{key:"_openWithoutParent",value:function(){var e=this,t=this.parent;t.destroyed||(t.rendered||t.rendering?this.open(t.entryPoint()):t.one("render",(function(){e.session.layoutValidator.schedulePostValidateFunction((function(){e.destroyed||e.rendered||e.open()}))})))}},{key:"open",value:function(e){var t=this;e?(this._triggerPopupOpenEvent(),this._open(e),this._openLater||(this.validateFocus(),this.animateOpening&&(this.$container.addClass("invisible"),setTimeout((function(){t.rendered&&!t.removing&&(t.$container.removeClass("invisible"),t.$container.addClassForAnimation("animate-open"))}))))):this._openWithoutParent()}},{key:"validateFocus",value:function(){if(this.withFocusContext){var e=this.session.focusManager.getFocusContext(this.$container);e.ready(),e.lastValidFocusedElement||this._requestInitialFocus()}}},{key:"_requestInitialFocus",value:function(){var e=this.session.focusManager.evaluateFocusRule(this.$container,this.initialFocus());e&&this.session.focusManager.requestFocus(e)}},{key:"_open",value:function(e){this.render(e),this._openLater||(this.revalidateLayout(),this.position())}},{key:"render",value:function(e){var t=e||this.entryPoint();t&&t.length&&t.isAttached()?xd($d(i.prototype),"render",this).call(this,t):this._openLater=!0}},{key:"_render",value:function(){this.$container=this.$parent.appendDiv("popup"),this.htmlComp=ea.install(this.$container,this.session),this.htmlComp.validateRoot=!0,this.htmlComp.setLayout(this._createLayout()),this.$container.window().on("resize",this._windowResizeHandler)}},{key:"_renderProperties",value:function(){xd($d(i.prototype),"_renderProperties",this).call(this),this._renderAnchor(),this._renderWithArrow(),this._renderWithFocusContext(),this._renderWithGlassPane()}},{key:"_postRender",value:function(){xd($d(i.prototype),"_postRender",this).call(this),this.size(),this._attachCloseHandlers(),this._attachAnchorHandlers(),this._handleGlassPanes()}},{key:"_onAttach",value:function(){xd($d(i.prototype),"_onAttach",this).call(this),this._openLater&&!this.rendered&&(this._openLater=!1,this.open())}},{key:"_renderOnDetach",value:function(){this._openLater=!0,this.remove(),xd($d(i.prototype),"_renderOnDetach",this).call(this)}},{key:"remove",value:function(){var e=this.animateRemoval;this.boundToAnchor&&this.$anchor&&!this._isAnchorInView()&&(this.animateRemoval=!1),xd($d(i.prototype),"remove",this).call(this),this.animateRemoval=e}},{key:"_remove",value:function(){this.$container.window().off("resize",this._windowResizeHandler),this._glassPaneRenderer&&this._glassPaneRenderer.removeGlassPanes(),this.withFocusContext&&this.session.focusManager.uninstallFocusContext(this.$container),this.$arrow&&(this.$arrow.remove(),this.$arrow=null),this.anchor&&this.anchor.one("render",this._anchorRenderHandler),this._detachAnchorHandlers(),this._detachCloseHandlers(),xd($d(i.prototype),"_remove",this).call(this)}},{key:"_destroy",value:function(){this.anchor&&this.anchor.off("render",this._anchorRenderHandler),xd($d(i.prototype),"_destroy",this).call(this)}},{key:"_renderWithFocusContext",value:function(){this.withFocusContext&&this.session.focusManager.installFocusContext(this.$container,Kf.PREPARE),this.withFocusContext&&this.focusableContainer&&this.$container.attr("tabindex",-1)}},{key:"_renderWithGlassPane",value:function(){this._glassPaneRenderer&&this._glassPaneRenderer.renderGlassPanes()}},{key:"setWithArrow",value:function(e){this.setProperty("withArrow",e)}},{key:"_renderWithArrow",value:function(){this.$arrow&&(this.$arrow.remove(),this.$arrow=null),this.$arrowOverlay&&(this.$arrowOverlay.remove(),this.$arrowOverlay=null),this.withArrow&&(this.$arrowOverlay=this.$container.prependDiv("popup-arrow-overlay"),this.$arrow=this.$container.prependDiv("popup-arrow"),this._updateArrowClass()),this.$container.toggleClass("with-arrow",this.withArrow),this.invalidateLayoutTree()}},{key:"_updateArrowClass",value:function(e,t){this.$arrow&&(this.$arrow.removeClass(this._alignClasses()),this.$arrow.addClass(this._computeArrowPositionClass(e,t)))}},{key:"_computeArrowPositionClass",value:function(e,t){var n=i.Alignment,r="";switch(t=t||this.horizontalAlignment,e=e||this.verticalAlignment,t){case n.LEFT:r=n.RIGHT;break;case n.RIGHT:r=n.LEFT;break;default:r=t}switch(e){case n.BOTTOM:r+=" "+n.TOP;break;case n.TOP:r+=" "+n.BOTTOM;break;default:r+=" "+e}return r}},{key:"_isRemovalPrevented",value:function(){return!1}},{key:"close",value:function(){var e=new sn;this.trigger("close",e),e.defaultPrevented||this.destroy()}},{key:"_attachCloseHandlers",value:function(){this.closeOnMouseDownOutside&&(this._documentMouseDownHandler=this._onDocumentMouseDown.bind(this),this.$container.document(!0).addEventListener("mousedown",this._documentMouseDownHandler,!0)),this.closeOnOtherPopupOpen&&(this._popupOpenHandler=this._onPopupOpen.bind(this),this.session.desktop.on("popupOpen",this._popupOpenHandler))}},{key:"_attachAnchorHandlers",value:function(){if(this.$anchor&&this.boundToAnchor&&this.scrollType){this._anchorScrollHandler=this._onAnchorScroll.bind(this),Lh.onScroll(this.$anchor,this._anchorScrollHandler);var e=O.widget(this.$anchor);e&&(this._anchorLocationChangeHandler=this._onAnchorLocationChange.bind(this),e.on("locationChange",this._anchorLocationChangeHandler))}}},{key:"_detachAnchorHandlers",value:function(){if(this._anchorScrollHandler&&(Lh.offScroll(this._anchorScrollHandler),this._anchorScrollHandler=null),this._anchorLocationChangeHandler){var e=O.widget(this.$anchor);e&&(e.off("locationChange",this._anchorLocationChangeHandler),this._anchorLocationChangeHandler=null)}}},{key:"_detachCloseHandlers",value:function(){this._popupOpenHandler&&(this.session.desktop.off("popupOpen",this._popupOpenHandler),this._popupOpenHandler=null),this._documentMouseDownHandler&&(this.$container.document(!0).removeEventListener("mousedown",this._documentMouseDownHandler,!0),this._documentMouseDownHandler=null)}},{key:"_onDocumentMouseDown",value:function(e){this.rendered&&this._isMouseDownOutside(e)&&this._onMouseDownOutside(e)}},{key:"_isMouseDownOutside",value:function(e){var t,n=s()(e.target);return!(!this.closeOnAnchorMouseDown&&this._isMouseDownOnAnchor(e)||(t=O.widget(n),this.isOrHas(t)||this.session.focusManager.isElementCovertByGlassPane(this.$container[0])))}},{key:"_isMouseDownOnAnchor",value:function(e){return!!this.$anchor&&this.$anchor.isOrHas(e.target)}},{key:"_onMouseDownOutside",value:function(e){this.close()}},{key:"_onAnchorScroll",value:function(e){this.rendered&&this._handleAnchorPositionChange()}},{key:"_handleAnchorPositionChange",value:function(e){O.isOneOf(this.scrollType,"position","layoutAndPosition")&&this.isOpeningAnimationRunning()||("position"===this.scrollType?this.position():"layoutAndPosition"===this.scrollType?(this.revalidateLayout(),this.position()):"remove"===this.scrollType&&this.close())}},{key:"isOpeningAnimationRunning",value:function(){return this.rendered&&this.animateOpening&&this.$container.hasClass("animate-open")}},{key:"_onAnchorLocationChange",value:function(e){this._handleAnchorPositionChange()}},{key:"_onPopupOpen",value:function(e){var t=!this.isOrHas(e.popup)&&!e.popup.isOrHas(this);this.rendered&&(t=t&&!this.session.focusManager.isElementCovertByGlassPane(this.$container[0])),t&&this.close()}},{key:"setHorizontalAlignment",value:function(e){this.setProperty("horizontalAlignment",e)}},{key:"_renderHorizontalAlignment",value:function(){this._updateArrowClass(),this.invalidateLayoutTree()}},{key:"setVerticalAlignment",value:function(e){this.setProperty("verticalAlignment",e)}},{key:"_renderVerticalAlignment",value:function(){this._updateArrowClass(),this.invalidateLayoutTree()}},{key:"setHorizontalSwitch",value:function(e){this.setProperty("horizontalSwitch",e)}},{key:"_renderHorizontalSwitch",value:function(){this.invalidateLayoutTree()}},{key:"setVerticalSwitch",value:function(e){this.setProperty("verticalSwitch",e)}},{key:"_renderVerticalSwitch",value:function(){this.invalidateLayoutTree()}},{key:"setTrimWidth",value:function(e){this.setProperty("trimWidth",e)}},{key:"_renderTrimWidth",value:function(){this.invalidateLayoutTree()}},{key:"setTrimHeight",value:function(e){this.setProperty("trimHeight",e)}},{key:"_renderTrimHeight",value:function(){this.invalidateLayoutTree()}},{key:"prefLocation",value:function(e,t){return this.boundToAnchor&&(this.anchorBounds||this.$anchor)?this._prefLocationWithAnchor(e,t):this._prefLocationWithoutAnchor()}},{key:"_prefLocationWithoutAnchor",value:function(){return jR.positionContainerInWindow(this.$container)}},{key:"_prefLocationWithAnchor",value:function(e,t){var n=this.$container;t=t||this.horizontalAlignment,e=e||this.verticalAlignment;var r=this.getAnchorBounds(),o=qs.size(n),s=qs.margins(n),a=i.Alignment,l=null;this.$arrow&&(this._updateArrowClass(e,t),qs.setMargins(this.$arrow,new Bs),l=qs.bounds(this.$arrow)),n.removeClass(this._alignClasses()),n.addClass(e+" "+t);var u=o.width+s.horizontal(),c=o.width,f=r.x;t===a.LEFT?f-=u:t===a.LEFTEDGE?this.withArrow?f+=r.width/2-l.center().x-s.left:f=r.x-s.left:t===a.CENTER?f+=r.width/2-c/2-s.left:t===a.RIGHT?f+=r.width:t===a.RIGHTEDGE&&(this.withArrow?f+=r.width/2-l.center().x-s.right:f=r.x+r.width-c-s.right);var h=o.height+s.vertical(),p=o.height,d=r.y;e===a.TOP?d-=h:e===a.TOPEDGE?this.withArrow?d+=r.height/2-l.center().y-s.top:d=r.y-s.top:e===a.CENTER?d+=r.height/2-p/2-s.top:e===a.BOTTOM?d+=r.height:e===a.BOTTOMEDGE&&(this.withArrow?d+=r.height/2-l.center().y-s.bottom:d=r.y+r.height-p-s.bottom);var y=this.$parent.offset();return f-=y.left,d-=y.top,new Is(f,d)}},{key:"_alignClasses",value:function(){var e=i.Alignment;return Wn.join(" ",e.LEFT,e.LEFTEDGE,e.CENTER,e.RIGHT,e.RIGHTEDGE,e.TOP,e.TOPEDGE,e.CENTER,e.BOTTOM,e.BOTTOMEDGE)}},{key:"getAnchorBounds",value:function(){var e=this.anchorBounds;if(!this.$anchor)return e;var t=qs.offsetBounds(this.$anchor,{exact:!0});return e?(e.x||(e.x=t.x,e.width=t.width),e.y||(e.y=t.y,e.height=t.height)):e=t,e}},{key:"getWindowSize",value:function(){var e=this.$parent.window();return new $s(e.width(),e.height())}},{key:"overlap",value:function(e,t){var n=this.$container;if(!n||!e)return null;t=O.nvl(t,!0);var r=n.outerHeight(t),o=n.outerWidth(t),i=new Hs(e.x,e.y,o,r),s=qs.offsetBounds(n.entryPoint(),!0),a=i.right()+this.windowPaddingX-s.width;a<0&&(a=Math.min(i.x-this.windowPaddingX-s.x,0));var l=i.bottom()+this.windowPaddingY-s.height;return l<0&&(l=Math.min(i.y-this.windowPaddingY-s.y,0)),new Is(a,l)}},{key:"adjustLocation",value:function(e,t){this.calculatedVerticalAlignment=this.verticalAlignment,this.calculatedHorizontalAlignment=this.horizontalAlignment;var n=this.overlap(e);return this.$arrow&&(this._updateArrowClass(this.calculatedVerticalAlignment,this.calculatedHorizontalAlignment),qs.setMargins(this.$arrow,new Bs)),e=e.clone(),0!==n.y&&(O.nvl(t,this.verticalSwitch)?(this.calculatedVerticalAlignment=i.SwitchRule[this.calculatedVerticalAlignment],e.y=this.prefLocation(this.calculatedVerticalAlignment).y):e.y-=n.y),0!==n.x&&(O.nvl(t,this.horizontalSwitch)?(this.calculatedHorizontalAlignment=i.SwitchRule[this.calculatedHorizontalAlignment],e.x=this.prefLocation(this.calculatedVerticalAlignment,this.calculatedHorizontalAlignment).x):e.x-=n.x),this.$arrow&&(0!==n.y&&(this.$arrow.hasClass(i.Alignment.LEFT)||this.$arrow.hasClass(i.Alignment.RIGHT))&&(n.y>0?this.$arrow.cssMarginTop(n.y):this.$arrow.cssMarginBottom(-n.y)),0!==n.x&&(this.$arrow.hasClass(i.Alignment.TOP)||this.$arrow.hasClass(i.Alignment.BOTTOM))&&(n.x>0?this.$arrow.cssMarginLeft(n.x):this.$arrow.cssMarginRight(-n.x))),e}},{key:"size",value:function(){var e=this.prefSize(this.$container);e&&qs.setSize(this.$container,e)}},{key:"prefSize",value:function(e){return null}},{key:"position",value:function(e){this.rendered&&(this._validateVisibility(),this._position(e))}},{key:"_position",value:function(e){var t=this.prefLocation();t&&(t=this.adjustLocation(t,e),this.setLocation(t))}},{key:"setLocation",value:function(e){this.rendered&&(this.$container.css("left",e.x).css("top",e.y),this._triggerLocationChange())}},{key:"_validateVisibility",value:function(){if(this.boundToAnchor&&this.$anchor){var e=this._isAnchorInView(),t=this.$container.hasClass("invisible")===e&&e;if(this.$container.toggleClass("invisible",!e),t){var n=this.animateResize;this.animateResize=!1,this.revalidateLayout(),this.animateResize=n,this.withFocusContext&&this.session.focusManager.validateFocus()}}}},{key:"_isAnchorInView",value:function(){if(this.boundToAnchor&&this.$anchor){var e=this.getAnchorBounds();return Lh.isLocationInView(e.center(),this.$anchor.scrollParent())}}},{key:"_triggerLocationChange",value:function(){this.trigger("locationChange")}},{key:"_triggerPopupOpenEvent",value:function(){this.session.desktop.trigger("popupOpen",{popup:this})}},{key:"belongsTo",value:function(e){return this.$anchor[0]===e[0]}},{key:"set$Anchor",value:function(e){this.$anchor&&this._detachAnchorHandlers(),this.setProperty("$anchor",e),this.rendered&&(this._attachAnchorHandlers(),this.revalidateLayout(),this.animateResize||this.position())}},{key:"isOpen",value:function(){return this.rendered}},{key:"ensureOpen",value:function(){this.isOpen()||this.open()}},{key:"setAnchor",value:function(e){this.setProperty("anchor",e)}},{key:"_setAnchor",value:function(e){e&&this.setParent(e),this._setProperty("anchor",e)}},{key:"_onAnchorRender",value:function(){var e=this;this.session.layoutValidator.schedulePostValidateFunction((function(){if(!e.rendered&&!e.destroyed)if(!e.anchor||e.anchor.rendered){var t=e.animateOpening;e.animateOpening=!1,e.open(),e.animateOpening=t}else e.anchor.one("render",e._anchorRenderHandler)}))}},{key:"_renderAnchor",value:function(){this.anchor&&this.set$Anchor(this.anchor.$container)}},{key:"_onWindowResize",value:function(){this.rendered&&("position"===this.windowResizeType?this.position():"layoutAndPosition"===this.windowResizeType?(this.revalidateLayoutTree(!1),this.position()):"remove"===this.windowResizeType&&this.close())}},{key:"_handleGlassPanes",value:function(){this.session.focusManager.isElementCovertByGlassPane(this.parent.$container)&&this.session.focusManager.rerenderGlassPanes()}}])&&Rd(t.prototype,n),r&&Rd(t,r),i}(ve);function Ld(e){return(Ld="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Hd(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Nd(e,t,n){return(Nd="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Gd(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function Vd(e,t){return(Vd=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Wd(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Gd(e);if(t){var o=Gd(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return zd(this,n)}}function zd(e,t){return!t||"object"!==Ld(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Gd(e){return(Gd=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}jd(Id,"Alignment",{LEFT:"left",LEFTEDGE:"leftedge",TOP:"top",TOPEDGE:"topedge",CENTER:"center",RIGHT:"right",RIGHTEDGE:"rightedge",BOTTOM:"bottom",BOTTOMEDGE:"bottomedge"}),jd(Id,"SwitchRule",{}),Bd=Id.SwitchRule,Md=Id.Alignment,Bd[Md.LEFT]=Md.RIGHT,Bd[Md.LEFTEDGE]=Md.RIGHTEDGE,Bd[Md.TOP]=Md.BOTTOM,Bd[Md.TOPEDGE]=Md.BOTTOMEDGE,Bd[Md.CENTER]=Md.CENTER,Bd[Md.RIGHT]=Md.LEFT,Bd[Md.RIGHTEDGE]=Md.LEFTEDGE,Bd[Md.BOTTOM]=Md.TOP,Bd[Md.BOTTOMEDGE]=Md.TOPEDGE;var Ud=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Vd(e,t)}(i,e);var t,n,r,o=Wd(i);function i(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),o.call(this)}return t=i,(n=[{key:"_onWidgetClose",value:function(e){e.preventDefault(),this._send("close")}},{key:"_onWidgetEvent",value:function(e){"close"===e.type?this._onWidgetClose(e):Nd(Gd(i.prototype),"_onWidgetEvent",this).call(this,e)}}])&&Hd(t.prototype,n),r&&Hd(t,r),i}(de);function Kd(e){return(Kd="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function qd(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Yd(e,t){return(Yd=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Xd(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Zd(e);if(t){var o=Zd(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Jd(this,n)}}function Jd(e,t){return!t||"object"!==Kd(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Zd(e){return(Zd=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Qd=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Yd(e,t)}(i,e);var t,n,r,o=Xd(i);function i(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(t=o.call(this)).popup=e,t.doubleCalcPrefSize=!0,t.autoPosition=!0,t.autoSize=!0,t}return t=i,(n=[{key:"layout",value:function(e){if(this.popup.isOpeningAnimationRunning())this.popup.$container.oneAnimationEnd(this.layout.bind(this,e));else if(!this.popup.removalPending&&!this.popup.removing&&this.popup.rendered)if(this.autoSize){var t=this.popup.htmlComp,n=qs.bounds(t.$comp),r=this.preferredLayoutSize(e,{exact:!0,onlyWidth:this.doubleCalcPrefSize});r=this.adjustSize(r),this.doubleCalcPrefSize&&(r=this.preferredLayoutSize(e,{exact:!0,widthHint:r.width-t.insets().horizontal()}),r=this.adjustSize(r)),this._setSize(r),t.layouted&&this.popup.animateResize&&this._resizeAnimated(n,r)}else this._setSize(this.popup.htmlComp.size({exact:!0}))}},{key:"_resizeAnimated",value:function(e,t){this._position();var n=this.popup.htmlComp,r=n.$comp.position(),o=new Hs(r.left,r.top,Math.ceil(t.width),Math.ceil(t.height));e.equals(o)||n.$comp.stop(!0).cssHeight(e.height).cssWidth(e.width).cssLeft(e.x).cssTop(e.y).animate({height:t.height,width:t.width,left:r.left,top:r.top},{complete:function(){this.popup.rendered&&this._position()}.bind(this)})}},{key:"_position",value:function(e){this.autoPosition&&this.popup.position(e)}},{key:"_setSize",value:function(e){qs.setSize(this.popup.htmlComp.$comp,e)}},{key:"adjustSize",value:function(e){return this.popup.htmlComp._adjustPrefSizeWithMinMaxSize(e),this.popup.boundToAnchor&&(this.popup.anchorBounds||this.popup.$anchor)?this._adjustSizeWithAnchor(e):this._adjustSize(e)}},{key:"_adjustSize",value:function(e){var t=new $s,n=this._calcMaxSize();return t.width=Math.min(n.width,e.width),t.height=Math.min(n.height,e.height),t}},{key:"_calcMaxSize",value:function(){this.popup.repositionEnabled&&this._position(!1);var e,t,n=this.popup.htmlComp,r=this.popup.windowPaddingX,o=this.popup.windowPaddingY,i=n.margins(),s=this.popup.getWindowSize();return e=s.width-i.horizontal()-r,t=s.height-i.vertical()-o,new $s(e,t)}},{key:"_adjustSizeWithAnchor",value:function(e){var t=new $s,n=this._calcMaxSizeAroundAnchor(),r=this._calcMaxSize(),o=Id.Alignment,i=this.popup.horizontalAlignment,s=this.popup.verticalAlignment;return n=n.floor(),t.width=e.width,this.popup.trimWidth&&(this.popup.horizontalSwitch?e.width>n.right&&e.width>n.left&&(t.width=Math.max(n.right,n.left)):i===o.RIGHT?t.width=Math.min(t.width,n.right):i===o.LEFT?t.width=Math.min(t.width,n.left):t.width=Math.min(t.width,r.width)),t.height=e.height,this.popup.trimHeight&&(this.popup.verticalSwitch?e.height>n.bottom&&e.height>n.top&&(t.height=Math.max(n.bottom,n.top)):s===o.BOTTOM?t.height=Math.min(t.height,n.bottom):s===o.TOP?t.height=Math.min(t.height,n.top):t.height=Math.min(t.height,r.height)),s!==o.CENTER&&i!==o.CENTER||(i===o.CENTER&&(t.width=Math.min(r.width,e.width)),s===o.CENTER&&(t.height=Math.min(r.height,e.height))),t}},{key:"_calcMaxSizeAroundAnchor",value:function(){this.popup.repositionEnabled&&this._position(!1);var e,t,n,r,o=this.popup.htmlComp,i=this.popup.windowPaddingX,s=this.popup.windowPaddingY,a=o.margins(),l=this.popup.getAnchorBounds(),u=this.popup.getWindowSize(),c=this.popup.horizontalAlignment,f=this.popup.verticalAlignment,h=Id.Alignment;return O.isOneOf(c,h.LEFTEDGE,h.RIGHTEDGE)?(t=u.width-l.x-a.horizontal()-i,e=l.right()-a.horizontal()-i):(t=u.width-l.right()-a.horizontal()-i,e=l.x-a.horizontal()-i),O.isOneOf(f,h.BOTTOMEDGE,h.TOPEDGE)?(n=u.height-l.y-a.vertical()-s,r=l.bottom()-a.vertical()-s):(n=u.height-l.bottom()-a.vertical()-s,r=l.y-a.vertical()-s),new Bs(r,t,n,e)}}])&&qd(t.prototype,n),r&&qd(t,r),i}(Zs);function ey(e){return(ey="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ty(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ny(e,t,n){return(ny="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=sy(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function ry(e,t){return(ry=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function oy(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=sy(e);if(t){var o=sy(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return iy(this,n)}}function iy(e,t){return!t||"object"!==ey(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function sy(e){return(sy=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var ay=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ry(e,t)}(i,e);var t,n,r,o=oy(i);function i(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(e=o.call(this)).popups=[],e._addWidgetProperties(["popups"]),e._addPreserveOnPropertyChangeProperties(["popups"]),e}return t=i,(n=[{key:"_init",value:function(e){var t=this;ny(sy(i.prototype),"_init",this).call(this,e),this.session.layoutValidator.schedulePostValidateFunction((function(){t._openPopups(t.popups)}))}},{key:"setPopups",value:function(e){this.setProperty("popups",e)}},{key:"_setPopups",value:function(e){var t=this;this._openPopups(rt.diff(e,this.popups)),this._destroyPopups(rt.diff(this.popups,e)),this._setProperty("popups",e),this.popups.forEach((function(e){e.parent instanceof scout.PopupManager&&e.setParent(t.session.desktop)}))}},{key:"_openPopups",value:function(e){e.forEach((function(e){e.open()}))}},{key:"_destroyPopups",value:function(e){e.forEach((function(e){e.destroy()}))}}])&&ty(t.prototype,n),r&&ty(t,r),i}(ve);function ly(e){return(ly="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function uy(e,t){return(uy=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function cy(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=hy(e);if(t){var o=hy(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return fy(this,n)}}function fy(e,t){return!t||"object"!==ly(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function hy(e){return(hy=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var py=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&uy(e,t)}(n,e);var t=cy(n);function n(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),t.call(this)}return n}(de);function dy(e){return(dy="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function yy(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function vy(e,t,n){return(vy="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=_y(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function by(e,t){return(by=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function my(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=_y(e);if(t){var o=_y(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return gy(this,n)}}function gy(e,t){return!t||"object"!==dy(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function _y(e){return(_y=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var wy=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&by(e,t)}(i,e);var t,n,r,o=my(i);function i(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(e=o.call(this)).$head,e.$body,e.$deco,e.$parent,e.horizontalSwitch=!0,e.verticalSwitch=!0,e._headVisible=!0,e.windowResizeType="remove",e}return t=i,(n=[{key:"_createLayout",value:function(){return new xy(this)}},{key:"_init",value:function(e){vy(_y(i.prototype),"_init",this).call(this,e),this.trimWidth=O.nvl(e.trimWidth,this._headVisible)}},{key:"_render",value:function(){vy(_y(i.prototype),"_render",this).call(this),this._$createBody(),this._headVisible&&this._renderHead()}},{key:"_postRender",value:function(){vy(_y(i.prototype),"_postRender",this).call(this),Lh.update(this.$body)}},{key:"_$createBody",value:function(){this.$body=this.$container.appendDiv("popup-body"),ea.install(this.$body,this.session).setLayout(this._createBodyLayout()),this._modifyBody()}},{key:"_createBodyLayout",value:function(){return new Sl}},{key:"rerenderHead",value:function(){this._removeHead(),this._renderHead()}},{key:"_renderHead",value:function(){this.$deco=this.$container.makeDiv("popup-deco"),this.$head=this.$container.makeDiv("popup-head menu-item").on("mousedown","",this._onHeadMouseDown.bind(this)),this.$container.prepend(this.$head).append(this.$deco),this.$headBlueprint&&(this.$head.html(this.$headBlueprint.html()),this._copyStyleToHeadChildren())}},{key:"_modifyBody",value:function(){}},{key:"_removeHead",value:function(){this.$head&&this.$head.remove(),this.$deco&&this.$deco.remove()}},{key:"_copyCssClassToHead",value:function(e){this.$headBlueprint&&this.$headBlueprint.hasClass(e)&&this.$head.addClass(e)}},{key:"_copyStyleToHeadChildren",value:function(){var e=this.$headBlueprint.children();this.$head.children().each((function(t){var n=s()(this),r=e.eq(t);n.copyCss(r,"margin padding line-height border vertical-align font-size display width height")}))}},{key:"_onHeadMouseDown",value:function(e){this.$head&&this.$head.isOrHas(e.target)&&this.close()}},{key:"_isMouseDownOutside",value:function(e){return(!this.$headBlueprint||!this.$headBlueprint.isOrHas(e.target))&&vy(_y(i.prototype),"_isMouseDownOutside",this).call(this,e)}},{key:"appendToBody",value:function(e){this.$body.append(e)}},{key:"addClassToBody",value:function(e){this.$body.addClass(e)}},{key:"_position",value:function(e){var t=this.$container;if(t){var n,r,o,s;if(!this._headVisible)return vy(_y(i.prototype),"_position",this).call(this,e),this.$body.removeClass(this._alignClasses()),r=Id.Alignment.TOP,t.hasClass(Id.Alignment.BOTTOM)&&(r=Id.Alignment.BOTTOM),n=Id.Alignment.LEFTEDGE,t.hasClass(Id.Alignment.RIGHTEDGE)&&(n=Id.Alignment.RIGHTEDGE),void this.$body.addClass(r+" "+n);this._positionImpl();var a=O.nvl(e,this.horizontalSwitch),l=O.nvl(e,this.verticalSwitch);if(a||l){s=t.offset(),o=this.overlap({x:s.left,y:s.top},!1);var u=this.$parent.offset();o.x-=u.left,o.y-=u.top,o.y>0&&l&&(r=Id.Alignment.TOP),o.x>0&&a&&(n=Id.Alignment.RIGHTEDGE),(n||r)&&this._positionImpl(n,r)}}}},{key:"_positionImpl",value:function(e,t){var n,r,o,i,a,l,u,c,f,h=0,p=0;e=e||this.horizontalAlignment,t=t||this.verticalAlignment,this.$container.removeClass(this._alignClasses()),this.$body.removeClass(this._alignClasses()),this.$container.addClass(t+" "+e),this.$body.addClass(t+" "+e),this.$head.copyCssIfGreater(this.$headBlueprint,"padding"),this.$head.copyCss(this.$headBlueprint,"line-height"),this.$head.height(this.$headBlueprint.height()),this.$head.width(this.$headBlueprint.width()),this._copyStyleToHeadChildren(),r=qs.size(this.$head,!0),(o=qs.size(this.$body,!0)).width=Math.max(o.width,r.width),i=o.width,n=this.$headBlueprint.offset();var d=this.$parent.offset();n.left-=d.left,n.top-=d.top,l=n.left,c=qs.insets(this.$head),f=qs.insets(this.$headBlueprint),u=n.top-c.top+f.top,t===Id.Alignment.TOP?(u-=o.height,p=(h=0+o.height)-1,this.$container.cssMarginBottom(r.height),this.$container.css("margin-top","")):t===Id.Alignment.BOTTOM&&(h-=r.height,this.$container.cssMarginTop(r.height),this.$container.css("margin-bottom","")),s.a.log.isTraceEnabled()&&s.a.log.trace("bodyWidth="+i+" pos=[left="+n.left+" top="+n.top+"] headSize="+r+" headInsets="+c+" left="+l+" top="+u),this.$head.cssTop(h),this.$body.cssTop(0),this.$deco.cssTop(p),e===Id.Alignment.RIGHTEDGE?(l-=(a=i-r.width)+c.left-f.left,this.$head.cssLeft(a),this.$body.cssLeft(0),this.$deco.cssLeft(a+this.$head.cssBorderLeftWidth()).width(r.width-this.$head.cssBorderWidthX())):(l=l-c.left+f.left,this.$head.cssLeft(0),this.$deco.cssLeft(1).width(r.width-2)),this.horizontalAlignment=e,this.verticalAlignment=t,this.setLocation(new Is(l,u)),qs.setSize(this.$head,r),qs.setSize(this.$body,o)}},{key:"_glassPaneTargets",value:function(){return[this.$container,this.$head]}}])&&yy(t.prototype,n),r&&yy(t,r),i}(Id);function ky(e){return(ky="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Sy(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Oy(e,t,n){return(Oy="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Ry(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function Ty(e,t){return(Ty=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Cy(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ry(e);if(t){var o=Ry(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Py(this,n)}}function Py(e,t){return!t||"object"!==ky(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Ry(e){return(Ry=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var xy=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ty(e,t)}(i,e);var t,n,r,o=Cy(i);function i(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),o.call(this,e)}return t=i,(n=[{key:"_setSize",value:function(e){Oy(Ry(i.prototype),"_setSize",this).call(this,e);var t=this.popup.htmlComp,n=e,r=ea.optGet(this.popup.$body);if(!this.popup.bodyAnimating){if(n=n.subtract(t.insets()),this._headVisible){var o=qs.size(this.popup.$head,!0);n.width<o.width&&(n.width=o.width)}r.setSize(n)}}},{key:"_adjustSize",value:function(e){return this._adjustSizeWithAnchor(e)}},{key:"_calcMaxSizeAroundAnchor",value:function(){if(!this.popup._headVisible)return Oy(Ry(i.prototype),"_calcMaxSizeAroundAnchor",this).call(this);this._position(!1);var e,t,n,r,o=this.popup.htmlComp,s=this.popup.windowPaddingX,a=this.popup.windowPaddingX,l=this.popup.windowPaddingY,u=qs.offsetBounds(o.$comp),c=qs.offsetBounds(this.popup.$head),f=o.margins(),h=this.popup.getWindowSize();return t=h.width-c.x-a,e=c.x+c.width-s,n=h.height-u.y-l,r=u.y-f.vertical()-l,new Bs(r,t,n,e)}},{key:"preferredLayoutSize",value:function(e,t){var n,r,o=this.popup.htmlComp;if(this.popup.bodyAnimating)r=qs.size(this.popup.$body,t).add(qs.margins(this.popup.$body));else{var i=this.popup.$container.attr("style"),s=this.popup.$body.siblings(".popup-body");s.addClass("hidden"),this.popup.$container.css({width:"auto",height:"auto"}),r=(n=ea.optGet(this.popup.$body))?n.prefSize(t).add(n.margins()):qs.prefSize(this.popup.$body,t).add(qs.margins(this.popup.$body)),s.removeClass("hidden"),this.popup.$container.attr("style",i)}if(this.popup._headVisible){var a=qs.size(this.popup.$head,t).add(qs.margins(this.popup.$head));r.width=r.width<a.width?a.width:r.width}return r=r.add(o.insets())}}])&&Sy(t.prototype,n),r&&Sy(t,r),i}(Qd);function Ey(e){return(Ey="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Dy(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Ay(e,t,n){return(Ay="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=My(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function Fy(e,t){return(Fy=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function $y(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=My(e);if(t){var o=My(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return jy(this,n)}}function jy(e,t){return!t||"object"!==Ey(t)&&"function"!=typeof t?By(e):t}function By(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function My(e){return(My=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Iy=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Fy(e,t)}(i,e);var t,n,r,o=$y(i);function i(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(e=o.call(this))._touchField=null,e._touchFieldTooltip=null,e._field=null,e._widget=null,e._$widgetContainer=null,e._widgetContainerHtmlComp=null,e.windowPaddingX=0,e.windowPaddingY=0,e.withGlassPane=!0,e._touchFieldPropertyChangeListener=e._onTouchFieldPropertyChange.bind(By(e)),e}return t=i,(n=[{key:"_init",value:function(e){Ay(My(i.prototype),"_init",this).call(this,e),this._touchField=e.field,this._touchField._tooltip()&&this._touchField._tooltip().rendered&&(this._touchFieldTooltip=this._touchField._tooltip(),this._touchFieldTooltip.remove()),this._field=this._touchField.clone(this._fieldOverrides()),this._touchField.on("propertyChange",this._touchFieldPropertyChangeListener),this._initWidget(e)}},{key:"_destroy",value:function(){this._touchField.off("propertyChange",this._touchFieldPropertyChangeListener),this._touchFieldTooltip&&!this._touchFieldTooltip.destroyed&&this._touchFieldTooltip.render(this._touchField._$tooltipParent()),Ay(My(i.prototype),"_destroy",this).call(this)}},{key:"_fieldOverrides",value:function(){return{parent:this,labelPosition:ZW.LabelPosition.ON_FIELD,fieldStyle:ZW.FieldStyle.CLASSIC,popup:this,statusVisible:!1,menusVisible:!1,embedded:!0,touchMode:!1,clearable:Qz.Clearable.ALWAYS}}},{key:"_initWidget",value:function(e){}},{key:"_createLayout",value:function(){return new Uy(this)}},{key:"prefLocation",value:function(e,t){var n=this.htmlComp.prefSize(),r=this.$container.window().width(),o=Math.max(this.windowPaddingX,(r-n.width)/2);return new Is(o,0)}},{key:"_render",value:function(){this.$container=this.$parent.appendDiv("touch-popup"),this._$header=this.$container.appendDiv("touch-popup-header"),this._$header.appendDiv("status closer touch-popup-close-icon").on("click",this._onCloseIconClick.bind(this)),this._$header.appendDiv("touch-popup-title").textOrNbsp(this._touchField.label,"empty"),this._$widgetContainer=this.$container.appendDiv("touch-popup-widget-container"),this._widgetContainerHtmlComp=ea.install(this._$widgetContainer,this.session),this._widgetContainerHtmlComp.setLayout(new Ml),this._field.render(),this._field.$container.insertBefore(this._$widgetContainer),this._field.$container.addClass("touch-popup-field"),this._widget&&this._widget.render(this._$widgetContainer),this.htmlComp=ea.install(this.$container,this.session),this.htmlComp.validateRoot=!0,this.htmlComp.setLayout(this._createLayout())}},{key:"_onTouchFieldPropertyChange",value:function(e){"errorStatus"===e.propertyName?this._field.setErrorStatus(e.newValue):"lookupRow"===e.propertyName&&this._field.setLookupRow(e.newValue)}},{key:"_acceptInput",value:function(){var e=this._field.acceptInput();e?e.always(this.close.bind(this)):this.close()}},{key:"_onCloseIconClick",value:function(e){this._acceptInput()}}])&&Dy(t.prototype,n),r&&Dy(t,r),i}(Id);function Ly(e){return(Ly="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Hy(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Ny(e,t,n){return(Ny="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Gy(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function Vy(e,t){return(Vy=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Wy(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Gy(e);if(t){var o=Gy(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return zy(this,n)}}function zy(e,t){return!t||"object"!==Ly(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Gy(e){return(Gy=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Uy=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Vy(e,t)}(i,e);var t,n,r,o=Wy(i);function i(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(t=o.call(this,e)).doubleCalcPrefSize=!1,t}return t=i,(n=[{key:"layout",value:function(e){Ny(Gy(i.prototype),"layout",this).call(this,e);var t=this.popup.htmlComp.size().subtract(this.popup.htmlComp.insets()),n=qs.size(this.popup._$header,!0).height,r=this.popup._field,o=r.htmlComp.prefSize().height,s=r.htmlComp.margins(),a=t.width-s.horizontal(),l=n+o+s.vertical();r.htmlComp.setBounds(new Hs(0,n,a,o)),this.popup._widgetContainerHtmlComp.setBounds(new Hs(0,l,t.width,t.height-l))}},{key:"preferredLayoutSize",value:function(e){var t=Xs.get().formColumnWidth,n=15*Xs.get().formRowHeight;return new $s(t,n)}}])&&Hy(t.prototype,n),r&&Hy(t,r),i}(Qd);function Ky(e){return(Ky="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function qy(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Yy(e,t,n){return(Yy="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=ev(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function Xy(e,t){return(Xy=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Jy(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=ev(e);if(t){var o=ev(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Zy(this,n)}}function Zy(e,t){return!t||"object"!==Ky(t)&&"function"!=typeof t?Qy(e):t}function Qy(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ev(e){return(ev=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var tv=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Xy(e,t)}(i,e);var t,n,r,o=Jy(i);function i(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(e=o.call(this)).animateOpening=!0,e.animateResize=!0,e.animateRemoval=!0,e.closable=!1,e.closeAction=null,e.movable=!1,e.resizable=!1,e.resizeModes=null,e.minSize=null,e.widget=null,e.windowPaddingX=0,e.windowPaddingY=0,e.windowResizeType="layoutAndPosition",e.$dragHandle=null,e._moveHandler=e._onMove.bind(Qy(e)),e._resizeHandler=e._onResize.bind(Qy(e)),e._autoPositionOrig=null,e._addWidgetProperties(["widget"]),e}return t=i,(n=[{key:"_createLayout",value:function(){return new yv(this)}},{key:"_init",value:function(e){Yy(ev(i.prototype),"_init",this).call(this,e),this._setClosable(this.closable)}},{key:"_render",value:function(){Yy(ev(i.prototype),"_render",this).call(this),this.$container.addClass("widget-popup")}},{key:"_renderProperties",value:function(){Yy(ev(i.prototype),"_renderProperties",this).call(this),this._renderWidget(),this._renderClosable(),this._renderMovable(),this._renderResizable()}},{key:"_remove",value:function(){this.$dragHandle=null,Yy(ev(i.prototype),"_remove",this).call(this)}},{key:"setWidget",value:function(e){this.setProperty("widget",e)}},{key:"_renderWidget",value:function(){this.widget&&(this.widget.render(),this.widget.$container.addClass("popup-widget"),this.invalidateLayoutTree())}},{key:"setClosable",value:function(e){this.setProperty("closable",e)}},{key:"_setClosable",value:function(e){if(this._setProperty("closable",e),this.closable){if(this.closeAction)return;this.closeAction=this._createCloseAction(),this.closeAction.on("action",this._onCloseAction.bind(this))}else{if(!this.closeAction)return;this.closeAction.destroy(),this.closeAction=null}}},{key:"_createCloseAction",value:function(){return O.create("Action",{parent:this,cssClass:"close-action",iconId:gn.REMOVE})}},{key:"_renderClosable",value:function(){this.closeAction&&this.closeAction.render()}},{key:"_onCloseAction",value:function(){this.close()}},{key:"setResizable",value:function(e){this.setProperty("resizable",e)}},{key:"_renderResizable",value:function(){this.resizable?this.$container.resizable({modes:this._determineResizeModes(),$parent:this.$container,boundaries:this._calculateResizeBoundaries()}).on("resize",this._resizeHandler):(this.$container.unresizable().off("resize",this._resizeHandler),this.invalidateLayoutTree())}},{key:"_calculateResizeBoundaries",value:function(){var e=new Bs;if(!this.$arrow)return e;var t=this._getAnchorMiddlePoint();if(!t)return e;var n=qs.size(this.$arrow);return this._isVerticallyAligned()?(e.top=t.y-n.height,e.bottom=t.y+n.height):(e.left=t.x-n.width,e.right=t.x+n.width),e}},{key:"_determineResizeModes",value:function(){return!this.$arrow||this.resizeModes?this.resizeModes:this.calculatedVerticalAlignment===Id.Alignment.TOP?[obe.MODES.WEST,obe.MODES.EAST,obe.MODES.NORTH]:this.calculatedVerticalAlignment===Id.Alignment.BOTTOM?[obe.MODES.WEST,obe.MODES.EAST,obe.MODES.SOUTH]:this.calculatedHorizontalAlignment===Id.Alignment.LEFT?[obe.MODES.NORTH,obe.MODES.SOUTH,obe.MODES.WEST]:this.calculatedHorizontalAlignment===Id.Alignment.RIGHT?[obe.MODES.NORTH,obe.MODES.SOUTH,obe.MODES.EAST]:this.resizeModes}},{key:"_onResize",value:function(e){var t=this.htmlComp.layout.autoSize;return this.htmlComp.layout.autoSize=!1,this.htmlComp.revalidateLayout(),this.htmlComp.layout.autoSize=t,this._updateArrowPosition(),!1}},{key:"position",value:function(e){if(this.rendered&&(Yy(ev(i.prototype),"position",this).call(this,e),this.resizable)){var t=this.$container.data("resizable");t.setBoundaries(this._calculateResizeBoundaries()),t.setModes(this._determineResizeModes()),this._updateArrowPosition()}}},{key:"_updateArrowClass",value:function(e,t){Yy(ev(i.prototype),"_updateArrowClass",this).call(this,e,t),this.$arrow&&(this.$arrow.cssLeft(null),this.$arrow.cssTop(null))}},{key:"_updateArrowPosition",value:function(){if(this.$arrow){var e=this._getAnchorMiddlePoint();if(e){this.$arrow.removeClass("leftedge rightedge topedge bottomedge");var t=qs.size(this.$arrow),n=qs.margins(this.$arrow);if(this._isVerticallyAligned()){var r=n.top+n.bottom;this.$arrow.cssTop(e.y-(r+this.$container.position().top+t.height/2))}else{var o=n.left+n.right;this.$arrow.cssLeft(e.x-(o+this.$container.position().left+t.width/2))}}}}},{key:"_getAnchorMiddlePoint",value:function(){var e=this.getAnchorBounds();return e?e.center():null}},{key:"_isVerticallyAligned",value:function(){return O.isOneOf(this.calculatedHorizontalAlignment,Id.Alignment.LEFT,Id.Alignment.RIGHT)}},{key:"setMovable",value:function(e){this.setProperty("movable",e)}},{key:"_renderMovable",value:function(){if(this.movable){if(this.$dragHandle)return;this.$dragHandle=this.$container.prependDiv("drag-handle"),this.$container.draggable(this.$dragHandle,s.a.throttle(this._moveHandler,1e3/60))}else{if(!this.$dragHandle)return;this.$container.undraggable(this.$dragHandle),this.$dragHandle.remove(),this.$dragHandle=null,this.htmlComp.layout.autoPosition=this._autoPositionOrig,this._autoPositionOrig=null,this.invalidateLayoutTree()}}},{key:"_onMove",value:function(e){null===this._autoPositionOrig&&(this._autoPositionOrig=this.htmlComp.layout.autoPosition,this.htmlComp.layout.autoPosition=!1),this.trigger("move",e)}},{key:"set$Anchor",value:function(e){this._autoPositionOrig&&e&&this.$anchor!==e&&(this.htmlComp.layout.autoPosition=this._autoPositionOrig,this._autoPositionOrig=null),Yy(ev(i.prototype),"set$Anchor",this).call(this,e)}}])&&qy(t.prototype,n),r&&qy(t,r),i}(Id);function nv(e){return(nv="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function rv(e,t){return(rv=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function ov(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=sv(e);if(t){var o=sv(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return iv(this,n)}}function iv(e,t){return!t||"object"!==nv(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function sv(e){return(sv=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var av=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&rv(e,t)}(n,e);var t=ov(n);function n(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),t.call(this)}return n}(Ud);function lv(e){return(lv="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function uv(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function cv(e,t,n){return(cv="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=dv(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function fv(e,t){return(fv=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function hv(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=dv(e);if(t){var o=dv(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return pv(this,n)}}function pv(e,t){return!t||"object"!==lv(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function dv(e){return(dv=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var yv=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&fv(e,t)}(i,e);var t,n,r,o=hv(i);function i(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),o.call(this,e)}return t=i,(n=[{key:"_setSize",value:function(e){cv(dv(i.prototype),"_setSize",this).call(this,e);var t=this.popup.htmlComp,n=this.popup.widget.htmlComp,r=e.subtract(t.insets());n.setSize(r.subtract(n.margins()))}},{key:"preferredLayoutSize",value:function(e,t){var n=this.popup.htmlComp,r=this.popup.widget.htmlComp;return r.prefSize(t).add(n.insets()).add(r.margins())}}])&&uv(t.prototype,n),r&&uv(t,r),i}(Qd);function vv(e){return(vv="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function bv(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function mv(e,t,n){return(mv="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=kv(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function gv(e,t){return(gv=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function _v(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=kv(e);if(t){var o=kv(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return wv(this,n)}}function wv(e,t){return!t||"object"!==vv(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function kv(e){return(kv=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Sv=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&gv(e,t)}(i,e);var t,n,r,o=_v(i);function i(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(e=o.call(this)).boundToAnchor=!1,e.closable=!0,e.title=null,e.withGlassPane=!0,e}return t=i,(n=[{key:"_createLayout",value:function(){return new Iv(this)}},{key:"_createCloseAction",value:function(){return O.create("Action",{parent:this,cssClass:"closer",iconId:gn.REMOVE_BOLD})}},{key:"prefLocation",value:function(e,t){var n=this.htmlComp.prefSize(),r=this.$container.window().height(),o=Math.max(r-n.height,0);return new Is(0,o)}},{key:"_render",value:function(){this.$container=this.$parent.appendDiv("popup mobile-popup"),this.htmlComp=ea.install(this.$container,this.session),this.htmlComp.validateRoot=!0,this.htmlComp.setLayout(this._createLayout()),this.$header=this.$container.appendDiv("mobile-popup-header"),this.$title=this.$header.appendDiv("title")}},{key:"_renderProperties",value:function(){mv(kv(i.prototype),"_renderProperties",this).call(this),this._renderTitle()}},{key:"_renderWidget",value:function(){mv(kv(i.prototype),"_renderWidget",this).call(this),this.widget&&this.widget.$container.addClass("mobile-popup-widget")}},{key:"_renderClosable",value:function(){this.closeAction&&this.closeAction.render(this.$header),this.$header.setVisible(this.title||this.closable)}},{key:"_renderTitle",value:function(){this.$title.textOrNbsp(this.title),this.$header.setVisible(this.title||this.closable)}}])&&bv(t.prototype,n),r&&bv(t,r),i}(tv);function Ov(e){return(Ov="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Tv(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Cv(e,t){return(Cv=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Pv(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=xv(e);if(t){var o=xv(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Rv(this,n)}}function Rv(e,t){return!t||"object"!==Ov(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function xv(e){return(xv=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Ev=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Cv(e,t)}(n,e);var t=Pv(n);function n(){return Tv(this,n),t.apply(this,arguments)}return n}(av);function Dv(e){return(Dv="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Av(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Fv(e,t,n){return(Fv="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Mv(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function $v(e,t){return($v=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function jv(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Mv(e);if(t){var o=Mv(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Bv(this,n)}}function Bv(e,t){return!t||"object"!==Dv(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Mv(e){return(Mv=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Iv=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&$v(e,t)}(i,e);var t,n,r,o=jv(i);function i(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(t=o.call(this,e)).doubleCalcPrefSize=!1,t}return t=i,(n=[{key:"layout",value:function(e){Fv(Mv(i.prototype),"layout",this).call(this,e);var t,n=this.popup.htmlComp,r=n.size(),o=this.popup.widget.htmlComp,s=0,a=this.popup.$header;r=r.subtract(n.insets()),t=qs.prefSize(a,!0),qs.setLocation(a,new Is(0,0)),(s=r.clone()).height-=t.height,o.setLocation(new Is(0,t.height)),o.setSize(s.subtract(o.margins()))}},{key:"preferredLayoutSize",value:function(e){var t=this.popup.$container.window();return new $s(t.width(),t.height())}}])&&Av(t.prototype,n),r&&Av(t,r),i}(Qd);function Lv(e){return(Lv="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Hv(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Nv(e,t,n){return(Nv="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Gv(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function Vv(e,t){return(Vv=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Wv(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Gv(e);if(t){var o=Gv(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return zv(this,n)}}function zv(e,t){return!t||"object"!==Lv(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Gv(e){return(Gv=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Uv=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Vv(e,t)}(i,e);var t,n,r,o=Wv(i);function i(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(e=o.call(this)).preselectedDate=null,e.selectedDate=null,e.dateFormat=null,e.viewDate=null,e.allowedDates=null,e.currentMonth=null,e.$scrollable=null,e.months=[],e.touch=Kt.get().supportsOnlyTouch(),e}return t=i,(n=[{key:"_init",value:function(e){Nv(Gv(i.prototype),"_init",this).call(this,e),this._setDateFormat(this.dateFormat)}},{key:"_render",value:function(){this.$container=this.$parent.appendDiv("date-picker").toggleClass("touch",this.touch),this.htmlComp=ea.install(this.$container,this.session),this._$header=this._append$Header(),this._$header.find(".date-picker-left-y, .date-picker-left-m, .date-picker-right-m, .date-picker-right-y").mousedown(this._onNavigationMouseDown.bind(this)),this.$container.appendDiv("date-picker-separator"),this.$scrollable=this.$container.appendDiv("date-picker-scrollable"),this._registerSwipeHandlers()}},{key:"_setDateFormat",value:function(e){e||(e=this.session.locale.dateFormatPatternDefault),e=tp.ensure(this.session.locale,e),this._setProperty("dateFormat",e)}},{key:"prependMonth",value:function(e){var t=this.months.slice();rt.insert(t,e,0),this.setMonths(t)}},{key:"appendMonth",value:function(e){var t=this.months.slice();t.push(e),this.setMonths(t)}},{key:"resetMonths",value:function(e){e=e||this.viewDate;var t=Et.shift(e,0,-1,0),n=Et.shift(e,0,1,0);this.setMonths([t,e,n])}},{key:"setMonths",value:function(e){e=(e=rt.ensure(e)).map((function(e){var t=e;e instanceof Date||(t=e.viewDate);var n=this._findMonthByViewDate(t);return n||{rendered:!1,viewDate:t,$container:void 0}}),this),this.rendered&&this.months.forEach((function(t){e.indexOf(t)<0&&t.rendered&&t.$container.remove()}),this),this.setProperty("months",e)}},{key:"_renderMonths",value:function(){this.months.forEach((function(e){e.rendered||(this._renderMonth(e),this.currentMonth&&Et.compare(e.viewDate,this.currentMonth.viewDate)<0&&e.$container.insertBefore(this.currentMonth.$container))}),this);var e=this.months.length*this._boxWidth;this.$scrollable.width(e),this.currentMonth&&this.$scrollable.cssLeft(this._scrollableLeftForMonth(this.currentMonth))}},{key:"_findMonthByViewDate",value:function(e){return rt.find(this.months,(function(t){return 0===Et.compareMonths(t.viewDate,e)}))}},{key:"_scrollableLeftForMonth",value:function(e){var t=qs.insets(this.$scrollable),n=qs.margins(e.$container);return-1*(e.$container.position().left-n.left-t.left)}},{key:"_renderMonth",value:function(e){if(!e.rendered){var t=this.$parent.makeDiv("date-picker-month-box");this._build$DateBox(e.viewDate).appendTo(t),t.on("DOMMouseScroll mousewheel",this._onMouseWheel.bind(this)).appendTo(this.$scrollable),this._boxWidth||(this._boxWidth=t.width()),t.width(this._boxWidth),e.$container=t,e.rendered=!0}}},{key:"setViewDate",value:function(e,t){Pr.equals(this.viewDate,e)||(this._setProperty("viewDate",e),this.rendered&&this._renderViewDate(t))}},{key:"_renderViewDate",value:function(e){var t=this,n=this._findMonthByViewDate(this.viewDate),r=this._scrollableLeftForMonth(n);this.currentMonth||this.revalidateLayoutTree(),this.currentMonth=n,this._updateHeader(this.viewDate),(e=O.nvl(e,!0))?this.$scrollable.stop(!0).animate({left:r},300,(function(){t.resetMonths()})):(this.$scrollable.cssLeft(r),this.resetMonths())}},{key:"preselectDate",value:function(e,t){this.showDate(e,t),e&&this.setSelectedDate(null),this.setPreselectedDate(e)}},{key:"setPreselectedDate",value:function(e){this.setProperty("preselectedDate",e)}},{key:"_renderPreselectedDate",value:function(){var e=this;this.currentMonth&&this.currentMonth.$container.find(".date-picker-day").each((function(t,n){var r=s()(n);r.removeClass("preselected"),Et.isSameDay(e.preselectedDate,r.data("date"))&&r.addClass("preselected")}))}},{key:"selectDate",value:function(e,t){this.showDate(e,t),e&&this.setPreselectedDate(null),this.setSelectedDate(e)}},{key:"setSelectedDate",value:function(e){this.setProperty("selectedDate",e)}},{key:"_renderSelectedDate",value:function(){var e=this;this.currentMonth&&this.currentMonth.$container.find(".date-picker-day").each((function(t,n){var r=s()(n);r.removeClass("selected"),Et.isSameDay(e.selectedDate,r.data("date"))&&r.addClass("selected")}))}},{key:"showDate",value:function(e,t){var n=0;this.viewDate&&(n=Et.compareMonths(e,this.viewDate)),this.currentMonth&&n?n<0?this.prependMonth(e):this.appendMonth(e):this.currentMonth?this.resetMonths(e):this.setMonths([e]),this.setViewDate(e,t)}},{key:"shiftViewDate",value:function(e,t,n){var r=this.viewDate;r=Et.shift(r,e,t,n),this.showDate(r)}},{key:"shiftSelectedDate",value:function(e,t,n){var r=this.preselectedDate;this.selectedDate&&(r=this.allowedDates?this._findNextAllowedDate(e,t,n):Et.shift(this.selectedDate,e,t,n)),r&&this.selectDate(r,!0)}},{key:"_findNextAllowedDate",value:function(e,t,n){var r,o,i=e+t+n>0?1:-1,s=this.selectedDate||Et.trunc(new Date);if(0!==e?s=Et.shift(s,e,0,0):0!==t&&(s=Et.shift(s,0,t,0)),1===i){for(r=0;r<this.allowedDates.length;r++)if(o=this.allowedDates[r],Et.compare(s,o)<0)return o}else if(-1===i)for(r=this.allowedDates.length-1;r>=0;r--)if(o=this.allowedDates[r],Et.compare(s,o)>0)return o;return null}},{key:"_isDateAllowed",value:function(e){if(!this.allowedDates||0===this.allowedDates.length)return!0;var t=e.getTime();return this.allowedDates.some((function(e){return e.getTime()===t}))}},{key:"_build$DateBox",value:function(e){var t,n,r,o,i,s,a,l=new Date,u=new Date(e),c=this.dateFormat.symbols.weekdaysShortOrdered,f=this.$container.makeDiv("date-picker-month").data("viewDate",e),h=f.appendDiv("date-picker-weekdays");c.forEach((function(e){h.appendDiv("date-picker-weekday",e)}));for(var p=0;p<42;p++){u.setDate(u.getDate()-1);var d=new Date(u.getYear(),e.getMonth(),0).getDate()-u.getDate();if(0===u.getDay()&&u.getMonth()!==e.getMonth()&&d>1)break}for(n=0;n<42;n++)n%7==0&&(a=f.appendDiv("date-picker-week")),u.setDate(u.getDate()+1),i=u.getDate(),t=6===u.getDay()||0===u.getDay()?u.getMonth()!==e.getMonth()?" date-picker-out-weekend":" date-picker-weekend":u.getMonth()!==e.getMonth()?" date-picker-out":"",Et.isSameDay(u,l)&&(t+=" date-picker-now"),Et.isSameDay(this.selectedDate,u)&&(t+=" selected"),Et.isSameDay(this.preselectedDate,u)&&(t+=" preselected"),i>9&&i<20&&(t+=" ten"),(o=this._isDateAllowed(u))||(t+=" disabled"),r=i<=9?"0"+i:i,(s=a.appendDiv("date-picker-day"+t).data("dayInMonth",i).data("date",new Date(u))).appendSpan("text",r),o&&s.on("click",this._onDayClick.bind(this));return f}},{key:"_append$Header",value:function(){return this.$container.appendElement('<div class="date-picker-header">  <div class="date-picker-left-y" data-shift="-12"></div>  <div class="date-picker-left-m" data-shift="-1"></div>  <div class="date-picker-right-y" data-shift="12"></div>  <div class="date-picker-right-m" data-shift="1"></div>  <div class="date-picker-header-month"></div></div>').toggleClass("touch",this.touch)}},{key:"_updateHeader",value:function(e){this._$header.find(".date-picker-header-month").text(this._createHeaderText(e))}},{key:"_createHeaderText",value:function(e){return this.dateFormat.symbols.months[e.getMonth()]+" "+e.getFullYear()}},{key:"_registerSwipeHandlers",value:function(){var e=this,t=this.$scrollable.window();this.$scrollable.on("touchmove",(function(e){e.preventDefault()})),this.$scrollable.on("remove",(function(e){t.off(".datepickerDrag")})),this.$scrollable.on(Nt.touchdown(this.touch),(function(n){var r=Nt.pageX(n),o=0;e.$scrollable.stop(!0);var i=Et.shift(e.viewDate,0,-1,0),s=Et.shift(e.viewDate,0,1,0);e.setMonths([i,e.viewDate,s]);var a=e.$scrollable.position().left;e.swiped=!1;var l=!0;t.on(Nt.touchmove(e.touch,"datepickerDrag"),(function(t){var n=Nt.pageX(t),i=a+(o=n-r),s=e.$container.width()-e.$scrollable.outerWidth();(i=Math.max(Math.min(i,0),s))!==a&&e.$scrollable.cssLeft(i)})),t.on(Nt.touchendcancel(e.touch,"datepickerDrag"),(function(n){if(t.off(".datepickerDrag"),l){l=!1;var r=e.viewDate;o<-5?r=s:o>5&&(r=i),e.viewDate!==r&&(e.swiped=!0,e.setViewDate(r))}}))}))}},{key:"_onNavigationMouseDown",value:function(e){var t=s()(e.currentTarget).data("shift");this.shiftViewDate(0,t,0)}},{key:"_onDayClick",value:function(e){if(!this.swiped){var t=s()(e.currentTarget).data("date");this.selectDate(t),this.trigger("dateSelect",{date:t})}}},{key:"_onMouseWheel",value:function(e){var t=((e=e.originalEvent||this.$container.window(!0).event.originalEvent).wheelDelta?e.wheelDelta/10:3*-e.detail)>=0?-1:1;this.shiftViewDate(0,t,0),e.preventDefault()}}])&&Hv(t.prototype,n),r&&Hv(t,r),i}(ve);function Kv(e){return(Kv="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function qv(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Yv(e,t,n){return(Yv="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Qv(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function Xv(e,t){return(Xv=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Jv(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Qv(e);if(t){var o=Qv(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Zv(this,n)}}function Zv(e,t){return!t||"object"!==Kv(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Qv(e){return(Qv=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var eb=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Xv(e,t)}(i,e);var t,n,r,o=Jv(i);function i(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),o.call(this)}return t=i,(n=[{key:"_init",value:function(e){e.scrollType=e.scrollType||"layoutAndPosition",e.withFocusContext=!1,Yv(Qv(i.prototype),"_init",this).call(this,e),this.picker=O.create("DatePicker",{parent:this,dateFormat:e.dateFormat,allowedDates:e.allowedDates})}},{key:"_createLayout",value:function(){return new lb(this)}},{key:"_render",value:function(){this.$container=this.$parent.appendDiv("date-picker-popup"),this.$container.toggleClass("alternative",this.field.fieldStyle===ZW.FieldStyle.ALTERNATIVE),this.htmlComp=ea.install(this.$container,this.session),this.htmlComp.setLayout(this._createLayout()),this.htmlComp.validateRoot=!0,this.picker.render()}},{key:"getDatePicker",value:function(){return this.picker}},{key:"_isMouseDownOnAnchor",value:function(e){return this.field.$dateField.isOrHas(e.target)||this.field.$dateFieldIcon.isOrHas(e.target)||this.field.$dateClearIcon&&this.field.$dateClearIcon.isOrHas(e.target)}}])&&qv(t.prototype,n),r&&qv(t,r),i}(Id);function tb(e){return(tb="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function nb(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function rb(e,t,n){return(rb="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=ab(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function ob(e,t){return(ob=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function ib(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=ab(e);if(t){var o=ab(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return sb(this,n)}}function sb(e,t){return!t||"object"!==tb(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function ab(e){return(ab=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var lb=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ob(e,t)}(i,e);var t,n,r,o=ib(i);function i(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(t=o.call(this)).popup=e,t.doubleCalcPrefSize=!1,t}return t=i,(n=[{key:"layout",value:function(e){var t,n=this.popup.htmlComp,r=this.popup.picker.htmlComp;rb(ab(i.prototype),"layout",this).call(this,e),t=n.size().subtract(n.insets()).subtract(r.margins()),r.setSize(t),this.popup.htmlComp.layouted&&this.popup.position()}},{key:"preferredLayoutSize",value:function(e){var t=this.popup.htmlComp,n=this.popup.picker.htmlComp;return n.prefSize().add(t.insets()).add(n.margins())}}])&&nb(t.prototype,n),r&&nb(t,r),i}(Qd);function ub(e){return(ub="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function cb(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function fb(e,t,n){return(fb="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=yb(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function hb(e,t){return(hb=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function pb(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=yb(e);if(t){var o=yb(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return db(this,n)}}function db(e,t){return!t||"object"!==ub(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function yb(e){return(yb=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var vb=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&hb(e,t)}(i,e);var t,n,r,o=pb(i);function i(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),o.call(this)}return t=i,(n=[{key:"_init",value:function(e){fb(yb(i.prototype),"_init",this).call(this,e),this._field.on("acceptInput",this._onFieldAcceptInput.bind(this))}},{key:"_initWidget",value:function(e){this._widget=O.create("DatePicker",{parent:this,dateFormat:e.dateFormat,allowedDates:e.allowedDates})}},{key:"_render",value:function(){fb(yb(i.prototype),"_render",this).call(this),this._field.$container.addClass("date")}},{key:"_onMouseDownOutside",value:function(){this._acceptInput()}},{key:"getDatePicker",value:function(){return this._widget}},{key:"_createLayout",value:function(){return new Sb(this)}},{key:"_onFieldAcceptInput",value:function(e){this._touchField.setDisplayText(e.displayText),this._touchField.setErrorStatus(e.errorStatus),!!e.errorStatus&&e.errorStatus.containsStatus(Xr)||this._touchField.setValue(e.value),this._touchField._triggerAcceptInput()}}])&&cb(t.prototype,n),r&&cb(t,r),i}(Iy);function bb(e){return(bb="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function mb(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function gb(e,t){return(gb=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function _b(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=kb(e);if(t){var o=kb(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return wb(this,n)}}function wb(e,t){return!t||"object"!==bb(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function kb(e){return(kb=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Sb=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&gb(e,t)}(i,e);var t,n,r,o=_b(i);function i(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),o.call(this,e)}return t=i,(n=[{key:"preferredLayoutSize",value:function(e,t){var n=Xs.get().formColumnWidth,r=this.popup.htmlComp.insets(),o=this.popup._field.htmlComp,i=this.popup._widgetContainerHtmlComp,s=o.prefSize(t).add(o.margins()),a=i.prefSize(t).add(i.margins()),l=qs.size(this.popup._$header,!0).height+s.height+a.height+r.vertical();return new $s(n,l)}}])&&mb(t.prototype,n),r&&mb(t,r),i}(Uy);function Ob(e){return(Ob="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Tb(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Cb(e,t,n){return(Cb="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Eb(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function Pb(e,t){return(Pb=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Rb(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Eb(e);if(t){var o=Eb(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return xb(this,n)}}function xb(e,t){return!t||"object"!==Ob(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Eb(e){return(Eb=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Db=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Pb(e,t)}(i,e);var t,n,r,o=Rb(i);function i(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(e=o.call(this)).bodyAnimating=!1,e.collapsed=!1,e.collapsible=!0,e.title=null,e.titleHtmlEnabled=!1,e.titleSuffix=null,e.header=null,e.headerFocusable=!1,e.headerVisible=!0,e.body=null,e.$container=null,e.$header=null,e.$footer=null,e.$collapseIcon=null,e.$collapseBorderLeft=null,e.$collapseBorderRight=null,e.collapseStyle=i.CollapseStyle.LEFT,e.htmlComp=null,e.htmlHeader=null,e.htmlFooter=null,e.iconId=null,e.icon=null,e._addWidgetProperties(["header"]),e._addWidgetProperties(["body"]),e}return t=i,(n=[{key:"_init",value:function(e){Cb(Eb(i.prototype),"_init",this).call(this,e),this.resolveTextKeys(["title","titleSuffix"]),this.resolveIconIds(["iconId"]),this._setBody(this.body),this._setHeader(this.header)}},{key:"_createKeyStrokeContext",value:function(){return new $u}},{key:"_initKeyStrokeContext",value:function(){Cb(Eb(i.prototype),"_initKeyStrokeContext",this).call(this),this.keyStrokeContext.$bindTarget=function(){return this.$header}.bind(this),this.keyStrokeContext.registerKeyStroke([new Jb(this)])}},{key:"_render",value:function(){this.$container=this.$parent.appendDiv("group"),this.htmlComp=ea.install(this.$container,this.session),this.htmlComp.setLayout(new zb(this)),this._renderHeader(),this.$collapseIcon=this.$header.appendDiv("group-collapse-icon"),this.$footer=this.$container.appendDiv("group-footer"),this.$collapseBorderLeft=this.$footer.appendDiv("group-collapse-border"),this.$collapseBorderRight=this.$footer.appendDiv("group-collapse-border"),this.htmlFooter=ea.install(this.$footer,this.session),this.$footer.on("mousedown",this._onFooterMouseDown.bind(this))}},{key:"_renderProperties",value:function(){Cb(Eb(i.prototype),"_renderProperties",this).call(this),this._renderIconId(),this._renderTitle(),this._renderTitleSuffix(),this._renderHeaderVisible(),this._renderHeaderFocusable(),this._renderCollapsed(),this._renderCollapseStyle(),this._renderCollapsible()}},{key:"_remove",value:function(){this.$header=null,this.$title=null,this.$titleSuffix=null,this.$footer=null,this.$collapseIcon=null,this.$collapseBorderLeft=null,this.$collapseBorderRight=null,this._removeIconId(),Cb(Eb(i.prototype),"_remove",this).call(this)}},{key:"_renderEnabled",value:function(){Cb(Eb(i.prototype),"_renderEnabled",this).call(this),this.$header.setTabbable(this.enabledComputed)}},{key:"setIconId",value:function(e){this.setProperty("iconId",e)}},{key:"_renderIconId",value:function(){var e=this,t=this.iconId||"";return t?this.icon?(this.icon.setIconDesc(t),void this._updateIconStyle()):(this.icon=O.create("Icon",{parent:this,iconDesc:t,prepend:!0}),this.icon.one("destroy",(function(){e.icon=null})),this.icon.render(this.$header),void this._updateIconStyle()):(this._removeIconId(),void this._updateIconStyle())}},{key:"_updateIconStyle",value:function(){var e=!!this.title;this.get$Icon().toggleClass("with-title",e),this.get$Icon().addClass("group-icon"),this._renderCollapseStyle()}},{key:"get$Icon",value:function(){return this.icon?this.icon.$container:s()()}},{key:"_removeIconId",value:function(){this.icon&&this.icon.destroy()}},{key:"setHeader",value:function(e){this.setProperty("header",e)}},{key:"_setHeader",value:function(e){this._setProperty("header",e)}},{key:"setHeaderFocusable",value:function(e){this.setProperty("headerFocusable",e)}},{key:"_renderHeaderFocusable",value:function(){this.$header.toggleClass("unfocusable",!this.headerFocusable)}},{key:"setTitle",value:function(e){this.setProperty("title",e)}},{key:"_renderTitle",value:function(){this.$title&&(this.titleHtmlEnabled?this.$title.htmlOrNbsp(this.title):this.$title.textOrNbsp(this.title),this._updateIconStyle())}},{key:"setTitleSuffix",value:function(e){this.setProperty("titleSuffix",e)}},{key:"_renderTitleSuffix",value:function(){this.$titleSuffix&&this.$titleSuffix.text(this.titleSuffix||"")}},{key:"setHeaderVisible",value:function(e){this.setProperty("headerVisible",e)}},{key:"_renderHeaderVisible",value:function(){this.$header.setVisible(this.headerVisible),this._renderCollapsible(),this.invalidateLayoutTree()}},{key:"setBody",value:function(e){this.setProperty("body",e)}},{key:"_setBody",value:function(e){e||(e=O.create("Widget",{parent:this,_render:function(){this.$container=this.$parent.appendDiv("group"),this.htmlComp=ea.install(this.$container,this.session)}})),this._setProperty("body",e)}},{key:"_createLoadingSupport",value:function(){return new oe({widget:this,$container:function(){return this.$header}.bind(this)})}},{key:"_renderHeader",value:function(){this.$header&&(this.$header.remove(),this._removeIconId()),this.header?(this.header.render(),this.$header=this.header.$container.addClass("group-header").addClass("custom-header-widget").prependTo(this.$container),this.htmlHeader=this.header.htmlComp):(this.$header=this.$container.prependDiv("group-header").unfocusable().addClass("prevent-initial-focus"),this.$title=this.$header.appendDiv("group-title"),this.$titleSuffix=this.$header.appendDiv("group-title-suffix"),xp.installForEllipsis(this.$title,{parent:this}),this.htmlHeader=ea.install(this.$header,this.session),this.rendering||(this._renderIconId(),this._renderTitle(),this._renderTitleSuffix())),this.$header.on("mousedown",this._onHeaderMouseDown.bind(this)),this.invalidateLayoutTree()}},{key:"_renderBody",value:function(){this.body.render(),this.body.$container.insertAfter(this.$header),this.body.$container.addClass("group-body"),this.body.invalidateLayoutTree()}},{key:"getFocusableElement",value:function(){return!!this.rendered&&this.$header}},{key:"toggleCollapse",value:function(){this.setCollapsed(!this.collapsed&&this.collapsible)}},{key:"setCollapsed",value:function(e){this.setProperty("collapsed",e)}},{key:"_renderCollapsed",value:function(){this.$container.toggleClass("collapsed",this.collapsed),this.$collapseIcon.toggleClass("collapsed",this.collapsed),this.collapsed||this.bodyAnimating||this._renderBody(),this.rendered?this.resizeBody():this.collapsed&&this.body.remove(),this.invalidateLayoutTree()}},{key:"setCollapsible",value:function(e){this.setProperty("collapsible",e)}},{key:"_renderCollapsible",value:function(){this.$container.toggleClass("collapsible",this.collapsible),this.$header.toggleClass("disabled",!this.collapsible),this.$footer.setVisible(this.collapseStyle===i.CollapseStyle.BOTTOM&&(this.headerVisible||this.collapsible)),this.$collapseIcon.setVisible(this.collapsible),this.invalidateLayoutTree()}},{key:"setCollapseStyle",value:function(e){this.setProperty("collapseStyle",e)}},{key:"_renderCollapseStyle",value:function(){if(this.$header.toggleClass("collapse-right",this.collapseStyle===i.CollapseStyle.RIGHT),this.$container.toggleClass("collapse-bottom",this.collapseStyle===i.CollapseStyle.BOTTOM),this.collapseStyle!==i.CollapseStyle.RIGHT||this.header)if(this.collapseStyle!==i.CollapseStyle.LEFT||this.header){if(this.collapseStyle===i.CollapseStyle.BOTTOM){var e=this.body.$container?this.body.$container:this.$header;this.$footer.insertAfter(e),this.$collapseIcon.insertAfter(this.$collapseBorderLeft)}}else this.$collapseIcon.prependTo(this.$header);else this.$collapseIcon.appendTo(this.$header);this._renderCollapsible(),this.invalidateLayoutTree()}},{key:"_onHeaderMouseDown",value:function(e){!this.collapsible||this.header&&this.collapseStyle===i.CollapseStyle.BOTTOM||this.setCollapsed(!this.collapsed&&this.collapsible)}},{key:"_onFooterMouseDown",value:function(e){this.collapsible&&this.setCollapsed(!this.collapsed&&this.collapsible)}},{key:"resizeBody",value:function(){var e=this;this.animateToggleCollapse().done((function(){e.bodyAnimating||(e.collapsed&&e.body.remove(),e.invalidateLayoutTree())}))}},{key:"animateToggleCollapse",value:function(e){var t,n,r,o=qs.cssSize(this.body.$container),i=qs.margins(this.body.$container),s=qs.paddings(this.body.$container);return this.collapsed?(t=0,n=new Bs,r=new Bs):(t=this.body.htmlComp.prefSize({widthHint:o.width}).height,this.body.htmlComp.setSize(new $s(this.body.$container.outerWidth(),t)),this.bodyAnimating?(this.body.$container.cssMarginY("").cssPaddingY(""),n=qs.margins(this.body.$container),r=qs.paddings(this.body.$container)):(o.height=0,i=new Bs,s=new Bs,n=qs.margins(this.body.$container),r=qs.paddings(this.body.$container))),this.bodyAnimating=!0,this.collapsed&&this.$container.addClass("collapsing"),this.body.$container.stop(!0).cssHeight(o.height).cssMarginTop(i.top).cssMarginBottom(i.bottom).cssPaddingTop(s.top).cssPaddingBottom(s.bottom).animate({height:t,marginTop:n.top,marginBottom:n.bottom,paddingTop:r.top,paddingBottom:r.bottom},{duration:350,progress:function(){this.trigger("bodyHeightChange"),this.revalidateLayoutTree()}.bind(this),complete:function(){this.bodyAnimating=!1,this.body.rendered&&(this.body.$container.cssMarginY(""),this.body.$container.cssPaddingY("")),this.rendered&&this.$container.removeClass("collapsing"),this.trigger("bodyHeightChangeDone")}.bind(this)}).promise()}}])&&Tb(t.prototype,n),r&&Tb(t,r),i}(ve);function Ab(e){return(Ab="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Fb(e,t){return(Fb=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function $b(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Bb(e);if(t){var o=Bb(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return jb(this,n)}}function jb(e,t){return!t||"object"!==Ab(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Bb(e){return(Bb=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}!function(e,t,n){t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}(Db,"CollapseStyle",{LEFT:"left",RIGHT:"right",BOTTOM:"bottom"});var Mb=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Fb(e,t)}(n,e);var t=$b(n);function n(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),(e=t.call(this))._addRemoteProperties(["collapsed"]),e}return n}(de);function Ib(e){return(Ib="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Lb(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Hb(e,t){return(Hb=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Nb(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Wb(e);if(t){var o=Wb(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Vb(this,n)}}function Vb(e,t){return!t||"object"!==Ib(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Wb(e){return(Wb=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var zb=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Hb(e,t)}(i,e);var t,n,r,o=Nb(i);function i(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(t=o.call(this)).group=e,t}return t=i,(n=[{key:"layout",value:function(e){var t=this.group.htmlComp,n=t.availableSize().subtract(t.insets()),r=this.group.htmlHeader,o=r.prefSize({widthHint:n.width});o.width=n.width,o=o.subtract(r.margins()),r.setSize(o);var i=this.group.htmlFooter;if(i.isVisible()){var s=i.prefSize({includeMargin:!1,useCssSize:!0});s.width=n.width,i.setSize(s.subtract(i.margins()))}if(!this.group.collapsed&&!this.group.bodyAnimating&&this.group.body.rendered&&this.group.body.isVisible()){var a=this.group.body.htmlComp,l=n.subtract(a.margins());l.height-=o.height,i.isVisible()&&(l.height-=i.prefSize(!0).height),a.setSize(l)}}},{key:"invalidate",value:function(e){this.group.body.htmlComp&&this.group.bodyAnimating&&e&&e.isDescendantOf(this.group.htmlComp)&&(this.group.body.$container.stop(),this.group.resizeBody())}},{key:"preferredLayoutSize",value:function(e,t){var n;t=t||{};var r=this.group.htmlComp,o=this.group.htmlHeader,i=this.group.body.htmlComp,s=this.group.htmlFooter;return t.heightHint=null,(n=(n=this.group.bodyAnimating?i.size(!0):!this.group.collapsed&&this.group.body.rendered&&this.group.body.isVisible()?i.prefSize(t).add(i.margins()):new $s(0,0)).add(r.insets({includeMargin:!0}))).height+=o.prefSize(t).add(o.margins()).height,s.isVisible()&&(n.height+=s.prefSize({includeMargin:!0,useCssSize:!0}).height),n}}])&&Lb(t.prototype,n),r&&Lb(t,r),i}(Zs);function Gb(e){return(Gb="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ub(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Kb(e,t){return(Kb=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function qb(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Xb(e);if(t){var o=Xb(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Yb(this,n)}}function Yb(e,t){return!t||"object"!==Gb(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Xb(e){return(Xb=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Jb=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Kb(e,t)}(i,e);var t,n,r,o=qb(i);function i(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(t=o.call(this,e)).field=e,t.which=[Ou.SPACE],t}return t=i,(n=[{key:"handle",value:function(e){this.field.toggleCollapse()}}])&&Ub(t.prototype,n),r&&Ub(t,r),i}(zu);function Zb(e){return(Zb="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Qb(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function em(e,t,n){return(em="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=om(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function tm(e,t){return(tm=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function nm(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=om(e);if(t){var o=om(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return rm(this,n)}}function rm(e,t){return!t||"object"!==Zb(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function om(e){return(om=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var im=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&tm(e,t)}(i,e);var t,n,r,o=nm(i);function i(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(e=o.call(this)).autoFit=!1,e.iconDesc=null,e.image=null,e.prepend=!1,e}return t=i,(n=[{key:"_init",value:function(e){em(om(i.prototype),"_init",this).call(this,e),this._setIconDesc(this.iconDesc)}},{key:"_renderProperties",value:function(){em(om(i.prototype),"_renderProperties",this).call(this),this._renderIconDesc()}},{key:"setIconDesc",value:function(e){this.setProperty("iconDesc",e)}},{key:"_setIconDesc",value:function(e){e=lm.ensure(e),this._setProperty("iconDesc",e)}},{key:"_renderIconDesc",value:function(){this._removeFontIcon(),this._removeImageIcon(),!this.iconDesc||this.iconDesc.isFontIcon()?this._renderFontIcon():this._renderImageIcon(),this.invalidateLayoutTree()}},{key:"_renderFontIcon",value:function(){this.$container=this.$parent.appendIcon(this.iconDesc),this.prepend&&this.$container.prependTo(this.$parent),this.htmlComp=ea.install(this.$container,this.session)}},{key:"_removeFontIcon",value:function(){this.$container&&(this.$container.remove(),this.$container=null)}},{key:"_renderImageIcon",value:function(){var e=this;this.image||(this.image=O.create("Image",{parent:this,imageUrl:this.iconDesc.iconUrl,cssClass:"icon image-icon",autoFit:this.autoFit,prepend:this.prepend}),this.image.render(this.$parent),this.image.one("destroy",(function(){e.image=null})),this.image.on("load error",(function(t){e.trigger(t.type,t)})),this.$container=this.image.$container,this.htmlComp=this.image.htmlComp)}},{key:"_removeImageIcon",value:function(){this.image&&(this.image.destroy(),this.image=null)}},{key:"setAutoFit",value:function(e){this.setProperty("autoFit",e),this.image&&this.image.setAutoFit(e)}}])&&Qb(t.prototype,n),r&&Qb(t,r),i}(ve);function sm(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function am(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var lm=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.iconType,this.font,this.iconCharacter,this.iconUrl}var t,n,r;return t=e,r=[{key:"ensure",value:function(t){return t?t instanceof e?t:gn.parseIconId(t):t}}],(n=[{key:"cssClass",value:function(){return this.isFontIcon()&&this.font!==e.DEFAULT_FONT?"font-"+this.font:""}},{key:"appendCssClass",value:function(e){var t=this.cssClass();return t.length>0?e+" "+t:e}},{key:"isFontIcon",value:function(){return this.iconType===e.IconType.FONT_ICON}},{key:"isBitmap",value:function(){return this.iconType===e.IconType.BITMAP}}])&&sm(t.prototype,n),r&&sm(t,r),e}();function um(e){return(um="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function cm(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function fm(e,t,n){return(fm="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=ym(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function hm(e,t){return(hm=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function pm(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=ym(e);if(t){var o=ym(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return dm(this,n)}}function dm(e,t){return!t||"object"!==um(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function ym(e){return(ym=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}am(lm,"IconType",{FONT_ICON:0,BITMAP:1}),am(lm,"DEFAULT_FONT","scoutIcons");var vm=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&hm(e,t)}(i,e);var t,n,r,o=pm(i);function i(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(e=o.call(this)).autoFit=!1,e.imageUrl=null,e.prepend=!1,e}return t=i,(n=[{key:"_render",value:function(){this.$container=this.$parent.makeElement("<img>","image").addDeviceClass().on("load",this._onImageLoad.bind(this)).on("error",this._onImageError.bind(this)),this.prepend?this.$container.prependTo(this.$parent):this.$container.appendTo(this.$parent),this.htmlComp=ea.install(this.$container,this.session),this.htmlComp.setLayout(new Om(this)),this.htmlComp.pixelBasedSizing=!1}},{key:"_renderProperties",value:function(){fm(ym(i.prototype),"_renderProperties",this).call(this),this._renderImageUrl(),this._renderAutoFit()}},{key:"_remove",value:function(){fm(ym(i.prototype),"_remove",this).call(this),this.htmlComp=null}},{key:"setImageUrl",value:function(e){this.setProperty("imageUrl",e)}},{key:"_renderImageUrl",value:function(){this.$container.attr("src",this.imageUrl),this.imageUrl||this.$container.addClass("empty").removeClass("broken")}},{key:"setAutoFit",value:function(e){this.setProperty("autoFit",e)}},{key:"_renderAutoFit",value:function(){this.$container.toggleClass("autofit",this.autoFit),Kt.get().isInternetExplorer()&&(this.autoFit?(this.htmlComp.cssMinSize=function(){return new $s},this.htmlComp.cssMaxSize=function(){return new $s(Number.MAX_VALUE,Number.MAX_VALUE)}):(delete this.htmlComp.cssMinSize,delete this.htmlComp.cssMaxSize),this.invalidateLayoutTree())}},{key:"_onImageLoad",value:function(e){this.rendered&&(this._ensureImageLayout(),this.$container.removeClass("empty broken"),this.invalidateLayoutTree(),this.trigger("load"))}},{key:"_ensureImageLayout",value:function(){var e=this;Kt.get().isChrome()&&(this.$container.addClass("chrome-fix"),setTimeout((function(){e.rendered&&e.$container.removeClass("chrome-fix")})))}},{key:"_onImageError",value:function(e){this.rendered&&(this.$container.addClass("empty broken"),this.invalidateLayoutTree(),this.trigger("error"))}}])&&cm(t.prototype,n),r&&cm(t,r),i}(ve);function bm(e){return(bm="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function mm(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function gm(e,t,n){return(gm="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Sm(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function _m(e,t){return(_m=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function wm(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Sm(e);if(t){var o=Sm(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return km(this,n)}}function km(e,t){return!t||"object"!==bm(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Sm(e){return(Sm=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Om=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_m(e,t)}(i,e);var t,n,r,o=wm(i);function i(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(t=o.call(this)).image=e,t}return t=i,(n=[{key:"preferredLayoutSize",value:function(e,t){var n=e[0];if(n&&n.complete&&n.naturalWidth>0&&n.naturalHeight>0){var r=n.naturalHeight,o=n.naturalWidth;return t.widthHint>0&&t.widthHint<n.naturalWidth?(r=t.widthHint/n.naturalWidth*n.naturalHeight,o=t.widthHint):t.heightHint>0&&t.heightHint<n.naturalHeight&&(r=t.heightHint,o=t.heightHint/n.naturalHeight*n.naturalWidth),new $s(o,r)}return gm(Sm(i.prototype),"preferredLayoutSize",this).call(this,e,t)}}])&&mm(t.prototype,n),r&&mm(t,r),i}(Zs);function Tm(e){return(Tm="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Cm(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Pm(e,t,n){return(Pm="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Dm(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function Rm(e,t){return(Rm=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function xm(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Dm(e);if(t){var o=Dm(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Em(this,n)}}function Em(e,t){return!t||"object"!==Tm(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Dm(e){return(Dm=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Am=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Rm(e,t)}(i,e);var t,n,r,o=xm(i);function i(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(e=o.call(this)).status=Br.info(),e.closable=!1,e.htmlEnabled=!1,e}return t=i,(n=[{key:"_init",value:function(e){Pm(Dm(i.prototype),"_init",this).call(this,e),(e.severity||e.message)&&(this.status=new Br({severity:O.nvl(e.severity,this.status.severity),message:O.nvl(e.message,this.status.message)})),bp.resolveTextProperty(this.status,"message",this.session),this._setStatus(this.status)}},{key:"_render",value:function(){this.$container=this.$parent.appendDiv("notification"),this.$content=this.$container.appendDiv("notification-content"),this.$messageText=this.$content.appendDiv("notification-message"),this.htmlComp=ea.install(this.$container,this.session)}},{key:"_remove",value:function(){Pm(Dm(i.prototype),"_remove",this).call(this),this._removeCloser()}},{key:"_renderProperties",value:function(){Pm(Dm(i.prototype),"_renderProperties",this).call(this),this._renderStatus(),this._renderClosable()}},{key:"setStatus",value:function(e){this.setProperty("status",e)}},{key:"_setStatus",value:function(e){this.rendered&&this._removeStatus(),e=Br.ensure(e),this._setProperty("status",e)}},{key:"_removeStatus",value:function(){this.status&&this.$container.removeClass(this.status.cssClass())}},{key:"_renderStatus",value:function(){this.status&&this.$container.addClass(this.status.cssClass()),this._renderMessage()}},{key:"_renderMessage",value:function(){var e=this.status.message||"";this.htmlEnabled?(this.$messageText.html(e),this.$messageText.find(".app-link").on("click",this._onAppLinkAction.bind(this))):this.$messageText.html(Wn.nl2br(e)),this.invalidateLayoutTree()}},{key:"setClosable",value:function(e){this.setProperty("closable",e)}},{key:"_renderClosable",value:function(){this.$content.toggleClass("closable",this.closable),this.closable?this._renderCloser():this._removeCloser()}},{key:"_removeCloser",value:function(){this.$closer&&(this.$closer.remove(),this.$closer=null)}},{key:"_renderCloser",value:function(){this.$closer||(this.$closer=this.$content.appendDiv("closer").on("click",this._onCloseIconClick.bind(this)))}},{key:"_onCloseIconClick",value:function(){this._removing||this.trigger("close")}},{key:"_onAppLinkAction",value:function(e){var t=s()(e.delegateTarget).data("ref");this.triggerAppLinkAction(t)}},{key:"triggerAppLinkAction",value:function(e){this.trigger("appLinkAction",{ref:e})}}])&&Cm(t.prototype,n),r&&Cm(t,r),i}(ve);function Fm(e){return(Fm="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function $m(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function jm(e,t,n){return(jm="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Lm(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function Bm(e,t){return(Bm=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Mm(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Lm(e);if(t){var o=Lm(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Im(this,n)}}function Im(e,t){return!t||"object"!==Fm(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Lm(e){return(Lm=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Hm=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Bm(e,t)}(i,e);var t,n,r,o=Mm(i);function i(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),o.call(this)}return t=i,(n=[{key:"_onWidgetClose",value:function(e){this._send("close",{ref:e.ref})}},{key:"_onWidgetAppLinkAction",value:function(e){this._send("appLinkAction",{ref:e.ref})}},{key:"_onWidgetEvent",value:function(e){"close"===e.type?this._onWidgetClose(e):"appLinkAction"===e.type?this._onWidgetAppLinkAction(e):jm(Lm(i.prototype),"_onWidgetEvent",this).call(this,e)}}])&&$m(t.prototype,n),r&&$m(t,r),i}(de);function Nm(e,t,n,r,o){if(e){t=rt.ensure(t),o=rt.ensure(o);var i=[],s=0;return e.forEach((function(e){var a=e.childActions;if(a.length>0){if(0===(a=Nm(a,t,n,r,o)).length)return void Vm(e,r,!0)}else if(!Wm(e,t)||0!==o.length&&Wm(e,o))return void Vm(e,r,!0);!n||e.visible?(e.separator&&s++,Vm(e,r,!1),i.push(e)):Vm(e,r,!0)})),s===i.length?[]:i}}function Vm(e,t,n){t&&(e.excludedByFilter=n)}function Wm(e,t){if(!t||0===t.length)return!1;if(!e.menuTypes)return!1;for(var n=0;n<t.length;n++)if(e.menuTypes.indexOf(t[n])>-1)return!0}var zm={checkType:function(e,t){return t=rt.ensure(t),e.childActions.length>0?Nm(e.childActions,t).length>0:Wm(e,t)},createEllipsisMenu:function(e){var t={iconId:gn.ELLIPSIS_V,tabbable:!1};return e=s.a.extend({},t,e),O.create("Menu",e)},filter:Nm,filterAccordingToSelection:function(e,t,n,r,o,i,s){var a=[];r===Gm.MENU_BAR?a=[e+".EmptySpace",e+".SingleSelection",e+".MultiSelection"]:r===Gm.CONTEXT_MENU?a=[e+".SingleSelection",e+".MultiSelection"]:r===Gm.HEADER&&(a=[e+".Header"]),a.indexOf(e+".SingleSelection")>-1&&1!==t&&rt.remove(a,e+".SingleSelection"),a.indexOf(e+".MultiSelection")>-1&&t<=1&&rt.remove(a,e+".MultiSelection"),s=rt.ensure(s);var l=[];return e+=".",s.forEach((function(t){t.slice(0,e.length)!==e&&(t=e+t),l.push(t)}),this),Nm(n,a,o,i,l)},moveMenuIntoEllipsis:function(e,t){e.remove(),e.overflow=!0,e.overflowMenu=t;var n=t.childActions.slice();n.unshift(e),t.setChildActions(n)},removeMenuFromEllipsis:function(e,t){e.overflow=!1,e.overflowMenu=null,e.rendered||e.render(t)},updateSeparatorVisibility:function(e){if(0!==(e=(e=rt.ensure(e)).filter((function(e){return e.visible||e.separator}))).length){var t=!1,n=!1;e.forEach((function(r,o){r.ellipsis||(r.separator?(n=e[o+1]&&!e[o+1].separator&&!e[o+1].ellipsis,t&&n?void 0!==r.visibleOrig&&(r.setVisible(r.visibleOrig),r.visibleOrig=void 0):void 0===r.visibleOrig&&(r.visibleOrig=r.visible,r.setVisible(!1))):t=!0)}))}}},Gm={MENU_BAR:1,CONTEXT_MENU:2,HEADER:3};function Um(e){return(Um="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Km(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function qm(e,t,n){return(qm="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Zm(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function Ym(e,t){return(Ym=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Xm(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Zm(e);if(t){var o=Zm(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Jm(this,n)}}function Jm(e,t){return!t||"object"!==Um(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Zm(e){return(Zm=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Qm(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var eg=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ym(e,t)}(i,e);var t,n,r,o=Xm(i);function i(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(e=o.call(this)).childActions=[],e.defaultMenu=null,e.excludedByFilter=!1,e.menuTypes=[],e.menuStyle=i.MenuStyle.NONE,e.overflown=!1,e.parentMenu=null,e.popup=null,e.popupHorizontalAlignment=void 0,e.popupVerticalAlignment=void 0,e.stackable=!0,e.separator=!1,e.shrinkable=!1,e.subMenuVisibility=i.SubMenuVisibility.DEFAULT,e.menuFilter=null,e.$submenuIcon=null,e.$subMenuBody=null,e._addCloneProperties(["defaultMenu","menuTypes","overflow","stackable","separator","shrinkable","parentMenu","menuFilter"]),e._addWidgetProperties("childActions"),e}return t=i,(n=[{key:"_init",value:function(e){qm(Zm(i.prototype),"_init",this).call(this,e),this._setChildActions(this.childActions)}},{key:"_initKeyStrokeContext",value:function(){qm(Zm(i.prototype),"_initKeyStrokeContext",this).call(this),this.keyStrokeContext.registerKeyStroke(new Eg(this))}},{key:"_render",value:function(){this.separator?this._renderSeparator():this._renderItem(),this.$container.unfocusable(),this.htmlComp=ea.install(this.$container,this.session)}},{key:"_renderProperties",value:function(){qm(Zm(i.prototype),"_renderProperties",this).call(this),this._renderOverflown(),this._renderMenuStyle(),this._renderActionStyle(),this._updateIconAndTextStyle()}},{key:"_remove",value:function(){qm(Zm(i.prototype),"_remove",this).call(this),this.$submenuIcon=null,this.$subMenuBody=null}},{key:"_renderSeparator",value:function(){this.$container=this.$parent.appendDiv("menu-separator")}},{key:"_renderItem",value:function(){this.$container=this.$parent.appendDiv("menu-item"),this.uiCssClass&&this.$container.addClass(this.uiCssClass);var e=this._onMouseEvent.bind(this);this.$container.on("mousedown",e).on("contextmenu",e).on("click",e),this._renderSubMenuIcon()}},{key:"_renderActionStyle",value:function(){this.$container.toggleClass("menu-button",this.isButton()&&!this.overflown)}},{key:"_renderSelected",value:function(){this._doActionTogglesSubMenu()||(qm(Zm(i.prototype),"_renderSelected",this).call(this),this.parent instanceof Qg&&this.parent.updateNextToSelected()),this.selected?this._doActionTogglesSubMenu()?this._renderSubMenuItems(this,this.childActions):this._doActionTogglesPopup()&&this._openPopup():this._doActionTogglesSubMenu()&&this.rendered?this._removeSubMenuItems(this):(this._closePopup(),this._closeSubMenues())}},{key:"_closeSubMenues",value:function(){this.childActions.forEach((function(e){e._doActionTogglesPopup()&&(e._closeSubMenues(),e.setSelected(!1))}))}},{key:"_removeSubMenuItems",value:function(e){this.parent instanceof Qg?this.parent.removeSubMenuItems(e,!0):this.parent instanceof i&&this.parent._removeSubMenuItems(e)}},{key:"_renderSubMenuItems",value:function(e,t){var n=this;if(this.parent instanceof Qg){this.parent.renderSubMenuItems(e,t,!0);var r=function(t){e.setSelected(!1)};this.parent.on("close",r),e.on("propertyChange",(function t(o){"selected"===o.propertyName&&!1===o.newValue&&(n.parent.off("close",r),e.off("propertyChange",t))}))}else this.parent instanceof i&&this.parent._renderSubMenuItems(e,t)}},{key:"_togglesSubMenu",value:function(){return!0}},{key:"_doActionTogglesSubMenu",value:function(){return!!this.childActions.length&&(this.parent instanceof Qg||this.parent instanceof i&&this.parent._togglesSubMenu())}},{key:"_getSubMenuLevel",value:function(){return this.parent instanceof Qg?0:qm(Zm(i.prototype),"_getSubMenuLevel",this).call(this)+1}},{key:"_onMouseEvent",value:function(e){"mousedown"===e.type&&this._doubleClickSupport.mousedown(e),this._allowMouseEvent(e)&&(xp.cancel(this.$container),"mousedown"===e.type&&this._doActionTogglesPopup()?this.doAction():"click"!==e.type&&"contextmenu"!==e.type||this._doActionTogglesPopup()||this.doAction())}},{key:"_doActionTogglesPopup",value:function(){return this.childActions.length>0}},{key:"_renderChildActions",value:function(){if(Pr.optProperty(this.popup,"rendered")){var e=this.popup.$container;this.childActions.forEach((function(t){t.render(e)}))}this._renderSubMenuIcon()}},{key:"setSubMenuVisibility",value:function(e){this.setProperty("subMenuVisibility",e)}},{key:"_renderSubMenuVisibility",value:function(){this._renderSubMenuIcon()}},{key:"_renderSubMenuIcon",value:function(){var e=!1;if(this.childActions.length>0)switch(this.subMenuVisibility){case i.SubMenuVisibility.DEFAULT:e=this._hasText();break;case i.SubMenuVisibility.TEXT_OR_ICON:e=this._hasText()||this.iconId;break;case i.SubMenuVisibility.ALWAYS:e=!0;break;case i.SubMenuVisibility.NEVER:e=!1}if(e){if(!this.$submenuIcon){var t=gn.parseIconId(i.SUBMENU_ICON);this.$submenuIcon=this.$container.appendSpan("submenu-icon").text(t.iconCharacter),this.invalidateLayoutTree()}}else this.$submenuIcon&&(this.$submenuIcon.remove(),this.$submenuIcon=null,this.invalidateLayoutTree());this.rendered&&this._renderTextPosition()}},{key:"_renderText",value:function(e){qm(Zm(i.prototype),"_renderText",this).call(this,e),this.$container.toggleClass("has-text",Wn.hasText(this.text)&&this.textVisible),this.rendered&&(this._updateIconAndTextStyle(),this._renderSubMenuIcon()),this.invalidateLayoutTree()}},{key:"_renderTextPosition",value:function(){qm(Zm(i.prototype),"_renderTextPosition",this).call(this);var e=this.$container;this.textPosition===Up.TextPosition.BOTTOM&&this.$text&&this.iconId&&(e=this.$text),this.$submenuIcon&&this.$submenuIcon.appendTo(e)}},{key:"_renderIconId",value:function(){qm(Zm(i.prototype),"_renderIconId",this).call(this),this.$container.toggleClass("has-icon",!!this.iconId),this.rendered&&(this._updateIconAndTextStyle(),this._renderSubMenuIcon()),this.invalidateLayoutTree()}},{key:"isTabTarget",value:function(){return this.enabledComputed&&this.visible&&!this.overflown&&(this.isButton()||!this.separator)}},{key:"recomputeEnabled",value:function(e){var t,n;void 0===e&&(e=this._getInheritedAccessibility()),n=this.enabled&&this.inheritAccessibility&&!e&&this.childActions.length>0?!!(t=this._hasAccessibleChildMenu())&&e:t=this._computeEnabled(this.inheritAccessibility,e),this._updateEnabledComputed(t,n)}},{key:"_getInheritedAccessibility",value:function(){for(var e=this,t=e;e;){if(!e.inheritAccessibility)return e.enabled;t=e,e=e.parentMenu}var n=t.parent;return!n||!n.initialized||void 0===n.enabledComputed||n.enabledComputed}},{key:"_findRootMenu",value:function(){for(var e,t=this;t;)e=t,t=t.parentMenu;return e}},{key:"_hasAccessibleChildMenu",value:function(){var e=!1;return this.visitChildMenus((function(t){return!t.inheritAccessibility&&t.enabled&&t.visible?(e=!0,iU.TERMINATE):iU.CONTINUE})),e}},{key:"visitChildMenus",value:function(e){for(var t=0;t<this.childActions.length;t++){var n=this.childActions[t];if(n instanceof i){var r=e(n);if(!0===r||r===iU.TERMINATE)return iU.TERMINATE;if(r!==iU.SKIP_SUBTREE&&(!0===(r=n.visitChildMenus(e))||r===iU.TERMINATE))return iU.TERMINATE}}}},{key:"_hasText",value:function(){return Wn.hasText(this.text)&&this.textVisible}},{key:"_updateIconAndTextStyle",value:function(){var e=this._hasText(),t=!(!e||!this.iconId);this.$container.toggleClass("menu-textandicon",t),this.$container.toggleClass("menu-icononly",!e)}},{key:"_closePopup",value:function(){this.popup&&!this.popup._isRemovalPending()&&this.popup.close()}},{key:"_openPopup",value:function(){var e=this;this.popup||(this.popup=this._createPopup(),this.popup.open(),this.popup.on("remove",(function(t){e.popup=null})),this.popup.on("close",(function(t){e.setSelected(!1)})),this.uiCssClass&&this.popup.$container.addClass(this.uiCssClass))}},{key:"_createPopup",value:function(e){var t={parent:this,menu:this,menuFilter:this.menuFilter,ignoreEvent:e,horizontalAlignment:this.popupHorizontalAlignment,verticalAlignment:this.popupVerticalAlignment};return O.create("MenuBarPopup",t)}},{key:"_createActionKeyStroke",value:function(){return new kg(this)}},{key:"isToggleAction",value:function(){return this.childActions.length>0||this.toggleAction}},{key:"isButton",value:function(){return Up.ActionStyle.BUTTON===this.actionStyle}},{key:"addChildActions",value:function(e){this.insertChildActions(e)}},{key:"insertChildAction",value:function(e){this.insertChildActions([e])}},{key:"insertChildActions",value:function(e){0!==(e=rt.ensure(e)).length&&this.setChildActions(this.childActions.concat(e))}},{key:"deleteChildAction",value:function(e){this.deleteChildActions([e])}},{key:"deleteChildActions",value:function(e){if(0!==(e=rt.ensure(e)).length){var t=this.childActions.slice();rt.removeAll(t,e),this.setChildActions(t)}}},{key:"setChildActions",value:function(e){this.setProperty("childActions",e)}},{key:"_setChildActions",value:function(e){var t=this;this.childActions.forEach((function(e){e.parentMenu=null})),this._setProperty("childActions",e),this.childActions.forEach((function(e){e.parentMenu=t})),this.initialized&&this.recomputeEnabled()}},{key:"_setInheritAccessibility",value:function(e){this._setProperty("inheritAccessibility",e),this.initialized&&this._findRootMenu().recomputeEnabled()}},{key:"_setEnabled",value:function(e){this._setProperty("enabled",e),this.initialized&&this._findRootMenu().recomputeEnabled()}},{key:"_setVisible",value:function(e){this._setProperty("visible",e),this.initialized&&this._findRootMenu().recomputeEnabled()}},{key:"setSelected",value:function(e){e!==this.selected&&(qm(Zm(i.prototype),"setSelected",this).call(this,e),(this._doActionTogglesSubMenu()||this._doActionTogglesPopup())&&this.overflowMenu&&!this.overflowMenu.selected&&this._handleSelectedInEllipsis())}},{key:"_handleSelectedInEllipsis",value:function(){this.selected&&this.overflowMenu.setSelected(!0)}},{key:"setStackable",value:function(e){this.setProperty("stackable",e)}},{key:"_renderStackable",value:function(){this.invalidateLayoutTree()}},{key:"setShrinkable",value:function(e){this.setProperty("shrinkable",e)}},{key:"_renderShrinkable",value:function(){this.invalidateLayoutTree()}},{key:"_setOverflown",value:function(e){this.overflown!==e&&(this._setProperty("overflown",e),this.rendered&&this._renderOverflown())}},{key:"_renderOverflown",value:function(){this.$container.toggleClass("overflown",this.overflown),this._renderActionStyle()}},{key:"setMenuStyle",value:function(e){this.setProperty("menuStyle",e)}},{key:"_renderMenuStyle",value:function(){this.$container.toggleClass("default-menu",this.menuStyle===i.MenuStyle.DEFAULT)}},{key:"setDefaultMenu",value:function(e){this.setProperty("defaultMenu",e)}},{key:"setMenuFilter",value:function(e){this.setProperty("menuFilter",e),this.childActions.forEach((function(t){t.setMenuFilter(e)}))}},{key:"clone",value:function(e,t){var n=qm(Zm(i.prototype),"clone",this).call(this,e,t);return this._deepCloneProperties(n,"childActions",t),n._setChildActions(n.childActions),n}},{key:"focus",value:function(){var e=new sn({source:this});return this.trigger("focus",e),!e.defaultPrevented&&qm(Zm(i.prototype),"focus",this).call(this)}}])&&Km(t.prototype,n),r&&Km(t,r),i}(Up);function tg(e){return(tg="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ng(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function rg(e,t,n){return(rg="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=ag(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function og(e,t){return(og=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function ig(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=ag(e);if(t){var o=ag(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return sg(this,n)}}function sg(e,t){return!t||"object"!==tg(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function ag(e){return(ag=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}Qm(eg,"SUBMENU_ICON",gn.ANGLE_DOWN_BOLD),Qm(eg,"MenuStyle",{NONE:0,DEFAULT:1}),Qm(eg,"SubMenuVisibility",{DEFAULT:"default",TEXT_OR_ICON:"textOrIcon",ALWAYS:"always",NEVER:"never"});var lg=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&og(e,t)}(i,e);var t,n,r,o=ig(i);function i(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(e=o.call(this)).hidden=!0,e.ellipsis=!0,e.stackable=!1,e.horizontalAlignment=1,e.iconId=gn.ELLIPSIS_V,e.tabbable=!1,e.rightAligned=!1,e._addPreserveOnPropertyChangeProperties(["childActions"]),e}return t=i,(n=[{key:"_render",value:function(){rg(ag(i.prototype),"_render",this).call(this),this.$container.addClass("ellipsis")}},{key:"setChildActions",value:function(e){rg(ag(i.prototype),"setChildActions",this).call(this,e),e&&e.forEach((function(e){e.setSelected(!1)}))}},{key:"_renderProperties",value:function(){rg(ag(i.prototype),"_renderProperties",this).call(this),this._renderHidden()}},{key:"setHidden",value:function(e){this.setProperty("hidden",e)}},{key:"_renderHidden",value:function(){this.$container.setVisible(!this.hidden)}},{key:"isTabTarget",value:function(){return rg(ag(i.prototype),"isTabTarget",this).call(this)&&!this.hidden}}])&&ng(t.prototype,n),r&&ng(t,r),i}(eg);function ug(e){return(ug="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function cg(e,t){return(cg=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function fg(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pg(e);if(t){var o=pg(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return hg(this,n)}}function hg(e,t){return!t||"object"!==ug(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function pg(e){return(pg=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var dg=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&cg(e,t)}(n,e);var t=fg(n);function n(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),t.call(this)}return n}(ed);function yg(e){return(yg="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function vg(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function bg(e,t,n){return(bg="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=wg(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function mg(e,t){return(mg=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function gg(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=wg(e);if(t){var o=wg(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return _g(this,n)}}function _g(e,t){return!t||"object"!==yg(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function wg(e){return(wg=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var kg=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&mg(e,t)}(i,e);var t,n,r,o=gg(i);function i(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),o.call(this,e)}return t=i,(n=[{key:"_isEnabled",value:function(){return!this.field.excludedByFilter&&bg(wg(i.prototype),"_isEnabled",this).call(this)}}])&&vg(t.prototype,n),r&&vg(t,r),i}(ld);function Sg(e){return(Sg="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Og(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Tg(e,t){return(Tg=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Cg(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=xg(e);if(t){var o=xg(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Pg(this,n)}}function Pg(e,t){return!t||"object"!==Sg(t)&&"function"!=typeof t?Rg(e):t}function Rg(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function xg(e){return(xg=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Eg=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Tg(e,t)}(i,e);var t,n,r,o=Cg(i);function i(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(t=o.call(this)).field=e,t.which=[Ou.SPACE,Ou.ENTER],t.stopPropagation=!0,t.renderingHints.offset=16,t.renderingHints.$drawingArea=function(e,t){return this.field.$container}.bind(Rg(t)),t}return t=i,(n=[{key:"handle",value:function(e){this.field.doAction()}}])&&Og(t.prototype,n),r&&Og(t,r),i}(zu);function Dg(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Ag=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.session=t,this.objectType=n,this.emptySpaceTypes=["EmptySpace"],this.selectionTypes=["SingleSelection","MultiSelection"]}var t,n,r;return t=e,(n=[{key:"order",value:function(e){var t=[],n=[],r=[],o=[],i=!1,s=!1;return e.forEach((function(e){e.createdBy!==this&&(e.isButton()?t.push(e):1===e.horizontalAlignment?o.push(e):zm.checkType(e,this._menuTypes(this.emptySpaceTypes))?(e.visible&&(i=!0),n.push(e)):zm.checkType(e,this._menuTypes(this.selectionTypes))&&(e.visible&&(s=!0),r.push(e)))}),this),i&&s&&n.push(this._createSeparator()),{left:t.concat(n,r),right:o,all:t.concat(n,r).concat(o)}}},{key:"_menuTypes",value:function(e){var t,n=[];for(e=e||[],t=0;t<e.length;t++)n.push(this.objectType+"."+e[t]);return n}},{key:"_createSeparator",value:function(){return O.create("Menu",{parent:this.menuBar,createdBy:this,separator:!0})}}])&&Dg(t.prototype,n),r&&Dg(t,r),e}();function Fg(e){return(Fg="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function $g(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function jg(e,t){return(jg=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Bg(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ig(e);if(t){var o=Ig(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Mg(this,n)}}function Mg(e,t){return!t||"object"!==Fg(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Ig(e){return(Ig=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Lg=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&jg(e,t)}(i,e);var t,n,r,o=Bg(i);function i(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),o.call(this)}return t=i,(n=[{key:"_render",value:function(){this.$container=this.$parent.appendDiv("menu-item combo-menu"),this.uiCssClass&&this.$container.addClass(this.uiCssClass),this.$container.unfocusable(),this.htmlComp=ea.install(this.$container,this.session),this.childActions.forEach((function(e){e.addCssClass("combo-menu-child"),e.render()}))}},{key:"_togglesSubMenu",value:function(){return!1}}])&&$g(t.prototype,n),r&&$g(t,r),i}(eg);function Hg(e){return(Hg="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ng(e,t){return(Ng=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Vg(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=zg(e);if(t){var o=zg(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Wg(this,n)}}function Wg(e,t){return!t||"object"!==Hg(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function zg(e){return(zg=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Gg=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ng(e,t)}(n,e);var t=Vg(n);function n(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),t.call(this)}return n}(dg);function Ug(e){return(Ug="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Kg(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function qg(e,t,n){return(qg="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Zg(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function Yg(e,t){return(Yg=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Xg(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Zg(e);if(t){var o=Zg(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Jg(this,n)}}function Jg(e,t){return!t||"object"!==Ug(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Zg(e){return(Zg=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Qg=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Yg(e,t)}(i,e);var t,n,r,o=Xg(i);function i(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(e=o.call(this))._headVisible=!1,e.menuItems=[],e.cloneMenuItems=!0,e._toggleSubMenuQueue=[],e.repositionEnabled=!0,e}return t=i,(n=[{key:"_init",value:function(e){e.focusableContainer=!0,!1===e.cloneMenuItems&&this._addWidgetProperties("menuItems"),qg(Zg(i.prototype),"_init",this).call(this,e)}},{key:"_initKeyStrokeContext",value:function(){qg(Zg(i.prototype),"_initKeyStrokeContext",this).call(this),Q_.registerKeyStrokes(this.keyStrokeContext,this,"menu-item")}},{key:"_createLayout",value:function(){return new a_(this)}},{key:"_createBodyLayout",value:function(){return new El({pixelBasedSizing:!1})}},{key:"_render",value:function(){qg(Zg(i.prototype),"_render",this).call(this),this._installScrollbars(),this._renderMenuItems()}},{key:"_installScrollbars",value:function(e){qg(Zg(i.prototype),"_installScrollbars",this).call(this,{axis:"y"})}},{key:"get$Scrollable",value:function(){return this.$body}},{key:"removeSubMenuItems",value:function(e,t){if(this.rendered||this.rendering)if(this.bodyAnimating)this._toggleSubMenuQueue.push(this.removeSubMenuItems.bind(this,e,t));else{this.$body=e.__originalParent.$subMenuBody,this.$body.insertBefore(e.$subMenuBody),e.__originalParent._doActionTogglesSubMenu&&e.__originalParent._doActionTogglesSubMenu();var n=this.htmlComp.offsetBounds().subtractFromDimension(this.htmlComp.insets());if(this.revalidateLayout(),this.position(),t){this.bodyAnimating=!0;var r=300,o=e.$placeHolder.position();e.$subMenuBody.css({width:"auto",height:"auto"});var i=this.htmlComp.offsetBounds().subtractFromDimension(this.htmlComp.insets());e.$subMenuBody.css("box-shadow","none"),this.htmlComp.setBounds(n),this.verticalAlignment!==Id.Alignment.TOP&&e.$subMenuBody.cssTop(),this._animateTopAndLeft(this.htmlComp.$comp,n,i,r),e.$subMenuBody.cssHeightAnimated(n.height,e.$container.cssHeight(),{duration:r,queue:!1});var s=o.top-this.$body.cssHeight(),a=0-n.height;e.$subMenuBody.cssTopAnimated(a,s,{duration:r,queue:!1,complete:function(){if(e.$container){Lh.uninstall(e.$subMenuBody,this.session),e.$placeHolder.replaceWith(e.$container),e.$container.toggleClass("expanded",!1),this._updateFirstLastClass(),this.updateNextToSelected("menu-item",e.$container),e.$subMenuBody.detach(),this._installScrollbars(),this.$body.css("box-shadow",""),this.bodyAnimating=!1,this._invalidateLayoutTreeAndRepositionPopup();var t=this._toggleSubMenuQueue.shift();t&&t()}}.bind(this)}),this.$body.cssWidthAnimated(n.width,i.width,{duration:r,start:this.revalidateLayout.bind(this,!0),progress:this.revalidateLayout.bind(this,!1),queue:!1}),i.height!==n.height&&this.$body.cssHeightAnimated(n.height,i.height,{duration:r,queue:!1})}}}},{key:"renderSubMenuItems",value:function(e,t,n,r){if(this.session.desktop.rendered||r){if(this.rendered||this.rendering)if(this.bodyAnimating)this._toggleSubMenuQueue.push(this.renderSubMenuItems.bind(this,e,t,n,r));else{var o=this.htmlComp.offsetBounds().subtractFromDimension(this.htmlComp.insets());e.__originalParent.$subMenuBody=this.$body,this.$body.find(".menu-item").removeClass("next-to-selected"),e.$subMenuBody?this.$body=e.$subMenuBody:(this._$createBody(),e.$subMenuBody=this.$body,this._renderMenuItems(t,r));var i=e.$container.prev(),s=e.$container.position();if(e.$placeHolder=e.$container.clone(),ea.install(e.$placeHolder,this.session),i.length?e.$placeHolder.insertAfter(i):e.__originalParent.$subMenuBody.prepend(e.$placeHolder),this.$body.insertAfter(e.__originalParent.$subMenuBody),this.$body.prepend(e.$container),e.$container.toggleClass("expanded"),this.revalidateLayout(),this.position(),this.updateNextToSelected(),n){this.bodyAnimating=!0;var a=300;e.__originalParent.$subMenuBody.css({width:"auto",height:"auto"});var l=this.htmlComp.offsetBounds().subtractFromDimension(this.htmlComp.insets());this._animateTopAndLeft(this.htmlComp.$comp,o,l,a),this.$body.css("box-shadow","none"),this.$body.cssWidthAnimated(o.width,l.width,{duration:a,start:this.revalidateLayout.bind(this,!0),progress:this.revalidateLayout.bind(this,!1),queue:!1}),this.$body.cssHeightAnimated(e.$container.cssHeight(),l.height,{duration:a,queue:!1});var u=0-l.height,c=s.top-e.__originalParent.$subMenuBody.cssHeight();this.$body.cssTopAnimated(c,u,{duration:a,queue:!1,complete:function(){this.bodyAnimating=!1,e.__originalParent.$subMenuBody&&(Lh.uninstall(e.__originalParent.$subMenuBody,this.session),e.__originalParent.$subMenuBody.detach(),this.$body.cssTop(0),this._installScrollbars(),this._updateFirstLastClass(),this.$body.css("box-shadow","")),this._invalidateLayoutTreeAndRepositionPopup();var t=this._toggleSubMenuQueue.shift();t&&t()}.bind(this)}),o.height!==l.height&&(e.__originalParent.$subMenuBody.cssHeightAnimated(o.height,l.height,{duration:a,queue:!1}),this.$container.cssHeight(o.height,l.height,{duration:a,queue:!1})),this.verticalAlignment===Id.Alignment.TOP&&(this.$container.cssTopAnimated(o.y,l.y,{duration:a,queue:!1}).css("overflow","visible"),this.$head.cssTopAnimated(o.height,l.height,{duration:a,queue:!1}),this.$deco.cssTopAnimated(o.height-1,l.height-1,{duration:a,queue:!1}))}else r||Lh.uninstall(e.__originalParent.$subMenuBody,this.session),e.__originalParent.$subMenuBody.detach(),this._installScrollbars(),this._updateFirstLastClass()}}else this.initialSubMenusToRender={parentMenu:e,menus:t}}},{key:"_animateTopAndLeft",value:function(e,t,n,r){var o={duration:r,queue:!1};e.cssTopAnimated(t.y,n.y,o).cssLeftAnimated(t.x,n.x,o)}},{key:"revalidateLayout",value:function(e){this.repositionEnabled=scout.nvl(e,!0),qg(Zg(i.prototype),"revalidateLayout",this).call(this),this.repositionEnabled=!0}},{key:"_renderMenuItems",value:function(e,t){e=e||this._getMenuItems(),this.menuFilter&&(e=this.menuFilter(e,Gm.CONTEXT_MENU)),e&&0!==e.length&&(e.forEach((function(e){if(!e.separator){var t=e.parent;this.cloneMenuItems&&!e.cloneOf&&((e=e.clone({parent:this,textPosition:Up.TextPosition.DEFAULT},{delegateEventsToOriginal:["acceptInput","action","click"],delegateAllPropertiesToClone:!0,delegateAllPropertiesToOriginal:!0,excludePropertiesToOriginal:["selected","logicalGrid","tabbable"]})).setTabbable(!1),this._attachCloneMenuListeners(e)),e.__originalParent||(e.__originalParent=t),e.render(this.$body),this._attachMenuListeners(e),e.icon&&e.icon.on("load error",this._invalidateLayoutTreeAndRepositionPopup.bind(this))}}),this),this._handleInitialSubMenus(t),this._updateFirstLastClass())}},{key:"_attachCloneMenuListeners",value:function(e){e.on("propertyChange",this._onCloneMenuPropertyChange.bind(this)),e.childActions.forEach(this._attachCloneMenuListeners.bind(this))}},{key:"_onCloneMenuPropertyChange",value:function(e){"selected"===e.propertyName&&e.source.cloneOf.triggerPropertyChange("selected",e.oldValue,e.newValue)}},{key:"_handleInitialSubMenus",value:function(e){if(!e)for(var t;this.initialSubMenusToRender;)t=this.initialSubMenusToRender,this.initialSubMenusToRender=void 0,this.renderSubMenuItems(t.parentMenu,t.menus,!1,!0)}},{key:"_attachMenuListeners",value:function(e){var t=this._onMenuItemAction.bind(this),n=this._onMenuItemPropertyChange.bind(this);e.on("action",t),e.on("propertyChange",n),this.one("remove",(function(){e.off("action",t),e.off("propertyChange",n)}))}},{key:"_modifyBody",value:function(){this.$body.addClass("context-menu")}},{key:"updateMenuItems",value:function(e){e=rt.ensure(e),rt.equals(this.menuItems,e)||this.close()}},{key:"_getMenuItems",value:function(){return this.menuItems}},{key:"$menuItems",value:function(){return this.$body.children(".menu-item")}},{key:"$visibleMenuItems",value:function(){return this.$body.children(".menu-item:visible")}},{key:"_updateFirstLastClass",value:function(e){var t,n;this.$body.children(".menu-item").each((function(){var e=s()(this);e.removeClass("context-menu-item-first context-menu-item-last"),e.isVisible()&&(t||(t=e),n=e)})),t&&t.addClass("context-menu-item-first"),n&&n.addClass("context-menu-item-last")}},{key:"updateNextToSelected",value:function(e,t){e=e||"menu-item";var n=this.$body.find("."+e);t=t||this.$body.find("."+e+".selected"),n.removeClass("next-to-selected"),t.hasClass("selected")&&t.nextAll(":visible").first().addClass("next-to-selected")}},{key:"_onMenuItemAction",value:function(e){e.source.isToggleAction()||this.close()}},{key:"_onMenuItemPropertyChange",value:function(e){this.rendered&&("visible"===e.propertyName?this._updateFirstLastClass():"selected"===e.propertyName&&this._deselectSiblings(e.source),this.position())}},{key:"_deselectSiblings",value:function(e){e.$container.siblings(".menu-item").each((function(e,t){s()(t).select(!1)}),this)}},{key:"_invalidateLayoutTreeAndRepositionPopup",value:function(){var e=this;this.invalidateLayoutTree(),this.session.layoutValidator.schedulePostValidateFunction((function(){e.rendered&&e.position()}))}}])&&Kg(t.prototype,n),r&&Kg(t,r),i}(wy);function e_(e){return(e_="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function t_(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function n_(e,t,n){return(n_="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=s_(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function r_(e,t){return(r_=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function o_(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=s_(e);if(t){var o=s_(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return i_(this,n)}}function i_(e,t){return!t||"object"!==e_(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function s_(e){return(s_=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var a_=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&r_(e,t)}(i,e);var t,n,r,o=o_(i);function i(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),o.call(this,e)}return t=i,(n=[{key:"layout",value:function(e){var t=this.popup.$visibleMenuItems();this._adjustTextAlignment(t),this._resetMaxWidthFor(t),n_(s_(i.prototype),"layout",this).call(this,e),this._setMaxWidthFor(t)}},{key:"_adjustTextAlignment",value:function(e){var t=0;e.each((function(e,n){var r=s()(n).children(".icon"),o=0;r.length>0&&(o=r.outerWidth(!0)),t=Math.max(t,o)})),e.each((function(e,n){var r=s()(n),o=r.children(".icon"),i=r.children(".text"),a=0;o.length>0&&(a=o.outerWidth(!0)),i.css("padding-left",t-a);var l=ea.optGet(r);l&&l.invalidateLayout()}))}},{key:"_resetMaxWidthFor",value:function(e){e.each((function(e,t){var n=s()(t).data("widget");n&&n.$text&&n.$text.css("max-width","")}))}},{key:"_setMaxWidthFor",value:function(e){var t=this;e.each((function(e,n){var r=s()(n).data("widget");if(r&&r.$text){var o=t._calcTextMaxWidth(r);r.$text.cssPxValue("max-width",o)}}))}},{key:"_calcTextMaxWidth",value:function(e){var t=e.$container.width(),n=e.get$Icon(),r=e.$text,o=e.$submenuIcon,i=t+1;return r&&r.isVisible()&&(i-=r.cssMarginX()),n&&n.isVisible()&&(i-=n.outerWidth(!0)),o&&o.isVisible()&&(i-=o.outerWidth(!0)),i}}])&&t_(t.prototype,n),r&&t_(t,r),i}(xy);function l_(e){return(l_="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function u_(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function c_(e,t,n){return(c_="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=d_(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function f_(e,t){return(f_=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function h_(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=d_(e);if(t){var o=d_(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return p_(this,n)}}function p_(e,t){return!t||"object"!==l_(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function d_(e){return(d_=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var y_=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&f_(e,t)}(i,e);var t,n,r,o=h_(i);function i(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(t=o.call(this)).field=e,t}return t=i,(n=[{key:"_accept",value:function(e){var t=c_(d_(i.prototype),"_accept",this).call(this,e);return!(!t||this.field.bodyAnimating)&&t}},{key:"_changeSelection",value:function(e,t){0!==t.length&&(t.select(!0).focus(),this.field.updateNextToSelected&&this.field.updateNextToSelected(this._menuItemClass,t),e.length>0&&e.select(!1))}}])&&u_(t.prototype,n),r&&u_(t,r),i}(zu);function v_(e){return(v_="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function b_(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function m_(e,t){return(m_=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function g_(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=w_(e);if(t){var o=w_(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return __(this,n)}}function __(e,t){return!t||"object"!==v_(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function w_(e){return(w_=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var k_=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&m_(e,t)}(i,e);var t,n,r,o=g_(i);function i(e,t){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(n=o.call(this,e))._menuItemClass=t,n.stopImmediatePropagation=!0,n.which=[Ou.ENTER,Ou.SPACE],n.renderingHints.render=!1,n}return t=i,(n=[{key:"handle",value:function(e){var t=Q_._findMenuItems(this.field,this._menuItemClass).$selected;t.length>0&&t.data("widget").doAction()}}])&&b_(t.prototype,n),r&&b_(t,r),i}(y_);function S_(e){return(S_="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function O_(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function T_(e,t,n){return(T_="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=x_(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function C_(e,t){return(C_=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function P_(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=x_(e);if(t){var o=x_(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return R_(this,n)}}function R_(e,t){return!t||"object"!==S_(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function x_(e){return(x_=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var E_=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&C_(e,t)}(i,e);var t,n,r,o=P_(i);function i(e,t){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(n=o.call(this,e,t))._menuItemClass=t,n.which=[Ou[1],Ou[2],Ou[3],Ou[4],Ou[5],Ou[6],Ou[7],Ou[8],Ou[9]],n.renderingHints.render=!0,n.renderingHints.hAlign=Do.RIGHT,n.renderingHints.$drawingArea=function(e,t){return t.$menuItem},n}return t=i,(n=[{key:"_accept",value:function(e){if(!T_(x_(i.prototype),"_accept",this).call(this,e))return!1;var t=Q_._findMenuItems(this.field,this._menuItemClass),n=Ou.codesToKeys[e.which];return e.$menuItem=t.$allVisible.eq(n-1),e.$menuItem.length>0}},{key:"handle",value:function(e){e.$menuItem.data("widget").doAction()}}])&&O_(t.prototype,n),r&&O_(t,r),i}(k_);function D_(e){return(D_="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function A_(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function F_(e,t){return(F_=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function $_(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=B_(e);if(t){var o=B_(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return j_(this,n)}}function j_(e,t){return!t||"object"!==D_(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function B_(e){return(B_=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var M_=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&F_(e,t)}(i,e);var t,n,r,o=$_(i);function i(e,t){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(n=o.call(this,e))._menuItemClass=t,n.which=[Ou.DOWN],n.renderingHints.render=!1,n}return t=i,(n=[{key:"handle",value:function(e){var t=Q_._findMenuItems(this.field,this._menuItemClass);t.$selected.length>0?this._changeSelection(t.$selected,t.$selected.nextAll(":visible").first()):this._changeSelection(t.$selected,t.$allVisible.first())}}])&&A_(t.prototype,n),r&&A_(t,r),i}(y_);function I_(e){return(I_="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function L_(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function H_(e,t){return(H_=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function N_(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=W_(e);if(t){var o=W_(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return V_(this,n)}}function V_(e,t){return!t||"object"!==I_(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function W_(e){return(W_=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var z_=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&H_(e,t)}(i,e);var t,n,r,o=N_(i);function i(e,t){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(n=o.call(this,e))._menuItemClass=t,n.which=[Ou.UP],n.renderingHints.render=!1,n}return t=i,(n=[{key:"handle",value:function(e){var t=Q_._findMenuItems(this.field,this._menuItemClass);t.$selected.length>0?this._changeSelection(t.$selected,t.$selected.prevAll(":visible").first()):this._changeSelection(t.$selected,t.$allVisible.last())}}])&&L_(t.prototype,n),r&&L_(t,r),i}(y_);function G_(e){return(G_="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function U_(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function K_(e,t,n){return(K_="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=J_(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function q_(e,t){return(q_=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Y_(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=J_(e);if(t){var o=J_(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return X_(this,n)}}function X_(e,t){return!t||"object"!==G_(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function J_(e){return(J_=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Z_=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&q_(e,t)}(i,e);var t,n,r,o=Y_(i);function i(e,t){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(n=o.call(this,e,t))._menuItemClass=t,n.which=[Ou.BACKSPACE],n.renderingHints.render=!0,n.renderingHints.$drawingArea=function(e,t){return t.$menuItem},n}return t=i,(n=[{key:"_accept",value:function(e){if(!K_(J_(i.prototype),"_accept",this).call(this,e))return!1;var t=Q_._findMenuItems(this.field,this._menuItemClass+".expanded");return t.$all.length>0&&(e.$menuItem=t.$all,!0)}},{key:"handle",value:function(e){e.$menuItem.data("widget").doAction()}}])&&U_(t.prototype,n),r&&U_(t,r),i}(k_);var Q_={registerKeyStrokes:function(e,t,n){e.registerKeyStroke([new z_(t,n),new M_(t,n),new k_(t,n),new E_(t,n),new Z_(t,n)])},_findMenuItems:function(e,t){return{$all:e.$body.find("."+t),$allVisible:e.$body.find("."+t+":visible"),$selected:e.$body.find("."+t+".selected")}}};function ew(e){return(ew="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function tw(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function nw(e,t,n){return(nw="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=aw(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function rw(e,t){return(rw=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function ow(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=aw(e);if(t){var o=aw(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return iw(this,n)}}function iw(e,t){return!t||"object"!==ew(t)&&"function"!=typeof t?sw(e):t}function sw(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function aw(e){return(aw=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var lw=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&rw(e,t)}(i,e);var t,n,r,o=ow(i);function i(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(e=o.call(this))._removeWidgetProperties("childActions"),e._buttonPropertyChangeHandler=e._onButtonPropertyChange.bind(sw(e)),e._buttonDestroyHandler=e._onButtonDestroy.bind(sw(e)),e._addCloneProperties(["button"]),e.button=null,e.menubar=null,e}return t=i,r=[{key:"adaptButtonProperties",value:function(e,t){for(var n in t=t||{},["visible","selected","tooltipText","keyStroke","keyStrokes","cssClass","modelClass","classId","iconId","preventDoubleClick","enabled","inheritAccessibility","stackable","shrinkable"].forEach((function(n){t[n]=e[n]})),t.text=e.label,t.textPosition=function(e){if(void 0!==e)return e===JK.LabelPosition.BOTTOM?Up.TextPosition.BOTTOM:Up.TextPosition.DEFAULT}(e.labelPosition),t.horizontalAlignment=e.gridData?e.gridData.horizontalAlignment:void 0,t.actionStyle=function(e){if(void 0!==e)return e===JK.DisplayStyle.LINK?Up.ActionStyle.DEFAULT:Up.ActionStyle.BUTTON}(e.displayStyle),t.toggleAction=e.displayStyle===JK.DisplayStyle.TOGGLE,t.childActions=e.menus,void 0===t.defaultMenu&&(t.defaultMenu=e.defaultButton),t)void 0===t[n]&&delete t[n];return t}}],(n=[{key:"_init",value:function(e){if(nw(aw(i.prototype),"_init",this).call(this,e),!this.button)throw new Error("Cannot adapt to undefined button");this.button.adaptedBy=this,this._installListeners()}},{key:"_destroy",value:function(){nw(aw(i.prototype),"_destroy",this).call(this),delete this.button.adaptedBy}},{key:"_installListeners",value:function(){this.button.on("propertyChange",this._buttonPropertyChangeHandler),this.button.on("destroy",this._buttonDestroyHandler)}},{key:"_uninstallListeners",value:function(){this.button.off("propertyChange",this._buttonPropertyChangeHandler),this.button.off("destroy",this._buttonDestroyHandler)}},{key:"_render",value:function(){nw(aw(i.prototype),"_render",this).call(this),this.$container.attr("data-buttonadapter",this.button.id)}},{key:"_onButtonPropertyChange",value:function(e){var t={};for(var n in t[e.propertyName]=e.newValue,t=i.adaptButtonProperties(t))this.setProperty(n,t[n])}},{key:"_onButtonDestroy",value:function(e){this.destroy(),this._uninstallListeners()}},{key:"doAction",value:function(){if(this.childActions.length>0)return nw(aw(i.prototype),"doAction",this).call(this);var e=this.button.doAction();return e&&(this.isToggleAction()&&this.setSelected(!this.selected),this._doAction()),e}},{key:"focus",value:function(){return this.rendered?(this.menubar.setTabbableMenu(this),this.session.focusManager.requestFocus(this.getFocusableElement())):(this.session.layoutValidator.schedulePostValidateFunction(this.focus.bind(this)),!1)}}])&&tw(t.prototype,n),r&&tw(t,r),i}(eg);function uw(e){return(uw="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function cw(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function fw(e,t,n){return(fw="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=yw(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function hw(e,t){return(hw=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function pw(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=yw(e);if(t){var o=yw(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return dw(this,n)}}function dw(e,t){return!t||"object"!==uw(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function yw(e){return(yw=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var vw=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&hw(e,t)}(i,e);var t,n,r,o=pw(i);function i(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(e=o.call(this))._addWidgetProperties("field"),e}return t=i,(n=[{key:"_render",value:function(){this.$container=this.$parent.appendDiv("menu-item"),this.$container.addClass("form-field-menu"),this.uiCssClass&&this.$container.addClass(this.uiCssClass),this.htmlComp=ea.install(this.$container,this.session),this.htmlComp.setLayout(new vl({stretch:!1}))}},{key:"_renderProperties",value:function(){fw(yw(i.prototype),"_renderProperties",this).call(this),this._renderField()}},{key:"_renderText",value:function(e){fw(yw(i.prototype),"_renderText",this).call(this,e),this.field&&this.field.rendered&&this.$text&&this.field.$container.insertAfter(this.$text)}},{key:"setField",value:function(e){this.setProperty("field",e)}},{key:"_renderField",value:function(){if(this.field){this.field.gridData=Ez.createFromHints(this.field,1),this.field.render(this.$container);var e=new ua(this.field);e.validate(),this.field.setLayoutData(e),this.field.$container.addClass("content")}}},{key:"_removeField",value:function(){this.field&&this.field.remove()}},{key:"clone",value:function(e,t){var n=fw(yw(i.prototype),"clone",this).call(this,e,t);return this._deepCloneProperties(n,["field"],t),n}},{key:"isTabTarget",value:function(){return!1}},{key:"_renderOverflown",value:function(){fw(yw(i.prototype),"_renderOverflown",this).call(this),this.field._hideStatusMessage()}}])&&cw(t.prototype,n),r&&cw(t,r),i}(eg);function bw(e){return(bw="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function mw(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function gw(e,t,n){return(gw="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Sw(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function _w(e,t){return(_w=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function ww(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Sw(e);if(t){var o=Sw(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return kw(this,n)}}function kw(e,t){return!t||"object"!==bw(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Sw(e){return(Sw=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Ow=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_w(e,t)}(i,e);var t,n,r,o=ww(i);function i(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),o.call(this)}return t=i,(n=[{key:"_postCreateWidget",value:function(){gw(Sw(i.prototype),"_postCreateWidget",this).call(this),this.widget.field&&(this.widget.field.gridDataHints=new Ez(this.widget.field.gridData))}}])&&mw(t.prototype,n),r&&mw(t,r),i}(dg);function Tw(e){return(Tw="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Cw(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Pw(e,t,n){return(Pw="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Dw(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function Rw(e,t){return(Rw=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function xw(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Dw(e);if(t){var o=Dw(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Ew(this,n)}}function Ew(e,t){return!t||"object"!==Tw(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Dw(e){return(Dw=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Aw=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Rw(e,t)}(i,e);var t,n,r,o=xw(i);function i(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(t=o.call(this)).compact=!1,t.menus=[],t._addWidgetProperties("menus"),t}return t=i,(n=[{key:"_init",value:function(e){Pw(Dw(i.prototype),"_init",this).call(this,e),this.menus=e.menus||[],this.uiMenuCssClass=e.uiMenuCssClass||"",this.uiMenuCssClass+=" menu-box-item",this._initMenus(this.menus)}},{key:"_initMenus",value:function(e){e.forEach(this._initMenu.bind(this))}},{key:"_initMenu",value:function(e){e.uiCssClass=this.uiMenuCssClass}},{key:"_render",value:function(){this.$container=this.$parent.appendDiv("menu-box"),this.htmlComp=ea.install(this.$container,this.session),this.htmlComp.setLayout(new Lw(this))}},{key:"_renderProperties",value:function(){Pw(Dw(i.prototype),"_renderProperties",this).call(this),this._renderMenus(),this._renderCompact()}},{key:"setMenus",value:function(e){this.setProperty("menus",e)}},{key:"_renderMenus",value:function(){this.menus.forEach((function(e){e.render()}),this),this.invalidateLayoutTree()}},{key:"_removeMenus",value:function(){this.menus.forEach((function(e){e.remove()})),this.invalidateLayoutTree()}},{key:"setCompact",value:function(e){this.setProperty("compact",e)}},{key:"_renderCompact",value:function(){this.$container.toggleClass("compact",this.compact),this.invalidateLayoutTree()}}])&&Cw(t.prototype,n),r&&Cw(t,r),i}(ve);function Fw(e){return(Fw="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function $w(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function jw(e,t){return(jw=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Bw(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Iw(e);if(t){var o=Iw(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Mw(this,n)}}function Mw(e,t){return!t||"object"!==Fw(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Iw(e){return(Iw=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Lw=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&jw(e,t)}(i,e);var t,n,r,o=Bw(i);function i(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(t=o.call(this)).menuBox=e,t.firstMenu=null,t.lastMenu=null,t}return t=i,(n=[{key:"layout",value:function(e){var t=this.menuBox.htmlComp.size(),n=this.visibleMenus(),r=0;this.menuBox.session.layoutValidator.schedulePostValidateFunction((function(){n.forEach((function(e){e.popup&&e.popup.position()}))})),this.updateFirstAndLastMenuMarker(n),this.undoCollapse(n),this.undoCompact(n),this.undoShrink(n),(r=this.actualPrefSize(n).width)<=t.width||(this.compact(n),(r=this.actualPrefSize(n).width)<=t.width||(this.shrink(n),(r=this.actualPrefSize(n).width)<=t.width||this.collapse(n,t,r)))}},{key:"preferredLayoutSize",value:function(e){var t=this.visibleMenus();return this.updateFirstAndLastMenuMarker(t),this.undoCollapse(t),this.undoCompact(t),this.undoShrink(t),this.actualPrefSize()}},{key:"compact",value:function(e){void 0===this.menuBox.compactOrig&&(this.menuBox.compactOrig=this.menuBox.compact,this.menuBox.htmlComp.suppressInvalidate=!0,this.menuBox.setCompact(!0),this.menuBox.htmlComp.suppressInvalidate=!1),this.compactMenus(e)}},{key:"undoCompact",value:function(e){void 0!==this.menuBox.compactOrig&&(this.menuBox.htmlComp.suppressInvalidate=!0,this.menuBox.setCompact(this.menuBox.compactOrig),this.menuBox.htmlComp.suppressInvalidate=!1,this.menuBox.compactOrig=void 0),this.undoCompactMenus(e)}},{key:"compactMenus",value:function(e){(e=e||this.visibleMenus()).forEach((function(e){void 0===e.compactOrig&&(e.compactOrig=e.compact,e.htmlComp.suppressInvalidate=!0,e.setCompact(!0),e.htmlComp.suppressInvalidate=!1)}),this),this._ellipsis&&this._ellipsis.setCompact(!0)}},{key:"undoCompactMenus",value:function(e){(e=e||this.visibleMenus()).forEach((function(e){void 0!==e.compactOrig&&(e.htmlComp.suppressInvalidate=!0,e.setCompact(e.compactOrig),e.htmlComp.suppressInvalidate=!1,e.compactOrig=void 0)}),this),this._ellipsis&&this._ellipsis.setCompact(!1)}},{key:"shrink",value:function(e){this.shrinkMenus(e)}},{key:"shrinkMenus",value:function(e){(e=e||this.visibleMenus()).forEach((function(e){void 0===e.textVisibleOrig&&e.iconId&&(e.textVisibleOrig=e.textVisible,e.htmlComp.suppressInvalidate=!0,e.setTextVisible(!1),e.htmlComp.suppressInvalidate=!1)}),this)}},{key:"undoShrink",value:function(e){this.undoShrinkMenus(e)}},{key:"undoShrinkMenus",value:function(e){(e=e||this.visibleMenus()).forEach((function(e){void 0!==e.textVisibleOrig&&(e.htmlComp.suppressInvalidate=!0,e.setTextVisible(e.textVisibleOrig),e.htmlComp.suppressInvalidate=!1,e.textVisibleOrig=void 0)}),this)}},{key:"collapse",value:function(e,t,n){this._createAndRenderEllipsis(this.menuBox.$container);var r=this._moveOverflowMenusIntoEllipsis(t,n);this.updateFirstAndLastMenuMarker(r)}},{key:"undoCollapse",value:function(e){e=e||this.visibleMenus(),this._destroyEllipsis(),this._removeMenusFromEllipsis(e)}},{key:"_createAndRenderEllipsis",value:function(e){var t=zm.createEllipsisMenu({parent:this.menuBox,horizontalAlignment:1,compact:this.menuBox.compact});t.uiCssClass=this.menuBox.uiMenuCssClass,t.render(e),this._ellipsis=t}},{key:"_destroyEllipsis",value:function(){this._ellipsis&&(this._ellipsis.destroy(),this._ellipsis=null)}},{key:"_moveOverflowMenusIntoEllipsis",value:function(e,t){var n=[this._ellipsis],r=qs.size(this._ellipsis.$container,!0);return t+=r.width,this.visibleMenus().slice().reverse().forEach((function(r){var o;t>e.width?(o=qs.size(r.$container,!0),t-=o.width,zm.moveMenuIntoEllipsis(r,this._ellipsis)):n.unshift(r)}),this),n}},{key:"_removeMenusFromEllipsis",value:function(e){(e=e||this.visibleMenus()).forEach((function(e){zm.removeMenuFromEllipsis(e,this.menuBox.$container)}),this)}},{key:"actualPrefSize",value:function(e){var t,n;return e=e||this.visibleMenus(),t=this._menusWidth(e),(n=qs.prefSize(this.menuBox.$container,{includeMargin:!0,useCssSize:!0})).width=t+this.menuBox.htmlComp.insets().horizontal(),n}},{key:"_menusWidth",value:function(e){var t=0;return(e=e||this.visibleMenus()).forEach((function(e){e.rendered&&(t+=e.$container.outerWidth(!0))}),this),this._ellipsis&&(t+=this._ellipsis.$container.outerWidth(!0)),t}},{key:"compactPrefSize",value:function(e){return e=e||this.visibleMenus(),this.updateFirstAndLastMenuMarker(e),this.undoCollapse(e),this.undoShrink(e),this.compact(e),this.actualPrefSize()}},{key:"shrinkPrefSize",value:function(e){return e=e||this.visibleMenus(),this.updateFirstAndLastMenuMarker(e),this.undoCollapse(e),this.compact(e),this.shrink(e),this.actualPrefSize()}},{key:"visibleMenus",value:function(){return this.menuBox.menus.filter((function(e){return e.visible}),this)}},{key:"updateFirstAndLastMenuMarker",value:function(e){var t=null,n=null;(e||[]).forEach((function(e){e.rendered&&(t||(t=e),n=e)})),t===this.firstMenu&&n===this.lastMenu||(this.firstMenu&&this.firstMenu.rendered&&this.firstMenu.$container.removeClass("first"),this.lastMenu&&this.lastMenu.rendered&&this.lastMenu.$container.removeClass("last"),this.firstMenu=t,this.lastMenu=n,this.firstMenu&&this.firstMenu.$container.addClass("first"),this.lastMenu&&this.lastMenu.$container.addClass("last"))}}])&&$w(t.prototype,n),r&&$w(t,r),i}(Zs);function Hw(e){return(Hw="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Nw(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Vw(e,t,n){return(Vw="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Kw(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function Ww(e,t){return(Ww=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function zw(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Kw(e);if(t){var o=Kw(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Gw(this,n)}}function Gw(e,t){return!t||"object"!==Hw(t)&&"function"!=typeof t?Uw(e):t}function Uw(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Kw(e){return(Kw=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function qw(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Yw=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ww(e,t)}(i,e);var t,n,r,o=zw(i);function i(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(e=o.call(this)).menuSorter=null,e.menuFilter=null,e.position=i.Position.TOP,e.tabbable=!0,e.menuboxLeft=null,e.menuboxRight=null,e.menuItems=[],e.orderedMenuItems={left:[],right:[],all:[]},e.defaultMenu=null,e.visible=!1,e.ellipsisPosition=i.EllipsisPosition.RIGHT,e._menuItemPropertyChangeHandler=e._onMenuItemPropertyChange.bind(Uw(e)),e._focusHandler=e._onMenuItemFocus.bind(Uw(e)),e.hiddenByUi=!1,e._addWidgetProperties("menuItems"),e}return t=i,(n=[{key:"_init",value:function(e){Vw(Kw(i.prototype),"_init",this).call(this,e),this.menuSorter=e.menuOrder||new zJ,this.menuSorter.menuBar=this,e.menuFilter&&(this.menuFilter=function(t,n,r,o){return e.menuFilter(t,Gm.MENU_BAR,r,o)}),this.menuboxLeft=O.create("MenubarBox",{parent:this,cssClass:"left",tooltipPosition:this._oppositePosition()}),this.menuboxRight=O.create("MenubarBox",{parent:this,cssClass:"right",tooltipPosition:this._oppositePosition()}),this._setMenuItems(rt.ensure(this.menuItems)),this.updateVisibility()}},{key:"_destroy",value:function(){Vw(Kw(i.prototype),"_destroy",this).call(this),this._detachMenuHandlers()}},{key:"_createKeyStrokeContext",value:function(){return new $u}},{key:"_initKeyStrokeContext",value:function(){Vw(Kw(i.prototype),"_initKeyStrokeContext",this).call(this),this.keyStrokeContext.registerKeyStroke([new fk(this),new mk(this)])}},{key:"_render",value:function(){this.$container=this.$parent.appendDiv("menubar"),this.htmlComp=ea.install(this.$container,this.session),this.htmlComp.setLayout(new ok(this)),this.menuboxRight.render(this.$container),this.menuboxLeft.render(this.$container)}},{key:"_renderProperties",value:function(){Vw(Kw(i.prototype),"_renderProperties",this).call(this),this._renderMenuItems(),this._renderPosition()}},{key:"setPosition",value:function(e){this.setProperty("position",e)}},{key:"_setPosition",value:function(e){this._setProperty("position",e),this.menuboxLeft.setTooltipPosition(this._oppositePosition()),this.menuboxRight.setTooltipPosition(this._oppositePosition())}},{key:"_renderPosition",value:function(){this.$container.toggleClass("bottom",this.position===i.Position.BOTTOM)}},{key:"_oppositePosition",value:function(){return this.position===i.Position.TOP?i.Position.BOTTOM:i.Position.TOP}},{key:"setEllipsisPosition",value:function(e){this.setProperty("ellipsisPosition",e)}},{key:"_setChildMenuFilters",value:function(){this.orderedMenuItems.all.forEach((function(e){e.setMenuFilter(this.menuFilter)}),this)}},{key:"_attachMenuHandlers",value:function(){this.orderedMenuItems.all.forEach((function(e){0===e.events.count("propertyChange",this._menuItemPropertyChangeHandler)&&e.on("propertyChange",this._menuItemPropertyChangeHandler),0===e.events.count("focus",this._focusHandler)&&e.on("focus",this._focusHandler)}),this)}},{key:"_detachMenuHandlers",value:function(){var e=this;this.orderedMenuItems.all.forEach((function(t){t.off("propertyChange",e._menuItemPropertyChangeHandler),t.off("focus",e._focusHandler)}))}},{key:"setMenuItems",value:function(e){if(e=rt.ensure(e),rt.equals(this.menuItems,e))return this.menuboxRight.link(this.menuboxRight.menuItems),void this.menuboxLeft.link(this.menuboxLeft.menuItems);this.setProperty("menuItems",e)}},{key:"_setMenuItems",value:function(e,t){this._detachMenuHandlers(),this.orderedMenuItems=this._createOrderedMenus(e),t?(this.menuboxRight.setMenuItems(this.orderedMenuItems.right),this.menuboxLeft.setMenuItems(this.orderedMenuItems.left)):(this.menuboxLeft.setMenuItems(this.orderedMenuItems.left),this.menuboxRight.setMenuItems(this.orderedMenuItems.right)),this._setChildMenuFilters(),this._attachMenuHandlers(),this.updateVisibility(),this.updateDefaultMenu(),this._updateTabbableMenu(),this._setProperty("menuItems",e)}},{key:"_renderMenuItems",value:function(){this.updateLeftOfButtonMarker(),this.invalidateLayoutTree()}},{key:"_removeMenuItems",value:function(){}},{key:"_createOrderedMenus",value:function(e){var t,n=this.menuSorter.order(e,this),r=-1;if(n.right.forEach((function(e){e.rightAligned=!0})),n.all.length>0){if(this._ellipsis&&(this._ellipsis.setChildActions([]),this._ellipsis.destroy()),t=O.create("EllipsisMenu",{parent:this,cssClass:"overflow-menu-item"}),this._ellipsis=t,this.ellipsisPosition===i.EllipsisPosition.RIGHT){var o=this._getFirstStackableIndexPosition(n.right.slice().reverse());o>-1?(r=n.right.length-o,t.rightAligned=!0,n.right.splice(r,0,t)):(o=this._getFirstStackableIndexPosition(n.left.slice().reverse()))>-1&&(r=n.left.length-o,n.left.splice(r,0,t))}else(r=this._getFirstStackableIndexPosition(n.left))>-1?n.left.splice(r,0,t):(r=this._getFirstStackableIndexPosition(n.right))>-1&&(t.rightAligned=!0,n.right.splice(r,0,t));n.all=n.left.concat(n.right)}return n}},{key:"_getFirstStackableIndexPosition",value:function(e){var t=-1;return e.some((function(e,n){return!(!e.stackable||!e.visible||(t=n,0))}),this),t}},{key:"_updateTabbableMenu",value:function(){this.tabbable&&(this.defaultMenu&&this.defaultMenu.enabledComputed?this.setTabbableMenu(this.defaultMenu):this.setTabbableMenu(rt.find(this.orderedMenuItems.all,(function(e){return e.isTabTarget()}))))}},{key:"setTabbableMenu",value:function(e){this.tabbable&&e!==this.tabbableMenu&&(this.tabbableMenu&&this.tabbableMenu.setTabbable(!1),this.tabbableMenu=e,e&&e.setTabbable(!0))}},{key:"setHiddenByUi",value:function(e){this.setProperty("hiddenByUi",e)}},{key:"updateVisibility",value:function(){zm.updateSeparatorVisibility(this.orderedMenuItems.left),zm.updateSeparatorVisibility(this.orderedMenuItems.right),this.setVisible(!this.hiddenByUi&&this.orderedMenuItems.all.some((function(e){return e.visible&&!e.ellipsis})))}},{key:"updateDefaultMenu",value:function(){var e,t,n=null;for(e=0;e<this.orderedMenuItems.all.length;e++)if((t=this.orderedMenuItems.all[e]).visible&&t.enabled&&!1!==t.defaultMenu){if(t.defaultMenu){n=t;break}!n&&this._isDefaultKeyStroke(t.actionKeyStroke)&&(n=t)}this.setDefaultMenu(n),n&&n.isTabTarget()&&this.setTabbableMenu(n)}},{key:"_isDefaultKeyStroke",value:function(e){return O.isOneOf(Ou.ENTER,e.which)&&!e.ctrl&&!e.alt&&!e.shift}},{key:"setDefaultMenu",value:function(e){this.setProperty("defaultMenu",e)}},{key:"_setDefaultMenu",value:function(e){this.defaultMenu&&this.defaultMenu.setMenuStyle(eg.MenuStyle.NONE),e&&e.setMenuStyle(eg.MenuStyle.DEFAULT),this._setProperty("defaultMenu",e)}},{key:"updateLeftOfButtonMarker",value:function(){this._updateLeftOfButtonMarker(this.orderedMenuItems.left),this._updateLeftOfButtonMarker(this.orderedMenuItems.right)}},{key:"_updateLeftOfButtonMarker",value:function(e){var t;e=e.filter((function(e){return e.visible&&e.rendered}));for(var n=0;n<e.length;n++)(t=e[n]).$container.removeClass("left-of-button"),n>0&&t.isButton()&&e[n-1].$container.addClass("left-of-button")}},{key:"_onMenuItemPropertyChange",value:function(e){if("overflown"!==e.propertyName&&"enabled"!==e.propertyName&&"visible"!==e.propertyName&&"hidden"!==e.propertyName||this.tabbableMenu&&e.source!==this.tabbableMenu||this._updateTabbableMenu(),"overflown"!==e.propertyName&&"hidden"!==e.propertyName||this.defaultMenu&&e.source!==this.defaultMenu||this.updateDefaultMenu(),"horizontalAlignment"===e.propertyName&&this.reorderMenus(e.newValue<=0),"visible"===e.propertyName){var t=this.visible;this.updateVisibility(),!t&&this.visible&&this.revalidateLayout(),e.source.separator||this.reorderMenus()}"keyStroke"!==e.propertyName&&"enabled"!==e.propertyName&&"defaultMenu"!==e.propertyName&&"visible"!==e.propertyName||this.updateDefaultMenu()}},{key:"_onMenuItemFocus",value:function(e){this.setTabbableMenu(e.source)}},{key:"reorderMenus",value:function(e){var t=this.menuItems;this._setMenuItems(t,e),this.rendered&&this.updateLeftOfButtonMarker()}},{key:"_allMenusAsFlatList",value:function(){return rt.flatMap(this.orderedMenuItems.all,(function(e){return e instanceof Lg?e.childActions:[e]}))}}])&&Nw(t.prototype,n),r&&Nw(t,r),i}(ve);function Xw(e){return(Xw="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Jw(e){return function(e){if(Array.isArray(e))return Zw(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return Zw(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Zw(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Zw(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Qw(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ek(e,t){return(ek=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function tk(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=rk(e);if(t){var o=rk(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return nk(this,n)}}function nk(e,t){return!t||"object"!==Xw(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function rk(e){return(rk=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}qw(Yw,"EllipsisPosition",{LEFT:"left",RIGHT:"right"}),qw(Yw,"Position",{TOP:"top",BOTTOM:"bottom"});var ok=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ek(e,t)}(i,e);var t,n,r,o=tk(i);function i(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(t=o.call(this))._menuBar=e,t._overflowMenuItems=[],t._visibleMenuItems=[],t._ellipsis=null,t.collapsed=!1,t}return t=i,r=[{key:"size",value:function(e,t){var n=e.prefSize({widthHint:t.width});return n.width=t.width,n=n.subtract(e.margins())}}],(n=[{key:"layout",value:function(e){var t,n=this._menuBar.orderedMenuItems.left.concat(this._menuBar.orderedMenuItems.right),r=ea.get(e);t=rt.find(n,(function(e){return e.ellipsis})),this.preferredLayoutSize(e,{widthHint:r.availableSize().width,undo:!1}),t&&this._overflowMenuItems.length>0&&t.setHidden(!1),this._visibleMenuItems.forEach((function(e){e._setOverflown(!1)}),this),this._overflowMenuItems.forEach((function(e){e._setOverflown(!0)})),t&&0===this._overflowMenuItems.length&&t.setHidden(!0),this._overflowMenuItems=this._overflowMenuItems.filter((function(e){return!e.separator})),t&&(t._closePopup(),t.setChildActions(this._overflowMenuItems)),this._visibleMenuItems.forEach((function(e){e.validateLayout()})),this._visibleMenuItems.forEach((function(e){e.popup&&e.popup.position()}))}},{key:"preferredLayoutSize",value:function(e,t){var n=this;if(this._overflowMenuItems=[],!this._menuBar.isVisible())return new $s(0,0);var r=this._menuBar.orderedMenuItems.all.filter((function(e){return e.visible}),this),o=r.filter((function(e){var t=e.overflown;return e._setOverflown(!1),t})),i=r.filter((function(e){var t=!e.textVisible;return n.undoShrink([e]),t})),s=Jw(r),a=ea.get(e),l=new $s(0,0),u=Number.MAX_VALUE;return(0===t.widthHint||t.widthHint)&&(u=t.widthHint-a.insets().horizontal()),u<=0?l=this._minSize(r):((l=this._prefSize(r)).width>u&&this.shrink(r),l=this._prefSizeWithOverflow(r,u)),O.nvl(t.undo,!0)&&(this.undoOverflow(o),this.undoShrink(s),this.shrink(i)),this._visibleMenuItems=r,l.add(a.insets())}},{key:"_prefSizeWithOverflow",value:function(e,t){var n=[];e.forEach((function(e,t){e.stackable&&n.push(t)}));var r=-1;this._setFirstLastMenuMarker(e);for(var o=this._prefSize(e);o.width>t&&n.length>0;)r=this._menuBar.ellipsisPosition===Yw.EllipsisPosition.RIGHT?n.splice(-1)[0]:n.splice(0,1)[0]-this._overflowMenuItems.length,this._overflowMenuItems.splice(0,0,e[r]),e.splice(r,1),this._setFirstLastMenuMarker(e),o=this._prefSize(e);return o}},{key:"_minSize",value:function(e){var t=e.filter((function(e){return!e.stackable}));return this.shrink(e),this._setFirstLastMenuMarker(t,!0),this._prefSize(t,!0)}},{key:"_prefSize",value:function(e,t){var n=new $s(0,0),r=new $s(0,0);return t=O.nvl(t,this._overflowMenuItems.length>0),e.forEach((function(e){r=new $s(0,0),e.ellipsis?t&&(r=this._menuItemSize(e)):r=this._menuItemSize(e),n.height=Math.max(n.height,r.height),n.width+=r.width}),this),n}},{key:"_menuItemSize",value:function(e){var t,n=e.$container.attr("class");return e.$container.removeClass("overflown"),e.$container.removeClass("hidden"),e.htmlComp.invalidateLayout(),t=e.htmlComp.prefSize({useCssSize:!0,exact:!0}).add(qs.margins(e.$container)),e.$container.attrOrRemove("class",n),t}},{key:"_setFirstLastMenuMarker",value:function(e,t){var n=e;t=O.nvl(t,this._overflowMenuItems.length>0),this._menuBar.orderedMenuItems.all.forEach((function(e){e.$container.removeClass("first last")})),t||(n=n.filter((function(e){return!e.ellipsis}))),n.length>0&&(n[0].$container.addClass("first"),n[n.length-1].$container.addClass("last"))}},{key:"undoOverflow",value:function(e){e.forEach((function(e){e._setOverflown(!0)}))}},{key:"shrink",value:function(e){e.forEach((function(e){void 0===e.textVisibleOrig&&e.shrinkable&&e.icon&&(e.textVisibleOrig=e.textVisible,e.htmlComp.suppressInvalidate=!0,e.setTextVisible(!1),e.htmlComp.suppressInvalidate=!1)}),this)}},{key:"undoShrink",value:function(e){e.forEach((function(e){void 0!==e.textVisibleOrig&&(e.htmlComp.suppressInvalidate=!0,e.setTextVisible(e.textVisibleOrig),e.htmlComp.suppressInvalidate=!1,e.textVisibleOrig=void 0)}),this)}}])&&Qw(t.prototype,n),r&&Qw(t,r),i}(Zs);function ik(e){return(ik="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function sk(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ak(e,t){return(ak=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function lk(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=ck(e);if(t){var o=ck(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return uk(this,n)}}function uk(e,t){return!t||"object"!==ik(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function ck(e){return(ck=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var fk=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ak(e,t)}(i,e);var t,n,r,o=lk(i);function i(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(t=o.call(this)).field=e,t.which=[Ou.LEFT],t.renderingHints.render=!1,t.stopPropagation=!0,t.keyStrokeMode=zu.Mode.DOWN,t}return t=i,(n=[{key:"handle",value:function(e){var t,n,r,o=this.field._allMenusAsFlatList(),i=this.field.$container.find(":focus");for(t=0;t<o.length;t++){if(n=o[t],i[0]===n.$container[0]){r&&(this.field.setTabbableMenu(r),r.focus());break}n.isTabTarget()&&(r=n)}}}])&&sk(t.prototype,n),r&&sk(t,r),i}(zu);function hk(e){return(hk="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function pk(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function dk(e,t){return(dk=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function yk(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=bk(e);if(t){var o=bk(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return vk(this,n)}}function vk(e,t){return!t||"object"!==hk(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function bk(e){return(bk=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var mk=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&dk(e,t)}(i,e);var t,n,r,o=yk(i);function i(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(t=o.call(this)).field=e,t.which=[Ou.RIGHT],t.renderingHints.render=!1,t.stopPropagation=!0,t.keyStrokeMode=zu.Mode.DOWN,t}return t=i,(n=[{key:"handle",value:function(e){var t,n,r=this.field._allMenusAsFlatList(),o=this.field.$container.find(":focus"),i=!1;for(t=0;t<r.length;t++){if(n=r[t],i&&n.isTabTarget()){this.field.setTabbableMenu(n),n.focus();break}o[0]===n.$container[0]&&(i=!0)}}}])&&pk(t.prototype,n),r&&pk(t,r),i}(zu);function gk(e){return(gk="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _k(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function wk(e,t,n){return(wk="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Ck(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function kk(e,t){return(kk=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Sk(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ck(e);if(t){var o=Ck(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Ok(this,n)}}function Ok(e,t){return!t||"object"!==gk(t)&&"function"!=typeof t?Tk(e):t}function Tk(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Ck(e){return(Ck=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Pk=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&kk(e,t)}(i,e);var t,n,r,o=Sk(i);function i(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(e=o.call(this)).menu=null,e.$headBlueprint=null,e.ignoreEvent=null,e._headVisible=!0,e.parentMenuPropertyChangeHandler=e._onParentMenuPropertyChange.bind(Tk(e)),e}return t=i,(n=[{key:"_init",value:function(e){e.$anchor=e.menu.$container,wk(Ck(i.prototype),"_init",this).call(this,e),this.$headBlueprint=this.menu.$container}},{key:"_getMenuItems",value:function(){return this.menu.childActions||this.menu.menus}},{key:"close",value:function(e){e&&this.ignoreEvent&&e.originalEvent===this.ignoreEvent.originalEvent||wk(Ck(i.prototype),"close",this).call(this,e)}},{key:"_render",value:function(){wk(Ck(i.prototype),"_render",this).call(this),this.menu.on("propertyChange",this.parentMenuPropertyChangeHandler)}},{key:"_remove",value:function(){this.menu.off("propertyChange",this.parentMenuPropertyChangeHandler),wk(Ck(i.prototype),"_remove",this).call(this)}},{key:"_renderHead",value:function(){wk(Ck(i.prototype),"_renderHead",this).call(this),this.menu.$container.parent().hasClass("main-menubar")&&this.$head.addClass("in-main-menubar"),this.menu.uiCssClass&&this._copyCssClassToHead(this.menu.uiCssClass),this._copyCssClassToHead("unfocusable"),this._copyCssClassToHead("button"),this._copyCssClassToHead("menu-textandicon"),this._copyCssClassToHead("bottom-text")}},{key:"_onParentMenuPropertyChange",value:function(e){var t=this;this.session.layoutValidator.schedulePostValidateFunction((function(){t.rendered&&(t.rerenderHead(),t.position())}))}}])&&_k(t.prototype,n),r&&_k(t,r),i}(Qg);function Rk(e){return(Rk="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function xk(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Ek(e,t,n){return(Ek="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=jk(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function Dk(e,t){return(Dk=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Ak(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=jk(e);if(t){var o=jk(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Fk(this,n)}}function Fk(e,t){return!t||"object"!==Rk(t)&&"function"!=typeof t?$k(e):t}function $k(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function jk(e){return(jk=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Bk=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Dk(e,t)}(i,e);var t,n,r,o=Ak(i);function i(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(e=o.call(this)).menuItems=[],e.tooltipPosition=Yw.Position.TOP,e._addWidgetProperties("menuItems"),e._menuItemPropertyChangeHandler=e._onMenuItemPropertyChange.bind($k(e)),e}return t=i,(n=[{key:"_destroy",value:function(){Ek(jk(i.prototype),"_destroy",this).call(this),this._removeMenuHandlers()}},{key:"_render",value:function(){this.$container=this.$parent.appendDiv("menubox"),this.htmlComp=ea.install(this.$container,this.session),this.htmlComp.setLayout(new Wk(this))}},{key:"_renderProperties",value:function(){Ek(jk(i.prototype),"_renderProperties",this).call(this),this._renderMenuItems()}},{key:"_remove",value:function(){this._removeMenuItems(),Ek(jk(i.prototype),"_remove",this).call(this)}},{key:"setMenuItems",value:function(e){e=rt.ensure(e),rt.equals(this.menuItems,e)||this.setProperty("menuItems",e)}},{key:"_setMenuItems",value:function(e){this._removeMenuHandlers(),this._setProperty("menuItems",e),this._addMenuHandlers(),this._updateTooltipPosition()}},{key:"_removeMenuItems",value:function(){this._removeMenuHandlers(),this.menuItems.forEach((function(e){e.overflow=!1,e.remove()}))}},{key:"_renderMenuItems",value:function(){var e=this;this.menuItems.forEach((function(t){t.render(e.$container),t.$container.addClass("menubar-item")})),this.rendering||this.invalidateLayoutTree()}},{key:"_addMenuHandlers",value:function(){this.menuItems.forEach((function(e){e.off("propertyChange",this._menuItemPropertyChangeHandler)}),this)}},{key:"_removeMenuHandlers",value:function(){this.menuItems.forEach((function(e){e.off("propertyChange",this._menuItemPropertyChangeHandler)}),this)}},{key:"_renderVisible",value:function(){Ek(jk(i.prototype),"_renderVisible",this).call(this),this.revalidateLayout()}},{key:"_onMenuItemPropertyChange",value:function(e){"visible"===e.propertyName&&this.setVisible(this.menuItems.some((function(e){return e.visible&&!e.ellipsis})))}},{key:"setTooltipPosition",value:function(e){this.setProperty("tooltipPosition",e)}},{key:"_setTooltipPosition",value:function(e){this._setProperty("tooltipPosition",e),this._updateTooltipPosition()}},{key:"_updateTooltipPosition",value:function(){this.menuItems.forEach((function(e){e.setTooltipPosition(this.tooltipPosition)}),this)}}])&&xk(t.prototype,n),r&&xk(t,r),i}(ve);function Mk(e){return(Mk="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ik(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Lk(e,t){return(Lk=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Hk(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Vk(e);if(t){var o=Vk(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Nk(this,n)}}function Nk(e,t){return!t||"object"!==Mk(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Vk(e){return(Vk=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Wk=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Lk(e,t)}(i,e);var t,n,r,o=Hk(i);function i(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(t=o.call(this)).menubox=e,t}return t=i,(n=[{key:"layout",value:function(e){}},{key:"preferredLayoutSize",value:function(e,t){var n=null;return this.menubox.menuItems.filter((function(e){return!e.overflown&&e.isVisible()})).reduce((function(e,t){return n=t.htmlComp.prefSize({useCssSize:!0,includeMargin:!0}),e.height=Math.max(e.height,n.height),e.width=Math.max(e.width,n.width),e}),new $s)}}])&&Ik(t.prototype,n),r&&Ik(t,r),i}(Zs);function zk(e){return(zk="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Gk(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Uk(e,t,n){return(Uk="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Xk(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function Kk(e,t){return(Kk=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function qk(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Xk(e);if(t){var o=Xk(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Yk(this,n)}}function Yk(e,t){return!t||"object"!==zk(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Xk(e){return(Xk=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Jk(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Zk=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Kk(e,t)}(i,e);var t,n,r,o=qk(i);function i(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(e=o.call(this)).monthViewNumberOfWeeks=6,e.numberOfHourDivisions=e.getConfiguredNumberOfHourDivisions(),e.heightPerDivision=e.getConfiguredHeightPerDivision(),e.startHour=e.getConfiguredStartHour(),e.heightPerHour=e.numberOfHourDivisions*e.heightPerDivision,e.heightPerDay=24*e.heightPerHour,e.spaceBeforeScrollTop=15,e.workDayIndices=[1,2,3,4,5],e.components=[],e.displayMode,e.displayCondensed=!1,e.loadInProgress=!1,e.selectedDate=null,e.showDisplayModeSelection=!0,e.title=null,e.useOverflowCells=!0,e.viewRange=null,e.calendarToggleListWidth=270,e.calendarToggleYearWidth=215,e.$container=null,e.$header=null,e.$range=null,e.$commands=null,e.$grids=null,e.$grid=null,e.$topGrid=null,e.$list=null,e.$progress=null,e._showYearPanel=!1,e._showListPanel=!1,e._exactRange=null,e._listComponents=[],e.menuInjectionTarget=null,e._menuInjectionTargetMenusChangedHandler=null,e._addWidgetProperties(["components","menus","selectedComponent"]),e._addPreserveOnPropertyChangeProperties(["selectedComponent"]),e}return t=i,(n=[{key:"init",value:function(e,t,n){Uk(Xk(i.prototype),"init",this).call(this,e,t,n)}},{key:"getConfiguredNumberOfHourDivisions",value:function(){return 2}},{key:"getConfiguredHeightPerDivision",value:function(){return 30}},{key:"getConfiguredStartHour",value:function(){return 6}},{key:"_isDay",value:function(){return this.displayMode===i.DisplayMode.DAY}},{key:"_isWeek",value:function(){return this.displayMode===i.DisplayMode.WEEK}},{key:"_isMonth",value:function(){return this.displayMode===i.DisplayMode.MONTH}},{key:"_isWorkWeek",value:function(){return this.displayMode===i.DisplayMode.WORK_WEEK}},{key:"_createKeyStrokeContext",value:function(){return new $u}},{key:"_init",value:function(e){Uk(Xk(i.prototype),"_init",this).call(this,e),this._yearPanel=O.create("YearPanel",{parent:this}),this._yearPanel.on("dateSelect",this._onYearPanelDateSelect.bind(this)),this.modesMenu=O.create("CalendarModesMenu",{parent:this,visible:!1,displayMode:this.displayMode}),this._setSelectedDate(e.selectedDate),this._setDisplayMode(e.displayMode),this._setMenuInjectionTarget(e.menuInjectionTarget),this._exactRange=this._calcExactRange(),this._yearPanel.setViewRange(this._exactRange),this.viewRange=this._calcViewRange()}},{key:"setSelectedDate",value:function(e){this.setProperty("selectedDate",e)}},{key:"_setSelectedDate",value:function(e){e=Et.ensure(e),this._setProperty("selectedDate",e),this._yearPanel.selectDate(this.selectedDate)}},{key:"setDisplayMode",value:function(e){if(!Pr.equals(this.displayMode,e)){var t=this.displayMode;this._setDisplayMode(e),this.rendered&&this._renderDisplayMode(t)}}},{key:"_setDisplayMode",value:function(e){if(this._setProperty("displayMode",e),this._yearPanel.setDisplayMode(this.displayMode),this.modesMenu.setDisplayMode(e),this._isWorkWeek()){var t=this._dateParts(this.selectedDate,!0);t.day>4&&this.setSelectedDate(new Date(t.year,t.month,t.date-t.day+4))}}},{key:"_renderDisplayMode",value:function(e){this.rendering||(this._updateModel(!1,!0),e!==i.DisplayMode.MONTH&&this.displayMode!==i.DisplayMode.MONTH||(this._renderComponents(),this.needsScrollToStartHour=!0))}},{key:"_setViewRange",value:function(e){e=US.ensure(e),this._setProperty("viewRange",e)}},{key:"_setMenus",value:function(e){if(this._checkMenuInjectionTarget(this.menuInjectionTarget)){var t=this._removeInjectedMenus(this.menuInjectionTarget,this.menus);this.menuInjectionTarget.setMenus(e.concat(t))}this._setProperty("menus",e)}},{key:"_setMenuInjectionTarget",value:function(e){var t=this;if(Pr.isString(e)&&(e=O.widget(e)),this._checkMenuInjectionTarget(this.menuInjectionTarget)){e.off("propertyChange:menus",this._menuInjectionTargetMenusChangedHandler);var n=this._removeInjectedMenus(this.menuInjectionTarget,this.menus);this.menuInjectionTarget.setMenus(n)}this._checkMenuInjectionTarget(e)&&(e.setMenus(this.menus.concat(e.menus)),this._menuInjectionTargetMenusChangedHandler=e.on("propertyChange:menus",(function(e){t.menuInjectionTarget.menus.some((function(e){return t.menus.includes(e)}))||t.menuInjectionTarget.setMenus(t.menus.concat(t.menuInjectionTarget.menus))}))),this._setProperty("menuInjectionTarget",e)}},{key:"_checkMenuInjectionTarget",value:function(e){return e instanceof gJ}},{key:"_removeInjectedMenus",value:function(e,t){return e.menus.filter((function(e){return!t.includes(e)}))}},{key:"_render",value:function(){this.$container=this.$parent.appendDiv("calendar");var e=new xS(this);this.htmlComp=ea.install(this.$container,this.session),this.htmlComp.setLayout(e);var t=Kt.get().type===Kt.Type.MOBILE;this.$header=this.$container.appendDiv("calendar-header"),this.$header.toggleClass("mobile",t),this.$headerRow1=this.$header.appendDiv("calendar-header-row first"),this.$headerRow2=this.$header.appendDiv("calendar-header-row last"),this._yearPanel.render(),this.$grids=this.$container.appendDiv("calendar-grids"),this.$topGrid=this.$grids.appendDiv("calendar-top-grid"),this.$topGrid.toggleClass("mobile",t),this.$grid=this.$grids.appendDiv("calendar-grid"),this.$grid.toggleClass("mobile",t),this.$list=this.$container.appendDiv("calendar-list-container").appendDiv("calendar-list"),this.$listTitle=this.$list.appendDiv("calendar-list-title"),this.$range=this.$headerRow1.appendDiv("calendar-range"),this.$range.appendDiv("calendar-previous").click(this._onPreviousClick.bind(this)),this.$range.appendDiv("calendar-today",this.session.text("ui.CalendarToday")).click(this._onTodayClick.bind(this)),this.$range.appendDiv("calendar-next").click(this._onNextClick.bind(this)),this.$title=this.$headerRow1.appendDiv("calendar-title"),this.$select=this.$title.appendDiv("calendar-select"),this.$progress=this.$title.appendDiv("busyindicator-label"),this.$commands=this.$headerRow1.appendDiv("calendar-commands"),this.$commands.appendDiv("calendar-mode first",this.session.text("ui.CalendarDay")).attr("data-mode",i.DisplayMode.DAY).click(this._onDisplayModeClick.bind(this)),this.$commands.appendDiv("calendar-mode",this.session.text("ui.CalendarWorkWeek")).attr("data-mode",i.DisplayMode.WORK_WEEK).click(this._onDisplayModeClick.bind(this)),this.$commands.appendDiv("calendar-mode",this.session.text("ui.CalendarWeek")).attr("data-mode",i.DisplayMode.WEEK).click(this._onDisplayModeClick.bind(this)),this.$commands.appendDiv("calendar-mode last",this.session.text("ui.CalendarMonth")).attr("data-mode",i.DisplayMode.MONTH).click(this._onDisplayModeClick.bind(this)),this.modesMenu.render(this.$commands),this.$commands.appendDiv("calendar-toggle-year").click(this._onYearClick.bind(this)),this.$commands.appendDiv("calendar-toggle-list").click(this._onListClick.bind(this));var n=this.$topGrid.appendDiv("calendar-week-header");n.appendDiv("calendar-week-name");for(var r=0;r<7;r++)n.appendDiv("calendar-day-name").data("day",r);this.$topGrid.appendDiv("calendar-week-task").attr("data-axis-name",this.session.text("ui.CalendarDay"));var o=this.$topGrid.appendDiv("calendar-week-allday-container");o.appendDiv("calendar-week-name");for(var s=this._onDayContextMenu.bind(this),a=0;a<7;a++)o.appendDiv("calendar-day").addClass("calendar-scrollable-components").data("day",a).on("contextmenu",s);for(var l=1;l<7;l++)for(var u=this.$grid.appendDiv("calendar-week"),c=0;c<8;c++){var f=u.appendDiv();l>0&&0===c?f.addClass("calendar-week-name"):l>0&&c>0&&f.addClass("calendar-day").data("day",c).data("week",l).on("contextmenu",s)}var h=this._onDayMouseDown.bind(this,!0);this.$grid.find(".calendar-day").on("mousedown",h);var p=this._onDayMouseDown.bind(this,!1);this.$topGrid.find(".calendar-day").on("mousedown",p),this._updateScreen(!1,!1)}},{key:"_renderProperties",value:function(){Uk(Xk(i.prototype),"_renderProperties",this).call(this),this._renderComponents(),this._renderSelectedComponent(),this._renderLoadInProgress(),this._renderDisplayMode()}},{key:"_renderComponents",value:function(){this.components.sort(this._sortFromTo),this.components.forEach((function(e){return e.remove()})),this.components.forEach((function(e){return e.render()})),this._arrangeComponents(),this._updateListPanel()}},{key:"_renderSelectedComponent",value:function(){this.selectedComponent&&this.selectedComponent.setSelected(!0)}},{key:"_renderLoadInProgress",value:function(){this.$progress.setVisible(this.loadInProgress)}},{key:"updateScrollPosition",value:function(e){this.rendered?this._updateScrollPosition(!0,e):this.session.layoutValidator.schedulePostValidateFunction(this._updateScrollPosition.bind(this,!0,e))}},{key:"_updateScrollPosition",value:function(e,t){if(this._isMonth())this._scrollToSelectedComponent(t);else if(this.selectedComponent)if(this.selectedComponent.fullDay)this._scrollToSelectedComponent(t),e&&this._scrollToInitialTime(t);else{var n=Et.parseJsonDate(this.selectedComponent.fromDate,this.selectedComponent),r=this._dayPosition(n.getHours(),n.getMinutes())/100,o=this.heightPerDay*r;Lh.scrollTop(this.$grid,o-this.spaceBeforeScrollTop,{animate:t})}else e&&this._scrollToInitialTime(t)}},{key:"_scrollToSelectedComponent",value:function(e){this.selectedComponent&&this.selectedComponent._$parts[0]&&this.selectedComponent._$parts[0].parent()&&this.selectedComponent._$parts[0].isVisible()&&Lh.scrollTo(this.selectedComponent._$parts[0].parent(),this.selectedComponent._$parts[0],{animate:e})}},{key:"_scrollToInitialTime",value:function(e){if(this.needsScrollToStartHour=!1,!this._isMonth())if(this.selectedComponent&&!this.selectedComponent.fullDay){var t=Et.parseJsonDate(this.selectedComponent.fromDate),n=this._dayPosition(t.getHours(),t.getMinutes())/100,r=this.heightPerDay*n;Lh.scrollTop(this.$grid,r-this.spaceBeforeScrollTop,{animate:e})}else{var o=this.heightPerHour*this.startHour;Lh.scrollTop(this.$grid,o-this.spaceBeforeScrollTop,{animate:e})}}},{key:"_onPreviousClick",value:function(e){this._navigateDate(i.Direction.BACKWARD)}},{key:"_onNextClick",value:function(e){this._navigateDate(i.Direction.FORWARD)}},{key:"_dateParts",value:function(e,t){var n={year:e.getFullYear(),month:e.getMonth(),date:e.getDate(),day:e.getDay()};return t&&(n.day=(e.getDay()+6)%7),n}},{key:"_navigateDate",value:function(e){this.selectedDate=this._calcSelectedDate(e),this._updateModel(!0,!1)}},{key:"_calcSelectedDate",value:function(e){var t=this._dateParts(this.selectedDate),n=e,r=7*e,o=e;return this._isDay()?new Date(t.year,t.month,t.date+n):this._isWeek()||this._isWorkWeek()?new Date(t.year,t.month,t.date+r):this._isMonth()?Et.shift(this.selectedDate,0,o,0):void 0}},{key:"_updateModel",value:function(e,t){this._exactRange=this._calcExactRange(),this._yearPanel.setViewRange(this._exactRange),this.viewRange=this._calcViewRange(),this.trigger("modelChange"),this._updateScreen(e,t)}},{key:"_calcExactRange",value:function(){var e,t,n=this._dateParts(this.selectedDate,!0);if(this._isDay())e=new Date(n.year,n.month,n.date),t=new Date(n.year,n.month,n.date+1);else if(this._isWeek())e=new Date(n.year,n.month,n.date-n.day),t=new Date(n.year,n.month,n.date-n.day+6);else if(this._isMonth())e=new Date(n.year,n.month,1),t=new Date(n.year,n.month+1,0);else{if(!this._isWorkWeek())throw new Error("invalid value for displayMode");e=new Date(n.year,n.month,n.date-n.day),t=new Date(n.year,n.month,n.date-n.day+4)}return new US(e,t)}},{key:"_calcViewRange",value:function(){var e=function(e){var t,n=new Date(e.valueOf());for(t=0;t<42;t++)if(n.setDate(n.getDate()-1),1===n.getDay()&&n.getMonth()!==e.getMonth())return n;throw new Error("failed to calc viewFrom date")}(this._exactRange.from),t=function(e){var t,n=new Date(e.valueOf());for(t=0;t<42;t++)n.setDate(n.getDate()+1);return n}(e);return new US(e,t)}},{key:"_onTodayClick",value:function(e){this.selectedDate=new Date,this._updateModel(!0,!1)}},{key:"_onDisplayModeClick",value:function(e){var t=s()(e.target).data("mode");this.setDisplayMode(t)}},{key:"_onYearClick",value:function(e){this._showYearPanel=!this._showYearPanel,this._updateScreen(!0,!0)}},{key:"_onListClick",value:function(e){this._showListPanel=!this._showListPanel,this._updateScreen(!1,!0)}},{key:"_onDayMouseDown",value:function(e,t){var n=new Date(s()(t.delegateTarget).data("date"));if(e&&(this._isDay()||this._isWeek()||this._isWorkWeek())){var r=Math.floor(t.originalEvent.layerY/this.heightPerDivision)/this.numberOfHourDivisions*60*60;r<86400&&n.setSeconds(r)}this._setSelection(n,null,!1)}},{key:"_setSelection",value:function(e,t,n){var r=this,o=!1;0!==Et.compareDays(this.selectedDate,e)&&(o=!0,s()(".calendar-day",this.$container).each((function(t,n){var o=s()(n),i=o.data("date");i&&0!==Et.compareDays(i,r.selectedDate)?0===Et.compareDays(i,e)&&o.select(!0):o.select(!1)})),this.selectedDate=e),this.selectedComponent!==t&&(o=!0,this.selectedComponent&&this.selectedComponent.setSelected(!1),t&&t.setSelected(!0),this.selectedComponent=t),o&&(this.trigger("selectionChange"),this._updateListPanel(),n&&this._updateScrollPosition(!1,!0)),this._showYearPanel&&this._yearPanel.selectDate(this.selectedDate)}},{key:"_updateScreen",value:function(e,t){s.a.log.isInfoEnabled()&&s.a.log.info("(Calendar#_updateScreen)"),s()(".calendar-mode",this.$commands).select(!1),s()('[data-mode="'+this.displayMode+'"]',this.$commands).select(!0),s()(".selected",this.$grid).select(!1),this.layoutLabel(),this.layoutSize(t),this.layoutAxis(),this._showYearPanel&&this._yearPanel.selectDate(this.selectedDate),this._updateListPanel(),this._updateScrollbars(this.$grid,t),e&&!this._isMonth()&&this._updateTopGrid()}},{key:"layoutSize",value:function(e){s()("div",this.$container).removeData(["new-width","new-height"]),this._isMonth()?(this.$topGrid.addClass("calendar-top-grid-short"),this.$grid.removeClass("calendar-grid-short")):(this.$topGrid.removeClass("calendar-top-grid-short"),this.$grid.addClass("calendar-grid-short"));var t=s()(".selected",this.$grid),n=s()(".selected",this.$topGrid),r=this.$container.width(),o=this.$grid.height(),i=r-(this.$grid.innerWidth()-this.$grid.width());s()(".calendar-toggle-year",this.$commands).select(this._showYearPanel),this._showYearPanel?(this._yearPanel.$container.data("new-width",this.calendarToggleYearWidth),i-=this.calendarToggleYearWidth,r-=this.calendarToggleYearWidth):this._yearPanel.$container.data("new-width",0),s()(".calendar-toggle-list",this.$commands).select(this._showListPanel),this._showListPanel?(this.$list.parent().data("new-width",this.calendarToggleListWidth),i-=this.calendarToggleListWidth,r-=this.calendarToggleListWidth):this.$list.parent().data("new-width",0),this.$grids.data("new-width",r);var a=s()(),l=s()(".calendar-week",this.$grid);if(this._isDay()||this._isWeek()||this._isWorkWeek()){l.removeClass("calendar-week-noborder");var u=t.parent();(a=l.not(u)).data("new-height",0),a.removeClass("invisible"),u.data("new-height",this.heightPerDay),u.addClass("calendar-week-noborder"),u.removeClass("hidden invisible"),s()(".calendar-day",u).data("new-height",this.heightPerDay),s()(".calendar-week-name",this.$grid).addClass("invisible"),s()(".calendar-week-allday-container",this.$topGrid).removeClass("hidden"),s()(".calendar-week-task",this.$topGrid).removeClass("hidden")}else{var c=o/this.monthViewNumberOfWeeks;l.removeClass("calendar-week-noborder invisible hidden"),l.eq(0).addClass("calendar-week-noborder"),l.data("new-height",c),s()(".calendar-day",this.$grid).data("new-height",c);var f=s()(".calendar-week-name",this.$grid);f.removeClass("hidden invisible"),f.data("new-height",c),s()(".calendar-week-allday-container",this.$topGrid).addClass("hidden"),s()(".calendar-week-task",this.$topGrid).addClass("hidden")}var h=i-45;if(this._isDay())s()(".calendar-day-name, .calendar-day",this.$topGrid).data("new-width",0),s()(".calendar-day",this.$grid).data("new-width",0),s()(".calendar-day-name:nth-child("+(n.index()+1)+")",this.$topGrid).data("new-width",h),s()(".calendar-day:nth-child("+(n.index()+1)+")",this.$topGrid).data("new-width",h),s()(".calendar-day:nth-child("+(t.index()+1)+")",this.$grid).data("new-width",h);else if(this._isWorkWeek()){this.$topGrid.find(".calendar-day-name").data("new-width",0),this.$grids.find(".calendar-day").data("new-width",0);var p=Math.round(h/this.workDayIndices.length);s()(".calendar-day-name:nth-child(-n+6), .calendar-day:nth-child(-n+6)",this.$topGrid).data("new-width",p),s()(".calendar-day:nth-child(-n+6)",this.$grid).data("new-width",p)}else if(this._isMonth()||this._isWeek()){var d=Math.round(h/7);this.$grids.find(".calendar-day").data("new-width",d),this.$topGrid.find(".calendar-day-name").data("new-width",d)}this._isMonth()&&s()(".component-month",this.$grid).each((function(){var e=s()(this),t=e.closest(".calendar-day");e.toggleClass("compact",t.data("new-width")<dS.MONTH_COMPACT_THRESHOLD)}));var y=this._afterLayout.bind(this);s()("div",this.$container).each((function(){var t=s()(this),n=t.data("new-width"),r=t.data("new-height");t.stop(!1,!0),void 0!==n&&n!==t.outerWidth()&&(e?t.animateAVCSD("width",n,y.bind(this,t,e)):(t.css("width",n),y(t,e))),void 0!==r&&r!==t.outerHeight()&&(r>0&&t.removeClass("hidden"),e?t.animateAVCSD("height",r,(function(){0===r&&t.addClass("hidden"),y(t,e)})):(t.css("height",r),0===r&&t.addClass("hidden"),y(t,e)))}))}},{key:"_afterLayout",value:function(e,t){this._updateScrollbars(e,t),this._updateWeekdayNames()}},{key:"_updateWeekdayNames",value:function(){var e,t=this.$topGrid.width();this._isDay()?t/=1:this._isWorkWeek()?t/=this.workDayIndices.length:(this._isWeek()||this._isMonth())&&(t/=7),e=t>90?this.session.locale.dateFormat.symbols.weekdaysOrdered:this.session.locale.dateFormat.symbols.weekdaysShortOrdered,s()(".calendar-day-name",this.$topGrid).each((function(t){s()(this).attr("data-day-name",e[t])}))}},{key:"_updateScrollbars",value:function(e,t){s()(".calendar-scrollable-components",e).each((function(){var e=s()(this);Lh.update(e,!0)})),this.updateScrollPosition(t)}},{key:"_updateTopGrid",value:function(){s()(".calendar-component",this.$topGrid).each((function(e,t){var n=s()(t).data("component");n&&n.remove()}));var e=this.components.filter((function(e){return e.fullDay}));e.forEach((function(e){return e.remove()})),e.forEach((function(e){return e.render()})),this._updateScrollbars(this.$topGrid,!1)}},{key:"layoutYearPanel",value:function(){this._showYearPanel&&(Lh.update(this._yearPanel.$yearList),this._yearPanel._scrollYear())}},{key:"layoutLabel",value:function(){var e,t,n,r=this._exactRange.from,o=this._exactRange.to;if(this._isDay())e=this._format(r,"d. MMMM yyyy");else if(this._isWorkWeek()||this._isWeek()){var i=this.session.text("ui.to");e=r.getMonth()===o.getMonth()?Wn.join(" ",this._format(r,"d."),i,this._format(o,"d. MMMM yyyy")):r.getFullYear()===o.getFullYear()?Wn.join(" ",this._format(r,"d. MMMM"),i,this._format(o,"d. MMMM yyyy")):Wn.join(" ",this._format(r,"d. MMMM yyyy"),i,this._format(o,"d. MMMM yyyy"))}else this._isMonth()&&(e=this._format(r,"MMMM yyyy"));this.$select.text(e),t=s()(".calendar-day",this.$grid);var a,l,u,c=this._exactRange.from.getMonth(),f=new Date(this.viewRange.from.valueOf());for(a=0;a<this.monthViewNumberOfWeeks;a++)for(l=0;l<7;l++)u="",u=-1===this.workDayIndices.indexOf(f.getDay())?f.getMonth()!==c?" weekend-out":" weekend":f.getMonth()!==c?" out":"",Et.isSameDay(f,new Date)&&(u+=" now"),Et.isSameDay(f,this.selectedDate)&&(u+=" selected"),this._isMonth()||(u+=" calendar-no-label"),f.getDate()>9&&f.getDate()<20&&(u+=" center-nice"),e=this._format(f,"dd"),t.eq(7*a+l).removeClass("weekend-out weekend out selected now calendar-no-label").addClass(u).attr("data-day-name",e).data("date",new Date(f.valueOf())),f.setDate(f.getDate()+1);if(!this._isMonth()){n=s()(".calendar-day",this.$topGrid);var h=new Date(this._exactRange.from.valueOf());for(f=Et.firstDayOfWeek(h,1),l=0;l<7;l++)u="",u=-1===this.workDayIndices.indexOf(f.getDay())?f.getMonth()!==c?" weekend-out":" weekend":f.getMonth()!==c?" out":"",Et.isSameDay(f,new Date)&&(u+=" now"),Et.isSameDay(f,this.selectedDate)&&(u+=" selected"),e=this._format(f,"dd"),n.eq(l).removeClass("weekend-out weekend out selected now").addClass(u).attr("data-day-name",e).data("date",new Date(f.valueOf())),f.setDate(f.getDate()+1)}}},{key:"layoutAxis",value:function(){var e;s()(".calendar-week-axis, .calendar-week-task",this.$grid).remove();var t=this.session;if(s()(".calendar-week-name",this.$container).each((function(n){n>0&&(e=s()(this)).text(t.text("ui.CW",Et.weekInYear(e.next().data("date"))))})),!this._isMonth())for(var n=s()(".calendar-week",this.$grid),r=0;r<24;r++){var o=("00"+r).slice(-2),i=r*this.heightPerHour;n.appendDiv("calendar-week-axis hour"+(0===r?" first":"")).attr("data-axis-name",o+":00").css("top",i+"px");for(var a=1;a<this.numberOfHourDivisions;a++)i+=this.heightPerDivision,n.appendDiv("calendar-week-axis").attr("data-axis-name","").css("top",i+"px")}}},{key:"_onYearPanelDateSelect",value:function(e){this.selectedDate=e.date,this._updateModel(!0,!1)}},{key:"_updateListPanel",value:function(){this._showListPanel&&(this._listComponents.forEach((function(e){e.remove()})),this._listComponents=[],this._renderListPanel())}},{key:"_remove",value:function(){for(var e=s()(".calendar-day",this.$grid),t=0;t<e.length;t++){var n=e.eq(t).children(".calendar-scrollable-components");n.length>0&&(Lh.uninstall(n,this.session),n.remove())}Uk(Xk(i.prototype),"_remove",this).call(this)}},{key:"_renderListPanel",value:function(){var e,t=this,n=[];function r(e){var t=Et.trunc(this.selectedDate);return Et.compare(t,e.coveredDaysRange.from)>=0&&Et.compare(t,e.coveredDaysRange.to)<=0}this.$listTitle.text(this._format(this.selectedDate,"d. MMMM yyyy")),this.components.forEach((function(e){r.call(t,e)&&n.push(e)})),n.forEach((function(n){(e=new kS(t.selectedDate,n)).render(t.$list),t._listComponents.push(e)}))}},{key:"_selectedComponentChanged",value:function(e,t,n){this._setSelection(t,e,n)}},{key:"_onDayContextMenu",value:function(e){this._showContextMenu(e,"Calendar.EmptySpace")}},{key:"_showContextMenu",value:function(e,t){e.preventDefault(),e.stopPropagation();var n=function(e,t){if(this.rendered&&this.attached){var n=zm.filter(this.menus,[t],!0),r=s()(e.currentTarget);0!==n.length&&O.create("ContextMenuPopup",{parent:this,menuItems:n,location:{x:e.pageX,y:e.pageY},$anchor:r}).open()}}.bind(this);this.session.onRequestsDone(n,e,t)}},{key:"_arrangeComponents",value:function(){var e,t,n,r,o,i,a,l,u=s()(".calendar-day",this.$grid);for(e=0;e<u.length;e++){if(o=(n=u.eq(e)).children(".calendar-component:not(.component-task)"),r=n.children(".calendar-component"),l=n.data("date"),(i=n.children(".calendar-scrollable-components")).length>0&&(Lh.uninstall(i,this.session),i.remove()),this._isMonth()&&r.length>0){for(i=n.appendDiv("calendar-scrollable-components"),t=0;t<r.length;t++){var c=r.eq(t);(this._isMonth()||c.hasClass("component-task"))&&i.append(c)}Lh.install(i,{parent:this,session:this.session,axis:"y"})}this._isMonth()&&o.length>2?n.addClass("many-items"):!this._isMonth()&&o.length>1&&(a=this._getComponents(o),this._arrange(a,l),this._arrangeComponentSetPlacement(o,l))}if(this._isMonth())this._uninstallScrollbars(),this.$grid.removeClass("calendar-scrollable-components");else{this.$grid.addClass("calendar-scrollable-components"),this._installScrollbars({parent:this,session:this.session,axis:"y"});var f=s()(".calendar-scrollable-components",this.$topGrid);for(e=0;e<f.length;e++){var h=f.eq(e);Lh.install(h,{parent:this,session:this.session,axis:"y"})}}}},{key:"_getComponents",value:function(e){var t,n,r=[];for(t=0;t<e.length;t++)n=e.eq(t),r.push(n.data("component"));return r}},{key:"_sort",value:function(e){e.sort(this._sortFromTo)}},{key:"_arrange",value:function(e,t){var n,r,o,i,s,a=[];for(this._sort(e),n=0;n<e.length;n++)(o=e[n]).stack||(o.stack={}),o.stack[t]={};for(n=0;n<e.length;n++)for(i=(o=e[n]).getPartDayPosition(t),a.length>0&&this._allEndBefore(a,i.from,t)&&(a=[]),(s=this._findReplacableColumn(a,i.from,t))>=0?(a[s]=o,o.stack[t].x=s):(a.push(o),o.stack[t].x=a.length-1),r=0;r<a.length;r++)a[r].stack[t].w=a.length}},{key:"_allEndBefore",value:function(e,t,n){var r;for(r=0;r<e.length;r++)if(!this._endsBefore(e[r],t,n))return!1;return!0}},{key:"_findReplacableColumn",value:function(e,t,n){var r;for(r=0;r<e.length;r++)if(this._endsBefore(e[r],t,n))return r;return-1}},{key:"_endsBefore",value:function(e,t,n){return e.getPartDayPosition(n).to<=t}},{key:"_arrangeComponentSetPlacement",value:function(e,t){var n,r,o;for(n=0;n<e.length;n++)o=(r=e.eq(n)).data("component").stack[t],r.css("width",100/o.w+"%").css("left",100*o.x/o.w+"%")}},{key:"get$Scrollable",value:function(){return this.$grid}},{key:"_dayPosition",value:function(e,t){var n;return n=e<0?0:100/1440*(60*e+t),Math.round(100*n)/100}},{key:"_hourToNumber",value:function(e){var t=e.split(":");return parseFloat(t[0])+parseFloat(t[1])/60}},{key:"_format",value:function(e,t){return Et.format(e,this.session.locale,t)}},{key:"_sortFromTo",value:function(e,t){var n=Et.parseJsonDate(e.fromDate),r=Et.parseJsonDate(t.fromDate),o=Et.compare(n,r);if(0!==o)return o;var i=Et.parseJsonDate(e.toDate),s=Et.parseJsonDate(t.toDate),a=Et.compare(i,s);if(0!==a)return a;var l=e.item&&e.item.subject?e.item.subject:"",u=t.item&&t.item.subject?t.item.subject:"";return l.localeCompare(u)}}])&&Gk(t.prototype,n),r&&Gk(t,r),i}(ve);function Qk(e){return(Qk="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function eS(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function tS(e,t,n){return(tS="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=iS(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function nS(e,t){return(nS=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function rS(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=iS(e);if(t){var o=iS(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return oS(this,n)}}function oS(e,t){return!t||"object"!==Qk(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function iS(e){return(iS=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}Jk(Zk,"DisplayMode",{DAY:1,WEEK:2,MONTH:3,WORK_WEEK:4}),Jk(Zk,"Direction",{BACKWARD:-1,FORWARD:1});var sS=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&nS(e,t)}(i,e);var t,n,r,o=rS(i);function i(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),o.call(this)}return t=i,(n=[{key:"_postCreateWidget",value:function(){this._sendViewRangeChange()}},{key:"_onWidgetEvent",value:function(e){"viewRangeChange"===e.type?this._sendViewRangeChange():"modelChange"===e.type?this._sendModelChange():"selectionChange"===e.type?this._sendSelectionChange():tS(iS(i.prototype),"_onWidgetEvent",this).call(this,e)}},{key:"_jsonViewRange",value:function(){return Et.toJsonDateRange(this.widget.viewRange)}},{key:"_jsonSelectedDate",value:function(){return Et.toJsonDate(this.widget.selectedDate)}},{key:"_sendViewRangeChange",value:function(){this._send("viewRangeChange",{viewRange:this._jsonViewRange()})}},{key:"_sendModelChange",value:function(){var e={viewRange:this._jsonViewRange(),selectedDate:this._jsonSelectedDate(),displayMode:this.widget.displayMode};this._send("modelChange",e)}},{key:"_sendSelectionChange",value:function(){var e=this.widget.selectedComponent?this.widget.selectedComponent.id:null;this._send("selectionChange",{date:this._jsonSelectedDate(),componentId:e})}}])&&eS(t.prototype,n),r&&eS(t,r),i}(de);function aS(e){return(aS="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function lS(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function uS(e,t,n){return(uS="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=pS(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function cS(e,t){return(cS=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function fS(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pS(e);if(t){var o=pS(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return hS(this,n)}}function hS(e,t){return!t||"object"!==aS(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function pS(e){return(pS=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var dS=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&cS(e,t)}(i,e);var t,n,r,o=fS(i);function i(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(e=o.call(this)).selected=!1,e.fullDay=!1,e.item=null,e._$parts=[],e}return t=i,(n=[{key:"_init",value:function(e){uS(pS(i.prototype),"_init",this).call(this,e),this._syncCoveredDaysRange(this.coveredDaysRange)}},{key:"_syncCoveredDaysRange",value:function(e){e&&(this.coveredDaysRange=new Fr(Et.parseJsonDate(e.from),Et.parseJsonDate(e.to)))}},{key:"_remove",value:function(){this._$parts.forEach((function(e){e.remove()})),this._$parts=[],uS(pS(i.prototype),"_remove",this).call(this)}},{key:"_startLoopDay",value:function(){return Et.compare(this.coveredDaysRange.from,this.parent.viewRange.from)>0?this.coveredDaysRange.from:this.parent.viewRange.from}},{key:"_render",value:function(){var e,t,n;if(this.coveredDaysRange){var r=this._startLoopDay(),o=Et.parseJsonDate(this.toDate),a=Et.parseJsonDate(this.fromDate),l=this.coveredDaysRange.to;if(!this.fullDay){var u=Et.trunc(o);Et.isSameDay(a,o)||0!==Et.compare(o,u)||(o=Et.shiftTime(o,0,0,0,-1),l=Et.shift(l,0,0,-1))}o=Et.toJsonDate(o);var c=Et.shift(l,0,0,1);if(!(Et.compare(r,c)>0))for(;!(Et.isSameDay(r,c)||(e=r,r=Et.shift(r,0,0,1),Et.compare(e,this.parent.viewRange.to)>0));)if(t=this.fullDay&&!this.parent._isMonth()?this._findDayInGrid(e,this.parent.$topGrid):this._findDayInGrid(e,this.parent.$grid))if((n=t.appendDiv("calendar-component")).addClass(this.item.cssClass).data("component",this).data("partDay",e).mousedown(this._onMouseDown.bind(this)).on("contextmenu",this._onContextMenu.bind(this)),n.appendDiv("calendar-component-leftcolorborder"),n.appendDiv("content",this.item.subject),this._$parts.push(n),this.parent._isMonth()){var f=t.data("new-width")||t.width();n.addClass("component-month").toggleClass("compact",f<i.MONTH_COMPACT_THRESHOLD)}else if(this.fullDay){var h=s()(".component-task",t).length;this._arrangeTask(30+26*h),n.addClass("component-task")}else{var p=Et.parseJsonDate(this.fromDate),d=Et.parseJsonDate(o),y=this._getHours(this.fromDate),v=this._getHours(o);n.addClass("component-day"),Et.isSameDay(Et.trunc(this.coveredDaysRange.from),Et.trunc(l))?this._partPosition(n,y,v):Et.isSameDay(e,p)?this._partPosition(n,y,25).addClass("component-open-bottom"):Et.isSameDay(e,d)?this._partPosition(n,0,v).addClass("component-open-top"):this._partPosition(n,0,25).addClass("component-open-top").addClass("component-open-bottom")}}}},{key:"_getHours",value:function(e){var t=Et.parseJsonDate(e);return t.getHours()+t.getMinutes()/60}},{key:"_findDayInGrid",value:function(e,t){return t.find(".calendar-day").filter((function(t,n){return Et.isSameDay(s()(this).data("date"),e)})).eq(0)}},{key:"_isTask",value:function(){return!this.parent._isMonth()&&this.fullDay}},{key:"_arrangeTask",value:function(e){this._$parts.forEach((function(t){t.css("top",e+"px")}))}},{key:"_isDayPart",value:function(){return!this.parent._isMonth()&&!this.fullDay}},{key:"_getHourRange",value:function(e){var t=new Fr(this._getHours(this.fromDate),this._getHours(this.toDate)),n=new Fr(Et.parseJsonDate(this.fromDate),Et.parseJsonDate(this.toDate));return Et.isSameDay(e,n.from)&&Et.isSameDay(e,n.to)?new Fr(t.from,t.to):Et.isSameDay(e,n.from)?new Fr(t.from,24):Et.isSameDay(e,n.to)?new Fr(0,t.to):new Fr(0,24)}},{key:"getPartDayPosition",value:function(e){return this._getDisplayDayPosition(this._getHourRange(e))}},{key:"_getDisplayDayPosition",value:function(e){var t=new Fr(this.parent._dayPosition(e.from,0),this.parent._dayPosition(e.to,0)),n=Math.round(1e4/24/this.parent.numberOfHourDivisions)/100;return t.size()<n?new Fr(t.from,t.from+n):t}},{key:"_partPosition",value:function(e,t,n){var r=25===n?23:0;n=Math.min(24,n);var o=new Fr(t,n),i=this._getDisplayDayPosition(o);return r=Math.round(100/1920*r*100)/100,e.css("top",i.from+"%").css("height",i.to-i.from-r+"%")}},{key:"_renderProperties",value:function(){uS(pS(i.prototype),"_renderProperties",this).call(this),this._renderSelected()}},{key:"_renderSelected",value:function(){this._$parts.forEach((function(e){e.toggleClass("comp-selected",this.selected)}),this)}},{key:"setSelected",value:function(e){this.setProperty("selected",e)}},{key:"updateSelectedComponent",value:function(e,t){this.parent._selectedComponentChanged(this,e.data("partDay"),t)}},{key:"_onMouseDown",value:function(e){var t=s()(e.delegateTarget);this.updateSelectedComponent(t,!1),0===e.button&&O.create("WidgetPopup",{parent:this.parent,$anchor:t,closeOnAnchorMouseDown:!0,closeOnMouseDownOutside:!0,closeOnOtherPopupOpen:!0,horizontalAlignment:Id.Alignment.LEFT,verticalAlignment:Id.Alignment.CENTER,trimWidth:!1,trimHeight:!1,horizontalSwitch:!0,verticalSwitch:!0,withArrow:!0,cssClass:"tooltip",scrollType:"remove",location:{y:e.originalEvent.clientY},widget:{objectType:"Label",htmlEnabled:!0,cssClass:"tooltip-content",value:this._description()}}).open(),e.stopPropagation()}},{key:"_onContextMenu",value:function(e){this.parent._showContextMenu(e,"Calendar.CalendarComponent")}},{key:"_format",value:function(e,t){return Et.format(e,this.session.locale,t)}},{key:"_description",value:function(){var e=[],t=null,n="",r=Et.parseJsonDate(this.fromDate),o=Et.parseJsonDate(this.toDate);return Wn.hasText(this.item.subject)&&e.push({text:Wn.encode(this.item.subject),cssClass:"calendar-component-title"}),this.fullDay||(t=Et.isSameDay(r,o)?this.session.text("ui.FromXToY",this._format(r,"HH:mm"),this._format(o,"HH:mm")):this.session.text("ui.FromXToY",this._format(r,"EEEE HH:mm "),this._format(o,"EEEE HH:mm"))),Wn.hasText(t)&&e.push({text:t,cssClass:"calendar-component-intro"}),Wn.hasText(this.item.description)&&e.push({text:Wn.nl2br(this.item.description)}),e.forEach((function(e){n+=(e.cssClass?'<span class="'+e.cssClass+'">'+e.text+"</span>":e.text)+"<br/>"})),n}}])&&lS(t.prototype,n),r&&lS(t,r),i}(ve);function yS(e){return(yS="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function vS(e,t){return(vS=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function bS(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=gS(e);if(t){var o=gS(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return mS(this,n)}}function mS(e,t){return!t||"object"!==yS(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function gS(e){return(gS=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}!function(e,t,n){t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}(dS,"MONTH_COMPACT_THRESHOLD",100);var _S=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&vS(e,t)}(n,e);var t=bS(n);function n(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),t.call(this)}return n}(de);function wS(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var kS=function(){function e(t,n){var r=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.partDay=t,this.source=n,this.$container=null,this._selectedListener=n.on("selected",(function(e){r.$container.toggleClass("comp-selected",e.selected)})),this._removeListener=n.on("remove",this.remove.bind(this))}var t,n,r;return t=e,(n=[{key:"render",value:function(e){var t=this.source;this.$container=e.appendDiv("calendar-component").data("partDay",this.partDay).addClass(t.item.cssClass).toggleClass("comp-selected",t._selected).mousedown(this._onMouseDown.bind(this,t)).on("contextmenu",t._onContextMenu.bind(t)),this.$container.appendDiv("calendar-component-leftcolorborder"),this.$container.appendDiv("content").html(t._description())}},{key:"_onMouseDown",value:function(e,t){t.preventDefault();var n=$(t.delegateTarget);e.updateSelectedComponent(n,!0)}},{key:"remove",value:function(){this.source.removeListener(this._selectedListener),this.source.removeListener(this._removeListener),this.$container.remove()}}])&&wS(t.prototype,n),r&&wS(t,r),e}();function SS(e){return(SS="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function OS(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function TS(e,t){return(TS=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function CS(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=RS(e);if(t){var o=RS(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return PS(this,n)}}function PS(e,t){return!t||"object"!==SS(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function RS(e){return(RS=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var xS=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&TS(e,t)}(i,e);var t,n,r,o=CS(i);function i(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(t=o.call(this)).calendar=e,t.stacked=!1,t.compacted=!1,t}return t=i,(n=[{key:"layout",value:function(e){var t,n=0,r=this.calendar._yearPanel.$container,o=this.calendar.$grids,i=this.calendar.$header;n+=e.cssMarginTop()+e.cssMarginBottom(),e.css("height","calc(100% - "+n+"px)"),this.undoCompact(),this.undoStack(),i[0].scrollWidth>e.width()&&this.stack(),i[0].scrollWidth>e.width()&&this.compact(),t=i.outerHeight(!0),r.css("height","calc(100% - "+(t+r.cssMarginY())+"px)"),o.css("height","calc(100% - "+(t+o.cssMarginY())+"px)"),this.calendar.layoutSize(),this.calendar.layoutYearPanel()}},{key:"compact",value:function(){if(!this.compacted){var e=this.calendar.$headerRow2;this.calendar.$title.appendTo(this.calendar.$headerRow2),e.show(),this.compacted=!0}}},{key:"undoCompact",value:function(){if(this.compacted){var e=this.calendar.$headerRow2;this.calendar.$title.insertBefore(this.calendar.$commands),e.hide(),this.compacted=!1}}},{key:"stack",value:function(){this.stacked||(this.calendar.$commands.children(".calendar-mode").hide(),this.calendar.modesMenu.setVisible(!0),this.stacked=!0)}},{key:"undoStack",value:function(){this.stacked&&(this.calendar.$commands.children(".calendar-mode").show(),this.calendar.modesMenu.setVisible(!1),this.stacked=!1)}}])&&OS(t.prototype,n),r&&OS(t,r),i}(Zs);function ES(e){return(ES="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function DS(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function AS(e,t){return(AS=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function FS(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=jS(e);if(t){var o=jS(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return $S(this,n)}}function $S(e,t){return!t||"object"!==ES(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function jS(e){return(jS=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var BS=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&AS(e,t)}(i,e);var t,n,r,o=FS(i);function i(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),o.call(this)}return t=i,(n=[{key:"doAction",value:function(){return!!this.prepareDoAction()&&(this.setSelected(!0),this.parentMenu.setSelected(!1),!0)}}])&&DS(t.prototype,n),r&&DS(t,r),i}(eg);function MS(e){return(MS="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function IS(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function LS(e,t,n){return(LS="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=WS(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function HS(e,t){return(HS=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function NS(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=WS(e);if(t){var o=WS(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return VS(this,n)}}function VS(e,t){return!t||"object"!==MS(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function WS(e){return(WS=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var zS=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&HS(e,t)}(i,e);var t,n,r,o=NS(i);function i(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(e=o.call(this)).cssClass="calendar-mode-menu",e.displayMode,e}return t=i,(n=[{key:"_init",value:function(e){LS(WS(i.prototype),"_init",this).call(this,e),this.calendar=this.parent;var t=[];t.push(O.create("CalendarModeMenu",{parent:this,displayMode:Zk.DisplayMode.DAY,text:this.session.text("ui.CalendarDay")})),t.push(O.create("CalendarModeMenu",{parent:this,displayMode:Zk.DisplayMode.WORK_WEEK,text:this.session.text("ui.CalendarWorkWeek")})),t.push(O.create("CalendarModeMenu",{parent:this,displayMode:Zk.DisplayMode.WEEK,text:this.session.text("ui.CalendarWeek")})),t.push(O.create("CalendarModeMenu",{parent:this,displayMode:Zk.DisplayMode.MONTH,text:this.session.text("ui.CalendarMonth")})),this.addChildActions(t),this.childActions.forEach((function(e){e.on("propertyChange",this._onMenuPropertyChange.bind(this))}),this),this._setDisplayMode(this.displayMode)}},{key:"setDisplayMode",value:function(e){this.setProperty("displayMode",e)}},{key:"_setDisplayMode",value:function(e){this._setProperty("displayMode",e);var t=this.getMenuForMode(this.displayMode);t.setSelected(!0),this.setText(t.text)}},{key:"getMenuForMode",value:function(e){return rt.find(this.childActions,(function(t){return t.displayMode===e}))}},{key:"_onMenuPropertyChange",value:function(e){if("selected"===e.propertyName&&e.newValue){var t=e.source.displayMode;this.setDisplayMode(t),this.calendar.setDisplayMode(t),this.childActions.forEach((function(t){t!==e.source&&t.setSelected(!1)}),this)}}}])&&IS(t.prototype,n),r&&IS(t,r),i}(eg);function GS(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var US=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.from=t,this.to=n}var t,n,r;return t=e,r=[{key:"ensure",value:function(t){return t?t instanceof e?t:new e(Et.ensure(t.from),Et.ensure(t.to)):t}}],(n=[{key:"equals",value:function(e){return!!e&&Et.equals(this.from,e.from)&&Et.equals(this.to,e.to)}},{key:"toString",value:function(){return"scout.DateRange[from="+(null===this.from?"null":this.from.toUTCString())+" to="+(null===this.to?"null":this.to.toUTCString())+"]"}}])&&GS(t.prototype,n),r&&GS(t,r),e}();function KS(e){return(KS="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function qS(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function YS(e,t,n){return(YS="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=QS(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function XS(e,t){return(XS=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function JS(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=QS(e);if(t){var o=QS(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return ZS(this,n)}}function ZS(e,t){return!t||"object"!==KS(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function QS(e){return(QS=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var eO=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&XS(e,t)}(i,e);var t,n,r,o=JS(i);function i(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(e=o.call(this)).$yearTitle,e.$yearList,e.selectedDate,e.displayMode,e.alwaysSelectFirstDay,e}return t=i,(n=[{key:"_init",value:function(e){YS(QS(i.prototype),"_init",this).call(this,e),this.alwaysSelectFirstDay=e.alwaysSelectFirstDay}},{key:"_render",value:function(){this.$container=this.$parent.appendDiv("year-panel-container"),this.$yearTitle=this.$container.appendDiv("year-panel-title"),this.$yearList=this.$container.appendDiv("year-panel-list")}},{key:"renderContent",value:function(){this.removeContent(),this._drawYear(),this._installScrollbars({axis:"y"}),this.yearRendered=!0,this._colorYear()}},{key:"get$Scrollable",value:function(){return this.$yearList}},{key:"removeContent",value:function(){this._uninstallScrollbars(),this.$yearList.empty(),this.yearRendered=!1}},{key:"_remove",value:function(){this.removeContent(),YS(QS(i.prototype),"_remove",this).call(this)}},{key:"_drawYear",value:function(){var e,t,n,r,o,i,a=this.selectedDate.getFullYear();for(this.$yearTitle.data("year",a).empty(),this.$yearTitle.appendDiv("year-title-item",a-1).data("year-diff",-1).click(this._onYearClick.bind(this)),this.$yearTitle.appendDiv("year-title-item selected",a),this.$yearTitle.appendDiv("year-title-item",a+1).data("year-diff",1).click(this._onYearClick.bind(this)),t=0;t<12;t++)for(e=new Date(a,t,1),n=this.$yearList.appendDiv("year-month").attr("data-title",this._format(e,"MMMM")),r=1;r<=31&&(o=new Date(a,t,r)).getMonth()===t;r++)i=n.appendDiv("year-day",r).data("date",o),0!==o.getDay()&&6!==o.getDay()||i.addClass("weekend"),1===r&&i.css("margin-left",(o.getDay()+6)%7*i.outerWidth());s()(".year-day",this.$yearList).click(this._onYearDayClick.bind(this)).hover(this._onYearHoverIn.bind(this),this._onYearHoverOut.bind(this)),Lh.update(this.$yearList)}},{key:"_colorYear",value:function(){if(this.yearRendered){s()(".year-day.year-range, .year-day.year-range-day",this.$yearList).removeClass("year-range year-range-day");var e,t,n=this;s()(".year-day",this.$yearList).each((function(){e=s()(this),t=e.data("date"),n.displayMode!==Zk.DisplayMode.DAY&&t>=n.viewRange.from&&t<n.viewRange.to&&e.addClass("year-range"),Et.isSameDay(t,n.selectedDate)&&e.addClass("year-range-day")})),this._scrollYear()}}},{key:"_scrollYear",value:function(){var e,t,n,r=s()(".year-range-day",this.$yearList),o=r.parent(),i=r.parent().parent();o[0]&&(e=o[0].offsetTop,t=o.outerHeight()/2,n=i.outerHeight()/2,this.$yearList.animateAVCSD("scrollTop",e+t-n))}},{key:"_format",value:function(e,t){return Et.format(e,this.session.locale,t)}},{key:"selectDate",value:function(e){this.selectedDate=e,this.rendered&&(e&&e.getFullYear()===this.$yearTitle.data("year")||this.renderContent(),this._colorYear())}},{key:"setDisplayMode",value:function(e){e!==this.displayMode&&(this._setProperty("displayMode",e),this.rendered&&this._colorYear())}},{key:"setViewRange",value:function(e){e!==this.viewRange&&(this._setProperty("viewRange",e),this.rendered&&this._colorYear())}},{key:"_onYearClick",value:function(e){var t,n=fO.DisplayMode,r=s()(e.target).data("year-diff"),o=this.selectedDate.getFullYear(),i=this.selectedDate.getMonth(),a=this.selectedDate.getDate(),l=new Date(o+r,i,a);this.alwaysSelectFirstDay&&(O.isOneOf(this.displayMode,n.WEEK,n.WORK_WEEK,n.CALENDAR_WEEK)?(t=Et.weekInYear(this.selectedDate)-Et.weekInYear(l),l=Et.shift(l,0,0,7*t),l=Et.shiftToNextOrPrevMonday(l,0)):O.isOneOf(this.displayMode,n.MONTH,n.YEAR)&&(l=new Date(o+r,i,1))),this.selectedDate=l,this.trigger("dateSelect",{date:this.selectedDate})}},{key:"_onYearDayClick",value:function(e){this.selectedDate=s()(".year-hover-day",this.$yearList).data("date"),this.selectedDate&&this.trigger("dateSelect",{date:this.selectedDate})}},{key:"_onYearHoverIn",value:function(e){var t,n,r,o,i=s()(e.target).data("date"),a=i.getFullYear(),l=i.getMonth(),u=i.getDate(),c=(i.getDay()+6)%7;this.displayMode===Zk.DisplayMode.DAY?(t=new Date(a,l,u),n=new Date(a,l,u)):this.displayMode===Zk.DisplayMode.WEEK?(t=new Date(a,l,u-c),n=new Date(a,l,u-c+6)):this.displayMode===Zk.DisplayMode.WORK_WEEK?(t=new Date(a,l,u-c),n=new Date(a,l,u-c+4),i>n&&(i=n)):this.displayMode===Zk.DisplayMode.MONTH?(t=new Date(a,l,1),n=new Date(a,l+1,0)):this.displayMode===fO.DisplayMode.YEAR?(t=new Date(a,l,1),n=t):(t=new Date(a,l,u-c),n=t),this.alwaysSelectFirstDay&&(i=t),s()(".year-day",this.$yearList).each((function(){r=s()(this),(o=r.data("date"))>=t&&o<=n?r.addClass("year-hover"):r.removeClass("year-hover"),Et.isSameDay(i,o)&&r.addClass("year-hover-day")}))}},{key:"_onYearHoverOut",value:function(e){s()(".year-day.year-hover, .year-day.year-hover-day",this.$yearList).removeClass("year-hover year-hover-day")}}])&&qS(t.prototype,n),r&&qS(t,r),i}(ve);function tO(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var nO=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.widget=null,this.emptyMandatoryElementsTextKey=null,this.emptyMandatoryElementsText=null,this.invalidElementsTextKey=null,this.invalidElementsText=null,this.saveChangesQuestionTextKey=null,this.askIfNeedSave=!0,this.askIfNeedSaveText=null,this.events=new ln,this.handlers={load:this._defaultLoad.bind(this),save:this._defaultSave.bind(this)}}var t,n,r;return t=e,(n=[{key:"init",value:function(e){O.assertParameter("widget",e.widget),s.a.extend(this,e),Pr.isNullOrUndefined(this.emptyMandatoryElementsText)&&(this.emptyMandatoryElementsText=this.session().text(this.emptyMandatoryElementsTextKey)),Pr.isNullOrUndefined(this.invalidElementsText)&&(this.invalidElementsText=this.session().text(this.invalidElementsTextKey)),Pr.isNullOrUndefined(this.askIfNeedSaveText)&&(this.askIfNeedSaveText=this.session().text(this.saveChangesQuestionTextKey))}},{key:"load",value:function(){var e=this;return this._load().then((function(){e.markAsSaved(),e.events.trigger("postLoad")}))}},{key:"_load",value:function(){var e=this;return this.handlers.load().then((function(t){e.events.trigger("load")}))}},{key:"_defaultLoad",value:function(){return s.a.resolvedPromise()}},{key:"ok",value:function(){var e=this;return this._whenInvalid(this._validate).then((function(t){if(!t)return e.requiresSave()?e._whenInvalid(e._save).then((function(t){if(!t)return e.markAsSaved(),e.close()})):e.close()}))}},{key:"cancel",value:function(){return this.requiresSave()&&this.askIfNeedSave?this._showYesNoCancelMessageBox(this.askIfNeedSaveText,this.ok.bind(this),this.close.bind(this)):this.close()}},{key:"reset",value:function(){var e=this;return this._reset(),this.load().then((function(){e.events.trigger("reset")}))}},{key:"close",value:function(){return this._close()}},{key:"_close",value:function(){return this.events.trigger("close"),s.a.resolvedPromise()}},{key:"save",value:function(){var e=this;return this._whenInvalid(this._validate).then((function(t){if(!t&&e.requiresSave())return e._whenInvalid(e._save).then((function(t){t||e.markAsSaved()}))}))}},{key:"_save",value:function(){var e=this;return this.handlers.save().then((function(t){return e.events.trigger("save"),t}))}},{key:"_defaultSave",value:function(){return s.a.resolvedPromise()}},{key:"markAsSaved",value:function(){}},{key:"requiresSave",value:function(){return!1}},{key:"setAskIfNeedSave",value:function(e){this.askIfNeedSave=e}},{key:"_whenInvalid",value:function(e){var t=this;return e.call(this).then((function(e){return e&&e.severity!==Br.Severity.OK?t._showStatusMessageBox(e):s.a.resolvedPromise(!1)})).catch((function(e){return t._showStatusMessageBox(function(e){return e instanceof Br?e:"string"==typeof e?Br.error({message:e}):Br.error({message:e.message})}(e))}))}},{key:"_showYesNoCancelMessageBox",value:function(e,t,n){return PU.create(this.widget).withSeverity(Br.Severity.WARNING).withHeader(e).withYes().withNo().withCancel().buildAndOpen().then((function(e){return e===yU.Buttons.YES?t():e===yU.Buttons.NO?n():s.a.resolvedPromise()}))}},{key:"_showStatusMessageBox",value:function(e){return PU.createOk(this.widget).withSeverity(e.severity).withBody(e.message,!0).buildAndOpen().then((function(){var t=e.severity===Br.Severity.ERROR;return s.a.resolvedPromise(t)}))}},{key:"_validate",value:function(){var e=this._validateElements();return e.isValid()&&(e=this._validateWidget()),s.a.resolvedPromise(e)}},{key:"_validateElements",value:function(){var e=this._invalidElements(),t=new Br;return 0===e.missingElements.length&&0===e.invalidElements.length?t.severity=Br.Severity.OK:(t.severity=Br.Severity.ERROR,t.message=this._createInvalidElementsMessageHtml(e.missingElements,e.invalidElements)),t}},{key:"_validateWidget",value:function(){return Br.ok()}},{key:"_invalidElements",value:function(){return{missingElements:[],invalidElements:[]}}},{key:"_createInvalidElementsMessageHtml",value:function(e,t){var n=s()("<div>"),r=e.length>0,o=t.length>0;return r&&i.call(this,n,this.emptyMandatoryElementsText,e,this._missingElementText),r&&o&&n.appendElement("<br>"),o&&i.call(this,n,this.invalidElementsText,t,this._invalidElementText),n.html();function i(e,t,n,r){e.appendElement("<strong>").text(t);var o=e.appendElement("<ul>");n.forEach((function(e){o.appendElement("<li>").text(r.call(this,e))}),this)}}},{key:"_invalidElementText",value:function(e){return""}},{key:"_missingElementText",value:function(e){return""}},{key:"session",value:function(){return this.widget.session}},{key:"handle",value:function(e,t){if(-1===["load","save"].indexOf(e))throw new Error("Cannot register handler for unsupported type '"+e+"'");this.handlers[e]=t}},{key:"on",value:function(e,t){return this.events.on(e,t)}},{key:"off",value:function(e,t){return this.events.off(e,t)}}])&&tO(t.prototype,n),r&&tO(t,r),e}();function rO(e){return(rO="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function oO(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function iO(e,t,n){return(iO="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=uO(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function sO(e,t){return(sO=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function aO(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=uO(e);if(t){var o=uO(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return lO(this,n)}}function lO(e,t){return!t||"object"!==rO(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function uO(e){return(uO=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function cO(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var fO=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&sO(e,t)}(i,e);var t,n,r,o=aO(i);function i(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(e=o.call(this)).activityMap=[],e.activitySelectable=!1,e.availableDisplayModes=[],e.displayMode=null,e.displayModeOptions={},e.headerVisible=!0,e.label=null,e.resources=[],e.resourceMap=[],e.selectionMode=i.SelectionMode.MULTI_RANGE,e.selectionRange=new US,e.selectedResources=[],e.viewRange={},e.selectedActivity=null,e._resourceTitleWidth=20,e._rangeSelectionStarted=!1,e.startRow=null,e.lastRow=null,e.$container=null,e.$range=null,e.$modes=null,e.$grid=null,e.transformLeft=function(e){return e},e.transformWidth=function(e,t){return t-e},e.yearPanelVisible=!1,e._addWidgetProperties(["menus"]),e}return t=i,(n=[{key:"_createKeyStrokeContext",value:function(){return new $u}},{key:"_init",value:function(e){iO(uO(i.prototype),"_init",this).call(this,e),this._yearPanel=O.create("YearPanel",{parent:this,alwaysSelectFirstDay:!0}),this._yearPanel.on("dateSelect",this._onYearPanelDateSelect.bind(this)),this._header=O.create("PlannerHeader",{parent:this}),this._header.on("todayClick",this._onTodayClick.bind(this)),this._header.on("yearClick",this._onYearClick.bind(this)),this._header.on("previousClick",this._onPreviousClick.bind(this)),this._header.on("nextClick",this._onNextClick.bind(this)),this._header.on("displayModeClick",this._onDisplayModeClick.bind(this)),this.menuBar=O.create("MenuBar",{parent:this,position:Yw.Position.BOTTOM,menuOrder:new LO(this.session,"Planner")});for(var t=0;t<this.resources.length;t++)this._initResource(this.resources[t]);this._setDisplayMode(this.displayMode),this._setAvailableDisplayModes(this.availableDisplayModes),this._setViewRange(this.viewRange),this._setSelectedResources(this.selectedResources),this._setSelectedActivity(this.selectedActivity),this._setSelectionRange(this.selectionRange),this._setMenus(this.menus),this._setDisplayModeOptions(this.displayModeOptions),this._tooltipSupport=new Pp({parent:this,arrowPosition:50})}},{key:"_initResource",value:function(e){Mt.applyTo(e,"Resource"),e.activities.forEach((function(e){this._initActivity(e)}),this),this.resourceMap[e.id]=e}},{key:"_initActivity",value:function(e){e.beginTime=Et.parseJsonDate(e.beginTime),e.endTime=Et.parseJsonDate(e.endTime),Mt.applyTo(e,"Activity"),this.activityMap[e.id]=e}},{key:"_render",value:function(){this.$container=this.$parent.appendDiv("planner");var e=new FO(this);this.htmlComp=ea.install(this.$container,this.session),this.htmlComp.setLayout(e),this._header.render(),this._yearPanel.render(),this.$grid=this.$container.appendDiv("planner-grid").on("mousedown",".resource-cells",this._onCellMouseDown.bind(this)).on("mousedown",".resource-title",this._onResourceTitleMouseDown.bind(this)).on("contextmenu",".resource-title",this._onResourceTitleContextMenu.bind(this)).on("contextmenu",".planner-activity",this._onActivityContextMenu.bind(this)),this.$scale=this.$container.appendDiv("planner-scale"),this.menuBar.render(),xp.install(this.$grid,{parent:this,selector:".planner-activity",text:function(e){if(this._activityById(e.attr("data-id")))return this._activityById(e.attr("data-id")).tooltipText}.bind(this)}),this._installScrollbars(),this._gridScrollHandler=this._onGridScroll.bind(this),this.$grid.on("scroll",this._gridScrollHandler)}},{key:"_renderProperties",value:function(){iO(uO(i.prototype),"_renderProperties",this).call(this),this._renderViewRange(),this._renderHeaderVisible(),this._renderYearPanelVisible(!1),this._renderResources(),this._renderSelectedActivity(),this._renderSelectedResources(),setTimeout(this._renderSelectionRange.bind(this))}},{key:"get$Scrollable",value:function(){return this.$grid}},{key:"_onPreviousClick",value:function(e){this._navigateDate(i.Direction.BACKWARD)}},{key:"_onNextClick",value:function(e){this._navigateDate(i.Direction.FORWARD)}},{key:"_navigateDate",value:function(e){var t=new US(this.viewRange.from,this.viewRange.to),n=i.DisplayMode;this.displayMode===n.DAY?(t.from=Et.shift(this.viewRange.from,0,0,e),t.to=Et.shift(this.viewRange.to,0,0,e)):O.isOneOf(this.displayMode,n.WEEK,n.WORK_WEEK)?(t.from=Et.shift(this.viewRange.from,0,0,7*e),t.from=Et.ensureMonday(t.from,-1*e),t.to=Et.shift(this.viewRange.to,0,0,7*e)):this.displayMode===n.MONTH||this.displayMode===n.CALENDAR_WEEK?(t.from=Et.shift(this.viewRange.from,0,e,0),t.from=Et.ensureMonday(t.from,-1*e),t.to=Et.shift(this.viewRange.to,0,e,0)):this.displayMode===n.YEAR&&(t.from=Et.shift(this.viewRange.from,0,3*e,0),t.to=Et.shift(this.viewRange.to,0,3*e,0)),this.setViewRange(t)}},{key:"_onTodayClick",value:function(e){var t=this._today(),n=t.getFullYear(),r=t.getMonth(),o=t.getDate(),s=(t.getDay()+6)%7,a=i.DisplayMode;t=this.displayMode===a.DAY?new Date(n,r,o):this.displayMode===a.YEAR?new Date(n,r,1):new Date(n,r,o-s),this.setViewRangeFrom(t)}},{key:"_today",value:function(){return new Date}},{key:"_onDisplayModeClick",value:function(e){var t=e.displayMode;this.setDisplayMode(t)}},{key:"_onYearClick",value:function(e){this.setYearPanelVisible(!this.yearPanelVisible)}},{key:"_onYearPanelDateSelect",value:function(e){this.setViewRangeFrom(e.date)}},{key:"_onResourceTitleMouseDown",value:function(e){var t=s()(e.target).parent();t.isSelected()&&(3===e.which||1===e.which&&e.ctrlKey)||(this.startRow=t.data("resource"),this.lastRow=this.startRow,this._select())}},{key:"_onResourceTitleContextMenu",value:function(e){this._showContextMenu(e,"Planner.Resource")}},{key:"_onRangeSelectorContextMenu",value:function(e){this._showContextMenu(e,"Planner.Range")}},{key:"_onActivityContextMenu",value:function(e){this._showContextMenu(e,"Planner.Activity")}},{key:"_showContextMenu",value:function(e,t){e.preventDefault(),e.stopPropagation();var n=function(e,t){if(this.rendered&&this.attached){var n=this._filterMenus([t],!0),r=s()(e.currentTarget);0!==n.length&&O.create("ContextMenuPopup",{parent:this,menuItems:n,location:{x:e.pageX,y:e.pageY},$anchor:r}).open()}}.bind(this);this.session.onRequestsDone(n,e,t)}},{key:"_onGridScroll",value:function(){this._reconcileScrollPos()}},{key:"_reconcileScrollPos",value:function(){var e=this.$grid.scrollLeft();this.$scale.scrollLeft(e)}},{key:"_renderRange",value:function(){if(this.viewRange.from&&this.viewRange.to){var e,t=new Date(this.viewRange.to.valueOf()-1),n=this.session.text("ui.to"),r=i.DisplayMode;e=Et.isSameDay(this.viewRange.from,t)?this._dateFormat(this.viewRange.from,"d. MMMM yyyy"):this.viewRange.from.getMonth()===t.getMonth()&&this.viewRange.from.getFullYear()===t.getFullYear()?Wn.join(" ",this._dateFormat(this.viewRange.from,"d."),n,this._dateFormat(t,"d. MMMM yyyy")):this.viewRange.from.getFullYear()===t.getFullYear()?this.displayMode===r.YEAR?Wn.join(" ",this._dateFormat(this.viewRange.from,"MMMM"),n,this._dateFormat(t,"MMMM yyyy")):Wn.join(" ",this._dateFormat(this.viewRange.from,"d.  MMMM"),n,this._dateFormat(t,"d. MMMM yyyy")):this.displayMode===r.YEAR?Wn.join(" ",this._dateFormat(this.viewRange.from,"MMMM yyyy"),n,this._dateFormat(t,"MMMM yyyy")):Wn.join(" ",this._dateFormat(this.viewRange.from,"d.  MMMM yyyy"),n,this._dateFormat(t,"d. MMMM yyyy")),s()(".planner-select",this._header.$range).text(e)}}},{key:"_renderScale",value:function(){if(this.viewRange.from&&this.viewRange.to){var e,t=this,n=i.DisplayMode;this.$scale.empty(),this.$grid.children(".planner-small-scale-item-line").remove(),this.$grid.children(".planner-large-scale-item-line").remove(),this.$scaleTitle=this.$scale.appendDiv("planner-scale-title"),this._renderLabel(),this.$timeline=this.$scale.appendDiv("timeline"),this.$timelineLarge=this.$timeline.appendDiv("timeline-large"),this.$timelineSmall=this.$timeline.appendDiv("timeline-small"),this.displayMode===n.DAY?this._renderDayScale():O.isOneOf(this.displayMode,n.WORK_WEEK,n.WEEK)?this._renderWeekScale():this.displayMode===n.MONTH?this._renderMonthScale():this.displayMode===n.CALENDAR_WEEK?this._renderCalendarWeekScale():this.displayMode===n.YEAR&&this._renderYearScale();var r,o,a,l,u=this.$timelineSmall.children(".scale-item"),c=this.$timelineLarge.children(".scale-item");if(e=100/u.length,c.each((function(){var n=s()(this),r=t.$grid.prependDiv("planner-large-scale-item-line");n.css("width",n.data("count")*e+"%").data("scale-item-line",r),n.prependDiv("planner-large-scale-item-line").css("left",0)})),u.each((function(n){var r=s()(this);if(r.css("width",e+"%"),!r.data("first")){var o=t.$grid.prependDiv("planner-small-scale-item-line");r.data("scale-item-line",o),r.prependDiv("planner-small-scale-item-line").css("left",0)}})),this.beginScale=this.$timelineSmall.children().first().data("date-from").valueOf(),this.endScale=this.$timelineSmall.children().last().data("date-to").valueOf(),O.isOneOf(this.displayMode,n.WORK_WEEK,n.WEEK)){var f=this.displayModeOptions[this.displayMode],h=(f.interval,f.firstHourOfDay),p=f.lastHourOfDay;this.transformLeft=(r=this.viewRange.from,o=this.viewRange.to,a=h,l=p,function(e){e=new Date(e),r=new Date(r);var t=(o=new Date(o))-r,n=Et.compareDays(e,r),i=Et.compareDays(o,r),s=36e5*n*24,u=24/(l-a+1),c=n/i;return e.getHours()<a?100*(u/t+c):e.getHours()>l?100*(u/t+(c=(n+1)/i)):100*((e.valueOf()-(r.valueOf()+36e5*a)-s)*u/t+c)}),this.transformWidth=function(e,t,n,r,o){return function(o,i){var s=t-e,a=new Fr(new Date(o),new Date(i)),l=this._findHiddenRangesInWeekMode();return a.subtractAll(l).reduce((function(e,t){return e+t.size()}),0)*(24/(r-n+1))/s*100}}(this.viewRange.from,this.viewRange.to,h,p)}else this.transformLeft=function(e,t){return function(n){return(n-e)/(t-e)*100}}(this.beginScale,this.endScale),this.transformWidth=function(e,t){return function(n,r){return(r-n)/(t-e)*100}}(this.beginScale,this.endScale)}}},{key:"_findHiddenRangesInWeekMode",value:function(){if(!O.isOneOf(this.displayMode,i.DisplayMode.WORK_WEEK,i.DisplayMode.WEEK))return[];for(var e,t=[],n=this.displayModeOptions[this.displayMode],r=n.firstHourOfDay,o=n.lastHourOfDay,s=new Date(this.viewRange.from.valueOf());s<this.viewRange.to;)(e=new Fr(new Date(s.valueOf()),Et.shiftTime(s,r))).size()>0&&t.push(e),(e=new Fr(Et.shiftTime(s,o+1),Et.shiftTime(s,24))).size()>0&&t.push(e),s.setHours(0),s.setMinutes(0),s.setDate(s.getDate()+1);return t}},{key:"_renderDayScale",value:function(){var e,t,n,r=!0,o=new Date(this.viewRange.from.valueOf()),i=this.displayModeOptions[this.displayMode],s=i.interval,a=i.labelPeriod,l=i.firstHourOfDay,u=i.lastHourOfDay;for(s=Math.min(s,60*(u-l+1));o<this.viewRange.to;)o.getHours()>=l&&o.getHours()<=u?(e=!1,(0===o.getMinutes()||r)&&(t=this.$timelineLarge.appendDiv("scale-item",this._dateFormat(o,"HH")).data("count",0),e=!0),n=this.$timelineSmall.appendDiv("scale-item",this._dateFormat(o,":mm")).data("date-from",new Date(o.valueOf())),o.getMinutes()%(s*a)!=0&&n.addClass("label-invisible"),o=Et.shiftTime(o,0,s,0),this._incrementTimelineScaleItems(t,n,o,e),r=!1):o=Et.shiftTime(o,0,s,0)}},{key:"_renderWeekScale",value:function(){var e,t,n,r=!0,o=new Date(this.viewRange.from.valueOf()),i=this.displayModeOptions[this.displayMode],s=i.interval,a=i.labelPeriod,l=i.firstHourOfDay,u=i.lastHourOfDay;for(s=Math.min(s,60*(u-l+1));o<this.viewRange.to;)e=!1,o.getHours()<l&&o.setHours(l),(o.getHours()===l&&0===o.getMinutes()||r)&&(t=0===o.getMonth()||r?this.$timelineLarge.appendDiv("scale-item",this._dateFormat(o,"d. MMMM yyyy")).data("count",0):1===o.getDate()?this.$timelineLarge.appendDiv("scale-item",this._dateFormat(o,"d. MMMM")).data("count",0):this.$timelineLarge.appendDiv("scale-item",this._dateFormat(o,"d.")).data("count",0),e=!0),n=this.$timelineSmall.appendDiv("scale-item",this._dateFormat(o,"HH:mm")).data("date-from",new Date(o.valueOf())),(60*(o.getHours()-l)+o.getMinutes())%(s*a)!=0&&n.addClass("label-invisible"),o=Et.shiftTime(o,0,s,0,0),this._incrementTimelineScaleItems(t,n,o,e),r=!1,o.getHours()>u&&(o.setHours(0),o.setMinutes(0),o.setDate(o.getDate()+1))}},{key:"_renderMonthScale",value:function(){for(var e,t,n,r=!0,o=new Date(this.viewRange.from.valueOf()),i=this.displayModeOptions[this.displayMode].labelPeriod;o<this.viewRange.to;)e=!1,(1===o.getDate()||r)&&(t=0===o.getMonth()||r?this.$timelineLarge.appendDiv("scale-item",this._dateFormat(o,"MMMM yyyy")).data("count",0):this.$timelineLarge.appendDiv("scale-item",this._dateFormat(o,"MMMM")).data("count",0),e=!0),n=this.$timelineSmall.appendDiv("scale-item",this._dateFormat(o,"dd")).data("date-from",new Date(o.valueOf())),o.getDate()%i!=0&&n.addClass("label-invisible"),o=Et.shift(o,0,0,1),this._incrementTimelineScaleItems(t,n,o,e),r=!1}},{key:"_renderCalendarWeekScale",value:function(){for(var e,t,n,r=!0,o=new Date(this.viewRange.from.valueOf()),i=this.displayModeOptions[this.displayMode].labelPeriod;o<this.viewRange.to;)e=!1,(o.getDate()<8||!0===r)&&(0===o.getMonth()||!0===r?o.getDate()>11?(t=this.$timelineLarge.appendDiv("scale-item").html("&nbsp;").data("count",0),r=2):(t=this.$timelineLarge.appendDiv("scale-item",this._dateFormat(o,"MMMM yyyy")).data("count",0),r=!1):2===r?(t=this.$timelineLarge.appendDiv("scale-item",this._dateFormat(o,"MMMM yyyy")).data("count",0),r=!1):t=this.$timelineLarge.appendDiv("scale-item",this._dateFormat(o,"MMMM")).data("count",0),e=!0),n=this.$timelineSmall.appendDiv("scale-item",Et.weekInYear(o)).data("date-from",new Date(o.valueOf())).data("tooltipText",this._scaleTooltipText.bind(this)),this._tooltipSupport.install(n),Et.weekInYear(o)%i!=0&&n.addClass("label-invisible"),o.setDate(o.getDate()+7),this._incrementTimelineScaleItems(t,n,o,e)}},{key:"_renderYearScale",value:function(){for(var e,t,n,r=!0,o=new Date(this.viewRange.from.valueOf()),i=this.displayModeOptions[this.displayMode].labelPeriod;o<this.viewRange.to;)e=!1,(0===o.getMonth()||r)&&(t=this.$timelineLarge.appendDiv("scale-item",this._dateFormat(o,"yyyy")).data("count",0),e=!0),n=this.$timelineSmall.appendDiv("scale-item",this._dateFormat(o,"MMMM")).data("date-from",new Date(o.valueOf())),o.getMonth()%i!=0&&n.addClass("label-invisible"),o=Et.shift(o,0,1,0),this._incrementTimelineScaleItems(t,n,o,e),r=!1}},{key:"_incrementTimelineScaleItems",value:function(e,t,n,r){e.data("count",e.data("count")+1),t.data("date-to",new Date(n.valueOf())).data("first",r)}},{key:"_scaleTooltipText",value:function(e){var t=" "+this.session.text("ui.to")+" ",n=new Date(e.data("date-from").valueOf()),r=new Date(e.data("date-to").valueOf()-1);return n.getMonth()===r.getMonth()?this._dateFormat(n,"d.")+t+this._dateFormat(r,"d. MMMM yyyy"):n.getFullYear()===r.getFullYear()?this._dateFormat(n,"d. MMMM")+t+this._dateFormat(r,"d. MMMM yyyy"):this._dateFormat(n,"d. MMMM yyyy")+t+this._dateFormat(r,"d. MMMM yyyy")}},{key:"_removeAllResources",value:function(){this.resources.forEach((function(e){e.$resource.remove()}))}},{key:"_renderResources",value:function(e){var t,n,r=this,o="";for(e=e||this.resources,t=0;t<e.length;t++)n=e[t],o+=this._buildResourceHtml(n,this.$grid);s()(o).appendTo(this.$grid),this.$grid.children(".planner-resource").each((function(e,t){var o=s()(t);n=r._resourceById(o.attr("data-id")),r._linkResource(o,n),r._linkActivitiesForResource(n)}))}},{key:"_linkResource",value:function(e,t){e.data("resource",t),t.$resource=e,t.$cells=e.children(".resource-cells")}},{key:"_linkActivity",value:function(e,t){e.data("activity",t),t.$activity=e}},{key:"_rerenderActivities",value:function(e){(e=e||this.resources).forEach((function(e){this._removeActivitiesForResource(e),this._renderActivititesForResource(e)}),this)}},{key:"_buildResourceHtml",value:function(e){var t='<div class="planner-resource" data-id="'+e.id+'">';return t+='<div class="resource-title">'+Wn.encode(e.resourceCell.text||"")+"</div>",t+='<div class="resource-cells">'+this._buildActivitiesHtml(e)+"</div>",t+="</div>"}},{key:"_renderActivititesForResource",value:function(e){e.$cells.html(this._buildActivitiesHtml(e)),this._linkActivitiesForResource(e)}},{key:"_linkActivitiesForResource",value:function(e){var t=this;e.$cells.children(".planner-activity").each((function(e,n){var r=s()(n),o=t._activityById(r.attr("data-id"));t._linkActivity(r,o)}))}},{key:"_buildActivitiesHtml",value:function(e){var t="";return e.activities.forEach((function(e){e.beginTime.valueOf()>=this.endScale||e.endTime.valueOf()<=this.beginScale||(t+=this._buildActivityHtml(e))}),this),t}},{key:"_removeActivitiesForResource",value:function(e){e.activities.forEach((function(e){e.$activity&&(e.$activity.remove(),e.$activity=null)}),this)}},{key:"_buildActivityHtml",value:function(e){var t=100-Math.min(100*e.level,100),n=To.modelToCssColor(e.backgroundColor),r=To.modelToCssColor(e.foregroundColor),o=To.modelToCssColor(e.levelColor),i=e.beginTime.valueOf(),s=e.endTime.valueOf();i=Math.max(i,this.beginScale),s=Math.min(s,this.endScale);var a="planner-activity"+(e.cssClass?" "+e.cssClass:""),l="left: calc("+this.transformLeft(i)+"% + 2px);";l+=" width: calc("+this.transformWidth(i,s)+"% - 4px);",o&&(l+=" background-color: "+o+";",l+=" border-color: "+o+";"),!o&&n&&(l+=" background-color: "+n+";",l+=" border-color: "+n+";"),r&&(l+=" color: "+r+";");var u="planner-activity-level"+(e.cssClass?" "+e.cssClass:""),c=To.get(u,"background-color").backgroundColor,f="<div";return f+=' class="'+a+'"',f+=' style="'+(l+=" background-image: linear-gradient(to bottom, "+c+" 0%, "+c+" "+t+"%, transparent "+t+"%, transparent 100% );")+'"',f+=' data-id="'+e.id+'"',f+=">"+Wn.encode(e.text||"")+"</div>"}},{key:"_onCellMouseDown",value:function(e){var t,n,r=s()(e.target),o=i.SelectionMode,a=3===e.which||1===e.which&&e.ctrlKey;this.activitySelectable?(!a&&this.$selector&&this.$selector.hide(),t=this.$grid.elementFromPoint(e.pageX,e.pageY),!a&&this.$selector&&this.$selector.show(),t.hasClass("planner-activity")?(n=t.parent().parent(),this.selectResources([n.data("resource")]),this.selectActivity(t.data("activity")),this.selectRange(new US)):this.selectActivity(null)):this.selectActivity(null),this.selectionMode!==o.NONE&&(r.hasClass("selector")&&a||(this.selectedActivity||this._startRangeSelection(e.pageX,e.pageY),this._cellMousemoveHandler=this._onCellMousemove.bind(this,e),r.document().on("mousemove",this._cellMousemoveHandler).one("mouseup",this._onDocumentMouseUp.bind(this))))}},{key:"_startRangeSelection",value:function(e,t){this.startRow=this._findRow(t),this.lastRow=this.startRow,this.startRange=this._findScale(e),this.lastRange=this.startRange,this._select(!0),this._rangeSelectionStarted=!0}},{key:"_prepareRangeSelectionByMousemove",value:function(e,t){var n=e.pageX-t.pageX,r=e.pageY-t.pageY,o=i.RANGE_SELECTION_MOVE_THRESHOLD;if(Math.abs(n)>=o)return!0;var s=this._findRow(e.pageY),a=this._findRow(t.pageY);return Math.abs(r)>=o&&this.selectionMode===i.SelectionMode.MULTI_RANGE&&s!==a}},{key:"_onCellMousemove",value:function(e,t){if(this.selectedActivity&&!this._rangeSelectionStarted){if(!this._prepareRangeSelectionByMousemove(e,t))return;this._startRangeSelection(e.pageX,e.pageY)}var n=this._findRow(t.pageY);n&&(this.lastRow=n);var r=this._findScale(t.pageX);r&&(this.lastRange=r),this._select(!0)}},{key:"_onResizeMouseDown",value:function(e){var t,n=s()(e.target);return this.startRow=this.selectedResources[0],this.lastRow=this.selectedResources[this.selectedResources.length-1],this.startRange=O.nvl(this._findScaleByFromDate(this.selectionRange.from),new Fr(this.selectionRange.from.getTime(),this.selectionRange.from.getTime())),this.lastRange=O.nvl(this._findScaleByToDate(this.selectionRange.to),new Fr(this.selectionRange.to.getTime(),this.selectionRange.to.getTime())),n.hasClass("selector-resize-left")&&(t=this.startRange,this.startRange=this.lastRange,this.lastRange=t),n.body().addClass("col-resize"),this._resizeMousemoveHandler=this._onResizeMousemove.bind(this),n.document().on("mousemove",this._resizeMousemoveHandler).one("mouseup",this._onDocumentMouseUp.bind(this)),!1}},{key:"_onResizeMousemove",value:function(e){if(this.rendered){var t=this._findScale(e.pageX);t&&(this.lastRange=t),this._select(!0)}}},{key:"_onDocumentMouseUp",value:function(e){var t=s()(e.target);t.body().removeClass("col-resize"),this._cellMousemoveHandler&&(t.document().off("mousemove",this._documentMousemoveHandler),this._cellMousemoveHandler=null),this._resizeMousemoveHandler&&(t.document().off("mousemove",this._resizeMousemoveHandler),this._resizeMousemoveHandler=null),this._rangeSelectionStarted&&(this._rangeSelectionStarted=!1,this.rendered&&this._select())}},{key:"_select",value:function(e){if(this.startRow&&this.lastRow){var t=!(!this.startRange||!this.lastRange),n=this.startRow.$resource,r=this.lastRow.$resource;this.selectionMode===i.SelectionMode.SINGLE_RANGE&&(this.lastRow=this.startRow,r=this.startRow.$resource);for(var o=n[0].offsetTop<=r[0].offsetTop?n:r,a=n[0].offsetTop>r[0].offsetTop?n:r,l=s()(".planner-resource",this.$grid).toArray(),u=o[0].offsetTop,c=a[0].offsetTop,f=l.length-1;f>=0;f--){var h=l[f];(h.offsetTop<u&&h.offsetTop<c||h.offsetTop>u&&h.offsetTop>c)&&l.splice(f,1)}if(this.selectResources(l.map((function(e){return s()(e).data("resource")})),!e),this.selectActivity(null),t){var p=Math.min(this.lastRange.from,this.startRange.from),d=Math.max(this.lastRange.to,this.startRange.to),y=new US(new Date(p),new Date(d));y=this._adjustSelectionRange(y),this.selectRange(y,!e)}}}},{key:"_adjustSelectionRange",value:function(e){var t=e.from.getTime(),n=e.to.getTime(),r=0,o=this.displayModeOptions[this.displayMode];o.interval>0&&o.minSelectionIntervalCount>0&&(r=o.minSelectionIntervalCount*o.interval*6e4);var i=o.lastHourOfDay,s=Et.shiftTime(Et.trunc(e.from),i+1),a=this._visibleViewRange();return this.lastRange.from<this.startRange.from?n-r>=a.from.getTime()?t=Math.min(t,n-r):(t=a.from.getTime(),n=Math.max(n,Math.min(t+r,a.to.getTime()))):t+r<=a.to.getTime()?(n=Math.max(n,Math.max(t+r,a.from.getTime())))>=s.getTime()&&new Fr(t,n).size()===r&&(n=s.getTime(),t=Math.min(t,n-r)):(n=a.to.getTime(),t=Math.min(t,n-r)),new US(new Date(t),new Date(n))}},{key:"_findRow",value:function(e){var t,n=qs.offsetBounds(this.$grid),r=n.x+10;return e=Math.min(Math.max(e,0),n.y+n.height-1),(t=this.$container.elementFromPoint(r,e,".planner-resource")).length>0?t.data("resource"):null}},{key:"_findScale",value:function(e){var t,n=qs.offsetBounds(this.$grid),r=this.$scale.offset().top+.75*this.$scale.height();return e=Math.min(Math.max(e,0),n.x+n.width-1),(t=this.$container.elementFromPoint(e,r,".scale-item")).length>0?new US(t.data("date-from").valueOf(),t.data("date-to").valueOf()):null}},{key:"_findScaleByFromDate",value:function(e){return this._findScaleByFunction((function(t,n){if(s()(n).data("date-from").getTime()===e.getTime())return!0}))}},{key:"_findScaleByToDate",value:function(e){return this._findScaleByFunction((function(t,n){if(s()(n).data("date-to").getTime()===e.getTime())return!0}))}},{key:"_findScaleByFunction",value:function(e){var t=this.$timelineSmall.children(".scale-item").filter(e);return t.length?new US(t.data("date-from").valueOf(),t.data("date-to").valueOf()):null}},{key:"_visibleViewRange",value:function(){var e=this.$timelineSmall.children(".scale-item");return new Fr(e.first().data("date-from"),e.last().data("date-to"))}},{key:"_dateFormat",value:function(e,t){var n=new Date(e.valueOf());return new tp(this.session.locale,t).format(n)}},{key:"_renderViewRange",value:function(){this._renderRange(),this._renderScale(),this.invalidateLayoutTree()}},{key:"_renderHeaderVisible",value:function(){this._header.setVisible(this.headerVisible),this.invalidateLayoutTree()}},{key:"_renderYearPanelVisible",value:function(e){var t;this.yearPanelVisible&&this._yearPanel.renderContent(),s()(".calendar-toggle-year",this.$modes).select(this.yearPanelVisible),t=this.yearPanelVisible?210:0,this._yearPanel.$container.animate({width:t},{duration:e?500:0,progress:this._onYearPanelWidthChange.bind(this),complete:this._afterYearPanelWidthChange.bind(this)})}},{key:"_onYearPanelWidthChange",value:function(){if(this._yearPanel.$container){var e=this._yearPanel.$container.outerWidth();this.$grid.css("width","calc(100% - "+e+"px)"),this.$scale.css("width","calc(100% - "+e+"px)"),this.revalidateLayout()}}},{key:"_afterYearPanelWidthChange",value:function(){this.yearPanelVisible||this._yearPanel.removeContent()}},{key:"_setMenus",value:function(e){this.updateKeyStrokes(e,this.menus),this._setProperty("menus",e),this._updateMenuBar()}},{key:"_updateMenuBar",value:function(){var e=this._filterMenus(["Planner.EmptySpace","Planner.Resource","Planner.Activity","Planner.Range"],!1,!0);this.menuBar.setMenuItems(e)}},{key:"_removeMenus",value:function(){}},{key:"_filterMenus",value:function(e,t,n){return(e=e||[]).indexOf("Planner.Resource")>-1&&0===this.selectedResources.length&&rt.remove(e,"Planner.Resource"),e.indexOf("Planner.Activity")>-1&&!this.selectedActivity&&rt.remove(e,"Planner.Activity"),e.indexOf("Planner.Range")>-1&&!this.selectionRange.from&&!this.selectionRange.to&&rt.remove(e,"Planner.Range"),zm.filter(this.menus,e,t,n)}},{key:"setDisplayModeOptions",value:function(e){this.setProperty("displayModeOptions",e)}},{key:"_setDisplayModeOptions",value:function(e){e&&this._adjustHours(e),this.displayModeOptions=e}},{key:"_adjustHours",value:function(e){function t(e){return e<0?0:e>23?23:e}Pr.values(e).forEach((function(e){e.firstHourOfDay&&(e.firstHourOfDay=t(e.firstHourOfDay)),e.lastHourOfDay&&(e.lastHourOfDay=t(e.lastHourOfDay))}))}},{key:"_renderDisplayModeOptions",value:function(){this._renderRange(),this._renderScale(),this._rerenderActivities(),this._select(),this.invalidateLayoutTree()}},{key:"_renderAvailableDisplayModes",value:function(){}},{key:"_renderDisplayMode",value:function(){}},{key:"_setViewRange",value:function(e){e=US.ensure(e),this._setProperty("viewRange",e),this._yearPanel.setViewRange(this.viewRange),this._yearPanel.selectDate(this.viewRange.from)}},{key:"_setDisplayMode",value:function(e){this._setProperty("displayMode",e),this._yearPanel.setDisplayMode(this.displayMode),this._header.setDisplayMode(this.displayMode)}},{key:"_setAvailableDisplayModes",value:function(e){this._setProperty("availableDisplayModes",e),this._header.setAvailableDisplayModes(this.availableDisplayModes)}},{key:"_setSelectionRange",value:function(e){e=US.ensure(e),this._setProperty("selectionRange",e),this.session.onRequestsDone(this._updateMenuBar.bind(this))}},{key:"_setSelectedResources",value:function(e){"string"==typeof e[0]&&(e=this._resourcesByIds(e)),this.rendered&&this._removeSelectedResources(),this._setProperty("selectedResources",e),this.session.onRequestsDone(this._updateMenuBar.bind(this))}},{key:"_removeSelectedResources",value:function(){this.selectedResources.forEach((function(e){e.$resource.select(!1)}))}},{key:"_renderSelectedResources",value:function(){this.selectedResources.forEach((function(e){e.$resource.select(!0)}))}},{key:"_renderActivitySelectable",value:function(){this.selectedActivity&&this.selectedActivity.$activity&&this.selectedActivity.$activity.toggleClass("selected",this.activitySelectable)}},{key:"_renderSelectionMode",value:function(){this.selectionMode===i.SelectionMode.NONE?this.$selector&&(this.$selector.remove(),this.$highlight.remove()):this._renderSelectionRange()}},{key:"_renderSelectionRange",value:function(){var e,t,n=this.selectionRange.from,r=this.selectionRange.to,o=this.selectedResources[0],i=this.selectedResources[this.selectedResources.length-1];if(this.$selector&&(this.$selector.remove(),this.$highlight.remove()),o&&i&&this.selectionRange.from&&this.selectionRange.to){e=o.$resource,t=i.$resource,n=Math.max(n,this.beginScale),r=Math.min(r,this.endScale);var s=e[0].offsetTop<=t[0].offsetTop?e:t;this.$selector=s.children(".resource-cells").appendDiv("selector"),this.$selector.cssHeight(e.outerHeight()+Math.abs(t[0].offsetTop-e[0].offsetTop));var a=this.$selector.appendDiv("selector-resize-left").mousedown(this._onResizeMouseDown.bind(this)),l=this.$selector.appendDiv("selector-resize-right").mousedown(this._onResizeMouseDown.bind(this));this.$selector.css("left","calc("+this.transformLeft(n)+"% - "+a.cssWidth()+"px)").css("width","calc("+this.transformWidth(n,r)+"% + "+(a.cssWidth()+l.cssWidth())+"px)").on("contextmenu",this._onRangeSelectorContextMenu.bind(this)),this.$highlight=this.$timelineSmall.prependDiv("highlight");var u=this.$selector.cssLeft()+a.cssWidth()+this.$scaleTitle.cssWidth(),c=this.$selector.cssWidth()-(a.cssWidth()+l.cssWidth());this.$highlight.cssLeft(u).cssWidth(c)}}},{key:"_setSelectedActivity",value:function(e){"string"==typeof e&&(e=this._activityById(e)),this.rendered&&this._removeSelectedActivity(),this._setProperty("selectedActivity",e),this.session.onRequestsDone(this._updateMenuBar.bind(this))}},{key:"_removeSelectedActivity",value:function(){this.selectedActivity&&this.selectedActivity.$activity&&this.selectedActivity.$activity.removeClass("selected")}},{key:"_renderSelectedActivity",value:function(){this.selectedActivity&&this.selectedActivity.$activity&&this.selectedActivity.$activity.addClass("selected")}},{key:"_renderLabel",value:function(){var e=this.label||"";this.$scaleTitle&&this.$scaleTitle.text(e)}},{key:"_resourcesByIds",value:function(e){return e.map(this._resourceById.bind(this))}},{key:"_activityById",value:function(e){return this.activityMap[e]}},{key:"_resourceById",value:function(e){return this.resourceMap[e]}},{key:"setDisplayMode",value:function(e){this.setProperty("displayMode",e),this.startRange=null,this.lastRange=null}},{key:"layoutYearPanel",value:function(){this.yearPanelVisible&&(Lh.update(this._yearPanel.$yearList),this._yearPanel._scrollYear())}},{key:"setYearPanelVisible",value:function(e){this.yearPanelVisible!==e&&(this._setProperty("yearPanelVisible",e),this.rendered&&this._renderYearPanelVisible(!0))}},{key:"setViewRangeFrom",value:function(e){var t=Et.compareDays(this.viewRange.to,this.viewRange.from),n=new US(this.viewRange.from,this.viewRange.to);n.from=e,n.to=Et.shift(e,0,0,t),this.setViewRange(n)}},{key:"setViewRange",value:function(e){this.viewRange!==e&&(this._setViewRange(e),this.rendered&&(this._renderViewRange(),this._rerenderActivities(),this._renderSelectedActivity(),this.validateLayoutTree()))}},{key:"selectRange",value:function(e){e&&e.equals(this.selectionRange)||this.setProperty("selectionRange",e)}},{key:"selectActivity",value:function(e){this.setProperty("selectedActivity",e)}},{key:"selectResources",value:function(e){rt.equals(e,this.selectedResources)||(e=(e=rt.ensure(e)).slice(),this.setProperty("selectedResources",e),this.trigger("resourcesSelected",{resources:e}),this.rendered&&this._renderSelectionRange())}},{key:"deselectResources",value:function(e){var t=!1;e=rt.ensure(e);var n=this.selectedResources.slice();return rt.removeAll(n,e)&&(this.selectResources(n),t=!0),t}},{key:"insertResources",value:function(e){var t=this;e.forEach((function(e){t._initResource(e),t.resources.push(e)})),this.rendered&&(this._renderResources(e),this.invalidateLayoutTree())}},{key:"deleteResources",value:function(e){var t=this;this.deselectResources(e)&&this.selectRange(new US),e.forEach((function(e){rt.remove(t.resources,e),delete t.resourceMap[e.id],e.activities.forEach((function(e){delete t.activityMap[e.id]})),t.rendered&&(e.$resource.remove(),delete e.$resource)})),this.invalidateLayoutTree()}},{key:"deleteAllResources",value:function(){this.rendered&&(this._removeAllResources(),this.invalidateLayoutTree()),this.resources=[],this.resourceMap={},this.activityMap={},this.selectResources([]),this.selectRange(new US)}},{key:"updateResources",value:function(e){var t=this;e.forEach((function(e){var n=t.resourceMap[e.id];if(!n)throw new Error("Update event received for non existing resource. ResourceId: "+e.id);if(t._initResource(e),rt.replace(t.resources,n,e),rt.replace(t.selectedResources,n,e),t.rendered&&n.$resource){var r=s()(t._buildResourceHtml(e));n.$resource.replaceWith(r),r.css("min-width",n.$resource.css("min-width")),t._linkResource(r,e),t._linkActivitiesForResource(e)}}))}}])&&oO(t.prototype,n),r&&oO(t,r),i}(ve);function hO(e){return(hO="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function pO(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function dO(e,t,n){return(dO="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=mO(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function yO(e,t){return(yO=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function vO(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=mO(e);if(t){var o=mO(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return bO(this,n)}}function bO(e,t){return!t||"object"!==hO(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function mO(e){return(mO=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}cO(fO,"Direction",{BACKWARD:-1,FORWARD:1}),cO(fO,"DisplayMode",{DAY:1,WEEK:2,MONTH:3,WORK_WEEK:4,CALENDAR_WEEK:5,YEAR:6}),cO(fO,"SelectionMode",{NONE:0,SINGLE_RANGE:1,MULTI_RANGE:2}),cO(fO,"RANGE_SELECTION_MOVE_THRESHOLD",10);var gO=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&yO(e,t)}(i,e);var t,n,r,o=vO(i);function i(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(e=o.call(this))._addRemoteProperties(["displayMode","viewRange","selectionRange","selectedActivity"]),e}return t=i,(n=[{key:"_orderPropertyNamesOnSync",value:function(e){return Object.keys(e).sort(this._createPropertySortFunc(i.PROPERTIES_ORDER))}},{key:"_sendViewRange",value:function(e){this._send("property",{viewRange:Et.toJsonDateRange(e)})}},{key:"_sendSelectedActivity",value:function(){var e=null;this.widget.selectedActivity&&(e=this.widget.selectedActivity.id),this._send("property",{selectedActivity:e})}},{key:"_sendSelectionRange",value:function(){var e=Et.toJsonDateRange(this.widget.selectionRange);this._send("property",{selectionRange:e})}},{key:"_onWidgetResourcesSelected",value:function(e){this._sendResourcesSelected()}},{key:"_sendResourcesSelected",value:function(){var e=this.widget.selectedResources.map((function(e){return e.id}));this._send("resourcesSelected",{resourceIds:e})}},{key:"_onWidgetEvent",value:function(e){"resourcesSelected"===e.type?this._onWidgetResourcesSelected(e):dO(mO(i.prototype),"_onWidgetEvent",this).call(this,e)}},{key:"_onResourcesInserted",value:function(e){this.widget.insertResources(e)}},{key:"_onResourcesDeleted",value:function(e){var t=this.widget._resourcesByIds(e);this.addFilterForWidgetEventType("resourcesSelected"),this.addFilterForProperties({selectionRange:new US}),this.widget.deleteResources(t)}},{key:"_onAllResourcesDeleted",value:function(){this.addFilterForWidgetEventType("resourcesSelected"),this.addFilterForProperties({selectionRange:new US}),this.widget.deleteAllResources()}},{key:"_onResourcesSelected",value:function(e){var t=this.widget._resourcesByIds(e);this.addFilterForWidgetEventType("resourcesSelected"),this.widget.selectResources(t,!1)}},{key:"_onResourcesUpdated",value:function(e){this.widget.updateResources(e)}},{key:"onModelAction",value:function(e){"resourcesInserted"===e.type?this._onResourcesInserted(e.resources):"resourcesDeleted"===e.type?this._onResourcesDeleted(e.resourceIds):"allResourcesDeleted"===e.type?this._onAllResourcesDeleted():"resourcesSelected"===e.type?this._onResourcesSelected(e.resourceIds):"resourcesUpdated"===e.type?this._onResourcesUpdated(e.resources):dO(mO(i.prototype),"onModelAction",this).call(this,e)}}])&&pO(t.prototype,n),r&&pO(t,r),i}(de);function _O(e){return(_O="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function wO(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function kO(e,t){return(kO=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function SO(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=TO(e);if(t){var o=TO(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return OO(this,n)}}function OO(e,t){return!t||"object"!==_O(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function TO(e){return(TO=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}!function(e,t,n){t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}(gO,"PROPERTIES_ORDER",["displayMode","viewRange"]);var CO=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&kO(e,t)}(i,e);var t,n,r,o=SO(i);function i(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(e=o.call(this)).availableDisplayModes=[],e}return t=i,(n=[{key:"_render",value:function(){this.$container=this.$parent.appendDiv("planner-header"),this.$range=this.$container.appendDiv("planner-range"),this.$range.appendDiv("planner-previous").on("click",this._onPreviousClick.bind(this)),this.$range.appendDiv("planner-today",this.session.text("ui.CalendarToday")).on("click",this._onTodayClick.bind(this)),this.$range.appendDiv("planner-next").on("click",this._onNextClick.bind(this)),this.$range.appendDiv("planner-select"),this.$commands=this.$container.appendDiv("planner-commands"),this._renderAvailableDisplayModes(),this._renderDisplayMode()}},{key:"setAvailableDisplayModes",value:function(e){this.setProperty("availableDisplayModes",e)}},{key:"_renderAvailableDisplayModes",value:function(){var e=fO.DisplayMode;this.$commands.empty(),this.availableDisplayModes.length>1&&(this.availableDisplayModes.indexOf(e.DAY)>-1&&this.$commands.appendDiv("planner-mode",this.session.text("ui.CalendarDay")).attr("data-mode",e.DAY).on("click",this._onDisplayModeClick.bind(this)),this.availableDisplayModes.indexOf(e.WORK_WEEK)>-1&&this.$commands.appendDiv("planner-mode",this.session.text("ui.CalendarWorkWeek")).attr("data-mode",e.WORK_WEEK).on("click",this._onDisplayModeClick.bind(this)),this.availableDisplayModes.indexOf(e.WEEK)>-1&&this.$commands.appendDiv("planner-mode",this.session.text("ui.CalendarWeek")).attr("data-mode",e.WEEK).on("click",this._onDisplayModeClick.bind(this)),this.availableDisplayModes.indexOf(e.MONTH)>-1&&this.$commands.appendDiv("planner-mode",this.session.text("ui.CalendarMonth")).attr("data-mode",e.MONTH).on("click",this._onDisplayModeClick.bind(this)),this.availableDisplayModes.indexOf(e.CALENDAR_WEEK)>-1&&this.$commands.appendDiv("planner-mode",this.session.text("ui.CalendarCalendarWeek")).attr("data-mode",e.CALENDAR_WEEK).on("click",this._onDisplayModeClick.bind(this)),this.availableDisplayModes.indexOf(e.YEAR)>-1&&this.$commands.appendDiv("planner-mode",this.session.text("ui.CalendarYear")).attr("data-mode",e.YEAR).on("click",this._onDisplayModeClick.bind(this)));var t=this.$commands.children(".planner-mode");t.first().addClass("first"),t.last().addClass("last"),1===t.length&&(t.first().addClass("disabled"),t.off("click")),this.$commands.appendDiv("planner-toggle-year").on("click",this._onYearClick.bind(this))}},{key:"setDisplayMode",value:function(e){this.setProperty("displayMode",e)}},{key:"_renderDisplayMode",value:function(){s()(".planner-mode",this.$commands).select(!1),s()('[data-mode="'+this.displayMode+'"]',this.$commands).select(!0)}},{key:"_onTodayClick",value:function(e){this.trigger("todayClick")}},{key:"_onNextClick",value:function(e){this.trigger("nextClick")}},{key:"_onPreviousClick",value:function(e){this.trigger("previousClick")}},{key:"_onYearClick",value:function(e){this.trigger("yearClick")}},{key:"_onDisplayModeClick",value:function(e){var t=s()(e.target).data("mode");this.setDisplayMode(t),this.trigger("displayModeClick",{displayMode:this.displayMode})}}])&&wO(t.prototype,n),r&&wO(t,r),i}(ve);function PO(e){return(PO="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function RO(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function xO(e,t){return(xO=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function EO(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=AO(e);if(t){var o=AO(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return DO(this,n)}}function DO(e,t){return!t||"object"!==PO(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function AO(e){return(AO=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var FO=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&xO(e,t)}(i,e);var t,n,r,o=EO(i);function i(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(t=o.call(this)).planner=e,t}return t=i,(n=[{key:"layout",value:function(e){var t,n=this.planner._header.$container,r=this.planner.$scale,o=this.planner.$grid,i=this.planner.menuBar,s=this.planner._yearPanel.$container,a=0,l=0,u=0,c=0,f=0,h=ea.get(i.$container),p=this.planner.htmlComp,d=p.availableSize().subtract(p.insets());i.$container.isVisible()&&(t=ok.size(h,d),h.setSize(t),a=t.height,"top"===i.position&&(f+=a)),n.isVisible()&&(f+=qs.size(n).height),r.css("top",f),c+=f+qs.size(r).height,o.css("top",c),u=f+s.cssMarginY(),l=c+o.cssMarginY(),i.$container.isVisible()&&"bottom"===i.position&&(u+=a,l+=a),s.css("height","calc(100% - "+u+"px)"),o.css("height","calc(100% - "+l+"px)"),this._updateMinWidth(),this._layoutScaleLines(),Lh.update(this.planner.$grid,!0),this.planner.layoutYearPanel()}},{key:"_updateMinWidth",value:function(){var e=this._minWidth(),t=this.planner.$scaleTitle,n=this.planner.$timeline;n&&(n.css("min-width",e),e+=t.outerWidth(!0),this.planner.resources.forEach((function(t){t.$resource.css("min-width",e)})))}},{key:"_layoutScaleLines",value:function(){var e,t,n,r,o=this.planner.$timelineSmall,i=this.planner.$timelineLarge;o&&(t=o.children(".scale-item"),(n=i.children(".scale-item")).each((function(){s()(this).data("scale-item-line").cssHeight(0)})),t.each((function(){var e=s()(this).data("scale-item-line");e&&e.cssHeight(0)})),Lh.reset(this.planner.$grid),e=this.planner.$grid[0].scrollHeight,r=this.planner.$scale[0].scrollLeft,n.each((function(){var t=s()(this);t.data("scale-item-line").cssLeft(r+t.position().left).cssHeight(e)})),t.each((function(){var t=s()(this),n=t.data("scale-item-line");n&&n.cssLeft(r+t.position().left).cssHeight(e)})))}},{key:"_minWidth",value:function(){var e=this.planner.$timelineLarge.children(".scale-item"),t=this.planner.$timelineSmall.children(".scale-item"),n=e.length,r=t.length,o=fO.DisplayMode,i=r*qs.insets(t,{includeBorder:!1}).horizontal();return this.planner.displayMode===o.DAY?Math.max(i,52*n):O.isOneOf(this.planner.displayMode,o.WORK_WEEK,o.WEEK)?Math.max(i,160*n):this.planner.displayMode===o.MONTH||this.planner.displayMode===o.CALENDAR_WEEK?Math.max(i,23*r):this.planner.displayMode===o.YEAR?Math.max(i,90*r):void 0}}])&&RO(t.prototype,n),r&&RO(t,r),i}(Zs);function $O(e){return($O="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function jO(e,t){return(jO=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function BO(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=IO(e);if(t){var o=IO(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return MO(this,n)}}function MO(e,t){return!t||"object"!==$O(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function IO(e){return(IO=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var LO=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&jO(e,t)}(n,e);var t=BO(n);function n(e,r){var o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),(o=t.call(this,e,r)).selectionTypes=["Resource","Activity","Range"],o}return n}(Ag);function HO(e){return(HO="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function NO(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function VO(e,t,n){return(VO="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=UO(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function WO(e,t){return(WO=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function zO(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=UO(e);if(t){var o=UO(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return GO(this,n)}}function GO(e,t){return!t||"object"!==HO(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function UO(e){return(UO=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var KO=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&WO(e,t)}(i,e);var t,n,r,o=zO(i);function i(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(e=o.call(this)).displayParent=null,e.files=[],e._glassPaneRenderer=null,e.maximumUploadSize=fT.DEFAULT_MAXIMUM_UPLOAD_SIZE,e}return t=i,(n=[{key:"_init",value:function(e){VO(UO(i.prototype),"_init",this).call(this,e),this._setDisplayParent(this.displayParent),this._glassPaneRenderer=new ih(this),this.fileInput=O.create("FileInput",{parent:this,acceptTypes:this.acceptTypes,maximumUploadSize:this.maximumUploadSize,multiSelect:this.multiSelect,visible:!Kt.get().supportsFile()}),this.fileInput.on("change",this._onFileChange.bind(this))}},{key:"_createKeyStrokeContext",value:function(){return new $u}},{key:"_initKeyStrokeContext",value:function(){var e=this;VO(UO(i.prototype),"_initKeyStrokeContext",this).call(this),this.keyStrokeContext.registerKeyStroke([new _c(this.session,this),new pc(this,[Ou.SPACE,Ou.ENTER]),new Pc(this,(function(){return e.$cancelButton}))])}},{key:"_render",value:function(){var e=this;this.$container=this.$parent.appendDiv("file-chooser").on("mousedown",this._onMouseDown.bind(this));var t=this.$container.appendDiv("drag-handle");this.$container.draggable(t),this.$container.appendDiv("closable").on("click",(function(){e.cancel()})),this.$content=this.$container.appendDiv("file-chooser-content"),this.$title=this.$content.appendDiv("file-chooser-title").text(this.session.text(this.multiSelect?"ui.ChooseFiles":"ui.ChooseFile")),this.fileInput.render(this.$content),this.fileInput.legacy||(this.$content.appendDiv("file-chooser-label").text(this.session.text("ui.FileChooserHint")),this.$files=this.$content.appendElement("<ul>","file-chooser-files"),this._installScrollbars()),this.$buttons=this.$container.appendDiv("file-chooser-buttons");var n=new yf(this.$buttons);this.fileInput.legacy||(this.$addFileButton=n.addButton({text:this.session.text("ui.Browse"),onClick:this._onAddFileButtonClicked.bind(this),needsClick:!0})),this.$uploadButton=n.addButton({text:this.session.text("ui.Upload"),onClick:this._onUploadButtonClicked.bind(this),enabled:!1}),this.$cancelButton=n.addButton({text:this.session.text("Cancel"),onClick:this._onCancelButtonClicked.bind(this)}),this.htmlComp=ea.install(this.$container,this.session),this.htmlComp.setLayout(new qC(this)),this.$container.addClassForAnimation("animate-open"),this.$container.addClass("calc-helper");var r=this.$container.windowSize(),o=Math.min(this.$container.width(),r.width-20);this.$container.css("min-width",o),this.$container.css("max-width",o),this.$container.removeClass("calc-helper"),n.updateButtonWidths(this.$container.width()),this._glassPaneRenderer.renderGlassPanes(),this._position()}},{key:"_renderProperties",value:function(){VO(UO(i.prototype),"_renderProperties",this).call(this),this.fileInput.legacy&&this.setFiles([]),this._renderFiles()}},{key:"_renderEnabled",value:function(){VO(UO(i.prototype),"_renderEnabled",this).call(this),this._installOrUninstallDragAndDropHandler()}},{key:"_postRender",value:function(){VO(UO(i.prototype),"_postRender",this).call(this),this._installFocusContext()}},{key:"_remove",value:function(){this._glassPaneRenderer.removeGlassPanes(),this._uninstallDragAndDropHandler(),this._uninstallFocusContext(),VO(UO(i.prototype),"_remove",this).call(this)}},{key:"_installFocusContext",value:function(){this.session.focusManager.installFocusContext(this.$container,Kf.AUTO)}},{key:"_uninstallFocusContext",value:function(){this.session.focusManager.uninstallFocusContext(this.$container)}},{key:"_createDragAndDropHandler",value:function(){var e=this;return rn.handler(this,{supportedScoutTypes:rn.SCOUT_TYPES.FILE_TRANSFER,validateFiles:function(){},onDrop:function(t){return e.addFiles(t.files)},dropType:function(){return rn.SCOUT_TYPES.FILE_TRANSFER},dropMaximumSize:function(){return e.maximumUploadSize}})}},{key:"_installOrUninstallDragAndDropHandler",value:function(){this.enabledComputed?this._installDragAndDropHandler():this._uninstallDragAndDropHandler()}},{key:"_installDragAndDropHandler",value:function(){this.dragAndDropHandler||(this.dragAndDropHandler=this._createDragAndDropHandler(),this.dragAndDropHandler&&this.dragAndDropHandler.install(this.$container))}},{key:"_uninstallDragAndDropHandler",value:function(){this.dragAndDropHandler&&(this.dragAndDropHandler.uninstall(),this.dragAndDropHandler=null)}},{key:"get$Scrollable",value:function(){return this.$files}},{key:"_position",value:function(){this.$container.cssMarginLeft(-this.$container.outerWidth()/2)}},{key:"setDisplayParent",value:function(e){this.setProperty("displayParent",e)}},{key:"_setDisplayParent",value:function(e){this._setProperty("displayParent",e),e&&this.setParent(this.findDesktop().computeParentForDisplayParent(e))}},{key:"setMaximumUploadSize",value:function(e){this.setProperty("maximumUploadSize",e),this.fileInput.setMaximumUploadSize(e)}},{key:"open",value:function(){this.setDisplayParent(this.displayParent||this.session.desktop),this.displayParent.fileChooserController.registerAndRender(this)}},{key:"close",value:function(){this.rendered?this.$cancelButton&&this.session.focusManager.requestFocus(this.$cancelButton)&&this.$cancelButton.click():this.cancel()}},{key:"cancel",value:function(){var e=new sn;this.trigger("cancel",e),e.defaultPrevented||this._close()}},{key:"_close",value:function(){this.displayParent&&this.displayParent.fileChooserController.unregisterAndRemove(this),this.destroy()}},{key:"browse",value:function(){this.fileInput.browse()}},{key:"setAcceptTypes",value:function(e){this.setProperty("acceptTypes",e),this.fileInput.setAcceptTypes(e)}},{key:"setMultiSelect",value:function(e){this.setProperty("multiSelect",e),this.fileInput.setMultiSelect(e)}},{key:"addFiles",value:function(e){e instanceof FileList&&(e=Wt.fileListToArray(e)),0!==(e=rt.ensure(e)).length&&(!this.multiSelect||this.fileInput.legacy?(e=[e[0]],this.setFiles([e[0]])):(e=e.slice(),rt.insertAll(e,this.files,0),this.setFiles(e)))}},{key:"removeFile",value:function(e){var t=this.files.slice();rt.remove(t,e),this.setFiles(t),this.fileInput.clear()}},{key:"setFiles",value:function(e){e instanceof FileList&&(e=Wt.fileListToArray(e)),e=rt.ensure(e);try{this.fileInput.validateMaximumUploadSize(e)}catch(e){return void PU.createOk(this).withHeader(this.session.text("ui.FileSizeLimitTitle")).withBody(e).withSeverity(Br.Severity.ERROR).buildAndOpen()}this.setProperty("files",e)}},{key:"_renderFiles",value:function(){var e=this.files;this.fileInput.legacy||(this.$files.empty(),e.forEach((function(e){var t=this.$files.appendElement("<li>","file",e.name);t.append(" ");var n=t.appendSpan("remove menu-item").on("click",this.removeFile.bind(this,e)),r=t.makeElement("<a>","remove-link",this.session.text("Remove"));n.appendTextNode("("),n.append(r),n.appendTextNode(")")}),this),Lh.update(this.$files)),this.$uploadButton.setEnabled(e.length>0)}},{key:"_onUploadButtonClicked",value:function(e){this.trigger("upload")}},{key:"_onCancelButtonClicked",value:function(e){this.cancel()}},{key:"_onAddFileButtonClicked",value:function(e){this.browse()}},{key:"_onFileChange",value:function(e){this.addFiles(e.files)}},{key:"_onMouseDown",value:function(e,t){var n=this.findParent((function(e){return e instanceof CC&&e.isDialog()}));n&&n.activate()}},{key:"_attach",value:function(){this.$parent.append(this.$container),VO(UO(i.prototype),"_attach",this).call(this)}},{key:"_detach",value:function(){this.$container.detach(),VO(UO(i.prototype),"_detach",this).call(this)}}])&&NO(t.prototype,n),r&&NO(t,r),i}(ve);function qO(e){return(qO="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function YO(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function XO(e,t,n){return(XO="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=eT(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function JO(e,t){return(JO=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function ZO(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=eT(e);if(t){var o=eT(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return QO(this,n)}}function QO(e,t){return!t||"object"!==qO(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function eT(e){return(eT=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var tT=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&JO(e,t)}(i,e);var t,n,r,o=ZO(i);function i(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),o.call(this)}return t=i,(n=[{key:"_onWidgetCancel",value:function(e){e.preventDefault(),this._send("cancel")}},{key:"_onWidgetEvent",value:function(e){"cancel"===e.type?this._onWidgetCancel(e):"upload"===e.type?this._onUpload(e):XO(eT(i.prototype),"_onWidgetEvent",this).call(this,e)}},{key:"_onUpload",value:function(e){var t=this;this.widget.rendered&&this.widget.$uploadButton.setEnabled(!1),0!==this.widget.files.length&&(this.widget.fileInput.legacy?this.widget.fileInput.upload():this.session.uploadFiles(this,this.widget.files,void 0,this.widget.maximumUploadSize),this.session.listen().done((function(){t.widget&&t.widget.rendered&&t.widget.$uploadButton.setEnabled(!0)})))}}])&&YO(t.prototype,n),r&&YO(t,r),i}(de);function nT(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var rT=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.displayParent=t,this.session=n}var t,n,r;return t=e,(n=[{key:"registerAndRender",value:function(e){O.assertProperty(e,"displayParent"),this.displayParent.fileChoosers.push(e),this._render(e)}},{key:"unregisterAndRemove",value:function(e){e&&(rt.remove(this.displayParent.fileChoosers,e),this._remove(e))}},{key:"remove",value:function(){this.displayParent.fileChoosers.forEach(this._remove.bind(this))}},{key:"render",value:function(){var e=this;this.displayParent.fileChoosers.forEach((function(t){t.setDisplayParent(e.displayParent),e._render(t)}))}},{key:"_render",value:function(e){if(e.displayParent||e._setProperty("displayParent",this.displayParent),this.displayParent.acceptView){if(!this.displayParent.acceptView(e))return}else if(!this.acceptView(e))return;var t;e.rendered||(t=this.displayParent instanceof CC&&this.displayParent.isPopupWindow()?this.displayParent.popupWindow.$container:this.session.desktop.$container,e.setTrackFocus(!0),e.render(t),this.displayParent.inFront()||e.detach())}},{key:"_remove",value:function(e){e.remove()}},{key:"attach",value:function(){this.displayParent.fileChoosers.forEach((function(e){e.attach()}),this)}},{key:"detach",value:function(){this.displayParent.fileChoosers.forEach((function(e){e.detach()}),this)}},{key:"acceptView",value:function(e){return this.displayParent.rendered}}])&&nT(t.prototype,n),r&&nT(t,r),e}();function oT(e){return(oT="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function iT(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function sT(e,t,n){return(sT="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=cT(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function aT(e,t){return(aT=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function lT(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=cT(e);if(t){var o=cT(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return uT(this,n)}}function uT(e,t){return!t||"object"!==oT(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function cT(e){return(cT=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var fT=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&aT(e,t)}(i,e);var t,n,r,o=lT(i);function i(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(e=o.call(this)).acceptTypes=null,e.maximumUploadSize=i.DEFAULT_MAXIMUM_UPLOAD_SIZE,e.multiSelect=!1,e.files=[],e.legacyFileUploadUrl=null,e.text=null,e}return t=i,r=[{key:"fileListToArray",value:function(e){return Wt.fileListToArray(e)}}],(n=[{key:"_init",value:function(e){sT(cT(i.prototype),"_init",this).call(this,e),this.uploadController=e.uploadController||e.parent;var t=new xo(e.legacyFileUploadUrl||"upload/"+this.session.uiSessionId+"/"+this.uploadController.id);t.setParameter("legacy",!0),this.legacyFileUploadUrl=t.toString(),this.legacy=!Kt.get().supportsFile()}},{key:"_initKeyStrokeContext",value:function(){this.keyStrokeContext=this._createKeyStrokeContext(),sT(cT(i.prototype),"_initKeyStrokeContext",this).call(this)}},{key:"_createKeyStrokeContext",value:function(){if(this.legacy)return new Vu}},{key:"_render",value:function(){this.$fileInput=this.$parent.makeElement("<input>").attr("type","file").on("change",this._onFileChange.bind(this)),this.legacy?this._renderLegacyMode():(this.$container=this.$parent.appendDiv("file-input input-field"),this.$fileInput.appendTo(this.$container),this.$container.on("mousedown",this._onMouseDown.bind(this)),this.$text=this.$container.appendDiv("file-input-text")),this.legacy&&this.clear()}},{key:"_renderLegacyMode",value:function(){var e=this;this.$legacyFormTarget=this.$fileInput.appendElement("<iframe>").attr("name","legacyFileUpload"+this.uploadController.id).on("load",(function(){try{var t=e.$legacyFormTarget.contents().text();if(Wn.hasText(t)){var n=s.a.parseJSON(t);e.session.responseQueue.process(n)}}finally{e.session.setBusy(!1)}})),this.$fileInput.attr("name","file").addClass("legacy-upload-file-input"),this.$legacyForm=this.$parent.appendElement("<form>","legacy-upload-form").attr("action",this.legacyFileUploadUrl).attr("enctype","multipart/form-data").attr("method","post").attr("target","legacyFileUpload"+this.uploadController.id).append(this.$fileInput),this.$container=this.$legacyForm}},{key:"_renderProperties",value:function(){sT(cT(i.prototype),"_renderProperties",this).call(this),this._renderText(),this._renderAcceptTypes(),this._renderMultiSelect()}},{key:"_renderEnabled",value:function(){sT(cT(i.prototype),"_renderEnabled",this).call(this),this._installOrUninstallDragAndDropHandler(),this.legacy?this.$fileInput.setEnabled(this.enabledComputed):this.$container.setTabbable(this.enabledComputed)}},{key:"setText",value:function(e){this.setProperty("text",e)}},{key:"_renderText",value:function(){if(!this.legacy){var e=this.text||"";this.$text.text(e)}}},{key:"setAcceptTypes",value:function(e){this.setProperty("acceptTypes",e)}},{key:"_renderAcceptTypes",value:function(){var e=this.acceptTypes||"";this.$fileInput.attr("accept",e)}},{key:"setMultiSelect",value:function(e){this.setProperty("multiSelect",e)}},{key:"_renderMultiSelect",value:function(){this.$fileInput.prop("multiple",this.multiSelect)}},{key:"setMaximumUploadSize",value:function(e){this.setProperty("maximumUploadSize",e)}},{key:"_remove",value:function(){this._uninstallDragAndDropHandler(),sT(cT(i.prototype),"_remove",this).call(this)}},{key:"_createDragAndDropHandler",value:function(){var e=this;return rn.handler(this,{supportedScoutTypes:rn.SCOUT_TYPES.FILE_TRANSFER,validateFiles:function(){},onDrop:function(t){t.files.length>=1&&e._setFiles(t.files)},dropType:function(){return rn.SCOUT_TYPES.FILE_TRANSFER},dropMaximumSize:function(){return e.maximumUploadSize}})}},{key:"_installOrUninstallDragAndDropHandler",value:function(){this.enabledComputed?this._installDragAndDropHandler():this._uninstallDragAndDropHandler()}},{key:"_installDragAndDropHandler",value:function(){this.dragAndDropHandler||(this.dragAndDropHandler=this._createDragAndDropHandler(),this.dragAndDropHandler&&this.dragAndDropHandler.install(this.$container))}},{key:"_uninstallDragAndDropHandler",value:function(){this.dragAndDropHandler&&(this.dragAndDropHandler.uninstall(),this.dragAndDropHandler=null)}},{key:"clear",value:function(){this._setFiles([]),this.setText(null),this.rendered&&this.$fileInput.val(null)}},{key:"_setFiles",value:function(e){if(e instanceof FileList&&(e=Wt.fileListToArray(e)),e=rt.ensure(e),!rt.equals(this.files,e)){var t="";e.length>0&&(t=this.legacy?e[0]:e[0].name),this.files=e,this.setText(t),this.trigger("change",{files:e})}}},{key:"upload",value:function(){return 0===this.files.length||(this.legacy?(this.session.setBusy(!0),this.$legacyForm[0].submit(),!0):this.session.uploadFiles(this.uploadController,this.files,void 0,this.maximumUploadSize))}},{key:"browse",value:function(){this.$fileInput.click()}},{key:"_onFileChange",value:function(e){var t=[];this.legacy?this.$fileInput[0].value&&t.push(this.$fileInput[0].value):t=this.$fileInput[0].files,t.length&&this._setFiles(t)}},{key:"_onMouseDown",value:function(){this.enabled&&this.browse()}},{key:"validateMaximumUploadSize",value:function(e){if(!Wt.validateMaximumUploadSize(e,this.maximumUploadSize))throw this.session.text("ui.FileSizeLimit",this.maximumUploadSize/1024/1024)}}])&&iT(t.prototype,n),r&&iT(t,r),i}(ve);function hT(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}!function(e,t,n){t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}(fT,"DEFAULT_MAXIMUM_UPLOAD_SIZE",52428800);var pT=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.location=null}var t,n,r;return t=e,(n=[{key:"matches",value:function(e){return!1}},{key:"activate",value:function(e){this.location=e}},{key:"deactivate",value:function(){}}])&&hT(t.prototype,n),r&&hT(t,r),e}(),dT=[],yT=new ln,vT=null,bT=null;function mT(e){e||(e=new RegExp("[^/]*$").exec(document.location.href)[0]);(Wn.empty(e)||"/"===e)&&(e=bT);var t,n=null;for(t=0;t<dT.length;t++)if((n=dT[t]).matches(e))return n===vT&&n.location===e?void(s.a.log.isDebugEnabled()&&s.a.log.debug("Route has not changed - do not activate route")):(vT&&vT.deactivate(),(vT=n).activate(e),window.location.replace(e),s.a.log.isInfoEnabled()&&s.a.log.info("router: activated route for location=",e),void yT.trigger("routeChange",{route:n}));s.a.log.warn("router: no route registered for location=",e)}var gT={activate:mT,currentRoute:vT,defaultLocation:bT,events:yT,on:function(e,t){yT.on(e,t)},prepare:function(e,t){Wn.startsWith(t,"#")||(t="#"+t),e.attr("href",t).on("mousedown",(function(e){return mT(t),!1}))},register:function(e){dT.push(e)},routes:dT,setDefaultLocation:function(e){bT="#"+e},updateLocation:function(e){var t="#"+e;window.location.replace(t)}};function _T(e){return(_T="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function wT(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function kT(e,t,n){return(kT="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=CT(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function ST(e,t){return(ST=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function OT(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=CT(e);if(t){var o=CT(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return TT(this,n)}}function TT(e,t){return!t||"object"!==_T(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function CT(e){return(CT=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}window.addEventListener("popstate",(function(e){return gT.activate(null),!1}));var PT=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ST(e,t)}(i,e);var t,n,r,o=OT(i);function i(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(e=o.call(this)).value=null,e.minValue=null,e.maxValue=null,e.step=null,e.$sliderInput=null,e.$sliderValue=null,e}return t=i,(n=[{key:"_init",value:function(e){kT(CT(i.prototype),"_init",this).call(this,e),this.value=e.value,this.minValue=e.minValue,this.maxValue=e.maxValue,this.step=e.step}},{key:"_render",value:function(){this.$container=this.$parent.appendDiv("slider"),this.htmlComp=ea.install(this.$container,this.session),this.htmlComp.setLayout(new HT(this)),this.$sliderInput=this.$container.appendElement("<input>","slider-input").attr("type","range").on("change",this._onValueChange.bind(this)).addClass(Kt.get().cssClassForEdge()),this.$sliderValue=this.$container.appendSpan("slider-value",this.value)}},{key:"_renderProperties",value:function(){kT(CT(i.prototype),"_renderProperties",this).call(this),this._renderValue(),this._renderMinValue(),this._renderMaxValue(),this._renderStep()}},{key:"_remove",value:function(){kT(CT(i.prototype),"_remove",this).call(this),this.$sliderInput=null,this.$sliderValue=null}},{key:"_renderValue",value:function(){var e=O.nvl(this.value,0);this.$sliderInput.val(e),this.$sliderValue.text(e)}},{key:"_renderMinValue",value:function(){this.minValue?this.$sliderInput.attr("min",this.minValue):this.$sliderInput.removeAttr("min")}},{key:"_renderMaxValue",value:function(){this.maxValue?this.$sliderInput.attr("max",this.maxValue):this.$sliderInput.removeAttr("max")}},{key:"_renderStep",value:function(){this.step?this.$sliderInput.attr("step",this.step):this.$sliderInput.removeAttr("step")}},{key:"_onValueChange",value:function(e){var t=Number(this.$sliderInput.val());Pr.isNumber(t)||(t=O.nvl(this.maxValue,this.minValue,0)),this.setValue(t)}},{key:"setValue",value:function(e){this.setProperty("value",e)}}])&&wT(t.prototype,n),r&&wT(t,r),i}(ve);function RT(e){return(RT="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function xT(e,t){return(xT=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function ET(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=AT(e);if(t){var o=AT(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return DT(this,n)}}function DT(e,t){return!t||"object"!==RT(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function AT(e){return(AT=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var FT=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&xT(e,t)}(n,e);var t=ET(n);function n(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),(e=t.call(this))._addRemoteProperties(["value"]),e}return n}(de);function $T(e){return($T="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function jT(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function BT(e,t){return(BT=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function MT(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=LT(e);if(t){var o=LT(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return IT(this,n)}}function IT(e,t){return!t||"object"!==$T(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function LT(e){return(LT=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var HT=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&BT(e,t)}(i,e);var t,n,r,o=MT(i);function i(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(t=o.call(this)).slider=e,t}return t=i,(n=[{key:"layout",value:function(e){var t=qs.size(e);this.slider.$sliderInput.css("height",t.height),this.slider.$sliderValue.css("height",t.height)}}])&&jT(t.prototype,n),r&&jT(t,r),i}(Zs);function NT(e){return(NT="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function VT(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function WT(e,t,n){return(WT="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=KT(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function zT(e,t){return(zT=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function GT(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=KT(e);if(t){var o=KT(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return UT(this,n)}}function UT(e,t){return!t||"object"!==NT(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function KT(e){return(KT=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var qT=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&zT(e,t)}(i,e);var t,n,r,o=GT(i);function i(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(e=o.call(this)).selected=!1,e.ref=null,e}return t=i,(n=[{key:"_init",value:function(e){e.owner=e.parent,WT(KT(i.prototype),"_init",this).call(this,e)}},{key:"_render",value:function(){WT(KT(i.prototype),"_render",this).call(this),this.$container.addClass("mode")}},{key:"_renderProperties",value:function(){WT(KT(i.prototype),"_renderProperties",this).call(this),this._renderSelected()}},{key:"setSelected",value:function(e){this.setProperty("selected",e)}},{key:"_renderSelected",value:function(){this.$container.select(this.selected)}},{key:"doAction",value:function(){return!!this.prepareDoAction()&&(this.selected||this.setSelected(!0),!0)}},{key:"toggle",value:function(){this.selected||this.setSelected(!0)}},{key:"_renderIconId",value:function(){WT(KT(i.prototype),"_renderIconId",this).call(this),this._updateLabelAndIconStyle(),this.invalidateLayoutTree()}},{key:"_renderText",value:function(){WT(KT(i.prototype),"_renderText",this).call(this),this._updateLabelAndIconStyle(),this.invalidateLayoutTree()}},{key:"_updateLabelAndIconStyle",value:function(){var e=!!this.text;this.get$Icon().toggleClass("with-label",e)}}])&&VT(t.prototype,n),r&&VT(t,r),i}(Up);function YT(e){return(YT="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function XT(e,t){return(XT=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function JT(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=QT(e);if(t){var o=QT(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return ZT(this,n)}}function ZT(e,t){return!t||"object"!==YT(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function QT(e){return(QT=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var eC=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&XT(e,t)}(n,e);var t=JT(n);function n(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),t.call(this)}return n}(ed);function tC(e){return(tC="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function nC(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function rC(e,t,n){return(rC="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=lC(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function oC(e,t){return(oC=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function iC(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=lC(e);if(t){var o=lC(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return sC(this,n)}}function sC(e,t){return!t||"object"!==tC(t)&&"function"!=typeof t?aC(e):t}function aC(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function lC(e){return(lC=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var uC=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&oC(e,t)}(i,e);var t,n,r,o=iC(i);function i(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(e=o.call(this))._addWidgetProperties(["modes","selectedMode"]),e._addPreserveOnPropertyChangeProperties(["selectedMode"]),e.modes=[],e.selectedMode=null,e._modePropertyChangeHandler=e._onModePropertyChange.bind(aC(e)),e}return t=i,(n=[{key:"_init",value:function(e){rC(lC(i.prototype),"_init",this).call(this,e),this._setModes(this.modes),this._setSelectedMode(this.selectedMode)}},{key:"_render",value:function(){this.$container=this.$parent.appendDiv("mode-selector"),this.htmlComp=ea.install(this.$container,this.session),this.htmlComp.setLayout(new bC(this))}},{key:"_renderProperties",value:function(){rC(lC(i.prototype),"_renderProperties",this).call(this),this._renderModes()}},{key:"setModes",value:function(e){this.setProperty("modes",e)}},{key:"_setModes",value:function(e){this.modes.forEach((function(e){e.off("propertyChange",this._modePropertyChangeHandler)}),this),this._setProperty("modes",rt.ensure(e)),this.modes.forEach((function(e){e.on("propertyChange",this._modePropertyChangeHandler),e.selected&&this.setSelectedMode(e)}),this)}},{key:"_renderModes",value:function(){this.modes.forEach((function(e){e.render()})),this._updateMarkers()}},{key:"setSelectedMode",value:function(e){this.setProperty("selectedMode",e)}},{key:"_setSelectedMode",value:function(e){this.selectedMode&&this.selectedMode!==e&&this.selectedMode.setSelected(!1),e&&!e.selected&&e.setSelected(!0),this._updateMarkers(),this._setProperty("selectedMode",e)}},{key:"_onModePropertyChange",value:function(e){"selected"===e.propertyName&&e.newValue?this.setSelectedMode(e.source):"visible"===e.propertyName&&this._updateMarkers()}},{key:"_updateMarkers",value:function(){var e=[],t=-1;this.modes.forEach((function(n){n.rendered&&(n.$container.removeClass("first last after-selected"),n.isVisible()&&(e.push(n),n.selected&&(t=e.length-1)))})),e.length&&(e[0].$container.addClass("first"),e[e.length-1].$container.addClass("last"),t>=0&&t<e.length-1&&e[t+1].$container.addClass("after-selected"))}},{key:"findModeById",value:function(e){return rt.find(this.modes,(function(t){return t.id===e}))}},{key:"findModeByRef",value:function(e){return rt.find(this.modes,(function(t){return t.ref===e}))}},{key:"selectModeById",value:function(e){this.setSelectedMode(this.findModeById(e))}},{key:"selectModeByRef",value:function(e){this.setSelectedMode(this.findModeByRef(e))}}])&&nC(t.prototype,n),r&&nC(t,r),i}(ve);function cC(e){return(cC="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function fC(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function hC(e,t,n){return(hC="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=vC(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function pC(e,t){return(pC=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function dC(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=vC(e);if(t){var o=vC(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return yC(this,n)}}function yC(e,t){return!t||"object"!==cC(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function vC(e){return(vC=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var bC=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&pC(e,t)}(i,e);var t,n,r,o=dC(i);function i(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(t=o.call(this)).modeSelector=e,t}return t=i,(n=[{key:"preferredLayoutSize",value:function(e,t){var n=hC(vC(i.prototype),"preferredLayoutSize",this).call(this,e,t),r=this.modeSelector.$container.attr("style");this.modeSelector.$container.css({width:"auto",height:"auto"});var o=0;return this.modeSelector.modes.forEach((function(e){var t=e.htmlComp.prefSize().width;t>o&&(o=t)})),this.modeSelector.$container.attrOrRemove("style",r),n.width=o*this.modeSelector.modes.length+this.modeSelector.htmlComp.insets().horizontal(),n}}])&&fC(t.prototype,n),r&&fC(t,r),i}(Zs);function mC(e){return(mC="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function gC(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function _C(e,t,n){return(_C="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=TC(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function wC(e,t){return(wC=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function kC(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=TC(e);if(t){var o=TC(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return SC(this,n)}}function SC(e,t){return!t||"object"!==mC(t)&&"function"!=typeof t?OC(e):t}function OC(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function TC(e){return(TC=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var CC=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&wC(e,t)}(i,e);var t,n,r,o=kC(i);function i(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(e=o.call(this))._addWidgetProperties(["rootGroupBox","views","dialogs","initialFocus","messageBoxes","fileChoosers"]),e._addPreserveOnPropertyChangeProperties(["initialFocus"]),e.animateOpening=!0,e.askIfNeedSave=!0,e.askIfNeedSaveText=null,e.data={},e.displayHint=i.DisplayHint.DIALOG,e.displayParent=null,e.maximized=!1,e.headerVisible=null,e.modal=!0,e.logicalGrid=O.create("FormGrid"),e.dialogs=[],e.views=[],e.messageBoxes=[],e.fileChoosers=[],e.focusedElement=null,e.closable=!0,e.cacheBounds=!1,e.cacheBoundsKey=null,e.resizable=!0,e.movable=!0,e.rootGroupBox=null,e.saveNeeded=!1,e.saveNeededVisible=!1,e.formController=null,e.messageBoxController=null,e.fileChooserController=null,e._glassPaneRenderer=null,e._preMaximizedBounds=null,e._resizeHandler=e._onResize.bind(OC(e)),e._windowResizeHandler=e._onWindowResize.bind(OC(e)),e.renderInitialFocusEnabled=!0,e.$statusIcons=[],e.$header=null,e.$statusContainer=null,e.$close=null,e.$saveNeeded=null,e.$icon=null,e.$title=null,e.$subTitle=null,e.$dragHandle=null,e}return t=i,r=[{key:"findForm",value:function(e){for(var t=e.parent;t&&!(t instanceof i);)t=t.parent;return t}},{key:"findNonWrappedForm",value:function(e){if(!e)return null;var t=null;return e.findParent((function(e){if(e instanceof i)return!((t=e).parent instanceof hne)})),t}}],(n=[{key:"_init",value:function(e){_C(TC(i.prototype),"_init",this).call(this,e),this.resolveTextKeys(["title","askIfNeedSaveText"]),this.resolveIconIds(["iconId"]),this._setDisplayParent(this.displayParent),this._setViews(this.views),this.formController=O.create("FormController",{displayParent:this,session:this.session}),this.messageBoxController=new TU(this,this.session),this.fileChooserController=new rT(this,this.session),this._setRootGroupBox(this.rootGroupBox),this._setStatus(this.status),this.cacheBoundsKey=O.nvl(e.cacheBoundsKey,this.objectType),this._installLifecycle()}},{key:"_render",value:function(){this._renderForm()}},{key:"_renderProperties",value:function(){_C(TC(i.prototype),"_renderProperties",this).call(this),this._renderMaximized(),this._renderMovable(),this._renderResizable(),this._renderHeaderVisible(),this._renderCssClass(),this._renderModal(),this._installFocusContext(),this.renderInitialFocusEnabled&&this.renderInitialFocus()}},{key:"_postRender",value:function(){_C(TC(i.prototype),"_postRender",this).call(this),this.formController.render(),this.messageBoxController.render(),this.fileChooserController.render(),this._glassPaneRenderer&&this._glassPaneRenderer.renderGlassPanes()}},{key:"_destroy",value:function(){_C(TC(i.prototype),"_destroy",this).call(this),this._glassPaneRenderer&&(this._glassPaneRenderer=null)}},{key:"_remove",value:function(){this.formController.remove(),this.messageBoxController.remove(),this.fileChooserController.remove(),this._glassPaneRenderer&&(this._glassPaneRenderer.removeGlassPanes(),this._glassPaneRenderer=null),this._uninstallFocusContext(),this._removeHeader(),this.$dragHandle=null,_C(TC(i.prototype),"_remove",this).call(this)}},{key:"_renderForm",value:function(){var e;this.$container=this.$parent.appendDiv("form").data("model",this),this.uiCssClass&&this.$container.addClass(this.uiCssClass),this.htmlComp=ea.install(this.$container,this.session),this.isDialog()?(this.$container.addClass("dialog"),e=new jR(this),this.htmlComp.validateRoot=!0,this.$container[0].addEventListener("mousedown",this._onDialogMouseDown.bind(this),!0)):e=new qC(this),this.htmlComp.setLayout(e),this.rootGroupBox.render()}},{key:"_renderFocusedElement",value:function(){this.focusedElement&&(this.focusedElement.focus(),this.focusedElement=null)}},{key:"setModal",value:function(e){this.setProperty("modal",e)}},{key:"_renderModal",value:function(){this.parent instanceof hne||(this.modal&&!this._glassPaneRenderer?(this._glassPaneRenderer=new ih(this),this._glassPaneRenderer.renderGlassPanes()):!this.modal&&this._glassPaneRenderer&&(this._glassPaneRenderer.removeGlassPanes(),this._glassPaneRenderer=null))}},{key:"_installLifecycle",value:function(){this.lifecycle=this._createLifecycle(),this.lifecycle.handle("load",this._onLifecycleLoad.bind(this)),this.lifecycle.handle("save",this._onLifecycleSave.bind(this)),this.lifecycle.on("postLoad",this._onLifecyclePostLoad.bind(this)),this.lifecycle.on("reset",this._onLifecycleReset.bind(this)),this.lifecycle.on("close",this._onLifecycleClose.bind(this))}},{key:"_createLifecycle",value:function(){return O.create("FormLifecycle",{widget:this,askIfNeedSave:this.askIfNeedSave,askIfNeedSaveText:this.askIfNeedSaveText})}},{key:"open",value:function(){var e=this;return this.load().then((function(){e.destroyed||e.show()}))}},{key:"load",value:function(){return this.lifecycle.load()}},{key:"whenLoad",value:function(){return this.when("load")}},{key:"_onLifecycleLoad",value:function(){var e=this;try{return this._load().then((function(t){e.destroyed||(e.setData(t),e.importData(),e.trigger("load"))})).catch((function(t){return e._handleLoadError(t)}))}catch(e){return this._handleLoadError(e)}}},{key:"_handleLoadError",value:function(e){throw this.destroy(),e}},{key:"_load",value:function(){var e=this;return s.a.resolvedPromise().then((function(){return e.data}))}},{key:"whenPostLoad",value:function(){return this.when("postLoad")}},{key:"_onLifecyclePostLoad",value:function(){var e=this;return this._postLoad().then((function(){e.trigger("postLoad")}))}},{key:"_postLoad",value:function(){return s.a.resolvedPromise()}},{key:"setData",value:function(e){this.setProperty("data",e)}},{key:"importData",value:function(){}},{key:"exportData",value:function(){}},{key:"ok",value:function(){return this.lifecycle.ok()}},{key:"save",value:function(){return this.lifecycle.save()}},{key:"whenSave",value:function(){return this.when("save")}},{key:"_onLifecycleSave",value:function(){var e=this,t=this.exportData();return this._save(t).then((function(n){return e.setData(t),e.trigger("save"),n}))}},{key:"_validate",value:function(){return Br.ok()}},{key:"_save",value:function(e){return s.a.resolvedPromise()}},{key:"reset",value:function(){this.lifecycle.reset()}},{key:"whenReset",value:function(){return this.when("reset")}},{key:"_onLifecycleReset",value:function(){this.trigger("reset")}},{key:"cancel",value:function(){return this.lifecycle.cancel()}},{key:"whenCancel",value:function(){return this.when("cancel")}},{key:"close",value:function(){return this.lifecycle.close()}},{key:"whenClose",value:function(){return this.when("close")}},{key:"_onLifecycleClose",value:function(){var e=new sn;this.trigger("close",e),e.defaultPrevented||this._close()}},{key:"_close",value:function(){this.hide(),this.destroy()}},{key:"abort",value:function(){var e=new sn;this.trigger("abort",e),e.defaultPrevented||this._abort()}},{key:"whenAbort",value:function(){return this.when("abort")}},{key:"_abort",value:function(){this.rootGroupBox.controls.concat(this.rootGroupBox.menus).filter((function(e){var t=e.enabled;return void 0!==e.enabledComputed&&(t=e.enabledComputed),e.visible&&t&&e.systemType&&e.systemType!==JK.SystemType.NONE})).some((function(e){return e.systemType===JK.SystemType.CLOSE}))?this.close():this.cancel()}},{key:"setClosable",value:function(e){this.setProperty("closable",e)}},{key:"_renderClosable",value:function(){if(this.$header)if(this.$container.toggleClass("closable"),this.closable){if(this.$close)return;this.$close=this.$statusContainer.appendDiv("status closer").on("click",this._onCloseIconClick.bind(this))}else{if(!this.$close)return;this.$close.remove(),this.$close=null}}},{key:"_onCloseIconClick",value:function(){this.abort()}},{key:"setResizable",value:function(e){this.setProperty("resizable",e)}},{key:"_renderResizable",value:function(){this.resizable&&this.isDialog()&&!this.maximized?this.$container.resizable().on("resize",this._resizeHandler):this.$container.unresizable().off("resize",this._resizeHandler)}},{key:"_onResize",value:function(e){var t=this.htmlComp.layout.autoSize;return this.htmlComp.layout.autoSize=!1,this.htmlComp.revalidateLayout(),this.htmlComp.layout.autoSize=t,this.updateCacheBounds(),!1}},{key:"setMovable",value:function(e){this.setProperty("movable",e)}},{key:"_renderMovable",value:function(){if(this.movable&&this.isDialog()&&!this.maximized){if(this.$dragHandle)return;this.$dragHandle=this.$container.prependDiv("drag-handle"),this.$container.draggable(this.$dragHandle,s.a.throttle(this._onMove.bind(this),1e3/60))}else{if(!this.$dragHandle)return;this.$container.undraggable(this.$dragHandle),this.$dragHandle.remove(),this.$dragHandle=null}}},{key:"_onDialogMouseDown",value:function(){this.activate()}},{key:"activate",value:function(){this.session.desktop.activateForm(this)}},{key:"show",value:function(){this.session.desktop.showForm(this)}},{key:"hide",value:function(){this.session.desktop.hideForm(this)}},{key:"_renderHeader",value:function(){this.$header=this.$container.prependDiv("header"),this.$statusContainer=this.$header.appendDiv("status-container"),this.$icon=this.$header.appendDiv("icon-container"),this.$title=this.$header.appendDiv("title"),xp.installForEllipsis(this.$title,{parent:this}),this.$subTitle=this.$header.appendDiv("sub-title"),xp.installForEllipsis(this.$subTitle,{parent:this}),this._renderTitle(),this._renderSubTitle(),this._renderIconId(),this._renderStatus(),this._renderClosable(),this._renderSaveNeeded()}},{key:"_removeHeader",value:function(){this.$title&&xp.uninstall(this.$title),this.$subTitle&&xp.uninstall(this.$subTitle),this.$header&&(this.$header.remove(),this.$header=null),this.$title=null,this.$subTitle=null,this.$statusContainer=null,this.$icon=null,this.$close=null,this.$saveNeeded=null}},{key:"_setRootGroupBox",value:function(e){this._setProperty("rootGroupBox",e),this.rootGroupBox&&(this.rootGroupBox.setMainBox(!0),(this.isDialog()||this.parent instanceof hne)&&this.rootGroupBox.setMenuBarPosition(gJ.MenuBarPosition.BOTTOM))}},{key:"_renderSaveNeeded",value:function(){if(this.$header){if(this.saveNeeded&&this.saveNeededVisible){if(this.$container.addClass("save-needed"),this.$saveNeeded)return;this.$close?this.$saveNeeded=this.$close.beforeDiv("status save-needer"):this.$saveNeeded=this.$statusContainer.appendDiv("status save-needer")}else{if(this.$container.removeClass("save-needed"),!this.$saveNeeded)return;this.$saveNeeded.remove(),this.$saveNeeded=null}this.invalidateLayoutTree()}}},{key:"setAskIfNeedSave",value:function(e){this.setProperty("askIfNeedSave",e),this.lifecycle&&this.lifecycle.setAskIfNeedSave(e)}},{key:"setDisplayHint",value:function(e){this.setProperty("displayHint",e)}},{key:"setSaveNeededVisible",value:function(e){this.setProperty("saveNeededVisible",e)}},{key:"_renderSaveNeededVisible",value:function(){this._renderSaveNeeded()}},{key:"_renderCssClass",value:function(e,t){e=e||this.cssClass,this.$container.removeClass(t),this.$container.addClass(e),this.invalidateLayoutTree()}},{key:"setStatus",value:function(e){this.setProperty("status",e)}},{key:"_setStatus",value:function(e){e=Br.ensure(e),this._setProperty("status",e)}},{key:"_renderStatus",value:function(){var e,t=this;this.$header&&(this.$statusIcons.forEach((function(e){e.remove()})),this.$statusIcons=[],this.status&&this.status.asFlatList().forEach((function(n){(e=t._renderSingleStatus(n,e))&&t.$statusIcons.push(e)})),this.invalidateLayoutTree())}},{key:"_renderSingleStatus",value:function(e,t){if(e&&e.iconId){var n=this.$statusContainer.appendIcon(e.iconId,"status");return e.cssClass()&&n.addClass(e.cssClass()),n.prependTo(this.$statusContainer),n}return t}},{key:"_updateTitleForWindow",value:function(){var e=Wn.join(" - ",this.title,this.subTitle),t=this.session.desktop.title;this.popupWindow.title(e||t)}},{key:"_updateTitleForDom",value:function(){var e=this.title;if(!e&&this.closable&&(e=Wn.plainText("&nbsp;")),e||this.subTitle){var t=n(this.$container,"title-box");e?n(t,"title").text(e).icon(this.iconId):r(t,"title"),Wn.hasText(e)?n(t,"sub-title").text(this.subTitle):r(t,"sub-title")}else r(this.$container,"title-box");function n(e,t){var n=e.children("."+t);return 0===n.length&&(n=this.$parent.appendDiv(t)),n}function r(e,t){e.children("."+t).remove()}}},{key:"isDialog",value:function(){return this.displayHint===i.DisplayHint.DIALOG}},{key:"isPopupWindow",value:function(){return this.displayHint===i.DisplayHint.POPUP_WINDOW}},{key:"isView",value:function(){return this.displayHint===i.DisplayHint.VIEW}},{key:"_onMove",value:function(e){this.trigger("move",e),this.updateCacheBounds()}},{key:"moveTo",value:function(e){this.$container.cssPosition(e),this.trigger("move",{left:e.x,top:e.y}),this.updateCacheBounds()}},{key:"position",value:function(){var e,t=this.prefBounds();e=t?t.point():jR.positionContainerInWindow(this.$container),this.moveTo(e)}},{key:"updateCacheBounds",value:function(){this.cacheBounds&&!this.maximized&&this.storeCacheBounds(this.htmlComp.bounds())}},{key:"appendTo",value:function(e){this.$container.appendTo(e)}},{key:"setHeaderVisible",value:function(e){this.setProperty("headerVisible",e)}},{key:"_renderHeaderVisible",value:function(){var e=null===this.headerVisible?this.isDialog():this.headerVisible;e&&!this.$header?this._renderHeader():!e&&this.$header&&this._removeHeader(),this.invalidateLayoutTree()}},{key:"setTitle",value:function(e){this.setProperty("title",e)}},{key:"_renderTitle",value:function(){this.$header&&(this.$title.text(this.title),this.$header.toggleClass("no-title",!this.title&&!this.subTitle)),this.isPopupWindow()&&this._updateTitleForWindow(),this.invalidateLayoutTree()}},{key:"setSubTitle",value:function(e){this.setProperty("subTitle",e)}},{key:"_renderSubTitle",value:function(){this.$header&&(this.$subTitle.text(this.subTitle),this.$header.toggleClass("no-title",!this.title&&!this.subTitle)),this.isPopupWindow()&&this._updateTitleForWindow(),this.invalidateLayoutTree()}},{key:"setIconId",value:function(e){this.setProperty("iconId",e)}},{key:"_renderIconId",value:function(){this.$header&&(this.$icon.icon(this.iconId),this.invalidateLayoutTree())}},{key:"_setViews",value:function(e){var t=this;e&&e.forEach((function(e){e.setDisplayParent(t)})),this._setProperty("views",e)}},{key:"setDisabledStyle",value:function(e){this.rootGroupBox.setDisabledStyle(e)}},{key:"setDisplayParent",value:function(e){this.setProperty("displayParent",e)}},{key:"_setDisplayParent",value:function(e){e instanceof i&&e.parent instanceof hne&&e.isView()&&(e=i.findNonWrappedForm(e)),this._setProperty("displayParent",e),e&&this.setParent(this.findDesktop().computeParentForDisplayParent(e))}},{key:"setMaximized",value:function(e){this.setProperty("maximized",e)}},{key:"_renderMaximized",value:function(){this.isDialog()&&(this.maximized&&this.htmlComp.layouted&&(this._preMaximizedBounds=this.htmlComp.bounds()),this._maximize(),this.maximized||(this._preMaximizedBounds=null),this.maximized?this.$container.window().on("resize",this._windowResizeHandler):this.$container.window().off("resize",this._windowResizeHandler),this.rendered&&(this._renderMovable(),this._renderResizable()))}},{key:"_onWindowResize",value:function(){this.maximized&&this._maximize()}},{key:"_maximize",value:function(){if(this.rendered){var e=this.htmlComp.layout.shrinkEnabled;this.htmlComp.layout.shrinkEnabled=!0,this.revalidateLayoutTree(),this.position(),this.htmlComp.layout.shrinkEnabled=e}}},{key:"prefBounds",value:function(){return this.maximized?null:this._preMaximizedBounds?this._preMaximizedBounds:this.cacheBounds?this.readCacheBounds():null}},{key:"_attach",value:function(){this.$parent.append(this.$container),this.isView()&&this.invalidateLayoutTree(!1),!this.isView()&&!this.isDialog()||this.detailForm||this.session.desktop._setFormActivated(this),_C(TC(i.prototype),"_attach",this).call(this)}},{key:"_postAttach",value:function(){this.formController.attachDialogs(),this.messageBoxController.attach(),this.fileChooserController.attach(),_C(TC(i.prototype),"_attach",this).call(this)}},{key:"_detach",value:function(){this.formController.detachDialogs(),this.messageBoxController.detach(),this.fileChooserController.detach(),this.$container.detach(),_C(TC(i.prototype),"_detach",this).call(this)}},{key:"renderInitialFocus",value:function(){var e=!1;if(this.initialFocus)e=this.initialFocus.focus();else if(!this.$container.isOrHas(this.$container.activeElement())){var t=this.session.focusManager;e=t.requestFocusIfReady(t.findFirstFocusableElement(this.$container))}if(e){var n=this.$container.activeElement().scrollParent();n.scrollTop(0),n.scrollLeft(0)}}},{key:"_initialFocusElement",value:function(){var e;return this.initialFocus&&(e=this.initialFocus.getFocusableElement()),e||(e=this.session.focusManager.findFirstFocusableElement(this.$container)),e}},{key:"_installFocusContext",value:function(){(this.isDialog()||this.isPopupWindow())&&this.session.focusManager.installFocusContext(this.$container,Kf.NONE)}},{key:"_uninstallFocusContext",value:function(){(this.isDialog()||this.isPopupWindow())&&this.session.focusManager.uninstallFocusContext(this.$container)}},{key:"touch",value:function(){this.rootGroupBox.touch()}},{key:"inFront",value:function(){return this.rendered&&this.attached}},{key:"visitFields",value:function(e){this.rootGroupBox.visitFields(e)}},{key:"visitDisplayChildren",value:function(e,t){t||(t=function(e){return!0});var n=function(n){e(n),n instanceof i&&n.visitDisplayChildren(e,t)};this.dialogs.filter(t).forEach(n,this),this.messageBoxes.filter(t).forEach(n,this),this.fileChoosers.filter(t).forEach(n,this)}},{key:"storeCacheBounds",value:function(e){if(this.cacheBounds){var t="scout:formBounds:"+this.cacheBoundsKey;Ho.setItemToLocalStorage(t,JSON.stringify(e))}}},{key:"readCacheBounds",value:function(){if(!this.cacheBounds)return null;var e="scout:formBounds:"+this.cacheBoundsKey,t=Ho.getItemFromLocalStorage(e);return t?(t=JSON.parse(t),new Hs(t.x,t.y,t.width,t.height)):null}}])&&gC(t.prototype,n),r&&gC(t,r),i}(ve);function PC(e){return(PC="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function RC(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function xC(e,t,n){return(xC="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=FC(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function EC(e,t){return(EC=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function DC(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=FC(e);if(t){var o=FC(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return AC(this,n)}}function AC(e,t){return!t||"object"!==PC(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function FC(e){return(FC=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}!function(e,t,n){t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}(CC,"DisplayHint",{DIALOG:"dialog",POPUP_WINDOW:"popupWindow",VIEW:"view"});var $C=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&EC(e,t)}(i,e);var t,n,r,o=DC(i);function i(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),o.call(this)}return t=i,(n=[{key:"_initModel",value:function(e,t){return(e=xC(FC(i.prototype),"_initModel",this).call(this,e,t)).logicalGrid=null,e}},{key:"_onWidgetEvent",value:function(e){"abort"===e.type?this._onWidgetAbort(e):"close"===e.type?this._onWidgetClose(e):xC(FC(i.prototype),"_onWidgetEvent",this).call(this,e)}},{key:"_onWidgetAbort",value:function(e){e.preventDefault(),this._send("formClosing")}},{key:"_onWidgetClose",value:function(e){this._send("close")}},{key:"onModelAction",value:function(e){"requestFocus"===e.type?this._onRequestFocus(e):"requestInput"===e.type?this._onRequestInput(e):xC(FC(i.prototype),"onModelAction",this).call(this,e)}},{key:"_onRequestFocus",value:function(e){this.session.getOrCreateWidget(e.formField,this.widget).focus()}},{key:"_onRequestInput",value:function(e){this.session.getOrCreateWidget(e.formField,this.widget).requestInput()}}])&&RC(t.prototype,n),r&&RC(t,r),i}(de);function jC(e){return(jC="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function BC(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function MC(e,t){return(MC=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function IC(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=HC(e);if(t){var o=HC(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return LC(this,n)}}function LC(e,t){return!t||"object"!==jC(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function HC(e){return(HC=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var NC=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&MC(e,t)}(i,e);var t,n,r,o=IC(i);function i(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),o.call(this)}return t=i,(n=[{key:"_validate",value:function(e){e.rootGroupBox.gridData=Ez.createFromHints(e.rootGroupBox)}}])&&BC(t.prototype,n),r&&BC(t,r),i}(ia);function VC(e){return(VC="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function WC(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function zC(e,t){return(zC=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function GC(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=KC(e);if(t){var o=KC(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return UC(this,n)}}function UC(e,t){return!t||"object"!==VC(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function KC(e){return(KC=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var qC=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&zC(e,t)}(i,e);var t,n,r,o=GC(i);function i(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(t=o.call(this)).form=e,t}return t=i,(n=[{key:"layout",value:function(e){var t,n=ea.get(e),r=this._htmlRootGroupBox();this.form.validateLogicalGrid(),(t=n.availableSize().subtract(n.insets()).subtract(r.margins())).height-=this._headerHeight(),s.a.log.isTraceEnabled()&&s.a.log.trace("(FormLayout#layout) rootGbSize="+t),r.setSize(t)}},{key:"preferredLayoutSize",value:function(e,t){t=t||{};var n,r=ea.get(e),o=this._htmlRootGroupBox();this.form.validateLogicalGrid();var i=this._headerHeight();return t.heightHint&&(t.heightHint-=i),(n=o.prefSize(t).add(r.insets()).add(o.margins())).height+=i,n}},{key:"_htmlRootGroupBox",value:function(){var e=this.form.$container.children(".root-group-box");return ea.get(e)}},{key:"_headerHeight",value:function(){return this.form.$header&&"absolute"!==this.form.$header.css("position")?qs.prefSize(this.form.$header,!0).height:0}}])&&WC(t.prototype,n),r&&WC(t,r),i}(Zs);function YC(e){return(YC="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function XC(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function JC(e,t){return(JC=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function ZC(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=eP(e);if(t){var o=eP(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return QC(this,n)}}function QC(e,t){return!t||"object"!==YC(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function eP(e){return(eP=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var tP=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&JC(e,t)}(i,e);var t,n,r,o=ZC(i);function i(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),o.call(this,e)}return t=i,(n=[{key:"handle",value:function(e){this.field.toggle()}},{key:"_postRenderKeyBox",value:function(e){if(this.field.iconId){var t=e.find(".icon").width()/2-e.find(".key-box").outerWidth()/2+e.cssPaddingLeft();e.find(".key-box").cssLeft(t)}}}])&&XC(t.prototype,n),r&&XC(t,r),i}(ld);function nP(e){return(nP="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function rP(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function oP(e,t,n){return(oP="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=lP(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function iP(e,t){return(iP=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function sP(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=lP(e);if(t){var o=lP(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return aP(this,n)}}function aP(e,t){return!t||"object"!==nP(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function lP(e){return(lP=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var uP=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&iP(e,t)}(i,e);var t,n,r,o=sP(i);function i(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(e=o.call(this)).form=null,e.toggleAction=!0,e.popupStyle=null,e._addWidgetProperties("form"),e}return t=i,(n=[{key:"_init",value:function(e){oP(lP(i.prototype),"_init",this).call(this,e),this.popupStyle||(this.session.userAgent.deviceType===Kt.Type.MOBILE?this.popupStyle=i.PopupStyle.MOBILE:this.popupStyle=i.PopupStyle.DEFAULT),this._setSelected(this.selected)}},{key:"_renderForm",value:function(){this.rendered&&this._renderSelected()}},{key:"clone",value:function(e,t){return(e=e||{}).form=this.form,oP(lP(i.prototype),"clone",this).call(this,e,t)}},{key:"_addFormRemoveHandler",value:function(){var e=this;this.form&&this.form.one("remove",(function(t){e._onFormRemove(t)}))}},{key:"_onFormRemove",value:function(e){if(this.selected){this.destroying||this.removing||this.setSelected(!1);var t=this.findParent((function(e){return e instanceof Qg}));!t||t.destroying||t.removing||t.close()}}},{key:"_setSelected",value:function(e){this._setProperty("selected",e),this.popupStyle===i.PopupStyle.MOBILE&&this._doActionTogglesPopup()&&(this.selected?this._openPopup():this._closePopup())}},{key:"_openPopup",value:function(){this.popup||(oP(lP(i.prototype),"_openPopup",this).call(this),this._addFormRemoveHandler())}},{key:"_createPopup",value:function(){return this.form.rootGroupBox.setMenuBarPosition(gJ.MenuBarPosition.BOTTOM),this.popupStyle===i.PopupStyle.MOBILE?O.create("MobilePopup",{parent:this.session.desktop,widget:this.form,title:this.form.title}):O.create("FormMenuPopup",{parent:this,formMenu:this,horizontalAlignment:this.popupHorizontalAlignment,verticalAlignment:this.popupVerticalAlignment})}},{key:"_doActionTogglesPopup",value:function(){return!!this.form}},{key:"_handleSelectedInEllipsis",value:function(){this.popupStyle!==i.PopupStyle.MOBILE&&oP(lP(i.prototype),"_handleSelectedInEllipsis",this).call(this)}},{key:"_createActionKeyStroke",value:function(){return new tP(this)}}])&&rP(t.prototype,n),r&&rP(t,r),i}(eg);function cP(e){return(cP="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function fP(e,t){return(fP=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function hP(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=dP(e);if(t){var o=dP(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return pP(this,n)}}function pP(e,t){return!t||"object"!==cP(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function dP(e){return(dP=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}!function(e,t,n){t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}(uP,"PopupStyle",{DEFAULT:"default",MOBILE:"mobile"});var yP=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&fP(e,t)}(n,e);var t=hP(n);function n(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),t.call(this)}return n}(dg);function vP(e){return(vP="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function bP(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function mP(e,t,n){return(mP="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=SP(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function gP(e,t){return(gP=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function _P(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=SP(e);if(t){var o=SP(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return wP(this,n)}}function wP(e,t){return!t||"object"!==vP(t)&&"function"!=typeof t?kP(e):t}function kP(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function SP(e){return(SP=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var OP=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&gP(e,t)}(i,e);var t,n,r,o=_P(i);function i(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(e=o.call(this)).formMenu=null,e.formMenuPropertyChangeHandler=e._onFormMenuPropertyChange.bind(kP(e)),e._addWidgetProperties("form"),e}return t=i,(n=[{key:"_init",value:function(e){e.form=e.formMenu.form,e.initialFocus=e.formMenu.form._initialFocusElement.bind(e.formMenu.form),mP(SP(i.prototype),"_init",this).call(this,e),this.$formMenu=this.formMenu.$container,this.$headBlueprint=this.$formMenu}},{key:"_createLayout",value:function(){return new AP(this)}},{key:"_render",value:function(){mP(SP(i.prototype),"_render",this).call(this),this.$container.addClass("form-menu-popup"),this.form.renderInitialFocusEnabled=!1,this.form.render(this.$body),this._headVisible&&this.formMenu.on("propertyChange",this.formMenuPropertyChangeHandler)}},{key:"_remove",value:function(){mP(SP(i.prototype),"_remove",this).call(this),this._headVisible&&this.formMenu.off("propertyChange",this.formMenuPropertyChangeHandler)}},{key:"_renderHead",value:function(){mP(SP(i.prototype),"_renderHead",this).call(this),this.formMenu.uiCssClass&&this._copyCssClassToHead(this.formMenu.uiCssClass),this.formMenu.cssClass&&this._copyCssClassToHead(this.formMenu.cssClass),this._copyCssClassToHead("unfocusable")}},{key:"_onFormMenuPropertyChange",value:function(e){var t=this;this.session.layoutValidator.schedulePostValidateFunction((function(){t.rendered&&(t.rerenderHead(),t.position())}))}},{key:"_onWindowResize",value:function(){this.rendered&&(this.revalidateLayout(),this.position(!1))}}])&&bP(t.prototype,n),r&&bP(t,r),i}(wy);function TP(e){return(TP="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function CP(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function PP(e,t,n){return(PP="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=DP(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function RP(e,t){return(RP=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function xP(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=DP(e);if(t){var o=DP(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return EP(this,n)}}function EP(e,t){return!t||"object"!==TP(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function DP(e){return(DP=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var AP=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&RP(e,t)}(i,e);var t,n,r,o=xP(i);function i(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(t=o.call(this,e)).popup=e,t}return t=i,(n=[{key:"_setSize",value:function(e){var t,n=this.popup.form.htmlComp;PP(DP(i.prototype),"_setSize",this).call(this,e),t=(t=qs.size(this.popup.$body)).subtract(qs.insets(this.popup.$body)),n.setSize(t)}},{key:"preferredLayoutSize",value:function(e){var t=this.popup.htmlComp,n=this.popup.form.htmlComp;return n.prefSize().add(t.insets()).add(qs.insets(this.popup.$body,!0)).add(n.margins())}}])&&CP(t.prototype,n),r&&CP(t,r),i}(xy);function FP(e){return(FP="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function $P(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function jP(e,t,n){return(jP="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=LP(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function BP(e,t){return(BP=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function MP(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=LP(e);if(t){var o=LP(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return IP(this,n)}}function IP(e,t){return!t||"object"!==FP(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function LP(e){return(LP=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var HP=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&BP(e,t)}(i,e);var t,n,r,o=MP(i);function i(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(e=o.call(this)).emptyMandatoryElementsTextKey="FormEmptyMandatoryFieldsMessage",e.invalidElementsTextKey="FormInvalidFieldsMessage",e.saveChangesQuestionTextKey="FormSaveChangesQuestion",e}return t=i,(n=[{key:"init",value:function(e){O.assertParameter("widget",e.widget,CC),jP(LP(i.prototype),"init",this).call(this,e)}},{key:"_reset",value:function(){this.widget.visitFields((function(e){e instanceof Qz&&e.resetValue()}))}},{key:"_invalidElements",value:function(){var e=[],t=[];return this.widget.visitFields((function(n){var r=n.getValidationResult();r.valid||(r.validByErrorStatus?r.validByMandatory||e.push(n):t.push(n))})),{missingElements:e,invalidElements:t}}},{key:"_invalidElementText",value:function(e){return e.label}},{key:"_missingElementText",value:function(e){return e.label}},{key:"_validateWidget",value:function(){return this.widget._validate()}},{key:"markAsSaved",value:function(){this.widget.visitFields((function(e){e.markAsSaved()}))}},{key:"requiresSave",value:function(){var e=!1;return this.widget.visitFields((function(t){t.updateRequiresSave(),t.requiresSave&&(e=!0)})),e}}])&&$P(t.prototype,n),r&&$P(t,r),i}(nO);function NP(e){return(NP="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function VP(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function WP(e,t,n){return(WP="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=KP(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function zP(e,t){return(zP=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function GP(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=KP(e);if(t){var o=KP(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return UP(this,n)}}function UP(e,t){return!t||"object"!==NP(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function KP(e){return(KP=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var qP=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&zP(e,t)}(i,e);var t,n,r,o=GP(i);function i(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(e=o.call(this)).actionStyle=Up.ActionStyle.BUTTON,e.keyStroke="esc",e.systemType=JK.SystemType.CANCEL,e.inheritAccessibility=!1,e.preventDoubleClick=!0,e}return t=i,(n=[{key:"_init",value:function(e){WP(KP(i.prototype),"_init",this).call(this,e),this.text=O.nvl(this.text,this.session.text("CancelButton"))}},{key:"_doAction",value:function(){var e=this.getForm(),t=new sn;this.trigger("action",t),t.defaultPrevented||e.cancel()}}])&&VP(t.prototype,n),r&&VP(t,r),i}(eg);function YP(e){return(YP="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function XP(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function JP(e,t,n){return(JP="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=tR(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function ZP(e,t){return(ZP=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function QP(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=tR(e);if(t){var o=tR(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return eR(this,n)}}function eR(e,t){return!t||"object"!==YP(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function tR(e){return(tR=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var nR=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ZP(e,t)}(i,e);var t,n,r,o=QP(i);function i(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(e=o.call(this)).actionStyle=Up.ActionStyle.BUTTON,e.keyStroke="esc",e.systemType=JK.SystemType.CLOSE,e.inheritAccessibility=!1,e.preventDoubleClick=!0,e}return t=i,(n=[{key:"_init",value:function(e){JP(tR(i.prototype),"_init",this).call(this,e),this.text=O.nvl(this.text,this.session.text("CloseButton"))}},{key:"_doAction",value:function(){var e=this.getForm(),t=new sn;this.trigger("action",t),t.defaultPrevented||e.close()}}])&&XP(t.prototype,n),r&&XP(t,r),i}(eg);function rR(e){return(rR="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function oR(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function iR(e,t,n){return(iR="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=uR(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function sR(e,t){return(sR=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function aR(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=uR(e);if(t){var o=uR(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return lR(this,n)}}function lR(e,t){return!t||"object"!==rR(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function uR(e){return(uR=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var cR=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&sR(e,t)}(i,e);var t,n,r,o=aR(i);function i(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(e=o.call(this)).actionStyle=Up.ActionStyle.BUTTON,e.keyStroke="enter",e.systemType=JK.SystemType.OK,e.preventDoubleClick=!0,e}return t=i,(n=[{key:"_init",value:function(e){iR(uR(i.prototype),"_init",this).call(this,e),this.text=O.nvl(this.text,this.session.text("OkButton"))}},{key:"_doAction",value:function(){var e=this.getForm(),t=new sn;this.trigger("action",t),t.defaultPrevented||e.ok()}}])&&oR(t.prototype,n),r&&oR(t,r),i}(eg);function fR(e){return(fR="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function hR(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function pR(e,t,n){return(pR="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=bR(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function dR(e,t){return(dR=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function yR(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=bR(e);if(t){var o=bR(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return vR(this,n)}}function vR(e,t){return!t||"object"!==fR(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function bR(e){return(bR=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var mR=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&dR(e,t)}(i,e);var t,n,r,o=yR(i);function i(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(e=o.call(this)).actionStyle=Up.ActionStyle.BUTTON,e.systemType=JK.SystemType.RESET,e.preventDoubleClick=!0,e}return t=i,(n=[{key:"_init",value:function(e){pR(bR(i.prototype),"_init",this).call(this,e),this.text=O.nvl(this.text,this.session.text("ResetButton"))}},{key:"_doAction",value:function(){var e=this.getForm(),t=new sn;this.trigger("action",t),t.defaultPrevented||e.reset()}}])&&hR(t.prototype,n),r&&hR(t,r),i}(eg);function gR(e){return(gR="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _R(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function wR(e,t,n){return(wR="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=TR(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function kR(e,t){return(kR=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function SR(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=TR(e);if(t){var o=TR(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return OR(this,n)}}function OR(e,t){return!t||"object"!==gR(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function TR(e){return(TR=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var CR=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&kR(e,t)}(i,e);var t,n,r,o=SR(i);function i(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(e=o.call(this)).actionStyle=Up.ActionStyle.BUTTON,e.keyStroke="enter",e.systemType=JK.SystemType.SAVE,e.preventDoubleClick=!0,e}return t=i,(n=[{key:"_init",value:function(e){wR(TR(i.prototype),"_init",this).call(this,e),this.text=O.nvl(this.text,this.session.text("SaveButton"))}},{key:"_doAction",value:function(){var e=this.getForm(),t=new sn;this.trigger("action",t),t.defaultPrevented||e.save()}}])&&_R(t.prototype,n),r&&_R(t,r),i}(eg);function PR(e){return(PR="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function RR(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function xR(e,t,n){return(xR="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=FR(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function ER(e,t){return(ER=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function DR(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=FR(e);if(t){var o=FR(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return AR(this,n)}}function AR(e,t){return!t||"object"!==PR(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function FR(e){return(FR=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var $R,jR=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ER(e,t)}(i,e);var t,n,r,o=DR(i);function i(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(t=o.call(this,e)).autoSize=!0,t.shrinkEnabled=!1,t}return t=i,r=[{key:"fitContainerInWindow",value:function(e,t,n,r){var o=e.width-r.horizontal()-t.x,i=e.height-r.vertical()-t.y,s=new $s;return s.width=Math.min(o,n.width),s.height=Math.min(i,n.height),s}},{key:"positionContainerInWindow",value:function(e){var t=e.windowSize(),n=ea.get(e).size(!0),r=(t.width-n.width)/2,o=(t.height-n.height)/2;return o-=o/5,r=Math.floor(r),o=Math.floor(o),new Is(r,o)}}],(n=[{key:"layout",value:function(e){if(this.autoSize){var t,n=this.form.htmlComp,r=this.form.prefBounds(),o=n.margins(),s=e.windowSize();t=r||n.bounds();var a=this._calcSize(e,t,r);e.toggleClass("full-width",0===t.x&&0===o.horizontal()&&s.width===a.width).toggleClass("full-height",0===t.y&&0===o.vertical()&&s.height===a.height),n.layouted&&!this.shrinkEnabled&&(a.width=Math.max(a.width,t.width),a.height=Math.max(a.height,t.height)),qs.setSize(e,a),xR(FR(i.prototype),"layout",this).call(this,e)}else xR(FR(i.prototype),"layout",this).call(this,e)}},{key:"_calcSize",value:function(e,t,n){var r,o=this.form.htmlComp.margins(),s=e.windowSize();return this.form.maximized?s:n&&(r=n.dimension(),t=n,r=i.fitContainerInWindow(s,t.point(),r,o),n.dimension().width===r.width)?r:(r=this.preferredLayoutSize(e,{widthOnly:!0}),r=i.fitContainerInWindow(s,t.point(),r,o),r=this.preferredLayoutSize(e,{widthHint:r.width}).ceil(),r=i.fitContainerInWindow(s,t.point(),r,o))}}])&&RR(t.prototype,n),r&&RR(t,r),i}(qC);function BR(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var MR=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.active=!0,this.globalState=null,this._responsiveHandlers=[]}var t,n,r;return t=e,r=[{key:"get",value:function(){return $R}}],(n=[{key:"init",value:function(){}},{key:"destroy",value:function(){this._responsiveHandlers.forEach((function(e){e.destroy()}))}},{key:"setActive",value:function(e){this.active=e}},{key:"setGlobalState",value:function(e){this.globalState=e}},{key:"handleResponsive",value:function(t,n){if(!this.active)return!1;if(!t.responsiveHandler||!t.responsiveHandler.active())return!1;var r,o=t.responsiveHandler.state;return this.globalState?r=this.globalState:n<t.responsiveHandler.getCompactThreshold()&&t.responsiveHandler.acceptState(e.ResponsiveState.COMPACT)?r=e.ResponsiveState.COMPACT:(o===e.ResponsiveState.COMPACT&&t.responsiveHandler.transform(e.ResponsiveState.CONDENSED),r=n<t.responsiveHandler.getCondensedThreshold()&&t.responsiveHandler.acceptState(e.ResponsiveState.CONDENSED)?e.ResponsiveState.CONDENSED:e.ResponsiveState.NORMAL),t.responsiveHandler.transform(r)}},{key:"reset",value:function(t,n){if(this.active)return!!(t.responsiveHandler&&t.responsiveHandler.active()||n)&&void t.responsiveHandler.transform(e.ResponsiveState.NORMAL,n)}},{key:"registerHandler",value:function(e,t){e.responsiveHandler&&e.responsiveHandler.destroy(),e.responsiveHandler=t}},{key:"unregisterHandler",value:function(e){e.responsiveHandler&&(e.responsiveHandler.destroy(),e.responsiveHandler=null)}}])&&BR(t.prototype,n),r&&BR(t,r),e}();function IR(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}!function(e,t,n){t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}(MR,"ResponsiveState",{NORMAL:"normal",CONDENSED:"condensed",COMPACT:"compact"}),E.addListener("prepare",(function(){$R||($R=O.create("ResponsiveManager")).init()}));var LR=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.widget=null,this.compactThreshold=-1,this.condensedThreshold=-1,this.oldState=MR.ResponsiveState.NORMAL,this.state=MR.ResponsiveState.NORMAL,this.allowedStates=[MR.ResponsiveState.NORMAL,MR.ResponsiveState.COMPACT],this.transformations=Pr.createMap(),this.enabledTransformations=Pr.createMap(),this._destroyHandler=this._onDestroy.bind(this)}var t,n,r;return t=e,(n=[{key:"init",value:function(e){s.a.extend(this,e),this.widget.one("destroy",this._destroyHandler)}},{key:"destroy",value:function(){this.widget.off("destroy",this._destroyHandler)}},{key:"getCompactThreshold",value:function(){return this.compactThreshold}},{key:"getCondensedThreshold",value:function(){return this.condensedThreshold}},{key:"active",value:function(){return!0}},{key:"setAllowedStates",value:function(e){this.allowedStates=e}},{key:"acceptState",value:function(e){return rt.containsAny(this.allowedStates,e)}},{key:"_registerTransformation",value:function(e,t){this.transformations[e]=t.bind(this)}},{key:"_enableTransformation",value:function(e,t){var n=this.enabledTransformations[e];n||(n=[],this.enabledTransformations[e]=n),n.push(t)}},{key:"_disableTransformation",value:function(e,t){rt.remove(this.enabledTransformations[e],t)}},{key:"_storeFieldProperty",value:function(e,t,n){e._setProperty("responsive-"+t,n)}},{key:"_hasFieldProperty",value:function(e,t){return e.hasOwnProperty("responsive-"+t)}},{key:"_getFieldProperty",value:function(e,t){return e["responsive-"+t]}},{key:"transform",value:function(e,t){return!(this.state===e&&!t||(this.oldState=this.state,this.state=e,this.oldState!==this.state?(n=this.enabledTransformations[this.oldState]||[],r=this.enabledTransformations[this.state]||[]):(n=[],this.state!==MR.ResponsiveState.NORMAL&&rt.pushAll(n,this.enabledTransformations[MR.ResponsiveState.NORMAL]),this.state!==MR.ResponsiveState.CONDENSED&&rt.pushAll(n,this.enabledTransformations[MR.ResponsiveState.CONDENSED]),this.state!==MR.ResponsiveState.COMPACT&&rt.pushAll(n,this.enabledTransformations[MR.ResponsiveState.COMPACT]),r=this.enabledTransformations[this.state]||[]),this._transformationsToApply=rt.diff(r,n),this._transformationsToReset=rt.diff(n,r),this._transform(),0));var n,r}},{key:"_transform",value:function(){this._transformWidget(this.widget)}},{key:"_transformWidget",value:function(e){var t=this;this._transformationsToApply.forEach((function(n){t.transformations[n](e,!0)})),this._transformationsToReset.forEach((function(n){t.transformations[n](e,!1)}))}},{key:"_onDestroy",value:function(e){this.destroy()}}])&&IR(t.prototype,n),r&&IR(t,r),e}();function HR(e){return(HR="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function NR(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function VR(e,t,n){return(VR="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=KR(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function WR(e,t){return(WR=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function zR(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=KR(e);if(t){var o=KR(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return GR(this,n)}}function GR(e,t){return!t||"object"!==HR(t)&&"function"!=typeof t?UR(e):t}function UR(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function KR(e){return(KR=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var qR=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&WR(e,t)}(i,e);var t,n,r,o=zR(i);function i(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(e=o.call(this))._initDefaults(),e.allowedStates=[MR.ResponsiveState.NORMAL,MR.ResponsiveState.CONDENSED,MR.ResponsiveState.COMPACT],e._formFieldAddedHandler=e._onFormFieldAdded.bind(UR(e)),e._compositeFields=[],e._htmlPropertyChangeHandler=e._onHtmlEnvironmentPropertyChange.bind(UR(e)),e}return t=i,(n=[{key:"_initDefaults",value:function(){this.compactThreshold=Xs.get().formColumnWidth}},{key:"_onHtmlEnvironmentPropertyChange",value:function(){this._initDefaults()}},{key:"init",value:function(e){var t=this;VR(KR(i.prototype),"init",this).call(this,e);var n=i.TransformationType,r=MR.ResponsiveState;this._registerTransformation(n.LABEL_POSITION_ON_FIELD,this._transformLabelPositionOnField),this._registerTransformation(n.LABEL_POSITION_ON_TOP,this._transformLabelPositionOnTop),this._registerTransformation(n.LABEL_VISIBILITY,this._transformLabelVisibility),this._registerTransformation(n.STATUS_POSITION_ON_TOP,this._transformStatusPosition),this._registerTransformation(n.STATUS_VISIBILITY,this._transformStatusVisibility),this._registerTransformation(n.VERTICAL_ALIGNMENT,this._transformVerticalAlignment),this._registerTransformation(n.GRID_COLUMN_COUNT,this._transformGridColumnCount),this._registerTransformation(n.HIDE_PLACE_HOLDER_FIELD,this._transformHidePlaceHolderField),this._registerTransformation(n.FIELD_SCALABLE,this._transformFieldScalable),this._enableTransformation(r.CONDENSED,n.LABEL_POSITION_ON_TOP),this._enableTransformation(r.CONDENSED,n.LABEL_VISIBILITY),this._enableTransformation(r.CONDENSED,n.VERTICAL_ALIGNMENT),this._enableTransformation(r.COMPACT,n.LABEL_POSITION_ON_TOP),this._enableTransformation(r.COMPACT,n.LABEL_VISIBILITY),this._enableTransformation(r.COMPACT,n.STATUS_POSITION_ON_TOP),this._enableTransformation(r.COMPACT,n.STATUS_VISIBILITY),this._enableTransformation(r.COMPACT,n.VERTICAL_ALIGNMENT),this._enableTransformation(r.COMPACT,n.GRID_COLUMN_COUNT),this._enableTransformation(r.COMPACT,n.HIDE_PLACE_HOLDER_FIELD),this._enableTransformation(r.COMPACT,n.FIELD_SCALABLE),Xs.get().on("propertyChange",this._htmlPropertyChangeHandler),this.widget.visitFields((function(e){e instanceof Iz&&(e.on("propertyChange",t._formFieldAddedHandler),t._compositeFields.push(e))}))}},{key:"destroy",value:function(){var e=this;VR(KR(i.prototype),"destroy",this).call(this),this._compositeFields.forEach((function(t){t.off("propertyChange",e._formFieldAddedHandler)})),Xs.get().off("propertyChange",this._htmlPropertyChangeHandler)}},{key:"active",value:function(){return this.widget.responsive}},{key:"getCondensedThreshold",value:function(){return this.condensedThreshold>0?this.condensedThreshold:this.widget.htmlComp.prefSize({widthOnly:!0}).width}},{key:"_transform",value:function(){this.widget.visitFields(this._transformWidget.bind(this))}},{key:"_transformWidget",value:function(e){if(e!==this.widget&&e instanceof gJ&&null!==e.responsive)return iU.SKIP_SUBTREE;var t;e instanceof ZW&&(e.htmlComp&&(e.htmlComp.suppressValidate=!0,(t=e.htmlComp.getParent())&&(t.suppressValidate=!0)),VR(KR(i.prototype),"_transformWidget",this).call(this,e),e.htmlComp&&(e.htmlComp.suppressValidate=!1),t&&(t.suppressValidate=!1))}},{key:"_transformLabelPositionOnField",value:function(e,t){e.parent instanceof d2||e instanceof Jq||e instanceof IZ||(t?(this._storeFieldProperty(e,"labelPosition",e.labelPosition),e.setLabelPosition(ZW.LabelPosition.ON_FIELD)):this._hasFieldProperty(e,"labelPosition")&&e.setLabelPosition(this._getFieldProperty(e,"labelPosition")))}},{key:"_transformLabelPositionOnTop",value:function(e,t){e.parent instanceof d2||e instanceof Jq||e instanceof IZ||e.labelPosition===ZW.LabelPosition.ON_FIELD||(t?(this._storeFieldProperty(e,"labelPosition",e.labelPosition),e.setLabelPosition(ZW.LabelPosition.TOP)):this._hasFieldProperty(e,"labelPosition")&&e.setLabelPosition(this._getFieldProperty(e,"labelPosition")))}},{key:"_transformLabelVisibility",value:function(e,t){e instanceof Jq&&(t?(this._storeFieldProperty(e,"labelVisible",e.labelVisible),e.setLabelVisible(!1)):this._hasFieldProperty(e,"labelVisible")&&e.setLabelVisible(this._getFieldProperty(e,"labelVisible")))}},{key:"getGridData",value:function(e){return new Ez(e.gridDataHints)}},{key:"setGridData",value:function(e,t){e.setGridDataHints(t)}},{key:"_transformStatusPosition",value:function(e,t){t?(this._storeFieldProperty(e,"statusPosition",e.statusPosition),e.setStatusPosition(ZW.StatusPosition.TOP)):this._hasFieldProperty(e,"statusPosition")&&e.setStatusPosition(this._getFieldProperty(e,"statusPosition"))}},{key:"_transformStatusVisibility",value:function(e,t){t?(this._storeFieldProperty(e,"statusVisible",e.statusVisible),e.setStatusVisible(!1)):this._hasFieldProperty(e,"statusVisible")&&e.setStatusVisible(this._getFieldProperty(e,"statusVisible"))}},{key:"_transformVerticalAlignment",value:function(e,t){var n=e instanceof JK&&e.displayStyle===JK.DisplayStyle.DEFAULT,r=e instanceof Jq,o=e.labelPosition===ZW.LabelPosition.ON_FIELD&&e.gridData&&1===e.gridData.h;if((n||r||o)&&e.gridData){var i=this.getGridData(e);t?(this._storeFieldProperty(e,"fillVertical",i.fillVertical),this._storeFieldProperty(e,"verticalAlignment",i.verticalAlignment),i.fillVertical=!1,i.verticalAlignment=1):(this._hasFieldProperty(e,"fillVertical")&&(i.fillVertical=this._getFieldProperty(e,"fillVertical")),this._hasFieldProperty(e,"verticalAlignment")&&(i.verticalAlignment=this._getFieldProperty(e,"verticalAlignment"))),this.setGridData(e,i)}}},{key:"_transformGridColumnCount",value:function(e,t){e instanceof gJ&&(t?(this._storeFieldProperty(e,"gridColumnCount",e.gridColumnCount),e.setGridColumnCount(1)):this._hasFieldProperty(e,"gridColumnCount")&&e.setGridColumnCount(this._getFieldProperty(e,"gridColumnCount")))}},{key:"_transformHidePlaceHolderField",value:function(e,t){e instanceof b0&&(t?(this._storeFieldProperty(e,"visible",e.visible),e.setVisible(!1)):this._hasFieldProperty(e,"visible")&&e.setVisible(this._getFieldProperty(e,"visible")))}},{key:"_transformFieldScalable",value:function(e,t){if(!(e.parent instanceof d2)){var n=this.getGridData(e);t&&0===n.weightX?(this._storeFieldProperty(e,"weightX",n.weightX),n.weightX=1):t||this._hasFieldProperty(e,"weightX")&&(n.weightX=this._getFieldProperty(e,"weightX")),this.setGridData(e,n)}}},{key:"_onFormFieldAdded",value:function(e){var t=this;this.state===MR.ResponsiveState.NORMAL||"fields"!==e.propertyName&&"tabItems"!==e.propertyName||rt.diff(e.newValue,e.oldValue).forEach((function(e){e.visitFields(t._transformWidget.bind(t))}))}}])&&NR(t.prototype,n),r&&NR(t,r),i}(LR);function YR(e){return(YR="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function XR(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function JR(e,t,n){return(JR="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=tx(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function ZR(e,t){return(ZR=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function QR(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=tx(e);if(t){var o=tx(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return ex(this,n)}}function ex(e,t){return!t||"object"!==YR(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function tx(e){return(tx=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}!function(e,t,n){t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}(qR,"TransformationType",{LABEL_POSITION_ON_FIELD:"labelPositionOnField",LABEL_POSITION_ON_TOP:"labelPositionOnTop",LABEL_VISIBILITY:"labelVisibility",STATUS_POSITION_ON_TOP:"statusPositionOnTop",STATUS_VISIBILITY:"statusVisibility",VERTICAL_ALIGNMENT:"verticalAlignment",GRID_COLUMN_COUNT:"gridColumnCount",HIDE_PLACE_HOLDER_FIELD:"hidePlaceHolderField",FIELD_SCALABLE:"fieldScalable"});var nx=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ZR(e,t)}(i,e);var t,n,r,o=QR(i);function i(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(e=o.call(this)).compactThreshold=500,e.allowedStates=[MR.ResponsiveState.NORMAL,MR.ResponsiveState.COMPACT],e}return t=i,(n=[{key:"init",value:function(e){JR(tx(i.prototype),"init",this).call(this,e),this._registerTransformation("navigationVisible",this._transformNavigationVisible),this._enableTransformation(MR.ResponsiveState.COMPACT,"navigationVisible")}},{key:"_transformNavigationVisible",value:function(e,t){t?(this._storeFieldProperty(e,"navigationVisible",e.navigationVisible),e.setNavigationVisible(!1)):this._hasFieldProperty(e,"navigationVisible")&&e.setNavigationVisible(this._getFieldProperty(e,"navigationVisible"))}}])&&XR(t.prototype,n),r&&XR(t,r),i}(LR);function rx(e){return(rx="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ox(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ix(e,t,n){return(ix="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=ux(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function sx(e,t){return(sx=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function ax(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=ux(e);if(t){var o=ux(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return lx(this,n)}}function lx(e,t){return!t||"object"!==rx(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function ux(e){return(ux=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var cx=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&sx(e,t)}(i,e);var t,n,r,o=ax(i);function i(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(e=o.call(this)).outline=null,e.nodes=null,e.tileOverviewTitle=null,e.scrollable=!0,e._addWidgetProperties(["pageTileGrid"]),e.$content=null,e.$title=null,e}return t=i,(n=[{key:"_init",value:function(e){ix(ux(i.prototype),"_init",this).call(this,e),this.pageTileGrid||(this.pageTileGrid=this._createPageTileGrid())}},{key:"_renderForm",value:function(){ix(ux(i.prototype),"_renderForm",this).call(this),this.htmlComp.setLayout(new El),this.$content=this.$container.appendDiv("tile-overview-content"),this.contentHtmlComp=ea.install(this.$content,this.session),this.contentHtmlComp.setLayout(new El({stretch:this.outline.compact})),this.$title=this.$content.appendDiv("tile-overview-title").text(this.tileOverviewTitle),ea.install(this.$title,this.session)}},{key:"_renderProperties",value:function(){ix(ux(i.prototype),"_renderProperties",this).call(this),this.pageTileGrid.rendered&&(this.pageTileGrid=this._createPageTileGrid()),this._renderPageTileGrid(),this._renderScrollable()}},{key:"_renderPageTileGrid",value:function(){this.pageTileGrid.render(this.$content)}},{key:"_createPageTileGrid",value:function(){return scout.create("PageTileGrid",{parent:this,outline:this.outline,nodes:this.nodes})}},{key:"setScrollable",value:function(e){this.setProperty("scrollable",e)}},{key:"_renderScrollable",value:function(){this.scrollable?this._installScrollbars({axis:"y"}):this._uninstallScrollbars()}},{key:"setPage",value:function(e){this.outline=e.getOutline(),this.nodes=e.childNodes,this.tileOverviewTitle=e.text,this.setScrollable(!this.outline.compact),this.pageTileGrid.setCompact(this.outline.compact),this.pageTileGrid.setOutline(this.outline),this.pageTileGrid.setPage(e),this.pageTileGrid.setNodes(this.nodes)}},{key:"_remove",value:function(){this.$content=null,this.$title=null,ix(ux(i.prototype),"_remove",this).call(this)}}])&&ox(t.prototype,n),r&&ox(t,r),i}(CC);function fx(e){return(fx="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function hx(e,t){return(hx=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function px(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=yx(e);if(t){var o=yx(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return dx(this,n)}}function dx(e,t){return!t||"object"!==fx(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function yx(e){return(yx=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var vx=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&hx(e,t)}(n,e);var t=px(n);function n(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),t.call(this)}return n}($C);function bx(e){return(bx="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function mx(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function gx(e,t,n){return(gx="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Ox(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function _x(e,t){return(_x=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function wx(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ox(e);if(t){var o=Ox(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return kx(this,n)}}function kx(e,t){return!t||"object"!==bx(t)&&"function"!=typeof t?Sx(e):t}function Sx(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Ox(e){return(Ox=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Tx(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Cx=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_x(e,t)}(i,e);var t,n,r,o=wx(i);function i(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(e=o.call(this)).autoResizeColumns=!1,e.columnAddable=!1,e.columnLayoutDirty=!1,e.columns=[],e.contextColumn=null,e.checkable=!1,e.checkableStyle=i.CheckableStyle.CHECKBOX,e.compact=!1,e.compactHandler=O.create("TableCompactHandler",{table:Sx(e)}),e.compactColumn=null,e.dropType=0,e.dropMaximumSize=rn.DEFAULT_DROP_MAXIMUM_SIZE,e.groupingStyle=i.GroupingStyle.BOTTOM,e.header=null,e.headerEnabled=!0,e.headerVisible=!0,e.headerMenusEnabled=!0,e.hasReloadHandler=!1,e.hierarchical=!1,e.hierarchicalStyle=i.HierarchicalStyle.DEFAULT,e.keyStrokes=[],e.menus=[],e.menuBar=null,e.menuBarVisible=!0,e.contextMenu=null,e.multiCheck=!0,e.multiSelect=!0,e.multilineText=!1,e.scrollToSelection=!1,e.scrollTop=0,e.selectedRows=[],e.sortEnabled=!0,e.tableControls=[],e.tableStatusVisible=!1,e.tableTileGridMediator=null,e.tileMode=!1,e.tileTableHeader=null,e.footer=null,e.footerVisible=!1,e.filters=[],e.rows=[],e.rootRows=[],e.visibleRows=[],e.estimatedRowCount=0,e.maxRowCount=0,e.truncatedCellTooltipEnabled=null,e.visibleRowsMap={},e.rowLevelPadding=0,e.rowsMap={},e.rowHeight=0,e.rowWidth=0,e.rowBorderWidth=0,e.rowBorderLeftWidth=0,e.rowBorderRightWidth=0,e.rowIconVisible=!1,e.rowIconColumnWidth=qA.NARROW_MIN_WIDTH,e.staticMenus=[],e.selectionHandler=new FD(Sx(e)),e.tooltips=[],e._filterMap={},e._filteredRows=[],e.tableNodeColumn=null,e._maxLevel=0,e._aggregateRows=[],e._animationRowLimit=25,e._blockLoadThreshold=25,e.updateBuffer=new CA(Sx(e)),e.viewRangeSize=10,e.viewRangeDirty=!1,e.viewRangeRendered=new Fr(0,0),e.virtual=!0,e._doubleClickSupport=new Yt,e._permanentHeadSortColumns=[],e._permanentTailSortColumns=[],e._filterMenusHandler=e._filterMenus.bind(Sx(e)),e._popupOpenHandler=e._onDesktopPopupOpen.bind(Sx(e)),e._rerenderViewPortAfterAttach=!1,e._renderViewPortAfterAttach=!1,e._desktopPropertyChangeHandler=e._onDesktopPropertyChange.bind(Sx(e)),e._addWidgetProperties(["tableControls","menus","keyStrokes","staticMenus","tileTableHeader","tableTileGridMediator"]),e.$data=null,e.$emptyData=null,e.$fillBefore=null,e.$fillAfter=null,e}return t=i,r=[{key:"parseHorizontalAlignment",value:function(e){return e>0?"right":0===e?"center":"left"}},{key:"linkRowToDiv",value:function(e,t){e&&(e.$row=t),t&&t.data("row",e)}}],(n=[{key:"_init",value:function(e){gx(Ox(i.prototype),"_init",this).call(this,e),this.resolveConsts([{property:"hierarchicalStyle",constType:i.HierarchicalStyle},{property:"checkableStyle",constType:i.CheckableStyle},{property:"groupingStyle",constType:i.GroupingStyle}]),this._initColumns(),this.rows.forEach((function(e,t){this.rows[t]=this._initRow(e)}),this),this.setFilters(this.filters),this._updateRowStructure({updateTree:!0}),this.menuBar=this._createMenuBar(),this._setSelectedRows(this.selectedRows),this._setKeyStrokes(this.keyStrokes),this._setMenus(this.menus),this._setTableControls(this.tableControls),this._setTableStatus(this.tableStatus),this._calculateValuesForBackgroundEffect(),this._group(),this._setTileMode(this.tileMode),this._setTileTableHeader(this.tileTableHeader)}},{key:"_initRow",value:function(e){return e instanceof Ix||(e.parent=this,e=O.create("TableRow",e)),this.rowsMap[e.id]=e,this.trigger("rowInit",{row:e}),e}},{key:"_initColumns",value:function(){this.columns=this.columns.map((function(e,t){var n=e;return n.session=this.session,n instanceof qA?n._setTable(this):(n.table=this,n=O.create(n)),n.index<0&&(n.index=t),n.checkable&&(this.checkableColumn=n),n}),this),this._setCheckable(this.checkable),this.rowIconVisible&&this._insertRowIconColumn(),this._setCompact(this.compact),this._calculateTableNodeColumn(),this._setHeadAndTailSortColumns(),this.columnLayoutDirty=!0}},{key:"_destroy",value:function(){this._destroyColumns(),gx(Ox(i.prototype),"_destroy",this).call(this)}},{key:"_destroyColumns",value:function(){this.columns.forEach((function(e){e.destroy()})),this.checkableColumn=null,this.compactColumn=null,this.rowIconColumn=null,this.columns=[]}},{key:"_calculateTableNodeColumn",value:function(){var e=this.visibleColumns().filter((function(e){return e.nodeColumnCandidate})),t=rt.first(e);this.tableNodeColumn&&this.tableNodeColumn!==t&&(this.tableNodeColumn.minWidth=this.tableNodeColumn._initialMinWidth),this.tableNodeColumn=t,this.tableNodeColumn&&(this.tableNodeColumn._initialMinWidth=this.tableNodeColumn.minWidth,this.tableNodeColumn.minWidth=this.rowLevelPadding*this._maxLevel+this.tableNodeColumn.tableNodeLevel0CellPadding+8,this.tableNodeColumn.minWidth>this.tableNodeColumn.width&&(this._isDataRendered()?this.resizeColumn(this.tableNodeColumn,this.tableNodeColumn.minWidth):this.tableNodeColumn.width=this.tableNodeColumn.minWidth))}},{key:"_createLoadingSupport",value:function(){var e=this;return new oe({widget:this,$container:function(){return e.$container.hasClass("knight-rider-loading")?e.$container:e.$data}})}},{key:"_createKeyStrokeContext",value:function(){return new $u}},{key:"_initKeyStrokeContext",value:function(){gx(Ox(i.prototype),"_initKeyStrokeContext",this).call(this),this._initTableKeyStrokeContext()}},{key:"_initTableKeyStrokeContext",value:function(){this.keyStrokeContext.registerKeyStroke([new LM(this),new KM(this),new bI(this),new TI(this),new tI(this),new uI(this),new VB(this),new JB(this),new AI(this),new dM(this),new iM(this),new SM(this),new DM(this),new FB(this),new ic(this,this.showContextMenu,this),new FW(this,this.handleAppLinkAction)])}},{key:"_insertBooleanColumn",value:function(){if(this.checkableStyle!==i.CheckableStyle.TABLE_ROW){var e=O.create("BooleanColumn",{session:this.session,fixedWidth:!0,fixedPosition:!0,guiOnly:!0,nodeColumnCandidate:!1,headerMenuEnabled:!1,showSeparator:!1,width:qA.NARROW_MIN_WIDTH,table:this});rt.insert(this.columns,e,0),this.checkableColumn=e}}},{key:"_insertRowIconColumn",value:function(){var e=0,t=O.create("IconColumn",{session:this.session,fixedWidth:!0,fixedPosition:!0,guiOnly:!0,nodeColumnCandidate:!1,headerMenuEnabled:!1,showSeparator:!1,width:this.rowIconColumnWidth,table:this});this.columns[0]===this.checkableColumn&&(e=1),rt.insert(this.columns,t,e),this.rowIconColumn=t}},{key:"handleAppLinkAction",value:function(e){var t=s()(e.target),n=this._columnAtX(t.offset().left),r=t.findUp((function(e){return e.hasClass("table-row")}),this.$container).data("row");this._triggerAppLinkAction(n,r,t.data("ref"),t)}},{key:"_isDataRendered",value:function(){return this.rendered&&null!==this.$data}},{key:"_render",value:function(){this.$container=this.$parent.appendDiv("table").addDeviceClass(),this.htmlComp=ea.install(this.$container,this.session),this.htmlComp.setLayout(new DD(this)),this.uiCssClass&&this.$container.addClass(this.uiCssClass),this.tileMode?this._renderTileMode():this._renderData(),this.session.desktop.on("popupOpen",this._popupOpenHandler),this.session.desktop.on("propertyChange",this._desktopPropertyChangeHandler)}},{key:"_renderData",value:function(){this.$data=this.$container.appendDiv("table-data"),this.$data.on("mousedown",".table-row",this._onRowMouseDown.bind(this)).on("mouseup",".table-row",this._onRowMouseUp.bind(this)).on("dblclick",".table-row",this._onRowDoubleClick.bind(this)).on("contextmenu",(function(e){e.preventDefault()})),this._installScrollbars({axis:"both"}),this._installImageListeners(),this._installCellTooltipSupport(),this._calculateRowBorderWidth(),this._updateRowWidth(),this._updateRowHeight(),this._renderViewport(),this.scrollToSelection&&this.revealSelection()}},{key:"_renderProperties",value:function(){gx(Ox(i.prototype),"_renderProperties",this).call(this),this._renderTableHeader(),this._renderMenuBarVisible(),this._renderFooterVisible(),this._renderCheckableStyle(),this._renderHierarchicalStyle()}},{key:"_setCssClass",value:function(e){gx(Ox(i.prototype),"_setCssClass",this).call(this,e);var t=["table-row-level-padding"];this.cssClass&&t.push(this.cssClass),this.setRowLevelPadding(To.getSize(t.reduce((function(e,t){return e+" "+t}),""),"width","width",15))}},{key:"_removeData",value:function(){this._destroyCellEditorPopup(),this._removeAggregateRows(),this._uninstallImageListeners(),this._uninstallCellTooltipSupport(),this._uninstallScrollbars(),this._removeRows(),this.$fillBefore=null,this.$fillAfter=null,this.$data.remove(),this.$data=null,this.$emptyData=null}},{key:"_remove",value:function(){this.session.desktop.off("propertyChange",this._desktopPropertyChangeHandler),this.session.desktop.off("popupOpen",this._popupOpenHandler),this._uninstallDragAndDropHandler(),this.header=null,this.$data&&this._removeData(),gx(Ox(i.prototype),"_remove",this).call(this)}},{key:"setRowLevelPadding",value:function(e){this.setProperty("rowLevelPadding",e)}},{key:"_renderRowLevelPadding",value:function(){this._rerenderViewport()}},{key:"setTableControls",value:function(e){this.setProperty("tableControls",e)}},{key:"_renderTableControls",value:function(){this.footer&&this.footer._renderControls()}},{key:"_setTableControls",value:function(e){var t;for(t=0;t<this.tableControls.length;t++)this.keyStrokeContext.unregisterKeyStroke(this.tableControls[t]);for(this._setProperty("tableControls",e),t=0;t<this.tableControls.length;t++)this.keyStrokeContext.registerKeyStroke(this.tableControls[t]);this._updateFooterVisibility(),this.tableControls.forEach((function(e){e.tableFooter=this.footer}),this)}},{key:"_onImageLoadOrError",value:function(e){var t=s()(e.target);if("in-progress"!==t.data("measure")){var n=t.closest(".table-row"),r=n.data("row");if(r){var o=r.height;r.height=n.outerHeight(!0),o!==r.height&&this.invalidateLayoutTree()}}}},{key:"_onRowMouseDown",value:function(e){var t=this;this._doubleClickSupport.mousedown(e),this._$mouseDownRow=s()(e.currentTarget),this._mouseDownRowId=this._$mouseDownRow.data("row").id,this._mouseDownColumn=this._columnAtX(e.pageX),this._$mouseDownRow.window().one("mouseup",(function(){t._$mouseDownRow=null,t._mouseDownRowId=null,t._mouseDownColumn=null})),this.setContextColumn(this._columnAtX(e.pageX)),this.selectionHandler.onMouseDown(e);var n=3===e.which,r=this._$mouseDownRow.data("row"),o=s()(e.target);if(this._isRowControl(o)&&(r.expanded?this.collapseRow(r):this.expandRow(r)),!O.isOneOf(this.checkableStyle,i.CheckableStyle.TABLE_ROW,i.CheckableStyle.CHECKBOX_TABLE_ROW)||n&&r.checked||s()(e.target).is(".table-row-control")||o.hasClass("checkable")||o.parent().hasClass("checkable")||this.checkRow(r,!r.checked),n)return this.showContextMenu({pageX:e.pageX,pageY:e.pageY}),!1}},{key:"_isRowControl",value:function(e){return e.hasClass("table-row-control")||e.parent().hasClass("table-row-control")}},{key:"_onRowMouseUp",value:function(e){var t,n,r,o,i=e.which;if(!this._doubleClickSupport.doubleClicked()&&(n=s()(e.currentTarget),this.selectionHandler.onMouseUp(e,n),this._$mouseDownRow&&this._mouseDownRowId===n.data("row").id&&(t=n,(r=this._columnAtX(e.pageX))===this._mouseDownColumn))){var a=s()(e.target);if(!this._isRowControl(a)){1===i&&(r.onMouseUp(e,t),o=this._find$AppLink(e));var l=t.data("row");o?this._triggerAppLinkAction(r,l,o.data("ref"),o):this._triggerRowClick(l,i)}}}},{key:"_onRowDoubleClick",value:function(e){var t=s()(e.currentTarget),n=this._columnAtX(e.pageX);this.doRowAction(t.data("row"),n)}},{key:"showContextMenu",value:function(e){this.session.onRequestsDone(this._showContextMenu.bind(this,e))}},{key:"_showContextMenu",value:function(e){if(e=e||{},this._isDataRendered()&&this.attached&&0!==this.selectedRows.length){var t=this._filterMenusForContextMenu();if(0!==t.length){var n=O.nvl(e.pageX,null),r=O.nvl(e.pageY,null);if(null===n||null===r){var o=this.isRowSelectedAndVisible(this.selectionHandler.lastActionRow)?this.selectionHandler.lastActionRow:this.getLastSelectedAndVisibleRow();if(null!==o){var i=o.$row,s=i.offset(),a=qs.offsetBounds(this.$data);s.left+=this.$data.scrollLeft(),n=s.left+10,r=s.top+i.outerHeight()/2,r=Math.min(Math.max(r,a.y+1),a.bottom()-1)}else n=this.$data.offset().left+10,r=this.$data.offset().top+10}this.contextMenu&&this.contextMenu.close(),this.contextMenu=O.create("ContextMenuPopup",{parent:this,menuItems:t,location:{x:n,y:r},$anchor:this.$data,menuFilter:this._filterMenusHandler}),this.contextMenu.open()}}}},{key:"isRowSelectedAndVisible",value:function(e){return!(!this.isRowSelected(e)||!e.$row)&&qs.offsetBounds(e.$row).intersects(qs.offsetBounds(this.$data))}},{key:"getLastSelectedAndVisibleRow",value:function(){for(var e=this.viewRangeRendered.to;e>=this.viewRangeRendered.from;e--)if(this.isRowSelectedAndVisible(this.rows[e]))return this.rows[e];return null}},{key:"onColumnVisibilityChanged",value:function(){this.columnLayoutDirty=!0,this._calculateTableNodeColumn(),this.trigger("columnStructureChanged"),this._isDataRendered()&&(this._updateRowWidth(),this._redraw(),this.invalidateLayoutTree())}},{key:"_onScroll",value:function(){var e=this.$data[0].scrollTop,t=this.$data[0].scrollLeft;this.scrollTop!==e&&this._renderViewport(),this.scrollTop=e,this.scrollLeft=t}},{key:"_renderTableStatus",value:function(){this.trigger("statusChanged")}},{key:"setContextColumn",value:function(e){this.setProperty("contextColumn",e)}},{key:"_hasVisibleTableControls",value:function(){return this.tableControls.some((function(e){return e.visible}))}},{key:"hasAggregateTableControl",value:function(){return this.tableControls.some((function(e){return e instanceof Z$}))}},{key:"_createHeader",value:function(){return O.create("TableHeader",{parent:this,table:this,enabled:this.headerEnabled,headerMenusEnabled:this.headerMenusEnabled})}},{key:"_createFooter",value:function(){return O.create("TableFooter",{parent:this,table:this})}},{key:"_installCellTooltipSupport",value:function(){xp.install(this.$data,{parent:this,selector:".table-cell",text:this._cellTooltipText.bind(this),htmlEnabled:this._isAggregatedTooltip.bind(this),arrowPosition:50,arrowPositionUnit:"%",nativeTooltip:!Kt.get().isCustomEllipsisTooltipPossible()})}},{key:"_uninstallCellTooltipSupport",value:function(){xp.uninstall(this.$data)}},{key:"_cellTooltipText",value:function(e){var t,n=e.parent(),r=this.columnFor$Cell(e,n),o=n.data("row");return o&&(t=this.cell(r,o).tooltipText),t||(n.data("aggregateRow")&&e.text().trim()&&(e.isContentTruncated()||e.children(".table-cell-icon").length&&!e.children(".table-cell-icon").isVisible())?((e=e.clone()).children(".table-cell-icon").setVisible(!0),e.html()):this._isTruncatedCellTooltipEnabled(r)&&e.isContentTruncated()?Wn.plainText(e.html(),{trim:!0}):void 0)}},{key:"setTruncatedCellTooltipEnabled",value:function(e){this.setProperty("truncatedCellTooltipEnabled",e)}},{key:"_isTruncatedCellTooltipEnabled",value:function(e){return null===this.truncatedCellTooltipEnabled?!this.headerVisible||!this.headerEnabled||e.fixedWidth:this.truncatedCellTooltipEnabled}},{key:"_isAggregatedTooltip",value:function(e){if(e.parent().data("aggregateRow"))return!0}},{key:"reload",value:function(e){this.hasReloadHandler&&(this._removeRows(),this._isDataRendered()&&(this._removeAggregateRows(),this._renderFiller()),this._triggerReload(e))}},{key:"setLoading",value:function(e){!e&&this.updateBuffer.isBuffering()||gx(Ox(i.prototype),"setLoading",this).call(this,e)}},{key:"exportToClipboard",value:function(){this._triggerClipboardExport()}},{key:"_exportToClipboard",value:function(){ct.copyText({parent:this,text:this._selectedRowsToText()})}},{key:"_selectedRowsToText",value:function(){var e=this,t=this.visibleColumns();return this.selectedRows.map((function(n){return t.map((function(t){var r,o=t.cell(n);return r=t instanceof mF?o.value?"X":"":o.htmlEnabled?Wn.plainText(o.text):o.text,e._unwrapText(r)})).join("\t")})).join("\n")}},{key:"_unwrapText",value:function(e){return Wn.nvl(e).split(/[\n\r]/).map((function(e){return e.replace(/\t/g," ")})).map((function(e){return e.trim()})).filter((function(e){return!!e.length})).join(" ")}},{key:"setMultiSelect",value:function(e){this.setProperty("multiSelect",e)}},{key:"toggleSelection",value:function(){this.selectedRows.length===this.visibleRows.length?this.deselectAll():this.selectAll()}},{key:"selectAll",value:function(){this.selectRows(this.visibleRows)}},{key:"deselectAll",value:function(){this.selectRows([])}},{key:"checkAll",value:function(e,t){var n=s.a.extend(t,{checked:e});this.checkRows(this.visibleRows,n)}},{key:"uncheckAll",value:function(e){this.checkAll(!1,e)}},{key:"updateScrollbars",value:function(){Lh.update(this.$data)}},{key:"_sort",value:function(e){var t=this._sortColumns();return!!this._isSortingPossible(t)&&(this.clearAggregateRows(e),!t.length||(t=rt.union(t,this.columns),this._sortImpl(t),this._triggerRowOrderChanged(),this._isDataRendered()&&this._renderRowOrderChanges(),this._group(e),!0))}},{key:"_isSortingPossible",value:function(e){return e.every((function(e){return e.isSortingPossible()}))}},{key:"_sortColumns",value:function(){for(var e=[],t=0;t<this.columns.length;t++){var n=this.columns[t],r=n.sortIndex;r>=0&&(e[r]=n)}return e}},{key:"_sortImpl",value:function(e){var t=function(t,n){for(var r=0;r<e.length;r++){var o=e[r],i=o.compare(t,n);if(o.sortActive&&!o.sortAscending&&(i=-i),0!==i)return i}return 0};if(this.hierarchical){this._sortHierarchical(t);var n=[];this.visitRows((function(e){n.push(e)})),this.rows=n}else this.rows.sort(t),this.rootRows=this.rows;this._updateRowStructure({filteredRows:!0,applyFilters:!1,visibleRows:!0})}},{key:"visitRows",value:function(e,t,n){n=O.nvl(n,0),(t=t||this.rootRows).forEach((function(t){e(t,n),this.visitRows(e,t.childRows,n+1)}),this)}},{key:"_sortHierarchical",value:function(e,t){(t=t||this.rootRows).sort(e),t.forEach((function(t){this._sortHierarchical(e,t.childRows)}),this)}},{key:"_renderRowOrderChanges",value:function(){var e,t=this,n=this.$rows(),r={};n.length===this.visibleRows.length&&n.each((function(n,o){var i=!1,a=s()(o),l=a.data("row");if(t._insertedRows)for(var u=0;u<t._insertedRows.length;u++)if(t._insertedRows[u].id===l.id){i=!0;break}i||(e=!0,r[l.id]=a.offset().top)})),this._rerenderViewport(),this._order$AggregateRows(),this.scrollToSelection&&this.revealSelection(),e&&(n=this.$rows()).each((function(e,n){var o=s()(n),i=o.data("row"),a=r[i.id];void 0!==a&&o.css("top",a-o.offset().top).animate({top:0},{progress:function(){this._triggerRowOrderChanged(i,!0),this.updateScrollbars()}.bind(t)})}))}},{key:"setSortEnabled",value:function(e){this.setProperty("sortEnabled",e)}},{key:"sort",value:function(e,t,n,r){var o,i,s;s=!(n=O.nvl(n,!1)),(r=O.nvl(r,!1))?this._removeSortColumn(e):this._addSortColumn(e,t,n),this.header&&this.header.onSortingChanged(),i=this._sort(s),o={column:e,sortAscending:e.sortAscending},r&&(o.sortingRemoved=!0),n&&(o.multiSort=!0),i||(o.sortingRequested=!0,this._animateAggregateRows=s),this.trigger("sort",o)}},{key:"_addSortColumn",value:function(e,t,n){var r;t=O.nvl(t,e.sortAscending?"asc":"desc"),n=O.nvl(n,!0),this._updateSortIndexForColumn(e,n),n||(r=this._groupedColumns().length,1===this._sortColumns().length&&1===r||(e.grouped=!1)),e.sortAscending="asc"===t,e.sortActive=!0}},{key:"_updateSortIndexForColumn",value:function(e,t){var n,r=this,o=-1;t?e.sortActive&&-1!==e.sortIndex||(o=Math.max(-1,rt.max(this.columns.map((function(e){return void 0===e.sortIndex||e.initialAlwaysIncludeSortAtEnd?-1:e.sortIndex})))),e.sortIndex=o+1,this._permanentTailSortColumns.forEach((function(e){e.sortIndex++}))):(e.initialAlwaysIncludeSortAtBegin||e.initialAlwaysIncludeSortAtEnd||(e.sortIndex=this._permanentHeadSortColumns.length),rt.eachSibling(this.columns,e,(function(e){e.sortActive&&r._removeSortColumnInternal(e)})),n=e.initialAlwaysIncludeSortAtBegin||e.initialAlwaysIncludeSortAtEnd?0:1,this._permanentTailSortColumns.forEach((function(e,t){e.sortIndex=this._permanentHeadSortColumns.length+n+t}),this))}},{key:"_removeSortColumn",value:function(e){e.initialAlwaysIncludeSortAtBegin||e.initialAlwaysIncludeSortAtEnd||(rt.eachSibling(this.columns,e,(function(t){t.sortIndex>e.sortIndex&&(t.sortIndex=t.sortIndex-1)})),this._removeSortColumnInternal(e))}},{key:"_removeSortColumnInternal",value:function(e){e.initialAlwaysIncludeSortAtBegin||e.initialAlwaysIncludeSortAtEnd||(e.sortActive=!1,e.grouped=!1,e.sortIndex=-1)}},{key:"isGroupingPossible",value:function(e){var t=!0;return!this.hierarchical&&!!this.sortEnabled&&(!(!this._permanentHeadSortColumns||0!==this._permanentHeadSortColumns.length)||(e.initialAlwaysIncludeSortAtBegin?(t=!0,rt.eachSibling(this._permanentHeadSortColumns,e,(function(n){n.sortIndex<e.sortIndex&&(t=t&&n.grouped)})),t):!e.initialAlwaysIncludeSortAtEnd&&(this._permanentHeadSortColumns.forEach((function(e){t=t&&e.grouped})),t)))}},{key:"isAggregationPossible",value:function(e){return e instanceof r$&&!e.grouped&&!(!e.allowedAggregationFunctions||e.allowedAggregationFunctions.length<=1)&&(this.isGrouped()||this.hasAggregateTableControl())}},{key:"changeAggregation",value:function(e,t){this.changeAggregations([e],[t])}},{key:"changeAggregations",value:function(e,t){e.forEach((function(e,n){var r=t[n];e.aggregationFunction!==r&&(e.setAggregationFunction(r),this._triggerAggregationFunctionChanged(e))}),this),this._group()}},{key:"_addGroupColumn",value:function(e,t,n){var r=-1;this.isGroupingPossible(e)&&(t=O.nvl(t,e.sortAscending?"asc":"desc"),n=O.nvl(n,!0),e.initialAlwaysIncludeSortAtBegin||e.initialAlwaysIncludeSortAtEnd?e.initialAlwaysIncludeSortAtBegin&&(e.grouped=!0):(n?(r=Math.max(-1,rt.max(this.columns.map((function(e){return void 0===e.sortIndex||e.initialAlwaysIncludeSortAtEnd||!e.grouped?-1:e.sortIndex})))),e.sortActive?(rt.eachSibling(this.columns,e,(function(t){t.sortActive&&!t.initialAlwaysIncludeSortAtBegin&&!t.initialAlwaysIncludeSortAtEnd&&t.sortIndex>r&&t.sortIndex<e.sortIndex&&t.sortIndex++})),e.sortIndex=r+1):(e.sortIndex=r+1,rt.eachSibling(this.columns,e,(function(e){e.sortActive&&!e.initialAlwaysIncludeSortAtBegin&&!e.initialAlwaysIncludeSortAtEnd&&e.sortIndex>r&&e.sortIndex++})),this._permanentTailSortColumns.forEach((function(e){e.sortIndex++})))):(r=this._permanentHeadSortColumns.length,e.sortActive?(rt.eachSibling(this.columns,e,(function(t){t.sortActive&&!t.initialAlwaysIncludeSortAtBegin&&!t.initialAlwaysIncludeSortAtEnd&&t.sortIndex>=r&&t.sortIndex<e.sortIndex&&t.sortIndex++})),e.sortIndex=r):(rt.eachSibling(this.columns,e,(function(e){e.sortActive&&!e.initialAlwaysIncludeSortAtBegin&&!e.initialAlwaysIncludeSortAtEnd&&e.sortIndex>=r&&e.sortIndex++})),e.sortIndex=r,this._permanentTailSortColumns.forEach((function(e){e.sortIndex++}))),rt.eachSibling(this.columns,e,(function(e){e.sortActive&&!e.initialAlwaysIncludeSortAtBegin&&!e.initialAlwaysIncludeSortAtEnd&&e.sortIndex>=r&&(e.grouped=!1)}))),e.sortAscending="asc"===t,e.sortActive=!0),e.grouped=!0)}},{key:"_removeGroupColumn",value:function(e){e.grouped=!1,e.initialAlwaysIncludeSortAtBegin&&this.columns.forEach((function(t){t.sortIndex>=e.sortIndex&&(t.grouped=!1)})),this._removeSortColumn(e)}},{key:"_buildRowDiv",value:function(e){var t=this.rowWidth,n="table-row";e.cssClass&&(n+=" "+e.cssClass),e.enabled||(n+=" disabled"),e.checked&&this.checkableStyle===i.CheckableStyle.TABLE_ROW&&(n+=" checked"),e.filterAccepted||(n+=" filter-not-accepted"),rt.empty(e.childRows)&&(n+=" leaf");var r,o,s='<div class="'+n+'" style="width: '+t+'px">';for(r=0;r<this.columns.length;r++)(o=this.columns[r]).isVisible()&&(s+=o.buildCellForRow(e));return s+="</div>"}},{key:"_calculateRowBorderWidth",value:function(){var e=this.$data.appendDiv("table-row");this.rowBorderLeftWidth=e.cssBorderLeftWidth(),this.rowBorderRightWidth=e.cssBorderRightWidth(),this.rowBorderWidth=this.rowBorderLeftWidth+this.rowBorderRightWidth,e.remove()}},{key:"_updateRowWidth",value:function(){var e=this;this.rowWidth=this.visibleColumns().reduce((function(t,n){return e.autoResizeColumns?t+n.width:t+n._realWidthIfAvailable()}),this.rowBorderWidth)}},{key:"_updateRealColumnWidths",value:function(e){if(!Kt.get().hasTableCellZoomBug())return!1;var t=!1;return e=e||this.$rows().eq(0),this.visibleColumns().forEach((function(n,r){this._updateRealColumnWidth(n,r,e)&&(t=!0)}),this),t}},{key:"_updateRealColumnWidth",value:function(e,t,n){if(!Kt.get().hasTableCellZoomBug())return!1;n=n||this.$rows().eq(0);var r=this.$cell(O.nvl(t,e),n);if(0===r.length&&null!==e._realWidth)return e._realWidth=null,!0;var o=qs.size(r,{exact:!0}).width;return o!==e._realWidth&&(e._realWidth=o,!0)}},{key:"_updateRowHeight",value:function(){var e=this.$data.appendDiv("table-row"),t=this.$data.appendDiv("table-aggregate-row");e.appendDiv("table-cell").html("&nbsp;"),t.appendDiv("table-cell").html("&nbsp;"),this.rowHeight=e.outerHeight(!0),this.aggregateRowHeight=t.outerHeight(!0),e.remove(),t.remove()}},{key:"_updateRowHeights",value:function(){this.rows.forEach((function(e){e.$row?e.height=e.$row.outerHeight(!0):e.height=null})),this._aggregateRows.forEach((function(e){e.$row?e.height=e.$row.outerHeight(!0):e.height=null}))}},{key:"_renderRowsInRange",value:function(e){var t,n=this,r="",o=0,a=!1,l=this.visibleRows;if(0!==l.length){var u=new Fr(0,this.rows.length);if(e=u.intersect(e),this.viewRangeRendered.size()>0&&!e.intersect(this.viewRangeRendered).equals(new Fr(0,0)))throw new Error("New range must not intersect with existing.");e.to<=this.viewRangeRendered.from&&(a=!0);var c=this.viewRangeRendered.union(e);if(2===c.length)throw new Error("Can only prepend or append rows to the existing range. Existing: "+this.viewRangeRendered+". New: "+c);this.viewRangeRendered=c[0],this._removeEmptyData();for(var f=e.from;f<e.to;f++){var h=l[f];r+=this._buildRowDiv(h),o++}t=this.$data.makeElement(r),(t=a?this.$fillBefore?t.insertAfter(this.$fillBefore):t.prependTo(this.$data):this.$fillAfter?t.insertBefore(this.$fillAfter):t.appendTo(this.$data)).each((function(t,r){var a=s()(r);n.viewRangeRendered.size()===o&&n._updateRealColumnWidths(a)&&(n._updateRowWidth(),n.header&&n.header.rendered&&n.header.resizeHeaderItems()),a.cssWidth(n.rowWidth);var u=l[e.from+t];i.linkRowToDiv(u,a),n._installRow(u)})),s.a.log.isTraceEnabled()&&(s.a.log.trace(o+" new rows rendered from "+e),s.a.log.trace(this._rowsRenderedInfo()))}}},{key:"_rowsRenderedInfo",value:function(){return this.$rows().length+" rows rendered ("+this.viewRangeRendered+")"}},{key:"moveRowToTop",value:function(e){var t=this.rows.indexOf(e);this.moveRow(t,0)}},{key:"moveRowToBottom",value:function(e){var t=this.rows.indexOf(e);this.moveRow(t,this.rows.length-1)}},{key:"moveRowUp",value:function(e){var t=this.rows.indexOf(e),n=t-1;if(this.hierarchical){var r=this.rows.filter((function(t){return e.parentRow===t.parentRow}),this),o=r.indexOf(e),i=r[o-1];n=i?this.rows.indexOf(i):0}this.moveRow(t,n)}},{key:"moveRowDown",value:function(e){var t=this.rows.indexOf(e),n=t+1;if(this.hierarchical){var r=this.rows.filter((function(t){return e.parentRow===t.parentRow}),this),o=r.indexOf(e),i=r[o+1];n=i?this.rows.indexOf(i):this.rows.length}this.moveRow(t,n)}},{key:"moveVisibleRowUp",value:function(e){var t,n,r=this.rows.indexOf(e),o=this.visibleRows.indexOf(e);if(this.hierarchical){var i=this.visibleRows.filter((function(t){return e.parentRow===t.parentRow}),this);if(!(t=i[i.indexOf(e)-1]))return;n=this.rows.indexOf(t)}else{if(!(t=this.visibleRows[o-1]))return;n=this.rows.indexOf(t)}this.moveRow(r,n)}},{key:"moveVisibleRowDown",value:function(e){var t,n,r=this.rows.indexOf(e),o=this.visibleRows.indexOf(e);if(this.hierarchical){var i=this.visibleRows.filter((function(t){return e.parentRow===t.parentRow}),this);if(!(t=i[i.indexOf(e)+1]))return;n=this.rows.indexOf(t)}else{if(!(t=this.visibleRows[o+1]))return;n=this.rows.indexOf(t)}this.moveRow(r,n)}},{key:"moveRow",value:function(e,t){var n=this.rows.length;e=Math.max(e,0),e=Math.min(e,n-1),t=Math.max(t,0),e!==(t=Math.min(t,n-1))&&(rt.move(this.rows,e,t),this.updateRowOrder(this.rows))}},{key:"_removeRowsInRange",value:function(e){var t,n,r=0,o=this.visibleRows;e=new Fr(0,o.length).intersect(e);var i=this.viewRangeRendered.subtract(e);if(2===i.length)throw new Error("Can only remove rows at the beginning or end of the existing range. "+this.viewRangeRendered+". New: "+i);for(this.viewRangeRendered=i[0],n=e.from;n<e.to;n++)t=o[n],this._removeRow(t),r++;s.a.log.isTraceEnabled()&&(s.a.log.trace(r+" rows removed from "+e+"."),s.a.log.trace(this._rowsRenderedInfo()))}},{key:"removeAllRows",value:function(){var e=this;this._isDataRendered()&&this.$rows().each((function(t,n){var r=s()(n),o=r.data("row");r.hasClass("hiding")||e._removeRow(o)})),this.viewRangeRendered=new Fr(0,0)}},{key:"_removeRows",value:function(e){var t=this;if(e){var n=this.isAttachedAndRendered();(e=rt.ensure(e)).forEach((function(e){var r=t.visibleRows.indexOf(e);if(-1!==r){var o=Boolean(e.$row),i=t.viewRangeRendered.contains(r);if(n){if(!o&&i)throw new Error("Inconsistency found while removing row. Row is undefined but inside rendered view range. RowIndex: "+r);if(o&&!i)throw new Error("Inconsistency found while removing row. Row is rendered but not inside rendered view range. RowIndex: "+r)}t._removeRow(e),(i||r<t.viewRangeRendered.from)&&(r<t.viewRangeRendered.from?(t.viewRangeRendered.from--,t.viewRangeRendered.to--):r<=t.viewRangeRendered.to&&t.viewRangeRendered.to--)}}))}else this.removeAllRows()}},{key:"_removeRow",value:function(e){var t=e.$row;t&&(this._destroyTooltipsForRow(e),this._removeCellEditorForRow(e),t.hasClass("hiding")||(t.remove(),e.$row=null))}},{key:"_showRow",value:function(e){var t=e.$row;t&&(t.is(".showing")||(t.hide(),t.addClass("showing"),t.removeClass("hiding"),t.stop().slideDown({duration:250,complete:function(){t.removeClass("showing"),this.updateScrollbars()}.bind(this)})))}},{key:"_hideRow",value:function(e){var t=e.$row;t&&(t.is(".hiding")||(t.addClass("hiding"),t.removeClass("showing"),t.stop().slideUp({duration:250,complete:function(){e.$row&&(t.remove(),t[0]===e.$row[0]&&(e.$row=null),this.updateScrollbars())}.bind(this)})))}},{key:"_installRow",value:function(e){if(e.height=e.$row.outerHeight(!0),e.hasError&&this._showCellErrorForRow(e),this.cellEditorPopup&&!this.cellEditorPopup.rendered&&this.cellEditorPopup.row.id===e.id){var t=this.cellEditorPopup.cell.field;this.startCellEdit(this.cellEditorPopup.column,e,t)}}},{key:"_calcRowLevelPadding",value:function(e){return e?this._calcRowLevelPadding(e.parentRow)+this.rowLevelPadding:-this.rowLevelPadding}},{key:"_showCellErrorForRow",value:function(e){var t=this.$cellsForRow(e.$row),n=this;t.each((function(t){var r=s()(this),o=n.cellByCellIndex(t,e);o.errorStatus&&n._showCellError(e,r,o.errorStatus)}))}},{key:"_showCellError",value:function(e,t,n){var r,o;o={parent:this,text:n.message,autoRemove:!1,$anchor:t,table:this},(r=O.create("TableTooltip",o)).render(),r.row=e,this.tooltips.push(r)}},{key:"_columnAtX",value:function(e){var t=0,n=this.$data.offset().left+this.rowBorderLeftWidth,r=this.$data.scrollLeft();if(e<n)return this.columns[0];n-=r;var o=this.visibleColumns(),i=rt.find(o,(function(r){if(t=n+r.width,e>=n&&e<t)return!0;n=t}));return i||(i=o[o.length-1]),i}},{key:"_find$AppLink",value:function(e){var t=s()(e.target),n=s()(e.delegateTarget),r=t.findUp((function(e){return e.hasClass("app-link")}),n);return r.length>0?r:null}},{key:"_filterMenus",value:function(e,t,n,r,o){return zm.filterAccordingToSelection("Table",this.selectedRows.length,e,t,n,r,o)}},{key:"_filterMenusForContextMenu",value:function(){return this._filterMenus(this.menus,Gm.CONTEXT_MENU,!0,!1,["Header"])}},{key:"setStaticMenus",value:function(e){this.setProperty("staticMenus",e),this._updateMenuBar()}},{key:"_removeMenus",value:function(){}},{key:"notifyRowSelectionFinished",value:function(){this._triggerRowsSelectedPending&&(this._triggerRowsSelected(),this._triggerRowsSelectedPending=!1),this.session.onRequestsDone(this._updateMenuBar.bind(this))}},{key:"_triggerRowClick",value:function(e,t,n){var r={row:e,mouseButton:t};this.trigger("rowClick",r)}},{key:"_triggerRowAction",value:function(e,t){this.trigger("rowAction",{row:e,column:t})}},{key:"prepareCellEdit",value:function(e,t,n){var r=s.a.resolvedPromise();return this.cellEditorPopup&&(r=this.cellEditorPopup.waitForCompleteCellEdit()),r.then(this.prepareCellEditInternal.bind(this,e,t,n))}},{key:"prepareCellEditInternal",value:function(e,t,n){var r=new sn({column:e,row:t});if(this.openFieldPopupOnCellEdit=O.nvl(n,!1),this.trigger("prepareCellEdit",r),!r.defaultPrevented){var o=e.createEditor(t);this.startCellEdit(e,t,o)}}},{key:"cell",value:function(e,t){return e===this.rowIconColumn?O.create("Cell",{iconId:t.iconId,cssClass:Wn.join(" ","row-icon-cell",t.cssClass)}):e===this.checkableColumn?O.create("Cell",{value:t.checked,editable:!0,cssClass:t.cssClass}):e===this.compactColumn?O.create("Cell",{text:t.compactValue,htmlEnabled:!0}):t.cells[e.index]}},{key:"cellByCellIndex",value:function(e,t){return this.cell(this.columns[e],t)}},{key:"cellValue",value:function(e,t){var n=this.cell(e,t);return n?void 0!==n.value?n.value:"":n}},{key:"cellText",value:function(e,t){var n=this.cell(e,t);return n&&n.text||""}},{key:"nextEditableCellPos",value:function(e,t,n){var r,o,i,s,a,l=this.columns.indexOf(e);return o=l+1,n&&(o=l-1),(r=this.nextEditableCellPosForRow(o,t,n))||(a=function(e){return!!e.$row&&(o=0,n&&(o=this.columns.length-1),!!(r=this.nextEditableCellPosForRow(o,e,n))||void 0)}.bind(this),s=(i=this.rows.indexOf(t))+1,n&&(s=i-1),rt.findFrom(this.rows,s,a,n)),r}},{key:"nextEditableCellPosForRow",value:function(e,t,n){var r,o,i;if(i=function(e){return!e.guiOnly&&(r=this.cell(e,t),this.enabledComputed&&t.enabled&&r.editable)}.bind(this),o=rt.findFrom(this.columns,e,i,n))return{column:o,row:t}}},{key:"clearAggregateRows",value:function(e){this._aggregateRows.forEach((function(e){e.prevRow&&(e.prevRow.aggregateRowAfter=null),e.nextRow&&(e.nextRow.aggregateRowBefore=null)}),this),this._isDataRendered()&&(this._removeAggregateRows(e),this._renderSelection()),this._aggregateRows=[]}},{key:"_forEachVisibleColumn",value:function(e,t,n){var r;this.visibleColumns().forEach((function(o,i){o[e]?(n&&(r=o.cellValueOrTextForCalculation(n)),t[i]=o[e](t[i],r)):t[i]=void 0}))}},{key:"_group",value:function(e){var t,n,r,o,s=this,a=this._groupedColumns(),l=this.groupingStyle===i.GroupingStyle.TOP,u=[];this.clearAggregateRows(),a.length&&(t=this.visibleRows,this._forEachVisibleColumn("aggrStart",u),t.forEach((function(e,i){r||(r=e),s._forEachVisibleColumn("aggrStep",u,e),n=t[i+1],(i===t.length-1||s._isNewGroup(a,e,n))&&(s._forEachVisibleColumn("aggrFinish",u),s._addAggregateRow(u,l?o:e,l?r:n),s._forEachVisibleColumn("aggrStart",u),r=null,o=e)})),this._isDataRendered()&&(this._renderAggregateRows(e),this._renderSelection()))}},{key:"_isNewGroup",value:function(e,t,n){var r,o,i,s=!1;if(!n)return!0;for(r=0;r<e.length;r++)if(i=(o=e[r])&&o.cellTextForGrouping&&"function"==typeof o.cellTextForGrouping,s=(s=s||i&&o.cellTextForGrouping(t)!==o.cellTextForGrouping(n))||!i&&this.cellText(o,t)!==this.cellText(o,n))return!0;return!1}},{key:"_groupedColumns",value:function(){return this.columns.filter((function(e){return e.grouped}))}},{key:"_addAggregateRow",value:function(e,t,n){var r={contents:e.slice(),prevRow:t,nextRow:n};this._aggregateRows.push(r),t&&(t.aggregateRowAfter=r),n&&(n.aggregateRowBefore=r)}},{key:"_removeAggregateRows",value:function(e){0!==this._aggregateRows.length&&((e=O.nvl(e,!1))?this._aggregateRows.forEach((function(e,t){this._hideRow(e)}),this):(this._aggregateRows.forEach((function(e){this._removeRow(e)}),this),this.updateScrollbars()))}},{key:"_renderAggregateRows",value:function(e){var t=this.groupingStyle===i.GroupingStyle.TOP,n=t?"insertBefore":"insertAfter";e=O.nvl(e,!1),this._aggregateRows.forEach((function(r,o){var i,a,l,u=this;r.$row||(i=t?r.nextRow:r.prevRow)&&i.$row&&((l=this.$container.makeDiv("table-aggregate-row").data("aggregateRow",r))[n](i.$row).width(this.rowWidth),this.visibleColumns().forEach((function(e){(a=s()(e.buildCellForAggregateRow(r))).appendTo(l),u._resizeCell(a)}),this),r.height=l.outerHeight(!0),r.$row=l,e&&this._showRow(r))}),this)}},{key:"groupColumn",value:function(e,t,n,r){var o,i;t=O.nvl(t,!1),(r=O.nvl(r,!1))&&this._removeGroupColumn(e),this.isGroupingPossible(e)&&(r||this._addGroupColumn(e,n,t),this.header&&this.header.onSortingChanged(),i=this._sort(!0),o={column:e,groupAscending:e.sortAscending},r&&(o.groupingRemoved=!0),t&&(o.multiGroup=!0),i||(o.groupingRequested=!0,this._animateAggregateRows=!0),this.trigger("group",o))}},{key:"removeColumnGrouping",value:function(e){e&&this.groupColumn(e,!1,"asc",!0)}},{key:"removeAllColumnGroupings",value:function(){this.columns.filter((function(e){return e.grouped})).forEach(this.removeColumnGrouping.bind(this))}},{key:"isGrouped",value:function(){return this.columns.some((function(e){return e.grouped}))}},{key:"setColumnBackgroundEffect",value:function(e,t){e.setBackgroundEffect(t)}},{key:"_updateBackgroundEffect",value:function(){this.columns.forEach((function(e){e.backgroundEffect&&e.updateBackgroundEffect()}),this)}},{key:"_calculateValuesForBackgroundEffect",value:function(){this.columns.forEach((function(e){e.backgroundEffect&&e.calculateMinMaxValues()}),this)}},{key:"_markAutoOptimizeWidthColumnsAsDirty",value:function(){this.columns.forEach((function(e){e.autoOptimizeWidthRequired=!0}))}},{key:"_markAutoOptimizeWidthColumnsAsDirtyIfNeeded",value:function(e,t,n){var r,o=!1;for(r=e.length-1;r>=0;r--){var i=e[r];this.cellValue(i,t)!==this.cellValue(i,n)&&(i.autoOptimizeWidthRequired=!0,e.splice(r,1),o=!0)}return o}},{key:"setMultiCheck",value:function(e){this.setProperty("multiCheck",e)}},{key:"checkedRows",value:function(){return this.rows.filter((function(e){return e.checked}))}},{key:"checkRow",value:function(e,t,n){var r=s.a.extend(n,{checked:t});this.checkRows([e],r)}},{key:"checkRows",value:function(e,t){var n=s.a.extend({checked:!0,checkOnlyEnabled:!0},t),r=[];!this.checkable||!this.enabledComputed&&n.checkOnlyEnabled||((e=rt.ensure(e)).forEach((function(e){if((e.enabled||!n.checkOnlyEnabled)&&e.checked!==n.checked){if(!this.multiCheck&&n.checked)for(var t=0;t<this.rows.length;t++)this.rows[t].checked&&(this.rows[t].checked=!1,r.push(this.rows[t]));e.checked=n.checked,r.push(e)}}),this),this._isDataRendered()&&r.forEach((function(e){this._renderRowChecked(e)}),this),this._triggerRowsChecked(r))}},{key:"uncheckRow",value:function(e,t){this.uncheckRows([e],t)}},{key:"uncheckRows",value:function(e,t){var n=s.a.extend({checked:!1},t);this.checkRows(e,n)}},{key:"isTableNodeColumn",value:function(e){return this.hierarchical&&this.tableNodeColumn===e}},{key:"collapseRow",value:function(e){this.collapseRows(rt.ensure(e))}},{key:"collapseAll",value:function(){this.expandRowsInternal(this.rootRows,!1,!0)}},{key:"expandAll",value:function(){this.expandRowsInternal(this.rootRows,!0,!0)}},{key:"collapseRows",value:function(e,t){this.expandRowsInternal(e,!1,t)}},{key:"expandRow",value:function(e,t){this.expandRows(rt.ensure(e))}},{key:"expandRows",value:function(e,t){this.expandRowsInternal(e,!0,t)}},{key:"expandRowsInternal",value:function(e,t,n){var r=[],o=[];e=e||this.rootRows,t=O.nvl(t,!0),(n=O.nvl(n,!1))?this.visitRows((function(e){e.expanded!==t&&(e.expanded=t,r.push(e),e.$row&&o.push(e))}),e):r=e.filter((function(e){var n=e.expanded!==t;return n&&e.$row&&o.push(e),e.expanded=t,n})),0!==r.length&&(this._updateRowStructure({visibleRows:!0}),this._triggerRowsExpanded(r),this._isDataRendered()&&(this._renderRowDelta(),o.forEach((function(e){e.animateExpansion()})),e[0].$row&&Lh.ensureExpansionVisible({element:e[0],$element:e[0].$row,$scrollable:this.get$Scrollable(),isExpanded:function(e){return e.expanded},getChildren:function(e){return e.childRows},defaultChildHeight:this.rowHeight})))}},{key:"doRowAction",value:function(e,t){1===this.selectedRows.length&&this.selectedRows[0]===e&&(t=t||this.columns[0],e&&t&&this._triggerRowAction(e,t))}},{key:"insertRow",value:function(e){this.insertRows([e])}},{key:"insertRows",value:function(e){var t=this,n=0===this.rows.length;e.forEach((function(t,n){(t=this._initRow(t)).status=Ix.Status.INSERTED,e[n]=t,this.rows.push(t)}),this);var r=e.filter((function(e){return this._applyFiltersForRow(e),e.filterAccepted}),this);this._updateRowStructure({updateTree:!0,filteredRows:!0,applyFilters:!1,visibleRows:!0}),this._filterCount()>0&&r.length>0&&this._triggerFilter(),this._calculateValuesForBackgroundEffect(),this._markAutoOptimizeWidthColumnsAsDirty(),this._triggerRowsInserted(e),this._sortAfterInsert(n),this._isDataRendered()&&(this.hierarchical&&this._renderRowOrderChanges(),this._insertedRows?rt.pushAll(this._insertedRows,e):(this._insertedRows=e,setTimeout((function(){t._insertedRows=null}),0)),this.viewRangeDirty=!0,this._renderViewport(),this.invalidateLayoutTree())}},{key:"_sortAfterInsert",value:function(e){this._sort()}},{key:"deleteRow",value:function(e){this.deleteRows([e])}},{key:"deleteRows",value:function(e){var t,n,r=this,o=[];this.visitRows((function(e){r.rowsMap[e.id]&&(o.push(e),r._isDataRendered()&&(r.cellEditorPopup&&r.cellEditorPopup.row.id===e.id&&r.cellEditorPopup.cancelEdit(),r._removeRows(e),t=!0),rt.remove(r.rows,e),rt.remove(r.visibleRows,e),r._filterCount()>0&&rt.remove(r._filteredRows,e)&&(n=!0),delete r.rowsMap[e.id],r.selectionHandler.lastActionRow===e&&r.selectionHandler.clearLastSelectedRowMarker())}),e),this.deselectRows(o),this._updateRowStructure({updateTree:!0,filteredRows:!0,applyFilters:!1,visibleRows:!0}),n&&this._triggerFilter(),this._group(),this._updateBackgroundEffect(),this._markAutoOptimizeWidthColumnsAsDirty(),this._triggerRowsDeleted(e),t&&(this._renderViewport(),this._renderRangeMarkers(),this._renderFiller(),this._renderEmptyData(),this.invalidateLayoutTree())}},{key:"deleteAllRows",value:function(){var e=this._filterCount()>0&&this._filteredRows.length>0,t=this.rows;this._isDataRendered()&&(this.cellEditorPopup&&this.cellEditorPopup.cancelEdit(),this.selectionHandler.clearLastSelectedRowMarker(),this._removeRows()),this.rows=[],this.rowsMap={},this._filteredRows=[],this.deselectAll(),this._updateRowStructure({updateTree:!0,filteredRows:!0,applyFilters:!1,visibleRows:!0}),e&&this._triggerFilter(),this._markAutoOptimizeWidthColumnsAsDirty(),this._group(),this._updateBackgroundEffect(),this._triggerAllRowsDeleted(t),this._isDataRendered()&&(this._renderFiller(),this._renderViewport(),this._renderEmptyData(),this.invalidateLayoutTree())}},{key:"updateRow",value:function(e){this.updateRows([e])}},{key:"updateRows",value:function(e){if(this.updateBuffer.isBuffering())this.updateBuffer.buffer(e);else{var t,n,r=this.columns.filter((function(e){return e.autoOptimizeWidth&&!e.autoOptimizeWidthRequired})),o={};this.rows.forEach((function(e,t){o[e.id]=t}),this);var i={},s=!1;e=e.map((function(e){var a=e.parentRow,l=this.rowsMap[e.id];if(i[e.id]=l,!l)throw new Error("Update event received for non existing row. RowId: "+e.id);return e.parentRow&&!Pr.isNullOrUndefined(e.parentRow.id)&&(a=e.parentRow.id),s=s||O.nvl(l._parentRowId,null)!==O.nvl(a,null),n=n||l.expanded!==O.nvl(e.expanded,!1),(e=this._initRow(e)).status===Ix.Status.NON_CHANGED&&e.cells.some((function(t,n){var r=l.cells[n];return!(r&&r.value===t.value||(e.status=Ix.Status.UPDATED,0))})),this.selectionHandler.lastActionRow===l&&(this.selectionHandler.lastActionRow=e),rt.replace(this.selectedRows,l,e),this.rows[o[e.id]]=e,e.filterAccepted=l.filterAccepted,this._filterCount()>0&&(t=this._applyFiltersForRow(e)||t),this._markAutoOptimizeWidthColumnsAsDirtyIfNeeded(r,l,e),e}),this),this._updateRowStructure({updateTree:!0,filteredRows:!0,applyFilters:!1,visibleRows:!0}),this._triggerRowsUpdated(e),this._isDataRendered()&&(this._renderUpdateRows(e,i),s&&this._renderRowOrderChanges()),t&&this._triggerFilter(),(t||n)&&this._renderRowDelta(),this._sortAfterUpdate(),this._updateBackgroundEffect(),this.invalidateLayoutTree()}}},{key:"_renderUpdateRows",value:function(e,t){e.forEach((function(e){var n,r=t[e.id];r.$row&&!r.$row.hasClass("hiding")&&((n=s()(this._buildRowDiv(e))).copyCssClasses(r.$row,i.SELECTION_CLASSES+" first last"),r.$row.replaceWith(n),i.linkRowToDiv(e,n),this._destroyTooltipsForRow(e),this._removeCellEditorForRow(e),this._installRow(e),r.$row.hasClass("showing")&&r.$row.outerHeight()<e.$row.outerHeight()/3&&this._showRow(e))}),this)}},{key:"_sortAfterUpdate",value:function(){this._sort()}},{key:"isHierarchical",value:function(){return this.hierarchical}},{key:"_setHierarchical",value:function(e){this.hierarchical!==e&&(e&&this.removeAllColumnGroupings(),this._setProperty("hierarchical",e))}},{key:"updateRowOrder",value:function(e){if((e=rt.ensure(e)).length!==this.rows.length)throw new Error("Row order may not be updated because lengths of the arrays differ.");this.rows=e.slice(),this._updateRowStructure({updateTree:!0,filteredRows:!0,applyFilters:!1,visibleRows:!0}),this.clearAggregateRows(this._animateAggregateRows),this._isDataRendered()&&this._renderRowOrderChanges(),this._triggerRowOrderChanged(),this._group(this._animateAggregateRows),this._animateAggregateRows=!1}},{key:"_destroyTooltipsForRow",value:function(e){for(var t=this.tooltips.length-1;t>=0;t--)this.tooltips[t].row.id===e.id&&(this.tooltips[t].destroy(),this.tooltips.splice(t,1))}},{key:"_removeCellEditorForRow",value:function(e){this.cellEditorPopup&&this.cellEditorPopup.rendered&&this.cellEditorPopup.row.id===e.id&&this.cellEditorPopup.remove()}},{key:"startCellEdit",value:function(e,t,n){if(this._isDataRendered()&&this.isAttachedAndRendered()){this.trigger("startCellEdit",{column:e,row:t,field:n}),this.ensureRowRendered(t);var r=e.startCellEdit(t,n);return this.cellEditorPopup=r,r}this._postRenderActions.push(this.startCellEdit.bind(this,e,t,n))}},{key:"endCellEdit",value:function(e,t){this._isDataRendered()&&this.isAttachedAndRendered()?this.cellEditorPopup?this._destroyCellEditorPopup(this._updateCellFromEditor.bind(this,this.cellEditorPopup,e,t)):e.destroy():this._postRenderActions.push(this.endCellEdit.bind(this,e,t))}},{key:"_updateCellFromEditor",value:function(e,t,n){(n=O.nvl(n,!1))&&e.column.updateCellFromEditor(e.row,t),t.destroy()}},{key:"completeCellEdit",value:function(){var e=this.cellEditorPopup.cell.field,t=new sn({field:e,row:this.cellEditorPopup.row,column:this.cellEditorPopup.column,cell:this.cellEditorPopup.cell});if(this.trigger("completeCellEdit",t),!t.defaultPrevented)return this.endCellEdit(e,!0)}},{key:"cancelCellEdit",value:function(){var e=this.cellEditorPopup.cell.field,t=new sn({field:e,row:this.cellEditorPopup.row,column:this.cellEditorPopup.column,cell:this.cellEditorPopup.cell});this.trigger("cancelCellEdit",t),t.defaultPrevented||this.endCellEdit(e)}},{key:"scrollTo",value:function(e,t){0!==this.viewRangeRendered.size()&&(this.ensureRowRendered(e),e.$row&&Lh.scrollTo(this.$data,e.$row,t))}},{key:"scrollPageUp",value:function(){var e=Math.max(0,this.$data[0].scrollTop-this.$data.height());this.setScrollTop(e)}},{key:"scrollPageDown",value:function(){var e=Math.min(this.$data[0].scrollHeight,this.$data[0].scrollTop+this.$data.height());this.setScrollTop(e)}},{key:"setScrollTop",value:function(e){this.setProperty("scrollTop",e),this._isDataRendered()&&this._renderViewport()}},{key:"_renderScrollTop",value:function(){this.rendering||Lh.scrollTop(this.get$Scrollable(),this.scrollTop)}},{key:"get$Scrollable",value:function(){return this.$data?this.$data:this.$container}},{key:"setScrollToSelection",value:function(e){this.setProperty("scrollToSelection",e)}},{key:"revealSelection",value:function(){this._isDataRendered()?this.selectedRows.length>0&&this.scrollTo(this.selectedRows[0]):this.session.layoutValidator.schedulePostValidateFunction(this.revealSelection.bind(this))}},{key:"revealChecked",value:function(){var e=rt.find(this.rows,(function(e){return!0===e.checked}));e&&this.scrollTo(e)}},{key:"_rowById",value:function(e){return this.rowsMap[e]}},{key:"_rowsByIds",value:function(e){return e.map(this._rowById.bind(this))}},{key:"_rowsToIds",value:function(e){return e.map((function(e){return e.id}))}},{key:"hasRow",value:function(e){return Boolean(this.rowsMap[e.id])}},{key:"_renderSelection",value:function(e){e=rt.ensure(e||this.selectedRows);for(var t=function(e,t,n){var r=e.hasClass(n);return t&&!r?(e.addClass(n),!0):!(t||!r||(e.removeClass(n),0))},n=0;n<e.length;n++){var r=e[n];if(r.$row){var o=-1!==this.selectedRows.indexOf(r),i=this.visibleRows,s=i.indexOf(r)-1,a=s>=0&&-1!==this.selectedRows.indexOf(i[s]),l=i.indexOf(r)+1,u=l<i.length&&-1!==this.selectedRows.indexOf(i[l]);o&&a&&r.aggregateRowBefore&&(a=!1),o&&u&&r.aggregateRowAfter&&(u=!1);var c=0+t(r.$row,o,"selected")+t(r.$row,o&&!a&&u,"select-top")+t(r.$row,o&&a&&!u,"select-bottom")+t(r.$row,o&&!a&&!u,"select-single")+t(r.$row,o&&a&&u,"select-middle");c&&a&&-1===e.indexOf(i[s])&&e.push(i[s]),c&&u&&-1===e.indexOf(i[l])&&e.push(i[l])}}this.cellEditorPopup&&this.cellEditorPopup.rendered&&this.selectedRows.indexOf(this.cellEditorPopup.row)>-1&&(this.cellEditorPopup.position(),this.cellEditorPopup.pack())}},{key:"_removeSelection",value:function(){this.selectedRows.forEach((function(e){e.$row&&(e.$row.select(!1),e.$row.toggleClass(i.SELECTION_CLASSES,!1))}),this)}},{key:"addRowToSelection",value:function(e,t){this.selectedRows.indexOf(e)>-1||(t=void 0===t||t,this.selectedRows.push(e),e.$row&&this._isDataRendered()&&(e.$row.select(!0),this._renderSelection(e),this.scrollToSelection&&this.revealSelection()),this._triggerRowsSelectedPending=!0,t||this.notifyRowSelectionFinished())}},{key:"removeRowFromSelection",value:function(e,t){t=void 0===t||t,rt.remove(this.selectedRows,e)&&(this._isDataRendered()&&this._renderSelection(e),t?this._triggerRowsSelectedPending=!0:this._triggerRowsSelected())}},{key:"selectRow",value:function(e,t){this.selectRows(e,t)}},{key:"selectRows",value:function(e,t){e=rt.ensure(e).filter((function(e){return Boolean(this.visibleRowsMap[e.id])}),this),rt.equalsIgnoreOrder(e,this.selectedRows)||(this._isDataRendered()&&this._removeSelection(),!this.multiSelect&&e.length>1&&(e=[e[0]]),this.selectedRows=e,this._triggerRowsSelected(t),this._updateMenuBar(),this._isDataRendered()&&(this._renderSelection(),this.scrollToSelection&&this.revealSelection()))}},{key:"deselectRow",value:function(e){this.deselectRows(e)}},{key:"deselectRows",value:function(e){e=rt.ensure(e);var t=this.selectedRows.slice();rt.removeAll(t,e)&&this.selectRows(t)}},{key:"isRowSelected",value:function(e){return this.selectedRows.indexOf(e)>-1}},{key:"_filterCount",value:function(){return Object.keys(this._filterMap).length}},{key:"filteredRows",value:function(){return this._filteredRows}},{key:"$rows",value:function(e){var t=".table-row";return e&&(t+=", .table-aggregate-row"),this.$data.find(t)}},{key:"$aggregateRows",value:function(){return this.$data.find(".table-aggregate-row")}},{key:"selectedRow",value:function(){return this.selectedRows.length>0?this.selectedRows[0]:null}},{key:"$selectedRows",value:function(){return this.$data?this.$data.find(".selected"):s()()}},{key:"$cellsForColIndex",value:function(e,t){var n=".table-row > div:nth-of-type("+e+")";return t&&(n+=", .table-aggregate-row > div:nth-of-type("+e+")"),this.$data.find(n)}},{key:"$cellsForColIndexWidthFix",value:function(e,t){var n=".table-row > div:nth-of-type("+e+") > .width-fix ";return t&&(n+=", .table-aggregate-row > div:nth-of-type("+e+") > .width-fix"),this.$data.find(n)}},{key:"$cellsForRow",value:function(e){return e.children(".table-cell")}},{key:"$cell",value:function(e,t){var n=e;return"number"!=typeof e&&(n=this.visibleColumns().indexOf(e)),t.children(".table-cell").eq(n)}},{key:"columnById",value:function(e){return rt.find(this.columns,(function(t){return t.id===e}))}},{key:"columnFor$Cell",value:function(e,t){t=t||e.closest(".table-row");var n=this.$cellsForRow(t).index(e);return this.visibleColumns()[n]}},{key:"columnsByIds",value:function(e){return e.map(this.columnById.bind(this))}},{key:"getVisibleRows",value:function(){return this.visibleRows}},{key:"_updateRowStructure",value:function(e){var t=O.nvl(e.updateTree,!1),n=O.nvl(e.filteredRows,t),r=O.nvl(e.applyFilters,n),o=O.nvl(e.visibleRows,n);t&&this._rebuildTreeStructure(),n&&this._updateFilteredRows(r),o&&this._updateVisibleRows()}},{key:"_rebuildTreeStructure",value:function(){var e=this,t=!1;if(this.rows.forEach((function(e){e.childRows=[],t=t||!Pr.isNullOrUndefined(e.parentRow)}),this),!t)return this.rootRows=this.rows,void this._setHierarchical(t);this._setHierarchical(t),this.rootRows=[],this.rows.forEach((function(e){var t;if(Pr.isNullOrUndefined(e.parentRow))return e.parentRow=null,e._parentRowId=null,void this.rootRows.push(e);if(!(t=Pr.isNullOrUndefined(e.parentRow.id)?this.rowsMap[e.parentRow]:this.rowsMap[e.parentRow.id]))throw new Error("Parent row of "+e+" can not be resolved.");e.parentRow=t,e._parentRowId=t.id,t.childRows.push(e)}),this),this._maxLevel=0,this.rows=[],this.visitRows((function(t,n){t._hierarchyLevel=n,e._maxLevel=Math.max(n,e._maxLevel),e.rows.push(t)})),this._calculateTableNodeColumn()}},{key:"_updateFilteredRows",value:function(e,t){t=Boolean(t),e=O.nvl(e,!0),this._filteredRows=this.rows.filter((function(n){return e&&(t=this._applyFiltersForRow(n)||t),n.filterAccepted}),this),t&&this._triggerFilter()}},{key:"_updateVisibleRows",value:function(){this.visibleRows=this._computeVisibleRows(),this.visibleRowsMap=this.visibleRows.reduce((function(e,t){return e[t.id]=t,e}),{}),this.initialized&&this.deselectRows(this.selectedRows.filter((function(e){return!this.visibleRowsMap[e.id]}),this))}},{key:"_computeVisibleRows",value:function(e){var t=[];return(e=e||this.rootRows).forEach((function(e){var n=this._computeVisibleRows(e.childRows);(e.filterAccepted||n.length>0)&&t.push(e),e._expandable=n.length>0,e.expanded&&(t=t.concat(n))}),this),t}},{key:"visibleChildRows",value:function(e){return e.childRows.filter((function(e){return Boolean(this.visibleRowsMap[e.id])}),this)}},{key:"_renderRowDelta",value:function(){var e=this;if(this._isDataRendered()){var t=[],n=[];this.$rows().each((function(r,o){var i=s()(o).data("row");e.visibleRows.indexOf(i)<0?(i.$row.detach(),n.push(i)):t.push(i)})),this._rerenderViewport(),n.forEach((function(e){e.$row.insertAfter(this.$fillBefore)}),this),this._order$Rows().insertAfter(this.$fillBefore),this._order$AggregateRows(),n.forEach((function(e){this._hideRow(e)}),this),this.$rows().each((function(n,r){var o=s()(r),i=o.data("row");o.hasClass("hiding")||t.indexOf(i)<0&&e._showRow(i)})),this._renderScrollTop(),this._renderEmptyData()}}},{key:"filter",value:function(){this._updateRowStructure({filteredRows:!0}),this._renderRowDelta(),this._group(),this.revealSelection()}},{key:"_order$Rows",value:function(e){var t=this;return(e=e||this.$rows()).sort((function(e,n){var r=s()(e),o=s()(n),i=r.data("row"),a=o.data("row");return t.rows.indexOf(i)-t.rows.indexOf(a)}))}},{key:"_order$AggregateRows",value:function(e){(e=e||this.$aggregateRows()).each((function(e,t){var n=s()(t),r=n.data("aggregateRow");r&&r.prevRow&&n.insertAfter(r.prevRow.$row)}))}},{key:"_rowAcceptedByFilters",value:function(e){for(var t in this._filterMap)if(!this._filterMap[t].accept(e))return!1;return!0}},{key:"_applyFiltersForRow",value:function(e){if(this._rowAcceptedByFilters(e)){if(!e.filterAccepted)return e.filterAccepted=!0,!0}else if(e.filterAccepted)return e.filterAccepted=!1,!0;return!1}},{key:"filteredBy",value:function(){var e=[];for(var t in this._filterMap){var n=this._filterMap[t];"function"==typeof n.createLabel&&e.push(n.createLabel())}return e}},{key:"resetUserFilter",value:function(){for(var e in this._filterMap)this._filterMap[e]instanceof NI&&this.removeFilterByKey(e);this.filter(),this._triggerFilterReset()}},{key:"hasUserFilter",value:function(){return Pr.values(this._filterMap).filter((function(e){return e instanceof NI})).length>0}},{key:"resizeToFit",value:function(e,t){if(!e.fixedWidth){var n=e.calculateOptimalWidth();Pr.isPlainObject(n)?n.always(this._resizeToFit.bind(this,e,t)):this._resizeToFit(e,t,n)}}},{key:"_resizeToFit",value:function(e,t,n){-1!==n&&(t&&t>0&&n>t&&(n=t),Kt.get().isInternetExplorer()&&n!==e.minWidth&&n++,e.width!==n&&this.resizeColumn(e,n),e.autoOptimizeWidthRequired=!1,this._triggerColumnResizedToFit())}},{key:"addFilter",value:function(e){var t=e.createKey();if(!t)throw new Error("key has to be defined");this._filterMap[t]=e,this.trigger("filterAdded",{filter:e})}},{key:"removeFilter",value:function(e){this.removeFilterByKey(e.createKey())}},{key:"removeFilterByKey",value:function(e){if(!e)throw new Error("key has to be defined");var t=this._filterMap[e];t&&(delete this._filterMap[e],this.trigger("filterRemoved",{filter:t}))}},{key:"getFilter",value:function(e){if(!e)throw new Error("key has to be defined");return this._filterMap[e]}},{key:"resizeColumn",value:function(e,t){var n=this;if(!e.fixedWidth){t=Math.floor(t),e.width=t;var r=this.visibleColumns().indexOf(e);if(-1!==r){var o=r+1;this.$cellsForColIndex(o,!0).css("min-width",t).css("max-width",t),this._updateRealColumnWidth(e),this._updateRowWidth(),this.$rows(!0).css("width",this.rowWidth),this._updateRowHeights(),this._renderFiller(),this._renderViewport(),this.updateScrollbars(),this._renderEmptyData()}this._aggregateRows.forEach((function(t){t.$row&&n._resizeCell(n.$cell(e,t.$row))}),this),this._triggerColumnResized(e)}}},{key:"_resizeCell",value:function(e){var t=e.children(".table-cell-icon");t.setVisible(!0),e.isContentTruncated()&&t.setVisible(!1)}},{key:"moveColumn",value:function(e,t,n,r){n=this._considerFixedPositionColumns(t,n);var o=this.visibleColumns(),i=o[n],s=this.columns.indexOf(i);rt.remove(this.columns,e),rt.insert(this.columns,e,s),o=this.visibleColumns(),n=o.indexOf(e),this._calculateTableNodeColumn(),this._triggerColumnMoved(e,t,n,r),this._aggregateRows.forEach((function(e){rt.move(e.contents,t,n)})),this._isDataRendered()&&this._rerenderViewport()}},{key:"_considerFixedPositionColumns",value:function(e,t){var n=-1;return t>e?(n=rt.findIndexFrom(this.visibleColumns(),e,(function(e){return e.fixedPosition})))>-1&&(t=Math.min(t,n-1)):(n=rt.findIndexFromReverse(this.visibleColumns(),e,(function(e){return e.fixedPosition})))>-1&&(t=Math.max(t,n+1)),t}},{key:"_renderColumnOrderChanges",value:function(e){var t,n,r,o,i,a,l,u=this;this.header&&this.header.onOrderChanged(e),this.$rows(!0).each((function(){for(l=s()(this),o=s()(),a=l.children(),n=0;n<u.columns.length;n++){for(t=u.columns[n],r=0;r<e.length;r++)if(e[r]===t){i=a[r];break}o.push(i)}l.prepend(o)}))}},{key:"_triggerRowsInserted",value:function(e){this.trigger("rowsInserted",{rows:e})}},{key:"_triggerRowsDeleted",value:function(e){this.trigger("rowsDeleted",{rows:e})}},{key:"_triggerRowsUpdated",value:function(e){this.trigger("rowsUpdated",{rows:e})}},{key:"_triggerAllRowsDeleted",value:function(e){this.trigger("allRowsDeleted",{rows:e})}},{key:"_triggerRowsSelected",value:function(e){this.trigger("rowsSelected",{debounce:e})}},{key:"_triggerRowsChecked",value:function(e){this.trigger("rowsChecked",{rows:e})}},{key:"_triggerRowsExpanded",value:function(e){this.trigger("rowsExpanded",{rows:e})}},{key:"_triggerFilter",value:function(){this.trigger("filter")}},{key:"_triggerFilterReset",value:function(){this.trigger("filterReset")}},{key:"_triggerAppLinkAction",value:function(e,t,n,r){this.trigger("appLinkAction",{column:e,row:t,ref:n,$appLink:r})}},{key:"_triggerReload",value:function(e){this.trigger("reload",{reloadReason:e})}},{key:"_triggerClipboardExport",value:function(){var e=new sn;this.trigger("clipboardExport",e),e.defaultPrevented||this._exportToClipboard()}},{key:"_triggerRowOrderChanged",value:function(e,t){var n={row:e,animating:t};this.trigger("rowOrderChanged",n)}},{key:"_triggerColumnResized",value:function(e){var t={column:e};this.trigger("columnResized",t)}},{key:"_triggerColumnResizedToFit",value:function(e){var t={column:e};this.trigger("columnResizedToFit",t)}},{key:"_triggerColumnMoved",value:function(e,t,n,r){var o={column:e,oldPos:t,newPos:n,dragged:r};this.trigger("columnMoved",o)}},{key:"_triggerAggregationFunctionChanged",value:function(e){var t={column:e};this.trigger("aggregationFunctionChanged",t)}},{key:"setHeaderVisible",value:function(e){this.setProperty("headerVisible",e)}},{key:"_renderHeaderVisible",value:function(){this._renderTableHeader()}},{key:"setHeaderEnabled",value:function(e){this.setProperty("headerEnabled",e)}},{key:"_renderHeaderEnabled",value:function(){this._removeTableHeader(),this._renderTableHeader()}},{key:"setHeaderMenusEnabled",value:function(e){this.setProperty("headerMenusEnabled",e),this.header&&this.header.setHeaderMenusEnabled(this.headerMenusEnabled)}},{key:"hasPermanentHeadOrTailSortColumns",value:function(){return 0!==this._permanentHeadSortColumns.length||0!==this._permanentTailSortColumns.length}},{key:"_setHeadAndTailSortColumns",value:function(){var e=this.columns.filter((function(e){return e.sortIndex>=0}));e.sort((function(e,t){return e.sortIndex-t.sortIndex})),this._permanentHeadSortColumns=[],this._permanentTailSortColumns=[],e.forEach((function(e){e.initialAlwaysIncludeSortAtBegin?this._permanentHeadSortColumns.push(e):e.initialAlwaysIncludeSortAtEnd&&this._permanentTailSortColumns.push(e)}),this)}},{key:"setTileMode",value:function(e){this.setProperty("tileMode",e)}},{key:"_setTileMode",value:function(e){e&&(this._ensureMediator(),this.tileTableHeader||this._setTileTableHeader(this._createTileTableHeader()),this.tableTileGridMediator.loadTiles(),this.tableTileGridMediator.activate()),this._setProperty("tileMode",e),!e&&this.tableTileGridMediator&&this.tableTileGridMediator.deactivate()}},{key:"_ensureMediator",value:function(){this.tableTileGridMediator||(this.tableTileGridMediator=O.create("TableTileGridMediator",{parent:this,gridColumnCount:6}))}},{key:"_renderTileMode",value:function(){this.tableTileGridMediator&&this.tableTileGridMediator.renderTileMode()}},{key:"createTiles",value:function(e){return e.map((function(e){var t=this.createTileForRow(e);return this._adaptTile(t),t.rowId=e.id,t}),this)}},{key:"_adaptTile",value:function(e){e.gridDataHints={weightX:0}}},{key:"createTileForRow",value:function(e){throw new Error("Not implemented")}},{key:"_setTileTableHeader",value:function(e){e&&e.addCssClass("tile-table-header"),this._setProperty("tileTableHeader",e)}},{key:"_createTileTableHeader",value:function(){return O.create("TileTableHeaderBox",{parent:this})}},{key:"setRowIconVisible",value:function(e){this.setProperty("rowIconVisible",e)}},{key:"_setRowIconVisible",value:function(e){this._setProperty("rowIconVisible",e);var t=this.rowIconColumn;this.rowIconVisible&&!t?(this._insertRowIconColumn(),this._calculateTableNodeColumn(),this.trigger("columnStructureChanged")):!this.rowIconVisible&&t&&(t.destroy(),rt.remove(this.columns,t),this.rowIconColumn=null,this._calculateTableNodeColumn(),this.trigger("columnStructureChanged"))}},{key:"_renderRowIconVisible",value:function(){this.columnLayoutDirty=!0,this._updateRowWidth(),this._redraw(),this.invalidateLayoutTree()}},{key:"_renderRowIconColumnWidth",value:function(){this.rowIconVisible&&this._renderRowIconVisible()}},{key:"setRowIconColumnWidth",value:function(e){this.setProperty("rowIconColumnWidth",e)}},{key:"_setRowIconColumnWidth",value:function(e){this._setProperty("rowIconColumnWidth",e);var t=this.rowIconColumn;t&&(t.width=e)}},{key:"_setSelectedRows",value:function(e){"string"==typeof e[0]&&(e=this._rowsByIds(e)),this._setProperty("selectedRows",e)}},{key:"setMenus",value:function(e){this.setProperty("menus",e)}},{key:"_setMenus",value:function(e,t){this.updateKeyStrokes(e,t),this._setProperty("menus",e),this._updateMenuBar(),this.header&&this.header.updateMenuBar()}},{key:"setMenuBarVisible",value:function(e){this.setProperty("menuBarVisible",e)}},{key:"_setMenuBarVisible",value:function(e){this._setProperty("menuBarVisible",e),this._updateMenuBar()}},{key:"_renderMenuBarVisible",value:function(){this.menuBarVisible?(this.menuBar.render(),this._refreshMenuBarPosition()):this.menuBar.remove(),this._updateMenuBar(),this.invalidateLayoutTree()}},{key:"_refreshMenuBarPosition",value:function(){this.menuBarVisible&&this.menuBar.rendered&&(this.menuBar.position===Yw.Position.TOP?this.menuBar.$container.prependTo(this.$container):this.menuBar.$container.appendTo(this.$container))}},{key:"_createMenuBar",value:function(){return O.create("MenuBar",{parent:this,position:Yw.Position.BOTTOM,menuOrder:new Ag(this.session,"Table"),menuFilter:this._filterMenusHandler})}},{key:"_updateMenuBar",value:function(){if(this.menuBarVisible){var e=this._filterMenus(this.menus,Gm.MENU_BAR,!1,!0,["Header"]);e=this.staticMenus.concat(e),this.menuBar.setMenuItems(e)}else this.menuBar.setMenuItems([]);if(this.contextMenu){var t=this._filterMenus(this.menus,Gm.CONTEXT_MENU,!0,!1,["Header"]);this.contextMenu.updateMenuItems(t)}}},{key:"_setKeyStrokes",value:function(e){this.updateKeyStrokes(e,this.keyStrokes),this._setProperty("keyStrokes",e)}},{key:"setFilters",value:function(e){for(var t in this._filterMap)this._filterMap[t]instanceof NI&&this.removeFilterByKey(t);e&&e.forEach((function(e){e=this._ensureFilter(e),this.addFilter(e)}),this)}},{key:"_ensureFilter",value:function(e){return e instanceof NI?e:(e.column&&(e.column=this.columnById(e.column)),e.table=this,e.session=this.session,O.create(e))}},{key:"setTableStatus",value:function(e){this.setProperty("tableStatus",e)}},{key:"_setTableStatus",value:function(e){e=Br.ensure(e),this._setProperty("tableStatus",e)}},{key:"setTableStatusVisible",value:function(e){this.setProperty("tableStatusVisible",e),this._updateFooterVisibility()}},{key:"_updateFooterVisibility",value:function(){this.setFooterVisible(this.tableStatusVisible||this._hasVisibleTableControls())}},{key:"setHierarchicalStyle",value:function(e){this.setProperty("hierarchicalStyle",e)}},{key:"_renderHierarchicalStyle",value:function(){this.$container.toggleClass("structured",i.HierarchicalStyle.STRUCTURED===this.hierarchicalStyle)}},{key:"setFooterVisible",value:function(e){this._setProperty("footerVisible",e),e&&!this.footer&&(this.footer=this._createFooter()),this.tableControls.forEach((function(e){e.tableFooter=this.footer}),this),this.rendered&&this._renderFooterVisible(),!e&&this.footer&&(this.footer.destroy(),this.footer=null)}},{key:"_renderBackgroundEffect",value:function(){this.columns.forEach((function(e){e.backgroundEffect&&e._renderBackgroundEffect()}),this)}},{key:"_renderRowChecked",value:function(e){if(this.checkable&&e.$row){var t;if(this.checkableStyle===i.CheckableStyle.TABLE_ROW)t=e.$row;else{if(!this.checkableColumn)throw new Error("checkableColumn not set");t=this.checkableColumn.$checkBox(e.$row)}t.toggleClass("checked",e.checked)}}},{key:"setCheckable",value:function(e){this.setProperty("checkable",e)}},{key:"_setCheckable",value:function(e){this._setProperty("checkable",e),this._updateCheckableColumn()}},{key:"_updateCheckableColumn",value:function(){var e=this.checkableColumn,t=this.checkable&&O.isOneOf(this.checkableStyle,i.CheckableStyle.CHECKBOX,i.CheckableStyle.CHECKBOX_TABLE_ROW);t&&!e?(this._insertBooleanColumn(),this._calculateTableNodeColumn(),this.trigger("columnStructureChanged")):!t&&e&&e.guiOnly&&(e.destroy(),rt.remove(this.columns,e),this.checkableColumn=null,this._calculateTableNodeColumn(),this.trigger("columnStructureChanged"))}},{key:"_renderCheckable",value:function(){this.columnLayoutDirty=!0,this._updateRowWidth(),this._redraw(),this.invalidateLayoutTree()}},{key:"setCheckableStyle",value:function(e){this.setProperty("checkableStyle",e)}},{key:"_setCheckableStyle",value:function(e){this._setProperty("checkableStyle",e),this._updateCheckableColumn()}},{key:"_renderCheckableStyle",value:function(){this.$container.toggleClass("checkable",O.isOneOf(this.checkableStyle,i.CheckableStyle.TABLE_ROW,i.CheckableStyle.CHECKBOX_TABLE_ROW)),this.$container.toggleClass("table-row-check",this.checkableStyle===i.CheckableStyle.TABLE_ROW),this._isDataRendered()&&this._redraw()}},{key:"setCompact",value:function(e){this.setProperty("compact",e)}},{key:"_setCompact",value:function(e){this._setProperty("compact",e),this._updateCompactColumn(),this.compactHandler&&this.compactHandler.handle(this.compact)}},{key:"_updateCompactColumn",value:function(){var e=this.compactColumn;return this.compact&&!e?(this._insertCompactColumn(),!0):!(this.compact||!e||(e.destroy(),rt.remove(this.columns,e),this.compactColumn=null,0))}},{key:"_insertCompactColumn",value:function(){var e=O.create("CompactColumn",{session:this.session,table:this,guiOnly:!0,headerMenuEnabled:!1});this.columns.push(e),this.compactColumn=e}},{key:"_renderCompact",value:function(){this.columnLayoutDirty=!0,this._updateRowWidth(),this._redraw(),this.invalidateLayoutTree()}},{key:"setGroupingStyle",value:function(e){this.setProperty("groupingStyle",e)}},{key:"_setGroupingStyle",value:function(e){this._setProperty("groupingStyle",e),this._group()}},{key:"_renderGroupingStyle",value:function(){this._rerenderViewport()}},{key:"_redraw",value:function(){this._isDataRendered()&&(this._rerenderHeaderColumns(),this._rerenderViewport())}},{key:"_rerenderHeaderColumns",value:function(){this.header&&(this.header.rerenderColumns(),this.invalidateLayoutTree())}},{key:"_renderTableHeader",value:function(){if(!this.tileMode){var e=!1;this.headerVisible&&!this.header?(this.header=this._createHeader(),this.header.render(),this._renderEmptyData(),e=!0):!this.headerVisible&&this.header&&(this._removeTableHeader(),this._removeEmptyData(),e=!0),this.$container.toggleClass("header-invisible",!this.header),e&&this.invalidateLayoutTree()}}},{key:"_removeTableHeader",value:function(){this.header&&(this.header.destroy(),this.header=null)}},{key:"_renderEmptyData",value:function(){!this.header||this.visibleRows.length>0||(this.$emptyData||(this.$emptyData=this.$data.appendDiv().html("&nbsp;")),this.$emptyData.css("min-width",this.rowWidth).css("max-width",this.rowWidth),this.updateScrollbars())}},{key:"_removeEmptyData",value:function(){this.header&&0===this.visibleRows.length||this.$emptyData&&(this.$emptyData.remove(),this.$emptyData=null,this.updateScrollbars())}},{key:"_renderFooterVisible",value:function(){this.footer&&(this.footerVisible?this._renderFooter():this._removeFooter(),this.invalidateLayoutTree())}},{key:"_renderFooter",value:function(){this.footer.rendered||this.footer.render()}},{key:"_removeFooter",value:function(){this.footer.rendered&&this.footer.remove()}},{key:"_renderEnabled",value:function(){gx(Ox(i.prototype),"_renderEnabled",this).call(this),this._installOrUninstallDragAndDropHandler();var e=this.enabledComputed;this.tileMode||this.$data.setEnabled(e),this.$container.setTabbable(e),this._isDataRendered()&&this.$rows().each((function(){var t=s()(this),n=t.data("row");t.find("input").setEnabled(e&&n.enabled)}))}},{key:"_renderDisabledStyle",value:function(){gx(Ox(i.prototype),"_renderDisabledStyle",this).call(this),this._renderDisabledStyleInternal(this.$data)}},{key:"setAutoResizeColumns",value:function(e){this.setProperty("autoResizeColumns",e)}},{key:"_renderAutoResizeColumns",value:function(){!this.autoResizeColumns&&Kt.get().hasTableCellZoomBug()&&this.visibleColumns().forEach((function(e,t){e._realWidth=null})),this.columnLayoutDirty=!0,this.invalidateLayoutTree()}},{key:"setMultilineText",value:function(e){this.setProperty("multilineText",e)}},{key:"_renderMultilineText",value:function(){this._markAutoOptimizeWidthColumnsAsDirty(),this._redraw(),this.invalidateLayoutTree()}},{key:"setDropType",value:function(e){this.setProperty("dropType",e)}},{key:"_renderDropType",value:function(){this._installOrUninstallDragAndDropHandler()}},{key:"setDropMaximumSize",value:function(e){this.setProperty("dropMaximumSize",e)}},{key:"_createDragAndDropHandler",value:function(){var e=this;return rn.handler(this,{supportedScoutTypes:rn.SCOUT_TYPES.FILE_TRANSFER,onDrop:function(t){return e.trigger("drop",t)},dropType:function(){return e.dropType},dropMaximumSize:function(){return e.dropMaximumSize},additionalDropProperties:function(e){var t=s()(e.currentTarget),n={rowId:""};if(t.hasClass("table-row")){var r=t.data("row");n.rowId=r.id}return n}})}},{key:"_installOrUninstallDragAndDropHandler",value:function(){this.dropType&&this.enabledComputed?this._installDragAndDropHandler():this._uninstallDragAndDropHandler()}},{key:"_installDragAndDropHandler",value:function(){this.dragAndDropHandler||(this.dragAndDropHandler=this._createDragAndDropHandler(),this.dragAndDropHandler&&this.dragAndDropHandler.install(this.$container,".table-data,.table-row"))}},{key:"_uninstallDragAndDropHandler",value:function(){this.dragAndDropHandler&&(this.dragAndDropHandler.uninstall(),this.dragAndDropHandler=null)}},{key:"_installImageListeners",value:function(){this._imageLoadListener=this._onImageLoadOrError.bind(this),this.$data[0].addEventListener("load",this._imageLoadListener,!0),this.$data[0].addEventListener("error",this._imageLoadListener,!0)}},{key:"_uninstallImageListeners",value:function(){this.$data[0].removeEventListener("load",this._imageLoadListener,!0),this.$data[0].removeEventListener("error",this._imageLoadListener,!0)}},{key:"calculateViewRangeSize",value:function(){if(this._updateRowHeight(),0===this.rowHeight)throw new Error("Cannot calculate view range with rowHeight = 0");return 2*Math.ceil(this.$data.outerHeight()/this.rowHeight)}},{key:"setViewRangeSize",value:function(e){this.viewRangeSize!==e&&(this._setProperty("viewRangeSize",e),this._isDataRendered()&&this._renderViewport())}},{key:"_calculateCurrentViewRange",value:function(){var e,t=this.$data[0].scrollTop;return e=0==this.$data[0].scrollHeight-this.$data[0].clientHeight?0:this._rowIndexAtScrollTop(t),this._calculateViewRangeForRowIndex(e)}},{key:"_rowIndexAtScrollTop",value:function(e){var t=this,n=0,r=-1;return this.visibleRows.some((function(o,i){return n+=t._heightForRow(o),e<n&&(r=i,!0)})),r}},{key:"_heightForRow",value:function(e){var t=0,n=e.aggregateRowAfter;return t=e.height?e.height:this.rowHeight,n&&(n.height?t+=n.height:t+=this.aggregateRowHeight),t}},{key:"_calculateViewRangeForRowIndex",value:function(e){if(!this.virtual)return new Fr(0,this.visibleRows.length);var t=new Fr,n=Math.floor(this.viewRangeSize/4);return t.from=Math.max(e-n,0),t.to=Math.min(t.from+this.viewRangeSize,this.visibleRows.length),this.viewRangeSize-t.size()>0&&(t.from=Math.max(t.to-this.viewRangeSize,0)),t}},{key:"_renderViewport",value:function(){if(this.isAttachedAndRendered()){if(!this._renderViewportBlocked&&0!==this.visibleColumns().length)if(this.$container.isEveryParentVisible()){var e=this._calculateCurrentViewRange();this._renderViewRange(e)}else this.invalidateLayoutTree()}else this._renderViewPortAfterAttach=!0}},{key:"_rerenderViewport",value:function(){this.isAttachedAndRendered()?(this._removeRows(),this._removeAggregateRows(),this._renderFiller(),this._renderViewport()):this._rerenderViewPortAfterAttach=!0}},{key:"_renderViewRangeForRowIndex",value:function(e){var t=this._calculateViewRangeForRowIndex(e);this._renderViewRange(t)}},{key:"_renderViewRange",value:function(e){var t=this;if(e.from!==this.viewRangeRendered.from||e.to!==this.viewRangeRendered.to||this.viewRangeDirty){this._removeRangeMarkers();var n=e.subtract(this.viewRangeRendered);if(this.viewRangeRendered.subtract(e).forEach((function(e){t._removeRowsInRange(e)})),n.forEach((function(e){t._renderRowsInRange(e)})),this.viewRangeRendered.size()>0){var r=this.visibleRows,o=r[this.viewRangeRendered.from],i=r[this.viewRangeRendered.to-1];if(!o.$row||!i.$row)throw new Error("Rows not rendered as expected. "+this.viewRangeRendered+". First: "+o.$row+". Last: "+i.$row)}this._renderRangeMarkers(),this._removeAggregateRows(),this._renderAggregateRows(),this._renderFiller(),this._renderEmptyData(),this._renderBackgroundEffect(),this._renderSelection(),this.viewRangeDirty=!1}}},{key:"_removeRangeMarkers",value:function(){this._modifyRangeMarkers("removeClass")}},{key:"_renderRangeMarkers",value:function(){this._modifyRangeMarkers("addClass")}},{key:"_modifyRangeMarkers",value:function(e){if(0!==this.viewRangeRendered.size()){var t=this.visibleRows;n(t[this.viewRangeRendered.from],"first"),n(t[this.viewRangeRendered.to-1],"last")}function n(t,n){t&&t.$row&&t.$row[e](n)}}},{key:"ensureRowRendered",value:function(e){if(!e.$row){var t=this.visibleRows.indexOf(e);t<0||this._renderViewRangeForRowIndex(t)}}},{key:"_renderFiller",value:function(){this.$fillBefore||(this.$fillBefore=this.$data.prependDiv("table-data-fill"),this._applyFillerStyle(this.$fillBefore));var e=this._calculateFillerHeight(new Fr(0,this.viewRangeRendered.from));this.$fillBefore.cssHeight(e),this.$fillBefore.cssWidth(this.rowWidth),s.a.log.isTraceEnabled()&&s.a.log.trace("FillBefore height: "+e),this.$fillAfter||(this.$fillAfter=this.$data.appendDiv("table-data-fill"),this._applyFillerStyle(this.$fillAfter));var t=this._calculateFillerHeight(new Fr(this.viewRangeRendered.to,this.visibleRows.length));this.$fillAfter.cssHeight(t),this.$fillAfter.cssWidth(this.rowWidth),s.a.log.isTraceEnabled()&&s.a.log.trace("FillAfter height: "+t)}},{key:"_applyFillerStyle",value:function(e){var t=e.css("background-color"),n=(100*(1-1/this.rowHeight)).toFixed(2)+"%";e.css({background:"linear-gradient(to bottom, transparent, transparent "+n+", "+t+" "+n+", "+t+")",backgroundSize:"100% "+this.rowHeight+"px",backgroundColor:"transparent"})}},{key:"_calculateFillerHeight",value:function(e){for(var t=0,n=e.from;n<e.to;n++){var r=this.visibleRows[n];t+=this._heightForRow(r)}return t}},{key:"containsAggregatedNumberColumn",value:function(){return!!this.initialized&&this.visibleColumns().some((function(e){return e instanceof r$&&"none"!==e.aggregationFunction}))}},{key:"updateColumnStructure",value:function(e){this._destroyColumns(),this.columns=e,this._initColumns(),this.trigger("columnStructureChanged"),this._isDataRendered()&&(this._updateRowWidth(),this.$rows(!0).css("width",this.rowWidth),this._rerenderHeaderColumns(),this._renderEmptyData())}},{key:"updateColumnOrder",value:function(e){var t,n,r,o;if(e.length!==this.columns.length)throw new Error("Column order may not be updated because lengths of the arrays differ.");for(o=this.columns.slice(),t=0;t<e.length;t++){if(n=e[t],(r=this.columns.indexOf(n))<0)throw new Error("Column with id "+n.id+"not found.");r!==t&&(rt.remove(this.columns,n),rt.insert(this.columns,n,t))}this._isDataRendered()&&this._renderColumnOrderChanges(o)}},{key:"updateColumnHeaders",value:function(e){for(var t,n,r=0;r<e.length;r++)t=this.columnById(e[r].id),n=s.a.extend(n,t),t.text=e[r].text,t.headerTooltipText=e[r].headerTooltipText,t.headerTooltipHtmlEnabled=e[r].headerTooltipHtmlEnabled,t.headerCssClass=e[r].headerCssClass,t.headerHtmlEnabled=e[r].headerHtmlEnabled,t.headerBackgroundColor=e[r].headerBackgroundColor,t.headerForegroundColor=e[r].headerForegroundColor,t.headerFont=e[r].headerFont,t.headerIconId=e[r].headerIconId,t.sortActive=e[r].sortActive,t.sortAscending=e[r].sortAscending,t.grouped&&!e[r].grouped&&this._removeGroupColumn(t),t.grouped=e[r].grouped,t.sortActive||-1===t.sortIndex?t.grouped&&t.sortActive&&-1===t.sortIndex?this._addGroupColumn(t):t.sortActive&&-1===t.sortIndex?this._addSortColumn(t):t.sortIndex=e[r].sortIndex:this._removeSortColumn(t),this._isDataRendered()&&this.header&&this.header.updateHeader(t,n)}},{key:"focusCell",value:function(e,t){if(this._isDataRendered()&&this.isAttachedAndRendered()){var n=this.cell(e,t);this.enabledComputed&&t.enabled&&n.editable&&this.prepareCellEdit(e,t,!1)}else this._postRenderActions.push(this.focusCell.bind(this,e,t))}},{key:"_attach",value:function(){this.$parent.append(this.$container),gx(Ox(i.prototype),"_attach",this).call(this)}},{key:"_postAttach",value:function(){var e=this.htmlComp.getParent();this.htmlComp.setSize(e.size()),gx(Ox(i.prototype),"_postAttach",this).call(this)}},{key:"_renderOnAttach",value:function(){gx(Ox(i.prototype),"_renderOnAttach",this).call(this),this._rerenderViewPortAfterAttach?(this._rerenderViewport(),this._rerenderViewPortAfterAttach=!1):this._renderViewPortAfterAttach&&(this._renderViewport(),this._renderViewPortAfterAttach=!1)}},{key:"_detach",value:function(){this.$container.detach(),gx(Ox(i.prototype),"_detach",this).call(this)}},{key:"_onDetach",value:function(){gx(Ox(i.prototype),"_onDetach",this).call(this),this._destroyCellEditorPopup()}},{key:"_destroyCellEditorPopup",value:function(e){var t=this;if(this.cellEditorPopup){var n=function(){t.cellEditorPopup.destroy(),t.cellEditorPopup=null,e&&e()},r=this.cellEditorPopup.waitForCompleteCellEdit();"resolved"===r.state()?n():r.then(n)}}},{key:"setVirtual",value:function(e){this._setProperty("virtual",e)}},{key:"setCellValue",value:function(e,t,n){e.setCellValue(t,n)}},{key:"setCellText",value:function(e,t,n){e.setCellText(t,n)}},{key:"setCellErrorStatus",value:function(e,t,n){e.setCellErrorStatus(t,n)}},{key:"visibleColumns",value:function(e){return this.filterColumns((function(e){return e.isVisible()}),e)}},{key:"displayableColumns",value:function(e){return this.filterColumns((function(e){return e.displayable}),e)}},{key:"filterColumns",value:function(e,t){return t=O.nvl(t,!0),this.columns.filter((function(n){return e(n)&&(t||!n.guiOnly)}))}},{key:"_onDesktopPopupOpen",value:function(e){var t=this,n=e.popup;this.enabledComputed&&this.has(n)&&n instanceof Qg&&(this.$container.addClass("focused"),n.one("destroy",(function(){t._isDataRendered()&&t.$container.removeClass("focused")})))}},{key:"_onDesktopPropertyChange",value:function(e){"dense"===e.propertyName&&this.menuBar.invalidateLayoutTree()}},{key:"markRowsAsNonChanged",value:function(e){rt.ensure(e||this.rows).forEach((function(e){e.status=Ix.Status.NON_CHANGED}))}}])&&mx(t.prototype,n),r&&mx(t,r),i}(ve);function Px(e){return(Px="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Rx(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function xx(e,t,n){return(xx="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Fx(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function Ex(e,t){return(Ex=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Dx(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Fx(e);if(t){var o=Fx(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Ax(this,n)}}function Ax(e,t){return!t||"object"!==Px(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Fx(e){return(Fx=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}Tx(Cx,"HierarchicalStyle",{DEFAULT:"default",STRUCTURED:"structured"}),Tx(Cx,"GroupingStyle",{TOP:"top",BOTTOM:"bottom"}),Tx(Cx,"CheckableStyle",{CHECKBOX:"checkbox",TABLE_ROW:"tableRow",CHECKBOX_TABLE_ROW:"checkbox_table_row"}),Tx(Cx,"ReloadReason",{UNSPECIFIED:"unspecified",SEARCH:"search",OVERRIDE_ROW_LIMIT:"overrideRowLimit",RESET_ROW_LIMIT:"resetRowLimit",ORGANIZE_COLUMNS:"organizeColumns",DATA_CHANGED_TRIGGER:"dataChangedTrigger"}),Tx(Cx,"SELECTION_CLASSES","select-middle select-top select-bottom select-single selected");var $x=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ex(e,t)}(i,e);var t,n,r,o=Dx(i);function i(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(e=o.call(this))._addRemoteProperties(["contextColumn"]),e}return t=i,r=[{key:"modifyTablePrototype",value:function(){E.get().remote&&(Pr.replacePrototypeFunction(Cx,"_sortAfterInsert",(function(e){this.modelAdapter?e&&this._group():this._sortAfterInsertOrig(e)}),!0),Pr.replacePrototypeFunction(Cx,"_sortAfterUpdate",(function(){this.modelAdapter?this._group():this._sortAfterUpdateOrig()}),!0),Pr.replacePrototypeFunction(Cx,"_isSortingPossible",(function(e){return this.modelAdapter?O.nvl(this.uiSortPossible,!0)&&this._isSortingPossibleOrig(e):this._isSortingPossibleOrig(e)}),!0),Pr.replacePrototypeFunction(Cx,"sort",(function(e,t,n,r){this.modelAdapter&&e.guiOnly||this.sortOrig(e,t,n,r)}),!0),Pr.replacePrototypeFunction(Cx,"_createTileTableHeader",(function(){if(!this.modelAdapter)return this._createTileTableHeaderOrig()}),!0),Pr.replacePrototypeFunction(Cx,"createTiles",(function(e){if(!this.modelAdapter)return this.createTilesOrig(e)}),!0))}},{key:"modifyColumnPrototype",value:function(){E.get().remote&&(Pr.replacePrototypeFunction(qA,"init",(function(e){e.table&&e.table.modelAdapter&&(e=s.a.extend({},e),Mt.applyTo(e)),this.initOrig(e)}),!0),Pr.replacePrototypeFunction(qA,"_ensureCell",(function(e){var t;return this.table.modelAdapter?(Pr.isPlainObject(e)?((t=e).value=this._parseValue(t.value),t.text&&void 0===t.value&&!t.errorStatus&&(t.value=this._parseValue(t.text)),void 0===t.value&&(t.value=null)):t={value:this._parseValue(e)},Mt.applyTo(t,"Cell"),O.create("Cell",t)):this._ensureCellOrig(e)}),!0),Pr.replacePrototypeFunction(qA,"isSortingPossible",(function(){return this.table.modelAdapter?O.nvl(this.uiSortPossible,!0)&&this.installComparator():this.isSortingPossibleOrig()}),!0))}},{key:"modifyBooleanColumnPrototype",value:function(){E.get().remote&&Pr.replacePrototypeFunction(mF,"_toggleCellValue",(function(e,t){this.table.modelAdapter||this._toggleCellValueOrig(e,t)}),!0)}}],(n=[{key:"_initProperties",value:function(e){xx(Fx(i.prototype),"_initProperties",this).call(this,e),e.compactHandler=null}},{key:"_postCreateWidget",value:function(){Pr.values(this.widget._filterMap).some((function(e){return e instanceof NI}))&&this._onWidgetFilter()}},{key:"_sendRowsSelected",value:function(e,t){var n={rowIds:e};this._send("rowsSelected",n,{delay:t?250:0,coalesce:function(e){return this.target===e.target&&this.type===e.type}})}},{key:"_sendRowClick",value:function(e,t,n){var r={rowId:e,columnId:n,mouseButton:t};this._send("rowClick",r)}},{key:"_onWidgetRowsSelected",value:function(e){var t=this.widget._rowsToIds(this.widget.selectedRows);this._sendRowsSelected(t,e.debounce)}},{key:"_onWidgetRowClick",value:function(e){var t;void 0!==e.column&&(t=e.column.id),this._sendRowClick(e.row.id,e.mouseButton,t)}},{key:"_onWidgetFilterAdded",value:function(e){var t=e.filter;t instanceof NI&&!(t instanceof YI&&t.column.guiOnly)&&this._send("filterAdded",t.createFilterAddedEventData())}},{key:"_onWidgetFilterRemoved",value:function(e){var t=e.filter;t instanceof NI&&!(t instanceof YI&&t.column.guiOnly)&&this._send("filterRemoved",t.createFilterRemovedEventData())}},{key:"_onWidgetColumnResized",value:function(e){this._sendColumnResized(e.column)}},{key:"_sendColumnResized",value:function(e){if(!(e.fixedWidth||e.guiOnly||this.widget.autoResizeColumns)){var t={columnId:e.id,width:e.width};this._send("columnResized",t,{delay:750,coalesce:function(e){return this.target===e.target&&this.type===e.type&&this.columnId===e.columnId},showBusyIndicator:!1})}}},{key:"_onWidgetAggregationFunctionChanged",value:function(e){this._sendAggregationFunctionChanged(e.column)}},{key:"_sendAggregationFunctionChanged",value:function(e){if(!e.guiOnly){var t={columnId:e.id,aggregationFunction:e.aggregationFunction};this._send("aggregationFunctionChanged",t)}}},{key:"_onWidgetColumnBackgroundEffectChanged",value:function(e){this._sendColumnBackgroundEffectChanged(e.column)}},{key:"_sendColumnBackgroundEffectChanged",value:function(e){if(!e.guiOnly){var t={columnId:e.id,backgroundEffect:e.backgroundEffect};this._send("columnBackgroundEffectChanged",t)}}},{key:"_onWidgetColumnOrganizeAction",value:function(e){this._send("columnOrganizeAction",{action:e.action,columnId:e.column.id})}},{key:"_onWidgetColumnMoved",value:function(e){var t=e.newPos;this.widget.columns.forEach((function(e,n){e.guiOnly&&t--})),this._sendColumnMoved(e.column,t)}},{key:"_sendColumnMoved",value:function(e,t){if(!e.guiOnly){var n={columnId:e.id,index:t};this._send("columnMoved",n)}}},{key:"_onWidgetPrepareCellEdit",value:function(e){e.preventDefault(),this._sendPrepareCellEdit(e.row,e.column)}},{key:"_sendPrepareCellEdit",value:function(e,t){if(!t.guiOnly){var n={rowId:e.id,columnId:t.id};this._send("prepareCellEdit",n)}}},{key:"_onWidgetCompleteCellEdit",value:function(e){e.preventDefault(),this._sendCompleteCellEdit(e.field)}},{key:"_sendCompleteCellEdit",value:function(e){var t={fieldId:e.id};this._send("completeCellEdit",t)}},{key:"_onWidgetCancelCellEdit",value:function(e){e.preventDefault(),this._sendCancelCellEdit(e.field)}},{key:"_sendCancelCellEdit",value:function(e){var t={fieldId:e.id};this._send("cancelCellEdit",t)}},{key:"_onWidgetRowsChecked",value:function(e){this._sendRowsChecked(e.rows)}},{key:"_sendRowsChecked",value:function(e){for(var t={rows:[]},n=0;n<e.length;n++)t.rows.push({rowId:e[n].id,checked:e[n].checked});this._send("rowsChecked",t)}},{key:"_onWidgetRowsExpanded",value:function(e){this._sendRowsExpanded(e.rows)}},{key:"_sendRowsExpanded",value:function(e){var t={rows:e.map((function(e){return{rowId:e.id,expanded:e.expanded}}))};this._send("rowsExpanded",t)}},{key:"_onWidgetFilter",value:function(e){var t=this.widget._rowsToIds(this.widget.filteredRows());this._sendFilter(t)}},{key:"_sendFilter",value:function(e){var t={};e.length===this.widget.rows.length?t.remove=!0:t.rowIds=e,this._send("filter",t,{delay:250,coalesce:function(e){return this.target===e.target&&this.type===e.type&&this.remove===e.remove},showBusyIndicator:!1})}},{key:"_onWidgetSort",value:function(e){e.column.guiOnly||this._send("sort",{columnId:e.column.id,sortAscending:e.sortAscending,sortingRemoved:e.sortingRemoved,multiSort:e.multiSort,sortingRequested:e.sortingRequested})}},{key:"_onWidgetGroup",value:function(e){e.column.guiOnly||this._send("group",{columnId:e.column.id,groupAscending:e.groupAscending,groupingRemoved:e.groupingRemoved,multiGroup:e.multiGroup,groupingRequested:e.groupingRequested})}},{key:"_onWidgetRowAction",value:function(e){this._sendRowAction(e.row,e.column)}},{key:"_sendRowAction",value:function(e,t){t.guiOnly&&(t=rt.find(this.columns,(function(e){return!e.guiOnly})));var n=t?t.id:null;this._send("rowAction",{rowId:e.id,columnId:n})}},{key:"_onWidgetAppLinkAction",value:function(e){this._sendAppLinkAction(e.column,e.ref)}},{key:"_sendAppLinkAction",value:function(e,t){this._send("appLinkAction",{columnId:e.id,ref:t})}},{key:"_sendContextColumn",value:function(e){e.guiOnly&&(e=null,this.widget.contextColumn=null);var t=null;e&&(t=e.id),this._send("property",{contextColumn:t})}},{key:"_onWidgetReload",value:function(e){var t={reloadReason:e.reloadReason};this._send("reload",t)}},{key:"_onWidgetExportToClipboard",value:function(e){this._send("clipboardExport"),e.preventDefault()}},{key:"_onWidgetEvent",value:function(e){"rowsSelected"===e.type?this._onWidgetRowsSelected(e):"rowsChecked"===e.type?this._onWidgetRowsChecked(e):"rowsExpanded"===e.type?this._onWidgetRowsExpanded(e):"filter"===e.type?this._onWidgetFilter(e):"sort"===e.type?this._onWidgetSort(e):"group"===e.type?this._onWidgetGroup(e):"rowClick"===e.type?this._onWidgetRowClick(e):"rowAction"===e.type?this._onWidgetRowAction(e):"prepareCellEdit"===e.type?this._onWidgetPrepareCellEdit(e):"completeCellEdit"===e.type?this._onWidgetCompleteCellEdit(e):"cancelCellEdit"===e.type?this._onWidgetCancelCellEdit(e):"appLinkAction"===e.type?this._onWidgetAppLinkAction(e):"clipboardExport"===e.type?this._onWidgetExportToClipboard(e):"reload"===e.type?this._onWidgetReload(e):"filterAdded"===e.type?this._onWidgetFilterAdded(e):"filterRemoved"===e.type?this._onWidgetFilterRemoved(e):"columnResized"===e.type?this._onWidgetColumnResized(e):"columnMoved"===e.type?this._onWidgetColumnMoved(e):"columnBackgroundEffectChanged"===e.type?this._onWidgetColumnBackgroundEffectChanged(e):"columnOrganizeAction"===e.type?this._onWidgetColumnOrganizeAction(e):"aggregationFunctionChanged"===e.type?this._onWidgetAggregationFunctionChanged(e):"drop"===e.type&&this.widget.dragAndDropHandler?this.widget.dragAndDropHandler.uploadFiles(e.files):xx(Fx(i.prototype),"_onWidgetEvent",this).call(this,e)}},{key:"_onRowsInserted",value:function(e){this.widget.insertRows(e),this._rebuildingTable=!1}},{key:"_onRowsDeleted",value:function(e){var t=this.widget._rowsByIds(e);this.addFilterForWidgetEventType("rowsSelected"),this.widget.deleteRows(t)}},{key:"_onAllRowsDeleted",value:function(){this.addFilterForWidgetEventType("rowsSelected"),this.widget.deleteAllRows()}},{key:"_onRowsUpdated",value:function(e){this.widget.updateRows(e)}},{key:"_onRowsSelected",value:function(e){var t=this.widget._rowsByIds(e);this.addFilterForWidgetEventType("rowsSelected"),this.widget.selectRows(t),this.widget.selectionHandler.clearLastSelectedRowMarker()}},{key:"_onRowsChecked",value:function(e){var t=[],n=[];e.forEach((function(e){var r=this.widget._rowById(e.id);e.checked?t.push(r):n.push(r)}),this),this.addFilterForWidgetEventType("rowsChecked"),this.widget.checkRows(t,{checked:!0,checkOnlyEnabled:!1}),this.widget.uncheckRows(n,{checkOnlyEnabled:!1})}},{key:"_onRowsExpanded",value:function(e){var t=[],n=[];e.forEach((function(e){var r=this.widget._rowById(e.id);e.expanded?t.push(r):n.push(r)}),this),this.addFilterForWidgetEventType("rowsExpanded"),this.widget.expandRows(t),this.widget.collapseRows(n)}},{key:"_onRowOrderChanged",value:function(e){var t=this.widget._rowsByIds(e);this.widget.updateRowOrder(t)}},{key:"_onColumnStructureChanged",value:function(e){this._rebuildingTable=!0,this.widget.updateColumnStructure(e)}},{key:"_onColumnOrderChanged",value:function(e){var t=this.widget.columnsByIds(e);this.widget.updateColumnOrder(t)}},{key:"_onColumnHeadersUpdated",value:function(e){e.forEach((function(e){Mt.applyTo(e)})),this.widget.updateColumnHeaders(e),this.widget.tileMode&&this.widget.tableTileGridMediator&&(this.widget.tableTileGridMediator._onTableGroup(),this.widget.updateRowOrder(this.widget.rows))}},{key:"_onStartCellEdit",value:function(e,t,n){var r=this.widget.columnById(e),o=this.widget._rowById(t),i=this.session.getOrCreateWidget(n,this.widget);this.widget.startCellEdit(r,o,i)}},{key:"_onEndCellEdit",value:function(e){var t=this.session.getModelAdapter(e);this.widget.endCellEdit(t.widget)}},{key:"_onRequestFocus",value:function(){this.widget.focus()}},{key:"_onScrollToSelection",value:function(){this.widget.revealSelection()}},{key:"_onColumnBackgroundEffectChanged",value:function(e){e.eventParts.forEach((function(e){var t=this.widget.columnById(e.columnId),n=e.backgroundEffect;this.addFilterForWidgetEvent((function(e){return"columnBackgroundEffectChanged"===e.type&&e.column.id===t.id&&e.column.backgroundEffect===n})),t.setBackgroundEffect(n)}),this)}},{key:"_onRequestFocusInCell",value:function(e){var t=this.widget._rowById(e.rowId),n=this.widget.columnById(e.columnId);this.widget.focusCell(n,t)}},{key:"_onAggregationFunctionChanged",value:function(e){var t=[],n=[];e.eventParts.forEach((function(e){var r=e.aggregationFunction,o=this.widget.columnById(e.columnId);this.addFilterForWidgetEvent((function(e){return"aggregationFunctionChanged"===e.type&&e.column.id===o.id&&e.column.aggregationFunction===r})),t.push(o),n.push(r)}),this),this.widget.changeAggregations(t,n)}},{key:"_onFiltersChanged",value:function(e){this.addFilterForWidgetEventType("filterAdded"),this.addFilterForWidgetEventType("filterRemoved"),this.widget.setFilters(e),this._rebuildingTable||this.widget.filter()}},{key:"onModelAction",value:function(e){"rowsInserted"===e.type?this._onRowsInserted(e.rows):"rowsDeleted"===e.type?this._onRowsDeleted(e.rowIds):"allRowsDeleted"===e.type?this._onAllRowsDeleted():"rowsSelected"===e.type?this._onRowsSelected(e.rowIds):"rowOrderChanged"===e.type?this._onRowOrderChanged(e.rowIds):"rowsUpdated"===e.type?this._onRowsUpdated(e.rows):"filtersChanged"===e.type?this._onFiltersChanged(e.filters):"rowsChecked"===e.type?this._onRowsChecked(e.rows):"rowsExpanded"===e.type?this._onRowsExpanded(e.rows):"columnStructureChanged"===e.type?this._onColumnStructureChanged(e.columns):"columnOrderChanged"===e.type?this._onColumnOrderChanged(e.columnIds):"columnHeadersUpdated"===e.type?this._onColumnHeadersUpdated(e.columns):"startCellEdit"===e.type?this._onStartCellEdit(e.columnId,e.rowId,e.fieldId):"endCellEdit"===e.type?this._onEndCellEdit(e.fieldId):"requestFocus"===e.type?this._onRequestFocus():"scrollToSelection"===e.type?this._onScrollToSelection():"aggregationFunctionChanged"===e.type?this._onAggregationFunctionChanged(e):"columnBackgroundEffectChanged"===e.type?this._onColumnBackgroundEffectChanged(e):"requestFocusInCell"===e.type?this._onRequestFocusInCell(e):xx(Fx(i.prototype),"onModelAction",this).call(this,e)}},{key:"exportAdapterData",value:function(e){return delete(e=xx(Fx(i.prototype),"exportAdapterData",this).call(this,e)).selectedRows,e.rows=[],e.columns.forEach((function(e){delete e.classId,delete e.modelClass})),e}}])&&Rx(t.prototype,n),r&&Rx(t,r),i}(de);function jx(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}E.addListener("bootstrap",$x.modifyTablePrototype),E.addListener("bootstrap",$x.modifyColumnPrototype),E.addListener("bootstrap",$x.modifyBooleanColumnPrototype);var Bx=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.table=null,this.useOnlyVisibleColumns=!0,this.maxContentLines=3,this._oldStates=Pr.createMap(),this._updateHandler=null}var t,n,r;return t=e,(n=[{key:"init",value:function(e){$.extend(this,e)}},{key:"setUseOnlyVisibleColumns",value:function(e){this.useOnlyVisibleColumns=e}},{key:"setMaxContentLines",value:function(e){this.maxContentLines=e}},{key:"handle",value:function(e){e?(this._compactColumns(!0),this._attachTableHandler()):(this._detachTableHandler(),this._compactColumns(!1)),this._adjustTable(e),e&&this.updateValues(this.table.rows)}},{key:"_adjustTable",value:function(e){var t=this;e?(this._cacheAndSetProperty("headerVisible",(function(){return t.table.headerVisible}),(function(){return t.table.setHeaderVisible(!1)})),this._cacheAndSetProperty("autoResizeColumns",(function(){return t.table.autoResizeColumns}),(function(){return t.table.setAutoResizeColumns(!0)}))):(this._resetProperty("headerVisible",(function(e){return t.table.setHeaderVisible(e)})),this._resetProperty("autoResizeColumns",(function(e){return t.table.setAutoResizeColumns(e)})))}},{key:"_cacheAndSetProperty",value:function(e,t,n){Pr.isNullOrUndefined(this._oldStates[e])&&(this._oldStates[e]=t()),n()}},{key:"_resetProperty",value:function(e,t){Pr.isNullOrUndefined(this._oldStates[e])||(t(this._oldStates[e]),delete this._oldStates[e])}},{key:"_compactColumns",value:function(e){this.table.displayableColumns(!1).forEach((function(t){return t.setCompacted(e,!1)})),this.table.onColumnVisibilityChanged()}},{key:"_attachTableHandler",value:function(){null==this._updateHandler&&(this._updateHandler=this._onTableEvent.bind(this),this.table.on("rowsInserted rowsUpdated columnStructureChanged",this._updateHandler))}},{key:"_detachTableHandler",value:function(){null!=this._updateHandler&&(this.table.off("rowsInserted rowsUpdated columnStructureChanged",this._updateHandler),this._updateHandler=null)}},{key:"updateValues",value:function(e){var t=this;if(0!==e.length){var n=this._getColumns();e.forEach((function(e){return t._updateValue(n,e)}))}}},{key:"_updateValue",value:function(e,t){t.setCompactValue(this.buildValue(e,t))}},{key:"buildValue",value:function(e,t){return this._buildValue(this._createBean(e,t))}},{key:"_createBean",value:function(e,t){var n=new xF;return this._processColumns(e,t,n),this._postProcessBean(n),n}},{key:"_processColumns",value:function(e,t,n){var r=this;e.forEach((function(e,o){return r._processColumn(e,o,t,n)}))}},{key:"_getColumns",value:function(){var e=this;return this.table.filterColumns((function(t){return e._acceptColumn(t)}))}},{key:"_acceptColumn",value:function(e){return!e.guiOnly&&(!this.useOnlyVisibleColumns||e.visible&&e.displayable)}},{key:"_processColumn",value:function(e,t,n,r){this._updateBean(r,e,t,n)}},{key:"_updateBean",value:function(e,t,n,r){this._acceptColumnForTitle(t,n)?e.setTitleLine(this._createCompactLine(t,n,r)):this._acceptColumnForTitleSuffix(t,n)?e.setTitleSuffixLine(this._createCompactLine(t,n,r)):this._acceptColumnForSubtitle(t,n)?e.setSubtitleLine(this._createCompactLine(t,n,r)):e.addContentLine(this._createCompactLine(t,n,r))}},{key:"_acceptColumnForTitle",value:function(e,t){return 0===t}},{key:"_acceptColumnForSubtitle",value:function(e,t){return 1===t}},{key:"_acceptColumnForTitleSuffix",value:function(e,t){return!1}},{key:"_createCompactLine",value:function(e,t,n){var r;this._showLabel(e,t,n)&&(r=e.headerCell());var o=e.cell(n),i=new DF(r,o);return this._adaptCompactLine(i,e,r,o),i}},{key:"_showLabel",value:function(e,t,n){return!this._acceptColumnForTitle(e,t)&&!this._acceptColumnForSubtitle(e,t)&&!this._acceptColumnForTitleSuffix(e,t)}},{key:"_adaptCompactLine",value:function(e,t,n,r){if(t instanceof mF){var o="",i=r.value;i?o="X":null===i&&(o="?"),e.textBlock.setText(o)}}},{key:"_postProcessBean",value:function(e){e.transform({maxContentLines:this.maxContentLines}),!e.title||e.subtitle||e.titleSuffix||e.content||(e.setContent(e.title),e.setTitle(""))}},{key:"_buildValue",value:function(e){var t=e.title+e.titleSuffix+e.subTitle?" has-header":"",n=e.moreContent?'<div class="compact-cell-more"><span class="more-link link">'.concat(this.table.session.text("More"),"</span></div>"):"";return'\n<div class="compact-cell-header">\n  <div class="compact-cell-title">\n    <span class="left">'.concat(e.title,'</span>\n    <span class="right">').concat(e.titleSuffix,'</span>\n    </div>\n  <div class="compact-cell-subtitle">').concat(e.subtitle,'</div>\n</div>\n<div class="compact-cell-content').concat(t,'">').concat(e.content,'</div>\n<div class="compact-cell-more-content hidden').concat(t,'">').concat(e.moreContent,"</div>\n  ").concat(n)}},{key:"_onTableEvent",value:function(e){var t=e.rows;"columnStructureChanged"===e.type&&(t=this.table.rows),this.updateValues(t)}}])&&jx(t.prototype,n),r&&jx(t,r),e}();function Mx(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Ix=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.$row=null,this.aggregateRowAfter=null,this.cells=[],this.checked=!1,this.compactValue=null,this.enabled=!0,this.filterAccepted=!0,this.height=null,this.hasError=!1,this.id=null,this.initialized=!1,this.parentRow=null,this.parent=null,this.childRows=[],this.expanded=!1,this.status=e.Status.NON_CHANGED}var t,n,r;return t=e,(n=[{key:"init",value:function(e){this._init(e),this.initialized=!0}},{key:"_init",value:function(e){if(!e.parent)throw new Error("missing property 'parent'");s.a.extend(this,e),Mt.applyTo(this),this._initCells()}},{key:"_initCells",value:function(){this.getTable().columns.forEach((function(e){if(!e.guiOnly){var t=this.cells[e.index];t=e.initCell(t,this),this.cells[e.index]=t}}),this)}},{key:"animateExpansion",value:function(){var e,t=this.$row;t&&(e=t.find(".table-row-control"),this.expanded?e.addClassForAnimation("expand-rotate"):e.addClassForAnimation("collapse-rotate"))}},{key:"hasFilterAcceptedChildren",value:function(){return this.childRows.some((function(e){return e.filterAccepted||e.hasFilterAcceptedChildren()}))}},{key:"getTable",value:function(){return this.parent}},{key:"setCompactValue",value:function(e){this.compactValue=e}}])&&Mx(t.prototype,n),r&&Mx(t,r),e}();function Lx(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Hx(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}!function(e,t,n){t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}(Ix,"Status",{NON_CHANGED:"nonChanged",INSERTED:"inserted",UPDATED:"updated"});var Nx=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.session=n,this.locale=n.locale,this._allData=[],this._allAxis=[],this._rows=t.rows,this._table=t}var t,n,r;return t=e,(n=[{key:"addData",value:function(t,n){var r=[],o=this.locale;return this._allData.push(r),r.column=t,r.format=function(e){return o.decimalFormat.format(e)},n===e.NumberGroup.COUNT?(r.norm=function(e){return 1},r.group=function(e){return e.length}):n===e.NumberGroup.SUM?(r.norm=function(e){return isNaN(e)||null===e||""===e?null:parseFloat(e)},r.group=function(e){return e.reduce((function(e,t){return e+t}))}):n===e.NumberGroup.AVG&&(r.norm=function(e){return isNaN(e)||null===e||""===e?null:parseFloat(e)},r.group=function(e){var t=e.reduce((function(e,t){return e+t})),n=e.reduce((function(e,t){return null===t?e:e+1}),0);return 0===n?null:t/n}),r}},{key:"addAxis",value:function(t,n){var r=[],o=this.locale,i=this.session,s=this.session.text.bind(this.session),a=s("ui.EmptyCell");return this._allAxis.push(r),r.column=t,r.normTable=[],r.sortCodeMap={},r.add=function(e){-1===r.indexOf(e)&&r.push(e)},r.reorder=function(){r.sort((function(e,t){if(null===e)return 1;if(null===t)return-1;var n=r.sortCodeMap[e],o=r.sortCodeMap[t];return Pr.isNullOrUndefined(n)&&Pr.isNullOrUndefined(o)?e-t:GA.NUMERIC.compare(n,o)}))},r.norm=function(e){if(null===e||""===e)return null;var t=r.normTable.indexOf(e);return-1===t?r.normTable.push(e)-1:t},r.format=function(e){return null===e?a:r.normTable[e]},r.deterministicKeyToKey=function(e){return r.norm(e)},r.keyToDeterministicKey=function(e){return null===e?e:r.format(e)},r.normDeterministic=function(e){return r.keyToDeterministicKey(r.norm(e))},t instanceof NF?(n===e.DateGroup.NONE?(r.norm=function(e){return null===e||""===e?null:e.getTime()},r.format=function(e){if(null===e)return null;var n=t.format;return(n=n?tp.ensure(o,n):o.dateFormat).format(new Date(e))}):n===e.DateGroup.YEAR?(r.norm=function(e){return null===e||""===e?null:e.getFullYear()},r.format=function(e){return null===e?a:String(e)}):n===e.DateGroup.MONTH?(r.norm=function(e){return null===e||""===e?null:e.getMonth()},r.format=function(e){return null===e?a:o.dateFormatSymbols.months[e]}):n===e.DateGroup.WEEKDAY?(r.norm=function(e){return null===e||""===e?null:(e.getDay()+7-o.dateFormatSymbols.firstDayOfWeek)%7},r.format=function(e){return null===e?a:o.dateFormatSymbols.weekdaysOrdered[e]}):n===e.DateGroup.DATE&&(r.norm=function(e){return null===e||""===e?null:Et.trunc(e).getTime()},r.format=function(e){return null===e?a:Et.format(new Date(e),o,o.dateFormatPatternDefault)}),r.deterministicKeyToKey=function(e){return e},r.keyToDeterministicKey=function(e){return e},r.normDeterministic=function(e){return r.norm(e)}):t instanceof r$?(r.norm=function(e){return isNaN(e)||null===e||""===e?null:parseFloat(e)},r.format=function(e){return isNaN(e)||null===e?a:t.decimalFormat.format(e)},r.deterministicKeyToKey=function(e){return e},r.keyToDeterministicKey=function(e){return e},r.normDeterministic=function(e){return r.norm(e)}):t instanceof mF?(r.norm=function(e){return t.triStateEnabled&&null===e?-1:!0===e?1:0},r.format=function(e){return-1===e?s("ui.BooleanColumnGroupingMixed"):0===e?s("ui.BooleanColumnGroupingFalse"):1===e?s("ui.BooleanColumnGroupingTrue"):void 0},r.deterministicKeyToKey=function(e){return e},r.keyToDeterministicKey=function(e){return e},r.normDeterministic=function(e){return r.norm(e)}):t instanceof YF?(r.textIsIcon=!0,r.deterministicKeyToKey=function(e){return e},r.keyToDeterministicKey=function(e){return e},r.normDeterministic=function(e){return r.norm(e)}):r.reorder=function(){var e=GA.TEXT;e.install(i),r.sort((function(t,n){if(null===t)return 1;if(null===n)return-1;var o=r.sortCodeMap[t],i=r.sortCodeMap[n];return Pr.isNullOrUndefined(o)&&Pr.isNullOrUndefined(i)?e.compare(r.format(t),r.format(n)):GA.NUMERIC.compare(o,i)}))},r}},{key:"calculate",value:function(){var e,t,n,r,o,i,s,a={},l=0;for(e=0;e<this._rows.length;e++){var u=this._rows[e],c=[];for(n=0;n<this._allAxis.length;n++){var f=this._allAxis[n].column;o=f.cellValueOrTextForCalculation(u),void 0!==(s=this._allAxis[n].norm(o))&&(this._allAxis[n].add(s),null!==f.cell(u).sortCode&&(this._allAxis[n].sortCodeMap[s]=f.cell(u).sortCode),c.push(s))}c=JSON.stringify(c);var h=[];for(t=0;t<this._allData.length;t++)r=this._table.cellValue(this._allData[t].column,u),void 0!==(i=this._allData[t].norm(r))&&h.push(i);a[c]?a[c].push(h):(a[c]=[h],l++)}for(t=0;t<this._allData.length;t++){for(n in(r=this._allData[t]).total=0,r.min=null,r.max=null,a)if(a.hasOwnProperty(n)){for(var p=a[n],d=[],y=0;y<p.length;y++)d.push(p[y][t]);var v=this._allData[t].group(d);if(a[n][t]=v,r.total+=v,null===v)continue;(v<r.min||null===r.min)&&(r.min=v),(v>r.max||null===r.min)&&(r.max=v)}0===O.nvl(r.max,0)&&(r.max=.1);var b=Math.ceil(Math.log(r.max)/Math.LN10)-1;r.max=Math.ceil(r.max/Math.pow(10,b))*Math.pow(10,b),r.max=4*Math.ceil(r.max/4)}for(n=0;n<this._allAxis.length;n++)(o=this._allAxis[n]).min=rt.min(o),o.max=rt.max(o),-1!==o.indexOf(null)&&(o.max=o.max+1),o.reorder();return a.getValue=function(e){return e=JSON.stringify(e),a.hasOwnProperty(e)?a[e]:null},a.length=l,a}},{key:"columnCount",value:function(e){var t,n,r,o,i,s=this.columns(e),a=[],l=0;for(t=0;t<s.length;t++){for(n=s[t],a.push([n,[]]),r=0;r<this._rows.length;r++)o=this._rows[r],i=n.cellValueOrTextForCalculation(o),-1===a[l][1].indexOf(i)&&a[l][1].push(i);a[l][1]=a[l][1].length,l++}return a}},{key:"isEmpty",value:function(){return 0===this._rows.length||0===this.columns().length}},{key:"columns",value:function(e){return e=O.nvl(e,!0),this._table.visibleColumns().filter((function(t){return!(t.guiOnly||e&&t instanceof r$)}))}},{key:"isMatrixValid",value:function(){return 0===this._table.rows.length||this.columns(!1).length===this._table.rows[0].cells.length}}])&&Lx(t.prototype,n),r&&Lx(t,r),e}();function Vx(e){return(Vx="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Wx(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function zx(e,t,n){return(zx="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Yx(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function Gx(e,t){return(Gx=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Ux(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Yx(e);if(t){var o=Yx(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Kx(this,n)}}function Kx(e,t){return!t||"object"!==Vx(t)&&"function"!=typeof t?qx(e):t}function qx(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Yx(e){return(Yx=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}Hx(Nx,"DateGroup",{NONE:0,YEAR:256,MONTH:257,WEEKDAY:258,DATE:259}),Hx(Nx,"NumberGroup",{COUNT:-1,SUM:1,AVG:2});var Xx=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Gx(e,t)}(i,e);var t,n,r,o=Ux(i);function i(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(e=o.call(this))._compactStyle=!1,e.animating=!1,e.open=!1,e.resizing=!1,e.table=null,e._tableRowsChangedHandler=e._onTableRowsChanged.bind(qx(e)),e._tableFilterHandler=e._onTableFilter.bind(qx(e)),e._tableFilterAddedHandler=e._onTableFilterAdded.bind(qx(e)),e._tableFilterRemovedHandler=e._onTableFilterRemoved.bind(qx(e)),e._tableRowsSelectedHandler=e._onTableRowsSelected.bind(qx(e)),e._tableStatusChangedHandler=e._onTableStatusChanged.bind(qx(e)),e._tablePropertyChangeHandler=e._onTablePropertyChange.bind(qx(e)),e}return t=i,(n=[{key:"_init",value:function(e){zx(Yx(i.prototype),"_init",this).call(this,e),this.searchFieldKeyStrokeContext=new Vu,this.searchFieldKeyStrokeContext.$bindTarget=function(){return this._$textFilter}.bind(this),this.searchFieldKeyStrokeContext.$scopeTarget=function(){return this._$textFilter}.bind(this)}},{key:"_render",value:function(){var e,t;this.$container=this.$parent.appendDiv("table-footer"),this._$window=this.$parent.window(),this._$body=this.$parent.body(),this.htmlComp=ea.install(this.$container,this.session),this.htmlComp.setLayout(new rE(this)),this.$controlContainer=this.$container.appendDiv("table-control-container").hide(),this.$controlContent=this.$controlContainer.appendDiv("table-control-content"),this._$controls=this.$container.appendDiv("table-controls"),this._$info=this.$container.appendDiv("table-info"),t=this._$info.appendDiv("table-filter"),this._$textFilter=TW.makeTextField(this.$container,"table-text-filter").appendTo(t).on("input","",this._createOnFilterFieldInputFunction().bind(this)).placeholder(this.session.text("ui.FilterBy_")),(e=this.table.getFilter(PL.TYPE))&&this._$textFilter.val(e.text),this.$clearIcon=t.appendSpan("clear-icon unfocusable needsclick").on("mousedown",this._onDeleteFilterMouseDown.bind(this)),this._$infoLoad=this._$info.appendDiv("table-info-item table-info-load").on("click","",this._onInfoLoadClick.bind(this)),this._$infoFilter=this._$info.appendDiv("table-info-item table-info-filter").on("click","",this._onInfoFilterClick.bind(this)),this._$infoSelection=this._$info.appendDiv("table-info-item table-info-selection").on("click","",this._onInfoSelectionClick.bind(this)),this._$infoTableStatus=this._$info.appendDiv("table-info-item table-info-status").on("mousedown",this._onStatusMouseDown.bind(this)),this._$infoTableStatusIcon=this._$infoTableStatus.appendSpan("icon font-icon"),this._renderControls(),this._renderInfo(),this._updateInfoVisibility(),this.table.on("rowsInserted",this._tableRowsChangedHandler),this.table.on("rowsDeleted",this._tableRowsChangedHandler),this.table.on("allRowsDeleted",this._tableRowsChangedHandler),this.table.on("filter",this._tableFilterHandler),this.table.on("filterAdded",this._tableFilterAddedHandler),this.table.on("filterRemoved",this._tableFilterRemovedHandler),this.table.on("rowsSelected",this._tableRowsSelectedHandler),this.table.on("statusChanged",this._tableStatusChangedHandler),this.table.on("propertyChange",this._tablePropertyChangeHandler),this.session.keyStrokeManager.installKeyStrokeContext(this.searchFieldKeyStrokeContext)}},{key:"getFocusableElement",value:function(){return this._$textFilter}},{key:"_renderProperties",value:function(){this._updateHasFilterText()}},{key:"_remove",value:function(){this.session.keyStrokeManager.uninstallKeyStrokeContext(this.searchFieldKeyStrokeContext),this._hideTableStatusTooltip(),this.$resizer=null,this.$controlContainer.stop(!1,!0),this.animating=!1,this.open=!1,this.table.off("rowsInserted",this._tableRowsChangedHandler),this.table.off("rowsDeleted",this._tableRowsChangedHandler),this.table.off("allRowsDeleted",this._tableRowsChangedHandler),this.table.off("filter",this._tableFilterHandler),this.table.off("filterAdded",this._tableFilterAddedHandler),this.table.off("filterRemoved",this._tableFilterRemovedHandler),this.table.off("rowsSelected",this._tableRowsSelectedHandler),this.table.off("statusChanged",this._tableStatusChangedHandler),this.table.off("propertyChange",this._tablePropertyChangeHandler),zx(Yx(i.prototype),"_remove",this).call(this)}},{key:"_renderResizerVisible",value:function(){this.selectedControl.resizerVisible?(this._renderResizer(),this.$controlContainer.addClass("has-resizer")):this.$resizer&&(this.$resizer.remove(),this.$resizer=null,this.$controlContainer.removeClass("has-resizer"))}},{key:"_renderResizer",value:function(){this.$resizer||(this.$resizer=this.$controlContainer.prependDiv("table-control-resize").on("mousedown","",function(e){var t=this.$controlContainer.height(),n=Math.floor(e.pageY);return this._$window.on("mousemove.tablefooter",function(e){if(this.rendered){var r=Math.floor(e.pageY)-n,o=this.table.$container.height()-this.table.footer.$container.height(),i=Math.min(t-r,o);this.$controlContainer.height(i);var s=qs.insets(this.$controlContainer);this.$controlContent.outerHeight(i-s.vertical()),this._revalidateTableLayout()}}.bind(this)).one("mouseup",function(){this.selectedControl&&this.rendered&&this.$controlContainer.height()<100&&this.selectedControl.setSelected(!1),this._$window.off("mousemove.tablefooter"),this._$body.removeClass("row-resize"),this.resizing=!1}.bind(this)),this._$body.addClass("row-resize"),this.resizing=!0,!1}.bind(this)))}},{key:"_renderControls",value:function(){var e=this,t=this.table.tableControls;t?t.forEach((function(t){t.setParent(e),t.render(e._$controls)})):this._$controls.empty()}},{key:"_renderInfo",value:function(){this._renderInfoLoad(),this._renderInfoTableStatus(),this._renderInfoFilter(),this._renderInfoSelection()}},{key:"_renderInfoLoad",value:function(){var e=this._$infoLoad,t=this.table.rows.length,n=this.table.estimatedRowCount,r=this.table.maxRowCount;e.empty(),this._compactStyle?(t<=1?e.appendSpan().text(this.session.text("ui.NumRowLoadedMin")):e.appendSpan().text(this.session.text("ui.NumRowsLoadedMin")),e.appendBr(),e.appendSpan("table-info-button").text(this.computeCountInfo(t))):(t<=1?e.appendSpan().text(this.session.text("ui.NumRowLoaded",this.computeCountInfo(t))):n&&n>t?e.appendSpan().text(this.session.text("ui.NumRowsLoaded",this.computeCountInfo(t,n))):e.appendSpan().text(this.session.text("ui.NumRowsLoaded",this.computeCountInfo(t))),this.table.hasReloadHandler&&(e.appendBr(),n&&r&&t<n&&t<r?n<r?e.appendSpan("table-info-button").text(this.session.text("ui.LoadAllData")).appendTo(e):e.appendSpan("table-info-button").text(this.session.text("ui.LoadNData",this.computeCountInfo(r))).appendTo(e):e.appendSpan("table-info-button").text(this.session.text("ui.ReloadData")).appendTo(e))),e.setEnabled(this.table.hasReloadHandler),this.htmlComp.layouting||this.invalidateLayoutTree(!1)}},{key:"_renderInfoFilter",value:function(){var e=this._$infoFilter,t=this.table.filteredRows().length,n=this.table.filteredBy().join(", ");e.empty(),this._compactStyle?(t<=1?e.appendSpan().text(this.session.text("ui.NumRowFilteredMin")):e.appendSpan().text(this.session.text("ui.NumRowsFilteredMin")),e.appendBr(),e.appendSpan("table-info-button").text(this.computeCountInfo(t))):(n?t<=1?e.appendSpan().text(this.session.text("ui.NumRowFilteredBy",this.computeCountInfo(t),n)):e.appendSpan().text(this.session.text("ui.NumRowsFilteredBy",this.computeCountInfo(t),n)):t<=1?e.appendSpan().text(this.session.text("ui.NumRowFiltered",this.computeCountInfo(t))):e.appendSpan().text(this.session.text("ui.NumRowsFiltered",this.computeCountInfo(t))),this.table.hasUserFilter()&&(e.appendBr(),e.appendSpan("table-info-button").text(this.session.text("ui.RemoveFilter")).appendTo(e))),this.htmlComp.layouting||this.invalidateLayoutTree(!1)}},{key:"_renderInfoSelection",value:function(){var e=this._$infoSelection,t=this.table.filteredRows().length,n=this.table.selectedRows.length,r=t>0&&t===n;e.empty(),this._compactStyle?(n<=1?e.appendSpan().text(this.session.text("ui.NumRowSelectedMin")):e.appendSpan().text(this.session.text("ui.NumRowsSelectedMin")),e.appendBr(),e.appendSpan("table-info-button").text(this.computeCountInfo(n))):(n<=1?e.appendSpan().text(this.session.text("ui.NumRowSelected",this.computeCountInfo(n))):e.appendSpan().text(this.session.text("ui.NumRowsSelected",this.computeCountInfo(n))),e.appendBr(),e.appendSpan("table-info-button").text(this.session.text(r?"ui.SelectNone":"ui.SelectAll")).appendTo(e)),this.htmlComp.layouting||this.invalidateLayoutTree(!1)}},{key:"_renderInfoTableStatus",value:function(){var e=this._$infoTableStatus,t=this.table.tableStatus;e.removeClass(Br.SEVERITY_CSS_CLASSES),t&&e.addClass(t.cssClass()),this.htmlComp.layouting||this.invalidateLayoutTree(!1)}},{key:"_updateInfoVisibility",value:function(){this._updateInfoFilterVisibility(),this._updateInfoSelectionVisibility(),this._updateInfoTableStatusVisibility()}},{key:"_updateInfoFilterVisibility",value:function(){var e=this.table.filteredBy().length>0;this._setInfoVisible(this._$infoFilter,e)}},{key:"_updateInfoSelectionVisibility",value:function(){var e=this.table.multiSelect;this._setInfoVisible(this._$infoSelection,e)}},{key:"_updateInfoTableStatusVisibility",value:function(){if(this.table.tableStatus){var e=null;O.isOneOf(this.table.tableStatus.uiState,"user-hidden","auto-hidden")||(this._$infoTableStatus.addClass("tooltip-active"),e=function(){this.table.tableStatus&&!O.isOneOf(this.table.tableStatus.uiState,"user-hidden","auto-hidden")&&this._showTableStatusTooltip()}.bind(this)),this._setInfoVisible(this._$infoTableStatus,!0,e)}else this._hideTableStatusTooltip(),this._setInfoVisible(this._$infoTableStatus,!1)}},{key:"_setInfoVisible",value:function(e,t,n){if(e.isVisible()!==t||t&&e.data("hiding"))if(this.rendered)if(t){var r={progress:this.revalidateLayout.bind(this),complete:function(){n&&n()}};e.data("animationComplete",r.complete),""===e[0].style.width&&e.cssWidth(0),e.stop().removeData("hiding").setVisible(!0).widthToContent(r)}else e.data("hiding",!0),e.stop().animate({width:0},{progress:this.revalidateLayout.bind(this),complete:function(){e.removeData("hiding"),e.setVisible(!1)}});else e.setVisible(t);else n&&n()}},{key:"_toggleTableInfoTooltip",value:function(e,t){var n=this;this._tableInfoTooltip?this._tableInfoTooltip.destroy():(this._tableInfoTooltip=O.create(t,{parent:this,tableFooter:this,cssClass:"table-info-tooltip",arrowPosition:50,arrowPositionUnit:"%",$anchor:e}),this._tableInfoTooltip.one("destroy",(function(){n._tableInfoTooltip=null})),this._tableInfoTooltip.render())}},{key:"computeCountInfo",value:function(e,t){return e=O.nvl(e,0),t?this.session.text("ui.TableRowCount",this.session.text("ui.CountOfApproxTotal",this.session.locale.decimalFormat.format(e),this.session.locale.decimalFormat.format(t))):0===e?this._compactStyle?this.session.text("ui.TableRowCount",0):this.session.text("ui.TableRowCount0"):1===e?this.session.text("ui.TableRowCount1"):this.session.text("ui.TableRowCount",this.session.locale.decimalFormat.format(e))}},{key:"_revalidateTableLayout",value:function(){this.table.htmlComp.revalidateLayoutTree()}},{key:"openControlContainer",value:function(e){this.open;var t=this.$controlContent.data("control");this.animating&&t!==e&&t.onControlContainerClosed(),this.animating=!0,this.open=!0;var n=this.computeControlContainerHeight(this.table,e),r=qs.insets(this.$controlContainer);this.$controlContent.outerHeight(n-r.vertical()),""===this.$controlContainer[0].style.height&&this.$controlContainer.outerHeight(0),this.$controlContainer.outerHeight()>n&&this.table.invalidateLayoutTree(),this.$controlContainer.stop(!0).show().delay(1).animate({height:n},{duration:this.rendered?e.animateDuration:0,complete:function(){this.animating=!1,e.onControlContainerOpened(),this.table.invalidateLayoutTree()}.bind(this)})}},{key:"closeControlContainer",value:function(e,t){if(this.open){t=s.a.extend({},{animate:!0},t),this.open=!1,this.animating=!0,this.table.invalidateLayoutTree();var n=function(){this.animating=!1,this.$controlContainer.hide(),e.onControlContainerClosed()}.bind(this);t.animate?this.$controlContainer.stop(!0).show().animate({height:0},{duration:e.animateDuration,complete:n}):n()}}},{key:"computeControlContainerHeight",value:function(e,t,n){var r,o,i=0,s=qs.size(e.$container).height,a=0,l=qs.margins(O.nvl(e.$data,e.$container)),u=l.top+l.bottom,c=e.menuBar,f=e.footer,h=e.htmlComp,p=h.availableSize().subtract(h.insets());if(f){if(e.menuBarVisible&&c.visible){var d=ea.get(c.$container);i=ok.size(d,p).height}return r=qs.size(f.$container).height,f.open&&(f.animating?a=t.height:(a=qs.size(f.$controlContainer).height,!f.resizing&&n&&(a=Math.max(t.height,a)))),this.table.htmlComp.layouted&&(o=s-(u+i+r),a=Math.min(a,o)),a}}},{key:"_hideTableStatusTooltip",value:function(){clearTimeout(this._autoHideTableStatusTooltipTimeoutId),this._tableStatusTooltip&&this._tableStatusTooltip.destroy()}},{key:"_showTableStatusTooltip",value:function(){var e=this;if(this._tableStatusTooltip&&(this._tableStatusTooltip.destroy(),this._tableStatusTooltip=null),this.rendered||this.rendering){var t=this.table.tableStatus,n=t?t.message:null;if(!Wn.empty(n)){var r={parent:this,text:n,severity:t.severity,autoRemove:!t.isError(),$anchor:this._$infoTableStatusIcon};this._tableStatusTooltip=O.create("Tooltip",r),this._tableStatusTooltip.one("destroy",(function(){e._tableStatusTooltip=null})),this._tableStatusTooltip.render(),this._$infoTableStatus.addClass("tooltip-active"),this._tableStatusTooltip.on("remove",(function(){e._$infoTableStatus.removeClass("tooltip-active"),clearTimeout(e._autoHideTableStatusTooltipTimeoutId),e.table.tableStatus&&!e.table.tableStatus.isError()&&(e.table.tableStatus.uiState="auto-hidden")})),clearTimeout(this._autoHideTableStatusTooltipTimeoutId),t.isError()||t.isWarning()||t.uiState||(this.table.tableStatus.uiState="auto-hidden",this._autoHideTableStatusTooltipTimeoutId=setTimeout((function(){e._hideTableStatusTooltip()}),5e3))}}}},{key:"_updateHasFilterText",value:function(){this._$textFilter.toggleClass("has-text",!!this._$textFilter.val())}},{key:"onControlSelected",value:function(e){var t=this.selectedControl;this.selectedControl=e,e&&(this._renderResizerVisible(),t&&t.height!==e.height&&this.openControlContainer(e))}},{key:"_onStatusMouseDown",value:function(e){this._tableStatusTooltip?(this._hideTableStatusTooltip(),this.table.tableStatus.uiState="user-hidden"):(this._showTableStatusTooltip(),this._tableStatusTooltip.rendered&&(this.table.tableStatus.uiState="user-shown"))}},{key:"_createOnFilterFieldInputFunction",value:function(){var e=s.a.debounce(this._applyFilter.bind(this));return function(t){this._updateHasFilterText(),e()}}},{key:"_onDeleteFilterMouseDown",value:function(e){this._$textFilter.val(""),this._updateHasFilterText(),this._applyFilter(),e.preventDefault()}},{key:"_applyFilter",value:function(e){var t,n=this._$textFilter.val();this.filterText!==n&&(this.filterText=n,n?((t=O.create("TableTextUserFilter",{session:this.session,table:this.table})).text=n,this.table.addFilter(t)):this.table.removeFilterByKey(PL.TYPE),this.table.filter(),this.validateLayoutTree())}},{key:"_onInfoLoadClick",value:function(){if(this._$infoLoad.isEnabled())if(this._compactStyle)this._toggleTableInfoTooltip(this._$infoLoad,"TableInfoLoadTooltip");else{var e=this.table.rows.length,t=this.table.estimatedRowCount,n=this.table.maxRowCount;t&&n&&e<t&&e<n?this.table.reload(Cx.ReloadReason.OVERRIDE_ROW_LIMIT):this.table.reload()}}},{key:"_onInfoFilterClick",value:function(){this._compactStyle?this._toggleTableInfoTooltip(this._$infoFilter,"TableInfoFilterTooltip"):this.table.resetUserFilter()}},{key:"_onInfoSelectionClick",value:function(){this._compactStyle?this._toggleTableInfoTooltip(this._$infoSelection,"TableInfoSelectionTooltip"):this.table.toggleSelection()}},{key:"_onTableRowsChanged",value:function(e){this._renderInfoLoad()}},{key:"_onTableFilter",value:function(e){this._renderInfoFilter(),this._renderInfoSelection()}},{key:"_onTableFilterAdded",value:function(e){this._renderInfoFilter(),this._updateInfoFilterVisibility(),e.filter.filterType===PL.TYPE&&this._$textFilter.val()!==e.filter.text&&(this._$textFilter.val(e.filter.text),this._updateHasFilterText(),this._applyFilter())}},{key:"_onTableFilterRemoved",value:function(e){this._renderInfoFilter(),this._updateInfoFilterVisibility(),e.filter.filterType===PL.TYPE&&(this._$textFilter.val(""),this._updateHasFilterText(),this._applyFilter())}},{key:"_onTableRowsSelected",value:function(e){this._renderInfoSelection()}},{key:"_onTableStatusChanged",value:function(e){this._renderInfoTableStatus(),this._updateInfoTableStatusVisibility()}},{key:"_onTablePropertyChange",value:function(e){"multiSelect"===e.propertyName&&this._updateInfoSelectionVisibility()}}])&&Wx(t.prototype,n),r&&Wx(t,r),i}(ve);function Jx(e){return(Jx="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Zx(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Qx(e,t){return(Qx=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function eE(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=nE(e);if(t){var o=nE(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return tE(this,n)}}function tE(e,t){return!t||"object"!==Jx(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function nE(e){return(nE=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var rE=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Qx(e,t)}(i,e);var t,n,r,o=eE(i);function i(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(t=o.call(this))._tableFooter=e,t}return t=i,(n=[{key:"layout",value:function(e){var t,n,r=this._tableFooter._$controls,o=this._tableFooter._$info,i=o.find(".table-info-item"),a=qs.size(e).width;n=qs.size(r,!0).width,qs.size(o).width,i.each((function(){var e=s()(this);e.isVisible()&&!e.data("hiding")&&(e.data("oldWidth",e.outerWidth()),e.css("width","auto"))})),o.css("max-width",""),this._tableFooter._compactStyle&&(this._tableFooter._compactStyle=!1,this._tableFooter._renderInfo()),n+qs.size(o).width<=a&&(this._tableFooter._tableInfoTooltip&&this._tableFooter._tableInfoTooltip.destroy(),t=!0),t||(this._tableFooter._compactStyle=!0,this._tableFooter._renderInfo(),n+qs.size(o).width<=a&&(t=!0),o.css("max-width",Math.max(a-n,0)));var l=this._tableFooter.htmlComp.layouted;this._setInfoItemsSize(i,l),this._tableFooter._tableStatusTooltip&&this._tableFooter._tableStatusTooltip.rendered&&this._tableFooter._tableStatusTooltip.position(),this._tableFooter._tableInfoTooltip&&this._tableFooter._tableInfoTooltip.rendered&&this._tableFooter._tableInfoTooltip.position(),this._tableFooter.table.tableControls.forEach((function(e){e.revalidateLayout()}))}},{key:"_setInfoItemsSize",value:function(e,t){e.each((function(){var e=s()(this);if(e.isVisible()&&!e.data("hiding")){var n=e.data("animationComplete");t?(e.stop().cssWidthAnimated(e.data("oldWidth"),e.outerWidth(),{complete:n}),e.removeData("oldWidth")):e.cssWidth(e.outerWidth())}}))}}])&&Zx(t.prototype,n),r&&Zx(t,r),i}(Zs);function oE(e){return(oE="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function iE(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function sE(e,t,n){return(sE="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=cE(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function aE(e,t){return(aE=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function lE(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=cE(e);if(t){var o=cE(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return uE(this,n)}}function uE(e,t){return!t||"object"!==oE(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function cE(e){return(cE=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var fE=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&aE(e,t)}(i,e);var t,n,r,o=lE(i);function i(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),o.call(this)}return t=i,(n=[{key:"_init",value:function(e){sE(cE(i.prototype),"_init",this).call(this,e),this.tableFooter=e.tableFooter}},{key:"_renderText",value:function(){var e=this.tableFooter.table,t=e.filteredRows().length,n=e.filteredBy().join(", ");this.$content.appendSpan().text(this.session.text("ui.NumRowsFilteredBy",this.tableFooter.computeCountInfo(t),n)),this.$content.appendBr(),this.$content.appendSpan("link").text(this.session.text("ui.RemoveFilter")).on("click",this._onRemoveFilterClick.bind(this))}},{key:"_onRemoveFilterClick",value:function(){this.tableFooter.table.resetUserFilter(),this.destroy()}}])&&iE(t.prototype,n),r&&iE(t,r),i}(Tp);function hE(e){return(hE="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function pE(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function dE(e,t,n){return(dE="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=mE(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function yE(e,t){return(yE=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function vE(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=mE(e);if(t){var o=mE(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return bE(this,n)}}function bE(e,t){return!t||"object"!==hE(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function mE(e){return(mE=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var gE=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&yE(e,t)}(i,e);var t,n,r,o=vE(i);function i(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),o.call(this)}return t=i,(n=[{key:"_init",value:function(e){dE(mE(i.prototype),"_init",this).call(this,e),this.tableFooter=e.tableFooter}},{key:"_renderText",value:function(){var e=this.tableFooter.table.rows.length;this.$content.appendSpan().text(this.session.text("ui.NumRowsLoaded",this.tableFooter.computeCountInfo(e))),this.$content.appendBr(),this.$content.appendSpan("link").text(this.session.text("ui.ReloadData")).on("click",this._onReloadClick.bind(this))}},{key:"_onReloadClick",value:function(){this.tableFooter.table.reload(),this.destroy()}}])&&pE(t.prototype,n),r&&pE(t,r),i}(Tp);function _E(e){return(_E="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function wE(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function kE(e,t,n){return(kE="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=CE(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function SE(e,t){return(SE=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function OE(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=CE(e);if(t){var o=CE(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return TE(this,n)}}function TE(e,t){return!t||"object"!==_E(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function CE(e){return(CE=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var PE=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&SE(e,t)}(i,e);var t,n,r,o=OE(i);function i(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),o.call(this)}return t=i,(n=[{key:"_init",value:function(e){kE(CE(i.prototype),"_init",this).call(this,e),this.tableFooter=e.tableFooter}},{key:"_renderText",value:function(){var e=this.tableFooter.table.selectedRows.length;this.$content.appendSpan().text(this.session.text("ui.NumRowsSelected",this.tableFooter.computeCountInfo(e))),this.$content.appendBr(),this.$content.appendSpan("link").text(this.session.text("ui.SelectNone")).on("click",this._onSelectNoneClick.bind(this)),this.$content.appendBr(),this.$content.appendSpan("link").text(this.session.text("ui.SelectAll")).on("click",this._onSelectAllClick.bind(this))}},{key:"_onSelectNoneClick",value:function(){this.tableFooter.table.deselectAll(),this.destroy()}},{key:"_onSelectAllClick",value:function(){this.tableFooter.table.selectAll(),this.destroy()}}])&&wE(t.prototype,n),r&&wE(t,r),i}(Tp);function RE(e){return(RE="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function xE(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function EE(e,t,n){return(EE="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=jE(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function DE(e,t){return(DE=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function AE(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=jE(e);if(t){var o=jE(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return FE(this,n)}}function FE(e,t){return!t||"object"!==RE(t)&&"function"!=typeof t?$E(e):t}function $E(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function jE(e){return(jE=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var BE=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&DE(e,t)}(i,e);var t,n,r,o=AE(i);function i(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(e=o.call(this)).dragging=!1,e.headerMenusEnabled=!0,e.table=null,e._tableDataScrollHandler=e._onTableDataScroll.bind($E(e)),e._tableAddFilterRemovedHandler=e._onTableAddFilterRemoved.bind($E(e)),e._tableColumnResizedHandler=e._onTableColumnResized.bind($E(e)),e._tableColumnMovedHandler=e._onTableColumnMoved.bind($E(e)),e._renderedColumns=[],e}return t=i,(n=[{key:"_init",value:function(e){EE(jE(i.prototype),"_init",this).call(this,e),this.menuBar=O.create("MenuBar",{parent:this,tabbable:!1,position:Yw.Position.BOTTOM,menuOrder:new zJ}),this.menuBar.on("propertyChange",this._onMenuBarPropertyChange.bind(this)),this.updateMenuBar()}},{key:"_render",value:function(){this.$container=this.table.$data.beforeDiv("table-header"),this.$filler=this.$container.appendDiv("table-header-item filler").css("visibility","hidden"),this.$menuBarContainer=this.$container.appendDiv("menubar-container").setVisible(this.menuBar.visible),this.menuBar.render(this.$menuBarContainer),this._$window=this.$container.window(),this._$body=this.$container.body(),this._renderColumns(),this.table.$data.on("scroll",this._tableDataScrollHandler),this.table.on("filterAdded",this._tableAddFilterRemovedHandler),this.table.on("filterRemoved",this._tableAddFilterRemovedHandler),this.table.on("columnResized",this._tableColumnResizedHandler),this.table.on("columnMoved",this._tableColumnMovedHandler)}},{key:"_remove",value:function(){this.table.$data.off("scroll",this._tableDataScrollHandler),this.table.off("filterAdded",this._tableAddFilterRemovedHandler),this.table.off("filterRemoved",this._tableAddFilterRemovedHandler),this.table.off("columnResized",this._tableColumnResizedHandler),this.table.off("columnMoved",this._tableColumnMovedHandler),this._removeColumns(),EE(jE(i.prototype),"_remove",this).call(this)}},{key:"rerenderColumns",value:function(){this._removeColumns(),this._renderColumns()}},{key:"_renderColumns",value:function(){var e=this._visibleColumns();e.forEach(this._renderColumn,this),0===e.length&&this.$filler.css("visibility","visible").html("&nbsp;").addClass("empty"),this._reconcileScrollPos()}},{key:"_renderColumn",value:function(e,t){var n=e._realWidthIfAvailable(),r="",o="",i=0===t,s=t===this._visibleColumns().length-1;i?r=this.table.rowBorderLeftWidth:s&&(o=this.table.rowBorderRightWidth);var a=this.$filler.beforeDiv("table-header-item").setEnabled(this.enabled).data("column",e).cssMinWidth(n).cssMaxWidth(n).cssMarginLeft(r).cssMarginRight(o);a.appendSpan("table-header-item-text"),this.enabled&&a.on("click",this._onHeaderItemClick.bind(this)).on("mousedown",this._onHeaderItemMouseDown.bind(this)),this.session.inspector&&_n.applyInfo(e,a),i?a.addClass("first"):s&&a.addClass("last"),e.$header=a,this._installHeaderItemTooltip(e),this._decorateHeader(e);var l=e.showSeparator;if(s&&!this.enabled&&(l=!1),l){var u=this.$filler.beforeDiv("table-header-resize");e.fixedWidth||!this.enabled?u.setEnabled(!1):u.on("mousedown","",this._onSeparatorMouseDown.bind(this)).on("dblclick",this._onSeparatorDblclick.bind(this)),e.$separator=u}this._renderedColumns.push(e)}},{key:"_removeColumns",value:function(){this._renderedColumns.slice().forEach(this._removeColumn,this)}},{key:"_removeColumn",value:function(e){e.$header&&(e.$header.remove(),e.$header=null),e.$separator&&(e.$separator.remove(),e.$separator=null),rt.remove(this._renderedColumns,e)}},{key:"resizeHeaderItem",value:function(e){if(e&&e.$header){var t,n,r=e.$header,o=e._realWidthIfAvailable(),i="",s="",a=this.menuBar.visible?this.$menuBarContainer.outerWidth(!0):0,l=this._visibleColumns(),u=l.indexOf(e),c=0===u,f=u===l.length-1;if(c)i=this.table.rowBorderLeftWidth;else if(f&&(s=this.table.rowBorderRightWidth,(t=this.$container.width()-this.table.rowWidth+qs.insets(this.table.$data).right)<a)){n=a,e.$separator&&(n+=e.$separator.width()),t>0&&(n-=t);var h=o;o=Math.max(o-n,e.minWidth),this.$filler.cssWidth(h-o)}r.css("min-width",o).css("max-width",o).css("margin-left",i).css("margin-right",s),this.tableHeaderMenu&&this.tableHeaderMenu.rendered&&this.tableHeaderMenu.column===e&&this.tableHeaderMenu.onColumnResized()}}},{key:"resizeHeaderItems",value:function(){this._visibleColumns().forEach(this.resizeHeaderItem.bind(this))}},{key:"_reconcileScrollPos",value:function(){var e=this.table.get$Scrollable().scrollLeft(),t=this._lastVisibleColumn();this.resizeHeaderItem(t),this.$container.scrollLeft(e),this.$menuBarContainer.cssRight(-1*e)}},{key:"_arrangeHeaderItems",value:function(e){var t=this;e.each((function(){s()(this).css("left",s()(this).data("old-pos")-s()(this).offset().left).animate({left:0},{progress:function(e,n,r){var o=s()(this);o.isSelected()&&(Lh.scrollHorizontalTo(t.table.$data,o),t.tableHeaderMenu&&t.tableHeaderMenu.rendered&&t.tableHeaderMenu.position())}})}))}},{key:"_installHeaderItemTooltip",value:function(e){xp.install(e.$header,{parent:this,text:this._headerItemTooltipText.bind(this),arrowPosition:50,arrowPositionUnit:"%",nativeTooltip:!Kt.get().isCustomEllipsisTooltipPossible(),htmlEnabled:this._headerItemTooltipHtmlEnabled.bind(this)})}},{key:"_installHeaderItemTooltips",value:function(){this._visibleColumns().forEach(this._installHeaderItemTooltip,this)}},{key:"_uninstallHeaderItemTooltip",value:function(e){xp.uninstall(e.$header)}},{key:"_uninstallHeaderItemTooltips",value:function(){this._visibleColumns().forEach(this._uninstallHeaderItemTooltip,this)}},{key:"_headerItemTooltipText",value:function(e){var t=e.data("column");if(t&&Wn.hasText(t.headerTooltipText))return t.headerTooltipText;if(e.isContentTruncated()||e.width()+e.position().left>e.parent().width()){(e=e.clone()).children(".table-header-item-state").remove();var n=Wn.plainText(e.html(),{trim:!0});if(Wn.hasText(n))return n}return null}},{key:"_headerItemTooltipHtmlEnabled",value:function(e){return e.data("column").headerTooltipHtmlEnabled}},{key:"setHeaderMenusEnabled",value:function(e){this.setProperty("headerMenusEnabled",e)}},{key:"_renderHeaderMenusEnabled",value:function(){this._visibleColumns().forEach((function(e){this._decorateHeader(e)}),this)}},{key:"openHeaderMenu",value:function(e){var t=this;this.tableHeaderMenu&&this.closeHeaderMenu(),this.tableHeaderMenu=e.createTableHeaderMenu(this),this.tableHeaderMenu.open(),e.trigger("headerMenuOpen",{menu:this.tableHeaderMenu}),this.tableHeaderMenu.one("destroy",(function(){e.trigger("headerMenuClose",{menu:t.tableHeaderMenu})}))}},{key:"closeHeaderMenu",value:function(){this.tableHeaderMenu.destroy(),this.tableHeaderMenu=null}},{key:"onColumnActionsChanged",value:function(e){this.tableHeaderMenu&&this.tableHeaderMenu.onColumnActionsChanged(e)}},{key:"findHeaderItems",value:function(){return this.$container.find(".table-header-item:not(.filler)")}},{key:"updateHeader",value:function(e,t){e.isVisible()&&this._decorateHeader(e,t)}},{key:"_decorateHeader",value:function(e,t){this._renderColumnCssClass(e,t),this._renderColumnText(e),this._renderColumnIconId(e),this._renderColumnState(e),this._renderColumnLegacyStyle(e),this._renderColumnHeaderMenuEnabled(e),this._renderColumnHorizontalAlignment(e)}},{key:"_renderColumnCssClass",value:function(e,t){var n=e.$header;t&&n.removeClass(t.headerCssClass),n.addClass(e.headerCssClass)}},{key:"_renderColumnText",value:function(e){var t=e.text,n=e.$header.children(".table-header-item-text");e.headerHtmlEnabled||(t=Wn.nl2br(t)),n.htmlOrNbsp(t,"empty"),this._updateColumnIconAndTextStyle(e)}},{key:"_renderColumnIconId",value:function(e){e.$header.icon(e.headerIconId),this._updateColumnIconAndTextStyle(e)}},{key:"_renderColumnHorizontalAlignment",value:function(e){e.$header.removeClass("halign-left halign-center halign-right"),e.$header.addClass("halign-"+Cx.parseHorizontalAlignment(e.horizontalAlignment))}},{key:"_updateColumnIconAndTextStyle",value:function(e){var t=e.$header.data("$icon"),n=e.$header.children(".table-header-item-text");t&&t.toggleClass("with-text",!!e.text),n.setVisible(!(t&&"&nbsp;"===n.html())),e.$header.toggleClass("table-header-item-icon-only",!(!e.headerIconId||e.text))}},{key:"_renderColumnLegacyStyle",value:function(e){To.legacyStyle(e,e.$header,"header")}},{key:"_renderColumnHeaderMenuEnabled",value:function(e){e.$header.toggleClass("disabled",!this._isHeaderMenuEnabled(e)||!this.enabled)}},{key:"_renderColumnState",value:function(e){var t,n,r=e.$header,o=this.table.getFilter(e.id);if(r.children(".table-header-item-state").remove(),(n=r.appendSpan("table-header-item-state")).empty(),r.removeClass("sort-asc sort-desc sorted group-asc group-desc grouped filtered"),n.removeClass("sort-asc sort-desc sorted group-asc group-desc grouped filtered"),e.sortActive&&(t=e.sortAscending?"asc":"desc",e.grouped&&r.addClass("group-"+t),r.addClass("sorted sort-"+t),n.addClass("sorted sort-"+t)),e.grouped||o){var i=n.appendDiv("left");e.grouped&&(r.addClass("grouped"),n.addClass("grouped"),i.appendDiv().text("G")),o&&(r.addClass("filtered"),n.addClass("filtered"),i.appendDiv().text("F"))}n.appendDiv("right"),this._adjustColumnMinWidth(e)}},{key:"_adjustColumnMinWidth",value:function(e){var t=this.table.getFilter(e.id);e.sortActive||e.grouped||t?(e.minWidth<qA.DEFAULT_MIN_WIDTH&&(e.prefMinWidth=e.minWidth,e.minWidth=qA.DEFAULT_MIN_WIDTH),e.width<e.minWidth&&this.table.resizeColumn(e,e.minWidth)):null!==e.prefMinWidth&&(e.minWidth=e.prefMinWidth,e.prefMinWidth=null,e.width===qA.DEFAULT_MIN_WIDTH&&this.table.resizeColumn(e,e.minWidth))}},{key:"updateMenuBar",value:function(){var e=this.table._filterMenus(this.table.menus,Gm.HEADER);this.menuBar.setHiddenByUi(!this.enabled),this.menuBar.setMenuItems(e)}},{key:"_onTableColumnResized",value:function(e){var t=e.column,n=this._lastVisibleColumn();this.resizeHeaderItem(t),n!==t&&this.resizeHeaderItem(n)}},{key:"onSortingChanged",value:function(){this._visibleColumns().forEach(this._renderColumnState,this)}},{key:"_onTableColumnMoved",value:function(e){var t=this,n=e.column,r=e.oldPos,o=e.newPos,i=n.$header,a=this.findHeaderItems(),l=a.eq(r),u=l.next(),c=this._visibleColumns(),f=c.length-1;a.each((function(){s()(this).data("old-pos",s()(this).offset().left)})),o<r?(a.eq(o).before(l),a.eq(o).before(u)):(a.eq(o).after(l),a.eq(o).after(u)),a.length>0&&(a.eq(0).removeClass("first"),a.eq(a.length-1).removeClass("last")),c.length>0&&(c[0].$header.addClass("first"),c[f].$header.addClass("last")),r!==f&&o!==f||c.forEach((function(e){t.resizeHeaderItem(e)})),e.dragged?i.css("left",parseInt(i.css("left"),0)+i.data("old-pos")-i.offset().left).animateAVCSD("left",0):this._arrangeHeaderItems(a)}},{key:"_visibleColumns",value:function(){return this.table.visibleColumns()}},{key:"_lastVisibleColumn",value:function(){return rt.last(this._visibleColumns())}},{key:"onOrderChanged",value:function(e){var t,n,r=this.findHeaderItems();r.each((function(){s()(this).data("old-pos",s()(this).offset().left)})),this._visibleColumns().forEach((function(e){t=e.$header,n=t.next(".table-header-resize"),this.$container.append(t),this.$container.append(n)}),this),this.$container.append(this.$filler),this._arrangeHeaderItems(r)}},{key:"_isHeaderMenuEnabled",value:function(e){return!(!e.headerMenuEnabled||!this.headerMenusEnabled)}},{key:"_onHeaderItemClick",value:function(e){var t=s()(e.currentTarget),n=t.data("column");return this.dragging||this.columnMoved?(this.dragging=!1,this.columnMoved=!1):this.table.sortEnabled&&(e.shiftKey||e.ctrlKey||!this._isHeaderMenuEnabled(n))?(this.table.removeColumnGrouping(),this.table.sort(n,t.hasClass("sort-asc")?"desc":"asc",e.shiftKey)):this.tableHeaderMenu&&this.tableHeaderMenu.isOpenFor(t)?this.closeHeaderMenu():this._isHeaderMenuEnabled(n)&&this.openHeaderMenu(n),!1}},{key:"_onHeaderItemMouseDown",value:function(e){if(!(e.button>0)){var t=0,n=this,r=Math.floor(e.pageX),o=s()(e.currentTarget),i=o.data("column"),a=this._visibleColumns().indexOf(i),l=a,u=o.outerWidth(),c=o.siblings(".table-header-item:not(.filler)");i.fixedPosition||(this.dragging=!1,this.columnMoved=!1,this._$window.on("mousemove.tableheader","",(function(e){if(!(-2<(t=Math.floor(e.pageX)-r)&&t<2)){n.dragging=!0,o.addClass("moving"),n.$container&&n.$container.addClass("moving"),o.css("left",t);var i=h(o);c.each((function(e){var t=h(s()(this));i<t&&e<a?s()(this).css("left",u):i>t&&e>=a?s()(this).css("left",-u):s()(this).css("left",0)})),n.tableHeaderMenu&&(n.tableHeaderMenu.destroy(),n.tableHeaderMenu=null),n.rendered&&n._uninstallHeaderItemTooltips()}})).one("mouseup","",(function(e){if(n._$window&&n._$window.off("mousemove.tableheader"),!n.dragging)return!0;(t<0?c:s()(c.get().reverse())).each((function(e){if("0px"!==s()(this).css("left"))return l=n._visibleColumns().indexOf(s()(this).data("column")),!1})),l>-1&&a!==l?(n.table.moveColumn(o.data("column"),a,l,!0),n.dragging=!1,n.columnMoved=!0):o.animateAVCSD("left","",(function(){n.dragging=!1})),c.each((function(){s()(this).css("left","")})),o.removeClass("moving"),n.$container&&n.$container.removeClass("moving"),n.rendered&&n._installHeaderItemTooltips()})))}function f(e){var t=e.html(),n=e.html("<span>"+t+"</span>").find("span:first").width();return e.html(t),n}function h(e){return e.hasClass("halign-right")?e.offset().left+e.outerWidth()-f(e)/2:e.offset().left+f(e)/2}}},{key:"_onSeparatorDblclick",value:function(e){if(!(e.button>0))if(e.shiftKey)this._visibleColumns().forEach((function(e){this.table.resizeToFit(e)}),this);else{var t=s()(e.target).prev().data("column");this.table.resizeToFit(t)}}},{key:"_onSeparatorMouseDown",value:function(e){if(!(e.button>0)){var t=Math.floor(e.pageX),n=s()(e.target).prev().data("column"),r=this,o=n.width,i=this.$container.appendDiv("table-column-resize-helper").css("width",this.table.rowWidth+this.table.rowBorderWidth),a=this.table.$data.appendDiv("table-column-resize-helper").css("width",this.table.rowWidth);this._$window.on("mousemove.tableheader",(function(e){var i=Math.floor(e.pageX)-t,s=o+i;s=Math.max(s,n.minWidth),r.rendered&&s!==n.width&&r.table.resizeColumn(n,s)})).one("mouseup",(function(e){i.remove(),a.remove(),r._$window&&r._$window.off("mousemove.tableheader"),r._$body&&r._$body.removeClass("col-resize"),r.table.rendered&&n.width!==o&&r.table.resizeColumn(n,n.width)})),this._$body.addClass("col-resize"),e.preventDefault()}}},{key:"_onTableDataScroll",value:function(){Lh.fix(this.$menuBarContainer),this._reconcileScrollPos(),this._fixTimeout=Lh.unfix(this.$menuBarContainer,this._fixTimeout)}},{key:"_onMenuBarPropertyChange",value:function(e){this.rendered&&"visible"===e.propertyName&&this.$menuBarContainer.setVisible(e.newValue)}},{key:"_onTableAddFilterRemoved",value:function(e){var t=e.filter.column;e.filter.filterType===YI.TYPE&&t.$header&&this._renderColumnState(t)}}])&&xE(t.prototype,n),r&&xE(t,r),i}(ve);function ME(e){return(ME="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function IE(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function LE(e,t,n){return(LE="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=zE(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function HE(e,t){return(HE=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function NE(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=zE(e);if(t){var o=zE(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return VE(this,n)}}function VE(e,t){return!t||"object"!==ME(t)&&"function"!=typeof t?WE(e):t}function WE(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function zE(e){return(zE=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function GE(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var UE=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&HE(e,t)}(i,e);var t,n,r,o=NE(i);function i(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(e=o.call(this)).column=null,e.tableHeader=null,e.table=null,e.filter=null,e.filterCheckedMode=i.CheckedMode.ALL,e.filterSortMode=i.SortMode.ALPHABETICALLY,e.hasFilterTable=!1,e.hasFilterFields=!1,e.leftGroups=[],e.moveGroup=null,e.toBeginButton=null,e.forwardButton=null,e.backwardButton=null,e.toEndButton=null,e.sortingGroup=null,e.sortDescButton=null,e.sortAscAddButton=null,e.sortDescAddButton=null,e.columnActionsGroup=null,e.addColumnButton=null,e.removeColumnButton=null,e.modifyColumnButton=null,e.groupButton=null,e.groupAddButton=null,e.barChartButton=null,e.colorGradient1Button=null,e.colorGradient2Button=null,e.$rightGroups=[],e.$headerItem=null,e.$columnActions=null,e.$columnFilters=null,e.$filterTableGroup=null,e.$filterToggleChecked=null,e.$filterTableGroupTitle=null,e.$filterSortOrder=null,e.$filterFieldsGroup=null,e._onColumnMovedHandler=e._onColumnMoved.bind(WE(e)),e._tableHeaderScrollHandler=e._onAnchorScroll.bind(WE(e)),e.on("locationChange",e._onLocationChange.bind(WE(e))),e.inheritAccessibility=!1,e}return t=i,(n=[{key:"_init",value:function(e){e.scrollType=e.scrollType||"none",LE(zE(i.prototype),"_init",this).call(this,e),this.tableHeader=e.tableHeader,this.column=e.column,this.table=this.tableHeader.table,this.$headerItem=this.$anchor,this.table.on("columnMoved",this._onColumnMovedHandler),this.filter=this.table.getFilter(this.column.id),this.filter||(this.filter=this.column.createFilter()),this.filter.calculate(),this.filter.on("filterFieldsChanged",this._updateFilterTable.bind(this)),this._updateFilterTableCheckedMode(),this.hasFilterTable=this.filter.availableValues.length>0,this.hasFilterFields=this.filter.hasFilterFields,this.hasFilterTable&&(this._tableFilterHandler=this._onFilterTableChanged.bind(this),this.table.on("filterAdded",this._tableFilterHandler),this.table.on("filterRemoved",this._tableFilterHandler),this._filterTableRowsCheckedHandler=this._onFilterTableRowsChecked.bind(this))}},{key:"_createLayout",value:function(){return new eD(this)}},{key:"_render",value:function(){this.leftGroups=[],this.$rightGroups=[],this.$headerItem.select(!0),this.$container=this.$parent.appendDiv("table-header-menu"),this.htmlComp=ea.install(this.$container,this.session),this.htmlComp.setLayout(this._createLayout()),this.$body=this.$container.appendDiv("table-header-menu-body"),ea.install(this.$body,this.session),this._installScrollbars({axis:"y"}),this.$columnActions=this.$body.appendDiv("table-header-menu-actions"),(this.hasFilterTable||this.hasFilterFields)&&(this.$columnFilters=this.$body.appendDiv("table-header-menu-filters"),ea.install(this.$columnFilters,this.session).setLayout(new El)),this.tableHeader.$container.on("scroll",this._tableHeaderScrollHandler),this.$whiter=this.$container.appendDiv("table-header-menu-whiter"),this.withFocusContext&&this.focusableContainer&&this.$container.attr("tabindex",-1),this.table.visibleColumns().filter((function(e){return!e.fixedPosition})).length>1&&!this.column.fixedPosition&&this.leftGroups.push(this._renderMovingGroup()),this.table.sortEnabled&&this.leftGroups.push(this._renderSortingGroup()),this._isColumnActionsGroupVisible()&&this.leftGroups.push(this._renderColumnActionsGroup()),(this.table.isGroupingPossible(this.column)||this.column.grouped)&&this.leftGroups.push(this._renderGroupingGroup()),this.leftGroups.push(this._renderHierarchyGruop()),this.table.isAggregationPossible(this.column)&&this.leftGroups.push(this._renderAggregationGroup()),this.column instanceof r$&&this.leftGroups.push(this._renderColoringGroup()),this.hasFilterTable&&this.$rightGroups.push(this._renderFilterTable()),this.hasFilterFields&&this.$rightGroups.push(this._renderFilterFields()),this._onColumnMoved(),this.table.enabled&&this.table.$container.addClass("focused")}},{key:"get$Scrollable",value:function(){return this.$body}},{key:"_updateFirstLast",value:function(){function e(e){e.forEach((function(e,n,r){t(e,"first",0===n),t(e,"last",n===r.length-1)}),this)}function t(e,t,n){(e instanceof lD?e.$container:e).toggleClass(t,n)}e(this.leftGroups.filter((function(e){return e.isVisible()}))),e(this.$rightGroups)}},{key:"_remove",value:function(){this.filterTable&&this.filterTable.off("rowsChecked",this._filterTableRowsCheckedHandler),this.tableHeader.$container.off("scroll",this._tableHeaderScrollHandler),this.$headerItem.select(!1),this.table.off("columnMoved",this._onColumnMovedHandler),this.table.off("filterAdded",this._tableFilterHandler),this.table.off("filterRemoved",this._tableFilterHandler),LE(zE(i.prototype),"_remove",this).call(this),this.table.rendered&&this.table.$container.removeClass("focused")}},{key:"_renderMovingGroup",value:function(){var e=this.table,t=this.column,n=e.visibleColumns().indexOf(t);return this.moveGroup=O.create("TableHeaderMenuGroup",{parent:this,textKey:"ui.Move",cssClass:"first"}),this.toBeginButton=O.create("TableHeaderMenuButton",{parent:this.moveGroup,text:"${textKey:ui.toBegin}",cssClass:"move move-top"}),this.toBeginButton.on("action",(function(){e.moveColumn(t,n,0),n=e.visibleColumns().indexOf(t)})),this.forwardButton=O.create("TableHeaderMenuButton",{parent:this.moveGroup,text:"${textKey:ui.forward}",cssClass:"move move-up"}),this.forwardButton.on("action",(function(){e.moveColumn(t,n,Math.max(n-1,0)),n=e.visibleColumns().indexOf(t)})),this.backwardButton=O.create("TableHeaderMenuButton",{parent:this.moveGroup,text:"${textKey:ui.backward}",cssClass:"move move-down"}),this.backwardButton.on("action",(function(){e.moveColumn(t,n,Math.min(n+1,e.header.findHeaderItems().length-1)),n=e.visibleColumns().indexOf(t)})),this.toEndButton=O.create("TableHeaderMenuButton",{parent:this.moveGroup,text:"${textKey:ui.toEnd}",cssClass:"move move-bottom"}),this.toEndButton.on("action",(function(){e.moveColumn(t,n,e.header.findHeaderItems().length-1),n=e.visibleColumns().indexOf(t)})),this.moveGroup.render(this.$columnActions),this.moveGroup}},{key:"_onColumnMoved",value:function(){var e=this.table,t=this.column;if(this.moveGroup){var n=e.visibleColumns(),r=e.visibleColumns().indexOf(t),o=n[r-1]&&!n[r-1].fixedPosition,i=n[r+1]&&!n[r+1].fixedPosition;this.toBeginButton.setEnabled(o),this.forwardButton.setEnabled(o),this.backwardButton.setEnabled(i),this.toEndButton.setEnabled(i)}this.hierarchyGroup.setVisible(this.table.isTableNodeColumn(t)),this._updateFirstLast()}},{key:"_isColumnActionsGroupVisible",value:function(){return this.table.columnAddable||this.column.removable||this.column.modifiable}},{key:"_renderColumnActionsGroup",value:function(){var e=this.column,t=this;return this.columnActionsGroup=O.create("TableHeaderMenuGroup",{parent:this,textKey:"ui.Column"}),this.addColumnButton=O.create("TableHeaderMenuButton",{parent:this.columnActionsGroup,text:"${textKey:ui.addColumn}",cssClass:"add-column",visible:this.table.columnAddable}),this.addColumnButton.on("action",n.bind(this,"add")),this.removeColumnButton=O.create("TableHeaderMenuButton",{parent:this.columnActionsGroup,text:"${textKey:ui.removeColumn}",cssClass:"remove-column",visible:this.column.removable}),this.removeColumnButton.on("action",n.bind(this,"remove")),this.modifyColumnButton=O.create("TableHeaderMenuButton",{parent:this.columnActionsGroup,text:"${textKey:ui.changeColumn}",cssClass:"change-column",visible:this.column.modifiable}),this.modifyColumnButton.on("action",n.bind(this,"modify")),this.columnActionsGroup.render(this.$columnActions),this.columnActionsGroup;function n(n){t.close(),this.table.trigger("columnOrganizeAction",{action:n,column:e})}}},{key:"onColumnActionsChanged",value:function(e){this.addColumnButton.setVisible(e.addVisible),this.removeColumnButton.setVisible(e.removeVisible),this.modifyColumnButton.setVisible(e.modifyVisible);var t=this.columnActionsGroup.children.some((function(e){return e.visible}));this.columnActionsGroup.setVisible(t)}},{key:"_renderSortingGroup",value:function(){var e=this.table,t=this.column,n=this;return this.sortingGroup=O.create("TableHeaderMenuGroup",{parent:this,textKey:"ColumnSorting"}),e.hasPermanentHeadOrTailSortColumns()||(this.sortAscButton=O.create("TableHeaderMenuButton",{parent:this.sortingGroup,text:"${textKey:ui.ascending}",cssClass:"sort sort-asc",direction:"asc",toggleAction:!0}),this.sortAscButton.on("action",r.bind(this.sortAscButton)),this.sortDescButton=O.create("TableHeaderMenuButton",{parent:this.sortingGroup,text:"${textKey:ui.descending}",cssClass:"sort sort-desc",direction:"desc",toggleAction:!0}),this.sortDescButton.on("action",r.bind(this.sortDescButton))),this.sortAscAddButton=O.create("TableHeaderMenuButton",{parent:this.sortingGroup,text:"${textKey:ui.ascendingAdditionally}",cssClass:"sort sort-asc-add",direction:"asc",toggleAction:!0}),this.sortAscAddButton.on("action",o.bind(this.sortAscAddButton)),this.sortDescAddButton=O.create("TableHeaderMenuButton",{parent:this.sortingGroup,text:"${textKey:ui.descendingAdditionally}",cssClass:"sort sort-desc-add",direction:"desc",toggleAction:!0}),this.sortDescAddButton.on("action",o.bind(this.sortDescAddButton)),this._updateSortingSelectedState(),this.sortingGroup.render(this.$columnActions),this.sortingGroup;function r(){n.close(),i(this.direction,!1,!this.selected)}function o(){n.close(),i(this.direction,!0,!this.selected)}function i(r,o,i){e.sort(t,r,o,i),n._updateSortingSelectedState()}}},{key:"_updateSortingSelectedState",value:function(){if(this.table.sortEnabled){var e,t=!1,n=this._sortColumnCount();this.sortingGroup.children.forEach((function(e){e.setSelected(!1)})),1!==n||this.table.hasPermanentHeadOrTailSortColumns()?(n>1||this.table.hasPermanentHeadOrTailSortColumns())&&(t=!0,this.column.sortActive&&(this.column.sortAscending?this.sortAscAddButton.setSelected(!0):this.sortDescAddButton.setSelected(!0),e=this.column.sortIndex+1,this.sortAscAddButton.setIconId(e),this.sortDescAddButton.setIconId(e))):this.column.sortActive?this.column.sortAscending?this.sortAscButton.setSelected(!0):this.sortDescButton.setSelected(!0):t=!0,this.sortAscAddButton.setVisible(t),this.sortDescAddButton.setVisible(t)}}},{key:"_renderGroupingGroup",value:function(){var e=this,t=this.table,n=this.column,r=this._groupColumnCount(),o=O.create("TableHeaderMenuGroup",{parent:this,textKey:"ui.Grouping"});return this.groupButton=O.create("TableHeaderMenuButton",{parent:o,text:"${textKey:ui.groupingApply}",cssClass:"group",additional:!1,toggleAction:!0}),this.groupButton.on("action",i.bind(this.groupButton)),this.groupAddButton=O.create("TableHeaderMenuButton",{parent:o,text:"${textKey:ui.additionally}",cssClass:"group-add",additional:!0,toggleAction:!0}),this.groupAddButton.on("action",i.bind(this.groupAddButton)),0===r?this.groupAddButton.setVisible(!1):1===r&&this.column.grouped?(this.groupButton.setSelected(!0),this.groupAddButton.setVisible(!1)):r>1&&this.groupAddButton.setVisible(!0),t.hasPermanentHeadOrTailSortColumns()&&r>0&&(this.groupButton.setVisible(!1),this.groupAddButton.setVisible(!0)),this.column.grouped&&(1===r?this.groupAddButton.setSelected(!0):r>1&&(this.groupAddButton.setSelected(!0),this.groupAddButton.setIconId(this.column.sortIndex+1))),o.render(this.$columnActions),o;function i(){var r=n.sortIndex>=0&&!n.sortAscending?"desc":"asc";e.close(),t.groupColumn(n,this.additional,r,!this.selected)}}},{key:"_renderHierarchyGruop",value:function(){var e=this.table,t=this;return this.hierarchyGroup=O.create("TableHeaderMenuGroup",{parent:this,textKey:"ui.Hierarchy",visible:this.table.isTableNodeColumn(this.column)}),O.create("TableHeaderMenuButton",{parent:this.hierarchyGroup,text:"${textKey:ui.CollapseAll}",cssClass:"hierarchy-collapse-all",enabled:!!rt.find(e.rows,(function(e){return e.expanded&&!rt.empty(e.childRows)}))}).on("action",(function(){t.close(),e.collapseAll()})),O.create("TableHeaderMenuButton",{parent:this.hierarchyGroup,text:"${textKey:ui.ExpandAll}",cssClass:"hierarchy-expand-all",enabled:!!rt.find(e.rows,(function(e){return!e.expanded&&!rt.empty(e.childRows)}))}).on("action",(function(){t.close(),e.expandAll()})),this.hierarchyGroup.render(this.$columnActions),this.hierarchyGroup}},{key:"_renderAggregationGroup",value:function(){var e=this.table,t=this.column,n=t.aggregationFunction,r=this,o=O.create("TableHeaderMenuGroup",{parent:this,textKey:"ui.Aggregation"}),i=rt.ensure(t.allowedAggregationFunctions),s=-1!==i.indexOf("none");return a("${textKey:ui.Sum}","sum"),a("${textKey:ui.Average}","avg"),a("${textKey:ui.Minimum}","min"),a("${textKey:ui.Maximum}","max"),o.children.forEach((function(e){e.setSelected(e.aggregation===n)})),o.render(this.$columnActions),o;function a(e,t){if(-1!==i.indexOf(t)){var n=O.create("TableHeaderMenuButton",{parent:o,text:e,cssClass:"aggregation-function "+t,aggregation:t,toggleAction:s});n.on("action",l.bind(n))}}function l(){r.close(),e.changeAggregation(t,this.aggregation===n?"none":this.aggregation)}}},{key:"_renderColoringGroup",value:function(){var e=this.table,t=this.column,n=this,r=t.backgroundEffect,o=O.create("TableHeaderMenuGroup",{parent:this,textKey:"ui.Coloring"});return this.colorGradient1Button=O.create("TableHeaderMenuButton",{parent:o,text:"${textKey:ui.fromRedToGreen}",cssClass:"color color-gradient1",backgroundEffect:"colorGradient1",toggleAction:!0}),this.colorGradient1Button.on("action",i.bind(this.colorGradient1Button)),this.colorGradient2Button=O.create("TableHeaderMenuButton",{parent:o,text:"${textKey:ui.fromGreenToRed}",cssClass:"color color-gradient2",backgroundEffect:"colorGradient2",toggleAction:!0}),this.colorGradient2Button.on("action",i.bind(this.colorGradient2Button)),Kt.get().supportsCssGradient()&&(this.barChartButton=O.create("TableHeaderMenuButton",{parent:o,text:"${textKey:ui.withBarChart}",cssClass:"color color-bar-chart",backgroundEffect:"barChart",toggleAction:!0}),this.barChartButton.on("action",i.bind(this.barChartButton))),o.children.forEach((function(e){e.setSelected(e.backgroundEffect===r)})),o.render(this.$columnActions),o;function i(){n.close(),e.setColumnBackgroundEffect(t,this.selected?this.backgroundEffect:null)}}},{key:"_renderFilterTable",value:function(){var e;this.$filterTableGroup=this.$columnFilters.appendDiv("table-header-menu-group first"),ea.install(this.$filterTableGroup,this.session).setLayout(new El),e=this.$filterTableGroup.appendDiv("table-header-menu-filter-actions"),this.$filterSortOrder=e.appendDiv("table-header-menu-toggle-sort-order").on("click",this._onSortModeClick.bind(this)).addClass(this.filterSortMode.cssClass),this.$filterToggleChecked=e.appendDiv("table-header-menu-filter-toggle-checked").text(this.session.text(this.filterCheckedMode.text)).on("click",this._onFilterCheckedModeClick.bind(this)),this.$filterTableGroupTitle=this.$filterTableGroup.appendDiv("table-header-menu-group-text").text(this._filterByText()),ea.install(this.$filterTableGroupTitle,this.session),this.filterTable=this._createFilterTable(),this.filterTable.on("rowsChecked",this._filterTableRowsCheckedHandler);var t,n=[];return this.filter.availableValues.forEach((function(e){t={cells:[O.create("Cell",{text:"NumberColumn"===this.filter.column.objectType?e.text:null,value:"NumberColumn"===this.filter.column.objectType?e.key:e.text,iconId:e.iconId,htmlEnabled:e.htmlEnabled,cssClass:e.cssClass}),e.count,null===e.key?1:0],checked:this.filter.selectedValues.indexOf(e.key)>-1,dataMap:{filterValue:e}},n.push(t)}),this),this.filterTable.insertRows(n),this.filterTable.render(this.$filterTableGroup),setTimeout(this.filterTable.revealChecked.bind(this.filterTable)),this.$filterTableGroup}},{key:"_createFilterTable",value:function(){var e="Column";return"NumberColumn"===this.column.objectType&&(e=this.column.objectType),O.create("Table",{parent:this,headerVisible:!1,multiSelect:!1,autoResizeColumns:!0,checkable:!0,checkableStyle:Cx.CheckableStyle.TABLE_ROW,columns:[{objectType:e,text:"filter-value",width:160,sortActive:!0,sortIndex:1,horizontalAlignment:-1},{objectType:"NumberColumn",text:"aggregate-count",width:40},{objectType:"NumberColumn",displayable:!1,sortActive:!0,sortIndex:0}]})}},{key:"_filterByText",value:function(){var e=this.session.text("ui.Filter"),t=this.filter.selectedValues.length,n=this.filter.availableValues.length;return t&&n?e+=" "+this.session.text("ui.FilterInfoXOfY",t,n):n&&(e+=" "+this.session.text("ui.FilterInfoCount",n)),e}},{key:"_onFilterCheckedModeClick",value:function(){var e=i.CheckedMode,t=this.filterCheckedMode.checkAll;this.filter.selectedValues=[],this.filterCheckedMode===e.ALL?(this.filterCheckedMode=e.NONE,this.filter.availableValues.forEach((function(e){this.filter.selectedValues.push(e.key)}),this)):this.filterCheckedMode=e.ALL,this.filterTable.checkAll(t),this._updateFilterTableActions()}},{key:"_onSortModeClick",value:function(){var e=i.SortMode;this.filterSortMode===e.ALPHABETICALLY?(this.filterTable.sort(this.filterTable.columns[1],"desc"),this.filterSortMode=e.AMOUNT):(this.filterTable.sort(this.filterTable.columns[2],"asc"),this.filterTable.sort(this.filterTable.columns[0],"asc",!0),this.filterSortMode=e.ALPHABETICALLY),this._updateFilterTableActions()}},{key:"_updateFilterTable",value:function(){this.filter.filterActive()?this.table.addFilter(this.filter):this.table.removeFilterByKey(this.column.id),this.table.filter()}},{key:"_updateFilterTableActions",value:function(){this.$filterToggleChecked.text(this.session.text(this.filterCheckedMode.text));var e=i.SortMode,t=this.filterSortMode===i.SortMode.ALPHABETICALLY;this.$filterSortOrder.toggleClass(e.ALPHABETICALLY.cssClass,t),this.$filterSortOrder.toggleClass(e.AMOUNT.cssClass,!t)}},{key:"_renderFilterFields",value:function(){this.filterFieldsGroupBox=O.create("GroupBox:FilterFields",{parent:this,column:this.column,filter:this.filter}),this.$filterFieldsGroup=this.$columnFilters.appendDiv("table-header-menu-group");var e=ea.install(this.$filterFieldsGroup,this.session);e.setLayout(new El);var t=this.$filterFieldsGroup.appendDiv("table-header-menu-group-text").text(this.filter.filterFieldsTitle());return e=ea.install(t,this.session),this.filterFieldsGroupBox.render(this.$filterFieldsGroup),this.$filterFieldsGroup}},{key:"isOpenFor",value:function(e){return this.rendered&&this.belongsTo(e)}},{key:"_countColumns",value:function(e){return this.table.visibleColumns().reduce((function(t,n){return t+(n[e]?1:0)}),0)}},{key:"_sortColumnCount",value:function(){return this._countColumns("sortActive")}},{key:"_groupColumnCount",value:function(){return this._countColumns("grouped")}},{key:"_computeWhitherWidth",value:function(){var e=this.tableHeader.$container,t=this.$headerItem.outerWidth()-this.$headerItem.cssBorderWidthX(),n=this.$container.outerWidth()-this.$container.cssBorderWidthX(),r=e.outerWidth()-this.tableHeader.menuBar.$container.outerWidth(),o=Math.min(t,n);o=Math.min(o,r-this.$headerItem.position().left);var i=e.offset().left-this.$headerItem.offset().left-this.tableHeader.table.$container.cssBorderLeftWidth();return i>0&&(o-=i),o}},{key:"_renderCompact",value:function(){this.$body.toggleClass("compact",this.compact),this.invalidateLayoutTree()}},{key:"setCompact",value:function(e){this.setProperty("compact",e)}},{key:"_onLocationChange",value:function(e){var t,n,r=Lh.isLocationInView,o=qs.offsetBounds(this.$headerItem),i=this.tableHeader.$container;this.$container.setVisible(!0),n=qs.offsetBounds(this.$container),(t=r(new Is(o.x,o.y),i))||(t=(t=r(new Is(o.x+o.width,o.y+o.height),i))&&r(new Is(n.x+n.width,n.y),i)),this.$container.setVisible(t),n=qs.offsetBounds(this.$container),this.$whiter.cssLeft(Math.max(o.x-n.x,i.offset().left-n.x-this.tableHeader.table.$container.cssBorderLeftWidth())).width(this._computeWhitherWidth())}},{key:"_onAnchorScroll",value:function(e){this.position()}},{key:"_onFilterTableRowsChecked",value:function(e){this.filter.selectedValues=[],this.filterTable.rows.forEach((function(e){e.checked&&this.filter.selectedValues.push(e.dataMap.filterValue.key)}),this),this._updateFilterTable()}},{key:"_onFilterTableChanged",value:function(){this.$filterTableGroupTitle.text(this._filterByText()),this._updateFilterTableCheckedMode(),this._updateFilterTableActions()}},{key:"_updateFilterTableCheckedMode",value:function(){0===this.filter.selectedValues.length?this.filterCheckedMode=i.CheckedMode.ALL:this.filterCheckedMode=i.CheckedMode.NONE}},{key:"_onMouseDownOutside",value:function(e){this.$headerItem.isOrHas(e.target)||this.close()}},{key:"onColumnResized",value:function(){this.$whiter.width(this._computeWhitherWidth())}}])&&IE(t.prototype,n),r&&IE(t,r),i}(Id);function KE(e){return(KE="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function qE(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function YE(e,t,n){return(YE="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=QE(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function XE(e,t){return(XE=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function JE(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=QE(e);if(t){var o=QE(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return ZE(this,n)}}function ZE(e,t){return!t||"object"!==KE(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function QE(e){return(QE=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}GE(UE,"CheckedMode",{ALL:{checkAll:!0,text:"ui.SelectAllFilter"},NONE:{checkAll:!1,text:"ui.SelectNoneFilter"}}),GE(UE,"SortMode",{ALPHABETICALLY:{text:"ui.SortAlphabeticallyFilter",cssClass:"table-header-menu-toggle-sort-order-alphabetically"},AMOUNT:{text:"ui.SortByAmountFilter",cssClass:"table-header-menu-toggle-sort-order-amount"}});var eD=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&XE(e,t)}(i,e);var t,n,r,o=JE(i);function i(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(t=o.call(this,e)).popup=e,t.doubleCalcPrefSize=!1,t}return t=i,(n=[{key:"layout",value:function(e){if(YE(QE(i.prototype),"layout",this).call(this,e),this.popup.hasFilterFields||this.popup.hasFilterTable){var t,n,r=this.popup.$columnFilters,o=qs.insets(r),s=qs.margins(r),a=new $s;if((n=this.popup.$body.hasClass("compact")?ea.get(r).prefSize():(n=this.preferredLayoutSize(e).subtract(qs.insets(e))).subtract(s)).width=r.cssWidth(),r.cssHeight(n.height),this.popup.hasFilterFields){var l=this.popup.$filterFieldsGroup;ea.get(l.find(".form-field")).setSize(new $s(n.width-o.horizontal(),this._filterFieldsGroupBoxHeight())),a=qs.size(l,!0)}if(this.popup.hasFilterTable){var u,c=this.popup.$filterTableGroup,f=qs.insets(c),h=this.popup.filterTable.htmlComp;u=n.height-o.vertical(),u-=a.height,u-=this._groupTitleHeight(c),u-=f.vertical(),u=Math.min(u,i.TABLE_MAX_HEIGHT),h.setSize(new $s(n.width-o.horizontal(),u))}this._setMaxWidth(),t=qs.size(this.popup.$columnActions),this._setMaxWidth(t.width),this.popup.$columnActions.css("vertical-align",t.height>=n.height?"middle":"top"),r.css("vertical-align","middle")}}},{key:"_adjustSizeWithAnchor",value:function(e){var t,n=this.popup.htmlComp,r=this.popup.windowPaddingX,o=n.margins(),s=n.offsetBounds();t=this.popup.$container.window().width()-o.horizontal()-s.x-r;var a=s.width>t;return a&&(this.popup.$body.addClass("compact",a),e=this.preferredLayoutSize(this.popup.$container)),YE(QE(i.prototype),"_adjustSizeWithAnchor",this).call(this,e)}},{key:"_groupTitleHeight",value:function(e){return qs.size(e.find(".table-header-menu-group-text"),!0).height}},{key:"_filterFieldsGroupBoxHeight",value:function(){return this.popup.filterFieldsGroupBox.htmlComp.prefSize().height}},{key:"preferredLayoutSize",value:function(e,t){var n,r,o,s,a=0,l=qs.insets(e),u=this._getMaxWidth();if(this._setMaxWidth(),s=qs.size(this.popup.$columnActions,!0).height,this.popup.hasFilterTable){var c,f=this.popup.$filterTableGroup,h=this.popup.filterTable.htmlComp.size(!0).height,p=qs.insets(f);c=h=Math.min(h,i.TABLE_MAX_HEIGHT),c+=this._groupTitleHeight(f),a+=c+=p.vertical()}if(this.popup.hasFilterFields){var d,y=this.popup.$filterFieldsGroup,v=qs.insets(y);d=this._filterFieldsGroupBoxHeight(),d+=this._groupTitleHeight(y),a+=d+=v.vertical()}return(this.popup.hasFilterFields||this.popup.hasFilterTable)&&(r=qs.margins(this.popup.$columnFilters),o=qs.insets(this.popup.$columnFilters),a+=r.vertical(),a+=o.vertical()),n=qs.prefSize(e),this.popup.$body.hasClass("compact")?n.height=s+a+l.vertical():n.height=Math.max(s,a)+l.vertical(),this._setMaxWidth(u),n}},{key:"_getMaxWidth",value:function(){return this.popup.$columnActions.css("max-width")}},{key:"_setMaxWidth",value:function(e){this.popup.$columnActions.css("max-width",e||"")}}])&&qE(t.prototype,n),r&&qE(t,r),i}(Qd);function tD(e){return(tD="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function nD(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function rD(e,t,n){return(rD="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=aD(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function oD(e,t){return(oD=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function iD(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=aD(e);if(t){var o=aD(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return sD(this,n)}}function sD(e,t){return!t||"object"!==tD(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function aD(e){return(aD=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}!function(e,t,n){t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}(eD,"TABLE_MAX_HEIGHT",330);var lD=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&oD(e,t)}(i,e);var t,n,r,o=iD(i);function i(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(e=o.call(this)).text=null,e.textKey=null,e.visible=!0,e.last=!1,e}return t=i,(n=[{key:"_init",value:function(e){rD(aD(i.prototype),"_init",this).call(this,e),this.text=O.nvl(this.text,this.session.text(this.textKey))}},{key:"_render",value:function(){this.$container=this.$parent.appendDiv("table-header-menu-group buttons"),this.$text=this.$container.appendDiv("table-header-menu-group-text"),this.cssClass&&this.$container.addClass(this.cssClass),this._renderText(),this.children.forEach((function(e){e.render()}),this),me.updateFirstLastMarker(this.children)}},{key:"appendText",value:function(e){this.text=this.session.text(this.textKey)+" "+e,this.rendered&&this._renderText()}},{key:"resetText",value:function(){this.text=this.session.text(this.textKey),this.rendered&&this._renderText()}},{key:"_renderText",value:function(){this.$text.text(this.text)}},{key:"setLast",value:function(e){this.setProperty("last",e)}},{key:"_renderLast",value:function(){this.$container.toggleClass("last",this.last)}}])&&nD(t.prototype,n),r&&nD(t,r),i}(ve);function uD(e){return(uD="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function cD(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function fD(e,t,n){return(fD="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=yD(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function hD(e,t){return(hD=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function pD(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=yD(e);if(t){var o=yD(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return dD(this,n)}}function dD(e,t){return!t||"object"!==uD(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function yD(e){return(yD=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var vD=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&hD(e,t)}(i,e);var t,n,r,o=pD(i);function i(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(e=o.call(this)).textVisible=!1,e.tabbable=!0,e}return t=i,(n=[{key:"_initKeyStrokeContext",value:function(){fD(yD(i.prototype),"_initKeyStrokeContext",this).call(this),this.keyStrokeContext.registerKeyStroke([new SD(this)])}},{key:"_render",value:function(){fD(yD(i.prototype),"_render",this).call(this),this.$container=this.$container.addClass("table-header-menu-command").unfocusable().on("mouseenter",this._onMouseOver.bind(this)).on("mouseleave",this._onMouseOut.bind(this)),this.$icon=this.$container.appendSpan("icon")}},{key:"_renderProperties",value:function(){fD(yD(i.prototype),"_renderProperties",this).call(this),this._renderToggleAction()}},{key:"_onMouseOver",value:function(){var e=this.selected?this.session.text("ui.remove"):this.text;this.parent.appendText(e)}},{key:"_onMouseOut",value:function(){this.parent.resetText()}},{key:"_renderToggleAction",value:function(){this.$container.toggleClass("togglable",this.toggleAction)}},{key:"_renderIconId",value:function(){this.iconId?this.$icon.attr("data-icon",this.iconId):this.$icon.removeAttr("data-icon")}}])&&cD(t.prototype,n),r&&cD(t,r),i}(Up);function bD(e){return(bD="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function mD(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function gD(e,t){return(gD=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function _D(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=kD(e);if(t){var o=kD(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return wD(this,n)}}function wD(e,t){return!t||"object"!==bD(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function kD(e){return(kD=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var SD=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&gD(e,t)}(i,e);var t,n,r,o=_D(i);function i(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(t=o.call(this)).field=e,t.which=[Ou.ENTER,Ou.SPACE],t.renderingHints.render=!0,t.stopPropagation=!0,t}return t=i,(n=[{key:"handle",value:function(e){this.field.doAction()}}])&&mD(t.prototype,n),r&&mD(t,r),i}(zu);function OD(e){return(OD="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function TD(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function CD(e,t,n){return(CD="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=ED(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function PD(e,t){return(PD=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function RD(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=ED(e);if(t){var o=ED(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return xD(this,n)}}function xD(e,t){return!t||"object"!==OD(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function ED(e){return(ED=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var DD=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&PD(e,t)}(i,e);var t,n,r,o=RD(i);function i(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(t=o.call(this)).table=e,t._dataHeightPositive=!1,t}return t=i,(n=[{key:"layout",value:function(e){var t,n=0,r=0,o=0,i=0,s=0,a=this.table.tableTileGridMediator?this.table.tableTileGridMediator.tileAccordion:null,l=this.table.$data,u=qs.margins(O.nvl(l,this.table.$container)),c=u.top+u.bottom,f=this.table.menuBar,h=this.table.footer,p=this.table.header,d=this.table.tileTableHeader,y=this.table.visibleColumns(),v=y[y.length-1],b=this.table.htmlComp,m=b.availableSize({exact:!0}).subtract(b.insets());if(this.table.menuBarVisible&&f.visible){var g=ea.get(f.$container),_=ok.size(g,m);g.setSize(_),n=_.height}if(p&&(o=qs.size(p.$container).height,p.menuBar&&p.menuBar.validateLayout()),h&&(r=qs.size(h.$container).height,s=h.computeControlContainerHeight(this.table,h.selectedControl,!this._dataHeightPositive),t=qs.insets(h.$controlContainer),h.animating||(h.$controlContainer.cssHeight(s),h.$controlContent.outerHeight(s-t.vertical()),h.revalidateLayout())),d&&d.visible){var w=d.htmlComp.prefSize({widthHint:m.width});w.width=m.width,w=w.subtract(d.htmlComp.margins()),d.htmlComp.setSize(w),i=w.height}var k=c+n+s+r+o+i,S=m.height-k;l?(l.css("height","calc(100% - "+k+"px)"),this._dataHeightPositive=l.height()>0):a&&a.htmlComp&&(a.htmlComp.setSize(new $s(m.width,S)),Lh.update(a.$container),this._dataHeightPositive=S>0),this.table.tileMode||(this._layoutColumns(),p&&p.resizeHeaderItem(v),this.table.setViewRangeSize(this.table.calculateViewRangeSize()),b.layouted||this.table._renderScrollTop(),this.table._renderViewport(),this.table.tooltips.forEach((function(e){e.rendered&&e.position()})),this.table.cellEditorPopup&&this.table.cellEditorPopup.rendered&&(this.table.cellEditorPopup.position(),this.table.cellEditorPopup.pack()),this.table.updateScrollbars())}},{key:"_layoutColumns",value:function(e){this._autoOptimizeColumnsWidths();var t=this.table.htmlComp,n=this.table.columnLayoutDirty||!t.sizeCached;if(!n){var r=e||t.size().width;n=t.sizeCached.width!==r}n&&(this.table.autoResizeColumns&&this._autoResizeColumns(e),this._updateRealColumnWidths(),this.table.columnLayoutDirty=!1)}},{key:"_updateRealColumnWidths",value:function(){this.table._updateRealColumnWidths()&&(this.table._updateRowWidth(),this.table.header&&this.table.header.rendered&&this.table.header.resizeHeaderItems(),this.table.$rows(!0).css("width",this.table.rowWidth))}},{key:"_autoOptimizeColumnsWidths",value:function(){this.table.visibleColumns().forEach((function(e){e.autoOptimizeWidth&&e.autoOptimizeWidthRequired&&this.table.resizeToFit(e,e.autoOptimizeMaxWidth)}),this)}},{key:"_autoResizeColumns",value:function(e){var t,n,r=this,o=[],i=0,s=0,a=e||this.table.$data.width(),l=Math.floor(a-this.table.rowBorderWidth);if(this.table.visibleColumns().forEach((function(e){e.fixedWidth||e.autoOptimizeWidth?l-=e.width:(o.push(e),i+=e.width,s+=e.initialWidth)})),l!==i){var u=l,c=o.filter((function(e){var r=Math.max(e.minWidth,e.initialWidth);return n=0===s?1/o.length:e.initialWidth/s,(t=Math.floor(n*u))<r&&(t=r,u=Math.max(u-t,0),!0)}));c.forEach((function(e,n){var i=Math.max(e.minWidth,e.initialWidth);rt.remove(o,e),t=i,s-=e.initialWidth,n===c.length-1&&u>0&&0===o.length&&(t+=u,u=0),t!==e.width&&r.table.resizeColumn(e,t)})),l=u,o.forEach((function(e,i){n=0===s?1/o.length:e.initialWidth/s,t=Math.floor(n*l),u-=t,i===o.length-1&&u>0&&(t+=u,u=0),t!==e.width&&r.table.resizeColumn(e,t)}))}}},{key:"preferredLayoutSize",value:function(e,t){return this.table.tileMode?(new El).preferredLayoutSize(e,t):(this._layoutColumns(t.widthHint),this.table._renderViewport(),CD(ED(i.prototype),"preferredLayoutSize",this).call(this,e,t))}}])&&TD(t.prototype,n),r&&TD(t,r),i}(Zs);function AD(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var FD=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.table=t,this.mouseMoveSelectionEnabled=!0,this._mouseDown=!1,this.lastActionRow=null,this.mouseOverHandler=null,this.select=!0,this.counterDebug=0,this.fromIndex=-1,this.toIndex=-1,this._prevSelectedRowIndex=-1,this._maxSelectedRowIndex=-1}var t,n,r;return t=e,(n=[{key:"clearLastSelectedRowMarker",value:function(){this.lastActionRow=null}},{key:"onMouseDown",value:function(e){var t=s()(e.currentTarget),n=t.data("row"),r=t.isSelected(),o=this.table.visibleRows;if(this._mouseDown=!0,this.select=!0,this.table.multiSelect&&e.shiftKey){if(this.table.selectedRows.indexOf(n)>-1)return;if(0===this.table.selectedRows.length&&(this.lastActionRow=n),!this.lastActionRow){var i=o.indexOf(n),a=this.table.selectedRows[0],l=this.table.selectedRows[this.table.selectedRows.length-1];i<=(o.indexOf(a)+o.indexOf(l))/2?this.lastActionRow=a:this.lastActionRow=l,this._maxSelectedRowIndex=o.indexOf(l),this._prevSelectedRowIndex=o.indexOf(this.lastActionRow)}this.fromIndex=o.indexOf(this.lastActionRow)}else e.ctrlKey?this.select=!r:(!r||this.table.selectedRows.length>1&&3!==e.which)&&(this.table._removeSelection(),this.table.selectedRows=[]);this.fromIndex<0&&(this.fromIndex=o.indexOf(n)),3===e.which&&r||(this.toIndex=o.indexOf(n),this.handleSelection(e),this.table.notifyRowSelectionFinished()),this.mouseMoveSelectionEnabled&&3!==e.which&&(this.table.$data.off("mouseover",this.mouseOverHandler),this.mouseOverHandler=this.onMouseOver.bind(this),this.table.$data.on("mouseover",".table-row",this.mouseOverHandler)),t.window().one("mouseup.selectionHandler",this.onMouseUp.bind(this)),this.lastActionRow=n}},{key:"onMouseOver",value:function(e){var t=s()(e.currentTarget).data("row"),n=this.table.visibleRows;this.toIndex=n.indexOf(t),this.handleSelection(e),this.lastActionRow=t}},{key:"handleSelection",value:function(e){var t,n=this.table.visibleRows;if(this.table.multiSelect){var r=this.toIndex,o=r<this._prevSelectedRowIndex,i=r>this._prevSelectedRowIndex,s=this._prevSelectedRowIndex<this.fromIndex,a=this._prevSelectedRowIndex>this.fromIndex;if(!e.ctrlKey){if(o&&a?t=n.slice(r+1,this._maxSelectedRowIndex+1):i&&s&&(t=n.slice(this._maxSelectedRowIndex,r)),t&&e.shiftKey){var l=this.getMinMaxSelectionIndizes();t=t.reduce((function(e,t){var r=n.indexOf(t);return O.isOneOf(r,l[0],l[1])&&e.push(t),e}),[])}t&&t.forEach((function(e){this.table.removeRowFromSelection(e,!0)}),this)}this._maxSelectedRowIndex=o?Math.min(this._maxSelectedRowIndex,r):i?Math.max(this._maxSelectedRowIndex,r):r,this._prevSelectedRowIndex=r}else this.select&&(this.table._removeSelection(),this.table.selectedRows=[]),this.fromIndex=this.toIndex;this._selectRange(this.fromIndex,this.toIndex,this.select)}},{key:"_selectRange",value:function(e,t,n){var r=this.table.visibleRows,o=Math.min(e,t),i=Math.max(e,t)+1,s=r.slice(o,i);n?s.forEach((function(e){this.table.addRowToSelection(e,!0)}),this):s.forEach((function(e){this.table.removeRowFromSelection(e,!0)}),this)}},{key:"getMinMaxSelectionIndizes",value:function(){var e=this.table.selectedRows,t=this.table.visibleRows;if(!e||0===e.length)return[-1,-1];var n=-1,r=-1;return e.forEach((function(e){var o=t.indexOf(e);(-1===n||o<n)&&(n=o),(-1===r||o>r)&&(r=o)})),[n,r]}},{key:"onMouseUp",value:function(e){this._mouseDown&&this.table.rendered&&(this._mouseDown=!1,this.table.$data.off("mouseover",this.mouseOverHandler),this.fromIndex=-1,this.toIndex=-1,this.select=!0,this.table.notifyRowSelectionFinished())}}])&&AD(t.prototype,n),r&&AD(t,r),e}();function $D(e){return($D="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function jD(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function BD(e,t,n){return(BD="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=ND(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function MD(e,t){return(MD=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function ID(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=ND(e);if(t){var o=ND(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return LD(this,n)}}function LD(e,t){return!t||"object"!==$D(t)&&"function"!=typeof t?HD(e):t}function HD(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ND(e){return(ND=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var VD=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&MD(e,t)}(i,e);var t,n,r,o=ID(i);function i(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(e=o.call(this)).table=null,e.tileAccordion=null,e._tileGridListener=null,e._tableListener=null,e._destroyHandler=null,e.tiles=[],e.tileMappings=[],e.tilesMap={},e.tileFilterMap={},e.groups={},e.groupForTileMap={},e.tableState={},e._tileAccordionPropertyChangeHandler=e._onTileAccordionPropertyChange.bind(HD(e)),e._tileAccordionActionHandler=e._onTileAccordionAction.bind(HD(e)),e._tileAccordionClickHandler=e._onTileAccordionClick.bind(HD(e)),e._tableFilterAddedHandler=e._onTableFilterAdded.bind(HD(e)),e._tableFilterRemovedHandler=e._onTableFilterRemoved.bind(HD(e)),e._tableFilterHandler=e._onTableFilter.bind(HD(e)),e._tableGroupHandler=e._onTableGroup.bind(HD(e)),e._tableRowsSelectedHandler=e._onTableRowsSelected.bind(HD(e)),e._tableRowsInsertedHandler=e._onTableRowsInserted.bind(HD(e)),e._tableRowsDeletedHandler=e._onTableRowsDeleted.bind(HD(e)),e._tableAllRowsDeletedHandler=e._onTableAllRowsDeleted.bind(HD(e)),e._tableRowOrderChangedHandler=e._onTableRowOrderChangedHandler.bind(HD(e)),e._destroyHandler=e._uninstallListeners.bind(HD(e)),e.exclusiveExpand=!1,e.gridColumnCount=null,e.tileGridLayoutConfig=null,e.withPlaceholders=null,e._addWidgetProperties(["tileAccordion","tiles","tileMappings"]),e}return t=i,(n=[{key:"init",value:function(e){BD(ND(i.prototype),"_init",this).call(this,e),this.table=this.parent,this.tileAccordion||(this.tileAccordion=this._createTileAccordion(),this._installListeners()),this.tableState.headerVisible=this.table.headerVisible,this._setTiles(this.tiles),this._setTileMappings(this.tileMappings)}},{key:"_installListeners",value:function(){this.tileAccordion.on("propertyChange",this._tileAccordionPropertyChangeHandler),this.tileAccordion.on("tileAction",this._tileAccordionActionHandler),this.tileAccordion.on("tileClick",this._tileAccordionClickHandler),this.table.on("filterAdded",this._tableFilterAddedHandler),this.table.on("filterRemoved",this._tableFilterRemovedHandler),this.table.on("filter",this._tableFilterHandler),this.table.on("group",this._tableGroupHandler),this.table.on("rowsSelected",this._tableRowsSelectedHandler),this.table.on("rowsInserted",this._tableRowsInsertedHandler),this.table.on("rowsDeleted",this._tableRowsDeletedHandler),this.table.on("allRowsDeleted",this._tableAllRowsDeletedHandler),this.table.on("rowOrderChanged",this._tableRowOrderChangedHandler),this.tileAccordion.on("destroy",this._destroyHandler),this.table.on("destroy",this._destroyHandler)}},{key:"_uninstallListeners",value:function(){this.tileAccordion.off("propertyChange",this._tileAccordionPropertyChangeHandler),this.tileAccordion.off("tileAction",this._tileAccordionActionHandler),this.tileAccordion.off("tileClick",this._tileAccordionClickHandler),this.table.off("filterAdded",this._tableFilterAddedHandler),this.table.off("filterRemoved",this._tableFilterRemovedHandler),this.table.off("filter",this._tableFilterHandler),this.table.off("group",this._tableGroupHandler),this.table.off("rowsSelected",this._tableRowsSelectedHandler),this.table.off("rowsInserted",this._tableRowsInsertedHandler),this.table.off("rowsDeleted",this._tableRowsDeletedHandler),this.table.off("allRowsDeleted",this._tableAllRowsDeletedHandler),this.table.off("rowOrderChanged",this._tableRowOrderChangedHandler),this.tileAccordion.off("destroy",this._destroyHandler),this.table.off("destroy",this._destroyHandler)}},{key:"setGridColumnCount",value:function(e){this.setProperty("gridColumnCount",e),this.tileAccordion&&this.tileAccordion.setGridColumnCount(e)}},{key:"setTileGridLayoutConfig",value:function(e){this.setProperty("tileGridLayoutConfig",e),this.tileAccordion&&this.tileAccordion.setTileGridLayoutConfig(e)}},{key:"setWithPlaceholders",value:function(e){this.setProperty("withPlaceholders",e),this.tileAccordion&&this.tileAccordion.setWithPlaceholders(e)}},{key:"_setTileMappings",value:function(e){if(this._setProperty("tileMappings",e),e){var t=e.map(this.resolveMapping,this);this._setTiles(t)}}},{key:"setTiles",value:function(e){this.setProperty("tiles",e)}},{key:"_setTiles",value:function(e){this._isUpdatingTiles=!0,rt.removeAll(this.tiles,e),this.reset(),this._setTilesInternal(e),this._isUpdatingTiles=!1}},{key:"_setTilesInternal",value:function(e){e.some((function(e){return void 0===this.table.rowsMap[e.rowId]}),this)?this.table.initialized?this.table.one("rowsInserted",this._setTilesInternal.bind(this,e)):this.table.one("init",this._setTilesInternal.bind(this,e)):(this._refreshTilesMap(e),this._initGroups(e),this._setProperty("tiles",e),this.tileAccordion.setTiles(this.tiles),this._updateGroupVisibility(),this._syncSelectionFromTableToTile())}},{key:"loadTiles",value:function(){var e=this.table.rows.filter((function(e){return!e.parentRow})),t=this.table.createTiles(e);t&&this.setTiles(t)}},{key:"resolveMapping",value:function(e){var t=e.tile;return t.rowId=e.tableRow,t.setParent(this),t.setOwner(this),t}},{key:"_refreshTilesMap",value:function(e){e||(e=this.tiles,this.tilesMap={}),e.forEach((function(e){this.tilesMap[e.rowId]=e}),this)}},{key:"getTilesForRows",value:function(e){return e.map((function(e){return this.tilesMap[e.id]}),this).filter((function(e){return!!e}))}},{key:"_initGroups",value:function(e){var t=rt.find(this.table.columns,(function(e){return e.grouped&&0===e.sortIndex}));e.forEach((function(e){var n=this.table.rowsMap[e.rowId],r=t?t.cellTextForGrouping(n):"default";r=O.nvl(r,""),this.groupForTileMap[n.id]=r;var o=this.tileAccordion.getGroupById(r);o||(o=this._createTileGroup(r,t,n),this._adaptTileGrid(o.body),this.tileAccordion.insertGroup(o)),e.parent=o}),this)}},{key:"_adaptTileGrid",value:function(e){Pr.mandatoryFunction(e,"_showContextMenu");var t=e._showContextMenu;e._showContextMenu=function(n){Pr.mandatoryFunction(this.table,"_filterMenusForContextMenu"),n.menuItems=this.table._filterMenusForContextMenu(),O.assertProperty(this.table,"_filterMenusHandler"),n.menuFilter=this.table._filterMenusHandler,t.call(e,n)}.bind(this),e.keyStrokeContext.$bindTarget=this.table.keyStrokeContext.$bindTarget}},{key:"_createTileAccordion",value:function(){return O.create("TileAccordion",{parent:this.table,virtual:!0,selectable:!0,multiselect:this.table.multiSelect,exclusiveExpand:this.exclusiveExpand,gridColumnCount:this.gridColumnCount,tileGridLayoutConfig:this.tileGridLayoutConfig,withPlaceholders:this.withPlaceholders})}},{key:"_createTileGroup",value:function(e,t,n){var r,o,i;if(t){r=t.htmlEnabled;var s=t.createAggrGroupCell(n);o=s.text,i=s.iconId}return O.create("Group",{parent:this.tileAccordion,id:e,headerVisible:"default"!==e,title:o,titleHtmlEnabled:r,iconId:i,body:{objectType:"TileGrid",scrollable:!1}})}},{key:"activate",value:function(){this.tableState.headerVisible=this.table.headerVisible,this.table.setHeaderVisible(!1),this.table.tileTableHeader&&this.table.tileTableHeader.setVisible(!0),this.table.tableControls.forEach((function(e){e instanceof Z$&&(this.tableState.aggregateTableControlSelected=e.selected,e.setSelected(!1,{closeWhenUnselected:!0,animate:!1}),e.setVisible(!1))}),this),this.tableState.loadingSupportContainer=this.table.loadingSupport.options$Container,this.table.loadingSupport.options$Container=function(){return this.tileAccordion.$container}.bind(this),null!==rt.find(this.table.rows,(function(e){return e.parentRow}))&&(this.table.addFilter(O.create("TileTableHierarchyFilter",{table:this.table})),this.table.filter()),this._syncFiltersFromTableToTile(),this._syncScrollTopFromTableToTile()}},{key:"deactivate",value:function(){this.table.tableControls.forEach((function(e){e instanceof Z$&&e.setVisible(!0)}),this),this.table._setProperty("headerVisible",this.tableState.headerVisible),this.table.tileTableHeader&&this.table.tileTableHeader.setVisible(!1),this.tableState.loadingSupportContainer&&(this.table.loadingSupport.options$Container=this.tableState.loadingSupportContainer),this.table.removeFilter(O.create("TileTableHierarchyFilter")),this.table.filter(),this._syncScrollTopFromTileGridToTable(),this.reset()}},{key:"reset",value:function(){this.tilesMap={},this.groups={},this.groupForTileMap={},this.tileAccordion.deleteAllTiles(),this.tileAccordion.deleteAllGroups(),this.tiles.forEach((function(e){e.destroy()}))}},{key:"renderTileMode",value:function(){this.table.tileMode?(this.table.$data&&this.table._removeData(),this._renderTileTableHeader(),this._renderTileAccordion()):(this._removeTileTableHeader(),this._removeTileAccordion(),this.table._renderData(),this.table._renderTableHeader(),this.tableState.aggregateTableControlSelected&&rt.find(this.table.tableControls,(function(e){return e instanceof Z$})).setSelected(!0)),this.table._refreshMenuBarPosition()}},{key:"destroy",value:function(){this.tiles.forEach((function(e){e.destroy()})),this.tileAccordion.destroy(),this.tileAccordion=null}},{key:"insertTiles",value:function(e){0!==(e=rt.ensure(e)).length&&this.setTiles(this.tiles.concat(e))}},{key:"deleteTiles",value:function(e){e||(e=this.tiles.slice()),rt.removeAll(this.tiles,e),e.forEach((function(e){delete this.tilesMap[e.rowId],delete this.groupForTileMap[e.rowId];var t=this.tileAccordion.getGroupByTile(e);t&&1===t.body.tiles.length&&this.tileAccordion.deleteGroup(t),e.destroy()}),this),this.tileAccordion.deleteTiles(e)}},{key:"_onTileAccordionPropertyChange",value:function(e){this.table.tileMode&&("selectedTiles"===e.propertyName&&(this._syncSelectionFromTileGridToTable(e.source.getSelectedTiles()),this.tileAccordion.rendered&&this.tileAccordion.$container.document(!0).getSelection().removeAllRanges()),"filteredTiles"===e.propertyName&&this._updateGroupVisibility())}},{key:"_onTileAccordionAction",value:function(e){this.table.tileMode&&this.table.doRowAction(this.table.rowsMap[e.tile.rowId])}},{key:"_onTileAccordionClick",value:function(e){this.table.tileMode&&this.table._triggerRowClick(this.table.rowsMap[e.tile.rowId],e.mouseButton)}},{key:"_onTableRowsSelected",value:function(e){this.table.tileMode&&this._syncSelectionFromTableToTile()}},{key:"_onTableRowsInserted",value:function(e){this.table.tileMode&&this.insertTiles(this.table.createTiles(e.rows))}},{key:"_onTableRowsDeleted",value:function(e){this.table.tileMode&&this.deleteTiles(this.getTilesForRows(e.rows))}},{key:"_onTableAllRowsDeleted",value:function(e){this.table.tileMode&&this.deleteTiles()}},{key:"_onTableRowOrderChangedHandler",value:function(e){this.table.tileMode&&!s.a.isEmptyObject(this.tilesMap)&&(this.tiles=this.table.rows.map((function(e){return this.tilesMap[e.id]}),this),this.tileAccordion.setTiles(this.tiles))}},{key:"_onTableGroup",value:function(e){this.table.tileMode&&(this.tileAccordion.deleteAllGroups(),this._initGroups(this.tiles),this.tileAccordion.setTiles(this.tiles))}},{key:"_onTableFilterAdded",value:function(e){this.table.tileMode&&this._addFilter(e.filter)}},{key:"_onTableFilterRemoved",value:function(e){this.table.tileMode&&(this.tileAccordion.removeTileFilter(this.tileFilterMap[e.filter.createKey()]),this.tileAccordion.filterTiles())}},{key:"_addFilter",value:function(e){var t={table:this.table,accept:function(t){var n=this.table.rowsMap[t.rowId];return!!n&&e.accept(n)}},n=e.createKey();this.tileFilterMap[n]&&this.tileAccordion.removeTileFilter(this.tileFilterMap[n]),this.tileFilterMap[n]=t,this.tileAccordion.addTileFilter(t)}},{key:"_onTableFilter",value:function(e){this.table.tileMode&&this.tileAccordion.filterTiles()}},{key:"_syncSelectionFromTableToTile",value:function(){this.tileAccordion&&this.tileAccordion.selectTiles(this.getTilesForRows(this.table.selectedRows))}},{key:"_syncSelectionFromTileGridToTable",value:function(e){if(!this._isUpdatingTiles){var t=e.map((function(e){return this.table.rowsMap[e.rowId]}),this).filter((function(e){return Boolean(e)}));this.table.selectRows(t)}}},{key:"_updateGroupVisibility",value:function(){this.tileAccordion.groups.forEach((function(e){var t=e.body.filters.length>0&&0===e.body.filteredTiles.length;e.setVisible(!t),e.setTitleSuffix("("+e.body.filteredTiles.length+")")}))}},{key:"_syncScrollTopFromTableToTile",value:function(){var e=this.table._rowIndexAtScrollTop(this.table.scrollTop);if(!(e<=0)){var t=this.tilesMap[this.table.rows[e].id];if(t){this.tileAccordion.scrollTop=null;var n={align:"top"};t.rendered?t.reveal(n):this.table.session.layoutValidator.schedulePostValidateFunction(t.reveal.bind(t,n))}}}},{key:"_syncScrollTopFromTileGridToTable",value:function(){var e=this.tileAccordion._tileAtScrollTop(this.tileAccordion.scrollTop);if(e){var t={align:"top"};this.table._isDataRendered()?this.table.scrollTo(this.table.rowsMap[e.rowId],t):this.table.session.layoutValidator.schedulePostValidateFunction(this.table.scrollTo.bind(this.table,this.table.rowsMap[e.rowId],t))}}},{key:"_syncFiltersFromTableToTile",value:function(){this.tileAccordion&&(this.tileAccordion.setTileFilters([]),Object.keys(this.table._filterMap).map((function(e){return this.table._filterMap[e]}),this).forEach((function(e){this._addFilter(e)}),this),this.tileAccordion.filterTiles())}},{key:"_renderTileTableHeader",value:function(){this.table.tileTableHeader&&this.table.tileTableHeader.render()}},{key:"_removeTileTableHeader",value:function(){this.table.tileTableHeader&&this.table.tileTableHeader.remove()}},{key:"_renderTileAccordion",value:function(){this.tileAccordion.rendered||this.tileAccordion.render()}},{key:"_removeTileAccordion",value:function(){this.tileAccordion.rendered&&this.tileAccordion.remove()}}])&&jD(t.prototype,n),r&&jD(t,r),i}(ve);function WD(e){return(WD="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function zD(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function GD(e,t){return(GD=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function UD(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=qD(e);if(t){var o=qD(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return KD(this,n)}}function KD(e,t){return!t||"object"!==WD(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function qD(e){return(qD=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var YD=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&GD(e,t)}(i,e);var t,n,r,o=UD(i);function i(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),o.call(this)}return t=i,r=[{key:"modifyTableTileGridMediator",value:function(){E.get().remote&&(Pr.replacePrototypeFunction(VD,"loadTiles",(function(){if(!this.modelAdapter)return this.loadTilesOrig()}),!0),Pr.replacePrototypeFunction(VD,"_onTableRowsInserted",(function(e){if(!this.modelAdapter)return this._onTableRowsInsertedOrig(e)}),!0),Pr.replacePrototypeFunction(VD,"_onTableRowsDeleted",(function(e){if(!this.modelAdapter)return this._onTableRowsDeletedOrig(e)}),!0),Pr.replacePrototypeFunction(VD,"_onTableAllRowsDeleted",(function(e){if(!this.modelAdapter)return this._onTableAllRowsDeletedOrig(e)}),!0))}}],(n=null)&&zD(t.prototype,n),r&&zD(t,r),i}(de);function XD(e){return(XD="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function JD(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ZD(e,t,n){return(ZD="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=rA(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function QD(e,t){return(QD=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function eA(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=rA(e);if(t){var o=rA(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return tA(this,n)}}function tA(e,t){return!t||"object"!==XD(t)&&"function"!=typeof t?nA(e):t}function nA(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function rA(e){return(rA=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}E.addListener("bootstrap",YD.modifyTableTileGridMediator);var oA=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&QD(e,t)}(i,e);var t,n,r,o=eA(i);function i(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(e=o.call(this)).table=null,e.page=null,e.row=null,e._tableRowsUpdatedHandler=e._onTableRowsUpdated.bind(nA(e)),e._tableRowsInsertedHandler=e._onTableRowsInserted.bind(nA(e)),e}return t=i,(n=[{key:"_init",value:function(e){ZD(rA(i.prototype),"_init",this).call(this,e),this.row=this.page.row,this.table.on("rowsUpdated",this._tableRowsUpdatedHandler),this.table.on("rowsInserted",this._tableRowsInsertedHandler)}},{key:"_destroy",value:function(){this.table.off("rowsUpdated",this._tableRowsUpdatedHandler),this.table.off("rowsInserted",this._tableRowsInsertedHandler),ZD(rA(i.prototype),"_destroy",this).call(this)}},{key:"_render",value:function(){this.$container=this.$parent.appendDiv("table-row-detail"),this.htmlComp=ea.install(this.$container,this.session),this._renderRow()}},{key:"_renderRow",value:function(){this.table.visibleColumns().forEach(this._renderCell.bind(this)),this.invalidateLayoutTree()}},{key:"_renderCell",value:function(e){var t=this.table.cell(e,this.row);if(!Wn.empty(t.text)||t.iconId){var n;n=e.headerHtmlEnabled?Wn.plainText(e.text):e.text,Wn.empty(n)&&(n=e.headerTooltipHtmlEnabled?Wn.plainText(e.headerTooltipText):e.headerTooltipText);var r=e.cellTextForRowDetail(this.row),o=this.$container.appendDiv("table-row-detail-field");Wn.empty(n)||o.appendSpan("table-row-detail-name").text(n+": ");var i=t.iconId,s=!Wn.empty(r);i&&o.appendIcon(i,"table-row-detail-icon").toggleClass("with-text",s),s&&o.appendSpan("table-row-detail-value").html(r)}}},{key:"_refreshRow",value:function(){this.$container.empty(),this._renderRow()}},{key:"_onTableRowsUpdated",value:function(e){var t=this;if(this.rendered){var n=rt.find(e.rows,(function(e){return e.id===t.row.id}));n&&(this.row=n,this._refreshRow())}}},{key:"_onTableRowsInserted",value:function(e){this.rendered&&(e.source.rows.indexOf(this.page.row)<0||(this.row=this.page.row,this._refreshRow()))}}])&&JD(t.prototype,n),r&&JD(t,r),i}(ve);function iA(e){return(iA="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function sA(e,t){return(sA=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function aA(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=uA(e);if(t){var o=uA(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return lA(this,n)}}function lA(e,t){return!t||"object"!==iA(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function uA(e){return(uA=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var cA=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&sA(e,t)}(n,e);var t=aA(n);function n(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),(e=t.call(this)).tableRow=null,e.tile=null,e._addWidgetProperties(["tile"]),e}return n}(ve);function fA(e){return(fA="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function hA(e,t){return(hA=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function pA(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=yA(e);if(t){var o=yA(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return dA(this,n)}}function dA(e,t){return!t||"object"!==fA(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function yA(e){return(yA=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var vA=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&hA(e,t)}(n,e);var t=pA(n);function n(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),t.call(this)}return n}(de);function bA(e){return(bA="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function mA(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function gA(e,t,n){return(gA="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=SA(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function _A(e,t){return(_A=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function wA(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=SA(e);if(t){var o=SA(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return kA(this,n)}}function kA(e,t){return!t||"object"!==bA(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function SA(e){return(SA=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var OA=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_A(e,t)}(i,e);var t,n,r,o=wA(i);function i(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),o.call(this)}return t=i,(n=[{key:"_init",value:function(e){gA(SA(i.prototype),"_init",this).call(this,e),this.table=e.table}},{key:"_render",value:function(){gA(SA(i.prototype),"_render",this).call(this),this._rowOrderChangedFunc=function(e){e.animating?e.row===this.row&&this.position():this.position()}.bind(this),this.table.on("rowOrderChanged",this._rowOrderChangedFunc)}},{key:"_remove",value:function(){gA(SA(i.prototype),"_remove",this).call(this),this.table.off("rowOrderChanged",this._rowOrderChangedFunc)}}])&&mA(t.prototype,n),r&&mA(t,r),i}(Tp);function TA(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var CA=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._rowMap={},this.promises=[],this.table=t}var t,n,r;return t=e,(n=[{key:"pushPromise",value:function(e){this.promises.push(e),this.table._renderViewportBlocked=!0,this.table.setLoading(!0);var t=function(){rt.remove(this.promises,e),0===this.promises.length&&this.process()}.bind(this);e.then(t,t)}},{key:"isBuffering",value:function(){return this.promises.length>0}},{key:"buffer",value:function(e){(e=rt.ensure(e)).forEach((function(e){this._rowMap[e.id]=e}),this)}},{key:"process",value:function(){if(!this.table.destroyed){var e=Pr.values(this._rowMap);this.table.updateRows(e),this._rowMap={},this.table.setLoading(!1),this.table._renderViewportBlocked=!1,this.table._isDataRendered()&&this.table._renderViewport()}}}])&&TA(t.prototype,n),r&&TA(t,r),e}();function PA(e){return(PA="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function RA(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function xA(e,t,n){return(xA="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=FA(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function EA(e,t){return(EA=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function DA(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=FA(e);if(t){var o=FA(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return AA(this,n)}}function AA(e,t){return!t||"object"!==PA(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function FA(e){return(FA=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var $A=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&EA(e,t)}(i,e);var t,n,r,o=DA(i);function i(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(e=o.call(this)).table=null,e}return t=i,(n=[{key:"_init",value:function(e){xA(FA(i.prototype),"_init",this).call(this,e)}},{key:"_data",value:function(){var e=[];return e.push([null,this.session.text("NoGrouping"),"BOLD"]),this.table.visibleColumns().forEach((function(t){this.table.isGroupingPossible(t)&&e.push([t,O.nvl(t.text,t.headerTooltipText)])}),this),e}},{key:"_dataToLookupRow",value:function(e){return O.create("LookupRow",{key:e[0],text:e[1],font:e[2]})}}])&&RA(t.prototype,n),r&&RA(t,r),i}(Di);function jA(e){return(jA="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function BA(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function MA(e,t,n){return(MA="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=NA(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function IA(e,t){return(IA=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function LA(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=NA(e);if(t){var o=NA(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return HA(this,n)}}function HA(e,t){return!t||"object"!==jA(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function NA(e){return(NA=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var VA=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&IA(e,t)}(i,e);var t,n,r,o=LA(i);function i(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(e=o.call(this)).table=null,e}return t=i,(n=[{key:"_init",value:function(e){MA(NA(i.prototype),"_init",this).call(this,e)}},{key:"_data",value:function(){var e=[];return this.table.visibleColumns().forEach((function(t){t.isSortingPossible()&&(e.push([{column:t,asc:!0},O.nvl(t.text,t.headerTooltipText)+" ("+this.session.text("ui.ascending")+")",gn.LONG_ARROW_UP_BOLD]),e.push([{column:t,asc:!1},O.nvl(t.text,t.headerTooltipText)+" ("+this.session.text("ui.descending")+")",gn.LONG_ARROW_DOWN_BOLD]))}),this),e}},{key:"_dataToLookupRow",value:function(e){return O.create("LookupRow",{key:e[0],text:e[1],iconId:e[2]})}}])&&BA(t.prototype,n),r&&BA(t,r),i}(Di),WA={collator:null,installed:!1,install:function(e){return this.installed||(Kt.get().supportsInternationalization()?(this.collator=new window.Intl.Collator(e.locale.languageTag),s.a.log.isInfoEnabled()&&s.a.log.info("(comparators.TEXT#install) Browser supports i18n - installed Intl.Collator, can sort in Browser")):s.a.log.isInfoEnabled()&&s.a.log.info("(comparators.TEXT#install) Browser doesn't support i18n. Must sort on server"),this.installed=!0),!!this.collator},compare:function(e,t){return e||t?e?t?this.collator?this.collator.compare(e,t):e<t?-1:e>t?1:0:1:-1:0},compareIgnoreCase:function(e,t){return e||(e=null),t||(t=null),e===t?0:null===e?-1:null===t?1:this.compare(e.toLowerCase(),t.toLowerCase())}},zA={install:function(e){return!0},compare:function(e,t){return Pr.isNullOrUndefined(e)&&Pr.isNullOrUndefined(t)?0:Pr.isNullOrUndefined(e)?-1:Pr.isNullOrUndefined(t)?1:e<t?-1:e>t?1:0}},GA={ALPHANUMERIC:{collator:null,installed:!1,install:function(e){return WA.install(e),this.collator=WA.collator,!!this.collator&&zA.install(e)},compare:function(e,t){return this._compare(e,t,!1)},compareIgnoreCase:function(e,t){return this._compare(e,t,!0)},_compare:function(e,t,n){if(!e&&!t)return 0;if(!e)return-1;if(!t)return 1;for(var r="(([0-9]+)|([^0-9]+))",o=new RegExp(r,"g"),i=new RegExp(r,"g"),s=o.exec(e),a=i.exec(t);s&&a;){var l=parseInt(s[1],0),u=parseInt(a[1],0);if(isNaN(l)||isNaN(u)){var c=n?WA.compareIgnoreCase(s[1],a[1]):WA.compare(s[1],a[1]);if(0!==c)return c}else{var f=zA.compare(l,u);if(0!==f)return f}s=o.exec(e),a=i.exec(t)}return s||a?s?1:-1:0}},NUMERIC:zA,TEXT:WA};function UA(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function KA(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var qA=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.autoOptimizeWidth=!1,this.autoOptimizeWidthRequired=!1,this.autoOptimizeMaxWidth=-1,this.cssClass=null,this.compacted=!1,this.editable=!1,this.removable=!1,this.modifiable=!1,this.fixedWidth=!1,this.fixedPosition=!1,this.grouped=!1,this.headerCssClass=null,this.headerIconId=null,this.headerHtmlEnabled=!1,this.headerTooltipText=null,this.horizontalAlignment=-1,this.htmlEnabled=!1,this.index=-1,this.initialized=!1,this.mandatory=!1,this.optimalWidthMeasurer=new XA(this),this.sortActive=!1,this.sortAscending=!0,this.sortIndex=-1,this.summary=!1,this.type="text",this.width=60,this.initialWidth=void 0,this.prefMinWidth=null,this.minWidth=e.DEFAULT_MIN_WIDTH,this.showSeparator=!0,this.table=null,this.tableNodeColumn=!1,this.maxLength=4e3,this.text=null,this.textWrap=!1,this.filterType="TextColumnUserFilter",this.comparator=GA.TEXT,this.displayable=!0,this.visible=!0,this.textBased=!0,this.headerMenuEnabled=!0,this.tableNodeLevel0CellPadding=28,this.expandableIconLevel0CellPadding=13,this.nodeColumnCandidate=!0,this.events=this._createEventSupport(),this._tableColumnsChangedHandler=this._onTableColumnsChanged.bind(this),this._realWidth=null,this.$header=null,this.$separator=null}var t,n,r;return t=e,(n=[{key:"init",value:function(e){this.session=e.session,s.a.extend(this,e),void 0===this.initialWidth&&(this.initialWidth=O.nvl(this.width,0)),this._init(e),this.initialized=!0}},{key:"_init",value:function(e){bp.resolveTextProperty(this,"text"),bp.resolveTextProperty(this,"headerTooltipText"),gn.resolveIconProperty(this,"headerIconId"),this._setTable(this.table),this._setDisplayable(this.displayable),this._setAutoOptimizeWidth(this.autoOptimizeWidth)}},{key:"destroy",value:function(){this._destroy(),this._setTable(null)}},{key:"_destroy",value:function(){}},{key:"_setTable",value:function(e){this.table&&this.table.off("columnMoved columnStructureChanged",this._tableColumnsChangedHandler),this.table=e,this.table&&this.table.on("columnMoved columnStructureChanged",this._tableColumnsChangedHandler)}},{key:"initCell",value:function(e,t){var n=this._ensureCell(e);return this._initCell(n),Pr.isNullOrUndefined(n.text)&&this._updateCellText(t,n),n}},{key:"_ensureCell",value:function(e){var t;return e instanceof Af?(t=e).value=this._parseValue(t.value):t=O.create("Cell",{value:this._parseValue(e)}),t}},{key:"_parseValue",value:function(e){return e}},{key:"_updateCellText",value:function(e,t){var n=t.value;if(e){var r=this._formatValue(n,e);r&&s.a.isFunction(r.promise)?this.setCellTextDeferred(r,e,t):this.setCellText(e,r,t)}}},{key:"_formatValue",value:function(e,t){return O.nvl(e,"")}},{key:"_initCell",value:function(e){return e.cssClass=O.nvl(e.cssClass,this.cssClass),e.editable=O.nvl(e.editable,this.editable),e.horizontalAlignment=O.nvl(e.horizontalAlignment,this.horizontalAlignment),e.htmlEnabled=O.nvl(e.htmlEnabled,this.htmlEnabled),e.mandatory=O.nvl(e.mandatory,this.mandatory),e}},{key:"buildCellForRow",value:function(e){var t=this.cell(e);return this.buildCell(t,e)}},{key:"buildCellForAggregateRow",value:function(e){var t;if(this.grouped){var n=this.table.groupingStyle===Cx.GroupingStyle.TOP?e.nextRow:e.prevRow;t=this.createAggrGroupCell(n)}else{var r=e.contents[this.table.columns.indexOf(this)];t=this.createAggrValueCell(r)}return this.buildCell(t,{})}},{key:"buildCell",value:function(e,t){O.assertParameter("cell",e,Af);var n=this.table.isTableNodeColumn(this),r=0;n&&(r=this.table._calcRowLevelPadding(t));var o,i=this._text(e),s=e.iconId,a=this._icon(s,!!i)||"",l=this._cellCssClass(e,n),u=this._cellStyle(e,n,r);return e.errorStatus&&(t.hasError=!0),i||a?o=a+i:(o="&nbsp;",l=Wn.join(" ",l,"empty")),n&&t._expandable&&(this.tableNodeColumn=!0,o=this._expandIcon(t.expanded,r)+o,t.expanded&&(l+=" expanded")),this._buildCell(o,u,l)}},{key:"_buildCell",value:function(e,t,n){return'<div class="'+n+'" style="'+t+'">'+e+"</div>"}},{key:"_expandIcon",value:function(e,t){var n="table-row-control";return e&&(n+=" expanded"),'<div class="'+n+'" style="padding-left: '+(t+this.expandableIconLevel0CellPadding)+'px"></div>'}},{key:"_icon",value:function(e,t){var n,r;if(e)return n="table-cell-icon",t&&(n+=" with-text"),(r=gn.parseIconId(e)).isFontIcon()?(n+=" font-icon",'<span class="'+r.appendCssClass(n)+'">'+r.iconCharacter+"</span>"):'<img class="'+(n+=" image-icon")+'" src="'+r.iconUrl+'">'}},{key:"_text",value:function(e){var t=e.text||"";return e.htmlEnabled||(t=e.encodedText()||"",this.table.multilineText&&(t=Wn.nl2br(t,!1))),t}},{key:"_cellCssClass",value:function(e,t){var n="table-cell";e.mandatory&&(n+=" mandatory"),this.table.multilineText&&this.textWrap||(n+=" white-space-nowrap"),e.editable&&(n+=" editable"),e.errorStatus&&(n+=" has-error"),n+=" halign-"+Cx.parseHorizontalAlignment(e.horizontalAlignment);var r=this.table.visibleColumns(),o=r.indexOf(this);return 0===o&&(n+=" first"),o===r.length-1&&(n+=" last"),t&&(n+=" table-node"),e.cssClass&&(n+=" "+e.cssClass),n}},{key:"_cellStyle",value:function(e,t,n){var r,o=this.width;return 0===o?"display: none;":(r="min-width: "+o+"px; max-width: "+o+"px; ",t&&(r+=" padding-left: "+(this.tableNodeLevel0CellPadding+n)+"px; "),r+=To.legacyStyle(e))}},{key:"onMouseUp",value:function(e,t){var n=t.data("row"),r=this.cell(n);this.isCellEditable(n,r,e)&&this.table.prepareCellEdit(this,n,!0)}},{key:"isCellEditable",value:function(e,t,n){return this.table.enabledComputed&&e.enabled&&t.editable&&!n.ctrlKey&&!n.shiftKey}},{key:"startCellEdit",value:function(e,t){var n,r=e.$row,o=this.cell(e),i=this.table.$cell(this,r);return o.field=t,o.field.gridData.horizontalAlignment=o.horizontalAlignment,(n=O.create("CellEditorPopup",{parent:this.table,column:this,row:e,cell:o})).$anchor=i,n.open(this.table.$data),n}},{key:"cell",value:function(e){return this.table.cell(this,e)}},{key:"headerCell",value:function(){return O.create("Cell",{value:this.text,text:this.text,iconId:this.headerIconId,cssClass:this.headerCssClass,tooltipText:this.headerTooltipText,htmlEnabled:this.headerHtmlEnabled})}},{key:"selectedCell",value:function(){var e=this.table.selectedRow();return this.table.cell(this,e)}},{key:"cellValueOrText",value:function(e){return this.textBased?this.table.cellText(this,e):this.table.cellValue(this,e)}},{key:"cellText",value:function(e){return this.table.cellText(this,e)}},{key:"cellValueOrTextForCalculation",value:function(e){var t=this.cell(e),n=this.cellValueOrText(e);return Pr.isNullOrUndefined(n)?null:this._preprocessValueOrTextForCalculation(n,t)}},{key:"_preprocessValueOrTextForCalculation",value:function(e,t){return"string"==typeof e?this._preprocessTextForCalculation(e,t.htmlEnabled):e}},{key:"_preprocessTextForCalculation",value:function(e,t){return this._preprocessText(e,{removeHtmlTags:t,removeNewlines:!0,trim:!0})}},{key:"cellTextForGrouping",value:function(e){var t=this.cell(e);return this._preprocessTextForGrouping(t.text,t.htmlEnabled)}},{key:"_preprocessTextForGrouping",value:function(e,t){return this._preprocessText(e,{removeHtmlTags:t,trim:!0})}},{key:"cellTextForTextFilter",value:function(e){var t=this.cell(e);return this._preprocessTextForTextFilter(t.text,t.htmlEnabled)}},{key:"_preprocessTextForTextFilter",value:function(e,t){return this._preprocessText(e,{removeHtmlTags:t})}},{key:"cellTextForRowDetail",value:function(e){var t=this.cell(e);return this._preprocessText(this._text(t),{removeHtmlTags:t.htmlEnabled})}},{key:"_preprocessText",value:function(e,t){return null==e||((t=t||{}).removeHtmlTags&&(e=Wn.plainText(e)),t.removeNewlines&&(e=e.replace("\n"," ")),t.trim&&(e=e.trim())),e}},{key:"setCellValue",value:function(e,t){var n=this.cell(e);this._setCellValue(e,t,n),this._updateCellText(e,n)}},{key:"_setCellValue",value:function(e,t,n){t=this._parseValue(t),n.value!==t&&e.status===Ix.Status.NON_CHANGED&&(e.status=Ix.Status.UPDATED),n.setValue(t)}},{key:"setCellTextDeferred",value:function(e,t,n){var r=this;e.done((function(e){r.setCellText(t,e,n)})).fail((function(e){r.setCellText(t,"",n),s.a.log.error("Could not resolve cell text for value "+n.value,e)})),this.table.updateBuffer.pushPromise(e)}},{key:"setCellText",value:function(e,t,n){n||(n=this.cell(e)),n.text!==t&&(n.setText(t),e.initialized&&this.table&&this.table.updateRow(e))}},{key:"setCellErrorStatus",value:function(e,t,n){n||(n=this.cell(e)),n.setErrorStatus(t)}},{key:"setCellIconId",value:function(e,t){var n=this.cell(e);n.iconId!==t&&(n.setIconId(t),e.initialized&&this.table.updateRow(e))}},{key:"setHorizontalAlignment",value:function(e){var t=this;this.horizontalAlignment!==e&&(this.horizontalAlignment=e,this.table.rows.forEach((function(n){t.cell(n).setHorizontalAlignment(e)})),this.table.updateRows(this.table.rows),this.table.header&&this.table.header.updateHeader(this))}},{key:"setEditable",value:function(e){var t=this;this.editable!==e&&(this.editable=e,this.table.rows.forEach((function(n){t.cell(n).setEditable(e)})),this.table.updateRows(this.table.rows))}},{key:"setMandatory",value:function(e){var t=this;this.mandatory!==e&&(this.mandatory=e,this.table.rows.forEach((function(n){t.cell(n).setMandatory(e)})),this.table.updateRows(this.table.rows))}},{key:"setCssClass",value:function(e){this.cssClass!==e&&(this.cssClass=e,this.table.rows.forEach((function(t){this.cell(t).setCssClass(e)}),this),this.table.updateRows(this.table.rows))}},{key:"setWidth",value:function(e){this.width!==e&&this.table.resizeColumn(this,e)}},{key:"createAggrGroupCell",value:function(e){var t=this.cell(e);return this.initCell(O.create("Cell",{value:t.value,text:this.cellTextForGrouping(e),iconId:t.iconId,horizontalAlignment:this.horizontalAlignment,cssClass:"table-aggregate-cell"}))}},{key:"createAggrValueCell",value:function(e){return this.createAggrEmptyCell()}},{key:"createAggrEmptyCell",value:function(){return this.initCell(O.create("Cell",{empty:!0,cssClass:"table-aggregate-cell"}))}},{key:"calculateOptimalWidth",value:function(){return this.optimalWidthMeasurer.measure()}},{key:"createFilter",value:function(e){return O.create(this.filterType,{session:this.session,table:this.table,column:this})}},{key:"createTableHeaderMenu",value:function(e){var t=this.$header;return O.create("TableHeaderMenu",{parent:e,column:t.data("column"),tableHeader:e,$anchor:t,focusableContainer:!0})}},{key:"createEditor",value:function(e){var t=this._createEditor(e),n=this.cell(e);this._initEditorField(t,n),t.setLabelVisible(!1),t.setFieldStyle(ZW.FieldStyle.CLASSIC);var r=new Ez(t.gridDataHints);return r.horizontalAlignment=n.horizontalAlignment,t.setGridDataHints(r),t}},{key:"_initEditorField",value:function(e,t){t.errorStatus?this._updateEditorFromInvalidCell(e,t):this._updateEditorFromValidCell(e,t)}},{key:"_updateEditorFromValidCell",value:function(e,t){e.setValue(t.value)}},{key:"_updateEditorFromInvalidCell",value:function(e,t){e.setErrorStatus(t.errorStatus),e.setDisplayText(t.text)}},{key:"_createEditor",value:function(){return O.create("StringField",{parent:this.table,maxLength:this.maxLength,multilineText:this.table.multilineText,wrapText:this.textWrap})}},{key:"updateCellFromEditor",value:function(e,t){t.errorStatus?this._updateCellFromInvalidEditor(e,t):this._updateCellFromValidEditor(e,t)}},{key:"_updateCellFromInvalidEditor",value:function(e,t){this.setCellErrorStatus(e,t.errorStatus),this.setCellText(e,t.displayText)}},{key:"_updateCellFromValidEditor",value:function(e,t){this.setCellErrorStatus(e,null),this.setCellValue(e,t.value)}},{key:"installComparator",value:function(){return this.comparator.install(this.session)}},{key:"isSortingPossible",value:function(){return this.installComparator(),!0}},{key:"compare",value:function(e,t){var n=this.table.cell(this,e),r=this.table.cell(this,t);if(null!==n.sortCode||null!==r.sortCode)return GA.NUMERIC.compare(n.sortCode,r.sortCode);var o=this.cellValueOrText(e),i=this.cellValueOrText(t);return this.comparator.compare(o,i)}},{key:"isVisible",value:function(){return this.displayable&&this.visible&&!this.compacted}},{key:"setVisible",value:function(e,t){this.visible!==e&&this._setVisible(e,t)}},{key:"_setVisible",value:function(e,t){this.visible=e,O.nvl(t,this.initialized)&&this.table.onColumnVisibilityChanged()}},{key:"setDisplayable",value:function(e,t){this.displayable!==e&&this._setDisplayable(e,t)}},{key:"_setDisplayable",value:function(e,t){this.displayable=e,O.nvl(t,this.initialized)&&this.table.onColumnVisibilityChanged()}},{key:"setCompacted",value:function(e,t){this.compacted!==e&&this._setCompacted(e,t)}},{key:"_setCompacted",value:function(e,t){this.compacted=e,O.nvl(t,this.initialized)&&this.table.onColumnVisibilityChanged()}},{key:"setAutoOptimizeWidth",value:function(e){this.autoOptimizeWidth!==e&&this._setAutoOptimizeWidth(e)}},{key:"_setAutoOptimizeWidth",value:function(e){this.autoOptimizeWidth=e,this.autoOptimizeWidthRequired=e,this.initialized&&(this.table.columnLayoutDirty=!0,this.table.invalidateLayoutTree())}},{key:"setMaxLength",value:function(e){this.maxLength=e}},{key:"setText",value:function(e){this.text!==e&&(this.text=e,this.table.header&&this.table.header.updateHeader(this))}},{key:"setHeaderIconId",value:function(e){this.headerIconId!==e&&(this.headerIconId=e,this.table.header&&this.table.header.updateHeader(this))}},{key:"setHeaderCssClass",value:function(e){if(this.headerCssClass!==e){var t=s.a.extend({},this);this.headerCssClass=e,this.table.header&&this.table.header.updateHeader(this,t)}}},{key:"setHeaderHtmlEnabled",value:function(e){this.headerHtmlEnabled!==e&&(this.headerHtmlEnabled=e,this.table.header&&this.table.header.updateHeader(this))}},{key:"setHeaderTooltipText",value:function(e){this.headerTooltipText=e}},{key:"setHeaderTooltipHtmlEnabled",value:function(e){this.headerTooltipHtmlEnabled=e}},{key:"setTextWrap",value:function(e){this.textWrap!==e&&(this.textWrap=e,this.table.rendered&&this.table.multilineText&&(this.autoOptimizeWidthRequired=!0,this.table._redraw(),this.table.invalidateLayoutTree()))}},{key:"isContentValid",value:function(e){var t=this.cell(e),n=!t.errorStatus||t.errorStatus.severity!==Br.Severity.ERROR,r=!t.mandatory||this._hasCellValue(t);return{valid:n&&r,validByErrorStatus:n,validByMandatory:r}}},{key:"_hasCellValue",value:function(e){return!!e.value}},{key:"_onTableColumnsChanged",value:function(e){0===this.table.visibleColumns().indexOf(this)?(this.tableNodeLevel0CellPadding=28,this.expandableIconLevel0CellPadding=13):(this.tableNodeLevel0CellPadding=23,this.expandableIconLevel0CellPadding=8)}},{key:"_realWidthIfAvailable",value:function(){return this._realWidth||this.width}},{key:"_createEventSupport",value:function(){return new ln}},{key:"trigger",value:function(e,t){(t=t||{}).source=this,this.events.trigger(e,t)}},{key:"one",value:function(e,t){this.events.one(e,t)}},{key:"on",value:function(e,t){return this.events.on(e,t)}},{key:"off",value:function(e,t){this.events.off(e,t)}},{key:"addListener",value:function(e){this.events.addListener(e)}},{key:"removeListener",value:function(e){this.events.removeListener(e)}},{key:"when",value:function(e){return this.events.when(e)}}])&&UA(t.prototype,n),r&&UA(t,r),e}();function YA(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}KA(qA,"DEFAULT_MIN_WIDTH",60),KA(qA,"NARROW_MIN_WIDTH",32);var XA=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.column=t,this.table=null,this.$measurement=null,this.deferred=null,this.imageCount=0,this.completeImageCount=0,this._imageLoadOrErrorHandler=this._onImageLoadOrError.bind(this),this._columnCellContents={}}var t,n,r;return t=e,(n=[{key:"measure",value:function(e){if(s.a.log.isDebugEnabled()&&s.a.log.debug("Optimal width measuring started for column "+this.column.id),this.table=this.column.table,this.$measurement&&(s.a.log.isDebugEnabled()&&s.a.log.debug("Optimal width measuring aborted for column "+this.column.id),this._resolve(-1)),this.$measurement=this.table.$data.makeDiv("hidden"),this.imageCount=0,this.completeImageCount=0,this._appendElements(),this.table.$data.append(this.$measurement),this.completeImageCount>=this.imageCount){var t=this._measure();return s.a.log.isDebugEnabled()&&s.a.log.debug("Optimal width measuring done (sync) for column "+this.column.id+": "+t),this.remove(),t}return s.a.log.isDebugEnabled()&&s.a.log.debug("Not all images loaded, deferring measurement for column "+this.column.id+". Images complete: "+this.completeImageCount+"/"+this.imageCount),this.$measurement[0].addEventListener("load",this._imageLoadOrErrorHandler,!0),this.$measurement[0].addEventListener("error",this._imageLoadOrErrorHandler,!0),this.deferred=s.a.Deferred(),this.deferred.promise()}},{key:"remove",value:function(){this.$measurement&&(this.$measurement[0].removeEventListener("load",this._imageLoadOrErrorHandler,!0),this.$measurement[0].removeEventListener("error",this._imageLoadOrErrorHandler,!0),this.$measurement.remove(),this.$measurement=null)}},{key:"_measure",value:function(){var e=this.column.minWidth;return this.$measurement.addClass("invisible").removeClass("hidden").children().each((function(){e=Math.max(e,qs.size(s()(this)).width)})),e}},{key:"_resolve",value:function(e){this.remove(),this.deferred&&(this.deferred.resolve(e),this.deferred=null)}},{key:"_appendElements",value:function(){this._appendHeader(),this._appendRows(),this._appendAggregateRows()}},{key:"_appendHeader",value:function(){this.column.$header&&this._appendToMeasurement(this.column.$header.clone())}},{key:"_appendRows",value:function(){this.table.rows.forEach(this._appendRow.bind(this)),this._columnCellContents={}}},{key:"_appendRow",value:function(e){var t=this.column.buildCellForRow(e);this._columnCellContents[t]||(this._columnCellContents[t]=!0,this._appendToMeasurement(s()(t)))}},{key:"_appendAggregateRows",value:function(){this.table._aggregateRows.forEach(this._appendAggregateRow.bind(this))}},{key:"_appendAggregateRow",value:function(e){this._appendToMeasurement(s()(this.column.buildCellForAggregateRow(e)))}},{key:"_appendToMeasurement",value:function(e){var t=this;e.find("img").each((function(e,n){var r=s()(n);r.data("measure","in-progress"),n.complete&&(r.data("complete",n.complete),t.completeImageCount++),t.imageCount++})),e.css({minWidth:"",maxWidth:""}).appendTo(this.$measurement)}},{key:"_onImageLoadOrError",value:function(e){if(!s()(e.target).data("complete")&&(this.completeImageCount++,s.a.log.isTraceEnabled()&&s.a.log.trace("Images complete (async) "+this.completeImageCount+"/"+this.imageCount,e.target.src),this.completeImageCount>=this.imageCount)){var t=this._measure();s.a.log.isDebugEnabled()&&s.a.log.debug("Optimal width measuring done (async) for column "+this.column.id+": "+t),this._resolve(t)}}}])&&YA(t.prototype,n),r&&YA(t,r),e}();function JA(e){return(JA="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ZA(e,t){return(ZA=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function QA(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=tF(e);if(t){var o=tF(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return eF(this,n)}}function eF(e,t){return!t||"object"!==JA(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function tF(e){return(tF=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var nF=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ZA(e,t)}(n,e);var t=QA(n);function n(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),(e=t.call(this)).comparator=GA.ALPHANUMERIC,e}return n}(qA);function rF(e){return(rF="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function oF(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function iF(e,t,n){return(iF="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=uF(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function sF(e,t){return(sF=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function aF(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=uF(e);if(t){var o=uF(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return lF(this,n)}}function lF(e,t){return!t||"object"!==rF(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function uF(e){return(uF=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var cF=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&sF(e,t)}(i,e);var t,n,r,o=aF(i);function i(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),o.call(this)}return t=i,(n=[{key:"buildCellForRow",value:function(e){var t=this.cell(e),n=this._cellCssClass(t),r=this._cellStyle(t),o=s()(iF(uF(i.prototype),"_buildCell",this).call(this,"",r,n)),a=this.table.cellValue(this,e);return t.errorStatus&&(e.hasError=!0),this._renderValue(o,a),o[0].outerHTML}},{key:"_renderValue",value:function(e,t){}},{key:"_plainTextForRow",value:function(e){var t=this.table.cell(this,e);if(!t.plainText){var n=this.buildCellForRow(e);t.plainText=Wn.plainText(n)}return t.plainText}},{key:"cellValueOrTextForCalculation",value:function(e){var t=this._plainTextForRow(e);return this._preprocessTextForCalculation(t)}},{key:"cellTextForGrouping",value:function(e){var t=this._plainTextForRow(e);return this._preprocessTextForGrouping(t)}},{key:"cellTextForTextFilter",value:function(e){var t=this._plainTextForRow(e);return this._preprocessTextForTextFilter(t)}},{key:"compare",value:function(e,t){var n=this._plainTextForRow(e),r=this._plainTextForRow(t);return this.comparator.compareIgnoreCase(n,r)}}])&&oF(t.prototype,n),r&&oF(t,r),i}(qA);function fF(e){return(fF="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function hF(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function pF(e,t,n){return(pF="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=bF(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function dF(e,t){return(dF=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function yF(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=bF(e);if(t){var o=bF(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return vF(this,n)}}function vF(e,t){return!t||"object"!==fF(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function bF(e){return(bF=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var mF=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&dF(e,t)}(i,e);var t,n,r,o=yF(i);function i(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(e=o.call(this)).comparator=GA.NUMERIC,e.filterType="ColumnUserFilter",e.horizontalAlignment=0,e.minWidth=qA.NARROW_MIN_WIDTH,e.triStateEnabled=!1,e.textBased=!1,e}return t=i,(n=[{key:"_formatValue",value:function(e,t){return this.triStateEnabled&&null===e?"?":e?"X":""}},{key:"buildCell",value:function(e,t){var n,r,o,s="",a=t.enabled,l=this.table.isTableNodeColumn(this),u=0;return l&&(u=this.table._calcRowLevelPadding(t)),e.empty?pF(bF(i.prototype),"buildCell",this).call(this,e,t):(a=a&&e.editable,r=this._cellCssClass(e,l),n=this._cellStyle(e,l,u),a||(r+=" disabled"),o="check-box",!0===e.value&&(o+=" checked"),this.triStateEnabled&&!0!==e.value&&!1!==e.value&&(o+=" undefined"),a||(o+=" disabled"),l&&t._expandable&&(this.tableNodeColumn=!0,s=this._expandIcon(t.expanded,u)+s,t.expanded&&(r+=" expanded")),'<div class="'+r+'" style="'+n+'">'+(s=s+'<div class="'+o+'"></div>')+"</div>")}},{key:"$checkBox",value:function(e){return this.table.$cell(this,e).children(".check-box")}},{key:"_cellCssClass",value:function(e,t){var n=pF(bF(i.prototype),"_cellCssClass",this).call(this,e);return n=n.replace(" editable",""),n+=" checkable",t&&(n+=" table-node"),n}},{key:"onMouseUp",value:function(e,t){var n=t.data("row"),r=this.cell(n);this.table.checkableColumn===this?this.table.checkRow(n,!n.checked):this.isCellEditable(n,r,e)&&this._toggleCellValue(n,r)}},{key:"_toggleCellValue",value:function(e,t){this.triStateEnabled?!1===t.value?this.setCellValue(e,!0):!0===t.value?this.setCellValue(e,null):null===t.value&&this.setCellValue(e,!1):this.setCellValue(e,!t.value)}},{key:"_createEditor",value:function(e){return O.create("CheckBoxField",{parent:this.table,triStateEnabled:this.triStateEnabled})}},{key:"cellTextForGrouping",value:function(e){var t=this.cell(e);return this.triStateEnabled&&null===t.value?this.session.text("ui.BooleanColumnGroupingMixed"):!0===t.value?this.session.text("ui.BooleanColumnGroupingTrue"):this.session.text("ui.BooleanColumnGroupingFalse")}},{key:"setTriStateEnabled",value:function(e){var t=this;this.triStateEnabled!==e&&(this.triStateEnabled=e,this.table.rows.forEach((function(e){return t._updateCellText(e,t.cell(e))})))}}])&&hF(t.prototype,n),r&&hF(t,r),i}(qA);function gF(e){return(gF="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _F(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function wF(e,t){return(wF=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function kF(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=OF(e);if(t){var o=OF(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return SF(this,n)}}function SF(e,t){return!t||"object"!==gF(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function OF(e){return(OF=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var TF=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&wF(e,t)}(i,e);var t,n,r,o=kF(i);function i(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(e=o.call(this)).cssClass="compact-cell",e.htmlEnabled=!0,e.width=120,e.textWrap=!0,e}return t=i,(n=[{key:"_onMoreLinkAction",value:function(e,t){var n=this.table.$cell(this,e).find(".compact-cell-more-content"),r=!n.isVisible();n.setVisible(r),t.setVisible(!r),this.table.invalidateLayoutTree()}},{key:"onMouseUp",value:function(e,t){var n=$(e.target),r=$(e.delegateTarget),o=n.findUp((function(e){return e.hasClass("more-link")}),r);o.length>0&&this._onMoreLinkAction(t,o)}}])&&_F(t.prototype,n),r&&_F(t,r),i}(qA);function CF(e){return function(e){if(Array.isArray(e))return PF(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return PF(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return PF(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function PF(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function RF(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var xF=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.title="",this.titleSuffix="",this.subtitle="",this.content="",this.moreContent="",this.contentLines=[]}var t,n,r;return t=e,(n=[{key:"setTitle",value:function(e){this.title=scout.nvl(e,"")}},{key:"setTitleLine",value:function(e){this.titleLine=e}},{key:"setTitleSuffix",value:function(e){this.titleSuffix=scout.nvl(e,"")}},{key:"setTitleSuffixLine",value:function(e){this.titleSuffixLine=e}},{key:"setSubtitle",value:function(e){this.subtitle=scout.nvl(e,"")}},{key:"setSubtitleLine",value:function(e){this.subtitleLine=e}},{key:"addContentLine",value:function(e){this.contentLines.push(e)}},{key:"setContent",value:function(e){this.content=scout.nvl(e,"")}},{key:"setMoreContent",value:function(e){this.moreContent=scout.nvl(e,"")}},{key:"transform",value:function(e){var t=scout.nvl(e.removeEmptyContentLines,!0),n=scout.nvl(e.maxContentLines,1e3);this.titleLine&&this.setTitle(this.titleLine.build()),this.titleSuffixLine&&this.setTitleSuffix(this.titleSuffixLine.build()),this.subtitleLine&&this.setSubtitle(this.subtitleLine.build());var r=[];t&&(r=this.contentLines.filter((function(e){return!!e.build()}))),n+1===r.length&&n++;var o=Math.min(r.length,n),i=Wn.join.apply(Wn,["\n"].concat(CF(r.slice(0,o).map((function(e){return e.build()})))));if(i&&this.setContent(i),o<r.length){var s=Wn.join.apply(Wn,["\n"].concat(CF(r.slice(o,r.length).map((function(e){return e.build()})))));this.setMoreContent(s)}}}])&&RF(t.prototype,n),r&&RF(t,r),e}();function EF(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var DF=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.labelBlock=null,this.textBlock=null,t instanceof Af?this.setLabelBlock(this.convertHeaderCellToBlock(t)):this.setLabelBlock(new FF(t)),n instanceof Af?this.setTextBlock(this.convertCellToBlock(n)):this.setTextBlock(new FF(n))}var t,n,r;return t=e,(n=[{key:"convertHeaderCellToBlock",value:function(e){return this.convertCellToBlock(e)}},{key:"convertCellToBlock",value:function(e){var t=new FF;return null!=e&&(t.setText(e.text),t.setIcon(e.iconId),t.setEncodeHtmlEnabled(!e.htmlEnabled)),t}},{key:"setLabelBlock",value:function(e){scout.assertParameter("block",e),this.labelBlock=e}},{key:"setTextBlock",value:function(e){scout.assertParameter("block",e),this.textBlock=e}},{key:"build",value:function(){var e=this.labelBlock.build();e&&(e+=": ");var t=this.textBlock.build();return t?'\n<div class="compact-cell-line">\n  <span class="compact-cell-line-label">'.concat(e,'</span>\n  <span class="compact-cell-line-value">').concat(t,"</span>\n</div>"):""}}])&&EF(t.prototype,n),r&&EF(t,r),e}();function AF(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var FF=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.text="",this.icon="",this._processedText=null,this.encodeHtmlEnabled=!0,this.nlToBrEnabled=!1,this.htmlToPlainTextEnabled=!1,this.setText(t),this.setIcon(n)}var t,n,r;return t=e,(n=[{key:"setText",value:function(e){this.text=O.nvl(e,"")}},{key:"processedText",value:function(){return null==this._processedText&&(this._processedText=this.processText()),this._processedText}},{key:"setIcon",value:function(e){this.icon=O.nvl(e,"")}},{key:"setEncodeHtmlEnabled",value:function(e){this.encodeHtmlEnabled!==e&&(this._processedText=null),this.encodeHtmlEnabled=e}},{key:"setNlToBrEnabled",value:function(e){this.nlToBrEnabled!==e&&(this._processedText=null),this.nlToBrEnabled=e}},{key:"setHtmlToPlainTextEnabled",value:function(e){this.htmlToPlainTextEnabled!==e&&(this._processedText=null),this.htmlToPlainTextEnabled=e}},{key:"processText",value:function(){var e=this.text;return this.htmlToPlainTextEnabled?(this.nlToBrEnabled&&(e=Wn.nl2br(e,!1)),e=Wn.plainText(e)):this.encodeHtmlEnabled&&(e=Wn.encode(e)),this.nlToBrEnabled&&(e=Wn.nl2br(e,!1)),e}},{key:"build",value:function(){return this.icon?$("<div>").appendIcon(this.icon).addClass(this.processedText()?" with-text":"").parent()[0].innerHTML+this.processedText():this.processedText()}}])&&AF(t.prototype,n),r&&AF(t,r),e}();function $F(e){return($F="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function jF(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function BF(e,t,n){return(BF="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=HF(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function MF(e,t){return(MF=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function IF(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=HF(e);if(t){var o=HF(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return LF(this,n)}}function LF(e,t){return!t||"object"!==$F(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function HF(e){return(HF=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var NF=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&MF(e,t)}(i,e);var t,n,r,o=IF(i);function i(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(e=o.call(this)).format,e.groupFormat="yyyy",e.hasDate=!0,e.hasTime=!1,e.filterType="DateColumnUserFilter",e.comparator=GA.NUMERIC,e.textBased=!1,e}return t=i,(n=[{key:"_init",value:function(e){BF(HF(i.prototype),"_init",this).call(this,e),this._setFormat(this.format),this._setGroupFormat(this.groupFormat)}},{key:"setFormat",value:function(e){var t=this;this.format!==e&&(this._setFormat(e),this.initialized&&this.table.rows.forEach((function(e){t._updateCellText(e,t.cell(e))})))}},{key:"_setFormat",value:function(e){e||(e=this._getDefaultFormat(this.session.locale)),e=tp.ensure(this.session.locale,e),this.format=e}},{key:"setGroupFormat",value:function(e){var t=this;this.groupFormat!==e&&(this._setGroupFormat(e),this.initialized&&this.table.rows.forEach((function(e){t._updateCellText(e,t.cell(e))})))}},{key:"_setGroupFormat",value:function(e){e||(e=this._getDefaultFormat(this.session.locale)),e=tp.ensure(this.session.locale,e),this.groupFormat=e}},{key:"_formatValue",value:function(e,t){return this.format.format(e)}},{key:"_parseValue",value:function(e){return Et.ensure(e)}},{key:"_getDefaultFormat",value:function(e){return this.hasDate&&this.hasTime?e.dateFormatPatternDefault+" "+e.timeFormatPatternDefault:this.hasDate?e.dateFormatPatternDefault:e.timeFormatPatternDefault}},{key:"cellTextForGrouping",value:function(e){var t=this.table.cellValue(this,e);return this.groupFormat.format(t)}},{key:"_createEditor",value:function(){return O.create("DateField",{parent:this.table,hasDate:this.hasDate,hasTime:this.hasTime})}}])&&jF(t.prototype,n),r&&jF(t,r),i}(qA);function VF(e){return(VF="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function WF(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function zF(e,t,n){return(zF="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=qF(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function GF(e,t){return(GF=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function UF(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=qF(e);if(t){var o=qF(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return KF(this,n)}}function KF(e,t){return!t||"object"!==VF(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function qF(e){return(qF=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var YF=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&GF(e,t)}(i,e);var t,n,r,o=UF(i);function i(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(e=o.call(this)).minWidth=qA.NARROW_MIN_WIDTH,e.filterType="ColumnUserFilter",e.textBased=!1,e}return t=i,(n=[{key:"_initCell",value:function(e){return zF(qF(i.prototype),"_initCell",this).call(this,e),e.text=null,e.iconId=e.value||e.iconId,e}},{key:"_formatValue",value:function(e,t){return null}},{key:"_cellCssClass",value:function(e,t){var n=zF(qF(i.prototype),"_cellCssClass",this).call(this,e,t);return n+=" table-icon-cell"}},{key:"setCellValue",value:function(e,t){zF(qF(i.prototype),"setCellValue",this).call(this,e,t),this.setCellIconId(e,this.cell(e).value)}},{key:"cellTextForGrouping",value:function(e){return this.table.cell(this,e).value}},{key:"createAggrGroupCell",value:function(e){var t=zF(qF(i.prototype),"createAggrGroupCell",this).call(this,e);return t.text=null,t}}])&&WF(t.prototype,n),r&&WF(t,r),i}(qA);function XF(e){return(XF="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function JF(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ZF(e,t,n){return(ZF="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=n$(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function QF(e,t){return(QF=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function e$(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=n$(e);if(t){var o=n$(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return t$(this,n)}}function t$(e,t){return!t||"object"!==XF(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function n$(e){return(n$=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var r$=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&QF(e,t)}(i,e);var t,n,r,o=e$(i);function i(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(e=o.call(this)).aggregationFunction="sum",e.backgroundEffect=null,e.decimalFormat=null,e.minValue=null,e.maxValue=null,e.calcMinValue=null,e.calcMaxValue=null,e.horizontalAlignment=1,e.filterType="NumberColumnUserFilter",e.comparator=GA.NUMERIC,e.textBased=!1,e.allowedAggregationFunctions=["sum","avg","min","max","none"],e}return t=i,(n=[{key:"_init",value:function(e){ZF(n$(i.prototype),"_init",this).call(this,e),this._setDecimalFormat(this.decimalFormat),this.setAggregationFunction(this.aggregationFunction)}},{key:"setDecimalFormat",value:function(e){var t=this;this.decimalFormat!==e&&(this._setDecimalFormat(e),this.initialized&&this.table.rows.forEach((function(e){t._updateCellText(e,t.cell(e))})))}},{key:"_setDecimalFormat",value:function(e){e||(e=this._getDefaultFormat(this.session.locale)),this.decimalFormat=rp.ensure(this.session.locale,e)}},{key:"_getDefaultFormat",value:function(e){return e.decimalFormatPatternDefault}},{key:"_formatValue",value:function(e,t){return this.decimalFormat.format(e)}},{key:"_parseValue",value:function(e){return pr.ensure(e)}},{key:"setAggregationFunction",value:function(e){if(this.aggregationFunction=e,"sum"===e)this.aggrStart=jo.sumStart,this.aggrStep=jo.sumStep,this.aggrFinish=jo.sumFinish,this.aggrSymbol=jo.sumSymbol;else if("avg"===e)this.aggrStart=jo.avgStart,this.aggrStep=jo.avgStep,this.aggrFinish=jo.avgFinish,this.aggrSymbol=jo.avgSymbol;else if("min"===e)this.aggrStart=jo.minStart,this.aggrStep=jo.minStep,this.aggrFinish=jo.minFinish,this.aggrSymbol=jo.minSymbol;else if("max"===e)this.aggrStart=jo.maxStart,this.aggrStep=jo.maxStep,this.aggrFinish=jo.maxFinish,this.aggrSymbol=jo.maxSymbol;else if("none"===e){var t=function(){};this.aggrStart=t,this.aggrStep=t,this.aggrFinish=t,this.aggrSymbol=void 0}}},{key:"createAggrValueCell",value:function(e){var t=this._formatValue(e);return O.create("Cell",{text:t,iconId:t?this.aggrSymbol:null,horizontalAlignment:this.horizontalAlignment,cssClass:"table-aggregate-cell"})}},{key:"_cellStyle",value:function(e,t,n){var r=ZF(n$(i.prototype),"_cellStyle",this).call(this,e,t,n);if(!this.backgroundEffect||void 0===e.value||Wn.contains(e.cssClass,"table-aggregate-cell"))return r;this.backgroundEffectFunc||(this.backgroundEffectFunc=this._resolveBackgroundEffectFunc());var o=this.backgroundEffectFunc(this._preprocessValueOrTextForCalculation(e.value));return o.backgroundColor&&(r+="background-color: "+o.backgroundColor+";"),o.backgroundImage&&(r+="background-image: "+o.backgroundImage+";"),r}},{key:"_preprocessValueOrTextForCalculation",value:function(e){return this.decimalFormat.round(e)}},{key:"setBackgroundEffect",value:function(e){this.backgroundEffect!==e&&(this.backgroundEffect=e,this.backgroundEffectFunc=this._resolveBackgroundEffectFunc(),this.table.trigger("columnBackgroundEffectChanged",{column:this}),!this.backgroundEffect||null!==this.calcMinValue&&null!==this.calcMaxValue||this.calculateMinMaxValues(),this.backgroundEffect||(this.calcMinValue=null,this.calcMaxValue=null),this.table.rendered&&this._renderBackgroundEffect())}},{key:"updateBackgroundEffect",value:function(){this.calculateMinMaxValues(),this.table.rendered&&this._renderBackgroundEffect()}},{key:"_resolveBackgroundEffectFunc",value:function(){var e=this.backgroundEffect;return"colorGradient1"===e?this._colorGradient1.bind(this):"colorGradient2"===e?this._colorGradient2.bind(this):"barChart"===e?this._barChart.bind(this):null!==e?(s.a.log.warn("Unsupported backgroundEffect: "+e),function(){return{}}):void 0}},{key:"_renderBackgroundEffect",value:function(){this.table.visibleRows.forEach((function(e){if(e.$row){var t=this.cell(e),n=this.table.$cell(this,e.$row);void 0!==t.value&&(n[0].style.cssText=this._cellStyle(t))}}),this)}},{key:"calculateMinMaxValues",value:function(){for(var e,t,n,r,o=this.table.rows,i=0;i<o.length;i++)e=o[i],((r=this.cellValueOrTextForCalculation(e))<t||void 0===t)&&(t=r),(r>n||void 0===n)&&(n=r);this.calcMinValue=O.nvl(t,null),this.calcMaxValue=O.nvl(n,null)}},{key:"_colorGradient1",value:function(e){var t=To.get("column-background-effect-gradient1-start","backgroundColor"),n=To.get("column-background-effect-gradient1-end","backgroundColor"),r=To.rgb(t.backgroundColor),o=To.rgb(n.backgroundColor);return this._colorGradient(e,r,o)}},{key:"_colorGradient2",value:function(e){var t=To.get("column-background-effect-gradient2-start","backgroundColor"),n=To.get("column-background-effect-gradient2-end","backgroundColor"),r=To.rgb(t.backgroundColor),o=To.rgb(n.backgroundColor);return this._colorGradient(e,r,o)}},{key:"_colorGradient",value:function(e,t,n){var r=(e-this.calcMinValue)/(this.calcMaxValue-this.calcMinValue);return{backgroundColor:"rgb("+Math.ceil(t.red-r*(t.red-n.red))+","+Math.ceil(t.green-r*(t.green-n.green))+", "+Math.ceil(t.blue-r*(t.blue-n.blue))+")"}}},{key:"_barChart",value:function(e){var t=Math.ceil((e-this.calcMinValue)/(this.calcMaxValue-this.calcMinValue)*100)+"",n=To.get("column-background-effect-bar-chart","backgroundColor").backgroundColor;return{backgroundImage:"linear-gradient(to left, "+n+" 0%, "+n+" "+t+"%, transparent "+t+"%, transparent 100% )"}}},{key:"_createEditor",value:function(){return O.create("NumberField",{parent:this.table,maxValue:this.maxValue,minValue:this.minValue,decimalFormat:this.decimalFormat})}},{key:"_hasCellValue",value:function(e){return!Pr.isNullOrUndefined(e.value)}}])&&JF(t.prototype,n),r&&JF(t,r),i}(qA);function o$(e){return(o$="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i$(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function s$(e,t,n){return(s$="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=c$(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function a$(e,t){return(a$=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function l$(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=c$(e);if(t){var o=c$(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return u$(this,n)}}function u$(e,t){return!t||"object"!==o$(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function c$(e){return(c$=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var f$=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&a$(e,t)}(i,e);var t,n,r,o=l$(i);function i(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(e=o.call(this)).codeType=null,e.lookupCall=null,e.browseHierarchy=!1,e.browseMaxRowCount=e3.DEFAULT_BROWSE_MAX_COUNT,e.browseAutoExpandAll=!0,e.browseLoadIncremental=!1,e.activeFilterEnabled=!1,e._lookupCallBatchContext=null,e}return t=i,(n=[{key:"_init",value:function(e){s$(c$(i.prototype),"_init",this).call(this,e),this._setLookupCall(this.lookupCall),this._setCodeType(this.codeType)}},{key:"_initCell",value:function(e){return s$(c$(i.prototype),"_initCell",this).call(this,e),e.sortCode=this._calculateCellSortCode(e),e}},{key:"_calculateCellSortCode",value:function(e){if(!this.codeType)return null;var t=Qi.get(this.codeType,e.value);return t?t.sortCode:null}},{key:"_updateAllCellSortCodes",value:function(){var e=this;this.table.rows.map((function(t){return e.cell(t)})).forEach((function(t){return t.setSortCode(e._calculateCellSortCode(t))}))}},{key:"setLookupCall",value:function(e){this.lookupCall!==e&&(this._setLookupCall(e),this._updateAllCellSortCodes())}},{key:"_setLookupCall",value:function(e){this.lookupCall=ri.ensure(e,this.session)}},{key:"setCodeType",value:function(e){this.codeType!==e&&(this._setCodeType(e),this._updateAllCellSortCodes())}},{key:"_setCodeType",value:function(e){this.codeType=e,e&&(this.lookupCall=O.create("CodeLookupCall",{session:this.session,codeType:e}))}},{key:"setBrowseHierarchy",value:function(e){this.browseHierarchy=e}},{key:"setBrowseMaxRowCount",value:function(e){this.browseMaxRowCount=e}},{key:"setBrowseAutoExpandAll",value:function(e){this.browseAutoExpandAll=e}},{key:"setBrowseLoadIncremental",value:function(e){this.browseLoadIncremental=e}},{key:"setActiveFilterEnabled",value:function(e){this.activeFilterEnabled=e}},{key:"_formatValue",value:function(e,t){if(!this.lookupCall)return Wn.nvl(e)+"";if(this.lookupCall.batch)return this._batchFormatValue(e);var n=this.lookupCall.clone();return this.trigger("prepareLookupCall",{lookupCall:n,row:t}),n.textByKey(e)}},{key:"_batchFormatValue",value:function(e){var t=this;if(Pr.isNullOrUndefined(e))return $.resolvedPromise("");var n=this._lookupCallBatchContext;if(!n){var r=$.Deferred();n={keySet:{},result:r.promise()},this._lookupCallBatchContext=n,setTimeout((function(){t._lookupCallBatchContext=null;var e=t.lookupCall.clone();t.trigger("prepareLookupCall",{lookupCall:e}),e.textsByKeys(Object.keys(n.keySet)).then((function(e){return r.resolve(e)})).catch((function(e){return r.reject(e)}))}))}return n.keySet[e]=!0,n.result.then((function(t){return t[e]||""}))}},{key:"_updateEditorFromValidCell",value:function(e,t){if(Pr.isNullOrUndefined(t.value))e.setValue(null);else{var n=new ii;n.key=t.value,n.text=t.text,e.setLookupRow(n)}}},{key:"_createEditor",value:function(e){var t=this,n=O.create("SmartField",{parent:this.table,codeType:this.codeType,lookupCall:this.lookupCall?this.lookupCall.clone():null,browseHierarchy:this.browseHierarchy,browseMaxRowCount:this.browseMaxRowCount,browseAutoExpandAll:this.browseAutoExpandAll,browseLoadIncremental:this.browseLoadIncremental,activeFilterEnabled:this.activeFilterEnabled});return n.on("prepareLookupCall",(function(n){t.trigger("prepareLookupCall",{lookupCall:n.lookupCall,row:e})})),n.on("lookupCallDone",(function(e){t.trigger("lookupCallDone",{result:e.result})})),n}},{key:"_updateCellFromValidEditor",value:function(e,t){this.setCellErrorStatus(e,null);var n=this.cell(e),r=n.text,o=t.displayText;n.setText(o),this._setCellValue(e,t.value,n),e.initialized&&r!==o&&n.text===o&&this.table.updateRow(e),this._updateCellText(e,n)}},{key:"_hasCellValue",value:function(e){var t=e.value;return Pr.isNumber(t)?!Pr.isNullOrUndefined(t):!!t}},{key:"_setCellValue",value:function(e,t,n){s$(c$(i.prototype),"_setCellValue",this).call(this,e,t,n),n.setSortCode(this._calculateCellSortCode(n))}}])&&i$(t.prototype,n),r&&i$(t,r),i}(qA);function h$(e){return(h$="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function p$(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function d$(e,t){return(d$=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function y$(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=b$(e);if(t){var o=b$(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return v$(this,n)}}function v$(e,t){return!t||"object"!==h$(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function b$(e){return(b$=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var m$=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&d$(e,t)}(i,e);var t,n,r,o=y$(i);function i(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(t=o.call(this,e)).renderingHints.offset=6,t}return t=i,(n=[{key:"handle",value:function(e){this.field.toggle()}},{key:"_postRenderKeyBox",value:function(e){if(this.field.iconId){var t=e.find(".icon").width()/2-e.find(".key-box").outerWidth()/2+e.cssPaddingLeft();e.find(".key-box").cssLeft(t)}}}])&&p$(t.prototype,n),r&&p$(t,r),i}(ld);function g$(e){return(g$="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _$(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function w$(e,t,n){return(w$="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=T$(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function k$(e,t){return(k$=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function S$(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=T$(e);if(t){var o=T$(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return O$(this,n)}}function O$(e,t){return!t||"object"!==g$(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function T$(e){return(T$=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function C$(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var P$=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&k$(e,t)}(i,e);var t,n,r,o=S$(i);function i(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(e=o.call(this)).tableFooter=null,e.contentRendered=!1,e.height=null,e.animateDuration=null,e.resizerVisible=!0,e.toggleAction=!0,e.showTooltipWhenSelected=!1,e}return t=i,(n=[{key:"_init",value:function(e){this.parent=e.parent,this.table=this.getTable(),w$(T$(i.prototype),"_init",this).call(this,e),this.denseClass=this.session.desktop.dense?" dense":"",i.CONTAINER_SIZE=To.getSize("table-control-container"+this.denseClass,"height","height",i.CONTAINER_SIZE),this.height=i.CONTAINER_SIZE,this.animateDuration=i.CONTAINER_ANIMATE_DURATION,this._setSelected(this.selected)}},{key:"_initKeyStrokeContext",value:function(){w$(T$(i.prototype),"_initKeyStrokeContext",this).call(this),this.tableControlKeyStrokeContext=this._createKeyStrokeContextForTableControl()}},{key:"_createKeyStrokeContextForTableControl",value:function(){var e=new $u;return e.$scopeTarget=function(){return this.tableFooter.$controlContent}.bind(this),e.$bindTarget=function(){return this.tableFooter.$controlContent}.bind(this),e.registerKeyStroke(new CB(this)),e}},{key:"_createLayout",value:function(){return new Sl}},{key:"_render",value:function(){var e="table-control ";this.cssClass&&(e+=this.cssClass+"-table-control"),this.$container=this.$parent.appendDiv(e).on("mousedown",this._onMouseDown.bind(this)).data("control",this),this.htmlComp=ea.install(this.$container,this.session),this.htmlComp.setLayout(this._createLayout())}},{key:"remove",value:function(){this.removeContent(),w$(T$(i.prototype),"remove",this).call(this)}},{key:"_renderContent",value:function(e){}},{key:"_removeContent",value:function(){}},{key:"removeContent",value:function(){this.contentRendered&&(this._removeContent(),this.cssClass&&(this.tableFooter.$controlContainer.removeClass(this.cssClass+"-table-control-container"),this.tableFooter.$controlContent.removeClass(this.cssClass+"-table-control-content")),this.session.keyStrokeManager.uninstallKeyStrokeContext(this.tableControlKeyStrokeContext),this.contentRendered=!1)}},{key:"renderContent",value:function(){(this.contentRendered||this.isContentAvailable())&&(this.tableFooter.open||this.tableFooter.openControlContainer(this),this.contentRendered||(this.cssClass&&(this.tableFooter.$controlContainer.addClass(this.cssClass+"-table-control-container"),this.tableFooter.$controlContent.addClass(this.cssClass+"-table-control-content")),this.tableFooter.$controlContent.data("control",this),this._renderContent(this.tableFooter.$controlContent),this.session.keyStrokeManager.installKeyStrokeContext(this.tableControlKeyStrokeContext),this.htmlComp&&this.htmlComp.invalidateLayoutTree(!1),this.contentRendered=!0))}},{key:"get$Scrollable",value:function(){return this.$contentContainer}},{key:"_renderSelected",value:function(e,t){e=O.nvl(e,this.selected),t=$.extend({},{closeWhenUnselected:!0},t),this.$container.select(e),e?(this.tableFooter.onControlSelected(this),this.renderContent()):this.rendered&&(t.closeWhenUnselected&&this===this.tableFooter.selectedControl?(this.tableFooter.onControlSelected(null),this.tableFooter.closeControlContainer(this,t)):this.removeContent()),this._updateTooltip()}},{key:"isContentAvailable",value:function(){return!0}},{key:"toggle",value:function(){this.enabledComputed&&(this.tableFooter.selectedControl===this?this.setSelected(!1):this.setSelected(!0))}},{key:"setSelected",value:function(e,t){e&&!this.visible||e!==this.selected&&(this.tableFooter&&this.tableFooter.selectedControl&&this.tableFooter.selectedControl!==this&&this.tableFooter.selectedControl.setSelected(!1,{closeWhenUnselected:!1}),this._setSelected(e),t=$.extend({},{closeWhenUnselected:!0},t),this.rendered?this._renderSelected(e,t):t.closeWhenUnselected&&this.tableFooter&&this===this.tableFooter.selectedControl&&!e&&this.tableFooter.onControlSelected(null))}},{key:"_setSelected",value:function(e){this._setProperty("selected",e)}},{key:"_configureTooltip",value:function(){var e=w$(T$(i.prototype),"_configureTooltip",this).call(this);return e.cssClass="table-control-tooltip",e}},{key:"_onMouseDown",value:function(){this.toggle()}},{key:"onControlContainerOpened",value:function(){}},{key:"onControlContainerClosed",value:function(){this.removeContent()}},{key:"_createActionKeyStroke",value:function(){return new m$(this)}},{key:"getTable",value:function(){for(var e=this.parent;e;){if(e instanceof Cx)return e;e=e.parent}return null}}])&&_$(t.prototype,n),r&&_$(t,r),i}(Up);function R$(e){return(R$="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function x$(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function E$(e,t){return(E$=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function D$(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=F$(e);if(t){var o=F$(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return A$(this,n)}}function A$(e,t){return!t||"object"!==R$(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function F$(e){return(F$=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}C$(P$,"CONTAINER_SIZE",345),C$(P$,"CONTAINER_ANIMATE_DURATION",350);var $$=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&E$(e,t)}(i,e);var t,n,r,o=D$(i);function i(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),o.call(this)}return t=i,(n=[{key:"_goOffline",value:function(){this.widget.isContentAvailable()||(this._enabledBeforeOffline=this.widget.enabled,this.widget.setEnabled(!1))}},{key:"_goOnline",value:function(){this.widget.isContentAvailable()||this.widget.setEnabled(this._enabledBeforeOffline)}}])&&x$(t.prototype,n),r&&x$(t,r),i}(ed);function j$(e){return(j$="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function B$(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function M$(e,t,n){return(M$="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=V$(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function I$(e,t){return(I$=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function L$(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=V$(e);if(t){var o=V$(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return H$(this,n)}}function H$(e,t){return!t||"object"!==j$(t)&&"function"!=typeof t?N$(e):t}function N$(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function V$(e){return(V$=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var W$=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&I$(e,t)}(i,e);var t,n,r,o=L$(i);function i(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(e=o.call(this)).tableControl=null,e._tableControlPropertyChangeHandler=e._onTableControlPropertyChange.bind(N$(e)),e._tableControlDestroyHandler=e._onTableControlDestroy.bind(N$(e)),e._addCloneProperties(["tableControl"]),e}return t=i,r=[{key:"adaptTableControlProperties",value:function(e,t){for(var n in t=t||{},["text","iconId","enabled","visible","selected","tooltipText","keyStroke","keyStrokes","modelClass","classId","form"].forEach((function(n){t[n]=e[n]})),t)void 0===t[n]&&delete t[n];return t}}],(n=[{key:"_init",value:function(e){if(M$(V$(i.prototype),"_init",this).call(this,e),!this.tableControl)throw new Error("Cannot adapt to undefined tableControl");this._installListeners()}},{key:"_destroy",value:function(){this._uninstallListeners(),M$(V$(i.prototype),"_destroy",this).call(this)}},{key:"_installListeners",value:function(){this.tableControl.on("propertyChange",this._tableControlPropertyChangeHandler),this.tableControl.on("destroy",this._tableControlDestroyHandler)}},{key:"_uninstallListeners",value:function(){this.tableControl.off("propertyChange",this._tableControlPropertyChangeHandler),this.tableControl.off("destroy",this._tableControlDestroyHandler)}},{key:"_render",value:function(){M$(V$(i.prototype),"_render",this).call(this),this.$container.attr("data-tableControlAdapter",this.tableControl.id)}},{key:"_onTableControlPropertyChange",value:function(e){var t={};for(var n in t[e.propertyName]=e.newValue,t=i.adaptTableControlProperties(t))this.setProperty(n,t[n])}},{key:"_onTableControlDestroy",value:function(e){this.destroy(),this._uninstallListeners()}},{key:"doAction",value:function(){return this.tableControl.doAction()}},{key:"setSelected",value:function(e){this.tableControl.setSelected(e)}}])&&B$(t.prototype,n),r&&B$(t,r),i}(uP);function z$(e){return(z$="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function G$(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function U$(e,t,n){return(U$="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=J$(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function K$(e,t){return(K$=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function q$(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=J$(e);if(t){var o=J$(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Y$(this,n)}}function Y$(e,t){return!t||"object"!==z$(t)&&"function"!=typeof t?X$(e):t}function X$(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function J$(e){return(J$=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Z$=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&K$(e,t)}(i,e);var t,n,r,o=q$(i);function i(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(e=o.call(this))._tableDataScrollHandler=e._onTableDataScroll.bind(X$(e)),e._tableColumnResizedHandler=e._onTableColumnResized.bind(X$(e)),e._tableColumnMovedHandler=e._onTableColumnMoved.bind(X$(e)),e._tableColumnStructureChangedHandler=e._onTableColumnStructureChanged.bind(X$(e)),e._tableChangedHandler=e._onTableChanged.bind(X$(e)),e._aggregationFunctionChangedHandler=e._onAggregationFunctionChanged.bind(X$(e)),e.animateDuration=i.CONTAINER_ANIMATE_DURATION,e.aggregateRow=[],e.cssClass="aggregate",e.height=0,e.iconId=gn.SUM,e.tooltipText="${textKey:ui.Total}",e.resizerVisible=!1,e}return t=i,(n=[{key:"_init",value:function(e){U$(J$(i.prototype),"_init",this).call(this,e),this.table.on("columnStructureChanged",this._tableColumnStructureChangedHandler),this.table.on("aggregationFunctionChanged",this._aggregationFunctionChangedHandler)}},{key:"_destroy",value:function(){U$(J$(i.prototype),"_destroy",this).call(this),this.table.off("columnStructureChanged",this._tableColumnStructureChangedHandler),this.table.off("aggregationFunctionChanged",this._aggregationFunctionChangedHandler)}},{key:"_render",value:function(){U$(J$(i.prototype),"_render",this).call(this),this._updateEnabledAndSelectedState(),this.height=this.table.rowHeight+qs.insets(this.table.footer.$controlContainer).vertical()}},{key:"_renderContent",value:function(e){this.$contentContainer=e.appendDiv("table-aggregate"),this._aggregate(),this._renderAggregate(),this._reconcileScrollPos(),this.table.$data.on("scroll",this._tableDataScrollHandler),this.table.on("columnResized",this._tableColumnResizedHandler),this.table.on("columnMoved",this._tableColumnMovedHandler),this.table.on("rowsSelected rowsInserted rowsUpdated rowsDeleted filter group allRowsDeleted",this._tableChangedHandler)}},{key:"_removeContent",value:function(){this.$contentContainer.remove(),this.table.$data.off("scroll",this._tableDataScrollHandler),this.table.off("columnResized",this._tableColumnResizedHandler),this.table.off("columnMoved",this._tableColumnMovedHandler),this.table.off("rowsSelected rowsInserted rowsUpdated rowsDeleted filter group allRowsDeleted",this._tableChangedHandler)}},{key:"_renderAggregate",value:function(){this.table.visibleColumns().forEach((function(e,t){var n,r,o;r=null==(n=this.aggregateRow[t])||e.grouped?e.createAggrEmptyCell():e.createAggrValueCell(n),o=s()(e.buildCell(r,{})),this._installCellTooltip(o),this.aggregateRow.selection&&o.addClass("selection"),o.appendTo(this.$contentContainer),o.isContentTruncated()&&o.children(".table-cell-icon").setVisible(!1)}),this),this.aggregateRow.selection&&this.$contentContainer.addClass("selection")}},{key:"_rerenderAggregate",value:function(){this.$contentContainer.empty(),this._renderAggregate(),this._reconcileScrollPos()}},{key:"_installCellTooltip",value:function(e){xp.install(e,{parent:this,text:this._cellTooltipText.bind(this),htmlEnabled:!0,arrowPosition:50,arrowPositionUnit:"%",nativeTooltip:!Kt.get().isCustomEllipsisTooltipPossible()})}},{key:"_cellTooltipText",value:function(e){return e.text().trim()&&(e.isContentTruncated()||e.children(".table-cell-icon").length&&!e.children(".table-cell-icon").isVisible())?((e=e.clone()).children(".table-cell-icon").setVisible(!0),e.html()):null}},{key:"_aggregate",value:function(){var e,t=[],n=this.table.selectedRows;n.length>1?(e=n,t.selection=!0):e=this.table.filteredRows(),this.table._forEachVisibleColumn("aggrStart",t),e.forEach((function(e){this.table._forEachVisibleColumn("aggrStep",t,e)}),this),this.table._forEachVisibleColumn("aggrFinish",t),this.aggregateRow=t,this.contentRendered&&this.selected&&this._rerenderAggregate()}},{key:"_reconcileScrollPos",value:function(){var e=this.table.$data.scrollLeft();this.$contentContainer.scrollLeft(e)}},{key:"_updateEnabledAndSelectedState",value:function(e){if(this.initialized){var t=this.table.containsAggregatedNumberColumn();t?e&&!this.table.isGrouped()&&this.setSelected(!0):this.selected&&this.setSelected(!1),this.setEnabled(t)}}},{key:"_setEnabled",value:function(e){U$(J$(i.prototype),"_setEnabled",this).call(this,e),this._updateEnabledAndSelectedState()}},{key:"_setSelected",value:function(e){this._setProperty("selected",e),this._updateEnabledAndSelectedState()}},{key:"_onTableDataScroll",value:function(){this._reconcileScrollPos()}},{key:"_onTableChanged",value:function(){this._aggregate()}},{key:"_onAggregationFunctionChanged",value:function(){this._updateEnabledAndSelectedState(!0),this.contentRendered&&this.selected&&this._aggregate()}},{key:"_onTableColumnResized",value:function(){this._rerenderAggregate()}},{key:"_onTableColumnMoved",value:function(e){rt.move(this.aggregateRow,e.oldPos,e.newPos),this._rerenderAggregate()}},{key:"_onTableColumnStructureChanged",value:function(){this._updateEnabledAndSelectedState(),this.contentRendered&&this.selected&&this._aggregate()}}])&&G$(t.prototype,n),r&&G$(t,r),i}(P$);function Q$(e){return(Q$="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ej(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function tj(e,t){return(tj=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function nj(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=oj(e);if(t){var o=oj(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return rj(this,n)}}function rj(e,t){return!t||"object"!==Q$(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function oj(e){return(oj=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}!function(e,t,n){t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}(Z$,"CONTAINER_ANIMATE_DURATION",200);var ij=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&tj(e,t)}(i,e);var t,n,r,o=nj(i);function i(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),o.call(this)}return t=i,r=[{key:"modifyAggregateTableControlPrototype",value:function(){E.get().remote&&Pr.replacePrototypeFunction(Z$,"_onTableColumnStructureChanged",(function(e){this.modelAdapter?this._updateEnabledAndSelectedState():this._onTableColumnStructureChangedOrig()}),!0)}}],(n=null)&&ej(t.prototype,n),r&&ej(t,r),i}($$);function sj(e){return(sj="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function aj(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function lj(e,t,n){return(lj="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=pj(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function uj(e,t){return(uj=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function cj(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pj(e);if(t){var o=pj(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return fj(this,n)}}function fj(e,t){return!t||"object"!==sj(t)&&"function"!=typeof t?hj(e):t}function hj(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function pj(e){return(pj=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}E.addListener("bootstrap",ij.modifyAggregateTableControlPrototype);var dj=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&uj(e,t)}(i,e);var t,n,r,o=cj(i);function i(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(e=o.call(this))._addWidgetProperties("form"),e._formDestroyedHandler=e._onFormDestroyed.bind(hj(e)),e}return t=i,(n=[{key:"_init",value:function(e){lj(pj(i.prototype),"_init",this).call(this,e),this._setForm(this.form)}},{key:"_createLayout",value:function(){return new Pj(this)}},{key:"_renderContent",value:function(e){this.form.renderInitialFocusEnabled=!1,this.form.render(e);var t=this.form.rootGroupBox;t.controls[0]instanceof s9&&t.controls[0].$container.addClass("in-table-control"),this.form.$container.height(e.height()),this.form.$container.width(e.width()),this.form.htmlComp.validateRoot=!0,this.form.htmlComp.validateLayout()}},{key:"_removeContent",value:function(){this.form&&this.form.remove()}},{key:"_removeForm",value:function(){this.removeContent()}},{key:"_renderForm",value:function(e){this.renderContent()}},{key:"isContentAvailable",value:function(){return!!this.form}},{key:"_setForm",value:function(e){this.form&&this.form.off("destroy",this._formDestroyedHandler),e&&(e.on("destroy",this._formDestroyedHandler),this._adaptForm(e)),this._setProperty("form",e)}},{key:"_adaptForm",value:function(e){e.rootGroupBox.setMenuBarPosition(gJ.MenuBarPosition.BOTTOM),e.setDisplayHint(CC.DisplayHint.VIEW),e.setModal(!1),e.setAskIfNeedSave(!1),this.session.userAgent.deviceType!==Kt.Type.MOBILE&&e.rootGroupBox.fieldStyle===ZW.FieldStyle.ALTERNATIVE&&e.rootGroupBox.setFieldStyle(ZW.FieldStyle.CLASSIC)}},{key:"onControlContainerOpened",value:function(){this.form&&this.form.rendered&&this.form.renderInitialFocus()}},{key:"_onFormDestroyed",value:function(e){this._removeForm(),this._setForm(null)}}])&&aj(t.prototype,n),r&&aj(t,r),i}(P$);function yj(e){return(yj="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function vj(e,t){return(vj=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function bj(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=gj(e);if(t){var o=gj(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return mj(this,n)}}function mj(e,t){return!t||"object"!==yj(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function gj(e){return(gj=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var _j=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&vj(e,t)}(n,e);var t=bj(n);function n(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),t.call(this)}return n}($$);function wj(e){return(wj="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function kj(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Sj(e,t){return(Sj=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Oj(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Cj(e);if(t){var o=Cj(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Tj(this,n)}}function Tj(e,t){return!t||"object"!==wj(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Cj(e){return(Cj=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Pj=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Sj(e,t)}(i,e);var t,n,r,o=Oj(i);function i(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(t=o.call(this)).control=e,t}return t=i,(n=[{key:"layout",value:function(e){if(this.control.contentRendered&&this.control.form){var t=this.control.form,n=t.htmlComp,r=qs.size(this.control.tableFooter.$controlContent).subtract(n.margins());if(n.setSize(r),t.rootGroupBox.controls[0]instanceof s9){var o=t.rootGroupBox.controls[0].selectedTab;o&&o.scrollable&&document.activeElement&&o.$body.has(document.activeElement)&&Lh.scrollTo(o.$body,s()(document.activeElement))}}}}])&&kj(t.prototype,n),r&&kj(t,r),i}(Zs);function Rj(e){return(Rj="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function xj(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Ej(e,t,n){return(Ej="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=jj(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function Dj(e,t){return(Dj=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Aj(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=jj(e);if(t){var o=jj(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Fj(this,n)}}function Fj(e,t){return!t||"object"!==Rj(t)&&"function"!=typeof t?$j(e):t}function $j(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function jj(e){return(jj=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Bj=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Dj(e,t)}(i,e);var t,n,r,o=Aj(i);function i(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(e=o.call(this)).table=null,e.column=null,e.row=null,e.cell=null,e._pendingCompleteCellEdit=null,e._keyStrokeHandler=e._onKeyStroke.bind($j(e)),e}return t=i,(n=[{key:"_init",value:function(e){e.scrollType=e.scrollType||"position",Ej(jj(i.prototype),"_init",this).call(this,e),this.table=e.column.table,this.link(this.cell.field)}},{key:"_createLayout",value:function(){return new Wj(this)}},{key:"_initKeyStrokeContext",value:function(){Ej(jj(i.prototype),"_initKeyStrokeContext",this).call(this),this.keyStrokeContext.registerKeyStroke([new rB(this),new fB(this)])}},{key:"_createCloseKeyStroke",value:function(){return new Xj(this)}},{key:"_open",value:function(e,t){this.render(e,t),this.position(),this.pack()}},{key:"_render",value:function(){Ej(jj(i.prototype),"_render",this).call(this);var e="",t=this.table.visibleColumns(),n=t.indexOf(this.column);0===n?e="first":n===t.length-1&&(e="last"),this.$container.addClass("cell-editor-popup "+e).data("popup",this);var r=this.cell.field;r.mode=ZW.Mode.CELLEDITOR,r.render(),r.prepareForCellEdit({cssClass:e}),this.$anchor.css("visibility","hidden"),this._rowOrderChangedFunc=function(e){e.animating?e.row===this.row&&this.position():this.position()}.bind(this),this.table.on("rowOrderChanged",this._rowOrderChangedFunc),this.table.enabled&&this.table.$container.addClass("focused"),this.session.keyStrokeManager.on("keyStroke",this._keyStrokeHandler)}},{key:"_postRender",value:function(){Ej(jj(i.prototype),"_postRender",this).call(this);var e=this.cell.field;e.onCellEditorRendered&&e.onCellEditorRendered({openFieldPopup:this.table.openFieldPopupOnCellEdit,cellEditorPopup:this})}},{key:"_remove",value:function(){Ej(jj(i.prototype),"_remove",this).call(this),this.session.keyStrokeManager.off("keyStroke",this._keyStrokeHandler),this.table.off("rowOrderChanged",this._rowOrderChangedFunc),this.table.rendered&&this.table.$container.removeClass("focused"),this.$anchor.css("visibility","")}},{key:"position",value:function(){var e,t,n=this.table.$data,r=this.row.$row,o=this.$anchor,i=n.cssPxValue("padding-left")+r.cssBorderLeftWidth();(e=qs.bounds(o)).x+=o.cssMarginX(),(t=qs.bounds(r)).y+=r.cssMarginY(),this.setLocation(new Is(i+e.x,n.scrollTop()+t.y))}},{key:"completeEdit",value:function(e){var t=this;if(this._pendingCompleteCellEdit)return this._pendingCompleteCellEdit;var n=this.cell.field.acceptInput();return n&&O.nvl(e,!0)?this._pendingCompleteCellEdit=n.then((function(){t.table.completeCellEdit()})):(this._pendingCompleteCellEdit=s.a.resolvedPromise(),this.table.completeCellEdit()),this._pendingCompleteCellEdit.then((function(){t._pendingCompleteCellEdit=null})),this._pendingCompleteCellEdit}},{key:"isCompleteCellEditRequested",value:function(){return!!this._pendingCompleteCellEdit}},{key:"cancelEdit",value:function(){this.table.cancelCellEdit(),this.remove()}},{key:"_onMouseDownOutside",value:function(e){var t=s()(e.target).closest(".table-row",this.table.$container[0]);this.completeEdit(),t.length>0&&!t.isAttached()&&this._propagateMouseDownToTableRow(e)}},{key:"_propagateMouseDownToTableRow",value:function(e){var t=this.table.$container.document(!0),n=s()(t.elementFromPoint(e.pageX,e.pageY));0!==n.closest(".table-row",this.table.$container[0]).length&&Nt.propagateEvent(n[0],e)}},{key:"_onKeyStroke",value:function(e){this.session.keyStrokeManager.invokeAcceptInputOnActiveValueField(e.keyStroke,e.keyStrokeContext)&&(this.$container.isOrHas(e.keyStrokeContext.$getScopeTarget())||this.completeEdit(!1))}},{key:"waitForCompleteCellEdit",value:function(){return this._pendingCompleteCellEdit?this._pendingCompleteCellEdit.promise():s.a.resolvedPromise()}}])&&xj(t.prototype,n),r&&xj(t,r),i}(Id);function Mj(e){return(Mj="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ij(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Lj(e,t){return(Lj=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Hj(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Vj(e);if(t){var o=Vj(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Nj(this,n)}}function Nj(e,t){return!t||"object"!==Mj(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Vj(e){return(Vj=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Wj=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Lj(e,t)}(i,e);var t,n,r,o=Hj(i);function i(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(t=o.call(this)).cellEditorPopup=e,t._field=e.cell.field,t._htmlContainer=e.htmlComp,t}return t=i,(n=[{key:"layout",value:function(e){var t,n=this._field.htmlComp;t=this._htmlContainer.availableSize({exact:!0}).subtract(this._htmlContainer.insets()).subtract(n.margins()),n.setSize(t)}},{key:"preferredLayoutSize",value:function(e){var t,n,r,o=this.cellEditorPopup.row.$row,i=this.cellEditorPopup.$anchor;return(t=qs.bounds(i,{exact:!0})).x+=i.cssMarginX(),(n=qs.bounds(o,{exact:!0})).y+=o.cssMarginY(),(r=this.cellEditorPopup.$container.cssMarginLeft())<0&&(t.width=t.width+-r),new $s(t.width,n.height)}}])&&Ij(t.prototype,n),r&&Ij(t,r),i}(Zs);function zj(e){return(zj="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Gj(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Uj(e,t){return(Uj=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Kj(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Yj(e);if(t){var o=Yj(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return qj(this,n)}}function qj(e,t){return!t||"object"!==zj(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Yj(e){return(Yj=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Xj=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Uj(e,t)}(i,e);var t,n,r,o=Kj(i);function i(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(t=o.call(this)).field=e,t.which=[Ou.ESC],t.stopPropagation=!0,t}return t=i,(n=[{key:"handle",value:function(e){this.field.cancelEdit()}}])&&Gj(t.prototype,n),r&&Gj(t,r),i}(zu);function Jj(e){return(Jj="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Zj(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Qj(e,t){return(Qj=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function eB(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=nB(e);if(t){var o=nB(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return tB(this,n)}}function tB(e,t){return!t||"object"!==Jj(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function nB(e){return(nB=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var rB=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Qj(e,t)}(i,e);var t,n,r,o=eB(i);function i(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(t=o.call(this)).field=e,t.which=[Ou.ENTER],t.stopPropagation=!0,t}return t=i,(n=[{key:"handle",value:function(e){this.field.completeEdit()}}])&&Zj(t.prototype,n),r&&Zj(t,r),i}(zu);function oB(e){return(oB="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function iB(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function sB(e,t,n){return(sB="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=cB(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function aB(e,t){return(aB=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function lB(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=cB(e);if(t){var o=cB(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return uB(this,n)}}function uB(e,t){return!t||"object"!==oB(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function cB(e){return(cB=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var fB=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&aB(e,t)}(i,e);var t,n,r,o=lB(i);function i(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(t=o.call(this)).field=e,t.which=[Ou.TAB],t.shift=void 0,t}return t=i,(n=[{key:"_accept",value:function(e){return sB(cB(i.prototype),"_accept",this).call(this,e)&&!this.field.isCompleteCellEditRequested()}},{key:"handle",value:function(e){var t,n=e.shiftKey,r=this.field.table,o=this.field.column,i=this.field.row;this.field.completeEdit().then((function(){(t=r.nextEditableCellPos(o,i,n))&&r.prepareCellEdit(t.column,t.row)}))}}])&&iB(t.prototype,n),r&&iB(t,r),i}(zu);function hB(e){return(hB="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function pB(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function dB(e,t,n){return(dB="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=mB(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function yB(e,t){return(yB=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function vB(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=mB(e);if(t){var o=mB(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return bB(this,n)}}function bB(e,t){return!t||"object"!==hB(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function mB(e){return(mB=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var gB=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&yB(e,t)}(i,e);var t,n,r,o=vB(i);function i(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(t=o.call(this)).repeatable=!0,t.field=e,t.shift=!!e.multiSelect&&void 0,t.stopPropagation=!0,t.keyStrokeMode=zu.Mode.DOWN,t}return t=i,(n=[{key:"_accept",value:function(e){if(!dB(mB(i.prototype),"_accept",this).call(this,e))return!1;var t=this.field.$container.activeElement(!0),n=t.tagName.toLowerCase();return!!("table-text-filter"===t.className||"textarea"!==n&&"input"!==n||e.originalEvent&&(!e.originalEvent||e.originalEvent.smartFieldEvent))}},{key:"_viewportInfo",value:function(){var e,t,n,r,o,i=this.field,s={},a=i.visibleRows;return 0===a.length||(e=qs.offsetBounds(i.$data),t=qs.insets(i.$data),n=i.$data.cssMarginTop(),e=e.subtract(t),n<0&&(e.y-=Math.abs(n),e.height+=Math.abs(n)),r=this._findFirstRowInViewport(i,e),o=this._findLastRowInViewport(i,a.indexOf(r),e),s.firstRow=r,s.lastRow=o),s}},{key:"firstRowAfterSelection",value:function(){var e=this.field.$selectedRows();if(e.length){var t=this.field.visibleRows,n=e.last().data("row");return t[this.field.filteredRows().indexOf(n)+1]}}},{key:"firstRowBeforeSelection",value:function(){var e=this.field.$selectedRows();if(e.length){var t=this.field.visibleRows,n=e.first().data("row");return t[this.field.visibleRows.indexOf(n)-1]}}},{key:"_findLastSelectedRowBefore",value:function(e,t){var n,r=e.visibleRows;return 0===t?r[t]:((n=rt.findFromReverse(r,t,(function(t,n){var o=r[n-1];return!!o&&!e.isRowSelected(o)})))||(n=r[0]),n)}},{key:"_findLastSelectedRowAfter",value:function(e,t){var n,r=e.visibleRows;return t===r.length-1?r[t]:((n=rt.findFrom(r,t,(function(t,n){var o=r[n+1];return!!o&&!e.isRowSelected(o)})))||(n=r[r.length-1]),n)}},{key:"_findFirstRowInViewport",value:function(e,t){var n=e.visibleRows;return rt.find(n,(function(e,n){var r,o,i=e.$row;return!!e.$row&&(r=i.offset(),(o=e.$row.cssMarginTop())<0&&(r.top+=Math.abs(o)),t.contains(r.left,r.top))}))}},{key:"_findLastRowInViewport",value:function(e,t,n){var r=e.visibleRows;return t===r.length-1?r[t]:rt.findFromForward(r,t,(function(e,t){var o,i,s=r[t+1];return!s||!(i=s.$row)||(o=qs.offsetBounds(i),!n.contains(o.x,o.y+o.height-1))}))}},{key:"_isEnabled",value:function(){return!this.field.tileMode}}])&&pB(t.prototype,n),r&&pB(t,r),i}(zu);function _B(e){return(_B="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function wB(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function kB(e,t){return(kB=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function SB(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=TB(e);if(t){var o=TB(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return OB(this,n)}}function OB(e,t){return!t||"object"!==_B(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function TB(e){return(TB=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var CB=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&kB(e,t)}(i,e);var t,n,r,o=SB(i);function i(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(t=o.call(this)).field=e,t.which=[Ou.ESC],t.stopPropagation=!0,t.renderingHints.render=!1,t}return t=i,(n=[{key:"handle",value:function(e){this.field.toggle()}}])&&wB(t.prototype,n),r&&wB(t,r),i}(zu);function PB(e){return(PB="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function RB(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function xB(e,t){return(xB=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function EB(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=AB(e);if(t){var o=AB(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return DB(this,n)}}function DB(e,t){return!t||"object"!==PB(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function AB(e){return(AB=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var FB=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&xB(e,t)}(i,e);var t,n,r,o=EB(i);function i(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(t=o.call(this)).field=e,t.which=[Ou.C],t.ctrl=!0,t.renderingHints.render=!1,t}return t=i,(n=[{key:"handle",value:function(e){this.field.exportToClipboard()}}])&&RB(t.prototype,n),r&&RB(t,r),i}(zu);function $B(e){return($B="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function jB(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function BB(e,t,n){return(BB="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=NB(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function MB(e,t){return(MB=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function IB(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=NB(e);if(t){var o=NB(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return LB(this,n)}}function LB(e,t){return!t||"object"!==$B(t)&&"function"!=typeof t?HB(e):t}function HB(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function NB(e){return(NB=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var VB=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&MB(e,t)}(i,e);var t,n,r,o=IB(i);function i(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(t=o.call(this,e)).field=e,t.which=[Ou.SUBTRACT,Ou.LEFT],t.renderingHints.text="-",t.renderingHints.$drawingArea=function(e,t){var n=this.field.selectedRows[0];if(n)return n.$row}.bind(HB(t)),t}return t=i,(n=[{key:"_accept",value:function(e){var t=BB(NB(i.prototype),"_accept",this).call(this,e),n=this.field.selectedRows[0];return!!(t&&n&&(n.expanded&&n._expandable||n.parentRow))}},{key:"handle",value:function(e){var t=this.field,n=this.field.selectedRows[0];n&&(n.expanded&&n._expandable?t.collapseRow(n):n.parentRow&&(t.selectRow(n.parentRow),t.selectionHandler.lastActionRow=n.parentRow))}}])&&jB(t.prototype,n),r&&jB(t,r),i}(gB);function WB(e){return(WB="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function zB(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function GB(e,t,n){return(GB="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=XB(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function UB(e,t){return(UB=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function KB(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=XB(e);if(t){var o=XB(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return qB(this,n)}}function qB(e,t){return!t||"object"!==WB(t)&&"function"!=typeof t?YB(e):t}function YB(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function XB(e){return(XB=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var JB=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&UB(e,t)}(i,e);var t,n,r,o=KB(i);function i(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(t=o.call(this,e)).field=e,t.which=[Ou.ADD,Ou.RIGHT],t.renderingHints.text="+",t.renderingHints.$drawingArea=function(e,t){var n=this.field.selectedRows[0];if(n)return n.$row}.bind(YB(t)),t}return t=i,(n=[{key:"_accept",value:function(e){var t=GB(XB(i.prototype),"_accept",this).call(this,e),n=this.field.selectedRows[0];return!!t&&!!n&&n._expandable}},{key:"handle",value:function(e){var t,n=this.field,r=this.field.selectedRows[0];r&&r._expandable&&(r.expanded?(t=this.field.visibleChildRows(r),n.selectRow(t[0]),n.selectionHandler.lastActionRow=t[0]):n.expandRow(r))}}])&&zB(t.prototype,n),r&&zB(t,r),i}(gB);function ZB(e){return(ZB="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function QB(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function eM(e,t){return(eM=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function tM(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=oM(e);if(t){var o=oM(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return nM(this,n)}}function nM(e,t){return!t||"object"!==ZB(t)&&"function"!=typeof t?rM(e):t}function rM(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function oM(e){return(oM=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var iM=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&eM(e,t)}(i,e);var t,n,r,o=tM(i);function i(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(t=o.call(this)).field=e,t.ctrl=!0,t.which=[Ou.A],t.renderingHints.offset=14,t.renderingHints.$drawingArea=function(e,t){return this.field.footer?this.field.footer._$infoSelection.find(".table-info-button"):null}.bind(rM(t)),t}return t=i,(n=[{key:"handle",value:function(e){var t=this.field;t.toggleSelection(),t.selectionHandler.lastActionRow=null}}])&&QB(t.prototype,n),r&&QB(t,r),i}(zu);function sM(e){return(sM="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function aM(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function lM(e,t,n){return(lM="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=pM(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function uM(e,t){return(uM=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function cM(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pM(e);if(t){var o=pM(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return fM(this,n)}}function fM(e,t){return!t||"object"!==sM(t)&&"function"!=typeof t?hM(e):t}function hM(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function pM(e){return(pM=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var dM=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&uM(e,t)}(i,e);var t,n,r,o=cM(i);function i(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(t=o.call(this)).field=e,t.ctrl=!0,t.which=[Ou.ENTER],t.stopPropagation=!0,t.renderingHints.$drawingArea=function(e,t){var n=t._editPosition,r=this.field.visibleColumns().indexOf(n.column);return 0===r?n.row.$row:this.field.$cell(r,n.row.$row)}.bind(hM(t)),t}return t=i,(n=[{key:"_accept",value:function(e){if(!lM(pM(i.prototype),"_accept",this).call(this,e))return!1;if(this.field.cellEditorPopup)return!1;var t=this.field.selectedRows;if(!t.length)return!1;var n=this.field.nextEditableCellPosForRow(0,t[0]);return!!n&&(e._editPosition=n,!0)}},{key:"handle",value:function(e){var t=e._editPosition;this.field.prepareCellEdit(t.column,t.row,!0)}}])&&aM(t.prototype,n),r&&aM(t,r),i}(zu);function yM(e){return(yM="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function vM(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function bM(e,t,n){return(bM="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=kM(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function mM(e,t){return(mM=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function gM(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=kM(e);if(t){var o=kM(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return _M(this,n)}}function _M(e,t){return!t||"object"!==yM(t)&&"function"!=typeof t?wM(e):t}function wM(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function kM(e){return(kM=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var SM=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&mM(e,t)}(i,e);var t,n,r,o=gM(i);function i(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(t=o.call(this)).field=e,t.which=[Ou.F5],t.renderingHints.offset=14,t.renderingHints.$drawingArea=function(e,t){return this.field.footer?this.field.footer._$infoLoad.find(".table-info-button"):null}.bind(wM(t)),t}return t=i,(n=[{key:"_accept",value:function(e){return bM(kM(i.prototype),"_accept",this).call(this,e)&&this.field.hasReloadHandler}},{key:"handle",value:function(e){this.field.reload()}}])&&vM(t.prototype,n),r&&vM(t,r),i}(zu);function OM(e){return(OM="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function TM(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function CM(e,t,n){return(CM="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=EM(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function PM(e,t){return(PM=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function RM(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=EM(e);if(t){var o=EM(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return xM(this,n)}}function xM(e,t){return!t||"object"!==OM(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function EM(e){return(EM=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var DM=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&PM(e,t)}(i,e);var t,n,r,o=RM(i);function i(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(t=o.call(this)).field=e,t.which=[Ou.SPACE],t.stopPropagation=!0,t.renderingHints.render=!1,t}return t=i,(n=[{key:"_accept",value:function(e){return CM(EM(i.prototype),"_accept",this).call(this,e)&&this.field.checkable&&this.field.selectedRows.length}},{key:"handle",value:function(e){var t=this.field.selectedRows.filter((function(e){return e.enabled})),n=t.some((function(e){return!e.checked}));t.forEach((function(e){this.field.checkRow(e,n)}),this)}}])&&TM(t.prototype,n),r&&TM(t,r),i}(zu);function AM(e){return(AM="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function FM(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function $M(e,t){return($M=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function jM(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=IM(e);if(t){var o=IM(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return BM(this,n)}}function BM(e,t){return!t||"object"!==AM(t)&&"function"!=typeof t?MM(e):t}function MM(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function IM(e){return(IM=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var LM=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&$M(e,t)}(i,e);var t,n,r,o=jM(i);function i(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(t=o.call(this,e)).which=[Ou.UP],t.renderingHints.text="↑",t.renderingHints.$drawingArea=function(e,t){var n=this.firstRowBeforeSelection();if(n)return n.$row}.bind(MM(t)),t}return t=i,(n=[{key:"handle",value:function(e){var t,n,r=this.field,o=r.visibleRows,i=r.selectedRows,s=r.selectionHandler.lastActionRow,a=-1,l=-1;if(s&&(a=o.indexOf(s)),o.length>1&&(i.length>0||a>-1)){if(a<0&&(s=o.length===i.length?rt.last(o):rt.first(i),a=o.indexOf(s)),0===a)return;if(t=[n=o[l=a-1]],e.shiftKey)if(r.isRowSelected(n)){t=[],rt.pushAll(t,i);var u=r.selectionHandler.getMinMaxSelectionIndizes();O.isOneOf(a,u[0],u[1])&&rt.remove(t,s)}else t=rt.union(t,i),n=this._findLastSelectedRowBefore(r,l)}else n=(t=[rt.last(o)])[0];r.selectionHandler.lastActionRow=n,r.selectRows(t,!0),r.scrollTo(n)}}])&&FM(t.prototype,n),r&&FM(t,r),i}(gB);function HM(e){return(HM="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function NM(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function VM(e,t){return(VM=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function WM(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=UM(e);if(t){var o=UM(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return zM(this,n)}}function zM(e,t){return!t||"object"!==HM(t)&&"function"!=typeof t?GM(e):t}function GM(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function UM(e){return(UM=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var KM=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&VM(e,t)}(i,e);var t,n,r,o=WM(i);function i(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(t=o.call(this,e)).which=[Ou.DOWN],t.renderingHints.text="↓",t.renderingHints.$drawingArea=function(e,t){var n=this.firstRowAfterSelection();if(n)return n.$row}.bind(GM(t)),t}return t=i,(n=[{key:"handle",value:function(e){var t,n,r=this.field,o=r.visibleRows,i=r.selectedRows,s=r.selectionHandler.lastActionRow,a=-1,l=-1;if(s&&(a=o.indexOf(s)),o.length>1&&(i.length>0||a>-1)){if(a<0&&(s=o.length===i.length?rt.first(o):rt.last(i),a=o.indexOf(s)),a===o.length-1)return;if(t=[n=o[l=a+1]],e.shiftKey)if(r.isRowSelected(n)){t=[],rt.pushAll(t,i);var u=r.selectionHandler.getMinMaxSelectionIndizes();O.isOneOf(a,u[0],u[1])&&rt.remove(t,s)}else t=rt.union(i,t),n=this._findLastSelectedRowAfter(r,l)}else n=(t=[rt.first(o)])[0];r.selectionHandler.lastActionRow=n,r.selectRows(t,!0),r.scrollTo(n)}}])&&NM(t.prototype,n),r&&NM(t,r),i}(gB);function qM(e){return(qM="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function YM(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function XM(e,t){return(XM=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function JM(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=eI(e);if(t){var o=eI(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return ZM(this,n)}}function ZM(e,t){return!t||"object"!==qM(t)&&"function"!=typeof t?QM(e):t}function QM(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function eI(e){return(eI=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var tI=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&XM(e,t)}(i,e);var t,n,r,o=JM(i);function i(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(t=o.call(this,e)).which=[Ou.HOME],t.renderingHints.text="Home",t.renderingHints.$drawingArea=function(e,t){var n=this._viewportInfo();if(n.firstRow)return n.firstRow.$row}.bind(QM(t)),t}return t=i,(n=[{key:"handle",value:function(e){var t=this.field,n=t.visibleRows,r=rt.first(n),o=t.selectedRows,i=[],s=t.selectionHandler.lastActionRow,a=-1;e.shiftKey&&o.length>0?(s&&(a=n.indexOf(s)),a<0&&(s=rt.first(o),a=n.indexOf(s)),i=n.slice(0,a),i=rt.union(i,o)):i=r,t.selectionHandler.lastActionRow=r,t.selectRows(i),t.scrollTo(r)}}])&&YM(t.prototype,n),r&&YM(t,r),i}(gB);function nI(e){return(nI="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function rI(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function oI(e,t){return(oI=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function iI(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=lI(e);if(t){var o=lI(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return sI(this,n)}}function sI(e,t){return!t||"object"!==nI(t)&&"function"!=typeof t?aI(e):t}function aI(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function lI(e){return(lI=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var uI=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&oI(e,t)}(i,e);var t,n,r,o=iI(i);function i(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(t=o.call(this,e)).which=[Ou.END],t.renderingHints.text="End",t.renderingHints.$drawingArea=function(e,t){var n=this._viewportInfo();if(n.lastRow)return n.lastRow.$row}.bind(aI(t)),t}return t=i,(n=[{key:"handle",value:function(e){var t=this.field,n=t.visibleRows,r=rt.last(n),o=t.selectedRows,i=[],s=t.selectionHandler.lastActionRow,a=-1;e.shiftKey&&o.length>0?(s&&(a=n.indexOf(s)),a<0&&(s=rt.last(o),a=n.indexOf(s)),i=n.slice(a+1,n.length),i=rt.union(o,i)):i=r,t.selectionHandler.lastActionRow=r,t.selectRows(i),t.scrollTo(r)}}])&&rI(t.prototype,n),r&&rI(t,r),i}(gB);function cI(e){return(cI="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function fI(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function hI(e,t){return(hI=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function pI(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=vI(e);if(t){var o=vI(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return dI(this,n)}}function dI(e,t){return!t||"object"!==cI(t)&&"function"!=typeof t?yI(e):t}function yI(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function vI(e){return(vI=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var bI=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&hI(e,t)}(i,e);var t,n,r,o=pI(i);function i(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(t=o.call(this,e)).which=[Ou.PAGE_UP],t.renderingHints.text="PgUp",t.renderingHints.$drawingArea=function(e,t){var n=this._viewportInfo();if(n.firstRow)return n.firstRow.$row}.bind(yI(t)),t}return t=i,(n=[{key:"handle",value:function(e){var t,n=this.field,r=this._viewportInfo(),o=n.visibleRows,i=n.selectedRows,s=rt.first(i),a=n.selectionHandler.lastActionRow,l=-1;(r.firstRow||(n.scrollPageUp(),(r=this._viewportInfo()).firstRow))&&(a&&(l=o.indexOf(a)),l<0&&(a=s,l=o.indexOf(a)),(!(i.length>0&&a===r.firstRow)||i.length>1&&!e.shiftKey||(n.scrollPageUp(),(r=this._viewportInfo()).firstRow))&&(e.shiftKey&&i.length>0?(t=o.slice(o.indexOf(r.firstRow),l),t=rt.union(i,t)):t=[r.firstRow],n.selectionHandler.lastActionRow=r.firstRow,n.selectRows(t,!0)))}}])&&fI(t.prototype,n),r&&fI(t,r),i}(gB);function mI(e){return(mI="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function gI(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function _I(e,t){return(_I=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function wI(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=OI(e);if(t){var o=OI(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return kI(this,n)}}function kI(e,t){return!t||"object"!==mI(t)&&"function"!=typeof t?SI(e):t}function SI(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function OI(e){return(OI=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var TI=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_I(e,t)}(i,e);var t,n,r,o=wI(i);function i(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(t=o.call(this,e)).which=[Ou.PAGE_DOWN],t.renderingHints.text="PgDn",t.renderingHints.$drawingArea=function(e,t){var n=this._viewportInfo();if(n.lastRow)return n.lastRow.$row}.bind(SI(t)),t}return t=i,(n=[{key:"handle",value:function(e){var t,n=this.field,r=this._viewportInfo(),o=n.visibleRows,i=n.selectedRows,s=rt.last(i),a=n.selectionHandler.lastActionRow,l=-1;(r.lastRow||(n.scrollPageDown(),(r=this._viewportInfo()).lastRow))&&(a&&(l=o.indexOf(a)),l<0&&(a=s,l=o.indexOf(a)),(!(i.length>0&&a===r.lastRow)||i.length>1&&!e.shiftKey||(n.scrollPageDown(),(r=this._viewportInfo()).lastRow))&&(e.shiftKey&&i.length>0?(t=o.slice(l+1,o.indexOf(r.lastRow)+1),t=rt.union(i,t)):t=[r.lastRow],n.selectionHandler.lastActionRow=r.lastRow,n.selectRows(t,!0)))}}])&&gI(t.prototype,n),r&&gI(t,r),i}(gB);function CI(e){return(CI="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function PI(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function RI(e,t){return(RI=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function xI(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=DI(e);if(t){var o=DI(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return EI(this,n)}}function EI(e,t){return!t||"object"!==CI(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function DI(e){return(DI=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var AI=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&RI(e,t)}(i,e);var t,n,r,o=xI(i);function i(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(t=o.call(this)).field=e,t.renderingHints.$drawingArea=function(e,t){return t._$filterInput},t.virtualKeyStrokeWhich="a-Z;a-z;0-9",t.preventDefault=!1,t.keyStrokeMode=zu.Mode.DOWN,t}return t=i,(n=[{key:"_accept",value:function(e){if(!this._isKeyStrokeInRange(e))return!1;var t=s()(".table-text-filter",this.field.$container);if(!t.length)return!1;var n=this.field.$container.activeElement(!0),r=n.tagName.toLowerCase(),o="textarea"===r||"input"===r;return!("table-text-filter"===n.className&&o||(e._$filterInput=t,this._isKeyStrokeInRange(e),0))}},{key:"handle",value:function(e){var t=e._$filterInput;if(this.field.session.focusManager.requestFocus(t)){t.focus();var n=O.nvl(t.val(),"").length;t[0].setSelectionRange(n,n)}}},{key:"keys",value:function(){return[new Cu(this,this.virtualKeyStrokeWhich)]}},{key:"renderKeyBox",value:function(e,t){var n=t._$filterInput,r=n.position().left+n.cssMarginLeft()+4;return n.beforeDiv("key-box char","a - z").toggleClass("disabled",!this.enabledByFilter).cssLeft(r),n.parent()}},{key:"_isKeyStrokeInRange",value:function(e){return e.which===this.virtualKeyStrokeWhich||!(e.altKey|e.ctrlKey)&&(e.which>=Ou.a&&e.which<=Ou.z||e.which>=Ou.A&&e.which<=Ou.Z||e.which>=Ou[0]&&e.which<=Ou[9]||e.which>=Ou.NUMPAD_0&&e.which<=Ou.NUMPAD_9)}}])&&PI(t.prototype,n),r&&PI(t,r),i}(zu);function FI(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var $I=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,(n=[{key:"createKey",value:function(){return"filterKey"}},{key:"accept",value:function(e){}}])&&FI(t.prototype,n),r&&FI(t,r),e}();function jI(e){return(jI="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function BI(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function MI(e,t){return(MI=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function II(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=HI(e);if(t){var o=HI(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return LI(this,n)}}function LI(e,t){return!t||"object"!==jI(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function HI(e){return(HI=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var NI=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&MI(e,t)}(i,e);var t,n,r,o=II(i);function i(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),o.call(this)}return t=i,(n=[{key:"init",value:function(e){if(this.session=e.session,!this.session)throw new Error("Session expected: "+this);this._init(e)}},{key:"_init",value:function(e){s.a.extend(this,e)}},{key:"createFilterAddedEventData",value:function(){return{filterType:this.filterType}}},{key:"createFilterRemovedEventData",value:function(){return{filterType:this.filterType}}},{key:"createKey",value:function(){return this.filterType}},{key:"createLabel",value:function(){return""}},{key:"accept",value:function(e){}}])&&BI(t.prototype,n),r&&BI(t,r),i}($I);function VI(e){return(VI="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function WI(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function zI(e,t,n){return(zI="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=qI(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function GI(e,t){return(GI=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function UI(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=qI(e);if(t){var o=qI(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return KI(this,n)}}function KI(e,t){return!t||"object"!==VI(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function qI(e){return(qI=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var YI=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&GI(e,t)}(i,e);var t,n,r,o=UI(i);function i(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(e=o.call(this)).filterType=i.TYPE,e.events=new ln,e.hasFilterFields=!1,e.availableValues=[],e.selectedValues=[],e}return t=i,(n=[{key:"axisGroup",value:function(){return Nx.NumberGroup.COUNT}},{key:"calculate",value:function(){var e,t;this.matrix=new Nx(this.table,this.session),this.matrix.addData(this.column,Nx.NumberGroup.COUNT),this.xAxis=this.matrix.addAxis(this.column,this.axisGroup());var n,r,o,i,s=this.matrix.calculate();this.selectedValues.forEach((function(n){var r=this;e=!1,this.xAxis.some((function(t){return r.xAxis.keyToDeterministicKey(t)===n&&(e=!0,!0)}),this),e||(this.xAxis.push(this.xAxis.deterministicKeyToKey(n)),t=!0)}),this),t&&this.xAxis.reorder(),this.availableValues=[],this.xAxis.forEach((function(e){r=this.xAxis.keyToDeterministicKey(e),n=this.xAxis.format(e),i=null,null!==e&&this.xAxis.textIsIcon&&(i=n,n=null),o=s.getValue([e]),this.availableValues.push({key:r,text:n,iconId:i,htmlEnabled:!1,cssClass:null,count:o?o[0]:0})}),this)}},{key:"createFilterAddedEventData",value:function(){var e=zI(qI(i.prototype),"createFilterAddedEventData",this).call(this);return e.columnId=this.column.id,e.selectedValues=this.selectedValues,e}},{key:"createFilterRemovedEventData",value:function(){var e=zI(qI(i.prototype),"createFilterRemovedEventData",this).call(this);return e.columnId=this.column.id,e}},{key:"createLabel",value:function(){return this.column.headerHtmlEnabled?Wn.plainText(this.column.text).replace(/\n/g," "):this.column.text||""}},{key:"createKey",value:function(){return this.column.id}},{key:"accept",value:function(e){this.xAxis||this.calculate();var t=!0,n=!0,r=this.column.cellValueOrTextForCalculation(e),o=this.xAxis.normDeterministic(r);return this.tableFilterActive()&&(t=this.selectedValues.indexOf(o)>-1),this.fieldsFilterActive()&&(n=this.acceptByFields(r,o,e)),t&&n}},{key:"filterActive",value:function(){return this.tableFilterActive()||this.fieldsFilterActive()}},{key:"tableFilterActive",value:function(){return this.selectedValues.length>0}},{key:"triggerFilterFieldsChanged",value:function(e){this.events.trigger("filterFieldsChanged",e)}},{key:"on",value:function(e,t){this.events.on(e,t)}},{key:"off",value:function(e,t){this.events.off(e,t)}},{key:"acceptByFields",value:function(e,t,n){return!0}},{key:"fieldsFilterActive",value:function(){return!1}},{key:"addFilterFields",value:function(e){}},{key:"modifyFilterFields",value:function(){}},{key:"filterFieldsTitle",value:function(){return null}},{key:"createComparator",value:function(){return GA.NUMERIC}}])&&WI(t.prototype,n),r&&WI(t,r),i}(NI);function XI(e){return(XI="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function JI(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ZI(e,t,n){return(ZI="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=nL(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function QI(e,t){return(QI=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function eL(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=nL(e);if(t){var o=nL(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return tL(this,n)}}function tL(e,t){return!t||"object"!==XI(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function nL(e){return(nL=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}!function(e,t,n){t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}(YI,"TYPE","column");var rL=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&QI(e,t)}(i,e);var t,n,r,o=eL(i);function i(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(e=o.call(this)).dateFrom,e.dateFromField,e.dateTo,e.dateToField,e.hasFilterFields=!0,e}return t=i,(n=[{key:"_init",value:function(e){ZI(nL(i.prototype),"_init",this).call(this,e),this.dateFrom=Et.parseJsonDate(this.dateFrom),this.dateTo=Et.parseJsonDate(this.dateTo)}},{key:"axisGroup",value:function(){return this.column.hasDate?Nx.DateGroup.YEAR:Nx.DateGroup.NONE}},{key:"createFilterAddedEventData",value:function(){var e=ZI(nL(i.prototype),"createFilterAddedEventData",this).call(this);return e.dateFrom=Et.toJsonDate(this.dateFrom),e.dateTo=Et.toJsonDate(this.dateTo),e}},{key:"fieldsFilterActive",value:function(){return this.dateFrom||this.dateTo}},{key:"acceptByFields",value:function(e,t,n){if(!e)return!1;var r=e.valueOf(),o=this.dateFrom?this.dateFrom.valueOf():null,i=this.dateTo?Et.shift(this.dateTo,0,0,1).valueOf()-1:null;if(o&&i)return r>=o&&r<=i;if(o)return r>=o;if(i)return r<=i;throw new Error("illegal state")}},{key:"filterFieldsTitle",value:function(){return this.session.text("ui.DateRange")}},{key:"addFilterFields",value:function(e){this.dateFromField=e.addFilterField("DateField","ui.from"),this.dateFromField.setValue(this.dateFrom),this.dateFromField.on("propertyChange",this._onPropertyChange.bind(this)),this.dateToField=e.addFilterField("DateField","ui.to"),this.dateToField.setValue(this.dateTo),this.dateToField.on("propertyChange",this._onPropertyChange.bind(this))}},{key:"_onPropertyChange",value:function(e){"value"===e.propertyName&&(this.dateFrom=this.dateFromField.value,this.dateTo=this.dateToField.value,s.a.log.isDebugEnabled()&&s.a.log.debug("(DateColumnUserFilter#_onAcceptInput) dateFrom="+this.dateFrom+" dateTo="+this.dateTo),this.triggerFilterFieldsChanged(e))}},{key:"modifyFilterFields",value:function(){this.dateFromField.$field.on("input","",s.a.debounce(this._onInput.bind(this))),this.dateToField.$field.on("input","",s.a.debounce(this._onInput.bind(this)))}},{key:"_onInput",value:function(e){this.dateFromField.rendered&&(this.dateFrom=this.dateFromField.value,this.dateTo=this.dateToField.value,this.triggerFilterFieldsChanged(e))}}])&&JI(t.prototype,n),r&&JI(t,r),i}(YI);function oL(e){return(oL="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function iL(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function sL(e,t,n){return(sL="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=cL(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function aL(e,t){return(aL=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function lL(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=cL(e);if(t){var o=cL(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return uL(this,n)}}function uL(e,t){return!t||"object"!==oL(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function cL(e){return(cL=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var fL=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&aL(e,t)}(i,e);var t,n,r,o=lL(i);function i(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(e=o.call(this)).numberFrom,e.numberFromField,e.numberTo,e.numberToField,e.hasFilterFields=!0,e}return t=i,(n=[{key:"createFilterAddedEventData",value:function(){var e=sL(cL(i.prototype),"createFilterAddedEventData",this).call(this);return e.numberFrom=this.numberFrom,e.numberTo=this.numberTo,e}},{key:"fieldsFilterActive",value:function(){return Pr.isNumber(this.numberFrom)||Pr.isNumber(this.numberTo)}},{key:"acceptByFields",value:function(e,t,n){var r=Pr.isNumber(this.numberFrom),o=Pr.isNumber(this.numberTo);return r&&o?t>=this.numberFrom&&t<=this.numberTo:r?t>=this.numberFrom:o?t<=this.numberTo:void 0}},{key:"filterFieldsTitle",value:function(){return this.session.text("ui.NumberRange")}},{key:"addFilterFields",value:function(e){this.numberFromField=e.addFilterField("NumberField","ui.from"),this.numberFromField.decimalFormat=this.column.decimalFormat,this.numberFromField.setValue(this.numberFrom),this.numberFromField.on("propertyChange",this._onPropertyChange.bind(this)),this.numberToField=e.addFilterField("NumberField","ui.to"),this.numberToField.decimalFormat=this.column.decimalFormat,this.numberToField.setValue(this.numberTo),this.numberToField.on("propertyChange",this._onPropertyChange.bind(this))}},{key:"_onPropertyChange",value:function(e){"value"===e.propertyName&&(this.numberFrom=this.numberFromField.value,this.numberTo=this.numberToField.value,s.a.log.isDebugEnabled()&&s.a.log.debug("(NumberColumnUserFilter#_onPropertyChange) numberFrom="+this.numberFrom+" numberTo="+this.numberTo),this.triggerFilterFieldsChanged(e))}}])&&iL(t.prototype,n),r&&iL(t,r),i}(YI);function hL(e){return(hL="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function pL(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function dL(e,t,n){return(dL="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=mL(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function yL(e,t){return(yL=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function vL(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=mL(e);if(t){var o=mL(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return bL(this,n)}}function bL(e,t){return!t||"object"!==hL(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function mL(e){return(mL=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var gL=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&yL(e,t)}(i,e);var t,n,r,o=vL(i);function i(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(e=o.call(this)).freeText=null,e.freeTextField=null,e.hasFilterFields=!0,e}return t=i,(n=[{key:"createFilterAddedEventData",value:function(){var e=dL(mL(i.prototype),"createFilterAddedEventData",this).call(this);return e.freeText=this.freeText,e}},{key:"fieldsFilterActive",value:function(){return Wn.hasText(this.freeText)}},{key:"acceptByFields",value:function(e,t,n){var r=Wn.nvl(this.freeText).toLowerCase();return Wn.nvl(this.column.cellTextForTextFilter(n)).toLowerCase().indexOf(r)>-1}},{key:"filterFieldsTitle",value:function(){return this.session.text("ui.FreeText")}},{key:"addFilterFields",value:function(e){this.freeTextField=O.create("StringField",{parent:e,labelVisible:!1,statusVisible:!1,maxLength:100,displayText:this.freeText,updateDisplayTextOnModify:!0}),this.freeTextField.on("acceptInput",this._onAcceptInput.bind(this)),e.addField0(this.freeTextField)}},{key:"_onAcceptInput",value:function(e){this.freeText=this.freeTextField.$field.val().trim(),s.a.log.isDebugEnabled()&&s.a.log.debug("(TextColumnUserFilter#_onAcceptInput) freeText="+this.freeText),this.triggerFilterFieldsChanged(e)}},{key:"modifyFilterFields",value:function(){this.freeTextField.removeMandatoryIndicator()}}])&&pL(t.prototype,n),r&&pL(t,r),i}(YI);function _L(e){return(_L="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function wL(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function kL(e,t,n){return(kL="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=CL(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function SL(e,t){return(SL=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function OL(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=CL(e);if(t){var o=CL(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return TL(this,n)}}function TL(e,t){return!t||"object"!==_L(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function CL(e){return(CL=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var PL=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&SL(e,t)}(i,e);var t,n,r,o=OL(i);function i(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(e=o.call(this)).filterType=i.TYPE,e}return t=i,(n=[{key:"createFilterAddedEventData",value:function(){var e=kL(CL(i.prototype),"createFilterAddedEventData",this).call(this);return e.text=this.text,e}},{key:"createLabel",value:function(){return this.text}},{key:"accept",value:function(e){var t=this.table.visibleColumns().reduce((function(t,n){return t+n.cellTextForTextFilter(e)+" "}),"");return this.text!==this._cachedText&&(this._cachedText=this.text,this._cachedTextLowerCase=this.text.toLowerCase()),(t=t.trim().toLowerCase()).indexOf(this._cachedTextLowerCase)>-1}}])&&wL(t.prototype,n),r&&wL(t,r),i}(NI);function RL(e){return(RL="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function xL(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function EL(e,t){return(EL=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function DL(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=$L(e);if(t){var o=$L(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return AL(this,n)}}function AL(e,t){return!t||"object"!==RL(t)&&"function"!=typeof t?FL(e):t}function FL(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function $L(e){return($L=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}!function(e,t,n){t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}(PL,"TYPE","text");var jL=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&EL(e,t)}(i,e);var t,n,r,o=DL(i);function i(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),t=o.call(this),s.a.extend(FL(t),e),t}return t=i,(n=[{key:"createKey",value:function(){return"TileTableHierarchyFilter"}},{key:"accept",value:function(e){return!e.parentRow}},{key:"createLabel",value:function(){return this.table.session.text("ui.TileView")}}])&&xL(t.prototype,n),r&&xL(t,r),i}($I);function BL(e){return(BL="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ML(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function IL(e,t){return(IL=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function LL(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=NL(e);if(t){var o=NL(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return HL(this,n)}}function HL(e,t){return!t||"object"!==BL(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function NL(e){return(NL=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var VL=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&IL(e,t)}(i,e);var t,n,r,o=LL(i);function i(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(t=o.call(this)).acceptedKeys=[],t.keySupplier=e||function(e){return e.lookupRow&&e.lookupRow.key},t.active=!0,t.alwaysAcceptedRowIds=[],t}return t=i,(n=[{key:"createKey",value:function(){return"KeyTableFilter"}},{key:"accept",value:function(e){if(!this.active||rt.empty(this.acceptedKeys)||-1!==this.alwaysAcceptedRowIds.indexOf(e.id))return!0;var t=this.keySupplier(e);return-1!==this.acceptedKeys.indexOf(t)}},{key:"setAcceptedKeys",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.acceptedKeys=rt.ensure(t)}},{key:"setActive",value:function(e){this.active=e}},{key:"setAlwaysAcceptedRowIds",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.alwaysAcceptedRowIds=t}}])&&ML(t.prototype,n),r&&ML(t,r),i}($I);function WL(e){return(WL="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function zL(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function GL(e,t){return(GL=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function UL(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=qL(e);if(t){var o=qL(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return KL(this,n)}}function KL(e,t){return!t||"object"!==WL(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function qL(e){return(qL=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var YL=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&GL(e,t)}(i,e);var t,n,r,o=UL(i);function i(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(t=o.call(this)).acceptedText=null,t.textSupplier=e||function(e){return e.lookupRow&&e.lookupRow.text},t.active=!0,t.alwaysAcceptedRowIds=[],t}return t=i,(n=[{key:"createKey",value:function(){return"TextTableFilter"}},{key:"accept",value:function(e){if(!this.active||Wn.empty(this.acceptedText)||-1!==this.alwaysAcceptedRowIds.indexOf(e.id))return!0;var t=this.textSupplier(e);return!Wn.empty(t)&&Wn.contains(t.toLowerCase(),this.acceptedText.toLowerCase())}},{key:"setAcceptedText",value:function(e){this.acceptedText=e}},{key:"setActive",value:function(e){this.active=e}},{key:"setAlwaysAcceptedRowIds",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.alwaysAcceptedRowIds=t}}])&&zL(t.prototype,n),r&&zL(t,r),i}($I);function XL(e){return(XL="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function JL(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ZL(e,t,n){return(ZL="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=nH(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function QL(e,t){return(QL=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function eH(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=nH(e);if(t){var o=nH(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return tH(this,n)}}function tH(e,t){return!t||"object"!==XL(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function nH(e){return(nH=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var rH=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&QL(e,t)}(i,e);var t,n,r,o=eH(i);function i(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(e=o.call(this)).preselectedTime=null,e.selectedTime=null,e.resolution=null,e.$scrollable=null,e.touch=Kt.get().supportsOnlyTouch(),e}return t=i,(n=[{key:"_init",value:function(e){ZL(nH(i.prototype),"_init",this).call(this,e),this.resolution=e.timeResolution}},{key:"_render",value:function(){this.$container=this.$parent.appendDiv("time-picker").toggleClass("touch",this.touch),this.htmlComp=ea.install(this.$container,this.session),this._renderTimeSelection(),this._installScrollbars()}},{key:"_renderTimeSelection",value:function(){var e,t,n,r=Et.trunc(new Date),o=Et.ceil(new Date,this.resolution),i=0,s=this.$parent.makeDiv("day-table");for(e=0;e<24;e++)for(r.setMinutes(0),i=r.getHours(),(n=(t=s.appendDiv("hour-row")).appendDiv("cell  hours").data("time",new Date(r)).on("click",this._onTimeClick.bind(this))).appendSpan("text").text(Et.format(r,this.session.locale,"HH"));i===r.getHours();)(n=t.appendDiv("cell minutes").data("time",new Date(r)).on("click",this._onTimeClick.bind(this))).appendSpan("text").text(Et.format(r,this.session.locale,":mm")),Et.isSameTime(o,r)&&n.addClass("now"),r.setMinutes(r.getMinutes()+this.resolution);return s.appendTo(this.$container),s}},{key:"_installScrollbars",value:function(e){this._uninstallScrollbars(),ZL(nH(i.prototype),"_installScrollbars",this).call(this,{axis:"y"})}},{key:"preselectTime",value:function(e){e&&this.setSelectedTime(null),this.setPreselectedTime(e)}},{key:"setPreselectedTime",value:function(e){this.setProperty("preselectedTime",e)}},{key:"_renderPreselectedTime",value:function(){var e,t=this;this.$container.find(".cell").each((function(n,r){var o=s()(r),i=o.data("time");o.removeClass("preselected"),t.preselectedTime&&(o.hasClass("hours")&&t.preselectedTime.getHours()===i.getHours()||o.hasClass("minutes")&&Et.isSameTime(t.preselectedTime,i))&&(o.addClass("preselected"),e=o)})),e&&Lh.scrollTo(this.$container,e,"center")}},{key:"selectTime",value:function(e){e&&this.setPreselectedTime(null),this.setSelectedTime(e)}},{key:"setSelectedTime",value:function(e){this.setProperty("selectedTime",e)}},{key:"_renderSelectedTime",value:function(){var e,t=this;this.$container.find(".cell").each((function(n,r){var o=s()(r),i=o.data("time");o.removeClass("selected"),t.selectedTime&&(o.hasClass("hours")&&t.selectedTime.getHours()===i.getHours()||o.hasClass("minutes")&&Et.isSameTime(t.selectedTime,i))&&(o.addClass("selected"),e=o)})),e&&Lh.scrollTo(this.$container,e,"center")}},{key:"shiftViewDate",value:function(e,t,n){var r=this.viewDate;r=Et.shift(r,e,t,n),this.showDate(r)}},{key:"shiftSelectedTime",value:function(e,t,n){var r=this.preselectedTime;this.selectedTime&&(r=Et.shiftTime(this.selectedTime,e,t*this.resolution,n)),r&&this.selectTime(this._snapToTimeGrid(r))}},{key:"_snapToTimeGrid",value:function(e){if(!e)return e;var t=e.getMinutes();return t=parseInt(t/this.resolution)*this.resolution,e.setMinutes(t),e}},{key:"_findNextAllowedDate",value:function(e,t,n){var r,o,i=e+t+n>0?1:-1,s=this.selectedDate||Et.trunc(new Date);if(0!==e?s=Et.shift(s,e,0,0):0!==t&&(s=Et.shift(s,0,t,0)),1===i){for(r=0;r<this.allowedDates.length;r++)if(o=this.allowedDates[r],Et.compare(s,o)<0)return o}else if(-1===i)for(r=this.allowedDates.length-1;r>=0;r--)if(o=this.allowedDates[r],Et.compare(s,o)>0)return o;return null}},{key:"_isDateAllowed",value:function(e){if(!this.allowedDates||0===this.allowedDates.length)return!0;var t=e.getTime();return this.allowedDates.some((function(e){return e.getTime()===t}))}},{key:"_onNavigationMouseDown",value:function(e){var t=s()(e.currentTarget).data("shift");this.shiftViewDate(0,t,0)}},{key:"_onTimeClick",value:function(e){var t=s()(e.currentTarget),n=new Date(t.data("time"));this.selectTime(n),this.trigger("timeSelect",{time:n})}},{key:"_onMouseWheel",value:function(e){var t=((e=e.originalEvent||this.$container.window(!0).event.originalEvent).wheelDelta?e.wheelDelta/10:3*-e.detail)>=0?-1:1;this.shiftViewDate(0,t,0),e.preventDefault()}}])&&JL(t.prototype,n),r&&JL(t,r),i}(ve);function oH(e){return(oH="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function iH(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function sH(e,t,n){return(sH="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=cH(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function aH(e,t){return(aH=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function lH(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=cH(e);if(t){var o=cH(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return uH(this,n)}}function uH(e,t){return!t||"object"!==oH(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function cH(e){return(cH=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var fH=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&aH(e,t)}(i,e);var t,n,r,o=lH(i);function i(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),o.call(this)}return t=i,(n=[{key:"_init",value:function(e){e.scrollType=e.scrollType||"layoutAndPosition",e.withFocusContext=!1,sH(cH(i.prototype),"_init",this).call(this,e),this.picker=O.create("TimePicker",{parent:this,timeResolution:e.timeResolution})}},{key:"_createLayout",value:function(){return new gH(this)}},{key:"_render",value:function(){this.$container=this.$parent.appendDiv("time-picker-popup"),this.$container.toggleClass("alternative",this.field.fieldStyle===ZW.FieldStyle.ALTERNATIVE),this.htmlComp=ea.install(this.$container,this.session),this.htmlComp.setLayout(this._createLayout()),this.htmlComp.validateRoot=!0,this.picker.render()}},{key:"getTimePicker",value:function(){return this.picker}},{key:"_isMouseDownOnAnchor",value:function(e){return this.field.$timeField.isOrHas(e.target)||this.field.$timeFieldIcon.isOrHas(e.target)||this.field.$timeClearIcon&&this.field.$timeClearIcon.isOrHas(e.target)}}])&&iH(t.prototype,n),r&&iH(t,r),i}(Id);function hH(e){return(hH="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function pH(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function dH(e,t,n){return(dH="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=mH(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function yH(e,t){return(yH=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function vH(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=mH(e);if(t){var o=mH(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return bH(this,n)}}function bH(e,t){return!t||"object"!==hH(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function mH(e){return(mH=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var gH=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&yH(e,t)}(i,e);var t,n,r,o=vH(i);function i(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(t=o.call(this)).popup=e,t.doubleCalcPrefSize=!1,t}return t=i,(n=[{key:"layout",value:function(e){var t,n=this.popup.htmlComp,r=this.popup.picker.htmlComp;dH(mH(i.prototype),"layout",this).call(this,e),t=n.size().subtract(n.insets()).subtract(r.margins()),r.setSize(t),this.popup.htmlComp.layouted&&this.popup.position()}},{key:"preferredLayoutSize",value:function(e){var t,n=this.popup.htmlComp,r=this.popup.picker.htmlComp;return(t=r.prefSize().add(n.insets()).add(r.margins())).height=Math.max(15,Math.min(350,t.height)),t}}])&&pH(t.prototype,n),r&&pH(t,r),i}(Qd);function _H(e){return(_H="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function wH(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function kH(e,t,n){return(kH="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=CH(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function SH(e,t){return(SH=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function OH(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=CH(e);if(t){var o=CH(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return TH(this,n)}}function TH(e,t){return!t||"object"!==_H(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function CH(e){return(CH=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var PH=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&SH(e,t)}(i,e);var t,n,r,o=OH(i);function i(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),o.call(this)}return t=i,(n=[{key:"_init",value:function(e){kH(CH(i.prototype),"_init",this).call(this,e),this._field.on("acceptInput",this._onFieldAcceptInput.bind(this))}},{key:"_initWidget",value:function(e){this._widget=O.create("TimePicker",{parent:this,timeResolution:e.timeResolution})}},{key:"_render",value:function(){kH(CH(i.prototype),"_render",this).call(this),this._field.$container.addClass("time")}},{key:"getTimePicker",value:function(){return this._widget}},{key:"_createLayout",value:function(){return new jH(this)}},{key:"_onFieldAcceptInput",value:function(e){this._touchField.setDisplayText(e.displayText),this._touchField.setErrorStatus(e.errorStatus),!!e.errorStatus&&e.errorStatus.containsStatus(Xr)||this._touchField.setValue(e.value),this._touchField._triggerAcceptInput()}}])&&wH(t.prototype,n),r&&wH(t,r),i}(Iy);function RH(e){return(RH="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function xH(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function EH(e,t,n){return(EH="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=$H(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function DH(e,t){return(DH=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function AH(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=$H(e);if(t){var o=$H(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return FH(this,n)}}function FH(e,t){return!t||"object"!==RH(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function $H(e){return($H=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var jH=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&DH(e,t)}(i,e);var t,n,r,o=AH(i);function i(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),o.call(this,e)}return t=i,(n=[{key:"layout",value:function(e){EH($H(i.prototype),"layout",this).call(this,e),this.popup.getTimePicker().htmlComp.setSize(this.popup._widgetContainerHtmlComp.size())}},{key:"preferredLayoutSize",value:function(e,t){var n=this.popup.htmlComp.insets(),r=this.popup._field.htmlComp,o=this.popup._widgetContainerHtmlComp,i=r.prefSize(t).add(r.margins()),s=o.prefSize(t).add(o.margins()),a=qs.size(this.popup._$header,!0).height+i.height+s.height+n.vertical(),l=Math.max(i.width,s.width);return new $s(l,a)}}])&&xH(t.prototype,n),r&&xH(t,r),i}(Uy);function BH(e){return(BH="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function MH(e){return function(e){if(Array.isArray(e))return IH(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return IH(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return IH(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function IH(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function LH(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function HH(e,t,n){return(HH="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=GH(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function NH(e,t){return(NH=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function VH(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=GH(e);if(t){var o=GH(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return WH(this,n)}}function WH(e,t){return!t||"object"!==BH(t)&&"function"!=typeof t?zH(e):t}function zH(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function GH(e){return(GH=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function UH(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var KH=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&NH(e,t)}(i,e);var t,n,r,o=VH(i);function i(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(e=o.call(this)).toggleBreadcrumbStyleEnabled=!1,e.breadcrumbTogglingThreshold=null,e.autoCheckChildren=!1,e.checkable=!1,e.checkableStyle=i.CheckableStyle.CHECKBOX_TREE_NODE,e.displayStyle=i.DisplayStyle.DEFAULT,e.dropType=0,e.dropMaximumSize=rn.DEFAULT_DROP_MAXIMUM_SIZE,e.filterEnabled=!1,e.lazyExpandingEnabled=!0,e.menus=[],e.contextMenu=null,e.menuBar=null,e.keyStrokes=[],e.multiCheck=!0,e.nodes=[],e.nodesMap={},e.nodePaddingLevelCheckable=23,e.nodePaddingLevelNotCheckable=18,e.nodePaddingLeft=null,e.nodeCheckBoxPaddingLeft=29,e.nodeControlPaddingLeft=null,e.nodePaddingLevel=e.nodePaddingLevelNotCheckable,e.scrollToSelection=!1,e.scrollTop=0,e.scrollTopHistory=[],e.selectedNodes=[],e.prevSelectedNode=null,e.checkedNodes=[],e.groupedNodes={},e.visibleNodesFlat=[],e.visibleNodesMap={},e._addWidgetProperties(["menus","keyStrokes"]),e._additionalContainerClasses="",e._filters=[],e._doubleClickSupport=new Yt,e._$animationWrapper=null,e._$expandAnimationWrappers=[],e._filterMenusHandler=e._filterMenus.bind(zH(e)),e._popupOpenHandler=e._onDesktopPopupOpen.bind(zH(e)),e._inSelectionPathList={},e.viewRangeRendered=new Fr(0,0),e.viewRangeSize=20,e.startAnimationFunc=function(){this.runningAnimations++}.bind(zH(e)),e.runningAnimations=0,e.runningAnimationsFinishFunc=function(){this.runningAnimations--,this.runningAnimations<=0&&(this.runningAnimations=0,this._renderViewportBlocked=!1,this.invalidateLayoutTree())}.bind(zH(e)),e.nodeHeight=0,e.nodeWidth=0,e.maxNodeWidth=0,e.nodeWidthDirty=!1,e.$data=null,e._scrolldirections="both",e.requestFocusOnNodeControlMouseDown=!0,e._$mouseDownNode=null,e}return t=i,r=[{key:"collectSubtree",value:function(e,t){if(!e)return s()();for(var n=parseFloat(e.attr("data-level")),r=e.next();r.length>0;){var o=parseFloat(r.attr("data-level"));if(isNaN(o)||o<=n)break;r=r.next()}var i=e.nextUntil(r);return(void 0===t||t)&&(i=i.add(e)),i}},{key:"visitNodes",value:function(e,t,n){var r,o;if(t)for(r=0;r<t.length;r++)!e(o=t[r],n)&&o.childNodes.length>0&&i.visitNodes(e,o.childNodes,o)}}],(n=[{key:"_init",value:function(e){HH(GH(i.prototype),"_init",this).call(this,e),this.addFilter(new hN(this),!0),this.breadcrumbFilter=new dN(this),this.displayStyle===i.DisplayStyle.BREADCRUMB&&this.addFilter(this.breadcrumbFilter,!0,!0),this.initialTraversing=!0,this._setCheckable(this.checkable),this._ensureTreeNodes(this.nodes),this.visitNodes(this._initTreeNode.bind(this)),this.visitNodes(this._updateFlatListAndSelectionPath.bind(this)),this.initialTraversing=!1,this.selectedNodes=this._nodesByIds(this.selectedNodes),this.menuBar=O.create("MenuBar",{parent:this,position:Yw.Position.BOTTOM,menuOrder:new Ag(this.session,"Tree"),menuFilter:this._filterMenusHandler}),this._updateItemPath(!0),this._setDisplayStyle(this.displayStyle),this._setKeyStrokes(this.keyStrokes),this._setMenus(this.menus)}},{key:"_ensureTreeNodes",value:function(e){var t,n;for(t=0;t<e.length;t++)(n=e[t]).childNodeIndex=O.nvl(n.childNodeIndex,t),n instanceof rN||(e[t]=this._createTreeNode(n))}},{key:"_createTreeNode",value:function(e){return(e=O.nvl(e,{})).parent=this,O.create("TreeNode",e)}},{key:"_createKeyStrokeContext",value:function(){return new $u}},{key:"_initKeyStrokeContext",value:function(){HH(GH(i.prototype),"_initKeyStrokeContext",this).call(this),this._initTreeKeyStrokeContext()}},{key:"_initTreeKeyStrokeContext",value:function(){var e=Ru.NONE;this.keyStrokeContext.registerKeyStroke([new EN(this),new IN(this,e),new UN(this,e),new lV(this,e),new vV(this,e),new eV(this,e),new TV(this,e)])}},{key:"_setMenus",value:function(e){this.updateKeyStrokes(e,this.menus),this._setProperty("menus",e),this._updateMenuBar()}},{key:"_updateMenuBar",value:function(){var e=this._filterMenus(this.menus,Gm.MENU_BAR,!1,!0);this.menuBar.setMenuItems(e);var t=this._filterMenus(this.menus,Gm.CONTEXT_MENU,!0);this.contextMenu&&this.contextMenu.updateMenuItems(t)}},{key:"_setKeyStrokes",value:function(e){this.updateKeyStrokes(e,this.keyStrokes),this._setProperty("keyStrokes",e)}},{key:"_resetTreeNode",value:function(e,t){e.reset()}},{key:"isSelectedNode",value:function(e){return this.initialTraversing?this.selectedNodes.indexOf(e.id)>-1:this.selectedNodes.indexOf(e)>-1}},{key:"_updateFlatListAndSelectionPath",value:function(e,t){if(this.isSelectedNode(e)&&(e.parentNode&&!this.visibleNodesMap[e.parentNode.id]||0===e.level))for(var n=e;n;)this._inSelectionPathList[n.id]=!0,n.filterDirty=!0,n!==e&&(e.expanded=!0,0===n.level&&(this._applyFiltersForNode(n),this._addToVisibleFlatList(n,!1),this._addChildrenToFlatList(n,this.visibleNodesFlat.length-1,!1,null,!0))),n=n.parentNode;else e.parentNode&&this.isSelectedNode(e.parentNode)&&(this._inSelectionPathList[e.id]=!0);this._applyFiltersForNode(e),this._addToVisibleFlatList(e,!1)}},{key:"_initTreeNode",value:function(e,t){this.nodesMap[e.id]=e,t&&(e.parentNode=t,e.level=e.parentNode.level+1),e.checked&&this.checkedNodes.push(e),this._initTreeNodeInternal(e,t),this._updateMarkChildrenChecked(e,!0,e.checked),e.initialized=!0}},{key:"_applyNodeDefaultValues",value:function(e){Mt.applyTo(e,"TreeNode")}},{key:"_initTreeNodeInternal",value:function(e,t){this._applyNodeDefaultValues(e)}},{key:"_destroy",value:function(){HH(GH(i.prototype),"_destroy",this).call(this),this.visitNodes(this._destroyTreeNode.bind(this)),this.nodes=[]}},{key:"_destroyTreeNode",value:function(e){delete this.nodesMap[e.id],this._removeFromFlatList(e,!1),e.destroy(),this._onNodeDeleted&&this._onNodeDeleted(e)}},{key:"visitNodes",value:function(e,t){return i.visitNodes(e,this.nodes,t)}},{key:"_render",value:function(){this.$container=this.$parent.appendDiv("tree"),this._additionalContainerClasses&&this.$container.addClass(this._additionalContainerClasses);var e=new cN(this);this.htmlComp=ea.install(this.$container,this.session),this.htmlComp.setLayout(e),this._renderData(),this.menuBar.render(),this.session.desktop.on("popupOpen",this._popupOpenHandler),this._renderCheckableStyle()}},{key:"_renderData",value:function(){this.$data=this.$container.appendDiv("tree-data").on("contextmenu",this._onContextMenu.bind(this)).on("mousedown",".tree-node",this._onNodeMouseDown.bind(this)).on("mouseup",".tree-node",this._onNodeMouseUp.bind(this)).on("dblclick",".tree-node",this._onNodeDoubleClick.bind(this)).on("mousedown",".tree-node-control",this._onNodeControlMouseDown.bind(this)).on("mouseup",".tree-node-control",this._onNodeControlMouseUp.bind(this)).on("dblclick",".tree-node-control",this._onNodeControlDoubleClick.bind(this)),ea.install(this.$data,this.session),this.isHorizontalScrollingEnabled()&&this.$data.toggleClass("scrollable-tree",!0),this._installScrollbars({axis:this._scrolldirections}),this._installNodeTooltipSupport(),this._updateNodeDimensions(),this._renderDisplayStyle(),this._renderViewport()}},{key:"_postRender",value:function(){HH(GH(i.prototype),"_postRender",this).call(this),this._renderSelection()}},{key:"_remove",value:function(){this.session.desktop.off("popupOpen",this._popupOpenHandler),this._$animationWrapper&&this._$animationWrapper.stop(!1,!0),this.visitNodes(this._resetTreeNode.bind(this)),this._uninstallDragAndDropHandler(),this._uninstallNodeTooltipSupport(),this.$fillBefore=null,this.$fillAfter=null,this.$data=null,this.viewRangeRendered=new Fr(0,0),HH(GH(i.prototype),"_remove",this).call(this)}},{key:"isHorizontalScrollingEnabled",value:function(){return"both"===this._scrolldirections||"x"===this._scrolldirections}},{key:"isTreeNodeCheckEnabled",value:function(){return this.checkableStyle===i.CheckableStyle.CHECKBOX_TREE_NODE}},{key:"_onScroll",value:function(){var e=this.scrollToSelection;this.scrollToSelection=!1;var t=this.$data[0].scrollTop,n=this.$data[0].scrollLeft;this.scrollTop!==t&&this._renderViewport(),this.scrollTop=t,this.scrollLeft=n,this.scrollToSelection=e}},{key:"setScrollTop",value:function(e){this.setProperty("scrollTop",e),this.rendered&&(this._renderViewport(),this._renderScrollTop())}},{key:"_renderScrollTop",value:function(){this.rendering||Lh.scrollTop(this.$data,this.scrollTop)}},{key:"get$Scrollable",value:function(){return this.$data}},{key:"_renderViewport",value:function(){if(!(this.runningAnimations>0||this._renderViewportBlocked)&&this.$container.isEveryParentVisible()){var e=this._calculateCurrentViewRange();this._renderViewRange(e)}}},{key:"_calculateCurrentViewRange",value:function(){var e,t=this.$data[0].scrollTop;return e=0==this.$data[0].scrollHeight-this.$data[0].clientHeight&&this.visibleNodesFlat.length>0?this.visibleNodesFlat[0]:this._nodeAtScrollTop(t),this._calculateViewRangeForNode(e)}},{key:"_rerenderViewport",value:function(){this._renderViewportBlocked||(this._removeRenderedNodes(),this._renderFiller(),this._updateDomNodeWidth(),this._renderViewport())}},{key:"_removeRenderedNodes",value:function(){var e=this;this.$data.find(".tree-node").each((function(t,n){var r=s()(n),o=r.data("node");r.hasClass("hiding")||e._removeNode(o)})),this.viewRangeRendered=new Fr(0,0)}},{key:"_renderViewRangeForNode",value:function(e){var t=this._calculateViewRangeForNode(e);this._renderViewRange(t)}},{key:"_renderNodesInRange",value:function(e){var t=this.visibleNodesFlat;if(0!==t.length){if(e=new Fr(0,t.length).intersect(e),this.viewRangeRendered.size()>0&&!e.intersect(this.viewRangeRendered).equals(new Fr(0,0)))throw new Error("New range must not intersect with existing.");e.to,this.viewRangeRendered.from;var n=this.viewRangeRendered.union(e);if(2===n.length)throw new Error("Can only prepend or append rows to the existing range. Existing: "+this.viewRangeRendered+". New: "+n);this.viewRangeRendered=n[0];var r=this.ensureRangeVisible(e);s.a.log.isTraceEnabled()&&s.a.log.trace(r+" new nodes rendered from "+e)}}},{key:"ensureRangeVisible",value:function(e){for(var t=this.visibleNodesFlat,n=[],r=e.from;r<e.to;r++){var o=t[r];o.attached||n.push(o)}return this._insertNodesInDOM(n),n.length}},{key:"_renderFiller",value:function(){this.$fillBefore||(this.$fillBefore=this.$data.prependDiv("tree-data-fill"));var e,t=this._calculateFillerDimension(new Fr(0,this.viewRangeRendered.from));this.$fillBefore.cssHeight(t.height),this.isHorizontalScrollingEnabled()&&(this.$fillBefore.cssWidth(t.width),this.maxNodeWidth=Math.max(t.width,this.maxNodeWidth)),s.a.log.isTraceEnabled()&&s.a.log.trace("FillBefore height: "+t.height),this.$fillAfter||(this.$fillAfter=this.$data.appendDiv("tree-data-fill")),e=this._calculateFillerDimension(new Fr(this.viewRangeRendered.to,this.visibleNodesFlat.length)),this.$fillAfter.cssHeight(e.height),this.isHorizontalScrollingEnabled()&&(this.$fillAfter.cssWidth(e.width),this.maxNodeWidth=Math.max(e.width,this.maxNodeWidth)),s.a.log.isTraceEnabled()&&s.a.log.trace("FillAfter height: "+e.height)}},{key:"_calculateFillerDimension",value:function(e){var t=0;this.rendered&&(t=this.$data.outerWidth());for(var n={height:0,width:Math.max(t,this.maxNodeWidth)},r=e.from;r<e.to;r++){var o=this.visibleNodesFlat[r];n.height+=this._heightForNode(o),n.width=Math.max(n.width,this._widthForNode(o))}return n}},{key:"_removeNodesInRange",value:function(e){var t,n,r=0,o=this.visibleNodesFlat;o[(e=new Fr(0,o.length).intersect(e)).from],o[e.to];var i=this.viewRangeRendered.subtract(e);if(2===i.length)throw new Error("Can only remove nodes at the beginning or end of the existing range. "+this.viewRangeRendered+". New: "+i);for(this.viewRangeRendered=i[0],n=e.from;n<e.to;n++)t=o[n],this._removeNode(t),r++;s.a.log.isTraceEnabled()&&s.a.log.trace(r+" nodes removed from "+e+".")}},{key:"_removeNode",value:function(e){var t=e.$node;t&&(t.hasClass("hiding")||(t.detach(),e.attached=!1))}},{key:"_renderViewRange",value:function(e){var t=this;if(e.from!==this.viewRangeRendered.from||e.to!==this.viewRangeRendered.to||this.viewRangeDirty){if(this.viewRangeDirty)this.viewRangeRendered=e,this.ensureRangeVisible(e);else{var n=e.subtract(this.viewRangeRendered),r=this.viewRangeRendered.subtract(e),o=new Fr(0,this.visibleNodesFlat.length);r.forEach((function(n){t._removeNodesInRange(n),o.to<n.to&&(t.viewRangeRendered=e)})),n.forEach((function(e){t._renderNodesInRange(e)}))}if(this.viewRangeRendered.size()>0){var i=this.visibleNodesFlat,s=i[this.viewRangeRendered.from],a=i[this.viewRangeRendered.to-1];if(this.viewRangeDirty){var l=s.$node.prevAll(".tree-node"),u=a.$node.nextAll(".tree-node");this._cleanupNodes(l),this._cleanupNodes(u)}if(!s.attached||!a.attached)throw new Error("Nodes not rendered as expected. "+this.viewRangeRendered+". First: "+s.$node+". Last: "+a.$node)}this._postRenderViewRange(),this.viewRangeDirty=!1}else this.nodeWidthDirty&&(this._renderFiller(),this._updateDomNodeWidth())}},{key:"_postRenderViewRange",value:function(){this._renderFiller(),this._updateDomNodeWidth(),this._renderSelection()}},{key:"_visibleNodesInViewRange",value:function(){return this.visibleNodesFlat.slice(this.viewRangeRendered.from,this.viewRangeRendered.to)}},{key:"_updateDomNodeWidth",value:function(){if(this.isHorizontalScrollingEnabled()&&this.rendered&&this.nodeWidthDirty){var e=this._visibleNodesInViewRange(),t=this.maxNodeWidth;t=e.reduce((function(e,t){return Math.max(t.width,e)}),O.nvl(t,0)),e.forEach((function(e){e.$node.cssWidth(t)})),this.nodeWidthDirty=!1}}},{key:"_cleanupNodes",value:function(e){for(var t=0;t<e.length;t++)this._removeNode(e.eq(t).data("node"))}},{key:"_nodeAtScrollTop",value:function(e){var t,n=this,r=0;this.visibleNodesFlat.some((function(o,i){return r+=n._heightForNode(o),e<r&&(t=o,!0)}));var o=this.visibleNodesFlat.length;return!t&&o>0&&(t=this.visibleNodesFlat[o-1]),t}},{key:"_heightForNode",value:function(e){return e.height?e.height:this.nodeHeight}},{key:"_widthForNode",value:function(e){return e.width?e.width:this.nodeWidth}},{key:"_calculateViewRangeForNode",value:function(e){var t=new Fr,n=Math.floor(this.viewRangeSize/i.VIEW_RANGE_DIVISOR),r=this.visibleNodesFlat.indexOf(e);return t.from=Math.max(r-n,0),t.to=Math.min(t.from+this.viewRangeSize,this.visibleNodesFlat.length),e&&-1!==r?(this.viewRangeSize-t.size()>0&&(t.from=Math.max(t.to-this.viewRangeSize,0)),t):t}},{key:"calculateViewRangeSize",value:function(){if(this._updateNodeDimensions(),0===this.nodeHeight)throw new Error("Cannot calculate view range with nodeHeight = 0");var e=i.VIEW_RANGE_DIVISOR/2,t=Math.ceil(this.$data.outerHeight()/this.nodeHeight)*e;return Math.max(i.VIEW_RANGE_DIVISOR,t)}},{key:"setViewRangeSize",value:function(e){this.viewRangeSize!==e&&(this._setProperty("viewRangeSize",e),this.rendered&&this._renderViewport())}},{key:"_updateNodeDimensions",value:function(){var e=this._createTreeNode(),t=this._renderNode(e).appendTo(this.$data);if(this.nodeHeight=t.outerHeight(!0),this.isHorizontalScrollingEnabled()){var n=this.nodeWidth;this.nodeWidth=t.outerWidth(!0),n!==this.nodeWidth&&(this.viewRangeDirty=!0)}e.reset()}},{key:"updateNodeHeights",value:function(){this.visibleNodesFlat.forEach((function(e){e.attached?e.height=e.$node.outerHeight(!0):e.height=null}))}},{key:"removeAllNodes",value:function(){this._removeNodes(this.nodes)}},{key:"_removeNodes",value:function(e,t){0!==e.length&&(e.forEach((function(e){this._removeFromFlatList(e,!0),e.childNodes.length>0&&this._removeNodes(e.childNodes,e),e.$node&&(this._$animationWrapper&&this._$animationWrapper.find(e.$node).length>0&&this._$animationWrapper.stop(!1,!0),e.reset())}),this),rt.ensure(t).forEach((function(e){e&&e.$node&&0===e.childNodes.length&&e.$node.removeClass("expanded lazy")})),this.rendered&&(this.viewRangeDirty=!0,this.invalidateLayoutTree()))}},{key:"_renderNode",value:function(e){var t=this._computeNodePaddingLeft(e);return e.render(this.$container,t,this.checkable,this.enabledComputed),e.$node}},{key:"_removeMenus",value:function(){}},{key:"_filterMenus",value:function(e,t,n,r){return zm.filterAccordingToSelection("Tree",this.selectedNodes.length,e,t,n,r)}},{key:"_renderEnabled",value:function(){HH(GH(i.prototype),"_renderEnabled",this).call(this),this._installOrUninstallDragAndDropHandler();var e=this.enabledComputed;this.$data.setEnabled(e),this.$container.setTabbable(e),this.rendered&&this.$nodes().each((function(){var t=s()(this),n=t.data("node");t.children(".tree-node-checkbox").children(".check-box").toggleClass("disabled",!(e&&n.enabled))}))}},{key:"_renderDisabledStyle",value:function(){HH(GH(i.prototype),"_renderDisabledStyle",this).call(this),this._renderDisabledStyleInternal(this.$data)}},{key:"setCheckable",value:function(e){this.setProperty("checkable",e)}},{key:"_setCheckable",value:function(e){this._setProperty("checkable",e),this.checkable?this.nodePaddingLevel=this.nodePaddingLevelCheckable:this.nodePaddingLevel=this.nodePaddingLevelNotCheckable}},{key:"setCheckableStyle",value:function(e){this.setProperty("checkableStyle",e)}},{key:"_renderCheckable",value:function(){var e=this,t=function(e){return Boolean(e.$node)};this.nodes.filter(t).forEach((function n(r){var o=r.$node,i=o.children(".tree-node-control"),s=o.children(".tree-node-checkbox");r._updateControl(i,e),e.checkable?0===s.length&&r._renderCheckbox():s.remove(),o.css("padding-left",e._computeNodePaddingLeft(r)),r.childNodes&&r.childNodes.filter(t).forEach(n)}))}},{key:"_renderDisplayStyle",value:function(){this.$container.toggleClass("breadcrumb",this.isBreadcrumbStyleActive()),this._updateNodePaddingsLeft(),this.invalidateLayoutTree()}},{key:"_renderExpansion",value:function(e,t){var n={expandLazyChanged:!1,expansionChanged:!1};s.a.extend(n,t);var r=e.$node,o=e.expanded;if(r&&0!==r.length){if(0===e.childNodes.length)return!0;r.toggleClass("lazy",o&&e.expandedLazy),(n.expansionChanged||n.expandLazyChanged)&&(o?r.addClass("expanded"):r.removeClass("expanded"))}}},{key:"_renderSelection",value:function(){0===this.selectedNodes.length&&this.nodes.forEach((function(e){e.rendered&&e.$node.addClass("child-of-selected")}),this),this.selectedNodes.forEach((function(e){if(this.visibleNodesMap[e.id]){var t=e.parentNode;for(t&&t.rendered&&t.$node.addClass("parent-of-selected");t;)t.rendered&&t.$node.addClass("ancestor-of-selected"),t=t.parentNode;e.expanded&&e.childNodes.forEach((function(e){e.rendered&&e.$node.addClass("child-of-selected")}),this),e.rendered&&e.$node.select(!0)}}),this);for(var e=this.viewRangeRendered.from;e<this.viewRangeRendered.to&&!(e>=this.visibleNodesFlat.length);e++){var t=this.visibleNodesFlat[e];t&&t.rendered&&t.$node.toggleClass("group",Boolean(this.groupedNodes[t.id]))}this._updateNodePaddingsLeft(),this._highlightPrevSelectedNode(),this.scrollToSelection&&this.revealSelection()}},{key:"_renderCheckableStyle",value:function(){this.$data.toggleClass("checkable",this.isTreeNodeCheckEnabled())}},{key:"_highlightPrevSelectedNode",value:function(){var e=this;if(this.isBreadcrumbStyleActive()&&this.prevSelectedNode&&this.prevSelectedNode.rendered&&!this.prevSelectedNode.prevSelectionAnimationDone)return this.prevSelectedNode.$node.hasClass("animate-prev-selected")?this:void this.prevSelectedNode.$node.addClassForAnimation("animate-prev-selected").oneAnimationEnd((function(){e.prevSelectedNode.prevSelectionAnimationDone=!0}))}},{key:"_removeSelection",value:function(){0===this.selectedNodes.length&&this.nodes.forEach((function(e){e.rendered&&e.$node.removeClass("child-of-selected")}),this),this.prevSelectedNode&&this.prevSelectedNode.rendered&&this.prevSelectedNode.$node.removeClass("animate-prev-selected"),this.selectedNodes.forEach(this._removeNodeSelection,this)}},{key:"_removeNodeSelection",value:function(e){e.rendered&&e.$node.select(!1);var t=e.parentNode;for(t&&t.rendered&&t.$node.removeClass("parent-of-selected");t&&t.rendered;)t.$node.removeClass("ancestor-of-selected"),t=t.parentNode;e.expanded&&e.childNodes.forEach((function(e){e.rendered&&e.$node.removeClass("child-of-selected")}),this)}},{key:"setDropType",value:function(e){this.setProperty("dropType",e)}},{key:"_renderDropType",value:function(){this._installOrUninstallDragAndDropHandler()}},{key:"setDropMaximumSize",value:function(e){this.setProperty("dropMaximumSize",e)}},{key:"_createDragAndDropHandler",value:function(){var e=this;return rn.handler(this,{supportedScoutTypes:rn.SCOUT_TYPES.FILE_TRANSFER,onDrop:function(t){return e.trigger("drop",t)},dropType:function(){return e.dropType},dropMaximumSize:function(){return e.dropMaximumSize},additionalDropProperties:function(e){var t=s()(e.currentTarget),n={nodeId:""};if(t.hasClass("tree-node")){var r=t.data("node");n.nodeId=r.id}return n}})}},{key:"_installOrUninstallDragAndDropHandler",value:function(){this.dropType&&this.enabledComputed?this._installDragAndDropHandler():this._uninstallDragAndDropHandler()}},{key:"_installDragAndDropHandler",value:function(){this.dragAndDropHandler||(this.dragAndDropHandler=this._createDragAndDropHandler(),this.dragAndDropHandler&&this.dragAndDropHandler.install(this.$container,".tree-data,.tree-node"))}},{key:"_uninstallDragAndDropHandler",value:function(){this.dragAndDropHandler&&(this.dragAndDropHandler.uninstall(),this.dragAndDropHandler=null)}},{key:"_updateMarkChildrenChecked",value:function(e,t,n,r){if(this.checkable){if(r){for(var o=!1,i=0;i<e.childNodes.length>0;i++){var s=e.childNodes[i];if(s.checked||s.childrenChecked){e.childrenChecked=!0,n=!0,o=!0,this.rendered&&e.$node&&e.$node.children(".tree-node-checkbox").children(".check-box").toggleClass("children-checked",!0);break}}o||(e.childrenChecked=!1,this.rendered&&e.$node&&e.$node.children(".tree-node-checkbox").children(".check-box").toggleClass("children-checked",!1))}if(e.parentNode&&!e.parentNode.checked){var a=!1;if(!n&&!t){for(var l=!1,u=0;u<e.parentNode.childNodes.length>0;u++){var c=e.parentNode.childNodes[u];if(c.checked||c.childrenChecked){l=!0;break}}l!==e.parentNode.childrenChecked&&(e.parentNode.childrenChecked=l,a=!0)}n&&!e.parentNode.childrenChecked&&(e.parentNode.childrenChecked=!0,a=!0),a&&(this._updateMarkChildrenChecked(e.parentNode,t,n),this.rendered&&e.parentNode.$node&&(n?e.parentNode.$node.children(".tree-node-checkbox").children(".check-box").toggleClass("children-checked",!0):e.parentNode.$node.children(".tree-node-checkbox").children(".check-box").toggleClass("children-checked",!1)))}}}},{key:"_installNodeTooltipSupport",value:function(){xp.install(this.$data,{parent:this,selector:".tree-node",text:this._nodeTooltipText.bind(this),arrowPosition:50,arrowPositionUnit:"%",nativeTooltip:!Kt.get().isCustomEllipsisTooltipPossible()})}},{key:"_uninstallNodeTooltipSupport",value:function(){xp.uninstall(this.$data)}},{key:"_nodeTooltipText",value:function(e){var t=e.data("node");return t.tooltipText?t.tooltipText:this._isTruncatedNodeTooltipEnabled()&&e.isContentTruncated()?t.$text.text():void 0}},{key:"_isTruncatedNodeTooltipEnabled",value:function(){return!0}},{key:"setDisplayStyle",value:function(e){this.displayStyle!==e&&(this._renderViewportBlocked=!0,this._setDisplayStyle(e),this.rendered&&this._renderDisplayStyle(),this._renderViewportBlocked=!1)}},{key:"_setDisplayStyle",value:function(e){if(this._setProperty("displayStyle",e),this.displayStyle===i.DisplayStyle.BREADCRUMB){if(this.selectedNodes.length>0){var t=this.selectedNodes[0];t.expanded||this.expandNode(t)}this.addFilter(this.breadcrumbFilter,!0,!0),this.filterVisibleNodes()}else this.removeFilter(this.breadcrumbFilter,!0),this.filter()}},{key:"_updateNodePaddingsLeft",value:function(){var e=this;this.$nodes().each((function(t,n){var r=s()(n),o=r.data("node"),i=e._computeNodePaddingLeft(o);r.css("padding-left",Pr.isNullOrUndefined(i)?"":i)}))}},{key:"setBreadcrumbStyleActive",value:function(e){e?this.setDisplayStyle(i.DisplayStyle.BREADCRUMB):this.setDisplayStyle(i.DisplayStyle.DEFAULT)}},{key:"isNodeInBreadcrumbVisible",value:function(e){return void 0!==this._inSelectionPathList[e.id]&&this._inSelectionPathList[e.id]}},{key:"isBreadcrumbStyleActive",value:function(){return this.displayStyle===i.DisplayStyle.BREADCRUMB}},{key:"setToggleBreadcrumbStyleEnabled",value:function(e){this.setProperty("toggleBreadcrumbStyleEnabled",e)}},{key:"setBreadcrumbTogglingThreshold",value:function(e){this.setProperty("breadcrumbTogglingThreshold",e)}},{key:"expandNode",value:function(e,t){this.setNodeExpanded(e,!0,t)}},{key:"collapseNode",value:function(e,t){this.setNodeExpanded(e,!1,t)}},{key:"collapseAll",value:function(){var e=this;this.rebuildSuppressed=!0,this.visitNodes((function(t){e.collapseNode(t)})),this.rendered&&this._rerenderViewport(),this.rebuildSuppressed=!1}},{key:"setNodeExpanded",value:function(e,t,n){var r=this,o=(n=n||{}).lazy;Pr.isNullOrUndefined(o)&&(o=e.expanded===t?e.expandedLazy:!!t&&e.lazyExpandingEnabled);var i=O.nvl(n.renderAnimated,!0);if(this.lazyExpandingEnabled||(o=!1),this.isBreadcrumbStyleActive()&&!t&&this.selectedNodes.indexOf(e)>-1)this.setNodeExpanded(e,!0,n);else{if(n.collapseChildNodes){var s=Pr.valueCopy(n);s.renderExpansion=!1,e.childNodes.forEach((function(e){e.expanded&&r.collapseNode(e,s)}))}var a={expansionChanged:!1,expandLazyChanged:!1};e.expanded===t&&e.expandedLazy===o||(a.expansionChanged=e.expanded!==t,a.expandLazyChanged=e.expandedLazy!==o,e.expanded=t,e.expandedLazy=o,this._applyFiltersForNode(e)&&a.expansionChanged?e.parentNode?this._rebuildParent(e.parentNode,n):e.filterAccepted?this._addToVisibleFlatList(e,!1):this._removeFromFlatList(e,!1):a.expandLazyChanged&&e.childNodes.forEach((function(e){r._applyFiltersForNode(e)})),this.groupedNodes[e.id]&&this._updateItemPath(!1,e),e.expanded?e.ensureLoadChildren().done(this._addChildrenToFlatList.bind(this,e,null,i,null,!0)):this._removeChildrenFromFlatList(e,i),this.trigger("nodeExpanded",{node:e,expanded:t,expandedLazy:o}),this.viewRangeDirty=!0),this.rendered&&O.nvl(n.renderExpansion,!0)&&this._renderExpansion(e,a),this.rendered&&this.ensureExpansionVisible(e)}}},{key:"setNodeExpandedRecursive",value:function(e,t,n){var r=this;i.visitNodes((function(e){r.setNodeExpanded(e,t,n)}),e)}},{key:"_rebuildParent",value:function(e,t){!this.rebuildSuppressed&&(e.expanded||e.expandedLazy?this._addChildrenToFlatList(e,null,!1,null,!0):this._removeChildrenFromFlatList(e,!1),this.rendered&&O.nvl(t.renderExpansion,!0))&&this._renderExpansion(e,{expansionChanged:!0})}},{key:"_removeChildrenFromFlatList",value:function(e,t){if(this.visibleNodesMap[e.id]){var n=this.visibleNodesFlat.indexOf(e),r=0,o=e.level,i=[];t=t&&this.rendered,this._$animationWrapper&&this._$animationWrapper.stop(!1,!0),this._$expandAnimationWrappers.forEach((function(e){e.stop(!1,!0)}));for(var a=n+1;a<this.visibleNodesFlat.length&&this.visibleNodesFlat[a].level>o;a++){var l=this.visibleNodesFlat[a];this.isHorizontalScrollingEnabled()&&l.width===this.maxNodeWidth&&(this.maxNodeWidth=0,this.nodeWidthDirty=!0),delete this.visibleNodesMap[this.visibleNodesFlat[a].id],l.attached&&t?(this._$animationWrapper||(this._$animationWrapper=s()('<div class="animation-wrapper">').insertBefore(l.$node),this._$animationWrapper.data("parentNode",e)),l.isDescendantOf(this._$animationWrapper.data("parentNode"))&&this._$animationWrapper.append(l.$node),l.attached=!1,l.displayBackup=l.$node.css("display"),i.push(l)):l.attached&&!t&&this.hideNode(l,!1,!1),r++}return this.visibleNodesFlat.splice(n+1,r),t&&(this._renderViewportBlocked=!0,i.length>0?this._$animationWrapper.animate({height:0},{start:this.startAnimationFunc,complete:u.bind(this,i),step:this.revalidateLayoutTree.bind(this),duration:200,queue:!1}):this._$animationWrapper?(this._$animationWrapper.remove(),this._$animationWrapper=null,u.call(this,i)):this._renderViewportBlocked=!1),i}function u(e){e.forEach((function(e){e.$node.detach(),e.$node.css("display",e.displayBackup),e.displayBackup=null})),this._$animationWrapper&&(this._$animationWrapper.remove(),this._$animationWrapper=null),this.runningAnimationsFinishFunc()}}},{key:"_removeFromFlatList",value:function(e,t){var n=[];if(this.visibleNodesMap[e.id]){var r=this.visibleNodesFlat.indexOf(e);this._removeChildrenFromFlatList(e,!1),this.isHorizontalScrollingEnabled()&&e.width===this.maxNodeWidth&&(this.maxNodeWidth=0,this.nodeWidthDirty=!0),n=rt.ensure(this.visibleNodesFlat.splice(r,1)),delete this.visibleNodesMap[e.id],this.hideNode(e,t)}return n.push(e),n}},{key:"_addToVisibleFlatList",value:function(e,t){if(!this.visibleNodesMap[e.id]&&e.isFilterAccepted()&&(!e.parentNode||e.parentNode.expanded&&this.visibleNodesMap[e.parentNode.id]))if(this.initialTraversing)this._addToVisibleFlatListNoCheck(e,this.visibleNodesFlat.length,t);else{var n=this._findInsertPositionInFlatList(e);this._addToVisibleFlatListNoCheck(e,n,t)}}},{key:"_addChildrenToFlatList",value:function(e,t,n,r,o){var i=this;if(!this.visibleNodesMap[e.id])return 0;var s=Boolean(r);return t=t||this.visibleNodesFlat.indexOf(e),n=n&&this.rendered,this._$animationWrapper&&!s&&this._$animationWrapper.stop(!1,!0),r?r.setInsertAt(t):r=this.newInsertBatch(t+1),e.childNodes.forEach((function(t,s){var a;t.initialized&&t.isFilterAccepted(o)&&(i.visibleNodesMap[t.id]?(i.insertBatchInVisibleNodes(r,i._showNodes(r),n),i.checkAndHandleBatchAnimationWrapper(e,n,r),r=i.newInsertBatch(r.nextBatchInsertIndex()),r=i._addChildrenToFlatListIfExpanded(1,t,a,n,r,o),n=!1):(r.insertNodes.push(t),i.visibleNodesMap[t.id]=!0,r=i.checkAndHandleBatch(r,e,n),r=i._addChildrenToFlatListIfExpanded(0,t,a,n,r,o)))})),s||(this.insertBatchInVisibleNodes(r,this._showNodes(r),n),this.invalidateLayoutTree()),r}},{key:"_addChildrenToFlatListIfExpanded",value:function(e,t,n,r,o,i){return t.expanded&&t.childNodes.length&&(n=o.containsNode(t.parentNode)||o.length()>1?o.insertAt():this._findInsertPositionInFlatList(t),n+=e,o=this._addChildrenToFlatList(t,n,r,o,i)),o}},{key:"_showNodes",value:function(e){return this.viewRangeRendered.from+this.viewRangeSize>=e.lastBatchInsertIndex()&&this.viewRangeRendered.from<=e.lastBatchInsertIndex()}},{key:"_findInsertPositionInFlatList",value:function(e){var t,n=this,r=e.parentNode;t=r?r.childNodes:this.nodes;var o=e,i=t.filter((function(e){return Boolean(n.visibleNodesMap[e.id])||e===o}));if(0===i.length)return this._findPositionInFlatList(r)+1;var s=i.indexOf(e);if(0===s)return this._findPositionInFlatList(r)+1;var a,l,u=i[s-1],c=this._findPositionInFlatList(u);if(-1===c)return this._findPositionInFlatList(r)+1;for(a=c;a<this.visibleNodesFlat.length;a++)if(l=this.visibleNodesFlat[a],!this._isInSameSubTree(u,l))return a;return this.visibleNodesFlat.length}},{key:"_findPositionInFlatList",value:function(e){return this.visibleNodesFlat.indexOf(e)}},{key:"_isInSameSubTree",value:function(e,t){do{if(t===e||t.parentNode===e)return!0;t=t.parentNode}while(t);return!1}},{key:"_isChildOfSelectedNodes",value:function(e){for(;e;){if(this.selectedNodes.indexOf(e.parentNode)>-1)return!0;e=e.parentNode}return!1}},{key:"newInsertBatch",value:function(e){return{insertNodes:[e,0],$animationWrapper:null,lastBatchInsertIndex:function(){return this.isEmpty()?this.insertAt():this.insertAt()+this.insertNodes.length-3},nextBatchInsertIndex:function(){return this.lastBatchInsertIndex()+(this.isEmpty()?1:2)},isEmpty:function(){return 2===this.insertNodes.length},length:function(){return this.insertNodes.length-2},insertAt:function(){return this.insertNodes[0]},setInsertAt:function(e){this.insertNodes[0]=e},containsNode:function(e){return-1!==this.insertNodes.indexOf(e)}}}},{key:"checkAndHandleBatchAnimationWrapper",value:function(e,t,n){if(t&&this.viewRangeRendered.from<=n.lastBatchInsertIndex()&&this.viewRangeRendered.to>=n.lastBatchInsertIndex()&&!n.$animationWrapper){var r=n.lastBatchInsertIndex()-1,o=this.viewRangeRendered.from===n.lastBatchInsertIndex()?null:this.visibleNodesFlat[r];if(o&&r>=this.viewRangeRendered.from&&r<this.viewRangeRendered.to&&!o.attached&&this.showNode(o,!1,r),o&&o.attached)n.$animationWrapper=s()('<div class="animation-wrapper">').insertAfter(o.$node);else if(e.attached)n.$animationWrapper=s()('<div class="animation-wrapper">').insertAfter(e.$node);else if(this.$fillBefore)n.$animationWrapper=s()('<div class="animation-wrapper">').insertAfter(this.$fillBefore);else{var i=this.visibleNodesFlat[n.lastBatchInsertIndex()];n.$animationWrapper=s()('<div class="animation-wrapper">').insertBefore(i.$node)}n.animationCompleteFunc=function(){n.$animationWrapper.replaceWith(n.$animationWrapper.contents()),rt.remove(this._$expandAnimationWrappers,n.$animationWrapper),n.$animationWrapper=null,this.runningAnimationsFinishFunc()},this._$expandAnimationWrappers.push(n.$animationWrapper)}}},{key:"checkAndHandleBatch",value:function(e,t,n){return this.viewRangeRendered.from-1===e.lastBatchInsertIndex()&&(this.insertBatchInVisibleNodes(e,!1,!1),e=this.newInsertBatch(e.lastBatchInsertIndex()+1)),this.checkAndHandleBatchAnimationWrapper(t,n,e),this.viewRangeRendered.from+this.viewRangeSize-1===e.lastBatchInsertIndex()&&(this.insertBatchInVisibleNodes(e,!0,n),e=this.newInsertBatch(e.lastBatchInsertIndex()+1)),e}},{key:"insertBatchInVisibleNodes",value:function(e,t,n){var r;if(!e.isEmpty())if((r=this.visibleNodesFlat).splice.apply(r,MH(e.insertNodes)),t){for(var o=e.insertAt(),i=2;i<e.insertNodes.length;i++){var s=e.insertNodes[i];this.showNode(s,!1,o),e.$animationWrapper&&e.$animationWrapper.append(s.$node),o++}if(e.$animationWrapper){var a=e.$animationWrapper.outerHeight();e.$animationWrapper.css("height",0).animate({height:a},{start:this.startAnimationFunc,complete:e.animationCompleteFunc.bind(this),step:this.revalidateLayoutTree.bind(this),duration:200,queue:!1})}}else e.$animationWrapper&&e.animationCompleteFunc&&e.animationCompleteFunc.call(this)}},{key:"_addToVisibleFlatListNoCheck",value:function(e,t,n){rt.insert(this.visibleNodesFlat,e,t),this.visibleNodesMap[e.id]=!0,this.rendered&&this.showNode(e,n,t)}},{key:"scrollTo",value:function(e,t){0!==this.viewRangeRendered.size()&&(e.attached||this._renderViewRangeForNode(e),e.attached&&Lh.scrollTo(this.$data,e.$node,t))}},{key:"revealSelection",value:function(){this.rendered?this.selectedNodes.length>0&&(this.visibleNodesMap[this.selectedNodes[0].id]||this._expandAllParentNodes(this.selectedNodes[0]),this.scrollTo(this.selectedNodes[0]),this.ensureExpansionVisible(this.selectedNodes[0])):this.session.layoutValidator.schedulePostValidateFunction(this.revealSelection.bind(this))}},{key:"ensureExpansionVisible",value:function(e){e&&e.$node&&this.selectedNodes[0]===e&&Lh.ensureExpansionVisible({element:e,$element:e.$node,$scrollable:this.get$Scrollable(),isExpanded:function(e){return e.expanded},getChildren:function(e){return e.childNodes},nodePaddingLevel:this.nodePaddingLevel,defaultChildHeight:this.nodeHeight})}},{key:"deselectAll",value:function(){this.selectNodes([])}},{key:"selectNode",value:function(e,t){this.selectNodes(e,t)}},{key:"selectNodes",value:function(e,t){e=rt.ensure(e),rt.equalsIgnoreOrder(e,this.selectedNodes)||(this.rendered&&(this._rememberScrollTopBeforeSelection(),this._removeSelection()),this.prevSelectedNode&&(this.prevSelectedNode.prevSelectionAnimationDone=!1),this.prevSelectedNode=this.selectedNodes[0],this._setSelectedNodes(e,t),this.rendered&&(this._renderSelection(),this._updateScrollTopAfterSelection()))}},{key:"_rememberScrollTopBeforeSelection",value:function(){this.isBreadcrumbStyleActive()?this.selectedNodes.length>0&&(this.scrollTopHistory[this.selectedNodes[0].level]=this.$data[0].scrollTop):this.scrollTopHistory=[]}},{key:"_updateScrollTopAfterSelection",value:function(){if(this.isBreadcrumbStyleActive()){var e=-1;this.selectedNodes.length>0&&(e=this.selectedNodes[0].level),this.scrollTopHistory.splice(e+1);var t=this.scrollTopHistory[e];t>=0&&this.setScrollTop(t)}}},{key:"_setSelectedNodes",value:function(e,t){this.selectedNodes=e.slice(),this._nodesSelectedInternal(),this._triggerNodesSelected(t),this.selectedNodes.length>0&&!this.visibleNodesMap[this.selectedNodes[0].id]&&this._expandAllParentNodes(this.selectedNodes[0]),this._updateItemPath(!0),this.isBreadcrumbStyleActive()&&(this.selectedNodes.length>0&&!this.selectedNodes[0].expanded&&(this.expandNode(this.selectedNodes[0]),this.selectedNodes[0].filterDirty=!0),this.filter(!0)),this.session.onRequestsDone(this._updateMenuBar.bind(this))}},{key:"_nodesSelectedInternal",value:function(e){}},{key:"deselectNode",value:function(e){this.deselectNodes(e)}},{key:"deselectNodes",value:function(e,t){e=rt.ensure(e),(t=t||{}).collectChildren&&(e=e.concat(this._collectNodesIfDescendants(e,this.selectedNodes)));var n=this.selectedNodes.slice();rt.removeAll(n,e)&&this.selectNodes(n)}},{key:"isNodeSelected",value:function(e){return this.selectedNodes.indexOf(e)>-1}},{key:"_computeNodePaddingLeft",value:function(e){if(this._computeNodePaddings(),this.isBreadcrumbStyleActive())return null;var t=e.level*this.nodePaddingLevel+this.nodePaddingLeft;return this.checkable&&(t+=this.nodeCheckBoxPaddingLeft),t}},{key:"_computeNodePaddings",value:function(){if(null===this.nodePaddingLeft||null===this.nodeControlPaddingLeft){var e=this.$data.appendDiv("tree-node"),t=e.appendDiv("tree-node-control");null===this.nodePaddingLeft&&(this.nodePaddingLeft=e.cssPaddingLeft()),null===this.nodeControlPaddingLeft&&(this.nodeControlPaddingLeft=t.cssPaddingLeft()),e.remove()}}},{key:"_expandAllParentNodes",value:function(e){var t,n=e,r=[];n=e;for(var o=[];n.parentNode;)r.push(n.parentNode),this.visibleNodesMap[n.id]||o.push(n),n=n.parentNode;for(t=r.length-1;t>=0;t--)-1!==o.indexOf(r[t])&&this._addToVisibleFlatList(r[t],!1),r[t].expanded||this.expandNode(r[t],{renderExpansion:!1,renderAnimated:!1});this.rendered&&o.length>0&&(this._rerenderViewport(),this.invalidateLayoutTree())}},{key:"_updateChildNodeIndex",value:function(e,t){if(e&&e.length)for(var n=O.nvl(t,0);n<e.length;n++)e[n].childNodeIndex=n}},{key:"insertNode",value:function(e,t){this.insertNodes([e],t)}},{key:"insertNodes",value:function(e,t){var n=this;if(e=rt.ensure(e).slice(),this._ensureTreeNodes(e),t&&!(t instanceof rN))throw new Error("parent has to be a tree node: "+t);e.sort((function(e,t){return e.childNodeIndex-t.childNodeIndex})),t?(t.childNodes&&t.childNodes.length>0?(e.forEach((function(e){t.childNodes.indexOf(e)<0&&rt.insert(t.childNodes,e,e.childNodeIndex)})),this._updateChildNodeIndex(t.childNodes,e[0].childNodeIndex)):e.forEach((function(e){t.childNodes.push(e)})),i.visitNodes(this._initTreeNode.bind(this),e,t),i.visitNodes(this._updateFlatListAndSelectionPath.bind(this),e,t),this.groupedNodes[t.id]&&this._updateItemPath(!1,t),this.rendered&&(this._renderExpansion(t,{expansionChanged:!0}),this.ensureExpansionVisible(t))):(this.nodes&&this.nodes.length>0?(e.forEach((function(e){n.nodes.indexOf(e)<0&&rt.insert(n.nodes,e,e.childNodeIndex)})),this._updateChildNodeIndex(this.nodes,e[0].childNodeIndex)):rt.pushAll(this.nodes,e),i.visitNodes(this._initTreeNode.bind(this),e,t),i.visitNodes(this._updateFlatListAndSelectionPath.bind(this),e,t)),this.rendered&&(this.viewRangeDirty=!0,this.invalidateLayoutTree()),this.trigger("nodesInserted",{nodes:e,parentNode:t})}},{key:"updateNode",value:function(e){this.updateNodes([e])}},{key:"updateNodes",value:function(e){(e=rt.ensure(e)).forEach((function(e){var t,n=this.nodesMap[e.id];e===n?t=!0:(this._applyNodeDefaultValues(e),t=this._applyUpdatedNodeProperties(n,e)),t&&(this._applyFiltersForNode(n)&&(n.isFilterAccepted()?this._addToVisibleFlatList(n,!1):(this._nodesFiltered([n]),this._removeFromFlatList(n,!1))),this._updateItemPath(!1,n.parentNode),this.rendered&&n._decorate())}),this),this.trigger("nodesUpdated",{nodes:e})}},{key:"_applyUpdatedNodeProperties",value:function(e,t){var n=!1;return e.leaf!==t.leaf&&(e.leaf=t.leaf,n=!0),e.enabled!==t.enabled&&(e.enabled=t.enabled,n=!0),e.lazyExpandingEnabled!==t.lazyExpandingEnabled&&(e.lazyExpandingEnabled=t.lazyExpandingEnabled,t.lazyExpandingEnabled&&this.lazyExpandingEnabled||(e.expandedLazy=!1),n=!0),n}},{key:"deleteNode",value:function(e,t){this.deleteNodes([e],t)}},{key:"deleteAllNodes",value:function(){this.deleteAllChildNodes()}},{key:"deleteNodes",value:function(e,t){var n=[],r=[],o=[];(e=rt.ensure(e).slice()).forEach((function(e){var s=t||e.parentNode;if(s){if(e.parentNode!==s)throw new Error("Unexpected parent. Node.parent: "+e.parentNode+", parentNode: "+t);rt.remove(s.childNodes,e),-1===r.indexOf(s)&&r.push(s)}else rt.remove(this.nodes,e),o=this.nodes;this._destroyTreeNode(e),n.push(e),this._updateMarkChildrenChecked(e,!1,!1),i.visitNodes(this._destroyTreeNode.bind(this),e.childNodes)}),this),r.forEach((function(e){this._updateChildNodeIndex(e.childNodes)}),this),this._updateChildNodeIndex(o),this.deselectNodes(n,{collectChildren:!0}),this.uncheckNodes(n,{collectChildren:!0}),this.rendered&&this._removeNodes(n,t||r),this.trigger("nodesDeleted",{nodes:e,parentNode:t})}},{key:"_collectNodesIfDescendants",value:function(e,t){var n=[];return t.forEach((function(t){e.some((function(e){return e.isAncestorOf(t)}))&&n.push(t)})),n}},{key:"deleteAllChildNodes",value:function(e){var t;e?(t=e.childNodes,e.childNodes=[]):(t=this.nodes,this.nodes=[]),i.visitNodes(function(e){this._destroyTreeNode(e),this._updateMarkChildrenChecked(e,!1,!1)}.bind(this),t),this.deselectNodes(t,{collectChildren:!0}),this.uncheckNodes(t,{collectChildren:!0}),this.rendered&&this._removeNodes(t,e),this.trigger("allChildNodesDeleted",{parentNode:e})}},{key:"updateNodeOrder",value:function(e,t){if(e=rt.ensure(e),this._updateChildNodeIndex(e),t){if(t.childNodes.length!==e.length)throw new Error("Node order may not be updated because lengths of the arrays differ.");t.childNodes=e.slice(),this._removeChildrenFromFlatList(t,!1),t.expanded&&this._addChildrenToFlatList(t,null,!1)}else{if(this.nodes.length!==e.length)throw new Error("Node order may not be updated because lengths of the arrays differ.");this.nodes=e.slice(),this.nodes.forEach((function(e){this._removeFromFlatList(e,!1),this._addToVisibleFlatList(e,!1),e.expanded&&this._addChildrenToFlatList(e,null,!1)}),this)}this.trigger("childNodeOrderChanged",{parentNode:t})}},{key:"checkNode",value:function(e,t,n){var r=s.a.extend(n,{checked:t});this.checkNodes([e],r)}},{key:"checkNodes",value:function(e,t){var n={checked:!0,checkOnlyEnabled:!0,checkChildren:this.autoCheckChildren,triggerNodesChecked:!0};s.a.extend(n,t);var r=[];!this.checkable||!this.enabledComputed&&n.checkOnlyEnabled||((e=rt.ensure(e)).forEach((function(e){if(!e.enabled&&n.checkOnlyEnabled||e.checked===n.checked)n.checkChildren&&this.checkNodes(e.childNodes,n);else{if(!this.multiCheck&&n.checked){for(var t=0;t<this.checkedNodes.length;t++)this.checkedNodes[t].checked=!1,this._updateMarkChildrenChecked(this.checkedNodes[t],!1,!1,!0),r.push(this.checkedNodes[t]);this.checkedNodes=[]}if(e.checked=n.checked,e.checked?this.checkedNodes.push(e):rt.remove(this.checkedNodes,e),r.push(e),this._updateMarkChildrenChecked(e,!1,n.checked,!0),n.checkChildren){var o=s.a.extend({},n,{triggerNodesChecked:!1});this.checkNodes(e.childNodes,o)}}}),this),n.triggerNodesChecked&&r.length>0&&this.trigger("nodesChecked",{nodes:r}),this.rendered&&r.forEach((function(e){e._renderChecked()})))}},{key:"uncheckNode",value:function(e,t){var n=s.a.extend({checkOnlyEnabled:!0},t);this.uncheckNodes([e],n)}},{key:"uncheckNodes",value:function(e,t){var n={checked:!1};s.a.extend(n,t),n.collectChildren&&(e=e.concat(this._collectNodesIfDescendants(e,this.checkedNodes))),this.checkNodes(e,n)}},{key:"_triggerNodesSelected",value:function(e){this.trigger("nodesSelected",{debounce:e})}},{key:"_showContextMenu",value:function(e){this.session.onRequestsDone(function(e){if(this.rendered){var t=this._filterMenus(this.menus,Gm.CONTEXT_MENU,!0),n=s()(e.currentTarget);0!==t.length&&(this.contextMenu&&this.contextMenu.close(),this.contextMenu=O.create("ContextMenuPopup",{parent:this,menuItems:t,location:{x:e.pageX,y:e.pageY},$anchor:n,menuFilter:this._filterMenusHandler}),this.contextMenu.open())}}.bind(this),e)}},{key:"_onNodeMouseDown",value:function(e){var t=this;if(this._doubleClickSupport.mousedown(e),this._doubleClickSupport.doubleClicked())return!1;var n=s()(e.currentTarget),r=n.data("node");return this.hasNode(r)?(this._$mouseDownNode=n,n.window().one("mouseup",(function(){t._$mouseDownNode=null})),this.selectNodes(r),this.checkable&&r.enabled&&this._isCheckboxClicked(e)&&(Kt.get().loosesFocusIfPseudoElementIsRemoved()&&this.focusAndPreventDefault(e),this.checkNode(r,!r.checked)),!0):void 0}},{key:"_onNodeMouseUp",value:function(e){if(this._doubleClickSupport.doubleClicked())return!1;var t=s()(e.currentTarget),n=t.data("node");return this._$mouseDownNode&&this._$mouseDownNode[0]===t[0]?(this.trigger("nodeClick",{node:n}),!0):void 0}},{key:"_isCheckboxClicked",value:function(e){return!!this.isTreeNodeCheckEnabled()||s()(e.target).is(".check-box")}},{key:"_updateItemPath",value:function(e,t){var n,r,o=this;if(e&&(this.groupedNodes={},this._inSelectionPathList={}),!t){if(0===(n=this.selectedNodes).length)return;for(r=n[0],e&&(this._inSelectionPathList[r.id]=!0,r.childNodes&&r.childNodes.forEach((function(e){o._inSelectionPathList[e.id]=!0}))),r.level;r.parentNode;){var i=r.parentNode;if(this._isGroupingEnd(i)&&!t&&(t=r,!e))break;e&&(this._inSelectionPathList[i.id]=!0),r=i}t=t||n[0],this.groupedNodes[t.id]=!0}(r=t)&&r.expanded&&this.groupedNodes[r.id]&&function e(t){var n=this;t.forEach((function(t){n.groupedNodes[t.id]=!0,t._decorate(),t.expanded&&t.isFilterAccepted()&&e.call(n,t.childNodes)}))}.call(this,r.childNodes)}},{key:"_isGroupingEnd",value:function(e){return!1}},{key:"selectedNode",value:function(){return 0===this.selectedNodes.length?null:this.selectedNodes[0]}},{key:"$selectedNodes",value:function(){return this.$data.find(".selected")}},{key:"$nodes",value:function(){return this.$data.find(".tree-node")}},{key:"addFilter",value:function(e,t,n){return this._filters.indexOf(e)<0&&(this._filters.push(e),t||this.filter(n),!0)}},{key:"removeFilter",value:function(e,t){rt.remove(this._filters,e)&&this.filter(t)}},{key:"filter",value:function(e){var t=this,n=Boolean(!e),r=[];this.visitNodes((function(e){return t._applyFiltersForNode(e)?(e.isFilterAccepted()?t._addToVisibleFlatList(e,n):rt.pushAll(r,t._removeFromFlatList(e,n)),t.viewRangeDirty=!0):e.attached||(t.showNode(e,n),e.attached&&e.$node.insertAfter(e.$node.nextAll(".hiding:last"))),!e.expanded&&!e.expandedLazy||!e.isFilterAccepted()})),this._nodesFiltered(r)}},{key:"filterVisibleNodes",value:function(e){for(var t=[],n=0;n<this.visibleNodesFlat.length;n++){var r=this.visibleNodesFlat[n];this._applyFiltersForNode(r)&&(r.isFilterAccepted()||(n--,rt.pushAll(t,this._removeFromFlatList(r,e))),this.viewRangeDirty=!0)}this._nodesFiltered(t)}},{key:"_nodesFiltered",value:function(e){this.deselectNodes(e)}},{key:"_nodeAcceptedByFilters",value:function(e){for(var t=0;t<this._filters.length;t++)if(!this._filters[t].accept(e))return!1;return!0}},{key:"_applyFiltersForNode",value:function(e){var t=e.filterDirty;return this._nodeAcceptedByFilters(e)?e.filterAccepted||(e.filterAccepted=!0,t=!0):e.filterAccepted&&(e.filterAccepted=!1,t=!0),!!t&&(e.filterDirty=!1,e.childNodes.forEach((function(e){e.filterDirty=!0})),!0)}},{key:"_insertNodesInDOM",value:function(e,t){(this.rendered||this.rendering)&&(e=e.filter((function(e){var n=void 0===t?this.visibleNodesFlat.indexOf(e):t;return-1!==n&&this.viewRangeRendered.from+this.viewRangeSize>=n&&this.viewRangeRendered.from<=n&&this.viewRangeRendered.size()>0&&!e.attached&&(e.rendered||this._renderNode(e),e._decorate(),this._insertNodeInDOMAtPlace(e,n),this.prevSelectedNode===e&&this._highlightPrevSelectedNode(),e.rendered=!0,e.attached=!0,!0)}),this),this._installNodes(e))}},{key:"_installNodes",value:function(e){this.isHorizontalScrollingEnabled()&&e.forEach((function(e){e.$node.css("width","auto"),e.$node.css("display","inline-block")}),this),e.forEach((function(e){if(e.height=e.$node.outerHeight(!0),this.isHorizontalScrollingEnabled()){var t=e.$node.outerWidth();(e.width?e.width:0)===this.maxNodeWidth&&t<this.maxNodeWidth?(this.maxNodeWidth=0,this.nodeWidthDirty=!0):t>this.maxNodeWidth&&(this.maxNodeWidth=t,this.nodeWidthDirty=!0),e.width=t}}),this),this.isHorizontalScrollingEnabled()&&e.forEach((function(e){this.nodeWidthDirty||e.$node.css("width",this.maxNodeWidth),e.$node.css("display","")}),this)}},{key:"_ensureNodeInDOM",value:function(e,t,n){e&&!e.attached&&e===this.visibleNodesFlat[n]&&n>=this.viewRangeRendered.from&&n<this.viewRangeRendered.to&&this.showNode(e,t,n)}},{key:"_insertNodeInDOMAtPlace",value:function(e,t){var n=e.$node;if(0!==t){var r=this.visibleNodesFlat[t-1];if(this._ensureNodeInDOM(r,!1,t-1),r.attached)n.insertAfter(r.$node);else{if(t+1<this.visibleNodesFlat.length){var o=this.visibleNodesFlat[t+1];if(o.attached)return void n.insertBefore(o.$node)}this.$fillBefore?n.insertAfter(this.$fillBefore):this.$data.prepend(n)}}else this.$fillBefore?n.insertAfter(this.$fillBefore):this.$data.prepend(n)}},{key:"showNode",value:function(e,t,n){if(this.rendered&&(!e.attached||e.$node.hasClass("hiding"))&&(e.attached||(this._ensureNodeInDOM(e.parentNode,t,n-1),this._insertNodesInDOM([e],n)),e.rendered)){var r=e.$node;if(!r.is(".showing")){r.removeClass("hiding");var o=this;t&&(r.addClass("showing"),r.hide(),r.stop(!1,!0).slideDown({duration:250,start:o.startAnimationFunc,complete:function(){o.runningAnimationsFinishFunc(),r.removeClass("showing")}}))}}}},{key:"hideNode",value:function(e,t,n){if(e.attached){this.viewRangeDirty=!0;var r=this,o=e.$node;o&&(o.is(".hiding")||(o.removeClass("showing"),t?(o.addClass("hiding"),this._renderViewportBlocked=!0,o.stop(!1,!0).slideUp({duration:250,start:r.startAnimationFunc,complete:function(){r.runningAnimationsFinishFunc(),o.removeClass("hiding"),o.hasClass("showing")||(o.detach(),e.attached=!1)}})):n||(o.detach(),e.attached=!1,r.invalidateLayoutTree())))}}},{key:"_nodesToIds",value:function(e){return e.map((function(e){return e.id}))}},{key:"_nodesByIds",value:function(e){var t=this;return e.map((function(e){return t.nodesMap[e]}))}},{key:"_nodeById",value:function(e){return this.nodesMap[e]}},{key:"hasNode",value:function(e){return Boolean(this._nodeById(e.id))}},{key:"_onNodeDoubleClick",value:function(e){if(!this.isBreadcrumbStyleActive()){var t=s()(e.currentTarget),n=t.data("node"),r=!t.hasClass("expanded");this.doNodeAction(n,r)}}},{key:"doNodeAction",value:function(e,t){this.trigger("nodeAction",{node:e}),!0===this.checkable&&this.isTreeNodeCheckEnabled()&&e.enabled||this.setNodeExpanded(e,t,{lazy:!1})}},{key:"_onNodeControlMouseDown",value:function(e){if(this._doubleClickSupport.mousedown(e),this._doubleClickSupport.doubleClicked())return!1;var t=s()(e.currentTarget).parent(),n=t.data("node"),r=!t.hasClass("expanded"),o={lazy:!1};if(t.hasClass("lazy")){if(!e.ctrlKey&&!e.shiftKey)return this.expandNode(n,o),!1;r=!1,o.collapseChildNodes=!0}return this.requestFocusOnNodeControlMouseDown&&this.focus(),this.selectNodes(n),this.setNodeExpanded(n,r,o),s.a.suppressEvent(e),!0}},{key:"_onNodeControlMouseUp",value:function(e){return!1}},{key:"_onNodeControlDoubleClick",value:function(e){return!1}},{key:"_onContextMenu",value:function(e){e.preventDefault(),this._showContextMenu(e)}},{key:"changeNode",value:function(e){this._applyFiltersForNode(e)&&(e.isFilterAccepted()?this._addToVisibleFlatList(e,!1):this._removeFromFlatList(e,!1)),this.rendered&&e._decorate(),this.trigger("nodeChanged",{node:e})}},{key:"_onDesktopPopupOpen",value:function(e){var t=this,n=e.popup;this.enabledComputed&&this.has(n)&&n instanceof Qg&&(this.$container.addClass("focused"),n.one("destroy",(function(){t.rendered&&t.$container.removeClass("focused")})))}},{key:"updateScrollbars",value:function(){Lh.update(this.$data)}}])&&LH(t.prototype,n),r&&LH(t,r),i}(ve);function qH(e){return(qH="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function YH(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function XH(e,t,n){return(XH="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=eN(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function JH(e,t){return(JH=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function ZH(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=eN(e);if(t){var o=eN(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return QH(this,n)}}function QH(e,t){return!t||"object"!==qH(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function eN(e){return(eN=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}UH(KH,"DisplayStyle",{DEFAULT:"default",BREADCRUMB:"breadcrumb"}),UH(KH,"CheckableStyle",{CHECKBOX:"checkbox",CHECKBOX_TREE_NODE:"checkbox_tree_node"}),UH(KH,"VIEW_RANGE_DIVISOR",4);var tN=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&JH(e,t)}(i,e);var t,n,r,o=ZH(i);function i(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(e=o.call(this))._addRemoteProperties(["displayStyle"]),e}return t=i,(n=[{key:"_sendNodesSelected",value:function(e,t){var n={nodeIds:e};this._send("nodesSelected",n,{delay:t?250:0,coalesce:function(e){return this.target===e.target&&this.type===e.type}})}},{key:"_onWidgetNodeClick",value:function(e){this._send("nodeClick",{nodeId:e.node.id})}},{key:"_onWidgetNodeAction",value:function(e){this._send("nodeAction",{nodeId:e.node.id})}},{key:"_onWidgetNodesSelected",value:function(e){var t=this.widget._nodesToIds(this.widget.selectedNodes);this._sendNodesSelected(t,e.debounce)}},{key:"_onWidgetNodeExpanded",value:function(e){this._send("nodeExpanded",{nodeId:e.node.id,expanded:e.expanded,expandedLazy:e.expandedLazy})}},{key:"_onWidgetNodesChecked",value:function(e){this._sendNodesChecked(e.nodes)}},{key:"_sendNodesChecked",value:function(e){for(var t={nodes:[]},n=0;n<e.length;n++)t.nodes.push({nodeId:e[n].id,checked:e[n].checked});this._send("nodesChecked",t)}},{key:"_onWidgetEvent",value:function(e){"nodesSelected"===e.type?this._onWidgetNodesSelected(e):"nodeClick"===e.type?this._onWidgetNodeClick(e):"nodeAction"===e.type?this._onWidgetNodeAction(e):"nodeExpanded"===e.type?this._onWidgetNodeExpanded(e):"nodesChecked"===e.type?this._onWidgetNodesChecked(e):"drop"===e.type&&this.widget.dragAndDropHandler?this.widget.dragAndDropHandler.uploadFiles(e.files):XH(eN(i.prototype),"_onWidgetEvent",this).call(this,e)}},{key:"onModelAction",value:function(e){"nodesInserted"===e.type?this._onNodesInserted(e.nodes,e.commonParentNodeId):"nodesUpdated"===e.type?this._onNodesUpdated(e.nodes):"nodesDeleted"===e.type?this._onNodesDeleted(e.nodeIds,e.commonParentNodeId):"allChildNodesDeleted"===e.type?this._onAllChildNodesDeleted(e.commonParentNodeId):"nodesSelected"===e.type?this._onNodesSelected(e.nodeIds):"nodeExpanded"===e.type?this._onNodeExpanded(e.nodeId,e):"nodeChanged"===e.type?this._onNodeChanged(e.nodeId,e):"nodesChecked"===e.type?this._onNodesChecked(e.nodes):"childNodeOrderChanged"===e.type?this._onChildNodeOrderChanged(e.childNodeIds,e.parentNodeId):"requestFocus"===e.type?this._onRequestFocus():"scrollToSelection"===e.type?this._onScrollToSelection():XH(eN(i.prototype),"onModelAction",this).call(this,e)}},{key:"_onNodesInserted",value:function(e,t){var n;if(null!=t&&!(n=this.widget.nodesMap[t]))throw new Error("Parent node could not be found. Id: "+t);this.widget.insertNodes(e,n)}},{key:"_onNodesUpdated",value:function(e){this.widget.updateNodes(e)}},{key:"_onNodesDeleted",value:function(e,t){var n;if(null!=t&&!(n=this.widget.nodesMap[t]))throw new Error("Parent node could not be found. Id: "+t);this.addFilterForWidgetEventType("nodesSelected"),this.addFilterForWidgetEventType("nodesChecked");var r=this.widget._nodesByIds(e);this.widget.deleteNodes(r,n)}},{key:"_onAllChildNodesDeleted",value:function(e){var t;if(null!=e&&!(t=this.widget.nodesMap[e]))throw new Error("Parent node could not be found. Id: "+e);this.addFilterForWidgetEventType("nodesSelected"),this.addFilterForWidgetEventType("nodesChecked"),this.widget.deleteAllChildNodes(t)}},{key:"_onNodesSelected",value:function(e){var t=this;this.addFilterForWidgetEvent((function(n){return"nodesSelected"===n.type&&rt.equals(e,t.widget._nodesToIds(t.widget.selectedNodes))}));var n=this.widget._nodesByIds(e);this.widget.selectNodes(n)}},{key:"_onNodeExpanded",value:function(e,t){var n=this.widget.nodesMap[e],r={lazy:t.expandedLazy},o=Pr.createMap();o[e]=!0,t.recursive&&KH.visitNodes((function(e){o[e.id]=!0}),n.childNodes),this.addFilterForWidgetEvent((function(e){return"nodeExpanded"===e.type&&o[e.node.id]&&t.expanded===e.expanded&&t.expandedLazy===e.expandedLazy})),this.widget.setNodeExpanded(n,t.expanded,r),t.recursive&&this.widget.setNodeExpandedRecursive(n.childNodes,t.expanded,r)}},{key:"_onNodeChanged",value:function(e,t){var n=this.widget.nodesMap[e];Mt.applyTo(t,"TreeNode"),n.text=t.text,n.cssClass=t.cssClass,n.iconId=t.iconId,n.tooltipText=t.tooltipText,n.foregroundColor=t.foregroundColor,n.backgroundColor=t.backgroundColor,n.font=t.font,n.htmlEnabled=t.htmlEnabled,this.widget.changeNode(n)}},{key:"_onNodesChecked",value:function(e){var t=[],n=[];e.forEach((function(e){var r=this.widget._nodeById(e.id);e.checked?t.push(r):n.push(r)}),this),this.addFilterForWidgetEventType("nodesChecked"),this.widget.checkNodes(t,{checked:!0,checkChildren:!1,checkOnlyEnabled:!1}),this.widget.uncheckNodes(n,{checkChildren:!1,checkOnlyEnabled:!1})}},{key:"_onChildNodeOrderChanged",value:function(e,t){var n=this.widget._nodeById([t]),r=this.widget._nodesByIds(e);this.widget.updateNodeOrder(r,n)}},{key:"_onRequestFocus",value:function(){this.widget.focus()}},{key:"_onScrollToSelection",value:function(){this.widget.revealSelection()}}])&&YH(t.prototype,n),r&&YH(t,r),i}(de);function nN(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var rN=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.$node=null,this.$text=null,this.attached=!1,this.checked=!1,this.childNodes=[],this.childrenLoaded=!1,this.childrenChecked=!1,this.cssClass=null,this.destroyed=!1,this.enabled=!0,this.expanded=!1,this.expandedLazy=!1,this.filterAccepted=!0,this.filterDirty=!1,this.htmlEnabled=!1,this.iconId=null,this.id=null,this.initialized=!1,this.initialExpanded=!1,this.lazyExpandingEnabled=!1,this.leaf=!1,this.level=0,this.parent=null,this.parentNode=void 0,this.prevSelectionAnimationDone=!1,this.rendered=!1,this.session=null,this.text=null,this._loadChildrenPromise=!1}var t,n,r;return t=e,(n=[{key:"init",value:function(e){var t=this._jsonModel();t&&(e=s.a.extend({},t,e)),this._init(e),void 0===e.initialExpanded&&(this.initialExpanded=this.expanded)}},{key:"destroy",value:function(){this.destroyed||(this._destroy(),this.destroyed=!0)}},{key:"_destroy",value:function(){}},{key:"getTree",value:function(){return this.parent}},{key:"_init",value:function(e){O.assertParameter("parent",e.parent,KH),this.session=e.session||e.parent.session,s.a.extend(this,e),Mt.applyTo(this),bp.resolveTextProperty(this,"text"),gn.resolveIconProperty(this,"iconId"),this.hasChildNodes()&&this.getTree()._ensureTreeNodes(this.childNodes)}},{key:"_jsonModel",value:function(){}},{key:"reset",value:function(){this.$node&&(this.$node.remove(),this.$node=null),this.rendered=!1,this.attached=!1}},{key:"hasChildNodes",value:function(){return this.childNodes.length>0}},{key:"isAncestorOf",value:function(e){for(;e;){if(e.parentNode===this)return!0;e=e.parentNode}return!1}},{key:"isDescendantOf",value:function(e){return e===this.parentNode||!!this.parentNode&&this.parentNode.isDescendantOf(e)}},{key:"isFilterAccepted",value:function(e){return(this.filterDirty||e)&&this.getTree()._applyFiltersForNode(this),this.filterAccepted}},{key:"loadChildren",value:function(){return s.a.resolvedDeferred()}},{key:"ensureLoadChildren",value:function(){if(this.childrenLoaded)return s.a.resolvedPromise();if(this._loadChildrenPromise)return this._loadChildrenPromise;var e=this.loadChildren(),t=e.promise();return"resolved"===e.state()?(this._loadChildrenPromise=null,t):(this._loadChildrenPromise=t,t.done(this._onLoadChildrenDone.bind(this)),t)}},{key:"_onLoadChildrenDone",value:function(){this._loadChildrenPromise=null}},{key:"setText",value:function(e){this.text=e}},{key:"render",value:function(e,t){this.$node=e.makeDiv("tree-node").data("node",this).attr("data-nodeid",this.id).attr("data-level",this.level),Pr.isNullOrUndefined(t)||this.$node.css("padding-left",t),this.$text=this.$node.appendSpan("text"),this._renderControl(),this.getTree().checkable&&this._renderCheckbox(),this._renderText(),this._renderIcon()}},{key:"_renderText",value:function(){this.htmlEnabled?this.$text.html(this.text):this.$text.textOrNbsp(this.text)}},{key:"_renderChecked",value:function(){this.rendered&&this.$node.children(".tree-node-checkbox").children(".check-box").toggleClass("checked",this.checked)}},{key:"_renderIcon",value:function(){var e=this;this.$node.icon(this.iconId,(function(t){t.insertBefore(e.$text)}))}},{key:"$icon",value:function(){return this.$node.children(".icon")}},{key:"_renderControl",value:function(){var e=this.$node.prependDiv("tree-node-control");this._updateControl(e,this.getTree())}},{key:"_updateControl",value:function(e,t){e.toggleClass("checkable",t.checkable),e.cssPaddingLeft(t.nodeControlPaddingLeft+this.level*t.nodePaddingLevel),e.setVisible(!this.leaf)}},{key:"_renderCheckbox",value:function(){this.$node.prependDiv("tree-node-checkbox").appendDiv("check-box").toggleClass("checked",this.checked).toggleClass("disabled",!(this.getTree().enabled&&this.enabled)).toggleClass("children-checked",!!this.childrenChecked)}},{key:"_decorate",value:function(){if(this.$node){var e=this.$node,t=this.getTree();e.attr("class",this._preserveCssClasses(e)),e.addClass(this.cssClass),e.toggleClass("leaf",!!this.leaf),e.toggleClass("expanded",!!this.expanded&&this.childNodes.length>0),e.toggleClass("lazy",e.hasClass("expanded")&&this.expandedLazy),e.toggleClass("group",!!t.groupedNodes[this.id]),e.setEnabled(!!this.enabled),e.children(".tree-node-control").setVisible(!this.leaf),e.children(".tree-node-checkbox").children(".check-box").toggleClass("disabled",!(t.enabled&&this.enabled)),(!this.parentNode&&0===t.selectedNodes.length||t._isChildOfSelectedNodes(this))&&e.addClass("child-of-selected"),this._renderText(),this._renderIcon(),To.legacyStyle(this._getStyles(),e),this.parentNode&&this.parentNode.expandedLazy&&!this.parentNode.childNodes.some((function(e){return!!t.visibleNodesMap[e.id]}))&&this.parentNode.$node&&this.parentNode.$node.removeClass("lazy")}}},{key:"_getStyles",value:function(){return this}},{key:"_preserveCssClasses",value:function(e){var t="tree-node";return e.isSelected()&&(t+=" selected"),e.hasClass("ancestor-of-selected")&&(t+=" ancestor-of-selected"),e.hasClass("parent-of-selected")&&(t+=" parent-of-selected"),t}}])&&nN(t.prototype,n),r&&nN(t,r),e}();function oN(e){return(oN="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function iN(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function sN(e,t){return(sN=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function aN(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=uN(e);if(t){var o=uN(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return lN(this,n)}}function lN(e,t){return!t||"object"!==oN(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function uN(e){return(uN=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var cN=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&sN(e,t)}(i,e);var t,n,r,o=aN(i);function i(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(t=o.call(this)).tree=e,t.nodeDimensionsDirty=!1,t}return t=i,(n=[{key:"layout",value:function(e){this._layout(e),Lh.update(this.tree.$data)}},{key:"_layout",value:function(e){var t,n,r,o=this.tree.menuBar,i=o.htmlComp,s=this.tree.htmlComp;n=s.availableSize({exact:!0}).subtract(s.insets()),this.tree.toggleBreadcrumbStyleEnabled&&this.tree.setBreadcrumbStyleActive(Math.floor(n.width)<=this.tree.breadcrumbTogglingThreshold),r=0,o.$container.isVisible()&&(t=ok.size(i,n),i.setSize(t),r+=t.height),this._setDataHeight(r),this.tree.setViewRangeSize(this.tree.calculateViewRangeSize()),this.nodeDimensionsDirty=this.nodeDimensionsDirty||this._sizeChanged(s),this.nodeDimensionsDirty&&(this.nodeDimensionsDirty=!1,this.tree.isHorizontalScrollingEnabled()?(this.tree.nodeWidthDirty=!0,this.tree.maxNodeWidth=0):(this.tree.updateNodeHeights(),this.tree._renderViewport(),this.tree._renderFiller())),s.layouted||this.tree._renderScrollTop(),this.tree._renderViewport(),s.layouted||this.tree._renderScrollTop()}},{key:"_sizeChanged",value:function(e){return e.sizeCached&&Math.ceil(e.sizeCached.width)!==Math.ceil(e.size().width)}},{key:"_setDataHeight",value:function(e){var t=this.tree.$data;e+=t.cssMarginTop()+t.cssMarginBottom(),t.css("height",0===e?"100%":"calc(100% - "+e+"px)")}},{key:"preferredLayoutSize",value:function(e,t){return this.tree._renderViewport(),this.tree.htmlComp.layouted||(this.nodeDimensionsDirty=!0),qs.prefSize(e,t)}}])&&iN(t.prototype,n),r&&iN(t,r),i}(Zs);function fN(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var hN=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.tree=t}var t,n,r;return t=e,(n=[{key:"accept",value:function(e){if(!e.expanded&&e.parentNode&&e.parentNode.expandedLazy&&e.parentNode.lazyExpandingEnabled&&this.tree.lazyExpandingEnabled){for(var t=0;t<this.tree.selectedNodes.length;t++){var n=this.tree.selectedNodes[t];if("string"==typeof n)break;if(n===e||n.isDescendantOf(e))return!0}return!1}return!0}}])&&fN(t.prototype,n),r&&fN(t,r),e}();function pN(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var dN=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.tree=t}var t,n,r;return t=e,(n=[{key:"accept",value:function(e){return 0===this.tree.selectedNodes.length?void 0===e.parentNode:this.tree.isNodeInBreadcrumbVisible(e)}}])&&pN(t.prototype,n),r&&pN(t,r),e}();function yN(e){return(yN="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function vN(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function bN(e,t,n){return(bN="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=wN(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function mN(e,t){return(mN=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function gN(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=wN(e);if(t){var o=wN(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return _N(this,n)}}function _N(e,t){return!t||"object"!==yN(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function wN(e){return(wN=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var kN=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&mN(e,t)}(i,e);var t,n,r,o=gN(i);function i(e,t){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(n=o.call(this)).field=e,n.repeatable=!0,n.stopPropagation=!0,n.renderingHints.hAlign=Do.RIGHT,n.ctrl=Ru.isCtrl(t),n.shift=Ru.isShift(t),n.alt=Ru.isAlt(t),n.keyStrokeMode=zu.Mode.DOWN,n}return t=i,(n=[{key:"_accept",value:function(e){return!!bN(wN(i.prototype),"_accept",this).call(this,e)&&(this.field.selectedNodes.length>0&&(e._treeCurrentNode=this.field.selectedNodes[0],e._$treeCurrentNode=e._treeCurrentNode.$node),!0)}},{key:"handle",value:function(e){var t=this._computeNewSelection(e._treeCurrentNode);t&&this.selectNodesAndReveal(t,!0)}},{key:"_computeNewSelection",value:function(e){return[]}},{key:"selectNodesAndReveal",value:function(e,t){this.field.selectNodes(e,t),this.field.revealSelection()}}])&&vN(t.prototype,n),r&&vN(t,r),i}(zu);function SN(e){return(SN="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ON(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function TN(e,t,n){return(TN="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=xN(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function CN(e,t){return(CN=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function PN(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=xN(e);if(t){var o=xN(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return RN(this,n)}}function RN(e,t){return!t||"object"!==SN(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function xN(e){return(xN=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var EN=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&CN(e,t)}(i,e);var t,n,r,o=PN(i);function i(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(t=o.call(this)).field=e,t.which=[Ou.SPACE],t.renderingHints.render=!1,t}return t=i,(n=[{key:"_accept",value:function(e){return TN(xN(i.prototype),"_accept",this).call(this,e)&&this.field.checkable&&this.field.selectedNodes.length}},{key:"handle",value:function(e){var t=this.field.selectedNodes.filter((function(e){return e.enabled})),n=t.some((function(e){return!e.checked}));t.forEach((function(e){this.field.checkNode(e,n)}),this)}}])&&ON(t.prototype,n),r&&ON(t,r),i}(zu);function DN(e){return(DN="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function AN(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function FN(e,t){return(FN=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function $N(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=MN(e);if(t){var o=MN(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return jN(this,n)}}function jN(e,t){return!t||"object"!==DN(t)&&"function"!=typeof t?BN(e):t}function BN(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function MN(e){return(MN=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var IN=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&FN(e,t)}(i,e);var t,n,r,o=$N(i);function i(e,t){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(n=o.call(this,e,t)).which=[Ou.UP],n.renderingHints.text="↑",n.renderingHints.$drawingArea=function(e,t){var n=this._computeNewSelection(t._treeCurrentNode);if(n)return n.$node}.bind(BN(n)),n}return t=i,(n=[{key:"_computeNewSelection",value:function(e){var t=this.field.visibleNodesFlat;if(0!==t.length)return e?t[t.indexOf(e)-1]:rt.last(t)}}])&&AN(t.prototype,n),r&&AN(t,r),i}(kN);function LN(e){return(LN="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function HN(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function NN(e,t){return(NN=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function VN(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=GN(e);if(t){var o=GN(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return WN(this,n)}}function WN(e,t){return!t||"object"!==LN(t)&&"function"!=typeof t?zN(e):t}function zN(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function GN(e){return(GN=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var UN=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&NN(e,t)}(i,e);var t,n,r,o=VN(i);function i(e,t){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(n=o.call(this,e,t)).which=[Ou.DOWN],n.renderingHints.text="↓",n.renderingHints.$drawingArea=function(e,t){var n=this._computeNewSelection(t._treeCurrentNode);if(n)return n.$node}.bind(zN(n)),n}return t=i,(n=[{key:"_computeNewSelection",value:function(e){var t=this.field.visibleNodesFlat;if(0!==t.length)return e?t[t.indexOf(e)+1]:t[0]}}])&&HN(t.prototype,n),r&&HN(t,r),i}(kN);function KN(e){return(KN="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function qN(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function YN(e,t){return(YN=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function XN(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=QN(e);if(t){var o=QN(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return JN(this,n)}}function JN(e,t){return!t||"object"!==KN(t)&&"function"!=typeof t?ZN(e):t}function ZN(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function QN(e){return(QN=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var eV=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&YN(e,t)}(i,e);var t,n,r,o=XN(i);function i(e,t){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(n=o.call(this,e,t)).which=[Ou.END],n.renderingHints.$drawingArea=function(e,t){var n=this._computeNewSelection(t._treeCurrentNode);if(n)return n.$node}.bind(ZN(n)),n}return t=i,(n=[{key:"handle",value:function(e){var t=this._computeNewSelection(e._treeCurrentNode);t&&this.selectNodesAndReveal(t)}},{key:"_computeNewSelection",value:function(e){var t=this.field.visibleNodesFlat;if(0!==t.length)return rt.last(t)}}])&&qN(t.prototype,n),r&&qN(t,r),i}(kN);function tV(e){return(tV="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function nV(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function rV(e,t){return(rV=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function oV(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=aV(e);if(t){var o=aV(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return iV(this,n)}}function iV(e,t){return!t||"object"!==tV(t)&&"function"!=typeof t?sV(e):t}function sV(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function aV(e){return(aV=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var lV=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&rV(e,t)}(i,e);var t,n,r,o=oV(i);function i(e,t){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(n=o.call(this,e,t)).which=[Ou.HOME],n.renderingHints.hAlign=Do.RIGHT,n.renderingHints.$drawingArea=function(e,t){if(this.field.visibleNodesFlat.length>0)return this.field.visibleNodesFlat[0].$node}.bind(sV(n)),n}return t=i,(n=[{key:"handle",value:function(e){this.field.collapseAll(),this.field.visibleNodesFlat.length>0&&this.selectNodesAndReveal(this.field.visibleNodesFlat[0])}}])&&nV(t.prototype,n),r&&nV(t,r),i}(kN);function uV(e){return(uV="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function cV(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function fV(e,t,n){return(fV="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=yV(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function hV(e,t){return(hV=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function pV(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=yV(e);if(t){var o=yV(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return dV(this,n)}}function dV(e,t){return!t||"object"!==uV(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function yV(e){return(yV=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var vV=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&hV(e,t)}(i,e);var t,n,r,o=pV(i);function i(e,t){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(n=o.call(this,e,t)).which=[Ou.SUBTRACT],n.renderingHints.text="-",n.renderingHints.$drawingArea=function(e,t){var n=t._treeCurrentNode;return n.expanded?n.$node:n.parentNode?n.parentNode.$node:void 0},n}return t=i,(n=[{key:"_accept",value:function(e){var t=fV(yV(i.prototype),"_accept",this).call(this,e),n=e._treeCurrentNode;return t&&n&&(n.expanded||n.parentNode)}},{key:"handle",value:function(e){var t=e._treeCurrentNode;t.expanded?this.field.collapseNode(t):t.parentNode&&this.selectNodesAndReveal(t.parentNode,!0)}}])&&cV(t.prototype,n),r&&cV(t,r),i}(kN);function bV(e){return(bV="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function mV(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function gV(e,t,n){return(gV="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=OV(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function _V(e,t){return(_V=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function wV(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=OV(e);if(t){var o=OV(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return kV(this,n)}}function kV(e,t){return!t||"object"!==bV(t)&&"function"!=typeof t?SV(e):t}function SV(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function OV(e){return(OV=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var TV=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_V(e,t)}(i,e);var t,n,r,o=wV(i);function i(e,t){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(n=o.call(this,e,t)).which=[Ou.ADD],n.renderingHints.text="+",n.renderingHints.$drawingArea=function(e,t){var n=t._treeCurrentNode;return this.isNodeExpandable(n)?n.$node:n.childNodes.length>0?n.childNodes[0].$node:void 0}.bind(SV(n)),n}return t=i,(n=[{key:"_accept",value:function(e){var t=gV(OV(i.prototype),"_accept",this).call(this,e),n=e._treeCurrentNode;return t&&n&&(this.isNodeExpandable(n)||n.childNodes.length>0)}},{key:"isNodeExpandable",value:function(e){return!e.expanded&&!e.leaf}},{key:"handle",value:function(e){var t=e._treeCurrentNode;if(this.isNodeExpandable(t))this.field.expandNode(t,{lazy:!1});else{var n=t.childNodes.filter((function(e){return this.field.visibleNodesFlat.indexOf(e)>-1}),this);n.length>0&&this.selectNodesAndReveal(n[0],!0)}}}])&&mV(t.prototype,n),r&&mV(t,r),i}(kN);function CV(e){return(CV="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function PV(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function RV(e,t,n){return(RV="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=AV(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function xV(e,t){return(xV=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function EV(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=AV(e);if(t){var o=AV(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return DV(this,n)}}function DV(e,t){return!t||"object"!==CV(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function AV(e){return(AV=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var FV=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&xV(e,t)}(i,e);var t,n,r,o=EV(i);function i(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(e=o.call(this)).$nodesContainer,e._scrolldirections="y",e}return t=i,(n=[{key:"_initTreeKeyStrokeContext",value:function(){this.keyStrokeContext.registerKeyStroke([new tW(this),new lW(this),new yW(this),new kW(this)])}},{key:"_createTreeNode",value:function(e){return(e=O.nvl(e,{})).parent=this,O.create("CompactTreeNode",e)}},{key:"_render",value:function(){this.$container=this.$parent.appendDiv("compact-tree");var e=new cN(this);this.htmlComp=ea.install(this.$container,this.session),this.htmlComp.setLayout(e),this.$data=this.$container.appendDiv("tree-data"),this._installScrollbars({borderless:!0}),this.menuBar=O.create("MenuBar",{parent:this,menuOrder:new Ag(this.session,"Tree")}),this.menuBar.render(),this.$nodesContainer=this.$data.appendDiv("nodes"),this._updateNodeDimensions(),this._renderViewport(),this.invalidateLayoutTree()}},{key:"_calculateCurrentViewRange",value:function(){return this.viewRangeSize=this.visibleNodesFlat.length,new Fr(0,Math.max(this.visibleNodesFlat.length,0))}},{key:"calculateViewRangeSize",value:function(){return this.visibleNodesFlat.length}},{key:"_insertNodeInDOMAtPlace",value:function(e,t){var n,r=this.visibleNodesFlat[t-1];if(r)if(r.level<e.level)e.$node.insertAfter(r.$node.children()[0]);else{n=r.$node;for(var o=0;o<r.level-e.level;o++)n=n.parent();e.$node.insertAfter(n)}else e.$node.prependTo(this.$nodesContainer)}},{key:"selectNodes",value:function(e,t){var n=[];(e=rt.ensure(e)).forEach((function(e){e.isSection()?e.childNodes.length>0&&n.push(e.childNodes[0]):n.push(e)}),this),RV(AV(i.prototype),"selectNodes",this).call(this,n)}},{key:"_renderExpansion",value:function(e){}},{key:"_updateItemPath",value:function(){}}])&&PV(t.prototype,n),r&&PV(t,r),i}(KH);function $V(e){return($V="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function jV(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function BV(e,t){return(BV=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function MV(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=LV(e);if(t){var o=LV(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return IV(this,n)}}function IV(e,t){return!t||"object"!==$V(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function LV(e){return(LV=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var HV=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&BV(e,t)}(i,e);var t,n,r,o=MV(i);function i(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),o.call(this,e)}return t=i,(n=[{key:"render",value:function(){var e=this.getTree();if(this.isSection()){var t=e.$container.makeDiv("section expanded").data("node",this);t.appendDiv("title").text(this.text),this.$node=t}else{var n=this.parentNode.$node.makeDiv("section-node").data("node",this).on("mousedown",e._onNodeMouseDown.bind(e)).on("mouseup",e._onNodeMouseUp.bind(e));this.$node=n}return this.$node}},{key:"_decorate",value:function(){if(this.$node){var e,t=this.$node;t.hasClass("section")?(t=t.children("title"),e="title"):(e="section-node",t.isSelected()&&(e+=" selected")),t.removeClass(),t.addClass(e),t.addClass(this.cssClass),t.text(this.text),To.legacyStyle(this,t),Wn.hasText(this.tooltipText)&&t.attr("title",this.tooltipText)}}},{key:"isSection",value:function(){return 0===this.level}}])&&jV(t.prototype,n),r&&jV(t,r),i}(rN);function NV(e){return(NV="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function VV(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function WV(e,t,n){return(WV="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=KV(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function zV(e,t){return(zV=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function GV(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=KV(e);if(t){var o=KV(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return UV(this,n)}}function UV(e,t){return!t||"object"!==NV(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function KV(e){return(KV=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var qV=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&zV(e,t)}(i,e);var t,n,r,o=GV(i);function i(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(t=o.call(this)).repeatable=!0,t.field=e,t.keyStrokeMode=zu.Mode.DOWN,t}return t=i,(n=[{key:"_accept",value:function(e){if(!WV(KV(i.prototype),"_accept",this).call(this,e))return!1;if(!this.field.nodes||!this.field.nodes.length)return!1;var t=this.field.$nodesContainer.find(".section-node.selected"),n=t.data("node"),r=this._findNextNode(t,n);return!!r&&(e._nextNode=r,!0)}},{key:"handle",value:function(e){this.field.selectNodes(e._nextNode),this.field.checkNode(e._nextNode,!0)}},{key:"_findNextNode",value:function(e,t){throw new Error("method must be overwritten by subclass")}}])&&VV(t.prototype,n),r&&VV(t,r),i}(zu);function YV(e){return(YV="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function XV(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function JV(e,t){return(JV=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function ZV(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=eW(e);if(t){var o=eW(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return QV(this,n)}}function QV(e,t){return!t||"object"!==YV(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function eW(e){return(eW=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var tW=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&JV(e,t)}(i,e);var t,n,r,o=ZV(i);function i(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(t=o.call(this,e)).which=[Ou.UP],t.renderingHints.text="↑",t}return t=i,(n=[{key:"_findNextNode",value:function(e,t){return t?e.prev(".section-node").data("node")||e.parent().prev(".section").children(".section-node").last().data("node"):rt.last(rt.last(this.field.nodes).childNodes)}}])&&XV(t.prototype,n),r&&XV(t,r),i}(qV);function nW(e){return(nW="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function rW(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function oW(e,t){return(oW=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function iW(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=aW(e);if(t){var o=aW(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return sW(this,n)}}function sW(e,t){return!t||"object"!==nW(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function aW(e){return(aW=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var lW=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&oW(e,t)}(i,e);var t,n,r,o=iW(i);function i(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(t=o.call(this,e)).which=[Ou.DOWN],t.renderingHints.text="↓",t}return t=i,(n=[{key:"_findNextNode",value:function(e,t){return t?e.next(".section-node").data("node")||e.parent().next(".section").children(".section-node").first().data("node"):rt.first(rt.first(this.field.nodes).childNodes)}}])&&rW(t.prototype,n),r&&rW(t,r),i}(qV);function uW(e){return(uW="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function cW(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function fW(e,t){return(fW=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function hW(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=dW(e);if(t){var o=dW(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return pW(this,n)}}function pW(e,t){return!t||"object"!==uW(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function dW(e){return(dW=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var yW=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&fW(e,t)}(i,e);var t,n,r,o=hW(i);function i(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(t=o.call(this,e)).renderingHints.text="←",t.which=[Ou.LEFT],t}return t=i,(n=[{key:"_findNextNode",value:function(e,t){return e.parent().prev(".section").children(".section-node").first().data("node")||e.parent().children(".section-node").not(e).first().data("node")}}])&&cW(t.prototype,n),r&&cW(t,r),i}(qV);function vW(e){return(vW="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function bW(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function mW(e,t){return(mW=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function gW(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=wW(e);if(t){var o=wW(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return _W(this,n)}}function _W(e,t){return!t||"object"!==vW(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function wW(e){return(wW=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var kW=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&mW(e,t)}(i,e);var t,n,r,o=gW(i);function i(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(t=o.call(this,e)).renderingHints.text="→",t.which=[Ou.RIGHT],t}return t=i,(n=[{key:"_findNextNode",value:function(e,t){return e.parent().next(".section").children(".section-node").first().data("node")}}])&&bW(t.prototype,n),r&&bW(t,r),i}(qV);function SW(e,t){return e.makeElement("<input>",t).attr("type","text").attr("autocomplete","NoAutocomplete").disableSpellcheck()}function OW(e,t){return e.$container.makeDiv(Wn.join(" ","input-field",t))}var TW={activateFirstField:function(e,t){var n=me.findFirstFocusableWidget(t,e);n&&n.activate()},appendIcon:function(e,t){var n=e.appendSpan("icon unfocusable");return t&&n.addClass(t),n},eventOutsideProposalField:function(e,t){var n=i(e.$field,t)||i(e.$icon,t)||i(e.$clearIcon,t),r=s(e.popup,t),o=s(e._tooltip(),t);return!n&&!r&&!o;function i(e,t){return e&&e.isOrHas(t)}function s(e,t){return e&&e.rendered&&e.$container.isOrHas(t)}},handleOnClick:function(e){return e.enabledComputed&&!e.embedded&&!e.popup},initTouch:function(e,t){e.embedded=O.nvl(t.embedded,!1),e.touchMode=O.nvl(t.touchMode,Kt.get().supportsOnlyTouch())},linkElementWithLabel:function(e,t){var n=t.attr("id");n||(n=me.createUniqueId("lbl"),t.attr("id",n));var r=e.attr("aria-labelledby")||"";r&&(n+=" "+r),e.attr("aria-labelledby",n)},makeInputDiv:OW,makeInputOrDiv:function(e,t){return e.touchMode?OW(e,t):SW(e.$container,t)},makeTextField:SW,valOrText:function(e,t){var n=e.is("div");if(2!==arguments.length)return n?e.text():e.val();n?e.text(t):e.val(t)}};function CW(e){return(CW="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function PW(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function RW(e,t,n){return(RW="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=AW(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function xW(e,t){return(xW=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function EW(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=AW(e);if(t){var o=AW(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return DW(this,n)}}function DW(e,t){return!t||"object"!==CW(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function AW(e){return(AW=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var FW=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&xW(e,t)}(i,e);var t,n,r,o=EW(i);function i(e,t){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(n=o.call(this)).field=e,n.appLinkTriggerFunction=t,n.which=[Ou.SPACE],n.renderingHints.render=!1,n}return t=i,(n=[{key:"_accept",value:function(e){return RW(AW(i.prototype),"_accept",this).call(this,e)&&s()(e.target).hasClass("app-link")}},{key:"handle",value:function(e){this.appLinkTriggerFunction.call(this.field,e)}}])&&PW(t.prototype,n),r&&PW(t,r),i}(zu);function $W(e){return($W="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function jW(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function BW(e,t,n){return(BW="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=NW(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function MW(e,t){return(MW=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function IW(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=NW(e);if(t){var o=NW(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return LW(this,n)}}function LW(e,t){return!t||"object"!==$W(t)&&"function"!=typeof t?HW(e):t}function HW(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function NW(e){return(NW=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var VW=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&MW(e,t)}(i,e);var t,n,r,o=IW(i);function i(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(e=o.call(this)).tooltip=null,e.contextMenu=null,e.status=null,e.updating=!1,e.autoRemove=!0,e.position=ZW.StatusPosition.DEFAULT,e._parents=[],e._parentPropertyChangeListener=e._onParentPropertyChange.bind(HW(e)),e._parentHierarchyChangeListener=e._onParentHierarchyChange.bind(HW(e)),e}return t=i,(n=[{key:"_render",value:function(){this.$container=this.$parent.appendSpan("status").on("mousedown",this._onStatusMouseDown.bind(this)),this.htmlComp=ea.install(this.$container,this.session)}},{key:"_remove",value:function(){BW(NW(i.prototype),"_remove",this).call(this),this.tooltip&&(this.tooltip.destroy(),this.tooltip=null),this.contextMenu&&(this.contextMenu.destroy(),this.contextMenu=null),this._removeParentListeners()}},{key:"_renderProperties",value:function(){BW(NW(i.prototype),"_renderProperties",this).call(this),this._renderPosition()}},{key:"update",value:function(e,t,n,r){this.updating=!0,this.setStatus(e),this.setMenus(t),this.setAutoRemove(n),this.updating=!1,this._updatePopup(r)}},{key:"clearStatus",value:function(){this.setStatus(null)}},{key:"setStatus",value:function(e){this.setProperty("status",e)}},{key:"_setStatus",value:function(e){e=Br.ensure(e),this._setProperty("status",e)}},{key:"_renderStatus",value:function(){this.updating||this._updatePopup()}},{key:"setPosition",value:function(e){this.setProperty("position",e)}},{key:"_renderPosition",value:function(){this.$container.toggleClass("top",this.position===ZW.StatusPosition.TOP),this.invalidateLayoutTree()}},{key:"_renderVisible",value:function(){BW(NW(i.prototype),"_renderVisible",this).call(this),this.visible||this.hidePopup()}},{key:"setMenus",value:function(e){this.setProperty("menus",rt.ensure(e))}},{key:"_renderMenus",value:function(){this.updating||this._updatePopup()}},{key:"setAutoRemove",value:function(e){this.setProperty("autoRemove",e)}},{key:"_renderAutoRemove",value:function(){this.updating||this._updatePopup()}},{key:"hideTooltip",value:function(){var e=new sn;this.tooltip&&(this.trigger("hideTooltip",e),e.defaultPrevented||(this.tooltip.destroy(),this.tooltip=null,this._removeParentListeners()))}},{key:"_updatePopup",value:function(e){this._requiresTooltip()||this.hideTooltip(),rt.empty(this.menus)&&this.hideContextMenu(),!0===e?this.showTooltip():!1===e&&this.hideTooltip()}},{key:"_requiresTooltip",value:function(){return!(!this.status||!this.rendered||rt.empty(this.menus)&&!Wn.hasText(this.status.message))}},{key:"showTooltip",value:function(){var e=this;if(this._requiresTooltip()){var t=new sn;this.trigger("showTooltip",t),t.defaultPrevented||(this._updateParentListeners(),this.hideContextMenu(),this.tooltip&&this.tooltip.autoRemove!==this.autoRemove&&this.hideTooltip(),this.tooltip?(this.tooltip.setText(this.status.message),this.tooltip.setSeverity(this.status.severity),this.tooltip.setMenus(this.menus)):(this.tooltip=O.create("Tooltip",{parent:this,$anchor:this.$container,text:this.status.message,severity:this.status.severity,autoRemove:this.autoRemove,menus:this.menus}),this.tooltip.one("destroy",(function(){e.hideTooltip()})),this.tooltip.render()))}}},{key:"hideContextMenu",value:function(){this.contextMenu&&(this.contextMenu.destroy(),this.contextMenu=null)}},{key:"showContextMenu",value:function(){var e=this;rt.empty(this.menus)||(this.hidePopup(),this.contextMenu=O.create("ContextMenuPopup",{parent:this,$anchor:this.$container,menuItems:this.menus,cloneMenuItems:!1,closeOnAnchorMouseDown:!1}),this.contextMenu.one("destroy",(function(){e.hideContextMenu()})),this.contextMenu.open())}},{key:"hidePopup",value:function(){this.hideTooltip(),this.hideContextMenu()}},{key:"togglePopup",value:function(){if(this.status)return this.hideContextMenu(),void(this.tooltip?this.hideTooltip():this.showTooltip());if(rt.empty(this.menus))this.hidePopup();else{this.hideTooltip();var e=function(){this.rendered&&(this.contextMenu?this.hideContextMenu():this.showContextMenu())}.bind(this);this.session.onRequestsDone(e)}}},{key:"_onStatusMouseDown",value:function(e){this.trigger("statusMouseDown",e),e.defaultPrevented||this.togglePopup()}},{key:"_updateTooltipVisibility",value:function(e){var t=this;this.isEveryParentVisible()?setTimeout((function(){t.rendered&&t.isEveryParentVisible()&&t.tooltip&&!t.tooltip.rendered&&t.tooltip.render()})):this.tooltip&&this.tooltip.rendered&&this.tooltip.remove()}},{key:"_onParentHierarchyChange",value:function(e){this._updateParentListeners()}},{key:"_onParentPropertyChange",value:function(e){"visible"===e.propertyName&&this._updateTooltipVisibility(e.source)}},{key:"_removeParentListeners",value:function(){var e=this;this._parents.forEach((function(t){t.off("hierarchyChange",e._parentHierarchyChangeListener),t.off("propertyChange",e._parentPropertyChangeListener)})),this._parents=[]}},{key:"_updateParentListeners",value:function(){this._removeParentListeners();for(var e=this.parent;e;)e.on("hierarchyChange",this._parentHierarchyChangeListener),e.on("propertyChange",this._parentPropertyChangeListener),this._parents.push(e),e=e.parent}}])&&jW(t.prototype,n),r&&jW(t,r),i}(ve);function WW(e){return(WW="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function zW(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function GW(e,t,n){return(GW="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=XW(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function UW(e,t){return(UW=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function KW(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=XW(e);if(t){var o=XW(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return qW(this,n)}}function qW(e,t){return!t||"object"!==WW(t)&&"function"!=typeof t?YW(e):t}function YW(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function XW(e){return(XW=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function JW(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var ZW=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&UW(e,t)}(i,e);var t,n,r,o=KW(i);function i(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(e=o.call(this)).dropType=0,e.dropMaximumSize=rn.DEFAULT_DROP_MAXIMUM_SIZE,e.empty=!0,e.errorStatus=null,e.fieldStyle=i.DEFAULT_FIELD_STYLE,e.gridData=null,e.gridDataHints=new Ez,e.mode=i.Mode.DEFAULT,e.keyStrokes=[],e.label=null,e.labelVisible=!0,e.labelPosition=i.LabelPosition.DEFAULT,e.labelWidthInPixel=0,e.labelUseUiWidth=!1,e.labelHtmlEnabled=!1,e.mandatory=!1,e.statusMenuMappings=[],e.menus=[],e.menusVisible=!0,e.preventInitialFocus=!1,e.requiresSave=!1,e.statusPosition=i.StatusPosition.DEFAULT,e.statusVisible=!0,e.suppressStatus=!1,e.touched=!1,e.tooltipText=null,e.tooltipAnchor=i.TooltipAnchor.DEFAULT,e.onFieldTooltipOptionsCreator=null,e.suppressStatus=null,e.$label=null,e.$field=null,e.$fieldContainer=null,e.$icon=null,e.$status=null,e.disabledCopyOverlay=!1,e.$disabledCopyOverlay=null,e._addWidgetProperties(["keyStrokes","menus","statusMenuMappings"]),e._addCloneProperties(["dropType","dropMaximumSize","errorStatus","fieldStyle","gridDataHints","gridData","label","labelVisible","labelPosition","labelWidthInPixel","labelUseUiWidth","mandatory","mode","preventInitialFocus","requiresSave","touched","statusVisible","statusPosition","statusMenuMappings","tooltipText","tooltipAnchor"]),e._menuPropertyChangeHandler=e._onMenuPropertyChange.bind(YW(e)),e}return t=i,(n=[{key:"_createKeyStrokeContext",value:function(){return new $u}},{key:"_createLoadingSupport",value:function(){return new oe({widget:this})}},{key:"_init",value:function(e){GW(XW(i.prototype),"_init",this).call(this,e),this.resolveConsts([{property:"labelPosition",constType:i.LabelPosition}]),this.resolveTextKeys(["label","tooltipText"]),this._setKeyStrokes(this.keyStrokes),this._setMenus(this.menus),this._setErrorStatus(this.errorStatus),this._setGridDataHints(this.gridDataHints),this._setGridData(this.gridData),this._updateEmpty()}},{key:"_initProperty",value:function(e,t){"gridDataHints"===e?this._initGridDataHints(t):GW(XW(i.prototype),"_initProperty",this).call(this,e,t)}},{key:"_initGridDataHints",value:function(e){e instanceof Ez?this.gridDataHints=e:Pr.isPlainObject(e)?s.a.extend(this.gridDataHints,e):this.gridDataHints=e}},{key:"_render",value:function(){throw new Error("sub-classes of FormField must implement a _render method")}},{key:"_renderProperties",value:function(){GW(XW(i.prototype),"_renderProperties",this).call(this),this._renderMandatory(),this._renderTooltipText(),this._renderErrorStatus(),this._renderMenus(),this._renderLabel(),this._renderLabelVisible(),this._renderStatusVisible(),this._renderStatusPosition(),this._renderFont(),this._renderForegroundColor(),this._renderBackgroundColor(),this._renderLabelFont(),this._renderLabelForegroundColor(),this._renderLabelBackgroundColor(),this._renderGridData(),this._renderPreventInitialFocus(),this._renderFieldStyle()}},{key:"_remove",value:function(){GW(XW(i.prototype),"_remove",this).call(this),this._removeField(),this._removeStatus(),this._removeLabel(),this._removeIcon(),this.removeMandatoryIndicator(),this._removeDisabledCopyOverlay(),this._uninstallDragAndDropHandler()}},{key:"setFieldStyle",value:function(e){this.setProperty("fieldStyle",e)}},{key:"_renderFieldStyle",value:function(){if(this._renderFieldStyleInternal(this.$container),this._renderFieldStyleInternal(this.$fieldContainer),this._renderFieldStyleInternal(this.$field),this.rendered){var e=this.htmlComp.getParent();e&&e.invalidateLayoutTree(),this.invalidateLayoutTree()}}},{key:"_renderFieldStyleInternal",value:function(e){e&&e.toggleClass("alternative",this.fieldStyle===i.FieldStyle.ALTERNATIVE)}},{key:"setMandatory",value:function(e){this.setProperty("mandatory",e)}},{key:"_renderMandatory",value:function(){this.$container.toggleClass("mandatory",this.mandatory)}},{key:"_errorStatus",value:function(){return this.errorStatus}},{key:"setErrorStatus",value:function(e){this.setProperty("errorStatus",e)}},{key:"_setErrorStatus",value:function(e){e=Br.ensure(e),this._setProperty("errorStatus",e)}},{key:"addErrorStatus",value:function(e){if(!(e instanceof Br))throw new Error("errorStatus is not a Status");var t=this._errorStatus();(t=t?t.ensureChildren():Br.ok("Root")).addStatus(e),this.setErrorStatus(t)}},{key:"containsStatus",value:function(e){return!!this.errorStatus&&this.errorStatus.containsStatus(e)}},{key:"setSuppressStatus",value:function(e){this.setProperty("suppressStatus",e)}},{key:"_renderSuppressStatus",value:function(){this._renderErrorStatus()}},{key:"_isSuppressStatusIcon",value:function(){return O.isOneOf(this.suppressStatus,i.SuppressStatus.ALL,i.SuppressStatus.ICON)}},{key:"_isSuppressStatusField",value:function(){return O.isOneOf(this.suppressStatus,i.SuppressStatus.ALL,i.SuppressStatus.FIELD)}},{key:"removeErrorStatus",value:function(e){this.removeErrorStatusByPredicate((function(t){return t instanceof e}))}},{key:"removeErrorStatusByPredicate",value:function(e){var t=this._errorStatus();if(t&&t.containsStatusByPredicate(e)){var n=t.clone();n.removeAllStatusByPredicate(e),n.hasChildren()?this.setErrorStatus(n):this.clearErrorStatus()}}},{key:"clearErrorStatus",value:function(){this.setErrorStatus(null)}},{key:"_renderErrorStatus",value:function(){var e=this._errorStatus(),t=!!e,n=t&&!this._isSuppressStatusField()?"has-"+e.cssClass():"";this._updateErrorStatusClasses(n,t),this._updateFieldStatus()}},{key:"_updateErrorStatusClasses",value:function(e,t){this._updateErrorStatusClassesOnElement(this.$container,e,t),this._updateErrorStatusClassesOnElement(this.$field,e,t)}},{key:"_updateErrorStatusClassesOnElement",value:function(e,t,n){e&&e.removeClass(i.SEVERITY_CSS_CLASSES).addClass(t,n)}},{key:"setTooltipText",value:function(e){this.setProperty("tooltipText",e)}},{key:"_renderTooltipText",value:function(){this._updateTooltip()}},{key:"setTooltipAnchor",value:function(e){this.setProperty("tooltipAnchor",e)}},{key:"_renderTooltipAnchor",value:function(){this._updateTooltip()}},{key:"_updateTooltip",value:function(){var e=this.hasStatusTooltip();if(this.$container.toggleClass("has-tooltip",e),this.$field&&this.$field.toggleClass("has-tooltip",e),this._updateFieldStatus(),this.$fieldContainer)if(this.hasOnFieldTooltip()){var t=this.onFieldTooltipOptionsCreator||this._createOnFieldTooltipOptions;xp.install(this.$fieldContainer,t.call(this))}else xp.uninstall(this.$fieldContainer)}},{key:"hasStatusTooltip",value:function(){return this.tooltipAnchor===i.TooltipAnchor.DEFAULT&&Wn.hasText(this.tooltipText)}},{key:"hasOnFieldTooltip",value:function(){return this.tooltipAnchor===i.TooltipAnchor.ON_FIELD&&Wn.hasText(this.tooltipText)}},{key:"setOnFieldTooltipOptionsCreator",value:function(e){this.onFieldTooltipOptionsCreator=e}},{key:"_createOnFieldTooltipOptions",value:function(){return{parent:this,text:this.tooltipText,arrowPosition:50}}},{key:"_renderVisible",value:function(){GW(XW(i.prototype),"_renderVisible",this).call(this),this.rendered&&this._renderErrorStatus()}},{key:"setLabel",value:function(e){this.setProperty("label",e)}},{key:"_renderLabel",value:function(){var e=this.label;this.labelPosition===i.LabelPosition.ON_FIELD?(this._renderPlaceholder(),this.$label&&this.$label.text("")):this.$label&&(this._removePlaceholder(),this.$label.contentOrNbsp(this.labelHtmlEnabled,e,"empty").toggleClass("top",this.labelPosition===i.LabelPosition.TOP),(this.labelUseUiWidth||this.labelWidthInPixel===i.LabelWidth.UI)&&this.invalidateLayoutTree())}},{key:"_renderEmptyLabel",value:function(){this.$label.html("&nbsp;").toggleClass("top",this.labelPosition===i.LabelPosition.TOP)}},{key:"_renderPlaceholder",value:function(e){(e=O.nvl(e,this.$field))&&e.placeholder(this.label)}},{key:"_removePlaceholder",value:function(e){(e=O.nvl(e,this.$field))&&e.placeholder("")}},{key:"setLabelVisible",value:function(e){this.setProperty("labelVisible",e)}},{key:"_renderLabelVisible",value:function(){var e=this.labelVisible;if(this._renderChildVisible(this.$label,e),this.$container.toggleClass("label-hidden",!e),this.rendered&&this.labelPosition===i.LabelPosition.TOP){var t=this.htmlComp.getParent();t&&t.invalidateLayoutTree()}}},{key:"setLabelWidthInPixel",value:function(e){this.setProperty("labelWidthInPixel",e)}},{key:"_renderLabelWidthInPixel",value:function(){this.invalidateLayoutTree()}},{key:"setLabelUseUiWidth",value:function(e){this.setProperty("labelUseUiWidth",e)}},{key:"_renderLabelUseUiWidth",value:function(){this.invalidateLayoutTree()}},{key:"setStatusVisible",value:function(e){this.setProperty("statusVisible",e)}},{key:"_renderStatusVisible",value:function(){this._updateFieldStatus()}},{key:"setStatusPosition",value:function(e){this.setProperty("statusPosition",e)}},{key:"_renderStatusPosition",value:function(e){this._updateFieldStatus()}},{key:"_tooltip",value:function(){return this.fieldStatus?this.fieldStatus.tooltip:null}},{key:"_updateFieldStatus",value:function(){if(this.fieldStatus){var e,t=this._errorStatus(),n=null,r=this._computeStatusVisible(),o=!0;if(this.fieldStatus.setPosition(this.statusPosition),this.fieldStatus.setVisible(r),r){if(t){if(this.mode===i.Mode.CELLEDITOR)return;o=!(n=t).isError(),e=this._getMenusForStatus(t)}else this.hasStatusTooltip()?(n=O.create("Status",{message:this.tooltipText,severity:Br.Severity.OK}),e=this._getCurrentMenus()):e=this._getCurrentMenus();this.fieldStatus.update(n,e,o,this._isInitialShowStatus())}}}},{key:"_isInitialShowStatus",value:function(){return!!this._errorStatus()}},{key:"_computeStatusVisible",value:function(){var e=this._errorStatus(),t=this.statusVisible,n=!!e,r=this.hasStatusTooltip();return!this._isSuppressStatusIcon()&&this.visible&&(t||n||r||this._hasMenus()&&this.menusVisible)}},{key:"_renderChildVisible",value:function(e,t){if(e)return e.isVisible()!==t?(e.setVisible(t),this.invalidateLayoutTree(),!0):void 0}},{key:"setLabelPosition",value:function(e){this.setProperty("labelPosition",e)}},{key:"_renderLabelPosition",value:function(e){if(this._renderLabel(),this.rendered){var t=this.htmlComp.getParent();t&&t.invalidateLayoutTree(),this.invalidateLayoutTree()}}},{key:"setLabelHtmlEnabled",value:function(e){this.setProperty("labelHtmlEnabled",e)}},{key:"_renderLabelHtmlEnabled",value:function(){this._renderLabel()}},{key:"_renderEnabled",value:function(){GW(XW(i.prototype),"_renderEnabled",this).call(this),this.$field&&this.$field.setEnabled(this.enabledComputed),this._updateDisabledCopyOverlay(),this._installOrUninstallDragAndDropHandler()}},{key:"_renderDisabledStyle",value:function(){this._renderDisabledStyleInternal(this.$container),this._renderDisabledStyleInternal(this.$fieldContainer),this._renderDisabledStyleInternal(this.$field),this._renderDisabledStyleInternal(this.$mandatory)}},{key:"setFont",value:function(e){this.setProperty("font",e)}},{key:"_renderFont",value:function(){To.legacyFont(this,this.$field)}},{key:"setForegroundColor",value:function(e){this.setProperty("foregroundColor",e)}},{key:"_renderForegroundColor",value:function(){To.legacyForegroundColor(this,this.$field)}},{key:"setBackgroundColor",value:function(e){this.setProperty("backgroundColor",e)}},{key:"_renderBackgroundColor",value:function(){To.legacyBackgroundColor(this,this.$field)}},{key:"setLabelFont",value:function(e){this.setProperty("labelFont",e)}},{key:"_renderLabelFont",value:function(){To.legacyFont(this,this.$label,"label")}},{key:"setLabelForegroundColor",value:function(e){this.setProperty("labelForegroundColor",e)}},{key:"_renderLabelForegroundColor",value:function(){To.legacyForegroundColor(this,this.$label,"label")}},{key:"setLabelBackgroundColor",value:function(e){this.setProperty("labelBackgroundColor",e)}},{key:"_renderLabelBackgroundColor",value:function(){To.legacyBackgroundColor(this,this.$label,"label")}},{key:"setGridDataHints",value:function(e){this.setProperty("gridDataHints",e)}},{key:"_setGridDataHints",value:function(e){e||(e=new Ez),this._setProperty("gridDataHints",Ez.ensure(e))}},{key:"_renderGridDataHints",value:function(){this.parent.invalidateLogicalGrid()}},{key:"_setGridData",value:function(e){e||(e=new Ez),this._setProperty("gridData",Ez.ensure(e))}},{key:"_renderGridData",value:function(){if(this.rendered){var e=this.htmlComp.getParent();e&&e.invalidateLayoutTree()}}},{key:"setMenus",value:function(e){this.setProperty("menus",e)}},{key:"_setMenus",value:function(e){e=rt.ensure(e),this.menus.forEach((function(e){e.off("propertyChange",this._menuPropertyChangeHandler)}),this),this.updateKeyStrokes(e,this.menus),this._setProperty("menus",e),this.menus.forEach((function(e){e.on("propertyChange",this._menuPropertyChangeHandler)}),this)}},{key:"insertMenu",value:function(e){this.insertMenus([e])}},{key:"insertMenus",value:function(e){0!==(e=rt.ensure(e)).length&&this.setMenus(this.menus.concat(e))}},{key:"deleteMenu",value:function(e){this.deleteMenus([e])}},{key:"deleteMenus",value:function(e){if(0!==(e=rt.ensure(e)).length){var t=this.menus.slice();rt.removeAll(t,e),this.setMenus(t)}}},{key:"_onMenuPropertyChange",value:function(e){"visible"===e.propertyName&&this.rendered&&this._updateMenus()}},{key:"_getCurrentMenus",value:function(){return this.menus.filter((function(e){return e.visible}))}},{key:"_getMenusForStatus",value:function(e){return this.statusMenuMappings.filter((function(t){return!(!t.menu||!t.menu.visible)&&(0===t.codes.length||t.codes.indexOf(e.code)>-1)&&(0===t.severities.length||t.severities.indexOf(e.severity)>-1)})).map((function(e){return e.menu}))}},{key:"_hasMenus",value:function(){return!!(this.menus&&this._getCurrentMenus().length>0)}},{key:"_updateMenus",value:function(){this.$container.toggleClass("has-menus",this._hasMenus()&&this.menusVisible),this._updateFieldStatus()}},{key:"_renderMenus",value:function(){this._updateMenus()}},{key:"_renderStatusMenuMappings",value:function(){this._updateMenus()}},{key:"setMenusVisible",value:function(e){this.setProperty("menusVisible",e)}},{key:"_setMenusVisible",value:function(e){this._setProperty("menusVisible",e)}},{key:"_renderMenusVisible",value:function(){this._updateMenus()}},{key:"_setKeyStrokes",value:function(e){this.updateKeyStrokes(e,this.keyStrokes),this._setProperty("keyStrokes",e)}},{key:"_$tooltipParent",value:function(){}},{key:"_hideStatusMessage",value:function(){this.fieldStatus&&this.fieldStatus.hideTooltip()}},{key:"_showContextMenu",value:function(){var e=this._getCurrentMenus();0!==e.length&&(this._hideStatusMessage(),this.contextPopup=O.create("ContextMenuPopup",{parent:this,$anchor:this.$status,menuItems:e,cloneMenuItems:!1,closeOnAnchorMouseDown:!1}),this.contextPopup.open())}},{key:"_hideContextMenu",value:function(){this.contextPopup&&(this.contextPopup.close(),this.contextPopup=null)}},{key:"_renderPreventInitialFocus",value:function(){this.$container.toggleClass("prevent-initial-focus",!!this.preventInitialFocus)}},{key:"focus",value:function(){if(!this.rendered)return this.session.layoutValidator.schedulePostValidateFunction(this.focus.bind(this)),!1;if(!this.enabledComputed)return!1;var e=this.getFocusableElement();return!!e&&this.session.focusManager.requestFocus(e)}},{key:"getFocusableElement",value:function(){return this.rendered&&this.$field?this.$field[0]:null}},{key:"_onFieldFocus",value:function(e){this.setFocused(!0)}},{key:"_onFieldBlur",value:function(){this.setFocused(!1)}},{key:"activate",value:function(){if(this.enabledComputed&&this.rendered){var e=this.getFocusableElement();e&&s.a.ensure(e).focus()}}},{key:"get$Scrollable",value:function(){return this.$field}},{key:"getParentGroupBox",value:function(){for(var e=this.parent;e&&!(e instanceof gJ);)e=e.parent;return e}},{key:"getParentField",value:function(){return this.parent}},{key:"addLabel",value:function(){this.$label=this.$container.appendElement("<label>"),xp.installForEllipsis(this.$label,{parent:this}),this.$label.on("click",this._onLabelClick.bind(this))}},{key:"_onLabelClick",value:function(e){Wn.hasText(this.label)&&this.activate()}},{key:"_removeLabel",value:function(){this.$label&&(xp.uninstall(this.$label),this.$label.remove(),this.$label=null)}},{key:"_linkWithLabel",value:function(e){this.$label&&e&&TW.linkElementWithLabel(e,this.$label)}},{key:"_removeIcon",value:function(){this.$icon&&(this.$icon.remove(),this.$icon=null)}},{key:"addField",value:function(e){this.$fieldContainer||this.addFieldContainer(e),this.$field=e,this._linkWithLabel(e),this.$field.on("blur",this._onFieldBlur.bind(this)).on("focus",this._onFieldFocus.bind(this))}},{key:"addFieldContainer",value:function(e){this.$fieldContainer=e.addClass("field"),(0===this.$container.has(e).length||e.next().length>0)&&e.appendTo(this.$container)}},{key:"_removeField",value:function(){this.$field&&(this.$field.remove(),this.$field=null),this.$fieldContainer&&(this.$fieldContainer.remove(),this.$fieldContainer=null)}},{key:"addStatus",value:function(){this.fieldStatus||(this.fieldStatus=O.create("FieldStatus",{parent:this,position:this.statusPosition,visible:this._computeStatusVisible()}),this.fieldStatus.render(),this.$status=this.fieldStatus.$container,this._updateFieldStatus())}},{key:"_removeStatus",value:function(){this.fieldStatus&&(this.fieldStatus.remove(),this.$status=null,this.fieldStatus=null)}},{key:"addPseudoStatus",value:function(){this.$pseudoStatus=this.$container.appendSpan("status")}},{key:"addMandatoryIndicator",value:function(){this.$mandatory=this.$container.appendSpan("mandatory-indicator")}},{key:"removeMandatoryIndicator",value:function(){this.$mandatory&&(this.$mandatory.remove(),this.$mandatory=null)}},{key:"addIcon",value:function(e){e||(e=this.$container),this.$icon=TW.appendIcon(e).on("mousedown",this._onIconMouseDown.bind(this))}},{key:"_onIconMouseDown",value:function(e){this.enabledComputed&&this.$field.focus()}},{key:"addContainer",value:function(e,t,n){this.$container=e.appendDiv("form-field"),t&&this.$container.addClass(t);var r=ea.install(this.$container,this.session);r.setLayout(n||this._createLayout()),this.htmlComp=r}},{key:"_createLayout",value:function(){return new dz(this)}},{key:"updateInnerAlignment",value:function(e){var t=(e=e||{}).$fieldContainer||this.$fieldContainer;this._updateElementInnerAlignment(e,t),t!==this.$container&&this._updateElementInnerAlignment(e,this.$container)}},{key:"_updateElementInnerAlignment",value:function(e,t){e=e||{};var n=O.nvl(e.useHorizontalAlignment,!0),r=O.nvl(e.useVerticalAlignment,!0);if(t&&(t.removeClass("has-inner-alignment halign-left halign-center halign-right valign-top valign-middle valign-bottom"),n||r)){t.addClass("has-inner-alignment");var o=this.gridData;if(this.parent.logicalGrid&&(o=this.gridDataHints),n){var i=o.horizontalAlignment;t.addClass(i<0?"halign-left":i>0?"halign-right":"halign-center")}if(r){var s=o.verticalAlignment;t.addClass(s<0?"valign-top":s>0?"valign-bottom":"valign-middle")}this.invalidateLayout()}}},{key:"addCellEditorFieldCssClasses",value:function(e,t){e.addClass("cell-editor-field").addClass(Kt.get().cssClassForEdge()),t.cssClass&&e.addClass(t.cssClass)}},{key:"prepareForCellEdit",value:function(e){e=e||{},this.$mandatory&&this.removeMandatoryIndicator(),this.$status&&(this.$status.remove(),this.$status=null),this.$container&&this.$container.addClass("cell-editor-form-field"),this.$field&&this.addCellEditorFieldCssClasses(this.$field,e)}},{key:"setDropType",value:function(e){this.setProperty("dropType",e)}},{key:"_renderDropType",value:function(){this._installOrUninstallDragAndDropHandler()}},{key:"setDropMaximumSize",value:function(e){this.setProperty("dropMaximumSize",e)}},{key:"_createDragAndDropHandler",value:function(){var e=this;return rn.handler(this,{supportedScoutTypes:rn.SCOUT_TYPES.FILE_TRANSFER,onDrop:function(t){return e.trigger("drop",t)},dropType:function(){return e.dropType},dropMaximumSize:function(){return e.dropMaximumSize}})}},{key:"_installOrUninstallDragAndDropHandler",value:function(){this.dropType&&this.enabledComputed?this._installDragAndDropHandler():this._uninstallDragAndDropHandler()}},{key:"_installDragAndDropHandler",value:function(){this.dragAndDropHandler||(this.dragAndDropHandler=this._createDragAndDropHandler(),this.dragAndDropHandler&&this.dragAndDropHandler.install(this.$field||this.$container))}},{key:"_uninstallDragAndDropHandler",value:function(){this.dragAndDropHandler&&(this.dragAndDropHandler.uninstall(),this.dragAndDropHandler=null)}},{key:"_updateDisabledCopyOverlay",value:function(){this.disabledCopyOverlay&&!Kt.get().supportsCopyFromDisabledInputFields()&&(this.enabledComputed?this._removeDisabledCopyOverlay():(this._renderDisabledCopyOverlay(),this.revalidateLayout()))}},{key:"_renderDisabledCopyOverlay",value:function(){this.$disabledCopyOverlay||(this.$disabledCopyOverlay=this.$container.appendDiv("disabled-overlay").on("contextmenu",this._createCopyContextMenu.bind(this)))}},{key:"_removeDisabledCopyOverlay",value:function(){this.$disabledCopyOverlay&&(this.$disabledCopyOverlay.remove(),this.$disabledCopyOverlay=null)}},{key:"_createCopyContextMenu",value:function(e){var t=this;if(this.visible&&!Wn.empty(this.displayText)){var n=O.create("Menu",{parent:this,text:this.session.text("ui.Copy"),inheritAccessibility:!1});n.on("action",(function(e){t.exportToClipboard()})),O.create("ContextMenuPopup",{parent:this,menuItems:[n],cloneMenuItems:!1,location:{x:e.pageX,y:e.pageY}}).open()}}},{key:"visitFields",value:function(e){return e(this)}},{key:"visitParents",value:function(e){for(var t=this.parent;t instanceof i;)e(t),t=t.parent}},{key:"markAsSaved",value:function(){this.setProperty("touched",!1),this.updateRequiresSave()}},{key:"touch",value:function(){this.setProperty("touched",!0),this.updateRequiresSave()}},{key:"updateRequiresSave",value:function(){this.initialized&&(this.requiresSave=this.touched||this.computeRequiresSave())}},{key:"computeRequiresSave",value:function(){return!1}},{key:"getValidationResult",value:function(){var e=!this._errorStatus(),t=!this.mandatory||!this.empty;return{valid:e&&t,validByErrorStatus:e,validByMandatory:t}}},{key:"_updateEmpty",value:function(){}},{key:"requestInput",value:function(){this.enabledComputed&&this.rendered&&this.focus()}},{key:"clone",value:function(e,t){var n=GW(XW(i.prototype),"clone",this).call(this,e,t);return this._deepCloneProperties(n,"menus",t),n}},{key:"exportToClipboard",value:function(){if(this.displayText){var e=new sn({text:this.displayText});this.trigger("clipboardExport",e),e.defaultPrevented||this._exportToClipboard(e.text)}}},{key:"_exportToClipboard",value:function(e){ct.copyText({parent:this,text:e})}}])&&zW(t.prototype,n),r&&zW(t,r),i}(ve);function QW(e){return(QW="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ez(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function tz(e,t,n){return(tz="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=iz(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function nz(e,t){return(nz=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function rz(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=iz(e);if(t){var o=iz(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return oz(this,n)}}function oz(e,t){return!t||"object"!==QW(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function iz(e){return(iz=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}JW(ZW,"FieldStyle",{CLASSIC:"classic",ALTERNATIVE:"alternative"}),JW(ZW,"SuppressStatus",{ALL:"all",ICON:"icon",FIELD:"field"}),JW(ZW,"DEFAULT_FIELD_STYLE",ZW.FieldStyle.ALTERNATIVE),JW(ZW,"StatusPosition",{DEFAULT:"default",TOP:"top"}),JW(ZW,"LabelPosition",{DEFAULT:0,LEFT:1,ON_FIELD:2,RIGHT:3,TOP:4,BOTTOM:5}),JW(ZW,"TooltipAnchor",{DEFAULT:"default",ON_FIELD:"onField"}),JW(ZW,"LabelWidth",{DEFAULT:0,UI:-1}),JW(ZW,"FULL_WIDTH",0),JW(ZW,"Mode",{DEFAULT:"default",CELLEDITOR:"celleditor"}),JW(ZW,"SEVERITY_CSS_CLASSES","has-error has-warning has-info has-ok");var sz=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&nz(e,t)}(i,e);var t,n,r,o=rz(i);function i(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(e=o.call(this)).enabledWhenOffline=!1,e}return t=i,(n=[{key:"_goOffline",value:function(){this.enabledWhenOffline||(this._enabledBeforeOffline=this.widget.enabled,this.widget.setEnabled(!1))}},{key:"_goOnline",value:function(){this.enabledWhenOffline||this.widget.setEnabled(this._enabledBeforeOffline)}},{key:"_onWidgetEvent",value:function(e){"drop"===e.type&&this.widget.dragAndDropHandler?this.widget.dragAndDropHandler.uploadFiles(e.files):tz(iz(i.prototype),"_onWidgetEvent",this).call(this,e)}}])&&ez(t.prototype,n),r&&ez(t,r),i}(de);function az(e){return(az="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function lz(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function uz(e,t){return(uz=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function cz(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pz(e);if(t){var o=pz(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return fz(this,n)}}function fz(e,t){return!t||"object"!==az(t)&&"function"!=typeof t?hz(e):t}function hz(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function pz(e){return(pz=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var dz=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&uz(e,t)}(i,e);var t,n,r,o=cz(i);function i(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(t=o.call(this)).formField=e,t._initDefaults(),t.htmlPropertyChangeHandler=t._onHtmlEnvironmentPropertyChange.bind(hz(t)),Xs.get().on("propertyChange",t.htmlPropertyChangeHandler),t.formField.one("remove",(function(){Xs.get().off("propertyChange",t.htmlPropertyChangeHandler)})),t}return t=i,(n=[{key:"_initDefaults",value:function(){this.mandatoryIndicatorWidth=Xs.get().fieldMandatoryIndicatorWidth,this.statusWidth=Xs.get().fieldStatusWidth,this.rowHeight=Xs.get().formRowHeight,this.compactFieldWidth=i.COMPACT_FIELD_WIDTH}},{key:"_onHtmlEnvironmentPropertyChange",value:function(){this._initDefaults(),this.formField.invalidateLayoutTree()}},{key:"layout",value:function(e){var t,n,r,o,i,s,a,l,u,c,f=ea.get(e),h=this.formField,p=h._tooltip(),d=this.labelWidth(),y=this.statusWidth;if(a=(t=f.insets({includeBorder:!1})).top,c=t.right,l=t.bottom,u=t.left,this._isLabelVisible())if((h.labelWidthInPixel===ZW.LabelWidth.UI||h.labelUseUiWidth)&&(d=h.$label.hasClass("empty")?0:qs.prefSize(h.$label).width),O.isOneOf(h.labelPosition,ZW.LabelPosition.DEFAULT,ZW.LabelPosition.LEFT))qs.setBounds(h.$label,u,a,d,this.rowHeight),u+=d+h.$label.cssMarginX();else if(h.labelPosition===ZW.LabelPosition.TOP){var v=qs.prefSize(h.$label).height;h.$label.cssHeight(v),a+=v+h.$label.cssMarginY(),s=!0}if(h.$mandatory&&h.$mandatory.isVisible()&&(h.$mandatory.cssTop(a).cssLeft(u).cssWidth(this.mandatoryIndicatorWidth),u+=h.$mandatory.outerWidth(!0)),this._isStatusVisible())if(h.$status.cssWidth(y),h.statusPosition===ZW.StatusPosition.TOP&&s){var b=qs.prefSize(h.$status,{useCssSize:!0}).height,m=t.top+h.$label.cssPaddingTop()+h.$label.height()/2-b/2;h.$status.cssTop(m).cssRight(c+h.$label.cssMarginRight()).cssHeight(b).cssLineHeight(null);var g=qs.size(h.$status,!0).width;h.$label.cssPaddingRight(g)}else h.$status.cssTop(a).cssRight(c).cssHeight(this.rowHeight).cssLineHeight(this.rowHeight),c+=y+h.$status.cssMarginX();if(h.$fieldContainer){n=new Bs(a-t.top,c-t.right,l-t.bottom,u-t.left);var _=qs.margins(h.$fieldContainer);if(r=f.availableSize({exact:!0}).subtract(f.insets()).subtract(n).subtract(_),o=new Hs(u,a,r.width,r.height),"absolute"!==h.$fieldContainer.css("position")&&(o.x=0,o.y=0),(i=ea.optGet(h.$fieldContainer))?i.setBounds(o):qs.setBounds(h.$fieldContainer,o),this.compactFieldWidth>-1&&(h.$field.toggleClass("compact",o.width<=this.compactFieldWidth),h.$container.toggleClass("compact",o.width<=this.compactFieldWidth)),s){var w=r.add(_).width-h.$label.cssMarginX();h.$mandatory&&h.$mandatory.isVisible()&&(w+=h.$mandatory.outerWidth(!0)),h.$label.cssWidth(w)}}if(h.$fieldContainer){var k=this._$elementForIconLayout(),S=qs.borders(k),T=qs.offsetBounds(k);a+=S.top,c+=S.right,o.x+=S.left,o.y+=S.top,o.height=T.height-S.top-S.bottom,o.width=T.width-S.left-S.right,h.$icon&&this._layoutIcon(h,o,c,a),h.$clearIcon&&this._layoutClearIcon(h,o,c,a)}p&&p.rendered&&p.position(),h.$field&&Lh.update(h.$field,!0),this._layoutDisabledCopyOverlay()}},{key:"_layoutDisabledCopyOverlay",value:function(){if(this.formField.$field&&this.formField.$disabledCopyOverlay){var e=this.formField.$disabledCopyOverlay,t=this.formField.$field,n=t.position(),r=qs.insets(t,{includePadding:!0}),o=t[0],i=t.css("overflow-x"),s=t.css("overflow-y"),a="scroll"===i||"auto"===i&&o.scrollWidth-o.clientWidth>0,l="scroll"===s||"auto"===s&&o.scrollHeight-o.clientHeight>0,u=Kt.get().scrollbarWidth;e.css("top",n.top).css("left",n.left).width(t.width()+r.horizontal()-(l?u:0)).height(t.height()+r.vertical()-(a?u:0))}}},{key:"_isLabelVisible",value:function(){return!!this.formField.$label&&this.formField.labelVisible}},{key:"_isStatusVisible",value:function(){return!!this.formField.$status&&(this.formField.statusVisible||this.formField.$status.isVisible())}},{key:"preferredLayoutSize",value:function(e,t){var n=ea.get(this.formField.$container),r=this.formField,o=new $s,i=new $s,s=new $s,a=new $s,l=O.nvl(t.widthHint,0),u=O.nvl(t.heightHint,0),c=r.statusPosition===ZW.StatusPosition.TOP&&this._isLabelVisible()&&r.labelPosition===ZW.LabelPosition.TOP;if(r.$mandatory&&r.$mandatory.isVisible()&&(i.width=this.mandatoryIndicatorWidth+r.$mandatory.cssMarginX(),l-=i.width),this._isLabelVisible()&&(o.width=this.labelWidth()+r.$label.cssMarginX(),o.height=this.rowHeight,r.labelPosition===ZW.LabelPosition.TOP?(o.width=0,o.height=qs.prefSize(r.$label,!0).height):(r.labelWidthInPixel===ZW.LabelWidth.UI||r.labelUseUiWidth)&&(r.$label.hasClass("empty")?o.width=0:o=qs.prefSize(r.$label,!0)),O.isOneOf(r.labelPosition,ZW.LabelPosition.DEFAULT,ZW.LabelPosition.LEFT)?l-=o.width:r.labelPosition===ZW.LabelPosition.TOP&&(u-=o.height)),this._isStatusVisible()&&(s.width=this.statusWidth+r.$status.cssMarginX(),c||(s.height=this.rowHeight,l-=s.width)),r.$fieldContainer){var f=qs.margins(r.$fieldContainer),h=ea.optGet(r.$fieldContainer);h||(l-=f.horizontal(),u-=f.vertical()),t.widthHint&&(t.widthHint=l),t.heightHint&&(t.heightHint=u),a=h?h.prefSize(t).add(f):qs.prefSize(r.$fieldContainer,t).add(f)}var p=new $s;return p.width=a.width,p.height=a.height,p.width+=i.width,p.height=Math.max(p.height,i.height),O.isOneOf(r.labelPosition,ZW.LabelPosition.DEFAULT,ZW.LabelPosition.LEFT)?(p.width+=o.width,p.height=Math.max(p.height,o.height)):r.labelPosition===ZW.LabelPosition.TOP&&(p.width=Math.max(p.width,o.width),p.height+=o.height),c||(p.width+=s.width,p.height=Math.max(p.height,s.height)),p=p.add(n.insets())}},{key:"_$elementForIconLayout",value:function(){return this.formField.$field}},{key:"_layoutIcon",value:function(e,t,n,r){var o=this.rowHeight;t&&(o=t.height),e.$icon.cssRight(n).cssTop(t.y).cssHeight(o).cssLineHeight(o)}},{key:"_layoutClearIcon",value:function(e,t,n,r){var o=this.rowHeight;t&&(o=t.height),e instanceof yG&&e.gridData.horizontalAlignment>0?e.$clearIcon.cssLeft(t.x).cssRight("").cssTop(t.y).cssHeight(o).cssLineHeight(o):e.$clearIcon.cssLeft("").cssRight(n).cssTop(t.y).cssHeight(o).cssLineHeight(o)}},{key:"labelWidth",value:function(){return ZW.LabelWidth.DEFAULT===this.formField.labelWidthInPixel?Xs.get().fieldLabelWidth:this.formField.labelWidthInPixel}}])&&lz(t.prototype,n),r&&lz(t,r),i}(Zs);function yz(e){return(yz="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function vz(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function bz(e,t,n){return(bz="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=wz(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function mz(e,t){return(mz=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function gz(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=wz(e);if(t){var o=wz(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return _z(this,n)}}function _z(e,t){return!t||"object"!==yz(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function wz(e){return(wz=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}!function(e,t,n){t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}(dz,"COMPACT_FIELD_WIDTH",61);var kz=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&mz(e,t)}(i,e);var t,n,r,o=gz(i);function i(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(e=o.call(this)).codes=[],e.severities=[],e.menu=null,e._addWidgetProperties(["menu"]),e}return t=i,(n=[{key:"_createChild",value:function(e){if("string"==typeof e){var t=this.parent.widget(e);if(!t)throw new Error("Referenced widget not found: "+e);return t}return bz(wz(i.prototype),"_createChild",this).call(this,e)}}])&&vz(t.prototype,n),r&&vz(t,r),i}(ve);function Sz(e){return(Sz="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Oz(e,t){return(Oz=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Tz(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Pz(e);if(t){var o=Pz(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Cz(this,n)}}function Cz(e,t){return!t||"object"!==Sz(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Pz(e){return(Pz=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Rz=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Oz(e,t)}(n,e);var t=Tz(n);function n(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),t.call(this)}return n}(de);function xz(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Ez=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),t=t||{},this.x=-1,this.y=-1,this.w=1,this.h=1,this.weightX=-1,this.weightY=-1,this.useUiWidth=!1,this.useUiHeight=!1,this.horizontalAlignment=-1,this.verticalAlignment=-1,this.fillHorizontal=!0,this.fillVertical=!0,this.widthInPixel=0,this.heightInPixel=0,s.a.extend(this,t)}var t,n,r;return t=e,r=[{key:"createFromHints",value:function(t,n){var r=new e(t.gridDataHints);return r.w===ZW.FULL_WIDTH&&(r.w=n),r}},{key:"ensure",value:function(t){return t?t instanceof e?t:new e(t):t}}],(n=null)&&xz(t.prototype,n),r&&xz(t,r),e}();function Dz(e){return(Dz="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Az(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Fz(e,t,n){return(Fz="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Mz(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function $z(e,t){return($z=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function jz(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Mz(e);if(t){var o=Mz(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Bz(this,n)}}function Bz(e,t){return!t||"object"!==Dz(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Mz(e){return(Mz=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Iz=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&$z(e,t)}(i,e);var t,n,r,o=jz(i);function i(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),o.call(this)}return t=i,(n=[{key:"getFields",value:function(){throw new Error("Not implemented")}},{key:"setFields",value:function(e){throw new Error("Not implemented")}},{key:"visitFields",value:function(e){var t=Fz(Mz(i.prototype),"visitFields",this).call(this,e);if(t===iU.TERMINATE)return iU.TERMINATE;if(t===iU.SKIP_SUBTREE)return iU.CONTINUE;for(var n=this.getFields(),r=0;r<n.length;r++)if((t=n[r].visitFields(e))===iU.TERMINATE)return iU.TERMINATE}},{key:"setFieldStyle",value:function(e){this.getFields().forEach((function(t){t.setFieldStyle(e)})),Fz(Mz(i.prototype),"setFieldStyle",this).call(this,e)}},{key:"activate",value:function(){TW.activateFirstField(this,this.getFields())}},{key:"getFocusableElement",value:function(){var e=me.findFirstFocusableWidget(this.getFields(),this);return e?e.getFocusableElement():null}}])&&Az(t.prototype,n),r&&Az(t,r),i}(ZW);function Lz(e){return(Lz="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Hz(e,t){return(Hz=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Nz(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Wz(e);if(t){var o=Wz(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Vz(this,n)}}function Vz(e,t){return!t||"object"!==Lz(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Wz(e){return(Wz=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var zz=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Hz(e,t)}(n,e);var t=Nz(n);function n(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),(e=t.call(this)).enabledWhenOffline=!0,e}return n}(sz);function Gz(e){return(Gz="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Uz(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Kz(e,t,n){return(Kz="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Zz(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function qz(e,t){return(qz=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Yz(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Zz(e);if(t){var o=Zz(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Xz(this,n)}}function Xz(e,t){return!t||"object"!==Gz(t)&&"function"!=typeof t?Jz(e):t}function Jz(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Zz(e){return(Zz=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Qz=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&qz(e,t)}(i,e);var t,n,r,o=Yz(i);function i(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(e=o.call(this)).clearable=i.Clearable.FOCUSED,e.displayText=null,e.formatter=e._formatValue.bind(Jz(e)),e.hasText=!1,e.initialValue=null,e.invalidValueMessageKey="InvalidValueMessageX",e.parser=e._parseValue.bind(Jz(e)),e.value=null,e.validators=[],e.validators.push(e._validateValue.bind(Jz(e))),e.$clearIcon=null,e._addCloneProperties(["value","displayText","clearable"]),e}return t=i,r=[{key:"invokeValueFieldAboutToBlurByMouseDown",value:function(e){var t=this._getActiveValueField(e);t&&t.aboutToBlurByMouseDown(e)}},{key:"invokeValueFieldAcceptInput",value:function(e){var t=this._getActiveValueField(e);t&&t.acceptInput()}},{key:"_getActiveValueField",value:function(e){var t=s()(e).activeElement(),n=O.widget(t);return n instanceof i&&n.enabledComputed?n:null}}],(n=[{key:"_init",value:function(e){Kz(Zz(i.prototype),"_init",this).call(this,e),this.validator&&(this.setValidator(this.validator),delete this.validator),this._initValue(this.value)}},{key:"_initValue",value:function(e){this.value=null,this._setValue(e),this._updateEmpty()}},{key:"_renderProperties",value:function(){Kz(Zz(i.prototype),"_renderProperties",this).call(this),this._renderDisplayText(),this._renderClearable(),this._renderHasText()}},{key:"_remove",value:function(){Kz(Zz(i.prototype),"_remove",this).call(this),this.$clearIcon=null}},{key:"_renderDisplayText",value:function(){this._updateHasText()}},{key:"_readDisplayText",value:function(){return""}},{key:"_onClearIconMouseDown",value:function(e){this.clear(),e.preventDefault()}},{key:"_onFieldBlur",value:function(){Kz(Zz(i.prototype),"_onFieldBlur",this).call(this),this.acceptInput(!1)}},{key:"acceptInput",value:function(e){e=!!e;var t=O.nvl(this._readDisplayText(),"");this._checkDisplayTextChanged(t,e)&&(this._setProperty("displayText",t),e||this.parseAndSetValue(t),this._triggerAcceptInput(e))}},{key:"parseAndSetValue",value:function(e){this.removeErrorStatus(Xr);try{var t=new sn({displayText:e});if(this.trigger("parse",t),!t.defaultPrevented){var n=this.parseValue(e);this.setValue(n)}}catch(t){this._parsingFailed(e,t)}}},{key:"_parsingFailed",value:function(e,t){s.a.log.isDebugEnabled()&&s.a.log.debug("Parsing failed for field with id "+this.id,t);var n=new sn({displayText:e,error:t});this.trigger("parseError",n),n.defaultPrevented||this._addParsingFailedErrorStatus(e,t)}},{key:"_addParsingFailedErrorStatus",value:function(e,t){var n=this._createParsingFailedStatus(e,t);this.addErrorStatus(n)}},{key:"_createParsingFailedStatus",value:function(e,t){return this._createInvalidValueStatus("ParsingFailedStatus",e,t)}},{key:"setParser",value:function(e){this.setProperty("parser",e),this.initialized&&this.parseAndSetValue(this.displayText)}},{key:"_setParser",value:function(e){e||(e=this._parseValue.bind(this)),this._setProperty("parser",e)}},{key:"parseValue",value:function(e){var t=this._parseValue.bind(this);return this.parser(e,t)}},{key:"_parseValue",value:function(e){return e}},{key:"_checkDisplayTextChanged",value:function(e,t){return e!==O.nvl(this.displayText,"")}},{key:"aboutToBlurByMouseDown",value:function(e){this.isFocusOnField(e)||this.acceptInput()}},{key:"isFocused",value:function(){return this.rendered&&Uf.isActiveElement(this.$field)}},{key:"isFocusOnField",value:function(e){return this.$field.isOrHas(e)||this.$clearIcon&&this.$clearIcon.isOrHas(e)}},{key:"_triggerAcceptInput",value:function(e){var t={displayText:this.displayText,whileTyping:!!e};this.trigger("acceptInput",t)}},{key:"setDisplayText",value:function(e){this.setProperty("displayText",e)}},{key:"_updateHasText",value:function(){this.setHasText(Wn.hasText(this._readDisplayText()))}},{key:"setHasText",value:function(e){this.setProperty("hasText",e)}},{key:"_renderHasText",value:function(){this.$field&&this.$field.toggleClass("has-text",this.hasText),this.$container.toggleClass("has-text",this.hasText)}},{key:"setClearable",value:function(e){this.setProperty("clearable",e)}},{key:"_renderClearable",value:function(){this.isClearable()?this.$clearIcon||this.addClearIcon():this.$clearIcon&&(this.$clearIcon.remove(),this.$clearIcon=null),this.invalidateLayoutTree(!1),this._updateClearableStyles()}},{key:"_updateClearableStyles",value:function(){this.$container.removeClass("clearable-always clearable-focused"),this.isClearable()&&(this.clearable===i.Clearable.ALWAYS?this.$container.addClass("clearable-always"):this.clearable===i.Clearable.FOCUSED&&this.$container.addClass("clearable-focused"))}},{key:"isClearable",value:function(){return this.clearable===i.Clearable.ALWAYS||this.clearable===i.Clearable.FOCUSED}},{key:"clear",value:function(){this._clear(),this._updateHasText(),this.acceptInput(),this._triggerClear()}},{key:"_clear",value:function(){}},{key:"_triggerClear",value:function(){this.trigger("clear")}},{key:"setValue",value:function(e){e=this._prepareProperty("value",e),this.rendered&&this._callRemoveProperty("value"),this._callSetProperty("value",e),this.rendered&&this._callRenderProperty("value")}},{key:"resetValue",value:function(){this.setValue(this.initialValue)}},{key:"_ensureValue",value:function(e){return e}},{key:"_setValue",value:function(e){this.initialized&&(this.removeErrorStatus(Xr),this.removeErrorStatus(no));var t=this.value,n=null;try{n=this._ensureValue(e),this.value=this.validateValue(n)}catch(t){return n=n||e,void this._validationFailed(n,t)}this._updateDisplayText(),this._valueEquals(t,this.value)||(this._valueChanged(),this._updateTouched(),this._updateEmpty(),this.triggerPropertyChange("value",t,this.value))}},{key:"_valueEquals",value:function(e,t){return Pr.equals(e,t)}},{key:"_valueChanged",value:function(){}},{key:"validate",value:function(){this._setValue(this.value)}},{key:"addValidator",value:function(e,t){var n=this.validators.slice();n.push(e),this.setValidators(n,t)}},{key:"removeValidator",value:function(e,t){var n=this.validators.slice();rt.remove(n,e),this.setValidators(n,t)}},{key:"setValidator",value:function(e,t){e||(e=this._validateValue.bind(this));var n=[];e&&(n=[e]),this.setValidators(n,t)}},{key:"setValidators",value:function(e,t){this.setProperty("validators",e),this.initialized&&O.nvl(t,!0)&&this.validate()}},{key:"validateValue",value:function(e){var t=this._validateValue.bind(this);return this.validators.forEach((function(n){e=n(e,t)})),e=O.nvl(e,null)}},{key:"_validateValue",value:function(e){return"string"==typeof e&&""===e&&(e=null),e}},{key:"_validationFailed",value:function(e,t){s.a.log.isDebugEnabled()&&s.a.log.debug("Validation failed for field with id "+this.id,t);var n=this._createValidationFailedStatus(e,t);this.addErrorStatus(n),this._updateDisplayText(e)}},{key:"_createValidationFailedStatus",value:function(e,t){return this._createInvalidValueStatus("ValidationFailedStatus",e,t)}},{key:"_createInvalidValueStatus",value:function(e,t,n){if(n instanceof Br.classForName(e))return n;var r,o=Br.Severity.ERROR;return n instanceof Br?(r=n.message,o=n.severity):r="string"==typeof n?n:this.session.text(this.invalidValueMessageKey,t),O.create(e,{message:r,severity:o})}},{key:"_updateDisplayText",value:function(e){var t=this;if(this.initialized||Pr.isNullOrUndefined(this.displayText)){e=O.nvl(e,this.value);var n=this.formatValue(e);n&&s.a.isFunction(n.promise)?n.done(this.setDisplayText.bind(this)).fail((function(){t.setDisplayText(""),s.a.log.isInfoEnabled()&&s.a.log.info("Could not resolve display text for value: "+e)})):this.setDisplayText(n)}}},{key:"setFormatter",value:function(e){this.setProperty("formatter",e),this.initialized&&this.validate()}},{key:"_setFormatter",value:function(e){e||(e=this._formatValue.bind(this)),this._setProperty("formatter",e)}},{key:"formatValue",value:function(e){var t=this._formatValue.bind(this);return this.formatter(e,t)}},{key:"_formatValue",value:function(e){return O.nvl(e,"")+""}},{key:"_updateTouched",value:function(){this.touched=!this._valueEquals(this.value,this.initialValue)}},{key:"addClearIcon",value:function(e){e||(e=this.$container),this.$clearIcon=e.appendSpan("clear-icon needsclick unfocusable").on("mousedown",this._onClearIconMouseDown.bind(this))}},{key:"addContainer",value:function(e,t,n){Kz(Zz(i.prototype),"addContainer",this).call(this,e,t,n),this.$container.addClass("value-field")}},{key:"addField",value:function(e){Kz(Zz(i.prototype),"addField",this).call(this,e),this.$field.data("valuefield",this)}},{key:"setCurrentMenuTypes",value:function(e){this.setProperty("currentMenuTypes",e)}},{key:"_renderCurrentMenuTypes",value:function(){this._updateFieldStatus()}},{key:"_getCurrentMenus",value:function(){if(this.currentMenuTypes){var e=this.currentMenuTypes.map((function(e){return"ValueField."+e}));return zm.filter(this.menus,e)}return Kz(Zz(i.prototype),"_getCurrentMenus",this).call(this)}},{key:"markAsSaved",value:function(){Kz(Zz(i.prototype),"markAsSaved",this).call(this),this.initialValue=this.value}},{key:"_updateEmpty",value:function(){this.empty=null===this.value||void 0===this.value}}])&&Uz(t.prototype,n),r&&Uz(t,r),i}(ZW);function eG(e){return(eG="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function tG(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function nG(e,t,n){return(nG="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=sG(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function rG(e,t){return(rG=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function oG(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=sG(e);if(t){var o=sG(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return iG(this,n)}}function iG(e,t){return!t||"object"!==eG(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function sG(e){return(sG=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}!function(e,t,n){t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}(Qz,"Clearable",{ALWAYS:"always",FOCUSED:"focused",NEVER:"never"});var aG=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&rG(e,t)}(i,e);var t,n,r,o=oG(i);function i(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),o.call(this)}return t=i,(n=[{key:"_onWidgetAcceptInput",value:function(e){this._send("acceptInput",{displayText:e.displayText,whileTyping:e.whileTyping},{showBusyIndicator:!e.whileTyping,coalesce:function(e){return this.target===e.target&&this.type===e.type&&this.whileTyping===e.whileTyping}})}},{key:"_onWidgetEvent",value:function(e){"acceptInput"===e.type?this._onWidgetAcceptInput(e):nG(sG(i.prototype),"_onWidgetEvent",this).call(this,e)}},{key:"exportAdapterData",value:function(e){return delete(e=nG(sG(i.prototype),"exportAdapterData",this).call(this,e)).displayText,e}},{key:"_syncDisplayText",value:function(e){this.widget.setDisplayText(e),this.widget.parseAndSetValue(e)}}])&&tG(t.prototype,n),r&&tG(t,r),i}(sz);function lG(e){return(lG="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function uG(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function cG(e,t,n){return(cG="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=dG(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function fG(e,t){return(fG=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function hG(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=dG(e);if(t){var o=dG(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return pG(this,n)}}function pG(e,t){return!t||"object"!==lG(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function dG(e){return(dG=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var yG=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&fG(e,t)}(i,e);var t,n,r,o=hG(i);function i(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(e=o.call(this)).disabledCopyOverlay=!0,e._displayTextModifiedTimeoutId=null,e.updateDisplayTextOnModify=!1,e.updateDisplayTextOnModifyDelay=250,e}return t=i,(n=[{key:"addField",value:function(e){cG(dG(i.prototype),"addField",this).call(this,e),e&&e.on("input",this._onFieldInput.bind(this))}},{key:"setUpdateDisplayTextOnModify",value:function(e){null!==this._displayTextModifiedTimeoutId&&(clearTimeout(this._displayTextModifiedTimeoutId),this._acceptInputWhileTyping()),this.setProperty("updateDisplayTextOnModify",e)}},{key:"setUpdateDisplayTextOnModifyDelay",value:function(e){this.setProperty("updateDisplayTextOnModifyDelay",e)}},{key:"_clear",value:function(){this.$field&&this.$field.val("")}},{key:"_onFieldInput",value:function(){this._updateHasText(),this.updateDisplayTextOnModify&&this._onDisplayTextModified()}},{key:"_onDisplayTextModified",value:function(){clearTimeout(this._displayTextModifiedTimeoutId),this.updateDisplayTextOnModifyDelay?this._displayTextModifiedTimeoutId=setTimeout(this._acceptInputWhileTyping.bind(this),this.updateDisplayTextOnModifyDelay):this._acceptInputWhileTyping()}},{key:"_acceptInputWhileTyping",value:function(){this._displayTextModifiedTimeoutId=null,this.rendered&&this.acceptInput(!0)}},{key:"acceptInput",value:function(e){null!==this._displayTextModifiedTimeoutId&&(clearTimeout(this._displayTextModifiedTimeoutId),this._displayTextModifiedTimeoutId=null),cG(dG(i.prototype),"acceptInput",this).call(this,e)}},{key:"_renderDisplayText",value:function(){this.$field.val(this.displayText),cG(dG(i.prototype),"_renderDisplayText",this).call(this)}},{key:"_readDisplayText",value:function(){return this.$field?this.$field.val():""}},{key:"_checkDisplayTextChanged",value:function(e,t){var n=cG(dG(i.prototype),"_checkDisplayTextChanged",this).call(this,e,t);return t?this.updateDisplayTextOnModify&&n&&(this._displayTextChangedWhileTyping=!0):(this._displayTextChangedWhileTyping&&(n=!0),this._displayTextChangedWhileTyping=!1),n}}])&&uG(t.prototype,n),r&&uG(t,r),i}(Qz);function vG(e){return(vG="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function bG(e,t){return(bG=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function mG(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=_G(e);if(t){var o=_G(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return gG(this,n)}}function gG(e,t){return!t||"object"!==vG(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function _G(e){return(_G=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var wG=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&bG(e,t)}(n,e);var t=mG(n);function n(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),(e=t.call(this)).enabledWhenOffline=!0,e}return n}(aG);function kG(e){return(kG="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function SG(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function OG(e,t,n){return(OG="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=RG(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function TG(e,t){return(TG=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function CG(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=RG(e);if(t){var o=RG(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return PG(this,n)}}function PG(e,t){return!t||"object"!==kG(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function RG(e){return(RG=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var xG=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&TG(e,t)}(i,e);var t,n,r,o=CG(i);function i(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(e=o.call(this)).scrollable=!0,e.fieldWidget=null,e._addWidgetProperties(["fieldWidget"]),e}return t=i,(n=[{key:"_init",value:function(e){OG(RG(i.prototype),"_init",this).call(this,e)}},{key:"_render",value:function(){this.addContainer(this.$parent,"widget-field",new WG(this)),this.addLabel(),this.addMandatoryIndicator(),this.addStatus()}},{key:"_renderProperties",value:function(){OG(RG(i.prototype),"_renderProperties",this).call(this),this._renderFieldWidget(),this._renderScrollable()}},{key:"setFieldWidget",value:function(e){this.setProperty("fieldWidget",e)}},{key:"_renderFieldWidget",value:function(){this.fieldWidget&&(this.fieldWidget.render(),this.addField(this.fieldWidget.$container),this.invalidateLayoutTree())}},{key:"_removeFieldWidget",value:function(){this.fieldWidget&&(this.fieldWidget.remove(),this._removeField(),this.invalidateLayoutTree())}},{key:"setScrollable",value:function(e){this.setProperty("scrollable",e)}},{key:"_renderScrollable",value:function(){this._uninstallScrollbars(),this.scrollable&&this._installScrollbars()}},{key:"get$Scrollable",value:function(){return this.$fieldContainer}}])&&SG(t.prototype,n),r&&SG(t,r),i}(ZW);function EG(e){return(EG="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function DG(e,t){return(DG=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function AG(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=$G(e);if(t){var o=$G(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return FG(this,n)}}function FG(e,t){return!t||"object"!==EG(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function $G(e){return($G=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var jG=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&DG(e,t)}(n,e);var t=AG(n);function n(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),t.call(this)}return n}(sz);function BG(e){return(BG="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function MG(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function IG(e,t,n){return(IG="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=VG(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function LG(e,t){return(LG=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function HG(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=VG(e);if(t){var o=VG(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return NG(this,n)}}function NG(e,t){return!t||"object"!==BG(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function VG(e){return(VG=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var WG=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&LG(e,t)}(i,e);var t,n,r,o=HG(i);function i(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),o.call(this,e)}return t=i,(n=[{key:"layout",value:function(e){IG(VG(i.prototype),"layout",this).call(this,e),Lh.update(this.$fieldContainer)}}])&&MG(t.prototype,n),r&&MG(t,r),i}(dz);function zG(e){return(zG="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function GG(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function UG(e,t,n){return(UG="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=XG(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function KG(e,t){return(KG=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function qG(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=XG(e);if(t){var o=XG(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return YG(this,n)}}function YG(e,t){return!t||"object"!==zG(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function XG(e){return(XG=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var JG=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&KG(e,t)}(i,e);var t,n,r,o=qG(i);function i(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(e=o.call(this)).filterBox=null,e.gridDataHints.weightY=1,e.gridDataHints.h=2,e.value=[],e.lookupCall=null,e._pendingLookup=null,e._currentLookupCall=null,e._pendingLookup=null,e._lookupExecuted=!1,e._valueSyncing=!1,e._addCloneProperties(["lookupCall"]),e}return t=i,(n=[{key:"_init",value:function(e){UG(XG(i.prototype),"_init",this).call(this,e),this.filterBox&&(this.filterBox.enabledComputed=!0,this.filterBox.recomputeEnabled(!0),this.filterBox.on("propertyChange",this._onFilterBoxPropertyChange.bind(this)))}},{key:"_initValue",value:function(e){this.lookupCall&&this._setLookupCall(this.lookupCall),this._initStructure(e),UG(XG(i.prototype),"_initValue",this).call(this,e)}},{key:"_render",value:function(){this.addContainer(this.$parent,"lookup-box"),this.addLabel(),this.addMandatoryIndicator(),this.addStatus(),this.addFieldContainer(this.$parent.makeDiv()),ea.install(this.$fieldContainer,this.session).setLayout(this._createFieldContainerLayout()),this._ensureLookupCallExecuted(),this._renderStructure(),this.$field.addDeviceClass(),this.$field.addClass("structure"),this._renderFilterBox()}},{key:"_renderFilterBox",value:function(){this.filterBox&&this.filterBox.visible&&this.filterBox.render(this.$fieldContainer)}},{key:"_ensureValue",value:function(e){return rt.ensure(e)}},{key:"_updateEmpty",value:function(){this.empty=rt.empty(this.value)}},{key:"_lookupByAll",value:function(){if(this.lookupCall){this._clearPendingLookup();var e=s.a.Deferred(),t=function(t){this._lookupByAllDone(t),e.resolve(t)}.bind(this);return this._executeLookup(this.lookupCall.cloneForAll(),!0).done(t),e.promise()}}},{key:"_clearPendingLookup",value:function(){this._pendingLookup&&(clearTimeout(this._pendingLookup),this._pendingLookup=null)}},{key:"_executeLookup",value:function(e,t){var n=this;return this.setLoading(!0),t&&this._currentLookupCall&&this._currentLookupCall.abort(),this._currentLookupCall=e,this.trigger("prepareLookupCall",{lookupCall:e}),e.execute().always((function(){n._currentLookupCall=null,n._lookupExecuted=!0,n.setLoading(!1),n._clearLookupStatus()}))}},{key:"_lookupByAllDone",value:function(e){try{return e.exception?(this.setErrorStatus(Br.error({message:e.exception})),!1):0!==e.lookupRows.length||(this.setLookupStatus(Br.warning({message:this.session.text("SmartFieldNoDataFound"),code:i.ErrorCode.NO_DATA})),!1)}finally{this.trigger("lookupCallDone",{result:e})}}},{key:"_errorStatus",value:function(){return this.lookupStatus||this.errorStatus}},{key:"setLookupStatus",value:function(e){this.setProperty("lookupStatus",e),this.rendered&&this._renderErrorStatus()}},{key:"clearErrorStatus",value:function(){this.setErrorStatus(null),this._clearLookupStatus()}},{key:"_clearLookupStatus",value:function(){this.setLookupStatus(null)}},{key:"setLookupCall",value:function(e){this.setProperty("lookupCall",e)}},{key:"_setLookupCall",value:function(e){this._setProperty("lookupCall",ri.ensure(e,this.session)),this._lookupExecuted=!1,this.rendered&&this._ensureLookupCallExecuted()}},{key:"refreshLookup",value:function(){this._lookupExecuted=!1,this._ensureLookupCallExecuted()}},{key:"_ensureLookupCallExecuted",value:function(){return!this._lookupExecuted&&(this._lookupByAll(),!0)}},{key:"_formatValue",value:function(e){return Pr.isNullOrUndefined(e)?"":this._formatLookupRows(this.getCheckedLookupRows())}},{key:"_formatLookupRows",value:function(e){if(0===(e=rt.ensure(e)).length)return"";var t=[];return e.forEach((function(e){t.push(e.text)})),Wn.join(", ",t)}},{key:"_readDisplayText",value:function(){return this.displayText}},{key:"_clear",value:function(){this.setValue(null)}},{key:"_onFilterBoxPropertyChange",value:function(e){if("visible"===e.propertyName){if(!this.rendered)return;this.filterBox.visible?this._renderFilterBox():this.filterBox.remove()}}}])&&GG(t.prototype,n),r&&GG(t,r),i}(Qz);function ZG(e){return(ZG="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function QG(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function eU(e,t){return(eU=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function tU(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=rU(e);if(t){var o=rU(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return nU(this,n)}}function nU(e,t){return!t||"object"!==ZG(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function rU(e){return(rU=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}!function(e,t,n){t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}(JG,"ErrorCode",{NO_DATA:1});var oU=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&eU(e,t)}(i,e);var t,n,r,o=tU(i);function i(e,t,n){var r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(r=o.call(this)).box=e,r.structure=t,r.filterBox=n,r}return t=i,(n=[{key:"layout",value:function(e){var t,n=ea.get(e).size(),r=n.height;this.filterBox&&this.filterBox.rendered&&(r-=t=ea.get(this.filterBox.$container).prefSize().height),r=Math.max(r,20),ea.get(this.structure.$container).setSize(new $s(n.width,r)),this.filterBox&&this.filterBox.rendered&&ea.get(this.filterBox.$container).setSize(new $s(n.width,t))}},{key:"preferredLayoutSize",value:function(e,t){t=t||{};var n,r,o,i,s=0,a=ea.get(e),l=Xs.get().formRowHeight,u=this.box;return t.heightHint=null,u.$label&&u.labelVisible&&(s+=Xs.get().fieldLabelWidth),u.$mandatory&&u.$mandatory.isVisible()&&(s+=u.$mandatory.outerWidth(!0)),u.$status&&u.statusVisible&&(s+=u.$status.outerWidth(!0)),n=(o=ea.optGet(this.structure.$container))?o.prefSize(t).add(a.insets()).add(o.margins()):this.naturalSize(u),r=new $s(0,0),this.filterBox&&(i=ea.optGet(this.filterBox.$container))&&(r=i.prefSize(t).add(a.insets()).add(i.margins())),s+=Math.max(n.width,r.width),l=Math.max(l,n.height+r.height),new $s(s,l)}},{key:"naturalSize",value:function(e){return new $s(e.$fieldContainer.width(),e.$fieldContainer.height())}}])&&QG(t.prototype,n),r&&QG(t,r),i}(Zs),iU={CONTINUE:"continue",TERMINATE:"terminate",SKIP_SUBTREE:"skip_subtree"};function sU(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var aU=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.displayParent=t.displayParent,this.session=t.session}var t,n,r;return t=e,(n=[{key:"registerAndRender",value:function(e,t,n){O.assertProperty(e,"displayParent"),e.isPopupWindow()?this._renderPopupWindow(e):e.isView()?this._renderView(e,!0,t,n):this._renderDialog(e,!0)}},{key:"_renderPopupWindow",value:function(e,t){throw new Error("popup window only supported by DesktopFormController")}},{key:"unregisterAndRemove",value:function(e){e&&(e.isPopupWindow()?this._removePopupWindow(e):e.isView()?this._removeView(e):this._removeDialog(e))}},{key:"_removePopupWindow",value:function(e){throw new Error("popup window only supported by DesktopFormController")}},{key:"render",value:function(){this._renderViews(),this._renderDialogs()}},{key:"_renderViews",value:function(){var e=this;this.displayParent.views.forEach((function(t,n){t.setDisplayParent(e.displayParent),e._renderView(t,!1,n,!1)}))}},{key:"_renderDialogs",value:function(){var e=this;this.displayParent.dialogs.forEach((function(t){t.setDisplayParent(e.displayParent),e._renderDialog(t,!1)}))}},{key:"remove",value:function(){var e=this;this.displayParent.dialogs.forEach((function(t){e._removeDialog(t,!1)})),this.displayParent.views.forEach((function(t,n){e._removeView(t,!1)}))}},{key:"activateForm",value:function(e){for(var t=this.displayParent;t;){if(t instanceof fde){this.session.desktop.setOutline(t);break}t=t.displayParent}e.displayHint===CC.DisplayHint.VIEW?this._activateView(e):this._activateDialog(e)}},{key:"acceptView",value:function(e,t,n,r){return this.displayParent.rendered}},{key:"_renderView",value:function(e,t,n,r){if(t&&(void 0!==n?rt.insert(this.displayParent.views,e,n):this.displayParent.views.push(e)),this.displayParent.acceptView){if(!this.displayParent.acceptView(e))return}else if(!this.acceptView(e))return;if(e.rendered)return!1;var o=this.session.desktop;if(o.displayStyle!==kae.DisplayStyle.COMPACT||o.bench){if(o.bench.removalPending)return void setTimeout(this._renderView.bind(this,e,t,n,r))}else o.sendOutlineToBack(),o.switchToBench(!e.headerVisible);o.bench.addView(e,r)}},{key:"acceptDialog",value:function(e){return this.displayParent.rendered}},{key:"_renderDialog",value:function(e,t){var n=this,r=this.session.desktop;if(t&&this.displayParent.dialogs.push(e),this.displayParent.acceptDialog){if(!this.displayParent.acceptDialog(e))return}else if(!this.acceptDialog(e))return;if(e.rendered)return!1;e.on("remove",(function(){var e=n._findFormToActivateAfterDialogRemove();e?r._setFormActivated(e):r._setOutlineActivated()})),e.isPopupWindow()?this._renderPopupWindow(e):(e.setTrackFocus(!0),e.render(r.$container),this._layoutDialog(e),r._setFormActivated(e),this.displayParent.inFront()||e.detach())}},{key:"_findFormToActivateAfterDialogRemove",value:function(){if(this.displayParent.dialogs.length>0)return this.displayParent.dialogs[this.displayParent.dialogs.length-1];if(this.displayParent instanceof CC&&!this.displayParent.detailForm)return this.displayParent;var e=this.session.desktop;if(e.bench){var t=e.bench.activeViews()[0];if(t instanceof CC&&!t.detailForm)return t}}},{key:"_removeView",value:function(e,t){(t=O.nvl(t,!0))&&rt.remove(this.displayParent.views,e),this.session.desktop.bench&&this.session.desktop.bench.removeView(e)}},{key:"_removeDialog",value:function(e,t){(t=O.nvl(t,!0))&&rt.remove(this.displayParent.dialogs,e),e.rendered&&e.remove()}},{key:"_activateView",value:function(e){var t=this.session.desktop.bench;t&&t.activateView(e)}},{key:"_activateDialog",value:function(e){if(e.displayParent instanceof CC&&(e.displayParent.displayHint===CC.DisplayHint.VIEW||e.displayParent.displayHint===CC.DisplayHint.DIALOG&&e.modal)&&this.activateForm(e.displayParent),e.rendered){var t=e.$container.nextAll().toArray(),n=t.filter((function(t){var n=O.widget(t);return n instanceof CC&&(!n.modal||!e.has(n)&&n.displayParent!==this.session.desktop)}),this),r=t.filter((function(e){return rt.find(n,(function(t){var n=O.widget(e);return!(n instanceof CC)&&O.widget(t).has(n)}))}));n=n.concat(r),this.session.desktop.moveOverlaysBehindAndFocus(n,e.$container)}}},{key:"attachDialogs",value:function(){this.displayParent.dialogs.forEach((function(e){e.attach()}),this)}},{key:"detachDialogs",value:function(){this.displayParent.dialogs.forEach((function(e){e.detach()}),this)}},{key:"_layoutDialog",value:function(e){e.htmlComp.validateLayout(),e.position(),this.session.focusManager.validateFocus(),e.animateOpening&&(e.$container.addClassForAnimation("animate-open"),e.$container.addDeviceClass())}}])&&sU(t.prototype,n),r&&sU(t,r),e}();function lU(e){return(lU="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function uU(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function cU(e,t,n){return(cU="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=dU(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function fU(e,t){return(fU=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function hU(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=dU(e);if(t){var o=dU(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return pU(this,n)}}function pU(e,t){return!t||"object"!==lU(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function dU(e){return(dU=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var yU=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&fU(e,t)}(i,e);var t,n,r,o=hU(i);function i(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(e=o.call(this)).severity=null,e.body=null,e.cancelButtonText=null,e.header=null,e.hiddenText=null,e.html=null,e.noButtonText=null,e.yesButtonText=null,e.$content=null,e.$header=null,e.$body=null,e.$buttons=null,e.$yesButton=null,e.$noButton=null,e.$cancelButton=null,e._$abortButton=null,e.displayParent=null,e}return t=i,(n=[{key:"_init",value:function(e){cU(dU(i.prototype),"_init",this).call(this,e),this._setDisplayParent(this.displayParent)}},{key:"_createKeyStrokeContext",value:function(){return new $u}},{key:"_initKeyStrokeContext",value:function(){var e=this;cU(dU(i.prototype),"_initKeyStrokeContext",this).call(this),this.keyStrokeContext.registerKeyStroke([new NU(this),new _c(this.session,this),new pc(this,[Ou.SPACE,Ou.ENTER]),new $c(this,(function(){return e._$abortButton}))])}},{key:"_render",value:function(){this.$container=this.$parent.appendDiv("messagebox").on("mousedown",this._onMouseDown.bind(this)).on("copy",this._onCopy.bind(this));var e=this.$container.appendDiv("drag-handle");this.$container.draggable(e),this.$content=this.$container.appendDiv("messagebox-content"),this.$header=this.$content.appendDiv("messagebox-label messagebox-header"),this.$body=this.$content.appendDiv("messagebox-label messagebox-body"),this.$html=this.$content.appendDiv("messagebox-label messagebox-html prevent-initial-focus"),this.$buttons=this.$container.appendDiv("messagebox-buttons").on("copy",this._onCopy.bind(this));var t=new yf(this.$buttons,this._onButtonClick.bind(this));this._$abortButton=null,this.yesButtonText&&(this.$yesButton=t.addButton({text:this.yesButtonText,option:i.Buttons.YES}),this._$abortButton=this.$yesButton),this.noButtonText&&(this.$noButton=t.addButton({text:this.noButtonText,option:i.Buttons.NO}),this._$abortButton=this.$noButton),this.cancelButtonText&&(this.$cancelButton=t.addButton({text:this.cancelButtonText,option:i.Buttons.CANCEL}),this._$abortButton=this.$cancelButton),this._installScrollbars({axis:"y"}),this._renderIconId(),this._renderSeverity(),this._renderHeader(),this._renderBody(),this._renderHtml(),this._renderHiddenText(),this.$container.addClass("calc-helper");var n=this.$container.width();this.$container.removeClass("calc-helper"),this.$container.css("min-width",Math.max(n,100*t.buttonCount())),t.updateButtonWidths(this.$container.width()),this.htmlComp=ea.install(this.$container,this.session),this.htmlComp.setLayout(new $U(this)),this.htmlComp.validateLayout(),this.$container.addClassForAnimation("animate-open"),this.$container.select(),this._glassPaneRenderer=new ih(this),this._glassPaneRenderer.renderGlassPanes()}},{key:"get$Scrollable",value:function(){return this.$content}},{key:"_postRender",value:function(){cU(dU(i.prototype),"_postRender",this).call(this),this._installFocusContext()}},{key:"_remove",value:function(){this._glassPaneRenderer.removeGlassPanes(),this._uninstallFocusContext(),cU(dU(i.prototype),"_remove",this).call(this)}},{key:"_installFocusContext",value:function(){this.session.focusManager.installFocusContext(this.$container,Kf.AUTO)}},{key:"_uninstallFocusContext",value:function(){this.session.focusManager.uninstallFocusContext(this.$container)}},{key:"_renderIconId",value:function(){}},{key:"_renderSeverity",value:function(){this.$container.removeClass("severity-error"),this.severity===Br.Severity.ERROR&&this.$container.addClass("severity-error")}},{key:"_renderHeader",value:function(){this.$header.html(Wn.nl2br(this.header)),this.$header.setVisible(this.header)}},{key:"_renderBody",value:function(){this.$body.html(Wn.nl2br(this.body)),this.$body.setVisible(this.body)}},{key:"_renderHtml",value:function(){this.$html.html(this.html),this.$html.setVisible(this.html),this.$html.find("a, .app-link").attr("tabindex","0").unfocusable()}},{key:"_renderHiddenText",value:function(){this.$hiddenText&&this.$hiddenText.remove(),this.hiddenText&&(this.$hiddenText=this.$content.appendElement("\x3c!-- \n"+this.hiddenText.replace(/<!--|-->/g,"")+"\n --\x3e"))}},{key:"_onMouseDown",value:function(){var e=this.findParent((function(e){return e instanceof CC&&e.isDialog()}));e&&e.activate()}},{key:"_setCopyable",value:function(e){this.$header.toggleClass("copyable",e),this.$body.toggleClass("copyable",e),this.$html.toggleClass("copyable",e)}},{key:"copy",value:function(){this._setCopyable(!0);var e=this.$container.document(!0),t=e.createRange();t.selectNodeContents(this.$content[0]);var n=this.$container.window(!0).getSelection();n.removeAllRanges(),n.addRange(t),e.execCommand("copy")}},{key:"_onCopy",value:function(e){var t=Kt.get().isInternetExplorer(),n=t?this.$container.window(!0).clipboardData:Pr.optProperty(e,"originalEvent","clipboardData");if(n){if(!t){var r=Wn.join("<br/>",this.$header[0].outerHTML,this.$body[0].outerHTML,this.$html[0].outerHTML,this.hiddenText);n.setData("text/html",r)}var o=t?"Text":"text/plain",i=Wn.join("\n\n",this.header,this.body,Wn.plainText(this.$html[0].outerHTML,{compact:!0,trim:!0}),this.hiddenText);n.setData(o,i),this.$container.window(!0).getSelection().removeAllRanges(),this._setCopyable(!1),ct.showNotification(this),e.preventDefault()}}},{key:"_onButtonClick",value:function(e,t){this.trigger("action",{option:t})}},{key:"setDisplayParent",value:function(e){this.setProperty("displayParent",e)}},{key:"_setDisplayParent",value:function(e){this._setProperty("displayParent",e),e&&this.setParent(this.findDesktop().computeParentForDisplayParent(e))}},{key:"open",value:function(){this.setDisplayParent(this.displayParent||this.session.desktop),this.displayParent.messageBoxController.registerAndRender(this)}},{key:"close",value:function(){this.displayParent&&this.displayParent.messageBoxController.unregisterAndRemove(this),this.destroy()}},{key:"abort",value:function(){this._$abortButton&&this.session.focusManager.requestFocus(this._$abortButton)&&this._$abortButton.click()}},{key:"_attach",value:function(){this.$parent.append(this.$container),cU(dU(i.prototype),"_attach",this).call(this)}},{key:"_detach",value:function(){this.$container.detach(),cU(dU(i.prototype),"_detach",this).call(this)}}])&&uU(t.prototype,n),r&&uU(t,r),i}(ve);function vU(e){return(vU="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function bU(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function mU(e,t,n){return(mU="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=kU(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function gU(e,t){return(gU=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function _U(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=kU(e);if(t){var o=kU(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return wU(this,n)}}function wU(e,t){return!t||"object"!==vU(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function kU(e){return(kU=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}!function(e,t,n){t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}(yU,"Buttons",{YES:"yes",NO:"no",CANCEL:"cancel"});var SU=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&gU(e,t)}(i,e);var t,n,r,o=_U(i);function i(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),o.call(this)}return t=i,(n=[{key:"_onWidgetAction",value:function(e){this._send("action",{option:e.option})}},{key:"_onWidgetEvent",value:function(e){"action"===e.type?this._onWidgetAction(e):mU(kU(i.prototype),"_onWidgetEvent",this).call(this,e)}}])&&bU(t.prototype,n),r&&bU(t,r),i}(de);function OU(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var TU=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.displayParent=t,this.session=n}var t,n,r;return t=e,(n=[{key:"registerAndRender",value:function(e){O.assertProperty(e,"displayParent"),this.displayParent.messageBoxes.push(e),this._render(e)}},{key:"unregisterAndRemove",value:function(e){e&&(rt.remove(this.displayParent.messageBoxes,e),this._remove(e))}},{key:"remove",value:function(){this.displayParent.messageBoxes.forEach(this._remove.bind(this))}},{key:"render",value:function(){var e=this;this.displayParent.messageBoxes.forEach((function(t){t.setDisplayParent(e.displayParent),e._render(t)}))}},{key:"_render",value:function(e){if(e.displayParent||e._setProperty("displayParent",this.displayParent),this.displayParent.acceptView){if(!this.displayParent.acceptView(e))return}else if(!this.acceptView(e))return;var t;e.rendered||(t=this.displayParent instanceof CC&&this.displayParent.isPopupWindow()?this.displayParent.popupWindow.$container:this.session.desktop.$container,e.setTrackFocus(!0),e.render(t),this.displayParent.inFront()||e.detach())}},{key:"_remove",value:function(e){e.remove()}},{key:"attach",value:function(){this.displayParent.messageBoxes.forEach((function(e){e.attach()}),this)}},{key:"detach",value:function(){this.displayParent.messageBoxes.forEach((function(e){e.detach()}),this)}},{key:"acceptView",value:function(e){return this.displayParent.rendered}}])&&OU(t.prototype,n),r&&OU(t,r),e}();function CU(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var PU=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.parent=null,this.yesText=null,this.noText=null,this.cancelText=null,this.bodyText=null,this.severity=Br.Severity.INFO,this.headerText=null,this.closeOnClick=!0,this.html=!1}var t,n,r;return t=e,r=[{key:"create",value:function(e){return O.create("MessageBoxes",{parent:e})}},{key:"createOk",value:function(e){return this.create(e).withYes(e.session.text("Ok"))}},{key:"createYesNo",value:function(e){return this.create(e).withYes().withNo()}},{key:"createYesNoCancel",value:function(e){return this.create(e).withYes().withNo().withCancel()}},{key:"openOk",value:function(e,t,n){return this.createOk(e).withBody(t).withSeverity(n).buildAndOpen()}},{key:"openYesNo",value:function(e,t,n){return this.createYesNo(e).withBody(t).withSeverity(n).buildAndOpen()}}],(n=[{key:"init",value:function(e){O.assertParameter("parent",e.parent),s.a.extend(this,e)}},{key:"withHeader",value:function(e){return this.headerText=e,this}},{key:"withBody",value:function(e,t){return this.bodyText=e,this.html=O.nvl(t,!1),this}},{key:"withSeverity",value:function(e){return this.severity=O.nvl(e,Br.Severity.INFO),this}},{key:"withYes",value:function(e){return this.yesText=O.nvl(e,this.parent.session.text("Yes")),this}},{key:"withNo",value:function(e){return this.noText=O.nvl(e,this.parent.session.text("No")),this}},{key:"withCancel",value:function(e){return this.cancelText=O.nvl(e,this.parent.session.text("Cancel")),this}},{key:"build",value:function(){var e={parent:this.parent,header:this.headerText,body:this.bodyText,severity:this.severity};return Wn.hasText(this.yesText)&&(e.yesButtonText=this.yesText),Wn.hasText(this.noText)&&(e.noButtonText=this.noText),Wn.hasText(this.cancelText)&&(e.cancelButtonText=this.cancelText),this.html&&(e.html=e.body,delete e.body),O.create("MessageBox",e)}},{key:"buildAndOpen",value:function(){var e=this,t=s.a.Deferred(),n=this.build();return n.on("action",(function(r){e.closeOnClick&&n.close(),t.resolve(r.option)})),n.open(),t.promise()}}])&&CU(t.prototype,n),r&&CU(t,r),e}();function RU(e){return(RU="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function xU(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function EU(e,t){return(EU=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function DU(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=FU(e);if(t){var o=FU(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return AU(this,n)}}function AU(e,t){return!t||"object"!==RU(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function FU(e){return(FU=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var $U=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&EU(e,t)}(i,e);var t,n,r,o=DU(i);function i(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(t=o.call(this,e)).messageBox=e,t}return t=i,(n=[{key:"layout",value:function(e){var t=ea.get(e),n=e.windowSize(),r=t.offsetBounds(!0),o=t.size(),i=t.margins();o=jR.fitContainerInWindow(n,r.point(),o,i),e.toggleClass("full-width",0===r.x&&0===i.horizontal()&&n.width===o.width).toggleClass("full-height",0===r.y&&0===i.vertical()&&n.height===o.height),qs.setSize(e,o);var s=qs.size(this.messageBox.$buttons,{exact:!0});this.messageBox.$content.css("height","calc(100% - "+s.height+"px)"),Lh.update(this.messageBox.$content),e.cssPosition(jR.positionContainerInWindow(e))}}])&&xU(t.prototype,n),r&&xU(t,r),i}(Zs);function jU(e){return(jU="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function BU(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function MU(e,t){return(MU=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function IU(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=HU(e);if(t){var o=HU(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return LU(this,n)}}function LU(e,t){return!t||"object"!==jU(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function HU(e){return(HU=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var NU=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&MU(e,t)}(i,e);var t,n,r,o=IU(i);function i(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(t=o.call(this)).field=e,t.which=[Ou.C],t.ctrl=!0,t.preventDefault=!1,t.renderingHints.render=!0,t.renderingHints.$drawingArea=function(t,n){return e.$container},t}return t=i,(n=[{key:"handle",value:function(e){this.field.copy()}}])&&BU(t.prototype,n),r&&BU(t,r),i}(zu);function VU(e){return(VU="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function WU(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function zU(e,t,n){return(zU="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=qU(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function GU(e,t){return(GU=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function UU(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=qU(e);if(t){var o=qU(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return KU(this,n)}}function KU(e,t){return!t||"object"!==VU(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function qU(e){return(qU=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var YU=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&GU(e,t)}(i,e);var t,n,r,o=UU(i);function i(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(e=o.call(this)).accordion=null,e.eventDelegator=null,e._addWidgetProperties(["accordion"]),e}return t=i,(n=[{key:"_init",value:function(e){zU(qU(i.prototype),"_init",this).call(this,e),this._setAccordion(this.accordion)}},{key:"_createLoadingSupport",value:function(){return null}},{key:"_render",value:function(){this.addContainer(this.$parent,"accordion-field"),this.addLabel(),this.addMandatoryIndicator(),this.addStatus(),this.accordion&&this._renderAccordion()}},{key:"_renderProperties",value:function(){zU(qU(i.prototype),"_renderProperties",this).call(this),this._renderDropType()}},{key:"setAccordion",value:function(e){this.setProperty("accordion",e)}},{key:"_setAccordion",value:function(e){this.accordion&&this.eventDelegator&&(this.eventDelegator.destroy(),this.eventDelegator=null),this._setProperty("accordion",e),e&&(this.eventDelegator=vt.create(this,e,{delegateProperties:["loading"]}),e.setLoading(this.loading),e.setScrollTop(this.scrollTop))}},{key:"_renderAccordion",value:function(){this.accordion&&(this.accordion.render(),this.addField(this.accordion.$container),this.invalidateLayoutTree())}},{key:"_removeAccordion",value:function(){this.accordion&&(this.accordion.remove(),this._removeField(),this.invalidateLayoutTree())}},{key:"getFocusableElement",value:function(){return this.accordion?this.accordion.getFocusableElement():null}},{key:"getDelegateScrollable",value:function(){return this.accordion}}])&&WU(t.prototype,n),r&&WU(t,r),i}(ZW);function XU(e){return(XU="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function JU(e,t){return(JU=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function ZU(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=eK(e);if(t){var o=eK(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return QU(this,n)}}function QU(e,t){return!t||"object"!==XU(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function eK(e){return(eK=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var tK=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&JU(e,t)}(n,e);var t=ZU(n);function n(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),t.call(this)}return n}(sz);function nK(e){return(nK="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function rK(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function oK(e,t,n){return(oK="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=lK(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function iK(e,t){return(iK=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function sK(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=lK(e);if(t){var o=lK(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return aK(this,n)}}function aK(e,t){return!t||"object"!==nK(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function lK(e){return(lK=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var uK=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&iK(e,t)}(i,e);var t,n,r,o=sK(i);function i(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(e=o.call(this)).preventInitialFocus=!0,e}return t=i,(n=[{key:"_render",value:function(){this.addContainer(this.$parent,"bean-field"),this.addLabel(),this.addField(this.$parent.makeDiv()),this.addStatus()}},{key:"_renderProperties",value:function(){oK(lK(i.prototype),"_renderProperties",this).call(this),this._renderValue()}},{key:"_initKeyStrokeContext",value:function(){oK(lK(i.prototype),"_initKeyStrokeContext",this).call(this),this.keyStrokeContext.registerKeyStroke(new FW(this,this._onAppLinkAction))}},{key:"_formatValue",value:function(e){return this.displayText}},{key:"_parseValue",value:function(e){return this.value}},{key:"_readDisplayText",value:function(){return this.displayText}},{key:"_renderDisplayText",value:function(){}},{key:"_renderValue",value:function(){}},{key:"triggerAppLinkAction",value:function(e){this.trigger("appLinkAction",{ref:e})}},{key:"_onAppLinkAction",value:function(e){var t=s()(e.delegateTarget).data("ref");this.triggerAppLinkAction(t)}}])&&rK(t.prototype,n),r&&rK(t,r),i}(Qz);function cK(e){return(cK="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function fK(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function hK(e,t,n){return(hK="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=vK(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function pK(e,t){return(pK=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function dK(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=vK(e);if(t){var o=vK(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return yK(this,n)}}function yK(e,t){return!t||"object"!==cK(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function vK(e){return(vK=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var bK=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&pK(e,t)}(i,e);var t,n,r,o=dK(i);function i(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),o.call(this)}return t=i,(n=[{key:"_onWidgetAppLinkAction",value:function(e){this._send("appLinkAction",{ref:e.ref})}},{key:"_onWidgetEvent",value:function(e){"appLinkAction"===e.type?this._onWidgetAppLinkAction(e):hK(vK(i.prototype),"_onWidgetEvent",this).call(this,e)}}])&&fK(t.prototype,n),r&&fK(t,r),i}(aG);function mK(e){return(mK="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function gK(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function _K(e,t,n){return(_K="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=OK(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function wK(e,t){return(wK=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function kK(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=OK(e);if(t){var o=OK(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return SK(this,n)}}function SK(e,t){return!t||"object"!==mK(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function OK(e){return(OK=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var TK=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&wK(e,t)}(i,e);var t,n,r,o=kK(i);function i(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(e=o.call(this)).autoCloseExternalWindow=!1,e.externalWindowButtonText=null,e.externalWindowFieldText=null,e.location=null,e.trackLocation=!1,e.sandboxEnabled=!0,e.sandboxPermissions=null,e.scrollBarEnabled=!0,e.showInExternalWindow=!1,e._messageListener=null,e._popupWindow=null,e._externalWindowTextField=null,e._externalWindowButton=null,e}return t=i,(n=[{key:"_init",value:function(e){_K(OK(i.prototype),"_init",this).call(this,e),this.iframe=O.create("IFrame",{parent:this,location:this.location,sandboxEnabled:this.sandboxEnabled,sandboxPermissions:this.sandboxPermissions,scrollBarEnabled:this.scrollBarEnabled,trackLocation:this.trackLocation}),this.iframe.on("propertyChange",this._onIFramePropertyChange.bind(this))}},{key:"_render",value:function(){this.addContainer(this.$parent,"browser-field",new NK(this)),this.addLabel(),this.addStatus(),this.showInExternalWindow?(this.addField(this.$parent.makeDiv()),this._externalWindowTextField=this.$field.appendDiv().addClass("alt"),this._externalWindowButton=this.$field.appendDiv().addClass("button").on("click",this._openPopupWindow.bind(this))):(this.iframe.render(),this.addFieldContainer(this.iframe.$container),this.addField(this.iframe.$iframe),this.$field.on("load",this._onLoad.bind(this))),this.myWindow=this.$parent.window(!0),this._messageListener=this._onMessage.bind(this),this.myWindow.addEventListener("message",this._messageListener),this.enabledComputed&&setTimeout(this._openPopupWindow.bind(this,!0),20)}},{key:"_renderProperties",value:function(){_K(OK(i.prototype),"_renderProperties",this).call(this),this._renderExternalWindowButtonText(),this._renderExternalWindowFieldText()}},{key:"_remove",value:function(){_K(OK(i.prototype),"_remove",this).call(this),this.myWindow.removeEventListener("message",this._messageListener),this._messageListener=null,this.showInExternalWindow&&this.autoCloseExternalWindow&&this._popupWindow&&!this._popupWindow.closed&&this._popupWindow.close()}},{key:"setLocation",value:function(e){this.setProperty("location",e),this.iframe.setLocation(e)}},{key:"_renderLocation",value:function(){var e=this.location||"about:blank";this.showInExternalWindow&&this._popupWindow&&!this._popupWindow.closed&&(this._popupWindow.location=e)}},{key:"setAutoCloseExternalWindow",value:function(e){this.setProperty("autoCloseExternalWindow",e)}},{key:"setExternalWindowButtonText",value:function(e){this.setProperty("externalWindowButtonText",e)}},{key:"_renderExternalWindowButtonText",value:function(){this.showInExternalWindow&&this._externalWindowButton.text(this.externalWindowButtonText||"")}},{key:"setExternalWindowFieldText",value:function(e){this.setProperty("externalWindowFieldText",e)}},{key:"_renderExternalWindowFieldText",value:function(){this.showInExternalWindow&&this._externalWindowTextField.text(this.externalWindowFieldText||"")}},{key:"_calcPopupBounds",value:function(){var e=this.$container.window(!0),t=new Hs(e.screenX,e.screenY,s()(e).width(),s()(e).height()+55),n=new Hs(this.$field.offset().left,this.$field.offset().top,this.$field.width(),this.$field.height()),r=t.x+n.x,o=t.y+n.y+55,i=n.width,a=n.height+38,l=o+a,u=t.y+t.height;return l>u&&(a-=l-u+38),new Hs(pr.round(r),pr.round(o),pr.round(i),pr.round(a))}},{key:"_openPopupWindow",value:function(e){if(e=O.nvl(e,!0),this.showInExternalWindow)if(!this._popupWindow||e&&this._popupWindow.closed){var t=O.create("PopupBlockerHandler",{session:this.session}),n=this._calcPopupBounds(),r=Wn.join(",","directories=no","location=no","menubar=no","resizable=yes","status=no","scrollbars="+(this.scrollBarEnabled?"yes":"no"),"toolbar=no","dependent=yes","left="+n.x,"top="+n.y,"width="+n.width,"height="+n.height),o=this.location||"about:blank";t.openWindow(o,void 0,r,this._popupWindowOpen.bind(this))}else e&&this._popupWindow.focus()}},{key:"_popupWindowOpen",value:function(e){var t=this;if(this._popupWindow=e,this._popupWindow&&!this._popupWindow.closed){this.trigger("externalWindowStateChange",{windowState:i.WindowStates.WINDOW_OPEN});var n=window.setInterval((function(){var e=!1;try{e=null===t._popupWindow||t._popupWindow.closed}catch(e){return void(s.a.log.isInfoEnabled()&&s.a.log.info("Reading the property popupWindow.closed threw an error (Retry in 500ms)"))}e&&(window.clearInterval(n),t.trigger("externalWindowStateChange",{windowState:i.WindowStates.WINDOW_CLOSED}))}),500)}}},{key:"_onMessage",value:function(e){e.source===this.$field[0].contentWindow?(s.a.log.isDebugEnabled()&&s.a.log.debug("received post-message data="+e.data+" origin="+e.origin),this.trigger("message",{data:e.data,origin:e.origin})):s.a.log.isTraceEnabled()&&s.a.log.trace("skipped post-message, because different source. data="+e.data+" origin="+e.origin)}},{key:"setTrackLocation",value:function(e){this.setProperty("trackLocation",e),this.iframe.setTrackLocation(e)}},{key:"_onIFramePropertyChange",value:function(e){this.trackLocation&&"location"===e.propertyName&&this._setProperty("location",e.newValue)}},{key:"_onLoad",value:function(e){this.rendered&&this.invalidateLayoutTree()}},{key:"setSandboxEnabled",value:function(e){this.setProperty("sandboxEnabled",e),this.iframe.setSandboxEnabled(e)}},{key:"setSandboxPermissions",value:function(e){this.setProperty("sandboxPermissions",e),this.iframe.setSandboxPermissions(e)}},{key:"setScrollBarEnabled",value:function(e){this.setProperty("scrollBarEnabled",e),this.iframe.setScrollBarEnabled(e)}}])&&gK(t.prototype,n),r&&gK(t,r),i}(Qz);function CK(e){return(CK="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function PK(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function RK(e,t,n){return(RK="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=AK(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function xK(e,t){return(xK=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function EK(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=AK(e);if(t){var o=AK(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return DK(this,n)}}function DK(e,t){return!t||"object"!==CK(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function AK(e){return(AK=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}!function(e,t,n){t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}(TK,"WindowStates",{WINDOW_OPEN:"true",WINDOW_CLOSED:"false"});var FK=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&xK(e,t)}(i,e);var t,n,r,o=EK(i);function i(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(e=o.call(this))._addRemoteProperties(["location"]),e}return t=i,(n=[{key:"_onWidgetMessage",value:function(e){this._send("postMessage",{data:e.data,origin:e.origin})}},{key:"_onWidgetExternalWindowStateChange",value:function(e){this._send("externalWindowStateChange",{windowState:e.windowState})}},{key:"_onWidgetEvent",value:function(e){"message"===e.type?this._onWidgetMessage(e):"externalWindowStateChange"===e.type?this._onWidgetExternalWindowStateChange(e):RK(AK(i.prototype),"_onWidgetEvent",this).call(this,e)}},{key:"_orderPropertyNamesOnSync",value:function(e){return Object.keys(e).sort(this._createPropertySortFunc(["scrollBarEnabled","location"]))}}])&&PK(t.prototype,n),r&&PK(t,r),i}(aG);function $K(e){return($K="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function jK(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function BK(e,t,n){return(BK="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=HK(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function MK(e,t){return(MK=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function IK(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=HK(e);if(t){var o=HK(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return LK(this,n)}}function LK(e,t){return!t||"object"!==$K(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function HK(e){return(HK=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var NK=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&MK(e,t)}(i,e);var t,n,r,o=IK(i);function i(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(t=o.call(this,e)).browserField=e,t}return t=i,(n=[{key:"preferredLayoutSize",value:function(e,t){var n=BK(HK(i.prototype),"preferredLayoutSize",this).call(this,e,t);return this._isIFrameReadable()&&(n.height=this.browserField.$field.contents().height()+this.browserField.iframe.htmlComp.insets().vertical()+this.browserField.htmlComp.insets().vertical()),n}},{key:"_isIFrameReadable",value:function(){var e=this.browserField,t=e.sandboxPermissions;if(e.sandboxEnabled&&t&&-1===t.indexOf("allow-same-origin"))return s.a.log.isWarnEnabled()&&s.a.log.warn('Access to IFrame denied, cannot read height. Reason: sandbox is enabled or "allow-same-origin" is not set'),!1;try{e.$field[0].contentWindow.document}catch(e){return s.a.log.isWarnEnabled()&&s.a.log.warn("Access to IFrame denied, cannot read height. Reason: denied by browser"),!1}return"loading"!==e.$field.contents().attr("readyState")||(s.a.log.isWarnEnabled()&&s.a.log.warn('Access to IFrame denied, cannot read height. Reason: readyState == "loading"'),!1)}}])&&jK(t.prototype,n),r&&jK(t,r),i}(dz);function VK(e){return(VK="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function WK(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function zK(e,t,n){return(zK="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=YK(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function GK(e,t){return(GK=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function UK(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=YK(e);if(t){var o=YK(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return KK(this,n)}}function KK(e,t){return!t||"object"!==VK(t)&&"function"!=typeof t?qK(e):t}function qK(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function YK(e){return(YK=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function XK(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var JK=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&GK(e,t)}(i,e);var t,n,r,o=UK(i);function i(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(e=o.call(this)).adaptedBy=null,e.defaultButton=!1,e.displayStyle=i.DisplayStyle.DEFAULT,e.gridDataHints.fillHorizontal=!1,e.iconId=null,e.keyStroke=null,e.keyStrokeScope=null,e.processButton=!0,e.selected=!1,e.statusVisible=!1,e.systemType=i.SystemType.NONE,e.preventDoubleClick=!1,e.stackable=!0,e.shrinkable=!1,e.$buttonLabel=null,e.buttonKeyStroke=new kq(qK(e),null),e._doubleClickSupport=new Yt,e._addCloneProperties(["defaultButton","displayStyle","iconId","keyStroke","processButton","selected","systemType","preventDoubleClick","stackable","shrinkable"]),e}return t=i,(n=[{key:"_init",value:function(e){zK(YK(i.prototype),"_init",this).call(this,e),this.resolveIconIds(["iconId"]),this._setKeyStroke(this.keyStroke),this._setKeyStrokeScope(this.keyStrokeScope),this._setInheritAccessibility(this.inheritAccessibility&&!this._isIgnoreAccessibilityFlags())}},{key:"_initKeyStrokeContext",value:function(){zK(YK(i.prototype),"_initKeyStrokeContext",this).call(this),this._initDefaultKeyStrokes(),this.formKeyStrokeContext=new $u,this.formKeyStrokeContext.invokeAcceptInputOnActiveValueField=!0,this.formKeyStrokeContext.registerKeyStroke(this.buttonKeyStroke),this.formKeyStrokeContext.$bindTarget=function(){if(this.keyStrokeScope)return this.keyStrokeScope.$container;var e=this.getForm();return e?e.$container:this.session.desktop.$container}.bind(this)}},{key:"_isIgnoreAccessibilityFlags",value:function(){return this.systemType===i.SystemType.CANCEL||this.systemType===i.SystemType.CLOSE}},{key:"_initDefaultKeyStrokes",value:function(){this.keyStrokeContext.registerKeyStroke([new kq(this,"ENTER"),new kq(this,"SPACE")])}},{key:"_createLoadingSupport",value:function(){return new oe({widget:this,$container:function(){return this.$field}.bind(this)})}},{key:"_render",value:function(){var e,t=this;if(this.displayStyle===i.DisplayStyle.LINK?(e=this.$parent.makeDiv("link-button"),this.$link=e.appendDiv("menu-item link"),this.$buttonLabel=this.$link.appendSpan("button-label text")):(e=this.$parent.makeElement("<button>").addClass("button"),this.$buttonLabel=e.appendSpan("button-label"),Kt.get().supportsOnlyTouch()&&e.setTabbable(!1)),this.addContainer(this.$parent,"button-field",new iq(this)),this.addField(e),this.addStatus(),e.on("mousedown",(function(e){return t._doubleClickSupport.mousedown(e)})).on("click",this._onClick.bind(this)).unfocusable(),this.menus&&this.menus.length>0&&(this.menus.forEach((function(e){this.keyStrokeContext.registerKeyStroke(e)}),this),this.label||!this.iconId)){var n=gn.parseIconId(i.SUBMENU_ICON);this.$submenuIcon=(this.$link||e).appendSpan("submenu-icon").text(n.iconCharacter)}this.session.keyStrokeManager.installKeyStrokeContext(this.formKeyStrokeContext),xp.installForEllipsis(this.$buttonLabel,{parent:this})}},{key:"_remove",value:function(){zK(YK(i.prototype),"_remove",this).call(this),xp.uninstall(this.$buttonLabel),this.session.keyStrokeManager.uninstallKeyStrokeContext(this.formKeyStrokeContext),this.$submenuIcon=null}},{key:"_renderProperties",value:function(){zK(YK(i.prototype),"_renderProperties",this).call(this),this._renderIconId(),this._renderSelected(),this._renderDefaultButton()}},{key:"_renderForegroundColor",value:function(){zK(YK(i.prototype),"_renderForegroundColor",this).call(this),To.legacyForegroundColor(this,this.$buttonLabel),To.legacyForegroundColor(this,this.get$Icon()),To.legacyForegroundColor(this,this.$submenuIcon)}},{key:"_renderBackgroundColor",value:function(){zK(YK(i.prototype),"_renderBackgroundColor",this).call(this),To.legacyBackgroundColor(this,this.$fieldContainer)}},{key:"_renderFont",value:function(){zK(YK(i.prototype),"_renderFont",this).call(this),To.legacyFont(this,this.$buttonLabel),this.invalidateLayoutTree()}},{key:"doAction",value:function(){return!(!this.enabledComputed||!this.visible||(this.displayStyle===i.DisplayStyle.TOGGLE?this.setSelected(!this.selected):this.menus.length>0&&this.togglePopup(),this._doAction(),0))}},{key:"_doAction",value:function(){this.trigger("click")}},{key:"togglePopup",value:function(){var e=this;this.popup?this.popup.close():(this.popup=this._openPopup(),this.popup.one("destroy",(function(t){e.popup=null})))}},{key:"_openPopup",value:function(){var e=O.create("ContextMenuPopup",{parent:this,menuItems:this.menus,cloneMenuItems:!1,closeOnAnchorMouseDown:!1,$anchor:this.$field});return e.open(),e}},{key:"_doActionTogglesSubMenu",value:function(){return!1}},{key:"setDefaultButton",value:function(e){this.setProperty("defaultButton",e)}},{key:"_renderDefaultButton",value:function(){this.$field.toggleClass("default",this.defaultButton)}},{key:"_renderEnabled",value:function(){zK(YK(i.prototype),"_renderEnabled",this).call(this),this.displayStyle===i.DisplayStyle.LINK&&(this.$link.setEnabled(this.enabledComputed),this.$field.setTabbable(this.enabledComputed&&!Kt.get().supportsOnlyTouch()))}},{key:"setSelected",value:function(e){this.setProperty("selected",e)}},{key:"_renderSelected",value:function(){this.displayStyle===i.DisplayStyle.TOGGLE&&this.$field.toggleClass("selected",this.selected)}},{key:"_renderLabel",value:function(){this.$buttonLabel.contentOrNbsp(this.labelHtmlEnabled,this.label,"empty"),this._updateLabelAndIconStyle(),this.invalidateLayoutTree()}},{key:"setIconId",value:function(e){this.setProperty("iconId",e)}},{key:"_renderIconId",value:function(){var e=this.$link||this.$fieldContainer;e.icon(this.iconId);var t=e.data("$icon");function n(e){t.removeClass("loading"),t.toggleClass("broken",!e),this.invalidateLayoutTree()}t&&(t.removeClass("loading broken"),t.is("img")&&(t.addClass("loading"),t.off("load error").on("load",n.bind(this,!0)).on("error",n.bind(this,!1))),this.rendered||To.legacyForegroundColor(this,t)),this._updateLabelAndIconStyle(),this.invalidateLayoutTree()}},{key:"get$Icon",value:function(){return(this.$link||this.$fieldContainer).children(".icon")}},{key:"_updateLabelAndIconStyle",value:function(){var e=!!this.label;this.$buttonLabel.setVisible(e||!this.iconId),this.get$Icon().toggleClass("with-label",e)}},{key:"setKeyStroke",value:function(e){this.setProperty("keyStroke",e)}},{key:"_setKeyStroke",value:function(e){this._setProperty("keyStroke",e),this.buttonKeyStroke.parseAndSetKeyStroke(this.keyStroke)}},{key:"_setKeyStrokeScope",value:function(e){("string"!=typeof e||(e=this._resolveKeyStrokeScope(e)))&&this._setProperty("keyStrokeScope",e)}},{key:"_resolveKeyStrokeScope",value:function(e){var t=this.findNonWrappedForm();if(!t)throw new Error("Could not resolve keyStrokeScope "+e+" because no form has been found.");if(t.initialized){if(!(e=t.widget(e)))throw new Error("Could not resolve keyStrokeScope "+e+" using form "+t);return e}t.one("init",this._setKeyStrokeScope.bind(this,e))}},{key:"_onClick",value:function(e){1===e.which&&(this.preventDoubleClick&&this._doubleClickSupport.doubleClicked()||this.enabledComputed&&this.doAction())}},{key:"setStackable",value:function(e){this.setProperty("stackable",e)}},{key:"setShrinkable",value:function(e){this.setProperty("shrinkable",e)}},{key:"setPreventDoubleClick",value:function(e){this.setProperty("preventDoubleClick",e)}},{key:"getFocusableElement",value:function(){return this.adaptedBy?this.adaptedBy.getFocusableElement():zK(YK(i.prototype),"getFocusableElement",this).call(this)}},{key:"isFocusable",value:function(){return this.adaptedBy?this.adaptedBy.isFocusable():zK(YK(i.prototype),"isFocusable",this).call(this)}},{key:"focus",value:function(){return this.adaptedBy?this.adaptedBy.focus():zK(YK(i.prototype),"focus",this).call(this)}}])&&WK(t.prototype,n),r&&WK(t,r),i}(ZW);function ZK(e){return(ZK="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function QK(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function eq(e,t,n){return(eq="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=oq(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function tq(e,t){return(tq=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function nq(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=oq(e);if(t){var o=oq(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return rq(this,n)}}function rq(e,t){return!t||"object"!==ZK(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function oq(e){return(oq=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}XK(JK,"SystemType",{NONE:0,CANCEL:1,CLOSE:2,OK:3,RESET:4,SAVE:5,SAVE_WITHOUT_MARKER_CHANGE:6}),XK(JK,"DisplayStyle",{DEFAULT:0,TOGGLE:1,RADIO:2,LINK:3}),XK(JK,"SUBMENU_ICON",gn.ANGLE_DOWN_BOLD);var iq=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&tq(e,t)}(i,e);var t,n,r,o=nq(i);function i(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(t=o.call(this,e)).button=e,t}return t=i,(n=[{key:"layout",value:function(e){eq(oq(i.prototype),"layout",this).call(this,e);var t=this.button.get$Icon(),n=this.button.$submenuIcon,r=this.button.$buttonLabel,o=this.button.$fieldContainer;r.css("max-width","");var s=n?qs.size(n,{includeMargin:!0,exact:!0}).width:0,a=t.length?qs.size(t,{includeMargin:!0,exact:!0}).width:0,l=Math.ceil(o.width()-(s+a));r.css("max-width",l)}},{key:"preferredLayoutSize",value:function(e,t){var n=this.button.$buttonLabel,r=n.css("max-width");n.css("max-width","");var o=eq(oq(i.prototype),"preferredLayoutSize",this).call(this,e,t);return n.css("max-width",r),o}}])&&QK(t.prototype,n),r&&QK(t,r),i}(dz);function sq(e){return(sq="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function aq(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function lq(e,t,n){return(lq="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=hq(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function uq(e,t){return(uq=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function cq(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=hq(e);if(t){var o=hq(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return fq(this,n)}}function fq(e,t){return!t||"object"!==sq(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function hq(e){return(hq=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var pq=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&uq(e,t)}(i,e);var t,n,r,o=cq(i);function i(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(e=o.call(this))._addRemoteProperties(["selected"]),e}return t=i,(n=[{key:"_onWidgetClick",value:function(e){this.widget.displayStyle===JK.DisplayStyle.TOGGLE||this.widget.menus.length>0||this._send("click")}},{key:"_onWidgetEvent",value:function(e){"click"===e.type?this._onWidgetClick(e):lq(hq(i.prototype),"_onWidgetEvent",this).call(this,e)}}])&&aq(t.prototype,n),r&&aq(t,r),i}(sz);function dq(e){return(dq="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function yq(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function vq(e,t,n){return(vq="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=wq(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function bq(e,t){return(bq=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function mq(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=wq(e);if(t){var o=wq(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return gq(this,n)}}function gq(e,t){return!t||"object"!==dq(t)&&"function"!=typeof t?_q(e):t}function _q(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function wq(e){return(wq=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var kq=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&bq(e,t)}(i,e);var t,n,r,o=mq(i);function i(e,t){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(n=o.call(this)).field=e,n.parseAndSetKeyStroke(t),n.stopPropagation=!0,n.stopImmediatePropagation=!0,n.renderingHints.hAlign=Do.RIGHT,n.renderingHints.$drawingArea=function(e,t){return this.field.$container}.bind(_q(n)),n}return t=i,(n=[{key:"_accept",value:function(e){return vq(wq(i.prototype),"_accept",this).call(this,e)&&this.field.$field.isAttached()}},{key:"handle",value:function(e){this.field.doAction()}}])&&yq(t.prototype,n),r&&yq(t,r),i}(zu);function Sq(e){return(Sq="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Oq(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Tq(e,t){return(Tq=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Cq(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Rq(e);if(t){var o=Rq(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Pq(this,n)}}function Pq(e,t){return!t||"object"!==Sq(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Rq(e){return(Rq=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var xq=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Tq(e,t)}(i,e);var t,n,r,o=Cq(i);function i(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(e=o.call(this)).gridDataHints.weightY=1,e._addWidgetProperties(["calendar"]),e}return t=i,(n=[{key:"_render",value:function(){this.addContainer(this.$parent,"calendar-field"),this.addLabel(),this.addStatus(),this.calendar&&(this.calendar.render(),this.addField(this.calendar.$container))}}])&&Oq(t.prototype,n),r&&Oq(t,r),i}(ZW);function Eq(e){return(Eq="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Dq(e,t){return(Dq=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Aq(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=$q(e);if(t){var o=$q(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Fq(this,n)}}function Fq(e,t){return!t||"object"!==Eq(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function $q(e){return($q=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var jq=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Dq(e,t)}(n,e);var t=Aq(n);function n(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),t.call(this)}return n}(sz);function Bq(e){return(Bq="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Mq(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Iq(e,t){return(Iq=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Lq(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Nq(e);if(t){var o=Nq(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Hq(this,n)}}function Hq(e,t){return!t||"object"!==Bq(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Nq(e){return(Nq=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Vq=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Iq(e,t)}(i,e);var t,n,r,o=Lq(i);function i(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(e=o.call(this)).gridDataHints.weightY=1,e._addWidgetProperties(["carousel"]),e}return t=i,(n=[{key:"_render",value:function(){this.addContainer(this.$parent,"carousel-field"),this.addLabel(),this.addMandatoryIndicator(),this.addStatus(),this.carousel&&this._renderCarousel()}},{key:"_renderCarousel",value:function(){this.carousel.render(),this.addField(this.carousel.$container)}},{key:"_removeCarousel",value:function(){this.carousel.remove(),this._removeField()}}])&&Mq(t.prototype,n),r&&Mq(t,r),i}(ZW);function Wq(e){return(Wq="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function zq(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Gq(e,t,n){return(Gq="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Xq(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function Uq(e,t){return(Uq=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Kq(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Xq(e);if(t){var o=Xq(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return qq(this,n)}}function qq(e,t){return!t||"object"!==Wq(t)&&"function"!=typeof t?Yq(e):t}function Yq(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Xq(e){return(Xq=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Jq=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Uq(e,t)}(i,e);var t,n,r,o=Kq(i);function i(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(e=o.call(this)).triStateEnabled=!1,e.wrapText=!1,e.keyStroke=null,e.checkBoxKeyStroke=new fY(Yq(e)),e.$checkBox=null,e.$checkBoxLabel=null,e}return t=i,(n=[{key:"_init",value:function(e){Gq(Xq(i.prototype),"_init",this).call(this,e),this._setKeyStroke(this.keyStroke)}},{key:"_initKeyStrokeContext",value:function(){Gq(Xq(i.prototype),"_initKeyStrokeContext",this).call(this),this.keyStrokeContext.registerKeyStroke(new fY(this)),this.formKeyStrokeContext=new $u,this.formKeyStrokeContext.invokeAcceptInputOnActiveValueField=!0,this.formKeyStrokeContext.registerKeyStroke(this.checkBoxKeyStroke),this.formKeyStrokeContext.$bindTarget=function(){var e=this.getForm();return e?e.$container:this.session.desktop.$container}.bind(this)}},{key:"_render",value:function(){this.addContainer(this.$parent,"check-box-field"),this.addLabel(),this.addMandatoryIndicator(),this.addFieldContainer(this.$parent.makeDiv()),this.$checkBox=this.$fieldContainer.appendDiv("check-box").on("mousedown",this._onMouseDown.bind(this)).data("valuefield",this),this.addField(this.$checkBox),this.$checkBoxLabel=this.$fieldContainer.appendDiv("label").on("mousedown",this._onMouseDown.bind(this)),TW.linkElementWithLabel(this.$checkBox,this.$checkBoxLabel),xp.installForEllipsis(this.$checkBoxLabel,{parent:this}),this.addStatus(),this.session.keyStrokeManager.installKeyStrokeContext(this.formKeyStrokeContext)}},{key:"_renderProperties",value:function(){Gq(Xq(i.prototype),"_renderProperties",this).call(this),this._renderValue(),this._renderWrapText()}},{key:"_remove",value:function(){xp.uninstall(this.$checkBoxLabel),this.session.keyStrokeManager.uninstallKeyStrokeContext(this.formKeyStrokeContext),Gq(Xq(i.prototype),"_remove",this).call(this)}},{key:"_renderDisplayText",value:function(){}},{key:"setValue",value:function(e){this.setProperty("value",e)}},{key:"_renderValue",value:function(){this.$fieldContainer.toggleClass("checked",!0===this.value),this.$checkBox.toggleClass("checked",!0===this.value),this.$checkBox.toggleClass("undefined",this.triStateEnabled&&!0!==this.value&&!1!==this.value)}},{key:"_renderEnabled",value:function(){Gq(Xq(i.prototype),"_renderEnabled",this).call(this),this.$checkBox.setTabbable(this.enabledComputed&&!Kt.get().supportsOnlyTouch()).setEnabled(this.enabledComputed)}},{key:"setTriStateEnabled",value:function(e){this.setProperty("triStateEnabled",e),this.rendered&&this._renderValue()}},{key:"_renderLabel",value:function(){this.$checkBoxLabel.contentOrNbsp(this.labelHtmlEnabled,this.label,"empty"),this._renderEmptyLabel()}},{key:"_renderFont",value:function(){To.legacyFont(this,this.$fieldContainer),this.invalidateLayoutTree()}},{key:"_renderForegroundColor",value:function(){To.legacyForegroundColor(this,this.$fieldContainer)}},{key:"_renderBackgroundColor",value:function(){To.legacyBackgroundColor(this,this.$fieldContainer)}},{key:"_renderGridData",value:function(){Gq(Xq(i.prototype),"_renderGridData",this).call(this),this.updateInnerAlignment({useHorizontalAlignment:!0})}},{key:"_renderGridDataHints",value:function(){Gq(Xq(i.prototype),"_renderGridDataHints",this).call(this),this.updateInnerAlignment({useHorizontalAlignment:!0})}},{key:"setKeyStroke",value:function(e){this.setProperty("keyStroke",e)}},{key:"_setKeyStroke",value:function(e){this._setProperty("keyStroke",e),this.checkBoxKeyStroke.parseAndSetKeyStroke(this.keyStroke)}},{key:"setWrapText",value:function(e){this.setProperty("wrapText",e)}},{key:"_renderWrapText",value:function(){this.$checkBoxLabel.toggleClass("white-space-nowrap",!this.wrapText),this.invalidateLayoutTree()}},{key:"acceptInput",value:function(e,t){}},{key:"toggleChecked",value:function(){this.enabledComputed&&(this.triStateEnabled?!1===this.value?this.setValue(!0):!0===this.value?this.setValue(null):this.setValue(!1):this.setValue(!this.value))}},{key:"prepareForCellEdit",value:function(e){Gq(Xq(i.prototype),"prepareForCellEdit",this).call(this,e),this.$checkBoxLabel.hide()}},{key:"_onMouseDown",value:function(e){if(this.enabledComputed){this.toggleChecked();var t=this.$checkBox.is(e.currentTarget),n=this.$checkBoxLabel.isOrHas(e.currentTarget);(t||n)&&this.focusAndPreventDefault(e)}}}])&&zq(t.prototype,n),r&&zq(t,r),i}(Qz);function Zq(e){return(Zq="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Qq(e,t){return(Qq=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function eY(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=nY(e);if(t){var o=nY(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return tY(this,n)}}function tY(e,t){return!t||"object"!==Zq(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function nY(e){return(nY=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var rY=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Qq(e,t)}(n,e);var t=eY(n);function n(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),(e=t.call(this))._addRemoteProperties(["value"]),e}return n}(aG);function oY(e){return(oY="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function iY(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function sY(e,t){return(sY=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function aY(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=cY(e);if(t){var o=cY(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return lY(this,n)}}function lY(e,t){return!t||"object"!==oY(t)&&"function"!=typeof t?uY(e):t}function uY(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function cY(e){return(cY=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var fY=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&sY(e,t)}(i,e);var t,n,r,o=aY(i);function i(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(t=o.call(this)).field=e,t.which=[Ou.SPACE],t.stopPropagation=!0,t.stopImmediatePropagation=!0,t.renderingHints.hAlign=Do.LEFT,t.renderingHints.$drawingArea=function(e,t){return this.field.$fieldContainer}.bind(uY(t)),t}return t=i,(n=[{key:"handle",value:function(e){this.field.toggleChecked()}}])&&iY(t.prototype,n),r&&iY(t,r),i}(zu);function hY(e){return(hY="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function pY(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function dY(e,t,n){return(dY="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=mY(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function yY(e,t){return(yY=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function vY(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=mY(e);if(t){var o=mY(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return bY(this,n)}}function bY(e,t){return!t||"object"!==hY(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function mY(e){return(mY=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function gY(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var _Y=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&yY(e,t)}(i,e);var t,n,r,o=vY(i);function i(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(e=o.call(this)).allowedMimeTypes=null,e.maximumSize=null,e._fileUploadWaitRetryCountTimeout=99,e._fullSelectionLength=0,e}return t=i,(n=[{key:"_createKeyStrokeContext",value:function(){return new Vu}},{key:"_render",value:function(){this.addContainer(this.$parent,"clipboard-field"),this.addLabel(),this.addField(this.$parent.makeElement("<div>").addClass("input-field")),this.addStatus(),this.$field.disableSpellcheck().attr("contenteditable",!0).attr("tabindex","0").on("keydown",this._onKeyDown.bind(this)).on("input",this._onInput.bind(this)).on("paste",this._onPaste.bind(this)).on("copy",this._onCopy.bind(this)).on("cut",this._onCopy.bind(this))}},{key:"_renderProperties",value:function(){dY(mY(i.prototype),"_renderProperties",this).call(this),this._renderDropType()}},{key:"_createDragAndDropHandler",value:function(){var e=this;return rn.handler(this,{supportedScoutTypes:rn.SCOUT_TYPES.FILE_TRANSFER,onDrop:function(t){return e.trigger("drop",t)},dropType:function(){return e.dropType},dropMaximumSize:function(){return e.maximumSize},allowedTypes:function(){return e.allowedMimeTypes}})}},{key:"_renderDisplayText",value:function(){var e,t=this,n=this.displayText;this.$field.children().each((function(t,n){e||"IMG"!==n.nodeName||(e=n)})),Wn.hasText(n)?(this.$field.html(Wn.nl2br(n,!0)),this._installScrollbars(),setTimeout((function(){t.$field.selectAllText();var e=t._getSelection();t._fullSelectionLength=e?e.toString().length:0}))):this.$field.empty(),e&&this.$field.prepend(e)}},{key:"_readDisplayText",value:function(){return this.displayText}},{key:"_getSelection",value:function(){var e,t=this.$container.window(!0);return t.getSelection?e=t.getSelection():document.getSelection&&(e=document.getSelection()),e&&0!==e.toString().length?e:null}},{key:"_onKeyDown",value:function(e){return!O.isOneOf(e.which,i.ALWAYS_DESTRUCTIVE_KEYS)&&!!(e.ctrlKey||e.altKey||e.metaKey||O.isOneOf(e.which,i.NON_DESTRUCTIVE_KEYS))&&void 0}},{key:"_onInput",value:function(e){return this._renderDisplayText(),!1}},{key:"_onCopy",value:function(e){if(!Kt.get().isIos()||!1!==this._onIosCopy(e)){var t,n,r,o=this.$container.window(!0);try{e.originalEvent.clipboardData?r=e.originalEvent.clipboardData:o.clipboardData&&(r=o.clipboardData)}catch(e){s.a.log.error('Error while reading "clipboardData"',e)}if(!r)return s.a.log.error("Unable to access clipboard data."),!1;if(this._uninstallScrollbars(),t=this._getSelection()){n=t.toString().length===this._fullSelectionLength?this.displayText:t.toString();try{r.setData("text/plain",n)}catch(e){r.setData("Text",n)}return this._installScrollbars(),!1}}}},{key:"_onIosCopy",value:function(e){var t=this,n=this.$field.attr("style");return this.$field.css({color:"#000","background-color":"transparent"}),setTimeout((function(){t.$field.attrOrRemove("style",n)})),!1}},{key:"_onPaste",value:function(e){var t=this;if(this.readOnly)return!1;var n,r=Date.now(),o=this.$container.window(!0);if(this.$field.selectAllText(),e.originalEvent.clipboardData)n=e.originalEvent.clipboardData;else{if(!o.clipboardData)throw new Error("Unable to access clipboard data.");n=o.clipboardData}var i=[],a={},l=0,u=0,c=n.getData("Text");c&&(window.Blob?(i.push(new Blob([c],{type:sr.TEXT_PLAIN})),u++):(a["textTransferObject"+l++]=c,u++)),0===u&&n.items&&(Array.prototype.forEach.call(n.items,(function(e){if(e.type===sr.TEXT_PLAIN)e.getAsString((function(e){i.push(new Blob([e],{type:sr.TEXT_PLAIN})),u++}));else if(O.isOneOf(e.type,[sr.IMAGE_PNG,sr.IMAGE_JPG,sr.IMAGE_JPEG,sr.IMAGE_GIF])){var t=e.getAsFile();t&&(r-t.lastModified<1e3&&(t.scoutName=xs.EMPTY_UPLOAD_FILENAME),i.push(t),u++)}})),this._cleanupFiles(i));var f=0;0===u&&n.files&&Array.prototype.forEach.call(n.files,(function(e){var t=new FileReader;t.onload=function(t){var n=new Blob([t.target.result],{type:e.type});n.name=e.name,i.push(n),f--},t.onerror=function(t){f--,s.a.log.error("Error while reading file "+e.name+" / "+t.target.error.code)},f++,u++,t.readAsArrayBuffer(e)}));var h=0,p=function e(){if(0===f||h++===t._fileUploadWaitRetryCountTimeout)if(h>=t._fileUploadWaitRetryCountTimeout){var n={entryPoint:t.$container.entryPoint(),header:t.session.text("ui.ClipboardTimeoutTitle"),body:t.session.text("ui.ClipboardTimeout"),yesButtonText:t.session.text("Ok")};t.session.showFatalMessage(n)}else(i.length>0||Object.keys(a).length>0)&&t.session.uploadFiles(t,i,a,t.maximumSize,t.allowedMimeTypes);else setTimeout(e,150)};return u>0?(p(),!1):(function(){t._uninstallScrollbars();var e=t.$field.html();t.$field.html("");var n=function(){t.$field.html(e),t._installScrollbars()};setTimeout((function(){var e=!1;if(t.$field.children().each((function(t,n){if("IMG"===n.nodeName){var r=s()(n).attr("src"),o=/^data:(.*);base64,(.*)/.exec(r),a=o&&o[1];if(O.isOneOf(a,sr.IMAGE_PNG,sr.IMAGE_JPG,sr.IMAGE_JPEG,sr.IMAGE_GIF)){for(var l=window.atob(o[2]),u=[],c=0;c<l.length;c++)u[c]=l.charCodeAt(c);var f=new Uint8Array(u),h=new Blob([f],{type:a});h.name="",i.push(h),e=!0}}})),e)n();else{var r=t.$field.text();Wn.hasText(r)?(t.setDisplayText(r),i.push(new Blob([r],{type:sr.TEXT_PLAIN}))):n()}p()}),0)}(),!0)}},{key:"_cleanupFiles",value:function(e){var t,n;2===e.length&&(e.forEach((function(e){"image.png"===e.name&&e.scoutName?t=e:"image.jpeg"===e.name&&e.scoutName&&(n=e)})),t&&n&&rt.remove(e,n))}}])&&pY(t.prototype,n),r&&pY(t,r),i}(Qz);function wY(e){return(wY="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function kY(e,t){return(kY=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function SY(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=TY(e);if(t){var o=TY(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return OY(this,n)}}function OY(e,t){return!t||"object"!==wY(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function TY(e){return(TY=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}gY(_Y,"NON_DESTRUCTIVE_KEYS",[Ou.ESC,Ou.ENTER,Ou.TAB,Ou.PAGE_UP,Ou.PAGE_DOWN,Ou.END,Ou.HOME,Ou.LEFT,Ou.UP,Ou.RIGHT,Ou.DOWN,Ou.F1,Ou.F2,Ou.F3,Ou.F4,Ou.F5,Ou.F6,Ou.F7,Ou.F8,Ou.F9,Ou.F10,Ou.F11,Ou.F12]),gY(_Y,"ALWAYS_DESTRUCTIVE_KEYS",[Ou.BACKSPACE,Ou.DELETE]);var CY=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&kY(e,t)}(n,e);var t=SY(n);function n(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),t.call(this)}return n}(aG);function PY(e){return(PY="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function RY(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function xY(e,t){return(xY=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function EY(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=AY(e);if(t){var o=AY(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return DY(this,n)}}function DY(e,t){return!t||"object"!==PY(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function AY(e){return(AY=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var FY=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&xY(e,t)}(i,e);var t,n,r,o=EY(i);function i(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),o.call(this)}return t=i,(n=[{key:"_render",value:function(){this.addContainer(this.$parent,"color-field"),this.addLabel(),this.addField(this.$parent.makeDiv("not-implemented").text("not implemented yet")),this.addMandatoryIndicator(),this.addStatus()}}])&&RY(t.prototype,n),r&&RY(t,r),i}(Qz);function $Y(e){return($Y="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function jY(e,t){return(jY=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function BY(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=IY(e);if(t){var o=IY(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return MY(this,n)}}function MY(e,t){return!t||"object"!==$Y(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function IY(e){return(IY=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var LY=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&jY(e,t)}(n,e);var t=BY(n);function n(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),t.call(this)}return n}(aG);function HY(e){return(HY="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function NY(e,t){return(NY=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function VY(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=zY(e);if(t){var o=zY(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return WY(this,n)}}function WY(e,t){return!t||"object"!==HY(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function zY(e){return(zY=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var GY=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&NY(e,t)}(n,e);var t=VY(n);function n(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),t.call(this)}return n}(Br);function UY(e){return(UY="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function KY(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function qY(e,t,n){return(qY="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=ZY(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function YY(e,t){return(YY=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function XY(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=ZY(e);if(t){var o=ZY(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return JY(this,n)}}function JY(e,t){return!t||"object"!==UY(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function ZY(e){return(ZY=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function QY(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var eX=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&YY(e,t)}(i,e);var t,n,r,o=XY(i);function i(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(e=o.call(this)).popup=null,e.autoDate=null,e.dateDisplayText=null,e.dateHasText=!1,e.dateFocused=!1,e.dateFormatPattern=null,e.disabledCopyOverlay=!0,e.hasDate=!0,e.touchMode=!1,e.embedded=!1,e.hasTime=!1,e.hasTimePopup=!0,e.timeDisplayText=null,e.timeHasText=!1,e.timeDisplayText=null,e.timePickerResolution=30,e.timeFormatPattern=null,e.timeFocused=!1,e.$dateField=null,e.$timeField=null,e.$dateFieldIcon=null,e.$timeFieldIcon=null,e.$dateClearIcon=null,e.$timeClearIcon=null,e._$predictDateField=null,e._$predictTimeField=null,e._tempTimeDate=null,e.invalidValueMessageKey="ui.InvalidDate",e._addCloneProperties(["hasDate","hasTime","dateFormatPattern","timeFormatPattern","allowedDates","autoDate"]),e}return t=i,(n=[{key:"_createKeyStrokeContext",value:function(){return new Vu}},{key:"_init",value:function(e){qY(ZY(i.prototype),"_init",this).call(this,e),TW.initTouch(this,e),this.popup=e.popup,this._setAutoDate(this.autoDate),this._setDisplayText(this.displayText),this._setAllowedDates(this.allowedDates),this._setTimePickerResolution(this.timePickerResolution)}},{key:"_initValue",value:function(e){this._setDateFormatPattern(this.dateFormatPattern),this._setTimeFormatPattern(this.timeFormatPattern),qY(ZY(i.prototype),"_initValue",this).call(this,e)}},{key:"createDatePopup",value:function(){var e=this.touchMode?"DatePickerTouchPopup":"DatePickerPopup";return O.create(e,{parent:this,$anchor:this.$field,boundToAnchor:!this.touchMode,cssClass:this._errorStatusClass(),closeOnAnchorMouseDown:!1,field:this,allowedDates:this.allowedDates,dateFormat:this.isolatedDateFormat,displayText:this.dateDisplayText})}},{key:"createTimePopup",value:function(){var e=this.touchMode?"TimePickerTouchPopup":"TimePickerPopup";return O.create(e,{parent:this,$anchor:this.$timeField,boundToAnchor:!this.touchMode,cssClass:this._errorStatusClass(),closeOnAnchorMouseDown:!1,field:this,timeResolution:this.timePickerResolution})}},{key:"_render",value:function(){this.addContainer(this.$parent,"date-field"),this.addLabel(),this.addField(this.$parent.makeDiv("date-time-composite")),this.addStatus(this.$field),this.embedded||this.addMandatoryIndicator(),this.htmlDateTimeComposite=ea.install(this.$field,this.session),this.htmlDateTimeComposite.setLayout(new vX(this))}},{key:"_renderProperties",value:function(){this._renderHasDate(),this._renderHasTime(),qY(ZY(i.prototype),"_renderProperties",this).call(this),this._renderDateHasText(),this._renderTimeHasText()}},{key:"_remove",value:function(){qY(ZY(i.prototype),"_remove",this).call(this),this.$dateField=null,this.$timeField=null,this.$dateFieldIcon=null,this.$timeFieldIcon=null,this.$dateClearIcon=null,this.$timeClearIcon=null,this._$predictDateField=null,this._$predictTimeField=null,this.popup=null}},{key:"setHasDate",value:function(e){this.setProperty("hasDate",e)}},{key:"_setHasDate",value:function(e){this._setProperty("hasDate",e),this.initialized&&this._updateDisplayTextProperty()}},{key:"_renderHasDate",value:function(){this.hasDate&&!this.$dateField?(this.$dateField=TW.makeInputOrDiv(this,"date").on("mousedown",this._onDateFieldMouseDown.bind(this)).appendTo(this.$field),this.$timeField&&this.$dateField.insertBefore(this.$timeField),this.touchMode||this.$dateField.on("keydown",this._onDateFieldKeyDown.bind(this)).on("input",this._onDateFieldInput.bind(this)).on("blur",this._onDateFieldBlur.bind(this)).on("focus",this._onDateFieldFocus.bind(this)),this._linkWithLabel(this.$dateField),ea.install(this.$dateField,this.session),this.$dateFieldIcon=TW.appendIcon(this.$field,"date").on("mousedown",this._onDateIconMouseDown.bind(this)),this.$dateFieldIcon.addClass("needsclick")):!this.hasDate&&this.$dateField&&(this.$dateField.remove(),this.$dateField=null,this.$dateFieldIcon.remove(),this.$dateFieldIcon=null),this.rendering||(this._renderDisplayText(),this._renderFieldStyle(),this._renderEnabled(),this.htmlDateTimeComposite.invalidateLayoutTree()),this._renderDateClearable()}},{key:"setHasTime",value:function(e){this.setProperty("hasTime",e)}},{key:"_setHasTime",value:function(e){this._setProperty("hasTime",e),this.initialized&&this._updateDisplayTextProperty()}},{key:"_renderHasTime",value:function(){this.hasTime&&!this.$timeField?(this.$timeField=TW.makeInputOrDiv(this,"time").on("mousedown",this._onTimeFieldMouseDown.bind(this)).appendTo(this.$field),this.$dateField&&this.$timeField.insertAfter(this.$dateField),this.touchMode&&this.hasTimePopup||this.$timeField.on("keydown",this._onTimeFieldKeyDown.bind(this)).on("input",this._onTimeFieldInput.bind(this)).on("blur",this._onTimeFieldBlur.bind(this)).on("focus",this._onTimeFieldFocus.bind(this)),this._linkWithLabel(this.$timeField),ea.install(this.$timeField,this.session),this.$timeFieldIcon=TW.appendIcon(this.$field,"time").on("mousedown",this._onTimeIconMouseDown.bind(this)),this.$timeFieldIcon.addClass("needsclick")):!this.hasTime&&this.$timeField&&(this.$timeField.remove(),this.$timeField=null,this.$timeFieldIcon.remove(),this.$timeFieldIcon=null),this.rendering||(this._renderDisplayText(),this._renderFieldStyle(),this._renderEnabled(),this.htmlDateTimeComposite.invalidateLayoutTree()),this._renderTimeClearable()}},{key:"setTimePickerResolution",value:function(e){this.setProperty("timePickerResolution",e)}},{key:"_setTimePickerResolution",value:function(e){e<1?(e=10,this.hasTimePopup=!1):this.hasTimePopup=!0,this._setProperty("timePickerResolution",e)}},{key:"_renderPlaceholder",value:function(e){qY(ZY(i.prototype),"_renderPlaceholder",this).call(this,this._fieldForPlaceholder())}},{key:"_removePlaceholder",value:function(e){qY(ZY(i.prototype),"_removePlaceholder",this).call(this,this._fieldForPlaceholder())}},{key:"_fieldForPlaceholder",value:function(){return this.hasDate?this.$dateField:this.hasTime?this.$timeField:null}},{key:"setDateFormatPattern",value:function(e){this.setProperty("dateFormatPattern",e)}},{key:"_setDateFormatPattern",value:function(e){e||(e=this.session.locale.dateFormatPatternDefault),this._setProperty("dateFormatPattern",e),this.isolatedDateFormat=new tp(this.session.locale,this.dateFormatPattern),this.initialized&&this._updateDisplayText()}},{key:"setTimeFormatPattern",value:function(e){this.setProperty("timeFormatPattern",e)}},{key:"_setTimeFormatPattern",value:function(e){e||(e=this.session.locale.timeFormatPatternDefault),this._setProperty("timeFormatPattern",e),this.isolatedTimeFormat=new tp(this.session.locale,this.timeFormatPattern),this.initialized&&this._updateDisplayText()}},{key:"_renderEnabled",value:function(){qY(ZY(i.prototype),"_renderEnabled",this).call(this),this.$container.setEnabled(this.enabledComputed),this.$dateField&&this.$dateField.setEnabled(this.enabledComputed),this.$timeField&&this.$timeField.setEnabled(this.enabledComputed),Kt.get().isInternetExplorer()&&!this.enabledComputed&&this.closePopup()}},{key:"_renderDisplayText",value:function(){this.hasDate&&this._renderDateDisplayText(),this.hasTime&&this._renderTimeDisplayText(),this._removePredictionFields()}},{key:"_readDisplayText",value:function(){var e,t;return this.hasDate&&(e=this._readDateDisplayText()),this.hasTime&&(t=this._readTimeDisplayText()),this._computeDisplayText(e,t)}},{key:"_renderDateDisplayText",value:function(){TW.valOrText(this.$dateField,this.dateDisplayText),this._updateDateHasText()}},{key:"_readDateDisplayText",value:function(){return this._$predictDateField?TW.valOrText(this._$predictDateField):TW.valOrText(this.$dateField)}},{key:"_renderTimeDisplayText",value:function(){TW.valOrText(this.$timeField,this.timeDisplayText),this._updateTimeHasText()}},{key:"_readTimeDisplayText",value:function(){return this._$predictTimeField?TW.valOrText(this._$predictTimeField):TW.valOrText(this.$timeField)}},{key:"setDisplayText",value:function(e){this._setDisplayText(e),this.rendered&&this._renderDisplayText()}},{key:"_setDisplayText",value:function(e){this._setProperty("displayText",e);var t=this._splitDisplayText(e);this.hasDate&&(this.dateDisplayText=t.dateText),this.hasTime&&(this.timeDisplayText=t.timeText)}},{key:"_ensureValue",value:function(e){return Et.ensure(e)}},{key:"_validateValue",value:function(e){if(Pr.isNullOrUndefined(e))return e;if(!(e instanceof Date))throw this.session.text(this.invalidValueMessageKey);return this.hasDate||this.value||(e=Et.combineDateTime(null,e)),e}},{key:"_valueEquals",value:function(e,t){return Et.equals(e,t)}},{key:"setAutoDate",value:function(e){this.setProperty("autoDate",e)}},{key:"_setAutoDate",value:function(e){e=Et.ensure(e),this._setProperty("autoDate",e)}},{key:"_setAllowedDates",value:function(e){Array.isArray(e)?(e=e.map((function(e){return Et.ensure(e)})),this._setProperty("allowedDates",e)):this._setProperty("allowedDates",null)}},{key:"_renderErrorStatus",value:function(){qY(ZY(i.prototype),"_renderErrorStatus",this).call(this);var e=!!this.errorStatus,t=this._errorStatusClass();this.$dateField&&(this._updateErrorStatusClassesOnElement(this.$dateField,t,e),this._updateErrorStatusClassesOnElement(this._$predictDateField,t,e)),this.$timeField&&(this._updateErrorStatusClassesOnElement(this.$timeField,t,e),this._updateErrorStatusClassesOnElement(this._$predictTimeField,t,e)),this.popup&&this._updateErrorStatusClassesOnElement(this.popup.$container,t,e)}},{key:"_errorStatusClass",value:function(){return this.errorStatus&&!this._isSuppressStatusField()?"has-"+this.errorStatus.cssClass():""}},{key:"_renderFont",value:function(){this.$dateField&&To.legacyFont(this,this.$dateField),this.$timeField&&To.legacyFont(this,this.$timeField)}},{key:"_renderForegroundColor",value:function(){this.$dateField&&To.legacyForegroundColor(this,this.$dateField),this.$timeField&&To.legacyForegroundColor(this,this.$timeField)}},{key:"_renderBackgroundColor",value:function(){this.$dateField&&To.legacyBackgroundColor(this,this.$dateField),this.$timeField&&To.legacyBackgroundColor(this,this.$timeField)}},{key:"activate",value:function(){this.enabledComputed&&this.rendered&&(this.$dateField?(this.$dateField.focus(),this._onDateFieldMouseDown()):this.$timeField&&(this.$timeField.focus(),this._onTimeFieldMouseDown()))}},{key:"getFocusableElement",value:function(){return this.$dateField?this.$dateField:this.$timeField?this.$timeField:null}},{key:"_onDateFieldMouseDown",value:function(){TW.handleOnClick(this)&&this.openDatePopupAndSelect(this.value)}},{key:"_onTimeFieldMouseDown",value:function(){TW.handleOnClick(this)&&this.openTimePopupAndSelect(this.value)}},{key:"setDateFocused",value:function(e){this.setProperty("dateFocused",e)}},{key:"_renderDateFocused",value:function(){this.$container.toggleClass("date-focused",this.dateFocused)}},{key:"_updateTimeHasText",value:function(){this.setTimeHasText(Wn.hasText(this._readTimeDisplayText()))}},{key:"setTimeHasText",value:function(e){this.setProperty("timeHasText",e)}},{key:"_renderTimeHasText",value:function(){this.$timeField&&this.$timeField.toggleClass("has-text",this.timeHasText),this.$container.toggleClass("time-has-text",this.timeHasText)}},{key:"_updateDateHasText",value:function(){this.setDateHasText(Wn.hasText(this._readDateDisplayText()))}},{key:"setDateHasText",value:function(e){this.setProperty("dateHasText",e)}},{key:"_renderDateHasText",value:function(){this.$dateField&&this.$dateField.toggleClass("has-text",this.dateHasText),this.$container.toggleClass("date-has-text",this.dateHasText)}},{key:"clear",value:function(){this.hasDate&&this.hasTime?(this._clear(),this.dateFocused||this.timeFocused||this.acceptInput(),this._triggerClear()):qY(ZY(i.prototype),"clear",this).call(this)}},{key:"_clear",value:function(){this._removePredictionFields(),this.hasDate&&!this.timeFocused&&(TW.valOrText(this.$dateField,""),this._setDateValid(!0),this._updateDateHasText()),this.hasTime&&!this.dateFocused&&(TW.valOrText(this.$timeField,""),this._setTimeValid(!0),this._updateTimeHasText())}},{key:"_onDateClearIconMouseDown",value:function(e){this.enabledComputed&&(this.$dateField.focus(),this.clear(),this.value?this.selectDate(this.value,!1):this.preselectDate(this._referenceDate(),!1),e.preventDefault())}},{key:"_onDateIconMouseDown",value:function(e){this.enabledComputed&&(this.$dateField.focus(),this.embedded||this.openDatePopupAndSelect(this.value))}},{key:"setTimeFocused",value:function(e){this.setProperty("timeFocused",e)}},{key:"_renderTimeFocused",value:function(){this.$container.toggleClass("time-focused",this.timeFocused)}},{key:"_renderClearable",value:function(){this._renderDateClearable(),this._renderTimeClearable(),this._updateClearableStyles()}},{key:"_renderDateClearable",value:function(){this.hasDate||this.isClearable()?this.$dateClearIcon||(this.$dateClearIcon=this.$field.appendSpan("icon date-clear unfocusable").on("mousedown",this._onDateClearIconMouseDown.bind(this)),this.$dateClearIcon.addClass("needsclick")):this.$dateClearIcon&&(this.$dateClearIcon.remove(),this.$dateClearIcon=null)}},{key:"_renderTimeClearable",value:function(){this.hasTime&&this.isClearable()&&!this.$timeClearIcon?(this.$timeClearIcon=this.$field.appendSpan("icon time-clear unfocusable").on("mousedown",this._onTimeClearIconMouseDown.bind(this)),this.$timeClearIcon.addClass("needsclick")):this.hasTime&&this.isClearable()||!this.$timeClearIcon||(this.$timeClearIcon.remove(),this.$timeClearIcon=null)}},{key:"_onTimeClearIconMouseDown",value:function(e){this.enabledComputed&&(this.$timeField.focus(),this.clear(),this.value?this.selectTime(this.value,!1):this.preselectTime(this._referenceDate(),!1),e.preventDefault())}},{key:"_onTimeIconMouseDown",value:function(e){this.enabledComputed&&(this.$timeField.focus(),this.embedded||this.openTimePopupAndSelect(this.value))}},{key:"_onDateFieldBlur",value:function(e){this.setFocused(!1),this.setDateFocused(!1),this.embedded||(this.popup instanceof eb&&this.closePopup(),this.setDateFocused(!1),this.acceptDate(),this._removePredictionFields())}},{key:"_onDateFieldFocus",value:function(e){this.setFocused(!0),this.setDateFocused(!0)}},{key:"_onTimeFieldBlur",value:function(e){this._tempTimeDate=null,this.setFocused(!1),this.setTimeFocused(!1),this.embedded||(this.popup instanceof fH&&this.closePopup(),this._tempTimeDate=null,this.setTimeFocused(!1),this.acceptTime(),this._removePredictionFields())}},{key:"_onTimeFieldFocus",value:function(){this.setFocused(!0),this.setTimeFocused(!0)}},{key:"_onDateFieldKeyDown",value:function(e){var t=0,n=0,r=0,o=0,i=this.$dateField[0].selectionStart,a=TW.valOrText(this.$dateField),l=this._$predictDateField&&TW.valOrText(this._$predictDateField),u=(e.ctrlKey?1:0)+(e.shiftKey?1:0)+(e.altKey?1:0)+(e.metaKey?1:0),c=this.value||this._referenceDate(),f=!0;if(this.hasTime&&this.mode===ZW.Mode.CELLEDITOR&&e.which===Ou.TAB&&0===u)e.stopPropagation();else if(e.which!==Ou.TAB&&e.which!==Ou.SHIFT&&e.which!==Ou.HOME&&e.which!==Ou.END&&e.which!==Ou.CTRL&&e.which!==Ou.ALT)if(e.which!==Ou.ENTER)if(e.which!==Ou.ESC)if(e.which!==Ou.RIGHT||i!==a.length){if((e.which===Ou.UP||e.which===Ou.DOWN||e.which===Ou.PAGE_UP||e.which===Ou.PAGE_DOWN)&&a&&!this._isDateValid()){var h=this.isolatedDateFormat.parse(a,c);h&&(c=h,this._setDateValid(!0))}if(e.which===Ou.PAGE_UP||e.which===Ou.PAGE_DOWN)return a&&this._isDateValid()?this.popup||this.openDatePopupAndSelect(c):(c=this._referenceDate(),this.hasTime&&(c=Et.combineDateTime(c,this.value||this._referenceDate())),this.openDatePopupAndSelect(c),this._updateDisplayText(c),this._setDateValid(!0),f=!1),f&&(r=e.which===Ou.PAGE_UP?-1:1,this.shiftSelectedDate(0,r,0),this._updateDisplayText(this.getDatePicker().selectedDate)),void s.a.suppressEvent(e);if(e.which===Ou.UP||e.which===Ou.DOWN){if(t=e.which===Ou.UP?-1:1,(e.ctrlKey||e.metaKey)&&1===u)n=t;else if(e.shiftKey&&1===u)r=t;else{if(0!==u)return void s.a.suppressEvent(e);o=t}a&&this._isDateValid()?this.popup||this.openDatePopupAndSelect(c):(c=this._referenceDate(),this.hasTime&&(c=Et.combineDateTime(c,this.value||this._referenceDate())),this.openDatePopupAndSelect(c),this._updateDisplayText(c),this._setDateValid(!0),f=!1),f&&(this.shiftSelectedDate(n,r,o),this._updateDisplayText(this.getDatePicker().selectedDate)),s.a.suppressEvent(e)}}else l&&this._setDateDisplayText(l.substring(0,a.length+1));else this.popup&&(this.closePopup(),s.a.suppressEvent(e));else(this.popup||this._$predictDateField)&&(this.acceptDate(),this.closePopup(),s.a.suppressEvent(e))}},{key:"_onDateFieldInput",value:function(e){var t=this,n=TW.valOrText(this.$dateField);if(this.$dateField[0]===this.$dateField.activeElement(!0)){this._$predictDateField||(this._$predictDateField=this._createPredictionField(this.$dateField)),this._removePredictErrorStatus();var r=this._predictDate(n);r?(TW.valOrText(this._$predictDateField,r.text),this.openDatePopupAndSelect(r.date)):this._removePredictionFields(),this._updateDateHasText(),setTimeout((function(){t._$predictDateField&&t._$predictDateField.setVisible(0===t.$dateField.scrollLeft())}),50)}}},{key:"acceptInput",value:function(){var e=O.nvl(this._readDisplayText(),""),t=this._checkDisplayTextChanged(e);if(t)this.parseAndSetValue(e);else{var n=this.value;this.parseAndSetValue(e),Et.equals(this.value,n)||(t=!0)}t&&this._triggerAcceptInput()}},{key:"acceptDate",value:function(){var e=this.containsStatus(Xr);this.hasTime&&!e&&Wn.empty(this.$dateField.val())&&this.$timeField.val(""),this.acceptInput()}},{key:"acceptTime",value:function(){var e=this.containsStatus(Xr);this.hasDate&&!e&&Wn.empty(this.$timeField.val())&&this.$dateField.val(""),this.acceptInput()}},{key:"acceptDateTime",value:function(e,t){e?this.acceptDate():t&&this.acceptTime()}},{key:"_onTimeFieldKeyDown",value:function(e){var t=0,n=0,r=0,o=0,i=this.$timeField[0].selectionStart,a=this.$timeField.val(),l=this._$predictTimeField&&this._$predictTimeField.val(),u=(e.ctrlKey?1:0)+(e.shiftKey?1:0)+(e.altKey?1:0)+(e.metaKey?1:0),c=this.value||this._referenceDate(),f=!0;if(this.hasDate&&this.mode===ZW.Mode.CELLEDITOR&&e.which===Ou.TAB&&e.shiftKey&&1===u)e.stopPropagation();else if(e.which!==Ou.TAB&&e.which!==Ou.SHIFT&&e.which!==Ou.HOME&&e.which!==Ou.END&&e.which!==Ou.CTRL&&e.which!==Ou.ALT)if(e.which!==Ou.ENTER)if(e.which!==Ou.ESC)if(e.which!==Ou.RIGHT||i!==a.length){if(e.which===Ou.UP||e.which===Ou.DOWN){if(t=e.which===Ou.UP?-1:1,e.ctrlKey&&1===u)o=t;else if(e.shiftKey&&1===u)n=t;else{if(0!==u)return void s.a.suppressEvent(e);r=t}if(this.hasTimePopup)a&&this._isTimeValid()?this.popup||this.openTimePopupAndSelect(c):(c=this._referenceDate(),this.openTimePopupAndSelect(c),this._updateDisplayText(c),this._setTimeValid(!0),f=!1),f&&(this.shiftSelectedTime(n,r,o),this._updateDisplayText(this.getTimePicker().selectedTime)),s.a.suppressEvent(e);else{if(!this._tempTimeDate){var h=this._predictTime(a);h&&h.date?this._tempTimeDate=h.date:(this._tempTimeDate=this._referenceDate(),f=!1)}f&&(this._tempTimeDate=Et.shiftTime(this._tempTimeDate,n,r,o)),this.hasDate&&(this._tempTimeDate=Et.combineDateTime(this.value||this._referenceDate(),this._tempTimeDate)),this._updateDisplayText(this._tempTimeDate),this._setTimeValid(!0),s.a.suppressEvent(e)}}}else l&&this._setTimeDisplayText(l.substring(0,a.length+1));else this.popup&&(this.closePopup(),s.a.suppressEvent(e));else(this.popup||this._$predictDateField)&&(this._tempTimeDate=null,this.acceptTime(),this.closePopup(),s.a.suppressEvent(e))}},{key:"_onTimeFieldInput",value:function(e){var t=this,n=this.$timeField.val();if(this.$timeField[0]===this.$timeField.activeElement(!0)){this._$predictTimeField||(this._$predictTimeField=this._createPredictionField(this.$timeField));var r=this._predictTime(n);r?(this._$predictTimeField.val(r.text),this.openTimePopupAndSelect(r.date)):(this._tempTimeDate=null,this._removePredictionFields()),this._updateTimeHasText(),setTimeout((function(){t._$predictTimeField&&t._$predictTimeField.setVisible(0===t.$timeField.scrollLeft())}),50)}}},{key:"_onDatePickerDateSelect",value:function(e){this._setDateValid(!0),this._setTimeValid(!0);var t=this._newTimestampAsDate(e.date,this.value);this.setValue(t),this.closePopup(),this._triggerAcceptInput()}},{key:"_onTimePickerTimeSelect",value:function(e){this._setDateValid(!0),this._setTimeValid(!0);var t=this._newTimestampAsDate(this.value,e.time);this.setValue(t),this.closePopup(),this._triggerAcceptInput()}},{key:"_createPredictionField",value:function(e){this.setSuppressStatus(ZW.SuppressStatus.ALL);var t=e.clone().addClass("predict").attr("tabIndex","-1").insertBefore(e);return e.hasClass("has-error")&&t.addClass("has-error"),t}},{key:"_removePredictionFields",value:function(){this.setSuppressStatus(null),this._$predictDateField&&(this._$predictDateField.remove(),this._$predictDateField=null),this._$predictTimeField&&(this._$predictTimeField.remove(),this._$predictTimeField=null)}},{key:"_setDateDisplayText",value:function(e){this.dateDisplayText=e,this._updateDisplayTextProperty(),this.rendered&&this._renderDateDisplayText()}},{key:"_setTimeDisplayText",value:function(e){this.timeDisplayText=e,this._updateDisplayTextProperty(),this.rendered&&this._renderTimeDisplayText()}},{key:"_computeDisplayText",value:function(e,t){var n=e||"",r=t||"",o=(this.hasDate?n:"")+(this.hasDate&&this.hasTime?"\n":"")+(this.hasTime?r:"");return"\n"===o&&(o=""),o}},{key:"_splitDisplayText",value:function(e){var t="",n="";if(Wn.hasText(e)){var r=e.split("\n");t=this.hasDate?r[0]:"",n=this.hasTime?this.hasDate?r[1]:r[0]:""}return{dateText:t,timeText:n}}},{key:"_updateDisplayTextProperty",value:function(){this._setProperty("displayText",this._computeDisplayText(this.dateDisplayText,this.timeDisplayText))}},{key:"aboutToBlurByMouseDown",value:function(e){var t,n,r,o,i=!!this.$dateField&&(this.$dateField.isOrHas(e)||this.$dateFieldIcon.isOrHas(e)||this.$dateClearIcon&&this.$dateClearIcon.isOrHas(e)),s=!!this.$timeField&&(this.$timeField.isOrHas(e)||this.$timeFieldIcon.isOrHas(e)||this.$timeClearIcon&&this.$timeClearIcon.isOrHas(e)),a=this.popup&&this.popup.$container.isOrHas(e),l=this.fieldStatus&&this.fieldStatus.$container.isOrHas(e),u=this.getDatePicker(),c=this.getTimePicker();if(!(i||s||a||l))return t=Uf.isActiveElement(this.$dateField),n=Uf.isActiveElement(this.$timeField),void this.acceptDateTime(t,n);this.embedded&&(r=u&&u.$container.isOrHas(e),o=c&&c.$container.isOrHas(e),r&&o&&this.acceptTime())}},{key:"_newTimestampAsDate",value:function(e,t){var n=null;return(e||t)&&(n=this.value||this._referenceDate(),e&&(n=Et.combineDateTime(e,n)),t&&(n=Et.combineDateTime(n,t))),n}},{key:"_referenceDate",value:function(){var e=this.autoDate||Et.ceil(Et.newDate(),this.timePickerResolution);return e=this.autoDate?this.autoDate:this.hasTime?Et.ceil(Et.newDate(),this.timePickerResolution):Et.trunc(Et.newDate()),this.allowedDates&&(e=this._findAllowedReferenceDate(e)),e}},{key:"_findAllowedReferenceDate",value:function(e){var t,n;for(t=0;t<this.allowedDates.length;t++)if(n=this.allowedDates[t],Et.compare(n,e)>=0)return n;for(t=this.allowedDates.length-1;t>=0;t--)if(n=this.allowedDates[t],Et.compare(n,e)<=0)return n;return e}},{key:"openDatePopup",value:function(e){var t=this;this.popup||(this.popup=this.createDatePopup(),this.popup.open(),this.$dateField.addClass("focused"),this.popup.on("remove",(function(e){t._onPopupRemove(e),t.popup=null,t.$dateField.removeClass("focused")})),this.getDatePicker().on("dateSelect",this._onDatePickerDateSelect.bind(this)))}},{key:"closePopup",value:function(){this.popup&&this.popup.close()}},{key:"toggleDatePopup",value:function(){s.a.log.isInfoEnabled()&&s.a.log.info("(DateField#toggleDatePopup) popupOpen=",!!this.popup),this.popup?this.closePopup():this.openDatePopupAndSelect(this.value)}},{key:"openTimePopup",value:function(e){var t=this;this.hasTimePopup&&!this.popup&&(this.popup=this.createTimePopup(),this.popup.open(),this.$timeField.addClass("focused"),this.popup.on("remove",(function(e){t._onPopupRemove(e),t.popup=null,t.$timeField.removeClass("focused")})),this.getTimePicker().on("timeSelect",this._onTimePickerTimeSelect.bind(this)))}},{key:"toggleTimePopup",value:function(){s.a.log.isInfoEnabled()&&s.a.log.info("(DateField#toggleTimePopup) popupOpen=",!!this.popup),this.popup?this.closePopup():this.openTimePopupAndSelect(this.value)}},{key:"_parseValue",value:function(e){var t=this._splitDisplayText(e),n=t.dateText,r={},o=t.timeText,i={},s=!0;if(this._removePredictErrorStatus(),this.hasDate&&((r=this._predictDate(n))||(s=!1),this._setDateDisplayText(n)),this.hasTime&&((i=this._predictTime(o))||(s=!1),this._setTimeDisplayText(o)),!s)throw new GY;return r.date||i.date?this._newTimestampAsDate(r.date,i.date):null}},{key:"_addParsingFailedErrorStatus",value:function(e,t){t instanceof GY||qY(ZY(i.prototype),"_addParsingFailedErrorStatus",this).call(this,e,t)}},{key:"_predictDate",value:function(e){var t=(e=e||"").match(/^([+-])(\d*)$/);if(t){var n=Et.newDate(),r=Number(t[1]+(t[2]||"0"));return n.setDate(n.getDate()+r),isNaN(n.valueOf())||n.getDate()<0?(this._setDateValid(!1),null):(this._setDateValid(!0),{date:n,text:e})}var o=this._analyzeInputAsDate(e,this.value||this._referenceDate());if(o.error)return this._setDateValid(!1),null;if(!o.predictedDate)return this._setDateValid(!0),{date:null,text:""};var i=o.predictedDate,s=new tp(this.isolatedDateFormat.locale,o.parsedPattern).format(i,!0);return(t=s.match(new RegExp("^"+Wn.quote(e)+"(.*)$","i")))&&(s=e+t[1]),this._setDateValid(!0),{date:i,text:s}}},{key:"_predictTime",value:function(e){e=e||"";var t=this._analyzeInputAsTime(e,this.value||this._referenceDate());if(t.error)return this._setTimeValid(!1),null;if(!t.predictedDate)return this._setTimeValid(!0),{date:null,text:""};var n=t.predictedDate,r=new tp(this.isolatedTimeFormat.locale,t.parsedPattern).format(n,!0),o=r.match(new RegExp("^"+Wn.quote(e)+"(.*)$","i"));return o&&(r=e+o[1]),this._setTimeValid(!0),{date:n,text:r}}},{key:"_analyzeInputAsDate",value:function(e,t){return this.isolatedDateFormat.analyze(e,t)}},{key:"_analyzeInputAsTime",value:function(e,t){return this.isolatedTimeFormat.analyze(e,t)}},{key:"_setErrorStatusPart",value:function(e,t){var n=null,r=null;this.errorStatus&&(r=rt.find(this.errorStatus.asFlatList(),i.PARSE_ERROR_PREDICATE)),n=r||new Xr({message:this.session.text("ui.InvalidDate"),severity:Br.Severity.ERROR,code:i.ErrorCode.PARSE_ERROR}),t?delete n[e]:n[e]=!0,n.hasOwnProperty("invalidDate")||n.hasOwnProperty("invalidTime")||(n=null),n&&!r?this.addErrorStatus(n):!n&&r&&this._removePredictErrorStatus()}},{key:"_removePredictErrorStatus",value:function(){this.removeErrorStatusByPredicate(i.PARSE_ERROR_PREDICATE)}},{key:"_createInvalidValueStatus",value:function(e,t,n){var r=qY(ZY(i.prototype),"_createInvalidValueStatus",this).call(this,e,t,n);return r.invalidDate=!0,r.invalidTime=!0,r.code=i.ErrorCode.PARSE_ERROR,r}},{key:"_setDateValid",value:function(e){this._setErrorStatusPart("invalidDate",e)}},{key:"_setTimeValid",value:function(e){this._setErrorStatusPart("invalidTime",e)}},{key:"_isErrorStatusPartValid",value:function(e){return!this.errorStatus||!this.errorStatus.asFlatList().some((function(t){return!!t[e]}))}},{key:"_isDateValid",value:function(){return this._isErrorStatusPartValid("invalidDate")}},{key:"_isTimeValid",value:function(){return this._isErrorStatusPartValid("invalidTime")}},{key:"onCellEditorRendered",value:function(e){e.openFieldPopup&&(this.hasDate&&!this.hasTime?this.openDatePopupAndSelect(this.value):!this.hasDate&&this.hasTime?this.openTimePopupAndSelect(this.value):Kt.get().supportsOnlyTouch()||this.openDatePopupAndSelect(this.value)),this.touchMode&&(this._cellEditorPopup=e.cellEditorPopup)}},{key:"_onPopupRemove",value:function(e){this.touchMode&&this._cellEditorPopup&&(this.hasDate&&this.hasTime||(this._cellEditorPopup.completeEdit(),this._cellEditorPopup=null))}},{key:"prepareForCellEdit",value:function(e){e=e||{},qY(ZY(i.prototype),"prepareForCellEdit",this).call(this,e),this.$field.removeClass("cell-editor-field first last"),this.$dateField&&this.addCellEditorFieldCssClasses(this.$dateField,e),this.$timeField&&(this.$dateField||(e.cssClass=""),this.addCellEditorFieldCssClasses(this.$timeField,e))}},{key:"getDatePicker",value:function(){if(this.popup&&this.popup.getDatePicker)return this.popup.getDatePicker()}},{key:"openDatePopupAndSelect",value:function(e){this.openDatePopup(),e?this.selectDate(e,!1):this.preselectDate(this._referenceDate(),!1)}},{key:"preselectDate",value:function(e,t){var n=this.getDatePicker();n&&n.preselectDate(e,t)}},{key:"selectDate",value:function(e,t){var n=this.getDatePicker();n&&n.selectDate(e,t)}},{key:"getTimePicker",value:function(){if(this.popup&&this.popup.getTimePicker)return this.popup.getTimePicker()}},{key:"openTimePopupAndSelect",value:function(e){this.hasTimePopup&&(this.openTimePopup(),e?this.selectTime(e):this.preselectTime(this._referenceDate()))}},{key:"preselectTime",value:function(e){var t=this.getTimePicker();t&&t.preselectTime(e)}},{key:"selectTime",value:function(e){var t=this.getTimePicker();t&&t.selectTime(e)}},{key:"shiftSelectedDate",value:function(e,t,n){this.openDatePopup(),this.getDatePicker().shiftSelectedDate(e,t,n)}},{key:"shiftSelectedTime",value:function(e,t,n){this.openTimePopup(),this.getTimePicker().shiftSelectedTime(e,t,n)}},{key:"_formatValue",value:function(e){var t="",n="";return this.hasDate&&(e&&(t=this.isolatedDateFormat.format(e)),this.dateDisplayText=t),this.hasTime&&(e&&(n=this.isolatedTimeFormat.format(e)),this.timeDisplayText=n),this._computeDisplayText(this.dateDisplayText,this.timeDisplayText)}},{key:"_renderFieldStyle",value:function(){qY(ZY(i.prototype),"_renderFieldStyle",this).call(this),this._renderFieldStyleInternal(this.$dateField),this._renderFieldStyleInternal(this.$timeField)}},{key:"_renderDisabledStyle",value:function(){qY(ZY(i.prototype),"_renderDisabledStyle",this).call(this),this._renderDisabledStyleInternal(this.$dateField),this._renderDisabledStyleInternal(this.$timeField)}},{key:"_triggerAcceptInput",value:function(){var e={displayText:this.displayText,errorStatus:this.errorStatus,value:this.value};this.trigger("acceptInput",e)}}])&&KY(t.prototype,n),r&&KY(t,r),i}(Qz);function tX(e){return(tX="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function nX(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function rX(e,t,n){return(rX="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=aX(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function oX(e,t){return(oX=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function iX(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=aX(e);if(t){var o=aX(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return sX(this,n)}}function sX(e,t){return!t||"object"!==tX(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function aX(e){return(aX=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}QY(eX,"ErrorCode",{PARSE_ERROR:-1}),QY(eX,"PARSE_ERROR_PREDICATE",(function(e){return e.code===eX.ErrorCode.PARSE_ERROR}));var lX=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&oX(e,t)}(i,e);var t,n,r,o=iX(i);function i(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),o.call(this)}return t=i,(n=[{key:"_initProperties",value:function(e){rX(aX(i.prototype),"_initProperties",this).call(this,e)}},{key:"_onWidgetAcceptInput",value:function(e){var t=null,n=this.widget.errorStatus;n&&n.hasChildren()&&(t=rt.find(n.asFlatList(),(function(e){return e instanceof Xr})));var r={displayText:this.widget.displayText,errorStatus:t};t||(r.value=Et.toJsonDate(this.widget.value)),this._send("acceptInput",r,{showBusyIndicator:!e.whileTyping,coalesce:function(e){return this.target===e.target&&this.type===e.type}})}},{key:"_orderPropertyNamesOnSync",value:function(e){return Object.keys(e).sort(this._createPropertySortFunc(i.PROPERTIES_ORDER))}}])&&nX(t.prototype,n),r&&nX(t,r),i}(aG);function uX(e){return(uX="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function cX(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function fX(e,t){return(fX=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function hX(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=yX(e);if(t){var o=yX(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return pX(this,n)}}function pX(e,t){return!t||"object"!==uX(t)&&"function"!=typeof t?dX(e):t}function dX(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function yX(e){return(yX=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}!function(e,t,n){t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}(lX,"PROPERTIES_ORDER",["hasTime","hasDate"]);var vX=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&fX(e,t)}(i,e);var t,n,r,o=hX(i);function i(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(t=o.call(this))._dateField=e,t.MIN_DATE_FIELD_WIDTH=90,t.PREF_DATE_FIELD_WIDTH=110,t.MIN_TIME_FIELD_WIDTH=60,t.PREF_TIME_FIELD_WIDTH=90,t._initDefaults(),t.htmlPropertyChangeHandler=t._onHtmlEnvironmentPropertyChange.bind(dX(t)),Xs.get().on("propertyChange",t.htmlPropertyChangeHandler),t._dateField.one("remove",(function(){Xs.get().off("propertyChange",t.htmlPropertyChangeHandler)})),t}return t=i,(n=[{key:"_initDefaults",value:function(){this.hgap=Xs.get().smallColumnGap}},{key:"_onHtmlEnvironmentPropertyChange",value:function(){this._initDefaults(),this._dateField.invalidateLayoutTree()}},{key:"layout",value:function(e){var t,n,r=ea.get(e),o=this._dateField.$dateField,i=this._dateField.$timeField,s=this._dateField.$dateFieldIcon,a=this._dateField.$timeFieldIcon,l=this._dateField.$dateClearIcon,u=this._dateField.$timeClearIcon,c=this._dateField._$predictDateField,f=this._dateField._$predictTimeField,h=o?ea.get(o):null,p=i?ea.get(i):null,d=!!o&&!o.isDisplayNone(),y=!!i&&!i.isDisplayNone(),v=r.availableSize({exact:!0}).subtract(r.insets());if(d&&y){var b=h.margins(),m=p.margins(),g=new Bs(Math.max(b.top,m.top),Math.max(b.right,m.right),Math.max(b.bottom,m.bottom),Math.max(b.left,m.left)),_=v.subtract(g),w=this._hgap(),k=_.width-w,S=.6*k,O=k-S;t=new $s(S,_.height),n=new $s(O,_.height),h.setSize(t),p.setSize(n),i.cssRight(0),s.cssTop(o.cssBorderTopWidth()).cssRight(O+w).cssHeight(t.height-o.cssBorderWidthY()).cssLineHeight(t.height-o.cssBorderWidthY()),l&&l.cssTop(o.cssBorderTopWidth()).cssRight(O+w).cssHeight(t.height-o.cssBorderWidthY()).cssLineHeight(t.height-o.cssBorderWidthY()),a.cssTop(i.cssBorderTopWidth()).cssRight(0).cssHeight(n.height-i.cssBorderWidthY()).cssLineHeight(n.height-i.cssBorderWidthY()),u&&u.cssTop(i.cssBorderTopWidth()).cssRight(0).cssHeight(n.height-i.cssBorderWidthY()).cssLineHeight(n.height-i.cssBorderWidthY()),o.toggleClass("compact",t.width<this.MIN_DATE_FIELD_WIDTH),i.toggleClass("compact",n.width<this.MIN_TIME_FIELD_WIDTH),this._dateField.$container.toggleClass("compact-date",t.width<this.MIN_DATE_FIELD_WIDTH),this._dateField.$container.toggleClass("compact-time",n.width<this.MIN_TIME_FIELD_WIDTH),c&&qs.setSize(c,t),f&&(qs.setSize(f,n),f.cssRight(0))}else d?(t=v.subtract(h.margins()),h.setSize(t),s.cssTop(o.cssBorderTopWidth()).cssRight(0).cssHeight(t.height-o.cssBorderWidthY()).cssLineHeight(t.height-o.cssBorderWidthY()),l&&l.cssTop(o.cssBorderTopWidth()).cssRight(0).cssHeight(t.height-o.cssBorderWidthY()).cssLineHeight(t.height-o.cssBorderWidthY()),o.toggleClass("compact",t.width<this.MIN_DATE_FIELD_WIDTH),this._dateField.$container.toggleClass("compact-date",t.width<this.MIN_DATE_FIELD_WIDTH),c&&qs.setSize(c,t)):y&&(n=v.subtract(p.margins()),p.setSize(n),a.cssTop(i.cssBorderTopWidth()).cssRight(0).cssHeight(n.height-i.cssBorderWidthY()).cssLineHeight(n.height-i.cssBorderWidthY()),u&&u.cssTop(i.cssBorderTopWidth()).cssRight(0).cssHeight(n.height-i.cssBorderWidthY()).cssLineHeight(n.height-i.cssBorderWidthY()),i.toggleClass("compact",n.width<this.MIN_TIME_FIELD_WIDTH),this._dateField.$container.toggleClass("compact-time",n.width<this.MIN_TIME_FIELD_WIDTH),f&&qs.setSize(f,n));var T=this._dateField.popup;T&&T.rendered&&T.position()}},{key:"_hgap",value:function(){return this._dateField.cellEditor?0:this.hgap}},{key:"preferredLayoutSize",value:function(e){var t=new $s,n=this._dateField.$dateField,r=this._dateField.$timeField,o=!!n&&!n.isDisplayNone(),i=!!r&&!r.isDisplayNone();return o&&i?(t=qs.prefSize(this._dateField.$dateField)).width=this.PREF_DATE_FIELD_WIDTH+this._hgap()+this.PREF_TIME_FIELD_WIDTH:o?(t=qs.prefSize(this._dateField.$dateField)).width=this.PREF_DATE_FIELD_WIDTH:i&&((t=qs.prefSize(this._dateField.$timeField)).width=this.PREF_TIME_FIELD_WIDTH),t}}])&&cX(t.prototype,n),r&&cX(t,r),i}(Zs);function bX(e){return(bX="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function mX(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function gX(e,t,n){return(gX="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=SX(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function _X(e,t){return(_X=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function wX(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=SX(e);if(t){var o=SX(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return kX(this,n)}}function kX(e,t){return!t||"object"!==bX(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function SX(e){return(SX=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var OX=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_X(e,t)}(i,e);var t,n,r,o=wX(i);function i(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(e=o.call(this)).button=null,e.fileInput=null,e.acceptTypes=null,e.maximumUploadSize=fT.DEFAULT_MAXIMUM_UPLOAD_SIZE,e}return t=i,(n=[{key:"_init",value:function(e){var t=this;gX(SX(i.prototype),"_init",this).call(this,e),this.button=O.create("Button",{parent:this,label:this._buttonLabel(),iconId:this.iconId,labelHtmlEnabled:this.labelHtmlEnabled}),this.button.on("click",this._onButtonClick.bind(this)),this.fileInput.on("change",this._onFileChange.bind(this)),this.on("propertyChange",(function(e){"enabledComputed"===e.propertyName&&(t.button.setEnabled(e.newValue),t.fileInput.setEnabled(e.newValue))}))}},{key:"_initValue",value:function(e){this.fileInput=O.create("FileInput",{parent:this,acceptTypes:this.acceptTypes,text:this.displayText,enabled:this.enabledComputed,maximumUploadSize:this.maximumUploadSize,visible:!Kt.get().supportsFile()}),gX(SX(i.prototype),"_initValue",this).call(this,e)}},{key:"_buttonLabel",value:function(){return this.label}},{key:"_render",value:function(){this.addContainer(this.$parent,"file-chooser-button has-icon"),this.addLabel();var e=this.$parent.makeDiv(),t=ea.install(e,this.session);this.button.render(e),t.setLayout(new Ml(this.button.htmlComp)),this.fileInput.render(e),this.addField(e),e.setTabbable(!1),this.addStatus()}},{key:"setDisplayText",value:function(e){gX(SX(i.prototype),"setDisplayText",this).call(this,e),this.fileInput.setText(e),e||this.fileInput.clear()}},{key:"_readDisplayText",value:function(){return this.fileInput.text}},{key:"_renderLabel",value:function(){this._renderEmptyLabel()}},{key:"_onButtonClick",value:function(e){this.fileInput.browse()}},{key:"setLabel",value:function(e){gX(SX(i.prototype),"setLabel",this).call(this,e),this.button.setLabel(this._buttonLabel())}},{key:"setIconId",value:function(e){this.setProperty("iconId",e),this.button.setIconId(e)}},{key:"setAcceptTypes",value:function(e){this.setProperty("acceptTypes",e),this.fileInput.setAcceptTypes(e)}},{key:"setFileExtensions",value:function(e){this.setProperty("fileExtensions",e);var t=rt.ensure(e);t=t.map((function(e){return"."===e.indexOf(0)?e:"."+e})),this.setAcceptTypes(Wn.join(",",t)),this.fileInput.acceptTypes=this.acceptTypes}},{key:"setMaximumUploadSize",value:function(e){this.setProperty("maximumUploadSize",e),this.fileInput.setMaximumUploadSize(e)}},{key:"_onFileChange",value:function(e){this.setValue(rt.first(e.files))}},{key:"_validateValue",value:function(e){return this.fileInput.validateMaximumUploadSize(e),e}},{key:"_formatValue",value:function(e){return e?e.name:""}},{key:"getFocusableElement",value:function(){return this.button.getFocusableElement()}}])&&mX(t.prototype,n),r&&mX(t,r),i}(Qz);function TX(e){return(TX="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function CX(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function PX(e,t,n){return(PX="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=DX(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function RX(e,t){return(RX=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function xX(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=DX(e);if(t){var o=DX(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return EX(this,n)}}function EX(e,t){return!t||"object"!==TX(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function DX(e){return(DX=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var AX=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&RX(e,t)}(i,e);var t,n,r,o=xX(i);function i(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),o.call(this)}return t=i,(n=[{key:"_onWidgetPropertyChange",value:function(e){PX(DX(i.prototype),"_onWidgetPropertyChange",this).call(this,e),"value"===e.propertyName&&this._onValueChange(e)}},{key:"_onValueChange",value:function(e){this.widget.fileInput.upload()||this.widget.fileInput.clear()}},{key:"_syncDisplayText",value:function(e){this.widget.setDisplayText(e)}}])&&CX(t.prototype,n),r&&CX(t,r),i}(aG);function FX(e){return(FX="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function $X(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function jX(e,t,n){return(jX="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=LX(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function BX(e,t){return(BX=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function MX(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=LX(e);if(t){var o=LX(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return IX(this,n)}}function IX(e,t){return!t||"object"!==FX(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function LX(e){return(LX=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var HX=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&BX(e,t)}(i,e);var t,n,r,o=MX(i);function i(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(e=o.call(this)).fileInput=null,e.acceptTypes=null,e.maximumUploadSize=fT.DEFAULT_MAXIMUM_UPLOAD_SIZE,e}return t=i,(n=[{key:"_init",value:function(e){var t=this;jX(LX(i.prototype),"_init",this).call(this,e),this.fileInput.on("change",this._onFileChange.bind(this)),this.on("propertyChange",(function(e){"enabledComputed"===e.propertyName&&t.fileInput.setEnabled(e.newValue)}))}},{key:"_initValue",value:function(e){this.fileInput=O.create("FileInput",{parent:this,acceptTypes:this.acceptTypes,text:this.displayText,enabled:this.enabledComputed,maximumUploadSize:this.maximumUploadSize}),jX(LX(i.prototype),"_initValue",this).call(this,e)}},{key:"_initKeyStrokeContext",value:function(){jX(LX(i.prototype),"_initKeyStrokeContext",this).call(this),this.fileInput.legacy||(this.keyStrokeContext.registerKeyStroke(new nJ(this)),this.keyStrokeContext.registerKeyStroke(new cJ(this)))}},{key:"_render",value:function(){this.addContainer(this.$parent,"file-chooser-field has-icon"),this.addLabel(),this.addMandatoryIndicator(),this._renderFileInput(),this.addIcon(),this.addStatus()}},{key:"_renderFileInput",value:function(){this.fileInput.render(),this.addField(this.fileInput.$container)}},{key:"setDisplayText",value:function(e){jX(LX(i.prototype),"setDisplayText",this).call(this,e),this.fileInput.setText(e),e||this.fileInput.clear()}},{key:"_readDisplayText",value:function(){return this.fileInput.text}},{key:"setAcceptTypes",value:function(e){this.setProperty("acceptTypes",e),this.fileInput.setAcceptTypes(e)}},{key:"_renderEnabled",value:function(){jX(LX(i.prototype),"_renderEnabled",this).call(this),this.$field.setTabbable(this.enabledComputed)}},{key:"_renderPlaceholder",value:function(){var e=this.fileInput.$text;e&&e.placeholder(this.label)}},{key:"_removePlaceholder",value:function(){var e=this.fileInput.$text;e&&e.placeholder("")}},{key:"setMaximumUploadSize",value:function(e){this.setProperty("maximumUploadSize",e),this.fileInput.setMaximumUploadSize(e)}},{key:"_clear",value:function(){this.fileInput.clear()}},{key:"_onIconMouseDown",value:function(e){jX(LX(i.prototype),"_onIconMouseDown",this).call(this,e),this.activate()}},{key:"_onFileChange",value:function(e){var t=rt.first(e.files);Pr.isNullOrUndefined(t)&&this.acceptInput(!1),this.setValue(t)}},{key:"activate",value:function(){this.enabledComputed&&this.rendered&&(this.$field.focus(),this.fileInput.browse())}},{key:"_validateValue",value:function(e){return this.fileInput.validateMaximumUploadSize(e),e}},{key:"_formatValue",value:function(e){return e?e.name:""}},{key:"_parseValue",value:function(e){if(!e)return null;var t=this.fileInput.files;return t&&t.length?t[0]:null}}])&&$X(t.prototype,n),r&&$X(t,r),i}(Qz);function NX(e){return(NX="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function VX(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function WX(e,t,n){return(WX="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=KX(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function zX(e,t){return(zX=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function GX(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=KX(e);if(t){var o=KX(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return UX(this,n)}}function UX(e,t){return!t||"object"!==NX(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function KX(e){return(KX=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var qX=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&zX(e,t)}(i,e);var t,n,r,o=GX(i);function i(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),o.call(this)}return t=i,(n=[{key:"_onWidgetPropertyChange",value:function(e){WX(KX(i.prototype),"_onWidgetPropertyChange",this).call(this,e),"value"===e.propertyName&&this._onValueChange(e)}},{key:"_onValueChange",value:function(e){this.widget.fileInput.upload()||this.widget.fileInput.clear()}},{key:"_syncDisplayText",value:function(e){this.widget.setDisplayText(e)}},{key:"_orderPropertyNamesOnSync",value:function(e){return Object.keys(e).sort(this._createPropertySortFunc(i.PROPERTIES_ORDER))}}])&&VX(t.prototype,n),r&&VX(t,r),i}(aG);function YX(e){return(YX="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function XX(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function JX(e,t){return(JX=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function ZX(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=tJ(e);if(t){var o=tJ(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return QX(this,n)}}function QX(e,t){return!t||"object"!==YX(t)&&"function"!=typeof t?eJ(e):t}function eJ(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function tJ(e){return(tJ=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}!function(e,t,n){t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}(qX,"PROPERTIES_ORDER",["value","displayText"]);var nJ=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&JX(e,t)}(i,e);var t,n,r,o=ZX(i);function i(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(t=o.call(this)).field=e,t.which=[Ou.SPACE],t.stopPropagation=!0,t.renderingHints.hAlign=Do.LEFT,t.renderingHints.$drawingArea=function(e,t){return this.field.$fieldContainer}.bind(eJ(t)),t}return t=i,(n=[{key:"handle",value:function(e){this.field.fileInput.browse()}}])&&XX(t.prototype,n),r&&XX(t,r),i}(zu);function rJ(e){return(rJ="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function oJ(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function iJ(e,t){return(iJ=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function sJ(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=uJ(e);if(t){var o=uJ(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return aJ(this,n)}}function aJ(e,t){return!t||"object"!==rJ(t)&&"function"!=typeof t?lJ(e):t}function lJ(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function uJ(e){return(uJ=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var cJ=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&iJ(e,t)}(i,e);var t,n,r,o=sJ(i);function i(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(t=o.call(this)).field=e,t.which=[Ou.DELETE],t.stopPropagation=!0,t.renderingHints.offset=25,t.renderingHints.hAlign=Do.RIGHT,t.renderingHints.$drawingArea=function(e,t){return this.field.$fieldContainer}.bind(lJ(t)),t}return t=i,(n=[{key:"handle",value:function(e){this.field.clear()}}])&&oJ(t.prototype,n),r&&oJ(t,r),i}(zu);function fJ(e){return(fJ="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function hJ(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function pJ(e,t,n){return(pJ="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=bJ(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function dJ(e,t){return(dJ=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function yJ(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=bJ(e);if(t){var o=bJ(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return vJ(this,n)}}function vJ(e,t){return!t||"object"!==fJ(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function bJ(e){return(bJ=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function mJ(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var gJ=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&dJ(e,t)}(i,e);var t,n,r,o=yJ(i);function i(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(e=o.call(this))._addWidgetProperties(["fields","notification","staticMenus"]),e._addCloneProperties(["menuBarVisible","bodyLayoutConfig","borderDecoration","borderVisible","expandable","expanded","gridColumnCount","scrollable","subLabel"]),e.fields=[],e.menus=[],e.menuBarVisible=!0,e.menuBarPosition=i.MenuBarPosition.AUTO,e.menuBarEllipsisPosition=Yw.EllipsisPosition.RIGHT,e.notification=null,e.bodyLayoutConfig=null,e.borderDecoration=i.BorderDecoration.AUTO,e.borderVisible=!0,e.mainBox=!1,e.scrollable=null,e.expandable=!1,e.expanded=!0,e.logicalGrid=O.create("scout.VerticalSmartGrid"),e.gridColumnCount=2,e.gridDataHints.useUiHeight=!0,e.gridDataHints.w=ZW.FULL_WIDTH,e.controls=[],e.systemButtons=[],e.customButtons=[],e.processButtons=[],e.processMenus=[],e.staticMenus=[],e.responsive=null,e.$body=null,e.$title=null,e.$subLabel=null,e}return t=i,(n=[{key:"_init",value:function(e){pJ(bJ(i.prototype),"_init",this).call(this,e),this.resolveConsts([{property:"menuBarPosition",constType:i.MenuBarPosition}]),this._setBodyLayoutConfig(this.bodyLayoutConfig),this.menuBar=O.create("MenuBar",{parent:this,menuOrder:new zJ,ellipsisPosition:this.menuBarEllipsisPosition}),this._setFields(this.fields),this._setMainBox(this.mainBox),this._updateMenuBar(),MR.get().registerHandler(this,O.create("GroupBoxResponsiveHandler",{widget:this})),this._setResponsive(this.responsive)}},{key:"_destroy",value:function(){MR.get().unregisterHandler(this),pJ(bJ(i.prototype),"_destroy",this).call(this)}},{key:"getFields",value:function(){return this.fields}},{key:"insertField",value:function(e,t){var n=this.fields.slice();t=O.nvl(t,this.fields.length),n.splice(t,0,e),this.setFields(n)}},{key:"insertFieldBefore",value:function(e,t){O.assertParameter("sibling",t);var n=this.fields.indexOf(t);this.insertField(e,n)}},{key:"insertFieldAfter",value:function(e,t){O.assertParameter("sibling",t);var n=this.fields.indexOf(t)+1;this.insertField(e,n)}},{key:"deleteField",value:function(e){var t=this.fields.slice(),n=this.fields.indexOf(e);n<0||(t.splice(n,1),this.setFields(t))}},{key:"setFields",value:function(e){this.setProperty("fields",e)}},{key:"_setFields",value:function(e){this._setProperty("fields",e),this._prepareFields()}},{key:"_renderFields",value:function(e){this._renderExpanded(),this.invalidateLogicalGrid(!0)}},{key:"_initKeyStrokeContext",value:function(){pJ(bJ(i.prototype),"_initKeyStrokeContext",this).call(this),this.keyStrokeContext.invokeAcceptInputOnActiveValueField=!0,this.keyStrokeContext.$bindTarget=this._keyStrokeBindTarget.bind(this)}},{key:"_setKeyStrokes",value:function(e){e=rt.ensure(e);var t={render:function(){return!0},offset:0,hAlign:Do.RIGHT,$drawingArea:function(e,t){return this.labelVisible?this.$title:this.$body}.bind(this)};e.forEach((function(e){e.actionKeyStroke.renderingHints=s.a.extend({},e.actionKeyStroke.renderingHints,t)}),this),pJ(bJ(i.prototype),"_setKeyStrokes",this).call(this,e)}},{key:"_keyStrokeBindTarget",value:function(){var e=this.getForm();return e?e.$container:this.$container}},{key:"_render",value:function(){this.addContainer(this.$parent,this.mainBox?"root-group-box":"group-box"),this.$title=this.$container.appendDiv("group-box-title"),this.addLabel(),this.addSubLabel(),this.addStatus(),this.$body=this.$container.appendDiv("group-box-body"),this.htmlBody=ea.install(this.$body,this.session),this.htmlBody.setLayout(this._createBodyLayout())}},{key:"_remove",value:function(){this._removeSubLabel(),pJ(bJ(i.prototype),"_remove",this).call(this)}},{key:"_renderProperties",value:function(){this._renderScrollable(),this._renderExpanded(),pJ(bJ(i.prototype),"_renderProperties",this).call(this),this._renderBodyLayoutConfig(),this._renderNotification(),this._renderBorderVisible(),this._renderExpandable(),this._renderMenuBarPosition(),this._renderMenuBarEllipsisPosition(),this._renderMenuBarVisible(),this._renderSubLabel()}},{key:"_createLayout",value:function(){return new VJ(this)}},{key:"_createBodyLayout",value:function(){return new ba(this,this.bodyLayoutConfig)}},{key:"setBodyLayoutConfig",value:function(e){this.setProperty("bodyLayoutConfig",e)}},{key:"_setBodyLayoutConfig",value:function(e){e||(e=new ga),this._setProperty("bodyLayoutConfig",ga.ensure(e))}},{key:"_renderBodyLayoutConfig",value:function(){var e=this.htmlBody.layout.minWidth;this.bodyLayoutConfig.applyToLayout(this.htmlBody.layout),e!==this.bodyLayoutConfig.minWidth&&this._renderScrollable(),this.rendered&&this.htmlBody.invalidateLayoutTree()}},{key:"rerenderControls",value:function(){this._removeControls(),this._renderControls(),this.htmlBody.invalidateLayoutTree()}},{key:"_removeControls",value:function(){this.controls.forEach((function(e){e.remove()}),this)}},{key:"_renderControls",value:function(){this.controls.forEach((function(e){e.rendered||(e.render(this.$body),e.setLayoutData(new ua(e)))}),this)}},{key:"addSubLabel",value:function(){this.$subLabel||(this.$subLabel=this.$title.appendDiv("sub-label"),xp.installForEllipsis(this.$subLabel,{parent:this}))}},{key:"_removeSubLabel",value:function(){this.$subLabel&&(xp.uninstall(this.$subLabel),this.$subLabel.remove(),this.$subLabel=null)}},{key:"setSubLabel",value:function(e){this.setProperty("subLabel",e)}},{key:"_renderSubLabel",value:function(){this.$subLabel.setVisible(Wn.hasText(this.subLabel)),this.$subLabel.textOrNbsp(this.subLabel),this.$container.toggleClass("has-sub-label",this.$subLabel.isVisible()),this.invalidateLayoutTree()}},{key:"setScrollable",value:function(e){this.setProperty("scrollable",e)}},{key:"_renderScrollable",value:function(){this._uninstallScrollbars(),this.scrollable?this._installScrollbars({axis:this.bodyLayoutConfig.minWidth>0?"both":"y"}):this.bodyLayoutConfig.minWidth>0&&this._installScrollbars({axis:"x"})}},{key:"get$Scrollable",value:function(){return this.$body}},{key:"setMainBox",value:function(e){this.setProperty("mainBox",e)}},{key:"_setMainBox",value:function(e){this._setProperty("mainBox",e),this.mainBox&&(this.menuBar.setCssClass("main-menubar"),null===this.scrollable&&this.setScrollable(!0),null===this.responsive&&this.setResponsive(!0))}},{key:"addLabel",value:function(){this.$label||(this.$label=this.$title.appendDiv("label"),xp.installForEllipsis(this.$label,{parent:this}))}},{key:"_renderLabel",value:function(){this.$label.textOrNbsp(this.label),this.rendered&&this._renderLabelVisible()}},{key:"addStatus",value:function(){pJ(bJ(i.prototype),"addStatus",this).call(this),this._updateStatusPosition()}},{key:"_renderStatusPosition",value:function(){this._updateStatusPosition()}},{key:"_updateStatusPosition",value:function(){this.fieldStatus&&(this.statusPosition===ZW.StatusPosition.TOP?this.$status.appendTo(this.$title):this.$status.appendTo(this.$container),this.invalidateLayoutTree())}},{key:"setNotification",value:function(e){this.setProperty("notification",e)}},{key:"_renderNotification",value:function(){this.notification?(this.notification.render(),this.notification.$container.insertBefore(this.$body),this.invalidateLayoutTree()):this.invalidateLayoutTree()}},{key:"_prepareFields",value:function(){var e,t;for(this.processButtons.forEach(this._unregisterButtonKeyStrokes.bind(this)),this.controls=[],this.systemButtons=[],this.customButtons=[],this.processButtons=[],this.processMenus=[],e=0;e<this.fields.length;e++)if((t=this.fields[e])instanceof JK)t.processButton?(this.processButtons.push(t),t.systemType!==JK.SystemType.NONE?this.systemButtons.push(t):this.customButtons.push(t)):(this.controls.push(t),this._registerButtonKeyStrokes(t));else if(t instanceof s9){this.controls.push(t);for(var n=0;n<t.tabItems.length;n++)t.tabItems[n].selectionKeystroke&&this.keyStrokeContext.registerKeyStroke(new Vc(t.tabItems[n].selectionKeystroke,t.tabItems[n]))}else this.controls.push(t);this.processMenus=this.processButtons.map((function(e){return O.create("ButtonAdapterMenu",lw.adaptButtonProperties(e,{parent:this,menubar:this.menuBar,button:e,defaultMenu:!!e.defaultButton||null}))}),this),this.registerKeyStrokes(this.processMenus)}},{key:"_unregisterButtonKeyStrokes",value:function(e){e.keyStrokes&&e.keyStrokes.forEach((function(e){this.keyStrokeContext.unregisterKeyStroke(e)}),this)}},{key:"_registerButtonKeyStrokes",value:function(e){e.keyStrokes&&e.keyStrokes.forEach((function(e){this.keyStrokeContext.registerKeyStroke(e)}),this)}},{key:"setBorderVisible",value:function(e){this.setProperty("borderVisible",e)}},{key:"_renderBorderVisible",value:function(){var e=this.borderVisible;this.borderDecoration===i.BorderDecoration.AUTO&&(e=this._computeBorderVisible(e)),this.$body.toggleClass("y-padding-invisible",!e),this.invalidateLayoutTree()}},{key:"setBorderDecoration",value:function(e){this.setProperty("borderDecoration",e)}},{key:"_renderBorderDecoration",value:function(){this._renderBorderVisible()}},{key:"_getCurrentMenus",value:function(){return this.menuBarVisible?[]:pJ(bJ(i.prototype),"_getCurrentMenus",this).call(this)}},{key:"setMenuBarVisible",value:function(e){this.setProperty("menuBarVisible",e)}},{key:"_setMenuBarVisible",value:function(e){this._setProperty("menuBarVisible",e),this._updateMenuBar()}},{key:"_renderMenuBarVisible",value:function(){this.menuBarVisible?this._renderMenuBar():this.menuBar.remove(),this._updateMenus(),this.invalidateLayoutTree()}},{key:"_renderMenuBar",value:function(){this.menuBar.render(),this.menuBarPosition===i.MenuBarPosition.TITLE?this.menuBar.$container.insertAfter(this.$subLabel):this.menuBar.position===Yw.Position.TOP&&this.menuBar.$container.insertAfter(this.$title)}},{key:"setMenuBarPosition",value:function(e){this.setProperty("menuBarPosition",e)}},{key:"_renderMenuBarPosition",value:function(){var e=this.menuBarPosition;e===i.MenuBarPosition.AUTO&&(e=i.MenuBarPosition.TOP);var t=e===i.MenuBarPosition.TITLE;this.$title.toggleClass("has-menubar",t),e===i.MenuBarPosition.BOTTOM?this.menuBar.setPosition(Yw.Position.BOTTOM):this.menuBar.setPosition(Yw.Position.TOP),this.rendered&&(this.menuBar.remove(),this._renderMenuBarVisible())}},{key:"setMenuBarEllipsisPosition",value:function(e){this.setProperty("menuBarEllipsisPosition",e),this.menuBar.setEllipsisPosition(e)}},{key:"_renderMenuBarEllipsisPosition",value:function(){this.menuBar.reorderMenus(),this.rendered&&(this.menuBar.remove(),this._renderMenuBarVisible())}},{key:"_computeBorderVisible",value:function(e){return(this.mainBox||this.parent instanceof i&&this.parent.parent instanceof CC&&this.parent.parent.parent instanceof hne&&this.parent.parent.parent.parent instanceof P4&&1===this.parent.getFields().length)&&(e=!1),e}},{key:"setExpandable",value:function(e){this.setProperty("expandable",e)}},{key:"_renderExpandable",value:function(){var e=this.expandable,t=this.$title.children(".group-box-control");e?(0===t.length&&this.$container.makeDiv("group-box-control").on("click",this._onControlClick.bind(this)).insertAfter(this.$label),this.$title.addClass("expandable").on("click.group-box-control",this._onControlClick.bind(this))):(t.remove(),this.$title.removeClass("expandable").off(".group-box-control"))}},{key:"setExpanded",value:function(e){this.setProperty("expanded",e)}},{key:"_renderExpanded",value:function(){this.$container.toggleClass("collapsed",!this.expanded),this.expanded?(void 0!==this._collapsedWeightY&&(this.gridData.weightY=this._collapsedWeightY,delete this._collapsedWeightY),this.invalidateLayout(),this._renderControls()):0!==this.gridData.weightY&&(this._collapsedWeightY=this.gridData.weightY,this.gridData.weightY=0),this.invalidateLayoutTree()}},{key:"setGridColumnCount",value:function(e){this.setProperty("gridColumnCount",e),this.invalidateLogicalGrid()}},{key:"invalidateLogicalGrid",value:function(e){pJ(bJ(i.prototype),"invalidateLogicalGrid",this).call(this,!1),O.nvl(e,!0)&&this.rendered&&this.htmlBody.invalidateLayoutTree()}},{key:"_setLogicalGrid",value:function(e){pJ(bJ(i.prototype),"_setLogicalGrid",this).call(this,e),this.logicalGrid&&this.logicalGrid.setGridConfig(new CJ)}},{key:"_renderLabelVisible",value:function(e){this.$title.setVisible(this._computeTitleVisible(e)),this._updateFieldStatus(),this.menuBarPosition===i.MenuBarPosition.TITLE&&this.invalidateLayoutTree()}},{key:"_computeTitleVisible",value:function(e){return!(!(e=O.nvl(e,this.labelVisible))||!this.label||this.mainBox)}},{key:"_computeStatusVisible",value:function(){return pJ(bJ(i.prototype),"_computeStatusVisible",this).call(this)&&this._computeTitleVisible()}},{key:"_setMenus",value:function(e){pJ(bJ(i.prototype),"_setMenus",this).call(this,e),this.menuBar&&this._updateMenuBar()}},{key:"_updateMenuBar",value:function(){if(this.menuBarVisible){var e=this.staticMenus.concat(this.processMenus).concat(this.menus);this.menuBar.setMenuItems(e)}else this.menuBar.setMenuItems([])}},{key:"_removeMenus",value:function(){}},{key:"setStaticMenus",value:function(e){this.setProperty("staticMenus",e),this._updateMenuBar()}},{key:"_onControlClick",value:function(e){this.expandable&&(this.setExpanded(!this.expanded),this.validateLayoutTree()),s.a.suppressEvent(e)}},{key:"setResponsive",value:function(e){this.setProperty("responsive",e)}},{key:"_setResponsive",value:function(e){if(this._setProperty("responsive",e),this.initialized){if(this.responsive)MR.get().reset(this,!0);else if(MR.get().reset(this,!0),null===this.responsive){var t=this.findParent((function(e){return e instanceof i&&e.responsive}));MR.get().reset(t,!0)}this.invalidateLayoutTree()}}},{key:"clone",value:function(e,t){var n=pJ(bJ(i.prototype),"clone",this).call(this,e);return this._deepCloneProperties(n,["fields"],t),n._prepareFields(),n}}])&&hJ(t.prototype,n),r&&hJ(t,r),i}(Iz);function _J(e){return(_J="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function wJ(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function kJ(e,t){return(kJ=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function SJ(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=TJ(e);if(t){var o=TJ(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return OJ(this,n)}}function OJ(e,t){return!t||"object"!==_J(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function TJ(e){return(TJ=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}mJ(gJ,"BorderDecoration",{AUTO:"auto",EMPTY:"empty",LINE:"line"}),mJ(gJ,"MenuBarPosition",{AUTO:"auto",TOP:"top",BOTTOM:"bottom",TITLE:"title"});var CJ=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&kJ(e,t)}(i,e);var t,n,r,o=SJ(i);function i(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),o.call(this)}return t=i,(n=[{key:"getGridWidgets",value:function(){return this.widget.controls}},{key:"getGridColumnCount",value:function(){var e=-1,t=this.widget;do{e=O.nvl(t.gridColumnCount,e)}while(e<0&&t.getParentGroupBox&&(t=t.getParentGroupBox()));return e<0?2:e}}])&&wJ(t.prototype,n),r&&wJ(t,r),i}(aa);function PJ(e){return(PJ="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function RJ(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function xJ(e,t,n){return(xJ="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=FJ(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function EJ(e,t){return(EJ=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function DJ(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=FJ(e);if(t){var o=FJ(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return AJ(this,n)}}function AJ(e,t){return!t||"object"!==PJ(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function FJ(e){return(FJ=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var $J=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&EJ(e,t)}(i,e);var t,n,r,o=DJ(i);function i(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(e=o.call(this))._addRemoteProperties(["expanded"]),e}return t=i,(n=[{key:"_initModel",value:function(e,t){return(e=xJ(FJ(i.prototype),"_initModel",this).call(this,e,t)).logicalGrid=null,e}},{key:"_postCreateWidget",value:function(){xJ(FJ(i.prototype),"_postCreateWidget",this).call(this),this.widget.responsiveHandler&&(this.widget.responsiveHandler.setAllowedStates([MR.ResponsiveState.NORMAL,MR.ResponsiveState.CONDENSED]),this.widget.responsiveHandler.getGridData=this._getGridData,this.widget.responsiveHandler.setGridData=this._setGridData)}},{key:"destroy",value:function(){xJ(FJ(i.prototype),"destroy",this).call(this)}},{key:"_getGridData",value:function(e){return new Ez(e.gridData)}},{key:"_setGridData",value:function(e,t){e._setGridData(t)}}])&&RJ(t.prototype,n),r&&RJ(t,r),i}(zz);function jJ(e){return(jJ="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function BJ(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function MJ(e,t){return(MJ=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function IJ(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=NJ(e);if(t){var o=NJ(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return LJ(this,n)}}function LJ(e,t){return!t||"object"!==jJ(t)&&"function"!=typeof t?HJ(e):t}function HJ(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function NJ(e){return(NJ=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var VJ=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&MJ(e,t)}(i,e);var t,n,r,o=IJ(i);function i(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(t=o.call(this)).groupBox=e,t._initDefaults(),t._htmlPropertyChangeHandler=t._onHtmlEnvironmentPropertyChange.bind(HJ(t)),Xs.get().on("propertyChange",t._htmlPropertyChangeHandler),t.groupBox.one("remove",(function(){Xs.get().off("propertyChange",t._htmlPropertyChangeHandler)})),t}return t=i,(n=[{key:"_initDefaults",value:function(){this._statusWidth=Xs.get().fieldStatusWidth}},{key:"_onHtmlEnvironmentPropertyChange",value:function(){this._initDefaults(),this.groupBox.invalidateLayoutTree()}},{key:"layout",value:function(e){var t,n,r=0,o=0,i=this.groupBox.statusPosition,a=this.groupBox.htmlComp,l=this._htmlGbBody(),u=this._htmlMenuBar(),c=this.groupBox._tooltip(),f=this.groupBox.$title,h=this.groupBox.$label,p=a.availableSize().subtract(a.insets());this.groupBox.responsive&&MR.get().handleResponsive(this.groupBox,p.width);var d=this._$status();if(d&&d.isVisible()&&(this._layoutStatus(),o=d.outerWidth(!0)),u){if(this.groupBox.menuBarPosition===gJ.MenuBarPosition.TITLE){n=u.prefSize({exact:!0});var y=qs.prefSize(this.groupBox.$title),v=Math.ceil(qs.prefSize(this.groupBox.$label,!0).width)+1,b=n.width,m=y.width-o;if(v+b<m)b=Math.floor(m-v),n.width=b,h.cssWidth("");else{var g=(v+b)/m,_=v/m/g,w=b/m/g;_<w?w=1-(_=Math.max(.33,_)):_=1-(w=Math.max(.33,w)),v=_*m,b=w*m,n.width=Math.floor(b),h.cssWidth(Math.floor(v))}}else r=(n=this._menuBarSize(u,p,o)).height,k(h);u.setSize(n)}else k(h);function k(e,t){if(t){var n=e.cssMarginX()+t;e.cssWidth("calc(100% - "+n+"px)")}else e.cssWidth("")}k(f),i===ZW.StatusPosition.TOP?this.groupBox.menuBarPosition!==gJ.MenuBarPosition.TITLE&&k(h,o):k(f,o),this.groupBox.notification&&k(this.groupBox.notification.$container,o),(t=p.subtract(l.margins())).height-=this._titleHeight(),t.height-=this._notificationHeight(),t.height-=r,s.a.log.isTraceEnabled()&&s.a.log.trace("(GroupBoxLayout#layout) gbBodySize="+t),l.setSize(t),c&&c.rendered&&c.position(),(l.scrollable||this.groupBox.bodyLayoutConfig.minWidth>0)&&Lh.update(l.$comp)}},{key:"_$status",value:function(){return this.groupBox.$status}},{key:"_layoutStatus",value:function(){var e=this.groupBox.htmlComp.insets({includeBorder:!1}),t=e.top,n=e.right,r=this.groupBox.$title,o=r.innerHeight(),i=this._$status(),s=qs.margins(i),a=this.groupBox.statusPosition;i.cssWidth(this._statusWidth),a===ZW.StatusPosition.DEFAULT&&i.cssTop(t+r.cssMarginTop()).cssRight(n).cssHeight(o-s.vertical()).cssLineHeight(o-s.vertical())}},{key:"preferredLayoutSize",value:function(e,t){t=t||{};var n,r,o=this.groupBox.htmlComp,i=this._htmlGbBody(),s=0,a=0,l=this.groupBox.gridData,u=!1;return this.groupBox.responsive&&t.widthHint&&(u=MR.get().handleResponsive(this.groupBox,t.widthHint)),l&&(s=l.widthInPixel,a=l.heightInPixel),s&&a?r=new $s(s,a).add(o.insets()):(!t.widthHint&&s&&(t.widthHint=s),t.heightHint=null,this.groupBox.expanded?(r=i.prefSize(t).add(i.margins()),(n=this._htmlMenuBar())&&this.groupBox.menuBarPosition!==gJ.MenuBarPosition.TITLE&&(r.height+=n.prefSize(t).height)):r=new $s(0,0),(r=r.add(o.insets())).height+=this._titleHeight(),r.height+=this._notificationHeight(t),s&&(r.width=s),a&&(r.height=a),u&&MR.get().reset(this.groupBox),r)}},{key:"_titleHeight",value:function(){return qs.prefSize(this.groupBox.$title,!0).height}},{key:"_notificationHeight",value:function(e){return e=e||{},this.groupBox.notification?(e.includeMargin=!0,this.groupBox.notification.htmlComp.prefSize(e).height):0}},{key:"_menuBarSize",value:function(e,t,n){var r=ok.size(e,t);return this.groupBox.mainBox||(r.width-=n),r}},{key:"_htmlMenuBar",value:function(){if(this.groupBox.menuBar&&this.groupBox.menuBarVisible){var e=ea.optGet(this.groupBox.menuBar.$container);if(e&&e.isVisible())return e}return null}},{key:"_htmlGbBody",value:function(){return ea.get(this.groupBox.$body)}}])&&BJ(t.prototype,n),r&&BJ(t,r),i}(Zs);function WJ(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var zJ=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,(n=[{key:"order",value:function(e){var t=[],n=[],r=[],o=[];return e.forEach((function(e){if(e.isButton()){var i=e.horizontalAlignment;void 0===i&&(i=e.gridData&&e.gridData.horizontalAlignment),1===i?r.push(e):t.push(e)}else 1===e.horizontalAlignment?o.push(e):n.push(e)})),{left:t.concat(n),right:o.concat(r),all:t.concat(n).concat(o).concat(r)}}}])&&WJ(t.prototype,n),r&&WJ(t,r),e}();function GJ(e){return(GJ="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function UJ(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function KJ(e,t,n){return(KJ="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=JJ(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function qJ(e,t){return(qJ=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function YJ(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=JJ(e);if(t){var o=JJ(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return XJ(this,n)}}function XJ(e,t){return!t||"object"!==GJ(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function JJ(e){return(JJ=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var ZJ=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&qJ(e,t)}(i,e);var t,n,r,o=YJ(i);function i(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(e=o.call(this)).scrollBarEnabled=!1,e.preventInitialFocus=!0,e}return t=i,(n=[{key:"_initKeyStrokeContext",value:function(){KJ(JJ(i.prototype),"_initKeyStrokeContext",this).call(this),this.keyStrokeContext.registerKeyStroke(new FW(this,this._onAppLinkAction))}},{key:"_render",value:function(){this.addContainer(this.$parent,"html-field"),this.addLabel(),this.addField(this.$parent.makeDiv()),this.addStatus()}},{key:"_renderProperties",value:function(){KJ(JJ(i.prototype),"_renderProperties",this).call(this),this._renderScrollBarEnabled(),this._renderScrollToAnchor()}},{key:"_readDisplayText",value:function(){return this.$field.html()}},{key:"_renderDisplayText",value:function(){this.displayText?(this.$field.html(this.displayText),this.$field.find(".app-link").on("click",this._onAppLinkAction.bind(this)),this.$field.find("a, .app-link").attr("tabindex","0").unfocusable(),this.$field.find("img").on("load",this._onImageLoad.bind(this)).on("error",this._onImageError.bind(this)),this.rendered&&(this._uninstallScrollbars(),this._renderScrollBarEnabled()),this.invalidateLayoutTree()):this.$field.empty()}},{key:"setScrollBarEnabled",value:function(e){this.setProperty("scrollBarEnabled",e)}},{key:"_renderScrollBarEnabled",value:function(){this.scrollBarEnabled?this._installScrollbars():this._uninstallScrollbars()}},{key:"_renderScrollToAnchor",value:function(){if(this.rendered){var e=this.scrollToAnchor;if(this.scrollBarEnabled&&e&&this.$field.find(e)){var t=this.$field.find("#".concat(e));t&&t.length>0&&Lh.scrollTo(this.$field,t)}}else this.session.layoutValidator.schedulePostValidateFunction(this._renderScrollToAnchor.bind(this))}},{key:"_onAppLinkAction",value:function(e){var t=s()(e.delegateTarget).data("ref");this.triggerAppLinkAction(t)}},{key:"triggerAppLinkAction",value:function(e){this.trigger("appLinkAction",{ref:e})}},{key:"_onImageLoad",value:function(e){this.invalidateLayoutTree()}},{key:"_onImageError",value:function(e){this.invalidateLayoutTree()}}])&&UJ(t.prototype,n),r&&UJ(t,r),i}(Qz);function QJ(e){return(QJ="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function eZ(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function tZ(e,t,n){return(tZ="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=iZ(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function nZ(e,t){return(nZ=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function rZ(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=iZ(e);if(t){var o=iZ(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return oZ(this,n)}}function oZ(e,t){return!t||"object"!==QJ(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function iZ(e){return(iZ=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var sZ=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&nZ(e,t)}(i,e);var t,n,r,o=rZ(i);function i(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),o.call(this)}return t=i,(n=[{key:"_initProperties",value:function(e){void 0!==e.scrollToEnd&&delete e.scrollToEnd}},{key:"_syncScrollToEnd",value:function(){this.widget.scrollToBottom()}},{key:"_onWidgetAppLinkAction",value:function(e){this._send("appLinkAction",{ref:e.ref})}},{key:"_onWidgetEvent",value:function(e){"appLinkAction"===e.type?this._onWidgetAppLinkAction(e):tZ(iZ(i.prototype),"_onWidgetEvent",this).call(this,e)}}])&&eZ(t.prototype,n),r&&eZ(t,r),i}(aG);function aZ(e){return(aZ="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function lZ(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function uZ(e,t,n){return(uZ="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=pZ(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function cZ(e,t){return(cZ=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function fZ(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pZ(e);if(t){var o=pZ(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return hZ(this,n)}}function hZ(e,t){return!t||"object"!==aZ(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function pZ(e){return(pZ=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var dZ=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&cZ(e,t)}(i,e);var t,n,r,o=fZ(i);function i(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(e=o.call(this)).autoFit=!1,e.imageUrl=null,e.scrollBarEnabled=!1,e.uploadEnabled=!1,e.acceptTypes=null,e.maximumUploadSize=fT.DEFAULT_MAXIMUM_UPLOAD_SIZE,e._clickHandler=null,e}return t=i,(n=[{key:"_init",value:function(e){uZ(pZ(i.prototype),"_init",this).call(this,e),this.resolveIconIds(["imageUrl"]),this.icon=O.create("Icon",{parent:this,iconDesc:this.imageUrl,autoFit:this.autoFit,prepend:!0}),this.icon.on("load",this._onImageLoad.bind(this)),this.icon.on("error",this._onImageError.bind(this))}},{key:"_render",value:function(){this.addContainer(this.$parent,"image-field",new EZ(this)),this.addFieldContainer(this.$parent.makeDiv()),ea.install(this.$fieldContainer,this.session).setLayout(new Ml),this.icon.render(this.$fieldContainer),this.addLabel(),this.addField(this.icon.$container),this.addStatus()}},{key:"_renderProperties",value:function(){uZ(pZ(i.prototype),"_renderProperties",this).call(this),this._renderScrollBarEnabled(),this._renderImageUrl(),this._renderUploadEnabled()}},{key:"_remove",value:function(){uZ(pZ(i.prototype),"_remove",this).call(this),this._clickHandler=null,this.fileInput&&(this.fileInput.destroy(),this.fileInput=null)}},{key:"_installDragAndDropHandler",value:function(){this.dragAndDropHandler||(this.dragAndDropHandler=this._createDragAndDropHandler(),this.dragAndDropHandler.install(this.$fieldContainer))}},{key:"setImageUrl",value:function(e){this.setProperty("imageUrl",e)}},{key:"_setImageUrl",value:function(e){this._setProperty("imageUrl",e),this.icon.setIconDesc(e)}},{key:"_renderImageUrl",value:function(){var e=!!this.imageUrl;this.$fieldContainer.toggleClass("has-image",e),this.$container.toggleClass("has-image",e),Lh.update(this.$fieldContainer)}},{key:"setAutoFit",value:function(e){this.setProperty("autoFit",e)}},{key:"_setAutoFit",value:function(e){this._setProperty("autoFit",e),this.icon.setAutoFit(e)}},{key:"_renderAutoFit",value:function(){Lh.update(this.$fieldContainer)}},{key:"setScrollBarEnabled",value:function(e){this.setProperty("scrollBarEnabled",e)}},{key:"_renderScrollBarEnabled",value:function(){this._updateInnerAlignment(),this.scrollBarEnabled?this._installScrollbars():this._uninstallScrollbars()}},{key:"get$Scrollable",value:function(){return this.$fieldContainer}},{key:"_renderGridData",value:function(){uZ(pZ(i.prototype),"_renderGridData",this).call(this),this._updateInnerAlignment()}},{key:"_renderGridDataHints",value:function(){uZ(pZ(i.prototype),"_renderGridDataHints",this).call(this),this._updateInnerAlignment()}},{key:"_updateInnerAlignment",value:function(){this.updateInnerAlignment({useHorizontalAlignment:!this.scrollBarEnabled,useVerticalAlignment:!this.scrollBarEnabled})}},{key:"_renderEnabled",value:function(){uZ(pZ(i.prototype),"_renderEnabled",this).call(this),this._updateUploadEnabled()}},{key:"setUploadEnabled",value:function(e){this.setProperty("uploadEnabled",e)}},{key:"_renderUploadEnabled",value:function(){this._updateUploadEnabled()}},{key:"_updateUploadEnabled",value:function(){var e=this.enabledComputed&&this.uploadEnabled;this.$fieldContainer.toggleClass("clickable",e),e?(this._clickHandler||(this._clickHandler=this._onClickUpload.bind(this),this.$fieldContainer.on("click",this._clickHandler)),this.fileInput||(this.fileInput=O.create("FileInput",{parent:this,acceptTypes:this.acceptTypes,text:this.displayText,enabled:this.enabledComputed,maximumUploadSize:this.maximumUploadSize,visible:!Kt.get().supportsFile()}),this.fileInput.render(this.$fieldContainer),this.fileInput.on("change",this._onFileChange.bind(this)))):(this.$fieldContainer.off("click",this._clickHandler),this._clickHandler=null,this.fileInput&&(this.fileInput.destroy(),this.fileInput=null))}},{key:"_onClickUpload",value:function(e){s()(e.target).isOrHas(this.$field)&&this.fileInput.browse()}},{key:"_onFileChange",value:function(e){this.trigger("fileUpload",{file:rt.first(e.files)})}},{key:"_onImageLoad",value:function(e){this._onIconUpdated()}},{key:"_onImageError",value:function(e){this._onIconUpdated()}},{key:"_onIconUpdated",value:function(){Lh.update(this.$fieldContainer),this.$field=this.icon.$container}}])&&lZ(t.prototype,n),r&&lZ(t,r),i}(ZW);function yZ(e){return(yZ="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function vZ(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function bZ(e,t,n){return(bZ="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=wZ(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function mZ(e,t){return(mZ=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function gZ(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=wZ(e);if(t){var o=wZ(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return _Z(this,n)}}function _Z(e,t){return!t||"object"!==yZ(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function wZ(e){return(wZ=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var kZ=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&mZ(e,t)}(i,e);var t,n,r,o=gZ(i);function i(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),o.call(this)}return t=i,(n=[{key:"_onWidgetEvent",value:function(e){"fileUpload"===e.type?this._onFileUpload(e):bZ(wZ(i.prototype),"_onWidgetEvent",this).call(this,e)}},{key:"_onFileUpload",value:function(e){this.widget.fileInput.upload()||this.widget.fileInput.clear()}}])&&vZ(t.prototype,n),r&&vZ(t,r),i}(sz);function SZ(e){return(SZ="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function OZ(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function TZ(e,t,n){return(TZ="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=xZ(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function CZ(e,t){return(CZ=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function PZ(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=xZ(e);if(t){var o=xZ(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return RZ(this,n)}}function RZ(e,t){return!t||"object"!==SZ(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function xZ(e){return(xZ=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var EZ=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&CZ(e,t)}(i,e);var t,n,r,o=PZ(i);function i(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),o.call(this,e)}return t=i,(n=[{key:"layout",value:function(e){TZ(xZ(i.prototype),"layout",this).call(this,e),Lh.update(this.formField.$fieldContainer)}}])&&OZ(t.prototype,n),r&&OZ(t,r),i}(dz);function DZ(e){return(DZ="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function AZ(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function FZ(e,t,n){return(FZ="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=MZ(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function $Z(e,t){return($Z=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function jZ(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=MZ(e);if(t){var o=MZ(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return BZ(this,n)}}function BZ(e,t){return!t||"object"!==DZ(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function MZ(e){return(MZ=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var IZ=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&$Z(e,t)}(i,e);var t,n,r,o=jZ(i);function i(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(e=o.call(this)).htmlEnabled=!1,e.selectable=!0,e.wrapText=!1,e}return t=i,(n=[{key:"_initValue",value:function(e){e=bp.resolveText(e,this.session.locale.languageTag),FZ(MZ(i.prototype),"_initValue",this).call(this,e)}},{key:"_render",value:function(){this.addContainer(this.$parent,"label-field"),this.addLabel(),this.addField(this.$parent.makeDiv()),this.addStatus()}},{key:"_renderProperties",value:function(){FZ(MZ(i.prototype),"_renderProperties",this).call(this),this._renderWrapText()}},{key:"acceptInput",value:function(){}},{key:"setHtmlEnabled",value:function(e){this.setProperty("htmlEnabled",e)}},{key:"_renderHtmlEnabled",value:function(){this._renderDisplayText()}},{key:"_renderDisplayText",value:function(){var e=this.displayText||"";this.htmlEnabled?(this.$field.html(e),this.$field.find(".app-link").on("click",this._onAppLinkAction.bind(this))):this.$field.html(Wn.nl2br(e)),this.invalidateLayoutTree()}},{key:"setWrapText",value:function(e){this.setProperty("wrapText",e)}},{key:"_renderWrapText",value:function(){this.$field.toggleClass("white-space-nowrap",!this.wrapText),this.invalidateLayoutTree()}},{key:"_renderGridData",value:function(){FZ(MZ(i.prototype),"_renderGridData",this).call(this),this.updateInnerAlignment({useHorizontalAlignment:!0})}},{key:"_renderGridDataHints",value:function(){FZ(MZ(i.prototype),"_renderGridDataHints",this).call(this),this.updateInnerAlignment({useHorizontalAlignment:!0})}},{key:"_onAppLinkAction",value:function(e){var t=$(e.delegateTarget).data("ref");this.triggerAppLinkAction(t)}},{key:"triggerAppLinkAction",value:function(e){this.trigger("appLinkAction",{ref:e})}},{key:"addField",value:function(e){FZ(MZ(i.prototype),"addField",this).call(this,e),this.$field.off("blur").off("focus")}}])&&AZ(t.prototype,n),r&&AZ(t,r),i}(Qz);function LZ(e){return(LZ="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function HZ(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function NZ(e,t,n){return(NZ="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=GZ(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function VZ(e,t){return(VZ=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function WZ(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=GZ(e);if(t){var o=GZ(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return zZ(this,n)}}function zZ(e,t){return!t||"object"!==LZ(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function GZ(e){return(GZ=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var UZ=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&VZ(e,t)}(i,e);var t,n,r,o=WZ(i);function i(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),o.call(this)}return t=i,(n=[{key:"_onWidgetAppLinkAction",value:function(e){this._send("appLinkAction",{ref:e.ref})}},{key:"_onWidgetEvent",value:function(e){"appLinkAction"===e.type?this._onWidgetAppLinkAction(e):NZ(GZ(i.prototype),"_onWidgetEvent",this).call(this,e)}}])&&HZ(t.prototype,n),r&&HZ(t,r),i}(aG);function KZ(e){return(KZ="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function qZ(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function YZ(e,t,n){return(YZ="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=QZ(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function XZ(e,t){return(XZ=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function JZ(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=QZ(e);if(t){var o=QZ(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return ZZ(this,n)}}function ZZ(e,t){return!t||"object"!==KZ(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function QZ(e){return(QZ=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var eQ=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&XZ(e,t)}(i,e);var t,n,r,o=JZ(i);function i(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(e=o.call(this)).table=null,e.lookupStatus=null,e.clearable=Qz.Clearable.NEVER,e._addWidgetProperties(["table","filterBox"]),e}return t=i,(n=[{key:"_init",value:function(e){YZ(QZ(i.prototype),"_init",this).call(this,e),this.table.on("rowsChecked",this._onTableRowsChecked.bind(this)),this.table.setScrollTop(this.scrollTop)}},{key:"_initStructure",value:function(e){this.table||(this.table=this._createDefaultListBoxTable())}},{key:"_render",value:function(){YZ(QZ(i.prototype),"_render",this).call(this),this.$container.addClass("list-box")}},{key:"_createFieldContainerLayout",value:function(){return new hQ(this,this.table,this.filterBox)}},{key:"_renderStructure",value:function(){this.table.render(this.$fieldContainer),this.addField(this.table.$container)}},{key:"_onTableRowsChecked",value:function(e){this._syncTableToValue()}},{key:"_syncTableToValue",value:function(){if(this.lookupCall&&!this._valueSyncing){this._valueSyncing=!0;var e=[];this.table.rows.forEach((function(t){t.checked&&e.push(t.lookupRow.key)}),this),this.setValue(e),this._valueSyncing=!1}}},{key:"_valueChanged",value:function(){YZ(QZ(i.prototype),"_valueChanged",this).call(this),this._syncValueToTable(this.value)}},{key:"_syncValueToTable",value:function(e){if(this.lookupCall&&!this._valueSyncing&&this.initialized){this._valueSyncing=!0;var t={checkOnlyEnabled:!1};try{if(rt.empty(e))this.table.uncheckRows(this.table.rows,t);else{if(this._ensureLookupCallExecuted())return;var n=[];this.table.uncheckRows(this.table.rows,t),this.table.rows.forEach((function(t){rt.containsAny(e,t.lookupRow.key)&&n.push(t)}),this),this.table.checkRows(n,t)}this._updateDisplayText()}finally{this._valueSyncing=!1}}}},{key:"_lookupByAllDone",value:function(e){YZ(QZ(i.prototype),"_lookupByAllDone",this).call(this,e)&&this._populateTable(e)}},{key:"_populateTable",value:function(e){var t=[];e.lookupRows.forEach((function(e){t.push(this._createTableRow(e))}),this),this.table.deleteAllRows(),this.table.insertRows(t),this._syncValueToTable(this.value)}},{key:"getCheckedLookupRows",value:function(){return null===this.value||rt.empty(this.value)||0===this.table.rows.length?[]:this.table.rows.filter((function(e){return e.checked})).map((function(e){return e.lookupRow}))}},{key:"_createTableRow",value:function(e){var t=O.create("Cell",{text:e.text}),n={cells:[t],lookupRow:e};return e.iconId&&(t.iconId=e.iconId),e.tooltipText&&(t.tooltipText=e.tooltipText),e.backgroundColor&&(t.backgroundColor=e.backgroundColor),e.foregroundColor&&(t.foregroundColor=e.foregroundColor),e.font&&(t.font=e.font),!1===e.enabled&&(n.enabled=!1),!1===e.active&&(n.active=!1),e.cssClass&&(n.cssClass=e.cssClass),n}},{key:"_createDefaultListBoxTable",value:function(){return O.create("Table",{parent:this,autoResizeColumns:!0,checkable:!0,checkableStyle:Cx.CheckableStyle.CHECKBOX_TABLE_ROW,headerVisible:!1,footerVisible:!1,columns:[{objectType:"Column"}]})}},{key:"getDelegateScrollable",value:function(){return this.table}}])&&qZ(t.prototype,n),r&&qZ(t,r),i}(JG);function tQ(e){return(tQ="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function nQ(e,t){return(nQ=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function rQ(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=iQ(e);if(t){var o=iQ(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return oQ(this,n)}}function oQ(e,t){return!t||"object"!==tQ(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function iQ(e){return(iQ=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var sQ=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&nQ(e,t)}(n,e);var t=rQ(n);function n(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),t.call(this)}return n}(aG);function aQ(e){return(aQ="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function lQ(e,t){return(lQ=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function uQ(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=fQ(e);if(t){var o=fQ(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return cQ(this,n)}}function cQ(e,t){return!t||"object"!==aQ(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function fQ(e){return(fQ=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var hQ=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&lQ(e,t)}(n,e);var t=uQ(n);function n(e,r,o){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),t.call(this,e,r,o)}return n}(oU);function pQ(e,t,n){var r=O.create("Cell");return t&&t.propertyName?r.text=n[t.propertyName]:(r.text=e.text,e.iconId&&(r.iconId=e.iconId),e.tooltipText&&(r.tooltipText=e.tooltipText),e.backgroundColor&&(r.backgroundColor=e.backgroundColor),e.foregroundColor&&(r.foregroundColor=e.foregroundColor),e.font&&(r.font=e.font)),r}var dQ={createTableCell:pQ,createTableRow:function(e,t){t=O.nvl(t,!1);var n=[],r={cells:n,lookupRow:e};return!1===e.enabled&&(r.enabled=!1),!1===e.active&&(r.active=!1),e.cssClass&&(r.cssClass=e.cssClass),t||n.push(pQ(e,null,null)),r}};function yQ(e){return(yQ="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function vQ(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function bQ(e,t){return(bQ=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function mQ(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=_Q(e);if(t){var o=_Q(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return gQ(this,n)}}function gQ(e,t){return!t||"object"!==yQ(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function _Q(e){return(_Q=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var wQ=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&bQ(e,t)}(i,e);var t,n,r,o=mQ(i);function i(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),o.call(this)}return t=i,(n=[{key:"sendLookup",value:function(e,t){var n=e.toLowerCase(),r="lookupBy"+Wn.toUpperCaseFirstLetter(n),o={showBusyIndicator:!1};Pr.isNullOrUndefined(t)||(o[n]=t),this._send(r,o)}}])&&vQ(t.prototype,n),r&&vQ(t,r),i}(aG);function kQ(e){return(kQ="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function SQ(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function OQ(e,t){return(OQ=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function TQ(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=RQ(e);if(t){var o=RQ(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return CQ(this,n)}}function CQ(e,t){return!t||"object"!==kQ(t)&&"function"!=typeof t?PQ(e):t}function PQ(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function RQ(e){return(RQ=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var xQ=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&OQ(e,t)}(i,e);var t,n,r,o=TQ(i);function i(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(e=o.call(this))._addWidgetProperties(["modeSelector","modes"]),e._modeSelectorPropertyChangeHandler=e._onModeSelectorPropertyChange.bind(PQ(e)),e}return t=i,(n=[{key:"_render",value:function(){this.addContainer(this.$parent,"mode-selector-field"),this.addLabel(),this.addStatus(),this.modeSelector&&(this._renderModeSelector(),this.modeSelector.on("propertyChange",this._modeSelectorPropertyChangeHandler))}},{key:"_renderModeSelector",value:function(){this.modeSelector.render(),this.addField(this.modeSelector.$container)}},{key:"_removeModeSelector",value:function(){this.modeSelector.remove(),this._removeField()}},{key:"_onModeSelectorPropertyChange",value:function(e){"selectedMode"===e.propertyName&&(e.newValue?this.setValue(e.newValue.ref):this.modeSelector.selectedMode&&this.modeSelector.selectedMode.id?this.setValue(this.modeSelector.selectedMode.id):this.setValue(null))}}])&&SQ(t.prototype,n),r&&SQ(t,r),i}(Qz);function EQ(e){return(EQ="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function DQ(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function AQ(e,t,n){return(AQ="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=BQ(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function FQ(e,t){return(FQ=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function $Q(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=BQ(e);if(t){var o=BQ(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return jQ(this,n)}}function jQ(e,t){return!t||"object"!==EQ(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function BQ(e){return(BQ=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var MQ=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&FQ(e,t)}(i,e);var t,n,r,o=$Q(i);function i(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),o.call(this)}return t=i,(n=[{key:"_createWidget",value:function(e){return this._addModeSelector(e),AQ(BQ(i.prototype),"_createWidget",this).call(this,e)}},{key:"_addModeSelector",value:function(e){e.modeSelector={objectType:"ModeSelector"}}},{key:"_postCreateWidget",value:function(){this.widget.modeSelector.setModes(this.widget.modes),delete this.widget.modes}}])&&DQ(t.prototype,n),r&&DQ(t,r),i}(aG);function IQ(e){return(IQ="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function LQ(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function HQ(e,t,n){return(HQ="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=zQ(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function NQ(e,t){return(NQ=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function VQ(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=zQ(e);if(t){var o=zQ(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return WQ(this,n)}}function WQ(e,t){return!t||"object"!==IQ(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function zQ(e){return(zQ=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var GQ=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&NQ(e,t)}(i,e);var t,n,r,o=VQ(i);function i(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(e=o.call(this)).calc=new t0,e.minValue=null,e.maxValue=null,e.decimalFormat=null,e.invalidValueMessageKey="InvalidNumberMessageX",e.gridDataHints.horizontalAlignment=1,e}return t=i,(n=[{key:"_init",value:function(e){HQ(zQ(i.prototype),"_init",this).call(this,e),this._setMinValue(this.minValue),this._setMaxValue(this.maxValue),this._setDecimalFormat(this.decimalFormat)}},{key:"_initValue",value:function(e){this._setDecimalFormat(this.decimalFormat),HQ(zQ(i.prototype),"_initValue",this).call(this,e)}},{key:"_createKeyStrokeContext",value:function(){return new Vu}},{key:"_render",value:function(){this.addContainer(this.$parent,"number-field"),this.addLabel(),this.addMandatoryIndicator();var e=TW.makeTextField(this.$parent);this.addField(e),this.addStatus()}},{key:"_renderGridData",value:function(){HQ(zQ(i.prototype),"_renderGridData",this).call(this),this.updateInnerAlignment({useHorizontalAlignment:!0})}},{key:"_renderGridDataHints",value:function(){HQ(zQ(i.prototype),"_renderGridDataHints",this).call(this),this.updateInnerAlignment({useHorizontalAlignment:!0})}},{key:"_getDefaultFormat",value:function(e){return e.decimalFormatPatternDefault}},{key:"setDecimalFormat",value:function(e){this.setProperty("decimalFormat",e)}},{key:"_setDecimalFormat",value:function(e){e||(e=this._getDefaultFormat(this.session.locale)),e=rp.ensure(this.session.locale,e),this._setProperty("decimalFormat",e),this.initialized&&this._updateDisplayText()}},{key:"_parseValue",value:function(e){return e?this.decimalFormat.parse(e,this._evaluateNumber.bind(this)):null}},{key:"_evaluateNumber",value:function(e){if(this.calc.isFormula(e)){var t=this.calc.evalFormula(e);if(isNaN(t))throw new Error(e+" is not a valid expression");return t}return Number(e)}},{key:"_ensureValue",value:function(e){return pr.ensure(e)}},{key:"_validateValue",value:function(e){if(Pr.isNullOrUndefined(e))return e;if(!pr.isNumber(e))throw this.session.text(this.invalidValueMessageKey,e);return!Pr.isNullOrUndefined(this.minValue)&&e<this.minValue&&this._onNumberTooSmall(),!Pr.isNullOrUndefined(this.maxValue)&&e>this.maxValue&&this._onNumberTooLarge(),e}},{key:"_onNumberTooLarge",value:function(){if(Pr.isNullOrUndefined(this.minValue))throw this.session.text("NumberTooLargeMessageX",this._formatValue(this.maxValue));throw this.session.text("NumberTooLargeMessageXY",this._formatValue(this.minValue),this._formatValue(this.maxValue))}},{key:"_onNumberTooSmall",value:function(){if(Pr.isNullOrUndefined(this.maxValue))throw this.session.text("NumberTooSmallMessageX",this._formatValue(this.minValue));throw this.session.text("NumberTooSmallMessageXY",this._formatValue(this.minValue),this._formatValue(this.maxValue))}},{key:"_formatValue",value:function(e){return Pr.isNullOrUndefined(e)?"":"number"!=typeof e?e+"":this.decimalFormat.format(e,!0)}},{key:"setMinValue",value:function(e){this.minValue!==e&&(this._setMinValue(e),this.validate())}},{key:"_setMinValue",value:function(e){this._setProperty("minValue",e),!Pr.isNullOrUndefined(this.maxValue)&&!Pr.isNullOrUndefined(this.minValue)&&e>this.maxValue&&this._setMaxValue(e)}},{key:"setMaxValue",value:function(e){this.maxValue!==e&&(this._setMaxValue(e),this.validate())}},{key:"_setMaxValue",value:function(e){this._setProperty("maxValue",e),!Pr.isNullOrUndefined(this.maxValue)&&!Pr.isNullOrUndefined(this.minValue)&&e<this.minValue&&this._setMinValue(e)}}])&&LQ(t.prototype,n),r&&LQ(t,r),i}(yG);function UQ(e){return(UQ="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function KQ(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function qQ(e,t,n){return(qQ="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=ZQ(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function YQ(e,t){return(YQ=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function XQ(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=ZQ(e);if(t){var o=ZQ(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return JQ(this,n)}}function JQ(e,t){return!t||"object"!==UQ(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function ZQ(e){return(ZQ=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var QQ=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&YQ(e,t)}(i,e);var t,n,r,o=XQ(i);function i(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),o.call(this)}return t=i,r=[{key:"modifyPrototype",value:function(){E.get().remote&&Pr.replacePrototypeFunction(GQ,"clearErrorStatus",(function(){if(!this.modelAdapter)return this.clearErrorStatusOrig()}),!0)}}],(n=[{key:"_onWidgetParseError",value:function(e){e.preventDefault()}},{key:"_onWidgetEvent",value:function(e){"parseError"===e.type?this._onWidgetParseError(e):qQ(ZQ(i.prototype),"_onWidgetEvent",this).call(this,e)}}])&&KQ(t.prototype,n),r&&KQ(t,r),i}(wG);function e0(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}E.addListener("bootstrap",QQ.modifyPrototype);var t0=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,(n=[{key:"isFormula",value:function(e){return e.match(/^[\d()+\-*/.]+$/)}},{key:"evalFormula",value:function(e){return this._tokens=e.split(/([\d.]+|\(|\)|[+\-*/])/).filter((function(e){return 0!==e.length})),this._expr()}},{key:"_next",value:function(){if(0!==this._tokens.length)return this._tokens[0]}},{key:"_consumeNext",value:function(){var e=this._tokens[0];return this._tokens=this._tokens.slice(1,this._tokens.length),e}},{key:"_expr",value:function(){return this._sum()}},{key:"_sum",value:function(){for(var e=this._prod();"+"===this._next()||"-"===this._next();)switch(this._consumeNext()){case"+":e+=this._prod();break;case"-":e-=this._prod()}return e}},{key:"_prod",value:function(){for(var e=this._unary();"*"===this._next()||"/"===this._next();)switch(this._consumeNext()){case"*":e*=this._unary();break;case"/":e/=this._unary()}return e}},{key:"_unary",value:function(){var e,t=1;return"+"===this._next()?this._consumeNext():"-"===this._next()&&(this._consumeNext(),t=-1),void 0!==(e=this._group())?t*e:t*(e=this._consumeNext())}},{key:"_group",value:function(){if("("===this._next()){this._consumeNext();var e=this._expr();if(")"!==this._next())throw"missing closing bracket";return this._consumeNext(),e}}}])&&e0(t.prototype,n),r&&e0(t,r),e}();function n0(e){return(n0="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function r0(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function o0(e,t,n){return(o0="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=l0(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function i0(e,t){return(i0=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function s0(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=l0(e);if(t){var o=l0(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return a0(this,n)}}function a0(e,t){return!t||"object"!==n0(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function l0(e){return(l0=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function u0(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var c0=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&i0(e,t)}(i,e);var t,n,r,o=s0(i);function i(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(e=o.call(this)).minValue=i.MIN_VALUE,e.maxValue=i.MAX_VALUE,e}return t=i,(n=[{key:"_getDefaultFormat",value:function(e){return"#,##0"}},{key:"_parseValue",value:function(e){var t=o0(l0(i.prototype),"_parseValue",this).call(this,e);return Pr.isNullOrUndefined(t)?null:this.decimalFormat.round(t,!1)}}])&&r0(t.prototype,n),r&&r0(t,r),i}(GQ);function f0(e){return(f0="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function h0(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function p0(e,t){return(p0=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function d0(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=v0(e);if(t){var o=v0(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return y0(this,n)}}function y0(e,t){return!t||"object"!==f0(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function v0(e){return(v0=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}u0(c0,"MIN_VALUE",Number.MIN_SAFE_INTEGER),u0(c0,"MAX_VALUE",Number.MAX_SAFE_INTEGER);var b0=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&p0(e,t)}(i,e);var t,n,r,o=d0(i);function i(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),o.call(this)}return t=i,(n=[{key:"_render",value:function(){this.addContainer(this.$parent,"placeholder-field"),this.addLabel()}},{key:"_renderLabel",value:function(){this._renderEmptyLabel()}}])&&h0(t.prototype,n),r&&h0(t,r),i}(ZW);function m0(e){return(m0="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function g0(e,t){return(g0=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function _0(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=k0(e);if(t){var o=k0(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return w0(this,n)}}function w0(e,t){return!t||"object"!==m0(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function k0(e){return(k0=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var S0=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&g0(e,t)}(n,e);var t=_0(n);function n(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),t.call(this)}return n}(sz);function O0(e){return(O0="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function T0(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function C0(e,t){return(C0=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function P0(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=x0(e);if(t){var o=x0(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return R0(this,n)}}function R0(e,t){return!t||"object"!==O0(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function x0(e){return(x0=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var E0=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&C0(e,t)}(i,e);var t,n,r,o=P0(i);function i(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(e=o.call(this))._addWidgetProperties(["planner"]),e.gridDataHints.weightY=1,e}return t=i,(n=[{key:"_render",value:function(){this.addContainer(this.$parent,"planner-field"),this.addLabel(),this.addStatus(),this.planner&&this._renderPlanner()}},{key:"_renderPlanner",value:function(){this.planner.render(),this.addField(this.planner.$container)}},{key:"_removePlanner",value:function(){this.planner.remove(),this._removeField()}}])&&T0(t.prototype,n),r&&T0(t,r),i}(ZW);function D0(e){return(D0="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function A0(e,t){return(A0=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function F0(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=j0(e);if(t){var o=j0(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return $0(this,n)}}function $0(e,t){return!t||"object"!==D0(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function j0(e){return(j0=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var B0=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&A0(e,t)}(n,e);var t=F0(n);function n(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),t.call(this)}return n}(sz);function M0(e){return(M0="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function I0(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function L0(e,t,n){return(L0="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=z0(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function H0(e,t){return(H0=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function N0(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=z0(e);if(t){var o=z0(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return V0(this,n)}}function V0(e,t){return!t||"object"!==M0(t)&&"function"!=typeof t?W0(e):t}function W0(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function z0(e){return(z0=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var G0=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&H0(e,t)}(i,e);var t,n,r,o=N0(i);function i(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(e=o.call(this)).gridDataHints.fillHorizontal=!0,e.focusWhenSelected=!0,e.wrapText=!1,e.buttonKeyStroke=new s2(W0(e),null),e.radioValue=null,e}return t=i,(n=[{key:"_initDefaultKeyStrokes",value:function(){this.keyStrokeContext.registerKeyStroke([new s2(this,"ENTER"),new s2(this,"SPACE")])}},{key:"_render",value:function(){this.addContainer(this.$parent,"radio-button",new Q0(this)),this.addFieldContainer(this.$parent.makeDiv()),this.$radioButton=this.$fieldContainer.appendDiv("radio-button-circle").data("radiobutton",this),this.addField(this.$radioButton),this.$buttonLabel=this.$fieldContainer.appendDiv("label"),TW.linkElementWithLabel(this.$radioButton,this.$buttonLabel),this.$fieldContainer.on("mousedown",this._onMouseDown.bind(this)),xp.installForEllipsis(this.$buttonLabel,{parent:this}),this.addStatus(),this.session.keyStrokeManager.installKeyStrokeContext(this.formKeyStrokeContext)}},{key:"_remove",value:function(){xp.uninstall(this.$buttonLabel),this.session.keyStrokeManager.uninstallKeyStrokeContext(this.formKeyStrokeContext),L0(z0(i.prototype),"_remove",this).call(this)}},{key:"_renderProperties",value:function(){L0(z0(i.prototype),"_renderProperties",this).call(this),this._renderWrapText(),this._renderSelected()}},{key:"setWrapText",value:function(e){this.setProperty("wrapText",e)}},{key:"_renderWrapText",value:function(){this.$buttonLabel.toggleClass("white-space-nowrap",!this.wrapText),this.invalidateLayoutTree()}},{key:"select",value:function(){this.setSelected(!0)}},{key:"setSelected",value:function(e){this.setProperty("selected",e)}},{key:"_renderSelected",value:function(){this.$fieldContainer.toggleClass("checked",this.selected),this.$field.toggleClass("checked",this.selected)}},{key:"setTabbable",value:function(e){this.rendered&&this.$field.setTabbable(e&&!Kt.get().supportsOnlyTouch())}},{key:"isTabbable",value:function(){return this.rendered&&this.$field.isTabbable()}},{key:"_renderIconId",value:function(){L0(z0(i.prototype),"_renderIconId",this).call(this);var e=this.get$Icon();e.length>0&&e.insertAfter(this.$radioButton)}},{key:"doAction",value:function(){return!(!this.enabledComputed||!this.visible||(this.select(),0))}},{key:"_onMouseDown",value:function(e){if(this.enabledComputed){var t=this.get$Icon().is(e.target),n=this.$radioButton.is(e.target),r=this.$buttonLabel.isOrHas(e.target);(n||r||t)&&(this.select(),this.focusWhenSelected&&(r||t)&&this.focusAndPreventDefault(e))}}}])&&I0(t.prototype,n),r&&I0(t,r),i}(JK);function U0(e){return(U0="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function K0(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function q0(e,t,n){return(q0="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Z0(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function Y0(e,t){return(Y0=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function X0(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Z0(e);if(t){var o=Z0(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return J0(this,n)}}function J0(e,t){return!t||"object"!==U0(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Z0(e){return(Z0=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Q0=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Y0(e,t)}(i,e);var t,n,r,o=X0(i);function i(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(t=o.call(this,e)).radioButton=e,t}return t=i,(n=[{key:"layout",value:function(e){q0(Z0(i.prototype),"layout",this).call(this,e);var t=this.radioButton.get$Icon(),n=this.radioButton.$radioButton,r=this.radioButton.$buttonLabel,o=this.radioButton.$fieldContainer.width()-(n.outerWidth(!0)+(t.length?t.outerWidth(!0):0));r.css("max-width",o)}}])&&K0(t.prototype,n),r&&K0(t,r),i}(iq);function e1(e){return(e1="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function t1(e,t){return(t1=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function n1(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=o1(e);if(t){var o=o1(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return r1(this,n)}}function r1(e,t){return!t||"object"!==e1(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function o1(e){return(o1=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var i1=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&t1(e,t)}(n,e);var t=n1(n);function n(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),(e=t.call(this))._addRemoteProperties(["selected"]),e}return n}(pq);function s1(e){return(s1="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function a1(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function l1(e,t,n){return(l1="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=p1(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function u1(e,t){return(u1=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function c1(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=p1(e);if(t){var o=p1(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return f1(this,n)}}function f1(e,t){return!t||"object"!==s1(t)&&"function"!=typeof t?h1(e):t}function h1(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function p1(e){return(p1=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function d1(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var y1=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&u1(e,t)}(i,e);var t,n,r,o=c1(i);function i(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(e=o.call(this)).logicalGrid=O.create("scout.HorizontalGrid"),e.layoutConfig=null,e.fields=[],e.radioButtons=[],e.gridColumnCount=i.DEFAULT_GRID_COLUMN_COUNT,e.selectedButton=null,e.$body=null,e.lookupStatus=null,e.lookupCall=null,e._lookupExecuted=!1,e._selectButtonLocked=!1,e._pendingLookup=null,e._lookupInProgress=!1,e._currentLookupCall=null,e._addWidgetProperties(["fields"]),e._addCloneProperties(["lookupCall","layoutConfig","gridColumnCount"]),e._buttonPropertyChangeHandler=e._onButtonPropertyChange.bind(h1(e)),e}return t=i,(n=[{key:"_init",value:function(e){l1(p1(i.prototype),"_init",this).call(this,e),this._setLayoutConfig(this.layoutConfig),this._setGridColumnCount(this.gridColumnCount)}},{key:"_initValue",value:function(e){this.lookupCall&&this._setLookupCall(this.lookupCall),this._setFields(this.fields),l1(p1(i.prototype),"_initValue",this).call(this,e)}},{key:"_initKeyStrokeContext",value:function(){l1(p1(i.prototype),"_initKeyStrokeContext",this).call(this),this.keyStrokeContext.registerKeyStroke([new G1(this),new Z1(this)])}},{key:"_initButtons",value:function(){this.radioButtons=this.fields.filter((function(e){return e instanceof G0})),this.radioButtons.forEach(this._initButton.bind(this))}},{key:"_initButton",value:function(e){0===e.events.count("propertyChange",this._buttonPropertyChangeHandler)&&e.on("propertyChange",this._buttonPropertyChangeHandler),e.selected&&(this.setValue(e.radioValue),this.selectButton(e),e.focused&&this.setFocused(!0))}},{key:"_render",value:function(){this.addContainer(this.$parent,"radiobutton-group"),this.addLabel(),this.addMandatoryIndicator(),this.$body=this.$container.appendDiv("radiobutton-group-body"),this.htmlBody=ea.install(this.$body,this.session),this.htmlBody.setLayout(this._createBodyLayout()),this.addField(this.$body),this.addStatus()}},{key:"_renderProperties",value:function(){l1(p1(i.prototype),"_renderProperties",this).call(this),this._renderFields(),this._renderLayoutConfig()}},{key:"_createBodyLayout",value:function(){return new I1(this,this.layoutConfig)}},{key:"_setLogicalGrid",value:function(e){l1(p1(i.prototype),"_setLogicalGrid",this).call(this,e),this.logicalGrid&&this.logicalGrid.setGridConfig(new E1)}},{key:"invalidateLogicalGrid",value:function(e){l1(p1(i.prototype),"invalidateLogicalGrid",this).call(this,!1),O.nvl(e,!0)&&this.rendered&&this.htmlBody.invalidateLayoutTree()}},{key:"setLayoutConfig",value:function(e){this.setProperty("layoutConfig",e)}},{key:"_setLayoutConfig",value:function(e){e||(e=new ga),this._setProperty("layoutConfig",ga.ensure(e))}},{key:"_renderLayoutConfig",value:function(){this.layoutConfig.applyToLayout(this.htmlBody.layout),this.rendered&&this.htmlBody.invalidateLayoutTree()}},{key:"isClearable",value:function(){return!1}},{key:"getFields",value:function(){return this.fields}},{key:"visitFields",value:function(e){var t=l1(p1(i.prototype),"visitFields",this).call(this,e);if(t===iU.TERMINATE)return iU.TERMINATE;if(t!==iU.SKIP_SUBTREE)for(var n=this.getFields(),r=0;r<n.length;r++)if((t=n[r].visitFields(e))===iU.TERMINATE)return iU.TERMINATE}},{key:"getFocusableElement",value:function(){return this.session.focusManager.findFirstFocusableElement(this.$container)}},{key:"setFields",value:function(e){this.setProperty("fields",e)}},{key:"_setFields",value:function(e){this._setProperty("fields",e),this._initButtons()}},{key:"_renderFields",value:function(){this._ensureLookupCallExecuted(),this.fields.forEach((function(e){e.render(this.$body),e.setLayoutData(new ua(e)),this._linkWithLabel(e.$field)}),this),this._provideTabIndex(),this.invalidateLogicalGrid(),this.validateLayoutTree()}},{key:"_renderEnabled",value:function(){l1(p1(i.prototype),"_renderEnabled",this).call(this),this._provideTabIndex()}},{key:"_provideTabIndex",value:function(){var e;this.radioButtons.forEach((function(t){t.enabledComputed&&this.enabledComputed&&!e?(t.setTabbable(!0),e=t):e&&this.enabledComputed&&t.enabledComputed&&t.selected?(e.setTabbable(!1),t.setTabbable(!0),e=t):t.setTabbable(!1)}),this)}},{key:"setGridColumnCount",value:function(e){this.setProperty("gridColumnCount",e)}},{key:"_setGridColumnCount",value:function(e){return e<0&&(e=this._calcDefaultGridColumnCount()),e!==this.gridColumnCount&&(this._setProperty("gridColumnCount",e),this.invalidateLogicalGrid(),!0)}},{key:"_calcDefaultGridColumnCount",value:function(){var e=1,t=this.gridDataHints;return t&&t.h>1&&(e=t.h),Math.ceil(this.fields.length/e)}},{key:"getButtonForRadioValue",value:function(e){return null===e?null:rt.find(this.radioButtons,(function(t){return Pr.equals(t.radioValue,e)}))}},{key:"_validateValue",value:function(e){if(l1(p1(i.prototype),"_validateValue",this).call(this,e),!this.initialized&&this.lookupCall)return e;if(this._ensureLookupCallExecuted())return e;if(!this.getButtonForRadioValue(e)&&null!=e&&!this._lookupInProgress)throw this.session.text("InvalidValueMessageX",e);return e}},{key:"_valueChanged",value:function(){l1(p1(i.prototype),"_valueChanged",this).call(this),(null!==this.value||this.initialized)&&this.selectButton(this.getButtonForRadioValue(this.value))}},{key:"selectFirstButton",value:function(){this.selectButtonByIndex(0)}},{key:"selectLastButton",value:function(){this.selectButtonByIndex(this.radioButtons.length-1)}},{key:"selectButtonByIndex",value:function(e){this.radioButtons.length&&e>=0&&e<this.radioButtons.length&&this.selectButton(this.radioButtons[e])}},{key:"selectButton",value:function(e){if(this.selectedButton!==e&&!this._selectButtonLocked){if(this._selectButtonLocked=!0,this.selectedButton&&this.selectedButton.setSelected(!1),e){var t=this.getTabbableButton(),n=!1;t&&(n=t.isFocused()),e.setSelected(!0),e.setTabbable(!0),n&&e.focus(),t&&t!==e&&t.setTabbable(!1)}this._selectButtonLocked=!1,this.setProperty("selectedButton",e)}}},{key:"getTabbableButton",value:function(){return rt.find(this.radioButtons,(function(e){return e.visible&&e.isTabbable()}))}},{key:"insertButton",value:function(e){var t=this.fields.slice();t.push(e),this.setFields(t)}},{key:"_onButtonPropertyChange",value:function(e){"selected"===e.propertyName?e.newValue?(this.setValue(e.source.radioValue),this.selectButton(e.source)):e.source===this.selectedButton&&this.selectButton(null):"focused"===e.propertyName&&this.setFocused(e.newValue)}},{key:"_setLookupCall",value:function(e){this._setProperty("lookupCall",ri.ensure(e,this.session)),this._lookupExecuted=!1,this.rendered&&this._ensureLookupCallExecuted()}},{key:"_ensureLookupCallExecuted",value:function(){return!!this.lookupCall&&!this._lookupExecuted&&(this._lookupByAll(),!0)}},{key:"_createLoadingSupport",value:function(){return new oe({widget:this,$container:function(){return this.$body}.bind(this)})}},{key:"_lookupByAll",value:function(){if(this.lookupCall){this._clearPendingLookup();var e=s.a.Deferred(),t=function(t){this._lookupByAllDone(t),e.resolve(t)}.bind(this);return this._executeLookup(this.lookupCall.cloneForAll(),!0).done(t),e.promise()}}},{key:"_clearPendingLookup",value:function(){this._pendingLookup&&(clearTimeout(this._pendingLookup),this._pendingLookup=null)}},{key:"_executeLookup",value:function(e,t){var n=this;return t&&this._currentLookupCall&&this._currentLookupCall.abort(),this._lookupInProgress=!0,this.setLoading(!0),this._currentLookupCall=e,this.trigger("prepareLookupCall",{lookupCall:e}),e.execute().always((function(){n._lookupInProgress=!1,n._lookupExecuted=!0,n._currentLookupCall=null,n.setLoading(!1),n._clearLookupStatus()}))}},{key:"_lookupByAllDone",value:function(e){try{if(e.exception)return void this.setErrorStatus(Br.error({message:e.exception}));if(0===e.lookupRows.length)return void this.setLookupStatus(Br.warning({message:this.session.text("SmartFieldNoDataFound"),code:i.ErrorCode.NO_DATA}));this._populateRadioButtonGroup(e)}finally{this.trigger("lookupCallDone",{result:e})}}},{key:"_populateRadioButtonGroup",value:function(e){var t=e.lookupRows,n=this.fields.slice();t.forEach((function(e){n.push(this._createLookupRowRadioButton(e))}),this),this.setFields(n),this.setValue(this.value),this.selectButton(this.getButtonForRadioValue(this.value))}},{key:"_clearLookupStatus",value:function(){this.setLookupStatus(null)}},{key:"setLookupStatus",value:function(e){this.setProperty("lookupStatus",e),this.rendered&&this._renderErrorStatus()}},{key:"_errorStatus",value:function(){return this.lookupStatus||this.errorStatus}},{key:"_createLookupRowRadioButton",value:function(e){var t={parent:this,label:e.text,radioValue:e.key,lookupRow:e};return e.iconId&&(t.iconId=e.iconId),e.tooltipText&&(t.tooltipText=e.tooltipText),e.backgroundColor&&(t.backgroundColor=e.backgroundColor),e.foregroundColor&&(t.foregroundColor=e.foregroundColor),e.font&&(t.font=e.font),!1===e.enabled&&(t.enabled=!1),!1===e.active&&(t.visible=!1),e.cssClass&&(t.cssClass=e.cssClass),O.create("RadioButton",t)}},{key:"clone",value:function(e,t){var n=l1(p1(i.prototype),"clone",this).call(this,e,t);return this._deepCloneProperties(n,"fields",t),n._initButtons(),n}}])&&a1(t.prototype,n),r&&a1(t,r),i}(Qz);function v1(e){return(v1="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function b1(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function m1(e,t,n){return(m1="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=k1(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function g1(e,t){return(g1=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function _1(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=k1(e);if(t){var o=k1(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return w1(this,n)}}function w1(e,t){return!t||"object"!==v1(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function k1(e){return(k1=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}d1(y1,"DEFAULT_GRID_COLUMN_COUNT",-1),d1(y1,"ErrorCode",{NO_DATA:1});var S1=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&g1(e,t)}(i,e);var t,n,r,o=_1(i);function i(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),o.call(this)}return t=i,(n=[{key:"_initModel",value:function(e,t){return(e=m1(k1(i.prototype),"_initModel",this).call(this,e,t)).logicalGrid=null,e}}])&&b1(t.prototype,n),r&&b1(t,r),i}(aG);function O1(e){return(O1="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function T1(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function C1(e,t){return(C1=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function P1(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=x1(e);if(t){var o=x1(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return R1(this,n)}}function R1(e,t){return!t||"object"!==O1(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function x1(e){return(x1=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var E1=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&C1(e,t)}(i,e);var t,n,r,o=P1(i);function i(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),o.call(this)}return t=i,(n=[{key:"getGridColumnCount",value:function(){return this.widget.gridColumnCount}},{key:"getGridWidgets",value:function(){return this.widget.fields}}])&&T1(t.prototype,n),r&&T1(t,r),i}(aa);function D1(e){return(D1="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function A1(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function F1(e,t,n){return(F1="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=M1(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function $1(e,t){return($1=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function j1(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=M1(e);if(t){var o=M1(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return B1(this,n)}}function B1(e,t){return!t||"object"!==D1(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function M1(e){return(M1=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var I1=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&$1(e,t)}(i,e);var t,n,r,o=j1(i);function i(e,t){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),o.call(this,e,t)}return t=i,(n=[{key:"_initDefaults",value:function(){F1(M1(i.prototype),"_initDefaults",this).call(this),this.hgap=Xs.get().smallColumnGap}}])&&A1(t.prototype,n),r&&A1(t,r),i}(ba);function L1(e){return(L1="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function H1(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function N1(e,t){return(N1=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function V1(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=z1(e);if(t){var o=z1(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return W1(this,n)}}function W1(e,t){return!t||"object"!==L1(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function z1(e){return(z1=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var G1=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&N1(e,t)}(i,e);var t,n,r,o=V1(i);function i(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(t=o.call(this)).field=e,t.which=[Ou.LEFT,Ou.UP],t.renderingHints.render=!1,t}return t=i,(n=[{key:"handle",value:function(e){var t,n=s()(e.target).data("radiobutton");this.field.radioButtons.some((function(e){return t&&e===n?(t.select(),t.focus(),!0):(e.enabledComputed&&e.visible&&(t=e),!1)}),this)}}])&&H1(t.prototype,n),r&&H1(t,r),i}(zu);function U1(e){return(U1="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function K1(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function q1(e,t){return(q1=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Y1(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=J1(e);if(t){var o=J1(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return X1(this,n)}}function X1(e,t){return!t||"object"!==U1(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function J1(e){return(J1=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Z1=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&q1(e,t)}(i,e);var t,n,r,o=Y1(i);function i(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(t=o.call(this)).field=e,t.which=[Ou.RIGHT,Ou.DOWN],t.renderingHints.render=!1,t}return t=i,(n=[{key:"handle",value:function(e){var t,n=s()(e.target).data("radiobutton");this.field.radioButtons.some((function(e){return t&&e.enabledComputed&&e.visible?(e.select(),e.focus(),!0):(e===n&&e.enabledComputed&&e.visible&&(t=e),!1)}),this)}}])&&K1(t.prototype,n),r&&K1(t,r),i}(zu);function Q1(e){return(Q1="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function e2(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function t2(e,t,n){return(t2="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=i2(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function n2(e,t){return(n2=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function r2(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=i2(e);if(t){var o=i2(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return o2(this,n)}}function o2(e,t){return!t||"object"!==Q1(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function i2(e){return(i2=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var s2=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&n2(e,t)}(i,e);var t,n,r,o=r2(i);function i(e,t){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(n=o.call(this,e,t)).renderingHints.hAlign=Do.LEFT,n}return t=i,(n=[{key:"_accept",value:function(e){return t2(i2(i.prototype),"_accept",this).call(this,e)&&!this.field.selected}}])&&e2(t.prototype,n),r&&e2(t,r),i}(kq);function a2(e){return(a2="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function l2(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function u2(e,t,n){return(u2="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=p2(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function c2(e,t){return(c2=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function f2(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=p2(e);if(t){var o=p2(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return h2(this,n)}}function h2(e,t){return!t||"object"!==a2(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function p2(e){return(p2=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var d2=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&c2(e,t)}(i,e);var t,n,r,o=f2(i);function i(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(e=o.call(this))._addWidgetProperties("fields"),e._addCloneProperties(["layoutConfig"]),e.logicalGrid=O.create("scout.HorizontalGrid"),e.layoutConfig=null,e.fields=[],e}return t=i,(n=[{key:"_init",value:function(e){u2(p2(i.prototype),"_init",this).call(this,e),this._setLayoutConfig(this.layoutConfig),this._initDateFields(),this.setErrorStatus(this.errorStatus),this.setTooltipText(this.tooltipText),this.setMenus(this.menus),this.setMenusVisible(this.menusVisible)}},{key:"_initDateFields",value:function(){for(var e=this._getDateFields(),t=null,n=0;n<e.length;n++){var r=e[n];r.autoDate&&(r.hasModelAutoDateSet=!0),r.hasModelAutoDateSet||r.setAutoDate(t),t=this._getAutoDateProposal(r)}}},{key:"_render",value:function(){var e,t;for(this.addContainer(this.$parent,"sequence-box"),this.addLabel(),this.addField(this.$parent.makeDiv()),this.addStatus(),this._handleStatus(),this.htmlBody=ea.install(this.$field,this.session),this.htmlBody.setLayout(this._createBodyLayout()),t=0;t<this.fields.length;t++)(e=this.fields[t]).labelUseUiWidth=!0,e.on("propertyChange",this._onFieldPropertyChange.bind(this)),e.render(this.$field),this._modifyLabel(e),e.setLayoutData(new ua(e))}},{key:"_renderProperties",value:function(){u2(p2(i.prototype),"_renderProperties",this).call(this),this._renderLayoutConfig()}},{key:"_createBodyLayout",value:function(){return new x2(this,this.layoutConfig)}},{key:"invalidateLogicalGrid",value:function(e){u2(p2(i.prototype),"invalidateLogicalGrid",this).call(this,!1),O.nvl(e,!0)&&this.rendered&&this.htmlBody.invalidateLayoutTree()}},{key:"_setLogicalGrid",value:function(e){u2(p2(i.prototype),"_setLogicalGrid",this).call(this,e),this.logicalGrid&&this.logicalGrid.setGridConfig(new w2)}},{key:"setLayoutConfig",value:function(e){this.setProperty("layoutConfig",e)}},{key:"_setLayoutConfig",value:function(e){e||(e=new ga),this._setProperty("layoutConfig",ga.ensure(e))}},{key:"_renderLayoutConfig",value:function(){this.layoutConfig.applyToLayout(this.htmlBody.layout),this.rendered&&this.htmlBody.invalidateLayoutTree()}},{key:"_onFieldPropertyChange",value:function(e){var t="visible"===e.propertyName;O.isOneOf(e.propertyName,["errorStatus","tooltipText","visible","menus","menusVisible"])&&this._handleStatus(t),"value"===e.propertyName&&this._onFieldValueChange(e)}},{key:"_handleStatus",value:function(e){e&&this._lastVisibleField&&(this._lastVisibleField.setSuppressStatus(null),this._lastVisibleField.rendered&&(this._lastVisibleField._renderErrorStatus(),this._lastVisibleField._renderTooltipText(),this._lastVisibleField._renderMenus())),this._lastVisibleField=this._getLastVisibleField(),this._lastVisibleField&&(this._isOverwritingStatusFromField=!0,this._lastVisibleField.errorStatus?(this.setErrorStatus(this._lastVisibleField.errorStatus),this._isErrorStatusOverwritten=!0):(this.setErrorStatus(this.boxErrorStatus),this._isErrorStatusOverwritten=!1),this._lastVisibleField.hasStatusTooltip()?(this.setTooltipText(this._lastVisibleField.tooltipText),this._isTooltipTextOverwritten=!0):(this.setTooltipText(this.boxTooltipText),this._isTooltipTextOverwritten=!1),this._lastVisibleField.menus&&this._lastVisibleField.menus.length>0?(this._updateBoxMenuOwner(this.fieldStatus),this.setMenus(this._lastVisibleField.menus),this.setMenusVisible(this._lastVisibleField.menusVisible),this._isMenusOverwritten=!0):(this._updateBoxMenuOwner(this),this.setMenus(this.boxMenus),this.setMenusVisible(this.boxMenusVisible),this._isMenusOverwritten=!1),this._isOverwritingStatusFromField=!1,this._lastVisibleField.setSuppressStatus(ZW.SuppressStatus.ICON),e&&this._lastVisibleField.rendered&&(this._lastVisibleField._renderErrorStatus(),this._lastVisibleField._renderTooltipText(),this._lastVisibleField._renderMenus()))}},{key:"setErrorStatus",value:function(e){this._isOverwritingStatusFromField&&!this._isErrorStatusOverwritten?this.boxErrorStatus=this.errorStatus:this._isOverwritingStatusFromField||(this.boxErrorStatus=e),!this._isOverwritingStatusFromField&&this._isErrorStatusOverwritten||u2(p2(i.prototype),"setErrorStatus",this).call(this,e)}},{key:"setTooltipText",value:function(e){this._isOverwritingStatusFromField&&!this._isTooltipTextOverwritten?this.boxTooltipText=this.tooltipText:this._isOverwritingStatusFromField||(this.boxTooltipText=e),!this._isOverwritingStatusFromField&&this._isTooltipTextOverwritten||u2(p2(i.prototype),"setTooltipText",this).call(this,e)}},{key:"setMenus",value:function(e){e=this._createChildren(e),this._isOverwritingStatusFromField&&!this._isMenusOverwritten?this.boxMenus=this.menus:this._isOverwritingStatusFromField||(this.boxMenus=e),!this._isOverwritingStatusFromField&&this._isMenusOverwritten||u2(p2(i.prototype),"setMenus",this).call(this,e)}},{key:"_updateBoxMenuOwner",value:function(e){this.boxMenus.forEach((function(t){t.setOwner(e)}))}},{key:"setMenusVisible",value:function(e){this._isOverwritingStatusFromField&&!this._isMenusOverwritten?this.boxMenusVisible=this.menusVisible:this._isOverwritingStatusFromField||(this.boxMenusVisible=e),!this._isOverwritingStatusFromField&&this._isMenusOverwritten||u2(p2(i.prototype),"setMenusVisible",this).call(this,e)}},{key:"_getLastVisibleField",value:function(){var e=this.fields.filter((function(e){return e.visible}));if(0!==e.length)return e[e.length-1]}},{key:"_onFieldValueChange",value:function(e){e.source instanceof eX&&this._onDateFieldValueChange(e)}},{key:"_onDateFieldValueChange",value:function(e){for(var t=e.source,n=this._getDateFields(),r=this._getAutoDateProposal(t),o=n.indexOf(t)+1;o<n.length;o++){var i=n[o];if(i.hasModelAutoDateSet||i.setAutoDate(r),i.value)break}}},{key:"_getDateFields",value:function(){return this.fields.filter((function(e){return e instanceof eX}))}},{key:"_getAutoDateProposal",value:function(e){var t=null;return e&&e.value&&(t=!e.hasDate&&e.hasTime?Et.shiftTime(e.value,1,0,0):Et.shift(e.value,0,0,1)),t}},{key:"_modifyLabel",value:function(e){e instanceof Jq&&(e.labelVisible=!1),e instanceof eX?(e.$dateField&&this._linkWithLabel(e.$dateField),e.$timeField&&this._linkWithLabel(e.$timeField)):e.$field&&this._linkWithLabel(e.$field)}},{key:"setFields",value:function(e){if(this.rendered)throw new Error("Setting fields is not supported if sequence box is already rendered.");this.setProperty("fields",e)}},{key:"getFields",value:function(){return this.fields}},{key:"clone",value:function(e,t){var n=u2(p2(i.prototype),"clone",this).call(this,e,t);return this._deepCloneProperties(n,"fields",t),n}}])&&l2(t.prototype,n),r&&l2(t,r),i}(Iz);function y2(e){return(y2="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function v2(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function b2(e,t){return(b2=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function m2(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=_2(e);if(t){var o=_2(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return g2(this,n)}}function g2(e,t){return!t||"object"!==y2(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function _2(e){return(_2=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var w2=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&b2(e,t)}(i,e);var t,n,r,o=m2(i);function i(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),o.call(this)}return t=i,(n=[{key:"getGridColumnCount",value:function(){return this.widget.fields.length}},{key:"getGridWidgets",value:function(){return this.widget.fields}}])&&v2(t.prototype,n),r&&v2(t,r),i}(aa);function k2(e){return(k2="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function S2(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function O2(e,t,n){return(O2="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=R2(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function T2(e,t){return(T2=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function C2(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=R2(e);if(t){var o=R2(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return P2(this,n)}}function P2(e,t){return!t||"object"!==k2(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function R2(e){return(R2=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var x2=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&T2(e,t)}(i,e);var t,n,r,o=C2(i);function i(e,t){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),o.call(this,e,t)}return t=i,(n=[{key:"_initDefaults",value:function(){O2(R2(i.prototype),"_initDefaults",this).call(this),this.hgap=Xs.get().smallColumnGap}}])&&S2(t.prototype,n),r&&S2(t,r),i}(ba);function E2(e){return(E2="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function D2(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function A2(e,t,n){return(A2="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=B2(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function F2(e,t){return(F2=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function $2(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=B2(e);if(t){var o=B2(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return j2(this,n)}}function j2(e,t){return!t||"object"!==E2(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function B2(e){return(B2=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var M2=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&F2(e,t)}(i,e);var t,n,r,o=$2(i);function i(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),o.call(this)}return t=i,(n=[{key:"_initModel",value:function(e,t){return(e=A2(B2(i.prototype),"_initModel",this).call(this,e,t)).logicalGrid=null,e}}])&&D2(t.prototype,n),r&&D2(t,r),i}(zz);function I2(e){return(I2="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function L2(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function H2(e,t,n){return(H2="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=z2(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function N2(e,t){return(N2=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function V2(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=z2(e);if(t){var o=z2(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return W2(this,n)}}function W2(e,t){return!t||"object"!==I2(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function z2(e){return(z2=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var G2=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&N2(e,t)}(i,e);var t,n,r,o=V2(i);function i(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(e=o.call(this)).slider,e}return t=i,(n=[{key:"_init",value:function(e){H2(z2(i.prototype),"_init",this).call(this,e);var t=s.a.extend({parent:this},e);this.slider=O.create("Slider",t)}},{key:"_render",value:function(){this.addContainer(this.$parent,"slider-field"),this.addLabel(),this.addMandatoryIndicator(),this._renderSlider()}},{key:"_renderSlider",value:function(){this.slider.render(),this.addField(this.slider.$container)}},{key:"_readDisplayText",value:function(){return String(this.slider.value)}},{key:"_parseValue",value:function(e){return Number(e)}},{key:"setValue",value:function(e){this.slider.setValue(e)}},{key:"getValue",value:function(){return this.slider.value}}])&&L2(t.prototype,n),r&&L2(t,r),i}(Qz);function U2(e){return(U2="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function K2(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function q2(e,t,n){return(q2="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Z2(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function Y2(e,t){return(Y2=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function X2(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Z2(e);if(t){var o=Z2(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return J2(this,n)}}function J2(e,t){return!t||"object"!==U2(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Z2(e){return(Z2=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Q2(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var e3=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Y2(e,t)}(i,e);var t,n,r,o=X2(i);function i(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(e=o.call(this)).popup=null,e.lookupCall=null,e.codeType=null,e._pendingLookup=null,e._pendingOpenPopup=!1,e._tabPrevented=null,e.lookupRow=null,e.browseHierarchy=!1,e.browseMaxRowCount=i.DEFAULT_BROWSE_MAX_COUNT,e.browseAutoExpandAll=!0,e.browseLoadIncremental=!1,e.searchRequired=!1,e.activeFilterEnabled=!1,e.activeFilter=null,e.activeFilterLabels=[],e.columnDescriptors=null,e.displayStyle=i.DisplayStyle.DEFAULT,e.touchMode=!1,e.embedded=!1,e._userWasTyping=!1,e._acceptInputEnabled=!0,e._acceptInputDeferred=s.a.Deferred(),e._notUnique=!1,e._lastSearchText=null,e.lookupStatus=null,e._currentLookupCall=null,e.lookupSeqNo=0,e.initActiveFilter=null,e.disabledCopyOverlay=!0,e._addCloneProperties(["lookupRow","codeType","lookupCall","activeFilter","activeFilterEnabled","activeFilterLabels","browseHierarchy","browseMaxRowCount","browseAutoExpandAll","browseLoadIncremental","searchRequired","columnDescriptors","displayStyle"]),e}return t=i,(n=[{key:"_init",value:function(e){q2(Z2(i.prototype),"_init",this).call(this,e),0===this.activeFilterLabels.length&&(this.activeFilterLabels=[this.session.text("ui.All"),this.session.text("ui.Inactive"),this.session.text("ui.Active")]),TW.initTouch(this,e)}},{key:"_initValue",value:function(e){this._setLookupCall(this.lookupCall),this._setCodeType(this.codeType),this._setLookupRow(this.lookupRow),q2(Z2(i.prototype),"_initValue",this).call(this,e)}},{key:"markAsSaved",value:function(){q2(Z2(i.prototype),"markAsSaved",this).call(this),this.setInitActiveFilter(this.activeFilter)}},{key:"resetValue",value:function(){q2(Z2(i.prototype),"resetValue",this).call(this),this.setActiveFilter(this.initActiveFilter)}},{key:"_createKeyStrokeContext",value:function(){return new Vu}},{key:"_initKeyStrokeContext",value:function(){q2(Z2(i.prototype),"_initKeyStrokeContext",this).call(this),this.keyStrokeContext.registerKeyStroke(new T3(this))}},{key:"_render",value:function(){this.addContainer(this.$parent,"has-icon "+this.cssClassName(),new v3(this)),this.addLabel();var e=(this.isDropdown()?TW.makeInputDiv:TW.makeInputOrDiv).call(O.fields,this).on("mousedown",this._onFieldMouseDown.bind(this));this.touchMode||e.keyup(this._onFieldKeyUp.bind(this)).keydown(this._onFieldKeyDown.bind(this)).on("input",this._onFieldInput.bind(this)),this.addField(e),this.embedded||this.addMandatoryIndicator(),this.addIcon(),this.$icon.addClass("needsclick"),this.addStatus()}},{key:"_renderGridData",value:function(){q2(Z2(i.prototype),"_renderGridData",this).call(this),this.updateInnerAlignment({useHorizontalAlignment:!this.browseHierarchy})}},{key:"_renderGridDataHints",value:function(){q2(Z2(i.prototype),"_renderGridDataHints",this).call(this),this.updateInnerAlignment({useHorizontalAlignment:!this.browseHierarchy})}},{key:"cssClassName",value:function(){var e=this.displayStyle;return this.displayStyle===i.DisplayStyle.DEFAULT&&(e="smart"),e+"-field"}},{key:"_readSearchText",value:function(){var e=this._readDisplayText(),t=O.nvl(this.displayText,"").split("\n");return 1===t.length||Wn.empty(e)?e:(t.shift(),rt.insert(t,e,0),Wn.join("\n",t))}},{key:"_readDisplayText",value:function(){return TW.valOrText(this.$field)}},{key:"_renderDisplayText",value:function(){var e=O.nvl(this.displayText,""),t=e.split("\n");t.length&&(e=t[0]),TW.valOrText(this.$field,e),q2(Z2(i.prototype),"_renderDisplayText",this).call(this)}},{key:"acceptInput",value:function(e){var t=this;if(!this._acceptInputEnabled)return s.a.log.isTraceEnabled()&&s.a.log.trace("(SmartField#acceptInput) Skipped acceptInput because _acceptInputEnabled=false"),this._acceptInputDeferred.promise();this._acceptInputEnabled=!1,setTimeout((function(){t._acceptInputEnabled=!0}));var n=this._readSearchText(),r=Wn.empty(n),o=this._checkSearchTextChanged(n),i=this._getSelectedLookupRow(o);return this._setProperty("displayText",n),this._acceptInputDeferred=s.a.Deferred(),this._flushLookupStatus(),this._clearPendingLookup(),this.touchMode?(s.a.log.isDebugEnabled()&&s.a.log.debug("(SmartField#acceptInput) Always send acceptInput for touch field"),void this._inputAccepted()):this._acceptInput(e,n,r,o,i)}},{key:"_getSelectedLookupRow",value:function(e){return!this.isPopupOpen()||e&&this._userWasTyping?null:this.lookupSeqNo===this.popup.lookupResult.seqNo?this.popup.getSelectedLookupRow():null}},{key:"_checkSearchTextChanged",value:function(e){return!(this.isDropdown()||!this._userWasTyping||this._searchTextEquals(e,this._lastSearchText))}},{key:"_searchTextEquals",value:function(e,t){var n=Wn.nullIfEmpty(this._firstTextLine(e)),r=Wn.nullIfEmpty(t);return Wn.equalsIgnoreCase(n,r)}},{key:"_clearPendingLookup",value:function(){this._pendingLookup&&(clearTimeout(this._pendingLookup),this._pendingLookup=null)}},{key:"_acceptInput",value:function(e,t,n,r,o){return!o&&this.lookupRow&&Wn.nvl(this.lookupRow.text)===t?(s.a.log.isDebugEnabled()&&s.a.log.debug("(SmartField#_acceptInput) unchanged: text is equals. Close popup"),this._clearLookupStatus(),void this._inputAccepted(!1)):(this._notUnique&&!n&&this._setNotUniqueError(t),o||this.lookupRow||!n?!o&&n?(s.a.log.isDebugEnabled()&&s.a.log.debug("(SmartField#_acceptInput) empty. Set lookup-row to null, close popup"),this._clearLookupStatus(),this.setLookupRow(null),void this._inputAccepted()):o?(s.a.log.isDebugEnabled()&&s.a.log.debug("(SmartField#_acceptInput) lookup-row selected. Set lookup-row, close popup lookupRow=",o.toString()),this._clearLookupStatus(),this.setLookupRow(o),void this._inputAccepted()):(r||this._userWasTyping?this._acceptByText(e,this._firstTextLine(t)):this._hasUiError()?this._hasNotUniqueError()&&this.popup?this.popup.selectFirstLookupRow():this._acceptInputDeferred.resolve():this._inputAccepted(!1),this._acceptInputDeferred.promise()):(s.a.log.isDebugEnabled()&&s.a.log.debug("(SmartField#_acceptInput) unchanged: text is empty. Close popup"),this._clearLookupStatus(),this.errorStatus&&this.errorStatus.code===i.ErrorCode.NO_RESULTS&&this.clearErrorStatus(),void this._inputAccepted(r||this._userWasTyping)))}},{key:"_firstTextLine",value:function(e){return Wn.empty(e)?e:e.split("\n")[0]}},{key:"_acceptByText",value:function(e,t){e=O.nvl(e,!1),s.a.log.isDebugEnabled()&&s.a.log.debug("(SmartField#_acceptByText) sync="+e+" searchText=",t),e?this._acceptByTextSync(t):this._acceptByTextAsync(t)}},{key:"_acceptByTextSync",value:function(e){this._lastSearchText=null,this._inputAccepted(),this._hasUiError()||this.resetDisplayText()}},{key:"_acceptByTextAsync",value:function(e){this._lastSearchText=e,this._executeLookup(this.lookupCall.cloneForText(e),!0).done(this._acceptByTextDone.bind(this)).done(this._triggerLookupCallDone.bind(this)),this._triggerAcceptByText(e)}},{key:"_inputAccepted",value:function(e,t){e=O.nvl(e,!0),t=O.nvl(t,!0),this.embedded||this.closePopup(),this._userWasTyping=!1,e&&this._triggerAcceptInput(t),this._focusNextTabbable(),this._acceptInputDeferred.resolve()}},{key:"_focusNextTabbable",value:function(){if(this._tabPrevented){var e=this.entryPoint().find(":tabbable"),t=this._tabPrevented.shiftKey?-1:1,n=e.index(this.$field),r=n+t;r<0?r=e.length-1:r>=e.length&&(r=0),s.a.log.isDebugEnabled()&&s.a.log.debug("(SmartField#_inputAccepted) tab-index="+n+" next tab-index="+r);var o=e.eq(r).focus();Pr.isFunction(o[0].select)&&o[0].select(),this._tabPrevented=null}}},{key:"_acceptByTextDone",value:function(e){if(this._userWasTyping=!1,this._extendResult(e),this._notUnique=e.numLookupRows>1,e.uniqueMatch){var t=e.uniqueMatch;this._isLookupRowActive(t)?(this.setLookupRow(t),this._inputAccepted()):this.setErrorStatus(Br.error({message:this.session.text("SmartFieldInactiveRow",e.text)}))}else this._acceptInputFail(e)}},{key:"_extendResult",value:function(e){e.seqNo=this.lookupSeqNo,e.uniqueMatch=null;var t="by"+Wn.toUpperCaseFirstLetter(e.queryBy.toLowerCase());if(e[t]=!0,this.browseHierarchy){var n=O.create("TreeProposalChooser",{parent:this,smartField:this});n.setLookupResult(e);var r=n.findLeafs();e.numLookupRows=r.length,1===e.numLookupRows&&(e.uniqueMatch=r[0].lookupRow)}else e.numLookupRows=e.lookupRows.length,1===e.numLookupRows&&(e.uniqueMatch=e.lookupRows[0]);e.empty=0===e.numLookupRows}},{key:"_acceptInputFail",value:function(e){var t=e.text;e.empty&&(this.embedded||this.closePopup(),this.setValue(null),this.setDisplayText(t),this.setErrorStatus(Br.error({message:this.session.text("SmartFieldCannotComplete",t),code:i.ErrorCode.NO_RESULTS}))),e.numLookupRows>1&&(this.setValue(null),this.setDisplayText(t),this._setNotUniqueError(t),this.isPopupOpen()?this.popup.setLookupResult(e):this._lookupByTextOrAllDone(e),this.isPopupOpen()&&this.popup.selectFirstLookupRow()),this._acceptInputDeferred.resolve(),this._triggerAcceptInputFail()}},{key:"lookupByRec",value:function(e){var t=this;return s.a.log.isDebugEnabled()&&s.a.log.debug("(SmartField#lookupByRec) rec=",e),this._lastSearchText=null,this._executeLookup(this.lookupCall.cloneForRec(e)).then((function(n){n.appendResult=!0,n.rec=e,t.isPopupOpen()&&t.popup.setLookupResult(n)})).then(this._triggerLookupCallDone.bind(this))}},{key:"_isLookupRowActive",value:function(e){return!!e.enabled&&(!this.activeFilterEnabled||("TRUE"===this.activeFilter?e.active:"FALSE"!==this.activeFilter||!e.active))}},{key:"_renderEnabled",value:function(){q2(Z2(i.prototype),"_renderEnabled",this).call(this),this.$field.setTabbable(this.enabledComputed)}},{key:"setLookupCall",value:function(e){this.setProperty("lookupCall",e)}},{key:"_setLookupCall",value:function(e){this._setProperty("lookupCall",ri.ensure(e,this.session))}},{key:"_setCodeType",value:function(e){if(this._setProperty("codeType",e),e){var t=O.create("CodeLookupCall",{session:this.session,codeType:e});this.setProperty("lookupCall",t)}}},{key:"_formatValue",value:function(e){return Pr.isNullOrUndefined(e)?"":this.lookupRow?this._formatLookupRow(this.lookupRow):(this._lastSearchText=null,this._executeLookup(this.lookupCall.cloneForKey(e),!0).then(this._lookupByKeyDone.bind(this)).then(this._triggerLookupCallDone.bind(this)))}},{key:"_lookupByKeyDone",value:function(e){this._notUnique=!1;var t=ri.firstLookupRow(e);return this.setLookupRow(t),this._formatLookupRow(t)}},{key:"_formatLookupRow",value:function(e){return e?e.text:""}},{key:"openPopup",value:function(e){var t=this._readDisplayText(),n=!!this.searchRequired||null;return s.a.log.isInfoEnabled()&&s.a.log.info("SmartField#openPopup browse="+e+" searchText="+t+" popup="+this.popup+" pendingOpenPopup="+this._pendingOpenPopup),this._tabPrevented=null,this._pendingOpenPopup=!0,Wn.empty(t)?e=!0:this.errorStatus&&(this._hasNotUniqueError()?(n=!0,e=!1):this.searchRequired||(e=!0)),this._lookupByTextOrAll(e,t,n)}},{key:"_hasUiError",value:function(e){var t=this._errorStatus();if(!t)return!1;e=e?rt.ensure(e):[i.ErrorCode.NO_RESULTS,i.ErrorCode.NOT_UNIQUE];var n=Br.asFlatList(t).reduce((function(e,t){return t.code&&-1===e.indexOf(t.code)&&e.push(t.code),e}),[]);return e.some((function(e){return n.indexOf(e)>-1}))}},{key:"_lookupByTextOrAll",value:function(e,t,n){var r=this;if(t=O.nvl(t,this._readDisplayText()),e=O.nvl(e,Wn.empty(t)),n=O.nvl(n,!1),this.isDropdown()&&(e=!0),!e&&!n){var o=null;if(o=this._lastSearchText?this._lastSearchText:this._getLastSearchText(),this._searchTextEquals(t,o))return this._pendingOpenPopup=!1,void s.a.log.debug("(SmartField#_lookupByTextOrAll) searchText is equals -> skip lookup")}this._clearPendingLookup();var a=s.a.Deferred(),l=function(e){this._lookupByTextOrAllDone(e),a.resolve(e)}.bind(this);return e?(s.a.log.isDebugEnabled()&&s.a.log.debug("(SmartField#_lookupByTextOrAll) lookup byAll (searchText empty)"),this._lastSearchText=null,this.searchRequired?(l({queryBy:Si.TEXT,lookupRows:[]}),this.setLookupStatus(Br.warning({message:this.session.text("TooManyRows"),code:i.ErrorCode.SEARCH_REQUIRED}))):this._executeLookup(this.lookupCall.cloneForAll(),!0).done(l).done(this._triggerLookupCallDone.bind(this))):this._pendingLookup=setTimeout((function(){s.a.log.isDebugEnabled()&&s.a.log.debug("(SmartField#_lookupByTextOrAll) lookup byText searchText="+t),r._lastSearchText=t,r._executeLookup(r.lookupCall.cloneForText(t),!0).done(l).done(r._triggerLookupCallDone.bind(r))}),i.DEBOUNCE_DELAY),a.promise()}},{key:"_getLastSearchText",value:function(){return Pr.optProperty(this.lookupRow,"text")}},{key:"_lookupByTextOrAllDone",value:function(e){if(this._extendResult(e),this._notUnique=!e.byAll&&e.numLookupRows>1,!this._handleException(e))if(this.rendered&&(this.isFocused()||this.isTouchable())){if(e.empty&&e.byAll)return this.activeFilterEnabled?this._ensurePopup(e):this.closePopup(),void this.setLookupStatus(Br.warning({message:this.session.text("SmartFieldNoDataFound"),code:i.ErrorCode.NO_DATA}));if(e.empty)return this._handleEmptyResult(),void this.setLookupStatus(Br.warning({message:this.session.text("SmartFieldCannotComplete",e.text),code:i.ErrorCode.NO_RESULTS}));var t=null;e.numLookupRows>this.browseMaxRowCount&&(e.lookupRows=e.lookupRows.slice(0,this.browseMaxRowCount),t=Br.info({message:this.session.text("SmartFieldMoreThanXRows",this.browseMaxRowCount)})),this._ensurePopup(e,t)}else this.closePopup()}},{key:"_ensurePopup",value:function(e,t){this.popup?(this.popup.setLookupResult(e),this.popup.setStatus(t)):this._renderPopup(e,t)}},{key:"_handleException",value:function(e){return!!e.exception&&(this.setErrorStatus(Br.error({message:e.exception})),this.closePopup(),!0)}},{key:"_handleEmptyResult",value:function(){this.touchMode||this.activeFilterEnabled?this._ensurePopup({lookupRows:[]}):this.embedded?this.popup.clearLookupRows():this.closePopup()}},{key:"_renderPopup",value:function(e,t){var n=this;this.$field.addClass("focused"),this.$container.addClass("popup-open");var r=this.touchMode&&!this.isDropdown(),o=r?"SmartFieldTouchPopup":"SmartFieldPopup";this._pendingOpenPopup=!1,this.popup=O.create(o,{parent:this,$anchor:this.$field,boundToAnchor:!r,closeOnAnchorMouseDown:!1,field:this,lookupResult:e,status:t}),this.popup.open();var i=r?this.popup._field:this;this.popup.on("lookupRowSelected",i._onLookupRowSelected.bind(i)),this.popup.on("activeFilterSelected",this._onActiveFilterSelected.bind(this)),this.popup.one("remove",(function(){n.popup=null,n.rendered&&(n.$container.removeClass("popup-open"),n.$field.removeClass("focused"),n._renderErrorStatus())}))}},{key:"closePopup",value:function(){this._pendingOpenPopup=!1,this.popup&&this.popup.close()}},{key:"aboutToBlurByMouseDown",value:function(e){if(this.touchMode)return!1;TW.eventOutsideProposalField(this,e)&&this.acceptInput(!0)}},{key:"_onFieldMouseDown",value:function(e){s.a.log.isDebugEnabled()&&s.a.log.debug("(SmartField#_onFieldMouseDown)"),this.activate(!0)}},{key:"activate",value:function(e){var t=this;this.enabledComputed&&this.rendered&&(this.isDropdown()||TW.handleOnClick(this)?(e&&!Kt.get().supportsOnlyTouch()||this.$field.focus(),this.togglePopup()):this.popup&&this.popup.removalPending&&this.popup.one("remove",(function(){t.rendered&&t.activate(e)})))}},{key:"_onIconMouseDown",value:function(e){s.a.log.isDebugEnabled()&&s.a.log.debug("(SmartField#_onIconMouseDown)"),this.enabledComputed&&(e.preventDefault(),this.$field.focus(),this.embedded||(this.isDropdown()?this.togglePopup():this.popup||this.openPopup(!this.searchRequired)))}},{key:"_onClearIconMouseDown",value:function(e){s.a.log.isDebugEnabled()&&s.a.log.debug("(SmartField#_onClearIconMouseDown)"),this.enabledComputed&&(e.preventDefault(),this.$field.focus(),this.clear())}},{key:"_clear",value:function(){this._tabPrevented=null,this._lastSearchText=this._readDisplayText(),this._userWasTyping=!0,TW.valOrText(this.$field,""),this.touchMode&&this.setValue(null),this.isPopupOpen()&&setTimeout(this._lookupByTextOrAll.bind(this,!0)),this._updateHasText()}},{key:"togglePopup",value:function(){s.a.log.isInfoEnabled()&&s.a.log.info("(SmartField#togglePopup) popupOpen=",this.isPopupOpen()),this.isPopupOpen()?this.closePopup():this.openPopup(!this.searchRequired)}},{key:"_onFieldBlur",value:function(e){this.setFocused(!1),this.setLoading(!1),this.isTouchable()||(this.acceptInput(!1),this.closePopup())}},{key:"isTouchable",value:function(){return this.embedded||this.touchMode}},{key:"_onFieldKeyUp",value:function(e){if(e.which!==Ou.ESC){var t=e.which,n=(e.ctrlKey||e.metaKey)&&t===Ou.V||e.shiftKey&&t===Ou.INSERT,r=(e.ctrlKey||e.metaKey)&&t===Ou.X||e.shiftKey&&t===Ou.DELETE;(!n&&!r||this.isDropdown())&&(e.ctrlKey||e.altKey||e.metaKey||t===Ou.ENTER||t===Ou.TAB||t===Ou.SHIFT||t===Ou.CTRL||t===Ou.ALT||t===Ou.HOME||t===Ou.END||t===Ou.LEFT||t===Ou.RIGHT||t===Ou.WIN_LEFT||t===Ou.WIN_RIGHT||t===Ou.SELECT||t===Ou.NUM_LOCK||t===Ou.CAPS_LOCK||t===Ou.SCROLL_LOCK||t===Ou.PAUSE||t===Ou.PRINT_SCREEN||this._isNavigationKey(e)||this._isFunctionKey(e))||this._handleInput()}}},{key:"_handleInput",value:function(){this._pendingOpenPopup||this.isPopupOpen()?this.isDropdown()||this._lookupByTextOrAll():this._pendingOpenPopup||this.openPopup()}},{key:"isPopupOpen",value:function(){return!(!this.popup||this.popup.removalPending)}},{key:"_onFieldKeyDown",value:function(e){if(this._updateUserWasTyping(e),e.which===Ou.TAB)return this.mode===ZW.Mode.DEFAULT&&(e.preventDefault(),e.stopPropagation(),s.a.log.isDebugEnabled()&&s.a.log.debug("(SmartField#_onFieldKeyDown) set _tabPrevented"),this._tabPrevented={shiftKey:e.shiftKey}),void this.acceptInput();if(e.which!==Ou.ENTER){var t=e.which;this.isDropdown()&&(e.ctrlKey||e.altKey||e.metaKey||t===Ou.ESC||t===Ou.SHIFT||t===Ou.CTRL||t===Ou.ALT||t===Ou.WIN_LEFT||t===Ou.WIN_RIGHT||t===Ou.SELECT||t===Ou.NUM_LOCK||t===Ou.CAPS_LOCK||t===Ou.SCROLL_LOCK||t===Ou.PAUSE||t===Ou.PRINT_SCREEN||this._isFunctionKey(e))||(this._isNavigationKey(e)||this.isDropdown())&&(this.isPopupOpen()?this.popup.delegateKeyEvent(e):this._pendingOpenPopup||this.openPopup(!this.searchRequired),e.stopPropagation(),e.preventDefault())}else this._handleEnterKey(e)}},{key:"_onFieldInput",value:function(){this._updateHasText(),Kt.get().isInternetExplorer()||this._userWasTyping||(this.isFocused()||this.focus(),this._handleInput())}},{key:"_updateUserWasTyping",value:function(e){var t=e.which,n=(e.ctrlKey||e.metaKey)&&t===Ou.V||e.shiftKey&&t===Ou.INSERT,r=(e.ctrlKey||e.metaKey)&&t===Ou.X||e.shiftKey&&t===Ou.DELETE;(!n&&!r||this.isDropdown())&&(e.ctrlKey||e.altKey||e.metaKey||t===Ou.ESC||t===Ou.TAB||t===Ou.SHIFT||t===Ou.CTRL||t===Ou.ALT||t===Ou.HOME||t===Ou.END||t===Ou.LEFT||t===Ou.RIGHT||t===Ou.WIN_LEFT||t===Ou.WIN_RIGHT||t===Ou.SELECT||t===Ou.NUM_LOCK||t===Ou.CAPS_LOCK||t===Ou.SCROLL_LOCK||t===Ou.PAUSE||t===Ou.PRINT_SCREEN||this._isFunctionKey(e))||(this._userWasTyping=!(this._isNavigationKey(e)||t===Ou.ENTER))}},{key:"_isNavigationKey",value:function(e){var t=[Ou.PAGE_UP,Ou.PAGE_DOWN,Ou.UP,Ou.DOWN];return this.isDropdown()&&(t.push(Ou.HOME),t.push(Ou.END)),O.isOneOf(e.which,t)}},{key:"_handleEnterKey",value:function(e){this.isPopupOpen()&&(this.popup.selectLookupRow(),e.stopPropagation())}},{key:"_isFunctionKey",value:function(e){return e.which>=Ou.F1&&e.which<=Ou.F12}},{key:"_onLookupRowSelected",value:function(e){this._clearPendingLookup();var t=this.original()._currentLookupCall;t&&(t.abort(),this.original()._currentLookupCall=null,this.setLoading(!1)),this.setLookupRow(e.lookupRow),this._inputAccepted(),this.closePopup()}},{key:"_onActiveFilterSelected",value:function(e){this.setActiveFilter(e.activeFilter);var t=!this.searchRequired,n=this._readSearchText();this.lookupRow?this.lookupRow.text!==n&&(t=!1):Wn.hasText(n)&&(t=!1),this._lookupByTextOrAll(t,n,!0)}},{key:"setBrowseMaxRowCount",value:function(e){this.setProperty("browseMaxRowCount",e)}},{key:"setBrowseAutoExpandAll",value:function(e){this.setProperty("browseAutoExpandAll",e)}},{key:"setBrowseLoadIncremental",value:function(e){this.setProperty("browseLoadIncremental",e),this.lookupCall&&this.lookupCall.setLoadIncremental(e)}},{key:"setActiveFilter",value:function(e){this.setProperty("activeFilter",this.activeFilterEnabled?e:null)}},{key:"setActiveFilterEnabled",value:function(e){this.setProperty("activeFilterEnabled",e)}},{key:"setInitActiveFilter",value:function(e){this.setProperty("initActiveFilter",e)}},{key:"setSearchRequired",value:function(e){this.setProperty("searchRequired",e)}},{key:"_executeLookup",value:function(e,t){var n=this;this.lookupSeqNo++,this.setLoading(!0);var r=this.original()._currentLookupCall;return t&&r&&r.abort(),this.original()._currentLookupCall=e,this.trigger("prepareLookupCall",{lookupCall:e}),e.execute().always((function(){n.original()._currentLookupCall=null,n.setLoading(!1),n._clearLookupStatus(),n._clearNoResultsErrorStatus()}))}},{key:"_clearNoResultsErrorStatus",value:function(){this.isTouchable()||this._userWasTyping&&this.errorStatus&&this.errorStatus.code===i.ErrorCode.NO_RESULTS&&this.setErrorStatus(null)}},{key:"virtual",value:function(){return this.browseMaxRowCount>i.DEFAULT_BROWSE_MAX_COUNT}},{key:"isDropdown",value:function(){return this.displayStyle===i.DisplayStyle.DROPDOWN}},{key:"_setLookupRow",value:function(e){this.lookupRow&&this.removeCssClass(this.lookupRow.cssClass),this._setProperty("lookupRow",e),e&&this.addCssClass(e.cssClass)}},{key:"setLookupRow",value:function(e){this.lookupRow!==e&&(this._notUnique=!1,this.clearErrorStatus(),this._setLookupRow(e),this._lockLookupRow=!0,e?this.setValue(this._getValueFromLookupRow(e)):this.setValue(null),this._lockLookupRow=!1,this.resetDisplayText())}},{key:"setDisplayText",value:function(e){q2(Z2(i.prototype),"setDisplayText",this).call(this,e),this._userWasTyping=!1}},{key:"resetDisplayText",value:function(){var e=this,t=this.formatValue(this.value);t&&s.a.isFunction(t.promise)?t.done(this._setAndRenderDisplayText.bind(this)).fail((function(){s.a.log.isInfoEnabled()&&s.a.log.info("Could not resolve display text for value: "+e.value)})):this._setAndRenderDisplayText(t)}},{key:"_setAndRenderDisplayText",value:function(e){this._setProperty("displayText",e),this.rendered&&this._renderDisplayText()}},{key:"_getValueFromLookupRow",value:function(e){return e.key}},{key:"_setValue",value:function(e){this._lockLookupRow||(Pr.isNullOrUndefined(e)||this._checkResetLookupRow(e))&&this._setLookupRow(null),q2(Z2(i.prototype),"_setValue",this).call(this,e),this._notUnique=!1}},{key:"_checkResetLookupRow",value:function(e){return this.lookupRow&&this.lookupRow.key!==e}},{key:"getValueForSelection",value:function(){return this._showSelection()?this.value:null}},{key:"_showSelection",value:function(){if(Pr.isNullOrUndefined(this.value)||Pr.isNullOrUndefined(this.lookupRow))return!1;var e;if(this.rendered){e=this._readDisplayText();var t=this.additionalLines();t&&(e=[e].concat(t).join("\n"))}else e=this.displayText;return e===this.lookupRow.text}},{key:"isClearable",value:function(){return q2(Z2(i.prototype),"isClearable",this).call(this)&&!this.isDropdown()&&!this.touchMode}},{key:"_triggerLookupCallDone",value:function(e){return this.trigger("lookupCallDone",{result:e}),e}},{key:"_triggerAcceptInputFail",value:function(){this._triggerAcceptInput(!1,!0)}},{key:"_triggerAcceptInput",value:function(e,t){this.trigger("acceptInput",{displayText:this.displayText,errorStatus:this.errorStatus,value:this.value,lookupRow:this.lookupRow,acceptByLookupRow:O.nvl(e,!0),failure:O.nvl(t,!1)})}},{key:"_triggerAcceptByText",value:function(e){this.trigger("acceptByText",{searchText:e,errorStatus:this.errorStatus})}},{key:"onCellEditorRendered",value:function(e){e.openFieldPopup&&(this._cellEditorPopup=e.cellEditorPopup,this.openPopup(!this.searchRequired))}},{key:"additionalLines",value:function(){var e=O.nvl(this.displayText,"").split("\n");return e.length>1?(e.shift(),e):null}},{key:"_createLoadingSupport",value:function(){return new fe({widget:this,loadingIndicatorDelay:400})}},{key:"_isInitialShowStatus",value:function(){return(!this.touchMode||!this._pendingOpenPopup&&!this.isPopupOpen())&&q2(Z2(i.prototype),"_isInitialShowStatus",this).call(this)}},{key:"acceptInputFromField",value:function(e){this._copyValuesFromField(e),this._cellEditorPopup?(this._cellEditorPopup.completeEdit(),this._cellEditorPopup=null):this.acceptInput()}},{key:"_copyValuesFromField",value:function(e){this.lookupRow!==e.lookupRow&&this.setLookupRow(e.lookupRow),this.setErrorStatus(e.errorStatus),this.setDisplayText(e.displayText)}},{key:"_setNotUniqueError",value:function(e){this.setErrorStatus(Br.error({message:this.session.text("SmartFieldNotUnique",e),code:i.ErrorCode.NOT_UNIQUE}))}},{key:"_hasNotUniqueError",value:function(e){return this._notUnique||this._hasUiError(i.ErrorCode.NOT_UNIQUE)}},{key:"_errorStatus",value:function(){return this.lookupStatus||this.errorStatus}},{key:"setLookupStatus",value:function(e){this.setProperty("lookupStatus",e),this.rendered&&this._renderErrorStatus()}},{key:"clearErrorStatus",value:function(){this.setErrorStatus(null),this._clearLookupStatus()}},{key:"_clearLookupStatus",value:function(){this.setLookupStatus(null)}},{key:"_flushLookupStatus",value:function(){if(this.lookupStatus){if(this.lookupStatus.code===i.ErrorCode.NO_RESULTS||this.lookupStatus.code===i.ErrorCode.NOT_UNIQUE){var e=this.lookupStatus.clone();e.severity=Br.Severity.ERROR,this.setErrorStatus(e)}this._clearLookupStatus()}}},{key:"requestInput",value:function(){this.enabledComputed&&this.rendered&&(this.focus(),this.openPopup(!this.searchRequired))}}])&&K2(t.prototype,n),r&&K2(t,r),i}(Qz);function t3(e){return(t3="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function n3(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function r3(e,t,n){return(r3="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=a3(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function o3(e,t){return(o3=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function i3(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=a3(e);if(t){var o=a3(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return s3(this,n)}}function s3(e,t){return!t||"object"!==t3(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function a3(e){return(a3=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}Q2(e3,"DisplayStyle",{DEFAULT:"default",DROPDOWN:"dropdown"}),Q2(e3,"ErrorCode",{NOT_UNIQUE:1,NO_RESULTS:2,NO_DATA:3,SEARCH_REQUIRED:4}),Q2(e3,"DEBOUNCE_DELAY",200),Q2(e3,"DEFAULT_BROWSE_MAX_COUNT",100),Q2(e3,"ACTIVE_FILTER_VALUES",["UNDEFINED","FALSE","TRUE"]);var l3=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&o3(e,t)}(i,e);var t,n,r,o=i3(i);function i(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(e=o.call(this))._addRemoteProperties(["activeFilter"]),e}return t=i,(n=[{key:"_postCreateWidget",value:function(){r3(a3(i.prototype),"_postCreateWidget",this).call(this),this.widget.lookupCall=O.create("RemoteLookupCall",this)}},{key:"_syncResult",value:function(e){var t=this.widget._currentLookupCall;!t&&this.widget.touchMode&&this.widget.popup&&this.widget.popup._field&&(t=this.widget.popup._field._currentLookupCall),t&&t.resolveLookup(e)}},{key:"_syncDisplayText",value:function(e){this.widget.setDisplayText(e)}},{key:"_orderPropertyNamesOnSync",value:function(e){return Object.keys(e).sort(this._createPropertySortFunc(i.PROPERTIES_ORDER))}},{key:"_onWidgetEvent",value:function(e){"acceptByText"===e.type?this._onWidgetAcceptByText(e):r3(a3(i.prototype),"_onWidgetEvent",this).call(this,e)}},{key:"_onWidgetAcceptByText",value:function(e){this._sendProperty("errorStatus",e.errorStatus)}},{key:"_onWidgetAcceptInput",value:function(e){var t={displayText:e.displayText,errorStatus:e.errorStatus};e.errorStatus?Wn.empty(e.displayText)&&(t.value=null):(t.value=e.value,e.acceptByLookupRow&&(t.lookupRow=e.lookupRow)),this._send("acceptInput",t,{showBusyIndicator:!e.whileTyping,coalesce:function(e){return this.target===e.target&&this.type===e.type&&this.whileTyping===e.whileTyping}})}}])&&n3(t.prototype,n),r&&n3(t,r),i}(wQ);function u3(e){return(u3="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function c3(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function f3(e,t,n){return(f3="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=y3(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function h3(e,t){return(h3=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function p3(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=y3(e);if(t){var o=y3(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return d3(this,n)}}function d3(e,t){return!t||"object"!==u3(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function y3(e){return(y3=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}!function(e,t,n){t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}(l3,"PROPERTIES_ORDER",["lookupRow","value","errorStatus","displayText"]);var v3=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&h3(e,t)}(i,e);var t,n,r,o=p3(i);function i(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(t=o.call(this,e))._smartField=e,t}return t=i,(n=[{key:"layout",value:function(e){if(f3(y3(i.prototype),"layout",this).call(this,e),!this._smartField.embedded){var t=this._smartField.popup;t&&t.rendered&&(t.position(),t.validateLayout())}}}])&&c3(t.prototype,n),r&&c3(t,r),i}(dz);function b3(e){return(b3="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function m3(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function g3(e,t,n){return(g3="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=O3(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function _3(e,t){return(_3=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function w3(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=O3(e);if(t){var o=O3(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return k3(this,n)}}function k3(e,t){return!t||"object"!==b3(t)&&"function"!=typeof t?S3(e):t}function S3(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function O3(e){return(O3=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var T3=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_3(e,t)}(i,e);var t,n,r,o=w3(i);function i(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(t=o.call(this)).field=e,t.which=[Ou.ESC],t.stopPropagation=!0,t.preventInvokeAcceptInputOnActiveValueField=!0,t.renderingHints.$drawingArea=function(e,t){return this.field.$fieldContainer}.bind(S3(t)),t}return t=i,(n=[{key:"_accept",value:function(e){return!!g3(O3(i.prototype),"_accept",this).call(this,e)&&!!this.field.popup}},{key:"handle",value:function(e){this.field.closePopup(),this.field.resetDisplayText()}}])&&m3(t.prototype,n),r&&m3(t,r),i}(zu);function C3(e){return(C3="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function P3(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function R3(e,t,n){return(R3="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=A3(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function x3(e,t){return(x3=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function E3(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=A3(e);if(t){var o=A3(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return D3(this,n)}}function D3(e,t){return!t||"object"!==C3(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function A3(e){return(A3=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var F3=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&x3(e,t)}(i,e);var t,n,r,o=E3(i);function i(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(e=o.call(this)).animateRemoval=i.hasPopupAnimation(),e}return t=i,r=[{key:"hasPopupAnimation",value:function(){return Kt.get().supportsCssAnimation()&&!Kt.get().isInternetExplorer()}}],(n=[{key:"_init",value:function(e){e.withFocusContext=!1,R3(A3(i.prototype),"_init",this).call(this,e),this.smartField=this.parent,this.proposalChooser=this._createProposalChooser(),this.proposalChooser.on("lookupRowSelected",this._triggerEvent.bind(this)),this.proposalChooser.on("activeFilterSelected",this._triggerEvent.bind(this)),this.smartField.on("remove",this._onRemoveSmartField.bind(this)),this.setLookupResult(e.lookupResult),this.setStatus(e.status)}},{key:"_createProposalChooser",value:function(){var e=this.smartField.browseHierarchy?"TreeProposalChooser":"TableProposalChooser";return O.create(e,{parent:this})}},{key:"_createLayout",value:function(){return new Y3(this,this.proposalChooser)}},{key:"_render",value:function(){var e=this.smartField.cssClassName()+"-popup";R3(A3(i.prototype),"_render",this).call(this),this.$container.addClass(e).on("mousedown",this._onContainerMouseDown.bind(this)),this.$container.toggleClass("alternative",this.smartField.fieldStyle===ZW.FieldStyle.ALTERNATIVE),this.proposalChooser.render()}},{key:"setLookupResult",value:function(e){this._setProperty("lookupResult",e),this.proposalChooser.setLookupResult(e)}},{key:"getSelectedLookupRow",value:function(){var e=this.proposalChooser.getSelectedLookupRow();return e&&e.enabled?e:null}},{key:"setStatus",value:function(e){this.proposalChooser.setStatus(e)}},{key:"selectFirstLookupRow",value:function(){this.proposalChooser.selectFirstLookupRow()}},{key:"selectLookupRow",value:function(){this.proposalChooser.triggerLookupRowSelected()}},{key:"delegateKeyEvent",value:function(e){e.originalEvent.smartFieldEvent=!0,this.proposalChooser.delegateKeyEvent(e)}},{key:"_triggerEvent",value:function(e){this.trigger(e.type,e)}},{key:"_onContainerMouseDown",value:function(e){return!1}},{key:"_onRemoveSmartField",value:function(e){this.animateRemoval=!1,this.remove()}},{key:"_isMouseDownOnAnchor",value:function(e){return this.field.$field.isOrHas(e.target)||this.field.$icon.isOrHas(e.target)||this.field.$clearIcon&&this.field.$clearIcon.isOrHas(e.target)}},{key:"_onAnimationEnd",value:function(){this.proposalChooser.updateScrollbars()}}])&&P3(t.prototype,n),r&&P3(t,r),i}(Id);function $3(e){return($3="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function j3(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function B3(e,t,n){return(B3="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=H3(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function M3(e,t){return(M3=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function I3(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=H3(e);if(t){var o=H3(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return L3(this,n)}}function L3(e,t){return!t||"object"!==$3(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function H3(e){return(H3=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var N3=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&M3(e,t)}(i,e);var t,n,r,o=I3(i);function i(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),o.call(this)}return t=i,(n=[{key:"_init",value:function(e){e.withFocusContext=!1,e.smartField=e.parent,B3(H3(i.prototype),"_init",this).call(this,e),this.setLookupResult(e.lookupResult),this.setStatus(e.status),this.one("close",this._beforeClosePopup.bind(this)),this.smartField.on("propertyChange",this._onPropertyChange.bind(this))}},{key:"_initWidget",value:function(e){this._widget=this._createProposalChooser(),this._widget.on("lookupRowSelected",this._triggerEvent.bind(this)),this._widget.on("activeFilterSelected",this._triggerEvent.bind(this))}},{key:"_createProposalChooser",value:function(){var e=this.parent.browseHierarchy?"TreeProposalChooser":"TableProposalChooser";return O.create(e,{parent:this,touch:!0,smartField:this._field})}},{key:"_fieldOverrides",value:function(){var e=B3(H3(i.prototype),"_fieldOverrides",this).call(this);return e.proposalChooser=null,e}},{key:"_onMouseDownOutside",value:function(){this._acceptInput()}},{key:"delegateKeyEvent",value:function(e){e.originalEvent.smartFieldEvent=!0,this._widget.delegateKeyEvent(e)}},{key:"getSelectedLookupRow",value:function(){return this._widget.getSelectedLookupRow()}},{key:"_triggerEvent",value:function(e){this.trigger(e.type,e)}},{key:"setLookupResult",value:function(e){this._widget.setLookupResult(e)}},{key:"setStatus",value:function(e){this._widget.setStatus(e)}},{key:"clearLookupRows",value:function(){this._widget.clearLookupRows()}},{key:"selectFirstLookupRow",value:function(){this._widget.selectFirstLookupRow()}},{key:"selectLookupRow",value:function(){this._widget.triggerLookupRowSelected()}},{key:"_onPropertyChange",value:function(e){"lookupStatus"===e.propertyName&&this._field.setLookupStatus(e.newValue)}},{key:"_beforeClosePopup",value:function(e){this.smartField.acceptInputFromField(this._field)}}])&&j3(t.prototype,n),r&&j3(t,r),i}(Iy);function V3(e){return(V3="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function W3(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function z3(e,t,n){return(z3="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=q3(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function G3(e,t){return(G3=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function U3(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=q3(e);if(t){var o=q3(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return K3(this,n)}}function K3(e,t){return!t||"object"!==V3(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function q3(e){return(q3=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Y3=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&G3(e,t)}(i,e);var t,n,r,o=U3(i);function i(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(t=o.call(this,e)).animating=!1,t.doubleCalcPrefSize=!1,t}return t=i,(n=[{key:"layout",value:function(e){var t,n=this,r=this._htmlProposalChooser();this.animating?this.popup.htmlComp.$comp.oneAnimationEnd((function(){n.popup.revalidateLayout()})):(z3(q3(i.prototype),"layout",this).call(this,e),t=this.popup.htmlComp.size().subtract(this.popup.htmlComp.insets()),r.setSize(t),this.popup.htmlComp.layouted?this.popup.position():F3.hasPopupAnimation()&&(this.animating=!0,this.popup.htmlComp.$comp.css("visibility","hidden"),this.popup.session.layoutValidator.schedulePostValidateFunction((function(){n.popup.htmlComp.$comp.css("visibility",""),n.popup.htmlComp.$comp.addClassForAnimation("animate-open"),n.popup.htmlComp.$comp.oneAnimationEnd((function(){n.animating=!1,n.popup._onAnimationEnd()}))}))))}},{key:"preferredLayoutSize",value:function(e,t){var n,r=this._htmlProposalChooser(),o=qs.offsetBounds(this.popup.smartField.$field);return(n=r?(n=r.prefSize(t)).add(this.popup.htmlComp.insets()):new $s(Xs.get().formColumnWidth,2*Xs.get().formRowHeight)).width=Math.max(o.width,n.width),n.height=Math.max(15,Math.min(350,n.height)),n.width>this._maxWindowSize()&&(n.width=this._maxWindowSize()),n}},{key:"_htmlProposalChooser",value:function(){var e=this.popup.proposalChooser;return e?e.htmlComp:null}},{key:"_maxWindowSize",value:function(){return this.popup.$container.window().width()-2*this.popup.windowPaddingX}}])&&W3(t.prototype,n),r&&W3(t,r),i}(Qd);function X3(e){return(X3="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function J3(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Z3(e,t,n){return(Z3="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=n5(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function Q3(e,t){return(Q3=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function e5(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=n5(e);if(t){var o=n5(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return t5(this,n)}}function t5(e,t){return!t||"object"!==X3(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function n5(e){return(n5=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var r5=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Q3(e,t)}(i,e);var t,n,r,o=e5(i);function i(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(e=o.call(this)).options,e._$multilineLines,e}return t=i,(n=[{key:"_render",value:function(){var e;this.addContainer(this.$parent,"smart-field has-icon",new v3(this)),this.addLabel(),this.addFieldContainer(this.$parent.makeDiv("multiline")),ea.install(this.$fieldContainer,this.session).setLayout(new b5(this)),e=TW.makeInputOrDiv(this,"multiline-input").on("mousedown",this._onFieldMouseDown.bind(this)).appendTo(this.$fieldContainer),this.touchMode||e.keyup(this._onFieldKeyUp.bind(this)).keydown(this._onFieldKeyDown.bind(this)).on("input",this._onFieldInput.bind(this)),this.addField(e),this._$multilineLines=this.$fieldContainer.appendDiv("multiline-lines").on("click",this._onMultilineLinesClick.bind(this)),this.embedded||this.addMandatoryIndicator(),this.addIcon(),this.$icon.addClass("needsclick"),this.addStatus()}},{key:"_renderEnabled",value:function(){Z3(n5(i.prototype),"_renderEnabled",this).call(this),this._$multilineLines.setEnabled(this.enabledComputed)}},{key:"_onMultilineLinesClick",value:function(e){this.enabledComputed&&(this.$field.window(!0).getSelection().toString()||this.$field.focus())}},{key:"_renderDisplayText",value:function(){Z3(n5(i.prototype),"_renderDisplayText",this).call(this);var e=this.additionalLines();e?this._$multilineLines.html(rt.formatEncoded(e,"<br/>")):this._$multilineLines.empty()}},{key:"_getInputBounds",value:function(){var e=qs.offsetBounds(this.$fieldContainer),t=qs.offsetBounds(this.$field);return e.height=t.height,e}},{key:"_renderFocused",value:function(){Z3(n5(i.prototype),"_renderFocused",this).call(this),this._$multilineLines.toggleClass("focused",this.focused)}},{key:"_updateErrorStatusClasses",value:function(e,t){Z3(n5(i.prototype),"_updateErrorStatusClasses",this).call(this,e,t),this._updateErrorStatusClassesOnElement(this._$multilineLines,e,t)}}])&&J3(t.prototype,n),r&&J3(t,r),i}(e3);function o5(e){return(o5="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i5(e,t){return(i5=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function s5(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=l5(e);if(t){var o=l5(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return a5(this,n)}}function a5(e,t){return!t||"object"!==o5(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function l5(e){return(l5=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var u5=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&i5(e,t)}(n,e);var t=s5(n);function n(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),t.call(this)}return n}(l3);function c5(e){return(c5="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function f5(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function h5(e,t){return(h5=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function p5(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=v5(e);if(t){var o=v5(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return d5(this,n)}}function d5(e,t){return!t||"object"!==c5(t)&&"function"!=typeof t?y5(e):t}function y5(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function v5(e){return(v5=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var b5=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&h5(e,t)}(i,e);var t,n,r,o=p5(i);function i(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(t=o.call(this)).smartField=e,t._initDefaults(),t.htmlPropertyChangeHandler=t._onHtmlEnvironmentPropertyChange.bind(y5(t)),Xs.get().on("propertyChange",t.htmlPropertyChangeHandler),t.smartField.one("remove",(function(){Xs.get().off("propertyChange",t.htmlPropertyChangeHandler)})),t}return t=i,(n=[{key:"_initDefaults",value:function(){this.rowHeight=Xs.get().formRowHeight}},{key:"_onHtmlEnvironmentPropertyChange",value:function(){this._initDefaults(),this.smartField.invalidateLayoutTree()}},{key:"layout",value:function(e){var t=ea.get(e),n=e.children(".multiline-input"),r=e.children(".multiline-lines"),o=t.availableSize().subtract(t.insets());n.cssHeight(this.rowHeight),r.cssHeight(o.height-this.rowHeight)}}])&&f5(t.prototype,n),r&&f5(t,r),i}(Zs);function m5(e){return(m5="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function g5(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function _5(e,t,n){return(_5="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=O5(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function w5(e,t){return(w5=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function k5(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=O5(e);if(t){var o=O5(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return S5(this,n)}}function S5(e,t){return!t||"object"!==m5(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function O5(e){return(O5=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var T5=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&w5(e,t)}(i,e);var t,n,r,o=k5(i);function i(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(e=o.call(this)).maxLength=4e3,e.trimText=!0,e.lookupOnAcceptByText=!1,e}return t=i,(n=[{key:"_getValueFromLookupRow",value:function(e){return e.text}},{key:"_getLastSearchText",value:function(){return this.value}},{key:"cssClassName",value:function(){return"proposal-field"}},{key:"_handleEnterKey",value:function(e){var t=!!this.popup;this.acceptInput(),this.popup&&this.closePopup(),t&&e.stopPropagation()}},{key:"_lookupByTextOrAllDone",value:function(e){if(!_5(O5(i.prototype),"_handleException",this).call(this,e))return 0===e.lookupRows.length?(this.setLoading(!1),void this._handleEmptyResult()):void _5(O5(i.prototype),"_lookupByTextOrAllDone",this).call(this,e)}},{key:"_formatValue",value:function(e){return O.nvl(e,"")}},{key:"_validateValue",value:function(e){if(Pr.isNullOrUndefined(e))return e;var t=Wn.asString(e);return this.trimText&&(t=t.trim()),t.length>this.maxLength&&(t=t.substring(0,this.maxLength)),""===t&&(t=null),t}},{key:"_ensureValue",value:function(e){return Wn.asString(e)}},{key:"_acceptByText",value:function(e,t){s.a.log.isDebugEnabled()&&s.a.log.debug("(ProposalField#_acceptByText) searchText=",t),!e&&this.lookupOnAcceptByText&&Wn.hasText(t)?_5(O5(i.prototype),"_acceptByTextAsync",this).call(this,t):this._customTextAccepted(t)}},{key:"_acceptByTextDone",value:function(e){if(this._userWasTyping=!1,this._extendResult(e),e.uniqueMatch){var t=e.uniqueMatch;if(this._isLookupRowActive(t))return this.setLookupRow(t),void this._inputAccepted()}this._customTextAccepted(e.text)}},{key:"_checkResetLookupRow",value:function(e){return this.lookupRow&&this.lookupRow.text!==e}},{key:"_checkSearchTextChanged",value:function(e){return this._checkDisplayTextChanged(e)}},{key:"_customTextAccepted",value:function(e){this._setLookupRow(null),this._setValue(e),this._inputAccepted(!0,!1)}},{key:"getValueForSelection",value:function(){return this._showSelection()?this.lookupRow.key:null}},{key:"_acceptLookupRowAndValueFromField",value:function(e){this.lookupRow!==e.lookupRow&&this.setLookupRow(e.lookupRow)}},{key:"_copyValuesFromField",value:function(e){this.lookupRow!==e.lookupRow&&this.setLookupRow(e.lookupRow),this.value!==e.value&&this.setValue(e.value)}},{key:"_acceptInput",value:function(e,t,n,r,o){return!o&&this.lookupRow&&this.lookupRow.text===t?(s.a.log.isDebugEnabled()&&s.a.log.debug("(ProposalField#_acceptInput) unchanged: text is equals. Close popup"),void this._inputAccepted(!1)):o?(s.a.log.isDebugEnabled()&&s.a.log.debug("(ProposalField#_acceptInput) lookup-row selected. Set lookup-row, close popup lookupRow=",o.toString()),this.clearErrorStatus(),this.setLookupRow(o),void this._inputAccepted()):(r?this._acceptByText(e,t):this._hasUiError()?this._acceptInputDeferred.resolve():this._inputAccepted(!1),this._acceptInputDeferred.promise())}},{key:"setTrimText",value:function(e){this.setProperty("trimText",e)}},{key:"setMaxLength",value:function(e){this.setProperty("maxLength",e)}},{key:"_updateEmpty",value:function(){this.empty=Wn.empty(this.value)}}])&&g5(t.prototype,n),r&&g5(t,r),i}(e3);function C5(e){return(C5="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function P5(e,t){return(P5=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function R5(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=E5(e);if(t){var o=E5(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return x5(this,n)}}function x5(e,t){return!t||"object"!==C5(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function E5(e){return(E5=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var D5=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&P5(e,t)}(n,e);var t=R5(n);function n(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),(e=t.call(this))._addRemoteProperties(["lookupRows"]),e}return n}(l3);function A5(e){return(A5="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function F5(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function $5(e,t,n){return($5="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=I5(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function j5(e,t){return(j5=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function B5(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=I5(e);if(t){var o=I5(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return M5(this,n)}}function M5(e,t){return!t||"object"!==A5(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function I5(e){return(I5=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var L5=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&j5(e,t)}(i,e);var t,n,r,o=B5(i);function i(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),o.call(this)}return t=i,(n=[{key:"_init",value:function(e){$5(I5(i.prototype),"_init",this).call(this,e)}},{key:"_renderText",value:function(){var e=this.text;!1===this.lookupRow.active&&(e+=" ("+this.session.text("InactiveState")+")"),this.htmlEnabled?this.$text.html(e):this.$text.textOrNbsp(e)}},{key:"_getStyles",value:function(){return this.lookupRow}},{key:"_decorate",value:function(){this.$node&&($5(I5(i.prototype),"_decorate",this).call(this),this.$node.toggleClass("inactive",!this.lookupRow.active))}},{key:"isBrowseLoadIncremental",value:function(){return this.proposalChooser.isBrowseLoadIncremental()}},{key:"loadChildren",value:function(){if(this.isBrowseLoadIncremental()){var e=this.lookupRow.key;return this.proposalChooser.smartField.lookupByRec(e)}return s.a.resolvedDeferred()}},{key:"hasChildNodes",value:function(){return!(!this.isBrowseLoadIncremental()||this.childrenLoaded)||$5(I5(i.prototype),"hasChildNodes",this).call(this)}}])&&F5(t.prototype,n),r&&F5(t,r),i}(rN);function H5(e){return(H5="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function N5(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function V5(e,t,n){return(V5="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=U5(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function W5(e,t){return(W5=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function z5(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=U5(e);if(t){var o=U5(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return G5(this,n)}}function G5(e,t){return!t||"object"!==H5(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function U5(e){return(U5=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var K5=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&W5(e,t)}(i,e);var t,n,r,o=z5(i);function i(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(e=o.call(this)).$container=null,e.$status=null,e.activeFilterGroup=null,e.htmlComp=null,e._updateStatusTimeout=null,e.status=null,e.statusVisible=!0,e.touch=!1,e}return t=i,(n=[{key:"_init",value:function(e){V5(U5(i.prototype),"_init",this).call(this,e),e.smartField||(this.smartField=this.parent.smartField),this.model=this._createModel()}},{key:"_createModel",value:function(e){throw new Error("_createModel() not implemented")}},{key:"setLookupResult",value:function(e){throw new Error("setLookupResult() not implemented")}},{key:"selectFirstLookupRow",value:function(){throw new Error("selectFirstLookupRow() not implemented")}},{key:"clearSelection",value:function(){throw new Error("clearSelection() not implemented")}},{key:"clearLookupRows",value:function(){throw new Error("clearLookupRows() not implemented")}},{key:"triggerLookupRowSelected",value:function(e){(e=e||this.selectedRow())&&e.enabled&&this.trigger("lookupRowSelected",{lookupRow:e.lookupRow})}},{key:"selectedRow",value:function(){throw new Error("selectedRow() not implemented")}},{key:"_render",value:function(){this.$container=this.$parent.appendDiv("proposal-chooser").toggleClass("touch",this.touch),this.htmlComp=ea.install(this.$container,this.session),this.htmlComp.setLayout(new e4(this)),this._renderModel(),this.$status=this.$container.appendDiv("status").setVisible(!1),this.smartField.activeFilterEnabled&&(this.activeFilterGroup=O.create("RadioButtonGroup",{parent:this,labelVisible:!1,statusVisible:!1,gridColumnCount:e3.ACTIVE_FILTER_VALUES.length}),e3.ACTIVE_FILTER_VALUES.forEach((function(e,t){this._insertActiveFilterButton(e,t)}),this),this.activeFilterGroup.render(),this.activeFilterGroup.$container.addClass("active-filter"),this.activeFilterGroup.removeMandatoryIndicator())}},{key:"_renderModel",value:function(){this.model.render()}},{key:"_renderProperties",value:function(){V5(U5(i.prototype),"_renderProperties",this).call(this),this._updateStatus()}},{key:"delegateEvent",value:function(e){e.originalEvent.smartFieldEvent=!0,this.model.$container.trigger(e)}},{key:"delegateKeyEvent",value:function(e){this.model.$container.trigger(e)}},{key:"_renderStatus",value:function(){this._updateStatus()}},{key:"_renderStatusVisible",value:function(){this._updateStatus()}},{key:"_computeStatusVisible",value:function(){return!(!this.statusVisible||!this.status)}},{key:"_updateStatus",value:function(){clearTimeout(this._updateStatusTimeout),Pr.optProperty(this.status,"severity")===Br.Severity.OK?this._updateStatusTimeout=setTimeout(this._updateStatusImpl.bind(this),250):this._updateStatusImpl()}},{key:"_updateStatusImpl",value:function(){if(this.rendered||this.rendering){var e=this.$status.isVisible(),t=this.$status.text(),n=this._computeStatusVisible();e===n&&t===Pr.optProperty(this.status,"message")||(s.a.log.isDebugEnabled()&&s.a.log.debug("(ProposalChooser#_updateStatusImpl) $status.visible="+n),this.$status.setVisible(n),this.status?this._setStatusMessage(this.status.message):this.$status.text(""),this.htmlComp.invalidateLayoutTree())}}},{key:"_setStatusMessage",value:function(e){Br.animateStatusMessage(this.$status,e)}},{key:"_insertActiveFilterButton",value:function(e,t){var n=this,r=O.create("RadioButton",{parent:this.activeFilterGroup,label:this._activeFilterLabel(t),radioValue:e3.ACTIVE_FILTER_VALUES[t],selected:this.smartField.activeFilter===e,focusWhenSelected:!1,gridDataHints:{useUiWidth:!0}});r.on("propertyChange",(function(e){"selected"===e.propertyName&&!0===e.newValue&&n.trigger("activeFilterSelected",{activeFilter:e.source.radioValue})})),this.activeFilterGroup.insertButton(r)}},{key:"setVirtual",value:function(e){this.model instanceof Cx&&this.model.setVirtual(e)}},{key:"setStatus",value:function(e){this.setProperty("status",e)}},{key:"setBusy",value:function(e){this.model.setProperty("loading",e),this.model.setProperty("enabled",!e)}},{key:"_activeFilterLabel",value:function(e){return this.smartField.activeFilterLabels[e]}},{key:"updateScrollbars",value:function(){this.model.updateScrollbars()}},{key:"_isProposal",value:function(){return this.smartField instanceof T5}},{key:"_selectProposal",value:function(e,t){this._isProposal()||(e.byAll?this.trySelectCurrentValue():1===t.length&&this.selectFirstLookupRow())}}])&&N5(t.prototype,n),r&&N5(t,r),i}(ve);function q5(e){return(q5="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Y5(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function X5(e,t){return(X5=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function J5(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Q5(e);if(t){var o=Q5(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Z5(this,n)}}function Z5(e,t){return!t||"object"!==q5(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Q5(e){return(Q5=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var e4=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&X5(e,t)}(i,e);var t,n,r,o=J5(i);function i(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(t=o.call(this))._proposalChooser=e,t._typeHandler=t._createTypeHandler(e),t}return t=i,(n=[{key:"_createTypeHandler",value:function(e){var t=e.model.objectType+"LayoutResetter";return O.create(t,e.model)}},{key:"layout",value:function(e){var t,n=ea.get(e),r=ea.get(e.children(this._typeHandler.cssSelector)),o=n.size().subtract(n.insets()),i=this._proposalChooser.$status,s=i&&i.isVisible(),a=this._proposalChooser.activeFilterGroup;s&&(o.height-=qs.size(i).height),a&&(t=a.htmlComp.prefSize(),o.height-=t.height),r.setSize(o),a&&a.htmlComp.setSize(new $s(o.width,t.height))}},{key:"preferredLayoutSize",value:function(e,t){var n,r,o,i,s,a,l,u=this._proposalChooser.htmlComp,c=this._proposalChooser.$status,f=this._proposalChooser.activeFilterGroup,h=e.parent();return r=o=this._proposalChooser.model.htmlComp.prefSize(t),Lh.storeScrollPositions(e,this._proposalChooser.session),a=e.css("width"),l=e.css("height"),e.detach(),this._typeHandler.modifyDom(),e.css("display","inline-block").css("width","auto").css("height","auto"),h.append(e),o.width=qs.prefSize(e,{restoreScrollPositions:!1}).width,e.detach(),this._typeHandler.restoreDom(),e.css("display","block").css("width",a).css("height",l),h.append(e),Lh.restoreScrollPositions(e,this._proposalChooser.session),c&&c.isVisible()&&(n=c.css("display"),c.css("display","inline-block"),i=qs.prefSize(c,{includeMargin:!0,useCssSize:!0}),c.css("display",n),r=new $s(Math.max(r.width,i.width),r.height+i.height)),f&&(s=f.htmlComp.prefSize(),r=new $s(Math.max(r.width,s.width),r.height+s.height)),e.toggleClass("empty",0===o.height),r.add(u.insets())}}])&&Y5(t.prototype,n),r&&Y5(t,r),i}(Zs);function t4(e){return(t4="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function n4(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function r4(e,t){return(r4=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function o4(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=s4(e);if(t){var o=s4(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return i4(this,n)}}function i4(e,t){return!t||"object"!==t4(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function s4(e){return(s4=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var a4=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&r4(e,t)}(i,e);var t,n,r,o=o4(i);function i(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),o.call(this)}return t=i,(n=[{key:"_createModel",value:function(){var e=!1,t=[],n=this.smartField.columnDescriptors;n?n.forEach((function(n,r){e=e||!!n.text,t.push(this._createColumnForDescriptor(n))}),this):t.push(this._createColumn());var r=this._createTable(t,e);return r.on("rowClick",this._onRowClick.bind(this)),r}},{key:"_createColumn",value:function(){return O.create("Column",{session:this.session,width:qA.NARROW_MIN_WIDTH,horizontalAlignment:this.smartField.gridData.horizontalAlignment})}},{key:"_createColumnForDescriptor",value:function(e){var t=qA.NARROW_MIN_WIDTH;return e.width&&e.width>0&&(t=e.width),O.create("Column",{session:this.session,text:e.text,cssClass:O.nvl(e.cssClass,null),width:t,autoOptimizeWidth:O.nvl(e.autoOptimizeWidth,!1),fixedWidth:O.nvl(e.fixedWidth,!1),fixedPosition:O.nvl(e.fixedPosition,!1),horizontalAlignment:O.nvl(e.horizontalAlignment,this.smartField.gridData.horizontalAlignment),visible:O.nvl(e.visible,!0),htmlEnabled:O.nvl(e.htmlEnabled,!1)})}},{key:"_createTable",value:function(e,t){return O.create("Table",{parent:this,headerVisible:t,autoResizeColumns:!0,multiSelect:!1,multilineText:!0,scrollToSelection:!0,columns:e,headerMenusEnabled:!1})}},{key:"_onRowClick",value:function(e){var t=e.row;t&&t.enabled&&(this.setBusy(!0),this.triggerLookupRowSelected(t))}},{key:"selectedRow",value:function(){return this.model.selectedRow()}},{key:"setLookupResult",value:function(e){var t=[],n=e.lookupRows,r=!!this.smartField.columnDescriptors;this.model.deleteAllRows(),n.forEach((function(e){t.push(this._createTableRow(e,r))}),this),this.model.insertRows(t),this._selectProposal(e,t)}},{key:"trySelectCurrentValue",value:function(){var e=this.smartField.getValueForSelection();if(!Pr.isNullOrUndefined(e)){var t=rt.find(this.model.rows,(function(t){return t.lookupRow.key===e}));t&&this.model.selectRow(t)}}},{key:"selectFirstLookupRow",value:function(){this.model.rows.length&&this.model.selectRow(this.model.rows[0])}},{key:"clearSelection",value:function(){this.model.deselectAll()}},{key:"clearLookupRows",value:function(){this.model.removeAllRows()}},{key:"_createTableRow",value:function(e,t){var n=dQ.createTableRow(e,t);return t&&rt.pushAll(n.cells,this._transformTableRowData(e,e.additionalTableRowData)),n}},{key:"_renderModel",value:function(){this.model.setVirtual(this.smartField.virtual()),this.model.render(),this.model.$container.setTabbable(!1),this.model.$container.addClass("focused")}},{key:"getSelectedLookupRow",value:function(){var e=this.model.selectedRow();return e?e.lookupRow:null}},{key:"_transformTableRowData",value:function(e,t){var n=this.smartField.columnDescriptors,r=[];return n.forEach((function(n){r.push(dQ.createTableCell(e,n,t))})),r}}])&&n4(t.prototype,n),r&&n4(t,r),i}(K5);function l4(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var u4=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._table=t,this._fillerWidth=null,this.cssSelector=".table"}var t,n,r;return t=e,(n=[{key:"modifyDom",value:function(){this._table.$container.css("display","inline-block").css("width","auto").css("height","auto"),this._table.$data.css("display","inline-block"),this._modifyFiller(this._table.$fillBefore),this._modifyFiller(this._table.$fillAfter),this._modifyTableData(this._cssBackup)}},{key:"restoreDom",value:function(){this._table.$container.css("display","block").css("width","100%").css("height","100%"),this._table.$data.css("display","block"),this._restoreFiller(this._table.$fillBefore),this._restoreFiller(this._table.$fillAfter),this._modifyTableData(this._cssRestore)}},{key:"_cssBackup",value:function(e,t){var n=e.css(t);e.css(t,"").data("backup"+t,n)}},{key:"_cssRestore",value:function(e,t){var n="backup"+t,r=e.data(n);e.css(t,r).removeData(n)}},{key:"_modifyTableData",value:function(e){var t=this;this._table.$rows().each((function(){var n=s()(this);e(n,"width"),t._table.$cellsForRow(n).each((function(){var t=s()(this);e(t,"min-width"),e(t,"max-width")}))}))}},{key:"_modifyFiller",value:function(e){e&&(this._fillerWidth=e.css("width"),e.css("width",""))}},{key:"_restoreFiller",value:function(e){e&&e.css("width",this._fillerWidth)}}])&&l4(t.prototype,n),r&&l4(t,r),e}();function c4(e){return(c4="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function f4(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function h4(e,t){return(h4=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function p4(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=y4(e);if(t){var o=y4(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return d4(this,n)}}function d4(e,t){return!t||"object"!==c4(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function y4(e){return(y4=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var v4=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&h4(e,t)}(i,e);var t,n,r,o=p4(i);function i(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),o.call(this)}return t=i,(n=[{key:"_createModel",value:function(){var e=O.create("Tree",{parent:this,requestFocusOnNodeControlMouseDown:!1,scrollToSelection:!0});return e.on("nodeClick",this._onNodeClick.bind(this)),e}},{key:"_onNodeClick",value:function(e){this.triggerLookupRowSelected(e.node)}},{key:"selectedRow",value:function(){return this.model.selectedNode()}},{key:"isBrowseLoadIncremental",value:function(){return this.smartField.browseLoadIncremental}},{key:"getSelectedLookupRow",value:function(){var e=this.model.selectedNode();return e?e.lookupRow:null}},{key:"selectFirstLookupRow",value:function(){this.model.nodes.length&&this.model.selectNode(this.model.nodes[0])}},{key:"clearSelection",value:function(){this.model.deselectAll()}},{key:"setLookupResult",value:function(e){var t,n,r=this,o=e.lookupRows;if(O.nvl(e.appendResult,!1))if(n=o.map(this._createTreeNode.bind(this)),(t=this._flatListToSubTree(n)).length){var i=null;t.forEach((function(e){i=r.model.nodesMap[e.parentId],r._appendChildNode(i,e)})),i&&this.model.insertNodes(t,i)}else{var s=this.model.nodesMap[e.rec];s.leaf=!0,s.childrenLoaded=!0,this.model.updateNode(s)}else this.model.deleteAllChildNodes(),n=o.map(this._createTreeNode.bind(this)),t=this._flatListToSubTree(n),e.byText&&this._expandAllParentNodes(n),this.model.insertNodes(t);this._selectProposal(e,n)}},{key:"_expandAllParentNodes",value:function(e){e.reduce((function(e,t){return(t.leaf||!t.childNodesLoaded&&0===t.childNodes.length)&&e.push(t),e}),[]).forEach(function(e){if(e.parentNode&&!e.parentNode.expanded)for(e=e.parentNode;e;)this.model.setNodeExpanded(e,!0),e=e.parentNode}.bind(this))}},{key:"trySelectCurrentValue",value:function(){var e=this.smartField.getValueForSelection();if(!Pr.isNullOrUndefined(e)){var t=Pr.values(this.model.nodesMap),n=rt.find(t,(function(t){return t.lookupRow.key===e}));n&&this.model.selectNode(n)}}},{key:"_createTreeNode",value:function(e){var t=!0,n=this.smartField.browseAutoExpandAll;return this.isBrowseLoadIncremental()&&(n=!1,t=!1),O.create("ProposalTreeNode",{parent:this.model,proposalChooser:this,childNodeIndex:0,enabled:e.enabled,htmlEnabled:!1,iconId:e.iconId,id:e.key,parentId:e.parentKey,expanded:n,initialExpanded:n,text:e.text,lookupRow:e,leaf:t,tooltipText:e.tooltipText})}},{key:"findLeafs",value:function(){var e=[];return KH.visitNodes((function(t,n){!t.leaf&&t.childNodes.length||e.push(t)}),this.model.nodes),e}},{key:"_flatListToSubTree",value:function(e){var t=this,n={};e.forEach((function(e){Pr.isNullOrUndefined(e.id)||(n[e.id]=e)}));var r=[];return e.forEach((function(e){var o=n[e.parentId];if(o===e)throw new Error("Cannot link a node to itself. Id: "+e.parentId);o?t._appendChildNode(o,e):(e.childNodeIndex=r.length,e.parentNode=null,r.push(e))})),r}},{key:"_appendChildNode",value:function(e,t){e.childNodes||(e.childNodes=[]),t.childNodeIndex=e.childNodes.length,t.parentNode=e,e.childNodes.push(t),e.leaf=!1,e.childrenLoaded=!0}},{key:"clearLookupRows",value:function(){this.model.deleteAllNodes()}}])&&f4(t.prototype,n),r&&f4(t,r),i}(K5);function b4(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var m4=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._tree=t,this.cssSelector=".tree"}var t,n,r;return t=e,(n=[{key:"modifyDom",value:function(){this._ensureFirstLast(),this._tree.$container.css("display","inline-block").css("width","auto").css("height","auto"),this._tree.$data.css("display","inline-block")}},{key:"restoreDom",value:function(){this._tree.$container.css("display","block").css("width","100%").css("height","100%"),this._tree.$data.css("display","block")}},{key:"_ensureFirstLast",value:function(){var e=this._tree.$data.children(".tree-node").removeClass("first last");e.first().addClass("first"),e.last().addClass("last")}}])&&b4(t.prototype,n),r&&b4(t,r),e}();function g4(e){return(g4="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _4(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function w4(e,t,n){return(w4="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=T4(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function k4(e,t){return(k4=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function S4(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=T4(e);if(t){var o=T4(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return O4(this,n)}}function O4(e,t){return!t||"object"!==g4(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function T4(e){return(T4=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function C4(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var P4=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&k4(e,t)}(i,e);var t,n,r,o=S4(i);function i(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(e=o.call(this))._addWidgetProperties(["firstField","secondField","collapsibleField"]),e._addPreserveOnPropertyChangeProperties(["collapsibleField"]),e.firstField=null,e.secondField=null,e.collapsibleField=null,e.collapseKeyStroke=null,e.fieldCollapsed=!1,e.toggleCollapseKeyStroke=null,e.firstCollapseKeyStroke=null,e.secondCollapseKeyStroke=null,e.splitHorizontal=!0,e.splitterEnabled=!0,e.splitterPosition=.5,e.minSplitterPosition=0,e.splitterPositionType=i.SPLITTER_POSITION_TYPE_RELATIVE_FIRST,e.fieldMinimized=!1,e.minimizeEnabled=!0,e._$splitArea=null,e._$splitter=null,e}return t=i,(n=[{key:"_init",value:function(e){w4(T4(i.prototype),"_init",this).call(this,e),this._setToggleCollapseKeyStroke(this.toggleCollapseKeyStroke),this._setFirstCollapseKeyStroke(this.firstCollapseKeyStroke),this._setSecondCollapseKeyStroke(this.secondCollapseKeyStroke),this._updateCollapseHandle(),this._initResponsive()}},{key:"_initResponsive",value:function(){this.getFields().forEach((function(e){e instanceof gJ&&null===e.responsive&&e.setResponsive(!0)}))}},{key:"_render",value:function(){function e(e){"visible"===e.propertyName&&(this._updateFieldVisibilityClasses(),this.htmlSplitArea.invalidateLayoutTree(!1))}this.addContainer(this.$parent,"split-box"),this._$splitArea=this.$parent.makeDiv("split-area"),this.addField(this._$splitArea),this.htmlSplitArea=ea.install(this._$splitArea,this.session),this.htmlSplitArea.setLayout(new u6(this)),this._$window=this.$parent.window(),this._$body=this.$parent.body(),this.firstField&&(this.firstField.render(this._$splitArea),this.firstField.$container.addClass("first-field").addClass(this.splitHorizontal?"x-axis":"y-axis"),this.firstField.on("propertyChange",e.bind(this)),this.secondField&&(this.secondField.render(this._$splitArea),this.secondField.$container.addClass("second-field").addClass(this.splitHorizontal?"x-axis":"y-axis"),this.secondField.on("propertyChange",e.bind(this)),this._$splitter=this._$splitArea.appendDiv("splitter").addClass(this.splitHorizontal?"x-axis":"y-axis").on("mousedown",function(e){if(1===e.which){var t,n,r,o,a,l;this.splitterEnabled&&(t={x:e.pageX,y:e.pageY},this._$window.on("mousemove.splitbox",f.bind(this)).on("mouseup.splitbox",h.bind(this)),this._$body.addClass(this.splitHorizontal?"col-resize":"row-resize"),s()("iframe").addClass("dragging-in-progress"),n=this._$splitArea.offset(),r=qs.size(this._$splitArea,!0),a=this._$splitter.offset(),o=qs.size(this._$splitter,!0),l=this._$splitArea.appendDiv("temp-splitter").addClass(this.splitHorizontal?"x-axis":"y-axis"),this.splitHorizontal?l.cssLeft(a.left-n.left):l.cssTop(a.top-n.top),this._$splitter.addClass("dragging"));var u=this.splitterPosition,c=10;return!1}function f(e){if(e.pageX!==t.x||e.pageY!==t.y)if(t={x:e.pageX,y:e.pageY},this.splitHorizontal){var s,a,f=e.pageX-n.left,h=Math.floor((o.width+Xs.get().fieldMandatoryIndicatorWidth)/2);this.splitterPositionType===i.SPLITTER_POSITION_TYPE_ABSOLUTE_FIRST?(s=O.nvl(this.minSplitterPosition,0),a=r.width-o.width+h):this.splitterPositionType===i.SPLITTER_POSITION_TYPE_RELATIVE_FIRST?(s=(r.width-o.width)*O.nvl(this.minSplitterPosition,0),a=r.width-o.width+h):this.splitterPositionType===i.SPLITTER_POSITION_TYPE_ABSOLUTE_SECOND?(s=0,a=r.width-o.width+h-O.nvl(this.minSplitterPosition,0)):this.splitterPositionType===i.SPLITTER_POSITION_TYPE_RELATIVE_SECOND&&(s=0,a=r.width-o.width+h-Math.floor(O.nvl(this.minSplitterPosition,0)*(r.width-o.width)));var p=h;f<s+h+c?(f=s,p=0):f>a-c&&(f=a),l.cssLeft(f-p),u=f-p,this.splitterPositionType===i.SPLITTER_POSITION_TYPE_RELATIVE_FIRST?u/=r.width-o.width:this.splitterPositionType===i.SPLITTER_POSITION_TYPE_RELATIVE_SECOND?u=1-u/(r.width-o.width):this.splitterPositionType===i.SPLITTER_POSITION_TYPE_ABSOLUTE_SECOND&&(u=r.width-o.width-u)}else{var d=e.pageY-n.top,y=Math.floor(o.height/2);d<c?(d=0,y=0):r.height-d<c&&(d=r.height,y=o.height),l.cssTop(d-y),u=d-y,this.splitterPositionType===i.SPLITTER_POSITION_TYPE_RELATIVE_FIRST?u/=r.height-o.height:this.splitterPositionType===i.SPLITTER_POSITION_TYPE_RELATIVE_SECOND?u=1-u/(r.height-o.height):this.splitterPositionType===i.SPLITTER_POSITION_TYPE_ABSOLUTE_SECOND&&(u=r.height-u-o.height)}}function h(e){1===e.which&&(this._$window.off("mousemove.splitbox").off("mouseup.splitbox"),l&&(this._$body.removeClass(this.splitHorizontal?"col-resize":"row-resize"),s()("iframe").removeClass("dragging-in-progress"),l.remove(),this._$splitter.removeClass("dragging"),this.newSplitterPosition(u,!0)))}}.bind(this)))),this._updateFieldVisibilityClasses()}},{key:"_renderProperties",value:function(){w4(T4(i.prototype),"_renderProperties",this).call(this),this._renderSplitterPosition(),this._renderSplitterEnabled(),this._renderCollapsibleField(),this._renderCollapseHandle(),this._renderFieldMinimized()}},{key:"_remove",value:function(){this._$splitArea=null,this._$splitter=null,w4(T4(i.prototype),"_remove",this).call(this)}},{key:"_setSplitterPosition",value:function(e){this._setProperty("splitterPosition",e),this._oldSplitterPositionType=null}},{key:"_renderSplitterPosition",value:function(){this.newSplitterPosition(this.splitterPosition,!1)}},{key:"_setSplitterPositionType",value:function(e){this.rendered&&!this._oldSplitterPositionType&&(this._oldSplitterPositionType=this.splitterPositionType),this._setProperty("splitterPositionType",e)}},{key:"_renderSplitterPositionType",value:function(){if(this._oldSplitterPositionType){var e=this.htmlSplitArea.size(),t=this.splitterPosition,n=qs.size(this._$splitter,!0),r=this.minSplitterPosition,o=0;o=this.splitHorizontal?e.width-n.width:e.height-n.height;var s=this._isSplitterPositionTypeRelative(this._oldSplitterPositionType),a=this._isSplitterPositionTypeRelative(this.splitterPositionType),l=!s,u=!a;s&&u?(this._oldSplitterPositionType===i.SPLITTER_POSITION_TYPE_RELATIVE_FIRST&&this.splitterPositionType===i.SPLITTER_POSITION_TYPE_ABSOLUTE_SECOND||this._oldSplitterPositionType===i.SPLITTER_POSITION_TYPE_RELATIVE_SECOND&&this.splitterPositionType===i.SPLITTER_POSITION_TYPE_ABSOLUTE_FIRST?t=o-o*t:t*=o,r&&(r*=o)):l&&a?(this._oldSplitterPositionType===i.SPLITTER_POSITION_TYPE_ABSOLUTE_FIRST&&this.splitterPositionType===i.SPLITTER_POSITION_TYPE_RELATIVE_SECOND||this._oldSplitterPositionType===i.SPLITTER_POSITION_TYPE_ABSOLUTE_SECOND&&this.splitterPositionType===i.SPLITTER_POSITION_TYPE_RELATIVE_FIRST?t=(o-t)/o:t/=o,r&&(r/=o)):t=l&&u?o-t:1-t,this.setMinSplitterPosition(r),this._oldSplitterPositionType=null,this.newSplitterPosition(t,!0)}}},{key:"_isSplitterPositionTypeRelative",value:function(e){return e===i.SPLITTER_POSITION_TYPE_RELATIVE_FIRST||e===i.SPLITTER_POSITION_TYPE_RELATIVE_SECOND}},{key:"_renderSplitterEnabled",value:function(){this._$splitter&&this._$splitter.setEnabled(this.splitterEnabled)}},{key:"setFieldCollapsed",value:function(e){this.setProperty("fieldCollapsed",e),this._updateCollapseHandleButtons()}},{key:"_renderFieldCollapsed",value:function(){this._renderCollapsibleField()}},{key:"setCollapsibleField",value:function(e){this.setProperty("collapsibleField",e),this._updateCollapseHandle()}},{key:"_updateCollapseHandle",value:function(){if(this.toggleCollapseKeyStroke&&this.unregisterKeyStrokes(this.toggleCollapseKeyStroke),this.firstCollapseKeyStroke&&this.unregisterKeyStrokes(this.firstCollapseKeyStroke),this.secondCollapseKeyStroke&&this.unregisterKeyStrokes(this.secondCollapseKeyStroke),this.collapsibleField){var e=Hf.HorizontalAlignment.LEFT;this.collapsibleField!==this.firstField&&(e=Hf.HorizontalAlignment.RIGHT),this._collapseHandle?this._collapseHandle.setHorizontalAlignment(e):(this._collapseHandle=O.create("CollapseHandle",{parent:this,horizontalAlignment:e}),this._collapseHandle.on("action",this.collapseHandleButtonPressed.bind(this)),this.toggleCollapseKeyStroke&&this.registerKeyStrokes(this.toggleCollapseKeyStroke),this.firstCollapseKeyStroke&&this.registerKeyStrokes(this.firstCollapseKeyStroke),this.secondCollapseKeyStroke&&this.registerKeyStrokes(this.secondCollapseKeyStroke),this.rendered&&this._renderCollapseHandle()),this._updateCollapseHandleButtons()}else this._collapseHandle&&(this._collapseHandle.destroy(),this._collapseHandle=null)}},{key:"_updateCollapseHandleButtons",value:function(){if(this._collapseHandle){var e,t,n=this.fieldCollapsed,r=this.fieldMinimized,o=this._isMinimizable(),s=this.splitterPositionType===i.SPLITTER_POSITION_TYPE_RELATIVE_FIRST||this.splitterPositionType===i.SPLITTER_POSITION_TYPE_ABSOLUTE_FIRST,a=s&&this.collapsibleField===this.secondField||!s&&this.collapsibleField===this.firstField;s?a?(e=!r&&o||n,t=!n):(e=!n,t=n||r&&o):a?(e=!n,t=!r&&o||n):(e=n||r&&o,t=!n),this._collapseHandle.setLeftVisible(e),this._collapseHandle.setRightVisible(t),this.firstCollapseKeyStroke&&(e?this.registerKeyStrokes(this.firstCollapseKeyStroke):this.unregisterKeyStrokes(this.firstCollapseKeyStroke)),this.secondCollapseKeyStroke&&(t?this.registerKeyStrokes(this.secondCollapseKeyStroke):this.unregisterKeyStrokes(this.secondCollapseKeyStroke))}}},{key:"getEffectiveSplitterPosition",value:function(){return this._isMinimizable()&&this.fieldMinimized?this.minSplitterPosition:this.splitterPosition}},{key:"setMinSplitterPosition",value:function(e){this.setProperty("minSplitterPosition",e),this._updateCollapseHandleButtons()}},{key:"_renderMinSplitterPosition",value:function(){this.rendered&&this.htmlSplitArea.invalidateLayoutTree(!1)}},{key:"setFieldMinimized",value:function(e){this.setProperty("fieldMinimized",e),this._updateCollapseHandleButtons()}},{key:"_renderFieldMinimized",value:function(){this.$container.removeClass("first-field-minimized second-field-minimized"),this.firstField&&this.firstField.$container.removeClass("minimized"),this.secondField&&this.secondField.$container.removeClass("minimized"),this.collapsibleField&&this.fieldMinimized&&(this.collapsibleField.$container.addClass("minimized"),this.$container.toggleClass("first-field-minimized",this.firstField===this.collapsibleField),this.$container.toggleClass("second-field-minimized",this.secondField===this.collapsibleField)),this.rendered&&this.htmlSplitArea.invalidateLayoutTree(!1)}},{key:"setMinimizeEnabled",value:function(e){this.setProperty("minimizeEnabled",e),this._isMinimizable()&&this._isSplitterPositionInMinimalRange(this.splitterPosition)&&this.setFieldMinimized(!0),this._updateCollapseHandleButtons()}},{key:"_renderMinimizeEnabled",value:function(){this.rendered&&this.htmlSplitArea.invalidateLayoutTree(!1)}},{key:"_isMinimizable",value:function(){return!!this.minSplitterPosition&&this.minimizeEnabled}},{key:"_renderCollapsibleField",value:function(){this.$container.removeClass("first-field-collapsed second-field-collapsed"),this.firstField&&this.firstField.$container.removeClass("collapsed"),this.secondField&&this.secondField.$container.removeClass("collapsed"),this.collapsibleField&&this.fieldCollapsed&&(this.collapsibleField.$container.addClass("collapsed"),this.$container.toggleClass("first-field-collapsed",this.firstField===this.collapsibleField),this.$container.toggleClass("second-field-collapsed",this.secondField===this.collapsibleField)),this.rendered&&this.htmlSplitArea.invalidateLayoutTree(!1)}},{key:"_setToggleCollapseKeyStroke",value:function(e){e&&(this.toggleCollapseKeyStroke instanceof zu&&this.unregisterKeyStrokes(this.collapseKeyStroke),this.toggleCollapseKeyStroke=new V4(this,e),this._collapseHandle&&this.registerKeyStrokes(this.toggleCollapseKeyStroke))}},{key:"_setFirstCollapseKeyStroke",value:function(e){e&&(this.firstCollapseKeyStroke instanceof zu&&this.unregisterKeyStrokes(this.firstCollapseKeyStroke),this.firstCollapseKeyStroke=new Y4(this,e),this._collapseHandle&&this.registerKeyStrokes(this.firstCollapseKeyStroke))}},{key:"_setSecondCollapseKeyStroke",value:function(e){e&&(this.secondCollapseKeyStroke instanceof zu&&this.unregisterKeyStrokes(this.secondCollapseKeyStroke),this.secondCollapseKeyStroke=new n6(this,e),this._collapseHandle&&this.registerKeyStrokes(this.secondCollapseKeyStroke))}},{key:"_renderCollapseHandle",value:function(){this._collapseHandle&&this._collapseHandle.render()}},{key:"newSplitterPosition",value:function(e,t){if(e=this._isSplitterPositionTypeRelative(this.splitterPositionType)?Math.max(0,Math.min(1,e)):Math.max(0,e),this._isMinimizable()&&this._isSplitterPositionInMinimalRange(e))this.setFieldMinimized(!0);else{var n=this.splitterPosition!==e;this.splitterPosition=e,n&&(this.trigger("positionChange",{position:e}),t&&this._updateFieldMinimized()),this._updateCollapseHandleButtons(),this.htmlSplitArea.invalidateLayoutTree(!1)}}},{key:"_updateFieldMinimized",value:function(){this._isMinimizable()?this.setFieldMinimized(this._isSplitterPositionInMinimalRange(this.splitterPosition)):this.setFieldMinimized(!1)}},{key:"_isSplitterPositionInMinimalRange",value:function(e){return!!this._isMinimizable()&&e<=this.minSplitterPosition}},{key:"toggleFieldCollapsed",value:function(){this.setFieldCollapsed(!this.fieldCollapsed)}},{key:"collapseHandleButtonPressed",value:function(e){var t=this.fieldCollapsed,n=this.fieldMinimized,r=this._isMinimizable(),o=this.splitterPositionType===i.SPLITTER_POSITION_TYPE_RELATIVE_FIRST||this.splitterPositionType===i.SPLITTER_POSITION_TYPE_ABSOLUTE_FIRST,s=!!e.left&&!o||!!e.right&&o;o&&this.collapsibleField===this.secondField||!o&&this.collapsibleField===this.firstField?s?t||(n&&r?this.setFieldMinimized(!1):this.setFieldCollapsed(!0)):t?this.setFieldCollapsed(!1):n||r&&this.setFieldMinimized(!0):s?t?this.setFieldCollapsed(!1):n&&this.setFieldMinimized(!1):t||(n||!r?this.setFieldCollapsed(!0):this.setFieldMinimized(!0))}},{key:"getFields",value:function(){var e=[];return this.firstField&&e.push(this.firstField),this.secondField&&e.push(this.secondField),e}},{key:"_updateFieldVisibilityClasses",value:function(){if(this.rendered||this.rendering){var e=this.firstField&&this.firstField.isVisible(),t=this.secondField&&this.secondField.isVisible(),n=!(e&&t)&&(e||t);this.$container.toggleClass("single-field",n)}}}])&&_4(t.prototype,n),r&&_4(t,r),i}(Iz);function R4(e){return(R4="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function x4(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function E4(e,t,n){return(E4="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=$4(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function D4(e,t){return(D4=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function A4(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=$4(e);if(t){var o=$4(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return F4(this,n)}}function F4(e,t){return!t||"object"!==R4(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function $4(e){return($4=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}C4(P4,"SPLITTER_POSITION_TYPE_RELATIVE_FIRST","relativeFirst"),C4(P4,"SPLITTER_POSITION_TYPE_RELATIVE_SECOND","relativeSecond"),C4(P4,"SPLITTER_POSITION_TYPE_ABSOLUTE_FIRST","absoluteFirst"),C4(P4,"SPLITTER_POSITION_TYPE_ABSOLUTE_SECOND","absoluteSecond");var j4=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&D4(e,t)}(i,e);var t,n,r,o=A4(i);function i(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(e=o.call(this))._addRemoteProperties(["collapsibleField","fieldCollapsed","minSplitterPosition","fieldMinimized"]),e}return t=i,(n=[{key:"_onWidgetPositionChange",value:function(e){this._send("setSplitterPosition",{splitterPosition:e.position})}},{key:"_onWidgetEvent",value:function(e){"positionChange"===e.type?this._onWidgetPositionChange(e):E4($4(i.prototype),"_onWidgetEvent",this).call(this,e)}}])&&x4(t.prototype,n),r&&x4(t,r),i}(zz);function B4(e){return(B4="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function M4(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function I4(e,t){return(I4=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function L4(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=N4(e);if(t){var o=N4(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return H4(this,n)}}function H4(e,t){return!t||"object"!==B4(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function N4(e){return(N4=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var V4=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&I4(e,t)}(i,e);var t,n,r,o=L4(i);function i(e,t){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(n=o.call(this)).field=e,n.parseAndSetKeyStroke(t),n}return t=i,(n=[{key:"handle",value:function(e){this.field.toggleFieldCollapsed()}},{key:"_postRenderKeyBox",value:function(e,t){var n,r=this.field._collapseHandle.$container;t.addClass("split-box-collapse-key-box"),n=r.offsetTo(this.field.$container),t.cssLeft(n.left-t.outerWidth()).cssTop(n.top)}}])&&M4(t.prototype,n),r&&M4(t,r),i}(zu);function W4(e){return(W4="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function z4(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function G4(e,t){return(G4=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function U4(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=q4(e);if(t){var o=q4(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return K4(this,n)}}function K4(e,t){return!t||"object"!==W4(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function q4(e){return(q4=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Y4=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&G4(e,t)}(i,e);var t,n,r,o=U4(i);function i(e,t){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(n=o.call(this)).field=e,n.parseAndSetKeyStroke(t),n}return t=i,(n=[{key:"handle",value:function(e){this.field.collapseHandleButtonPressed({left:!0})}},{key:"_postRenderKeyBox",value:function(e,t){var n,r=this.field._collapseHandle.$container;t.addClass("split-box-collapse-key-box left"),n=r.offsetTo(this.field.$container),t.cssLeft(n.left-t.outerWidth()).cssTop(n.top)}}])&&z4(t.prototype,n),r&&z4(t,r),i}(zu);function X4(e){return(X4="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function J4(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Z4(e,t){return(Z4=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Q4(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=t6(e);if(t){var o=t6(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return e6(this,n)}}function e6(e,t){return!t||"object"!==X4(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function t6(e){return(t6=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var n6=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Z4(e,t)}(i,e);var t,n,r,o=Q4(i);function i(e,t){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(n=o.call(this)).field=e,n.parseAndSetKeyStroke(t),n}return t=i,(n=[{key:"handle",value:function(e){this.field.collapseHandleButtonPressed({right:!0})}},{key:"_postRenderKeyBox",value:function(e,t){var n,r=this.field._collapseHandle.$container;t.addClass("split-box-collapse-key-box right"),n=r.offsetTo(this.field.$container),t.cssLeft(n.left+r.width()-t.outerWidth()).cssTop(n.top-t.outerHeight())}}])&&J4(t.prototype,n),r&&J4(t,r),i}(zu);function r6(e){return(r6="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o6(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function i6(e,t){return(i6=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function s6(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=l6(e);if(t){var o=l6(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return a6(this,n)}}function a6(e,t){return!t||"object"!==r6(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function l6(e){return(l6=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var u6=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&i6(e,t)}(i,e);var t,n,r,o=s6(i);function i(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(t=o.call(this)).splitBox=e,t}return t=i,(n=[{key:"layout",value:function(e){var t=ea.get(e),n=e.children(".splitter"),r=e.children(".form-field"),o=ea.optGet(r.eq(0)),i=ea.optGet(r.eq(1)),s=this.splitBox.splitHorizontal;n.removeClass("hidden");var a,l,u,c,f=t.availableSize().subtract(t.insets()),h=o&&o.isVisible(),p=i&&i.isVisible(),d=h&&p,y=!d&&(h||p),v=this.splitBox.getEffectiveSplitterPosition(),b=new $s(f);if(d&&(s?b.width-=o.margins().right:b.height-=o.margins().bottom),d)a=new $s(b),l=new $s(b),this.computeInnerFieldsDimensions(s,a,l,v),u=new Hs(0,0,a.width,a.height),c=new Hs(0,0,l.width,l.height),s?(n.cssLeft(u.width),c.x=u.width+o.margins().right):(n.cssTop(u.height),c.y=u.height+o.margins().bottom),o.setBounds(u),i.setBounds(c);else{if(y){var m=h?o:i,g=f.subtract(m.margins());m.setBounds(new Hs(0,0,g.width,g.height))}n.addClass("hidden")}if(this.splitBox._collapseHandle){var _=this.splitBox._collapseHandle.$container,w=this.splitBox.firstField&&this.splitBox.firstField.visible&&this.splitBox.secondField&&this.splitBox.secondField.visible;_.setVisible(w);var k=null;if(d&&this.splitBox.collapsibleField===this.splitBox.firstField){var S=qs.size(_);k=u.width-S.width}_.cssLeft(k)}}},{key:"preferredLayoutSize",value:function(e,t){var n=ea.get(e),r=e.children(".form-field"),o=ea.optGet(r.eq(0)),i=ea.optGet(r.eq(1)),a=this.splitBox.splitHorizontal,l=this.splitBox.getEffectiveSplitterPosition(),u=s.a.extend({},t),c=s.a.extend({},t);if(t.widthHint){var f=new $s(t.widthHint,0),h=new $s(t.widthHint,0);this.computeInnerFieldsDimensions(a,f,h,l),u.widthHint=f.width,c.widthHint=h.width}var p=new $s(0,0);o&&(p=o.prefSize(u).add(o.margins()));var d=new $s(0,0);return i&&(d=i.prefSize(c).add(i.margins())),(a?new $s(p.width+d.width,Math.max(p.height,d.height)):new $s(Math.max(p.width,d.width),p.height+d.height)).add(n.insets())}},{key:"computeInnerFieldsDimensions",value:function(e,t,n,r){e?this.splitBox.splitterPositionType===P4.SPLITTER_POSITION_TYPE_RELATIVE_FIRST?(t.width=Math.floor(t.width*r),n.width-=t.width):this.splitBox.splitterPositionType===P4.SPLITTER_POSITION_TYPE_RELATIVE_SECOND?(n.width=Math.floor(n.width*r),t.width-=n.width):(r=Math.min(r,t.width),this.splitBox.splitterPositionType===P4.SPLITTER_POSITION_TYPE_ABSOLUTE_SECOND?(t.width=t.width-r,n.width=r):(t.width=r,n.width=n.width-r)):this.splitBox.splitterPositionType===P4.SPLITTER_POSITION_TYPE_RELATIVE_FIRST?(t.height=Math.floor(t.height*r),n.height-=t.height):this.splitBox.splitterPositionType===P4.SPLITTER_POSITION_TYPE_RELATIVE_SECOND?(n.height=Math.floor(n.height*r),t.height-=n.height):(r=Math.min(r,t.height),this.splitBox.splitterPositionType===P4.SPLITTER_POSITION_TYPE_ABSOLUTE_SECOND?(t.height=t.height-r,n.height=r):(t.height=r,n.height=n.height-r))}}])&&o6(t.prototype,n),r&&o6(t,r),i}(Zs);function c6(e){return(c6="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function f6(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function h6(e,t,n){return(h6="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=b6(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function p6(e,t){return(p6=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function d6(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=b6(e);if(t){var o=b6(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return y6(this,n)}}function y6(e,t){return!t||"object"!==c6(t)&&"function"!=typeof t?v6(e):t}function v6(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function b6(e){return(b6=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function m6(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var g6=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&p6(e,t)}(i,e);var t,n,r,o=d6(i);function i(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(e=o.call(this)).format,e.hasAction=!1,e.inputMasked=!1,e.inputObfuscated=!1,e.maxLength=4e3,e.multilineText=!1,e.selectionStart=0,e.selectionEnd=0,e.selectionTrackingEnabled=!1,e.spellCheckEnabled=!1,e.trimText=!0,e.wrapText=!1,e._onSelectionChangingActionHandler=e._onSelectionChangingAction.bind(v6(e)),e}return t=i,(n=[{key:"_initValue",value:function(e){e=bp.resolveText(e,this.session.locale.languageTag),h6(b6(i.prototype),"_initValue",this).call(this,e)}},{key:"_initKeyStrokeContext",value:function(){h6(b6(i.prototype),"_initKeyStrokeContext",this).call(this),this.keyStrokeContext.registerKeyStroke([new W6(this),new J6(this)])}},{key:"_createKeyStrokeContext",value:function(){return new Vu}},{key:"_render",value:function(){var e;this.addContainer(this.$parent,"string-field",new P6(this)),this.addLabel(),this.addMandatoryIndicator(),this.multilineText?(e=this._makeMultilineField(),this.$container.addClass("multiline")):e=TW.makeTextField(this.$parent),e.on("paste",this._onFieldPaste.bind(this)),this.addField(e),this.addStatus()}},{key:"_makeMultilineField",value:function(){var e=this,t=function(){this.mouseClicked=!0}.bind(this);return this.$parent.makeElement("<textarea>").on("DOMMouseScroll mousewheel",this._onMouseWheel.bind(this)).on("mousedown",t).on("focus",(function(n){e.$field.off("mousedown",t),e.mouseClicked||setTimeout((function(){e.rendered&&!e.session.focusManager.isElementCovertByGlassPane(e.$field)&&(e._renderSelectionStart(),e._renderSelectionEnd())})),e.mouseClicked=!1})).on("focusout",(function(){e.$field.on("mousedown",t)})).addDeviceClass()}},{key:"_onFieldBlur",value:function(){h6(b6(i.prototype),"_onFieldBlur",this).call(this),this.multilineText&&this._updateSelection(),this.inputObfuscated&&this.$field.val(this.displayText)}},{key:"_onMouseWheel",value:function(e){var t=(e=e.originalEvent||this.$container.window(!0).event.originalEvent).wheelDelta?-e.wheelDelta:e.detail,n=this.$field[0].scrollTop;if(!(t<0&&0===n)){var r=this.$field[0].scrollHeight-this.$field[0].clientHeight;t>0&&n>=r-1?this.$field[0].scrollTop=r:e.stopPropagation()}}},{key:"_renderProperties",value:function(){h6(b6(i.prototype),"_renderProperties",this).call(this),this._renderInputMasked(),this._renderWrapText(),this._renderFormat(),this._renderSpellCheckEnabled(),this._renderHasAction(),this._renderMaxLength(),this._renderSelectionTrackingEnabled(),this._renderDropType()}},{key:"addIcon",value:function(){this.$icon=TW.appendIcon(this.$container).on("click",this._onIconClick.bind(this))}},{key:"isClearable",value:function(){return h6(b6(i.prototype),"isClearable",this).call(this)&&!this.multilineText}},{key:"setMaxLength",value:function(e){this.setProperty("maxLength",e)}},{key:"_renderMaxLength",value:function(){var e=this;function t(){var e=this.$field.val();e.length>this.maxLength&&this.$field.val(e.slice(0,this.maxLength))}this.$field[0].maxLength?this.$field.attr("maxlength",this.maxLength):this.$field.on("keyup paste",(function(n){setTimeout(t.bind(e),0)})),t.call(this),this.rendering||this.parseAndSetValue(this._readDisplayText())}},{key:"setSelectionStart",value:function(e){this.setProperty("selectionStart",e)}},{key:"_renderSelectionStart",value:function(){null!==O.nvl(this.selectionStart,null)&&(this.$field[0].selectionStart=this.selectionStart)}},{key:"setSelectionEnd",value:function(e){this.setProperty("selectionEnd",e)}},{key:"_renderSelectionEnd",value:function(){null!==O.nvl(this.selectionEnd,null)&&(this.$field[0].selectionEnd=this.selectionEnd)}},{key:"setSelectionTrackingEnabled",value:function(e){this.setProperty("selectionTrackingEnabled",e)}},{key:"_renderSelectionTrackingEnabled",value:function(){this.$field.off("select",this._onSelectionChangingActionHandler).off("mousedown",this._onSelectionChangingActionHandler).off("keydown",this._onSelectionChangingActionHandler).off("input",this._onSelectionChangingActionHandler),this.selectionTrackingEnabled&&this.$field.on("select",this._onSelectionChangingActionHandler).on("mousedown",this._onSelectionChangingActionHandler).on("keydown",this._onSelectionChangingActionHandler).on("input",this._onSelectionChangingActionHandler)}},{key:"setInputMasked",value:function(e){this.setProperty("inputMasked",e)}},{key:"_renderInputMasked",value:function(){this.multilineText||this.$field.attr("type",this.inputMasked?"password":"text")}},{key:"_renderInputObfuscated",value:function(){this.inputObfuscated&&this.focused&&this.$field.val("")}},{key:"setHasAction",value:function(e){this.setProperty("hasAction",e)}},{key:"_renderHasAction",value:function(){this.hasAction?(this.$icon||this.addIcon(),this.$container.addClass("has-icon")):(this._removeIcon(),this.$container.removeClass("has-icon")),this.revalidateLayout()}},{key:"setFormatUpper",value:function(e){e?this.setFormat(i.Format.UPPER):this.setFormat(null)}},{key:"setFormatLower",value:function(e){e?this.setFormat(i.Format.LOWER):this.setFormat(null)}},{key:"setFormat",value:function(e){this.setProperty("format",e)}},{key:"_renderFormat",value:function(){this.format===i.Format.LOWER?this.$field.css("text-transform","lowercase"):this.format===i.Format.UPPER?this.$field.css("text-transform","uppercase"):this.$field.css("text-transform","")}},{key:"setSpellCheckEnabled",value:function(e){this.setProperty("spellCheckEnabled",e)}},{key:"_renderSpellCheckEnabled",value:function(){this.spellCheckEnabled?this.$field.attr("spellcheck","true"):this.$field.attr("spellcheck","false")}},{key:"_renderDisplayText",value:function(){if(this.inputObfuscated&&this.focused)this.$field.val("");else{var e=Wn.nvl(this.displayText),t=Wn.nvl(this.$field.val()),n=this._getSelection();if(h6(b6(i.prototype),"_renderDisplayText",this).call(this),this.trimText&&t!==e){var r=t.match(i.TRIM_REGEXP);r&&r[2]===e&&this._setSelection({start:Math.max(n.start-r[1].length,0),end:Math.min(n.end-r[1].length,e.length)})}}}},{key:"insertText",value:function(e){this.rendered?this._insertText(e):this._postRenderActions.push(this.insertText.bind(this,e))}},{key:"_insertText",value:function(e){if(e){var t=this._getSelection(),n=this._applyTextToSelection(this.$field.val(),e,t);n.length>this.maxLength?this._showNotification("ui.CannotInsertTextTooLong"):(this.$field.val(n),this._setSelection(t.start+e.length),this.updateDisplayTextOnModify&&this.acceptInput(!0),this.acceptInput())}}},{key:"_applyTextToSelection",value:function(e,t,n){return this.inputObfuscated&&(e=""),e.slice(0,n.start)+t+e.slice(n.end)}},{key:"setWrapText",value:function(e){this.setProperty("wrapText",e)}},{key:"_renderWrapText",value:function(){this.$field.attr("wrap",this.wrapText?"soft":"off")}},{key:"setTrimText",value:function(e){this.setProperty("trimText",e)}},{key:"_renderTrimText",value:function(){}},{key:"_renderGridData",value:function(){h6(b6(i.prototype),"_renderGridData",this).call(this),this.updateInnerAlignment({useHorizontalAlignment:!this.multilineText})}},{key:"_renderGridDataHints",value:function(){h6(b6(i.prototype),"_renderGridDataHints",this).call(this),this.updateInnerAlignment({useHorizontalAlignment:!0})}},{key:"_onIconClick",value:function(e){this.acceptInput(),this.$field.focus(),this.trigger("action")}},{key:"_onSelectionChangingAction",value:function(e){var t=this;"mousedown"===e.type?this.$field.window().one("mouseup.stringfield",(function(){setTimeout(t._updateSelection.bind(t))})):"keydown"===e.type?setTimeout(this._updateSelection.bind(this)):this._updateSelection()}},{key:"_getSelection",value:function(){var e=O.nvl(this.$field[0].selectionStart,null),t=O.nvl(this.$field[0].selectionEnd,null);return null!==e&&null!==t||(e=0,t=0),{start:e,end:t}}},{key:"_setSelection",value:function(e,t){"number"==typeof e?t=O.nvl(t,e):"object"===c6(e)&&(t=e.end,e=e.start),this.$field[0].selectionStart=e,this.$field[0].selectionEnd=t,this._updateSelection()}},{key:"_updateSelection",value:function(){var e=this.selectionStart,t=this.selectionEnd;this.selectionStart=this.$field[0].selectionStart,this.selectionEnd=this.$field[0].selectionEnd,this.selectionTrackingEnabled&&(this.selectionStart!==e||this.selectionEnd!==t)&&this.triggerSelectionChange()}},{key:"triggerSelectionChange",value:function(){this.trigger("selectionChange",{selectionStart:this.selectionStart,selectionEnd:this.selectionEnd})}},{key:"_validateValue",value:function(e){return Pr.isNullOrUndefined(e)?e:(e=Wn.asString(e),this.trimText&&(e=e.trim()),h6(b6(i.prototype),"_validateValue",this).call(this,e))}},{key:"_clear",value:function(){h6(b6(i.prototype),"_clear",this).call(this),this.inputObfuscated=!1}},{key:"_updateEmpty",value:function(){this.empty=Wn.empty(this.value)}},{key:"acceptInput",value:function(e){var t=O.nvl(this._readDisplayText(),"");this.inputObfuscated&&""!==t&&(this.inputObfuscated=!1),h6(b6(i.prototype),"acceptInput",this).call(this,e)}},{key:"_onFieldFocus",value:function(e){var t=this;h6(b6(i.prototype),"_onFieldFocus",this).call(this,e),this.inputObfuscated&&(this.$field.val(""),setTimeout((function(){if(t.rendered){var e=t.$field[0];e.selectionStart=0,e.selectionEnd=0}})))}},{key:"_getClipboardData",value:function(e,t){var n=e.originalEvent.clipboardData||this.$container.window(!0).clipboardData;if(n){if(n.items&&n.items.length){var r=rt.find(n.items,(function(e){return"text/plain"===e.type}));return void(r&&r.getAsString(t))}n.getData&&t(n.getData("Text"))}}},{key:"_onFieldPaste",value:function(e){var t=this,n=this.$field.val(),r=this._getSelection();this._getClipboardData(e,(function(e){e&&(n=t._applyTextToSelection(n,e,r)).length>t.maxLength&&t._showNotification("ui.PastedTextTooLong")}))}},{key:"_showNotification",value:function(e){O.create("DesktopNotification",{parent:this,severity:Br.Severity.WARNING,message:this.session.text(e)}).show()}},{key:"_checkDisplayTextChanged",value:function(e,t){var n=h6(b6(i.prototype),"_checkDisplayTextChanged",this).call(this,e,t);return(!n||!this.inputObfuscated||""!==e)&&n}}])&&f6(t.prototype,n),r&&f6(t,r),i}(yG);function _6(e){return(_6="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function w6(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function k6(e,t,n){return(k6="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=C6(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function S6(e,t){return(S6=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function O6(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=C6(e);if(t){var o=C6(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return T6(this,n)}}function T6(e,t){return!t||"object"!==_6(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function C6(e){return(C6=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}m6(g6,"Format",{LOWER:"a",UPPER:"A"}),m6(g6,"TRIM_REGEXP",new RegExp("^(\\s*)(.*?)(\\s*)$"));var P6=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&S6(e,t)}(i,e);var t,n,r,o=O6(i);function i(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),o.call(this,e)}return t=i,(n=[{key:"_layoutClearIcon",value:function(e,t,n,r){e.$icon&&e.$icon.isVisible()&&(n+=qs.prefSize(e.$icon,!0).width),k6(C6(i.prototype),"_layoutClearIcon",this).call(this,e,t,n,r)}}])&&w6(t.prototype,n),r&&w6(t,r),i}(dz);function R6(e){return(R6="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function x6(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function E6(e,t,n){return(E6="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=$6(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function D6(e,t){return(D6=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function A6(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=$6(e);if(t){var o=$6(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return F6(this,n)}}function F6(e,t){return!t||"object"!==R6(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function $6(e){return($6=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var j6=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&D6(e,t)}(i,e);var t,n,r,o=A6(i);function i(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),o.call(this)}return t=i,(n=[{key:"_initProperties",value:function(e){void 0!==e.insertText&&delete e.insertText}},{key:"_syncInsertText",value:function(e){this.widget.insertText(e)}},{key:"_onWidgetSelectionChange",value:function(e){this._send("selectionChange",{selectionStart:e.selectionStart,selectionEnd:e.selectionEnd},{showBusyIndicator:!1,delay:500,coalesce:function(e){return this.target===e.target&&this.type===e.type}})}},{key:"_onWidgetAction",value:function(e){this._send("action")}},{key:"_onWidgetEvent",value:function(e){"selectionChange"===e.type?this._onWidgetSelectionChange(e):"action"===e.type?this._onWidgetAction(e):E6($6(i.prototype),"_onWidgetEvent",this).call(this,e)}}])&&x6(t.prototype,n),r&&x6(t,r),i}(wG);function B6(e){return(B6="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function M6(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function I6(e,t,n){return(I6="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=V6(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function L6(e,t){return(L6=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function H6(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=V6(e);if(t){var o=V6(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return N6(this,n)}}function N6(e,t){return!t||"object"!==B6(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function V6(e){return(V6=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var W6=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&L6(e,t)}(i,e);var t,n,r,o=H6(i);function i(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(t=o.call(this)).field=e,t.which=[Ou.ENTER],t.renderingHints.render=!1,t.preventDefault=!1,t}return t=i,(n=[{key:"_applyPropagationFlags",value:function(e){I6(V6(i.prototype),"_applyPropagationFlags",this).call(this,e);var t=this.field.$container.activeElement(!0);this.preventInvokeAcceptInputOnActiveValueField=!e.isPropagationStopped()&&"textarea"===t.tagName.toLowerCase(),this.preventInvokeAcceptInputOnActiveValueField&&e.stopPropagation()}},{key:"handle",value:function(e){}}])&&M6(t.prototype,n),r&&M6(t,r),i}(zu);function z6(e){return(z6="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function G6(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function U6(e,t,n){return(U6="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=X6(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function K6(e,t){return(K6=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function q6(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=X6(e);if(t){var o=X6(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Y6(this,n)}}function Y6(e,t){return!t||"object"!==z6(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function X6(e){return(X6=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var J6=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&K6(e,t)}(i,e);var t,n,r,o=q6(i);function i(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(t=o.call(this)).field=e,t.which=[Ou.ENTER],t.ctrl=!0,t}return t=i,(n=[{key:"_accept",value:function(e){return U6(X6(i.prototype),"_accept",this).call(this,e)&&this.field.hasAction}},{key:"handle",value:function(e){this.field._onIconClick()}}])&&G6(t.prototype,n),r&&G6(t,r),i}(zu);function Z6(e){return(Z6="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Q6(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function e9(e,t,n){return(e9="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=i9(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function t9(e,t){return(t9=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function n9(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=i9(e);if(t){var o=i9(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return r9(this,n)}}function r9(e,t){return!t||"object"!==Z6(t)&&"function"!=typeof t?o9(e):t}function o9(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function i9(e){return(i9=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var s9=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&t9(e,t)}(i,e);var t,n,r,o=n9(i);function i(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(e=o.call(this)).gridDataHints.useUiHeight=!0,e.gridDataHints.w=ZW.FULL_WIDTH,e.menusVisible=!1,e.selectedTab=null,e.tabItems=[],e.tabAreaStyle=u8.DisplayStyle.DEFAULT,e._addWidgetProperties(["tabItems","selectedTab"]),e._addPreserveOnPropertyChangeProperties(["selectedTab"]),e._$tabContent=null,e._tabBoxHeaderPropertyChangeHander=e._onTabBoxHeaderPropertyChange.bind(o9(e)),e}return t=i,(n=[{key:"_init",value:function(e){e9(i9(i.prototype),"_init",this).call(this,e),this.header=O.create("TabBoxHeader",{parent:this,tabBox:this}),this._initProperties(e),this.header.on("propertyChange",this._tabBoxHeaderPropertyChangeHander)}},{key:"_initProperties",value:function(e){this._setTabItems(this.tabItems),this._setSelectedTab(this.selectedTab),this._setTabAreaStyle(this.tabAreaStyle)}},{key:"_destroy",value:function(){e9(i9(i.prototype),"_destroy",this).call(this),this.header.off("propertyChange",this._tabBoxHeaderPropertyChangeHander)}},{key:"_render",value:function(){this.addContainer(this.$parent,"tab-box",new T8(this)),this.header.render(this.$container),this.addStatus(),this._$tabContent=this.$container.appendDiv("tab-content"),ea.install(this._$tabContent,this.session).setLayout(new Ml)}},{key:"_renderProperties",value:function(){e9(i9(i.prototype),"_renderProperties",this).call(this),this._renderSelectedTab()}},{key:"_remove",value:function(){e9(i9(i.prototype),"_remove",this).call(this),this._removeSelectedTab()}},{key:"_getCurrentMenus",value:function(){return[]}},{key:"_removeMenus",value:function(){}},{key:"deleteTabItem",value:function(e){var t=this.tabItems.indexOf(e),n=this.tabItems.slice();t>=0&&(n.splice(t,1),this.setTabItems(n))}},{key:"insertTabItem",value:function(e,t){if(e){t=O.nvl(t,this.tabItems.length);var n=this.tabItems.slice();n.splice(t,0,e),this.setTabItems(n)}}},{key:"setTabItems",value:function(e){this.setProperty("tabItems",e)}},{key:"_setTabItems",value:function(e){e=e||[],(this.tabItems||[]).filter((function(t){return e.indexOf(t)<0}),this).forEach((function(e){e.remove()})),this._setProperty("tabItems",e),this.header.setTabItems(this.tabItems),this.tabItems.indexOf(this.selectedTab)<0&&this.setSelectedTab(this.tabItems[0])}},{key:"_renderTabItems",value:function(e){}},{key:"_removeTabItems",value:function(e){}},{key:"_removeTabContent",value:function(){this.tabItems.forEach((function(e){e.remove()}),this)}},{key:"selectTabById",value:function(e){var t=this.getTabItem(e);if(!t)throw new Error("Tab with ID '"+e+"' does not exist");this.setSelectedTab(t)}},{key:"setSelectedTab",value:function(e){this.setProperty("selectedTab",e)}},{key:"_setSelectedTab",value:function(e){s.a.log.isDebugEnabled()&&s.a.log.debug("(TabBox#_selectTab) tab="+e),this.selectedTab&&this.selectedTab.rendered&&this.selectedTab.remove(),this._setProperty("selectedTab",e),this.header.setSelectedTabItem(this.selectedTab)}},{key:"_renderSelectedTab",value:function(){this.selectedTab&&this.selectedTab.render(this._$tabContent),this.rendered&&ea.get(this._$tabContent).revalidateLayoutTree()}},{key:"_removeSelectedTab",value:function(){this.selectedTab&&this.selectedTab.remove()}},{key:"setTabAreaStyle",value:function(e){this.setProperty("tabAreaStyle",e)}},{key:"_setTabAreaStyle",value:function(e){this.tabAreaStyle=e,this.header&&this.header.tabArea&&this.header.tabArea.setDisplayStyle(e)}},{key:"_renderStatusPosition",value:function(){e9(i9(i.prototype),"_renderStatusPosition",this).call(this),this.fieldStatus&&(this.statusPosition===ZW.StatusPosition.TOP?this.$status.appendTo(this.header.$container):this.$status.appendTo(this.$container),this.invalidateLayoutTree())}},{key:"_updateFieldStatus",value:function(){e9(i9(i.prototype),"_updateFieldStatus",this).call(this),this.selectedTab&&this.selectedTab.notification&&this.selectedTab.invalidateLayoutTree()}},{key:"getFields",value:function(){return this.tabItems}},{key:"getTabItem",value:function(e){return rt.find(this.tabItems,(function(t){return t.id===e}))}},{key:"focus",value:function(){return this.rendered?this.selectedTab?this.selectedTab.focus():void 0:(this.session.layoutValidator.schedulePostValidateFunction(this.focus.bind(this)),!1)}},{key:"getFocusableElement",value:function(){return this.selectedTab?this.selectedTab.getFocusableElement():null}},{key:"isTabItemFocused",value:function(e){return this.header.isTabItemFocused(e)}},{key:"focusTabItem",value:function(e){this.selectedTab!==e&&this.selectTab(e),this.header.focusTabItem(e)}},{key:"_onTabBoxHeaderPropertyChange",value:function(e){"selectedTabItem"===e.propertyName&&this.setSelectedTab(e.newValue)}}])&&Q6(t.prototype,n),r&&Q6(t,r),i}(Iz);function a9(e){return(a9="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function l9(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function u9(e,t){return(u9=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function c9(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=h9(e);if(t){var o=h9(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return f9(this,n)}}function f9(e,t){return!t||"object"!==a9(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function h9(e){return(h9=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var p9=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&u9(e,t)}(i,e);var t,n,r,o=c9(i);function i(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(t=o.call(this)).field=e,t.which=[Ou.LEFT],t.renderingHints.render=!1,t.stopPropagation=!0,t.keyStrokeMode=zu.Mode.DOWN,t}return t=i,(n=[{key:"handle",value:function(e){this.field.selectPreviousTab(!0)}}])&&l9(t.prototype,n),r&&l9(t,r),i}(zu);function d9(e){return(d9="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function y9(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function v9(e,t){return(v9=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function b9(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=g9(e);if(t){var o=g9(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return m9(this,n)}}function m9(e,t){return!t||"object"!==d9(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function g9(e){return(g9=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var _9=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&v9(e,t)}(i,e);var t,n,r,o=b9(i);function i(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(t=o.call(this)).field=e,t.which=[Ou.RIGHT],t.renderingHints.render=!1,t.stopPropagation=!0,t.keyStrokeMode=zu.Mode.DOWN,t}return t=i,(n=[{key:"handle",value:function(e){this.field.selectNextTab(!0)}}])&&y9(t.prototype,n),r&&y9(t,r),i}(zu);function w9(e){return(w9="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function k9(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function S9(e,t,n){return(S9="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=P9(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function O9(e,t){return(O9=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function T9(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=P9(e);if(t){var o=P9(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return C9(this,n)}}function C9(e,t){return!t||"object"!==w9(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function P9(e){return(P9=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var R9=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&O9(e,t)}(i,e);var t,n,r,o=T9(i);function i(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(e=o.call(this))._addRemoteProperties(["selectedTab"]),e}return t=i,(n=[{key:"exportAdapterData",value:function(e){return delete(e=S9(P9(i.prototype),"exportAdapterData",this).call(this,e)).selectedTab,e}}])&&k9(t.prototype,n),r&&k9(t,r),i}(zz);function x9(e){return(x9="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function E9(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function D9(e,t){return(D9=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function A9(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=j9(e);if(t){var o=j9(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return F9(this,n)}}function F9(e,t){return!t||"object"!==x9(t)&&"function"!=typeof t?$9(e):t}function $9(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function j9(e){return(j9=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var B9=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&D9(e,t)}(i,e);var t,n,r,o=A9(i);function i(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(t=o.call(this)).tabBoxHeader=e,t._initDefaults(),t.htmlPropertyChangeHandler=t._onHtmlEnvironmentPropertyChange.bind($9(t)),Xs.get().on("propertyChange",t.htmlPropertyChangeHandler),t.tabBoxHeader.one("remove",(function(){Xs.get().off("propertyChange",t.htmlPropertyChangeHandler)})),t}return t=i,(n=[{key:"_initDefaults",value:function(){this.fieldStatusWidth=Xs.get().fieldStatusWidth}},{key:"_onHtmlEnvironmentPropertyChange",value:function(){this._initDefaults(),this.tabBoxHeader.invalidateLayoutTree()}},{key:"layout",value:function(e){var t,n,r=ea.get(e),o=this.tabBoxHeader.tabArea,i=o.htmlComp.margins(),s=this.tabBoxHeader.menuBar,a=s.htmlComp.margins(),l=this.tabBoxHeader.tabBox.$status,u=new $s,c=r.insets(),f=r.availableSize({exact:!0}).subtract(r.insets()),h=new Hs(c.left,c.top,f.width,f.height),p=h.x;n=s.htmlComp.prefSize({widthHint:0}),this.tabBoxHeader.tabBox.statusPosition===ZW.StatusPosition.TOP&&l&&l.isVisible()&&(u.height=l.outerHeight(!0),u.width=this.fieldStatusWidth+qs.margins(l).horizontal()),t=o.htmlComp.prefSize({widthHint:h.width-n.width-a.horizontal()-u.width,exact:!1}),o.htmlComp.setBounds(new Hs(h.x+i.left,c.top+i.top,t.width,h.height-i.vertical())),s.htmlComp.layout.collapsed=o.htmlComp.layout.overflowTabs.length>0,s.htmlComp.setBounds(new Hs(p+t.width+i.horizontal()+a.left,c.top+a.top,h.width-t.width-i.horizontal()-a.horizontal()-u.width,h.height-a.vertical())),this.tabBoxHeader.tabBox.statusPosition===ZW.StatusPosition.TOP&&l&&l.isVisible()&&l.cssWidth(this.fieldStatusWidth).cssRight(c.left).cssHeight(h.height-qs.margins(l).vertical()).cssLineHeight(h.height-qs.margins(l).vertical())}},{key:"preferredLayoutSize",value:function(e,t){var n,r,o,i=ea.get(e),s=i.insets(),a=(t.widthHint||i.availableSize().width)-i.insets().horizontal(),l=new $s,u=this.tabBoxHeader.tabBox.$status,c=new $s,f=this.tabBoxHeader.tabArea,h=f.htmlComp.margins(),p=this.tabBoxHeader.menuBar,d=p.htmlComp.margins();return r=p.htmlComp.prefSize({widthHint:0}),this.tabBoxHeader.tabBox.statusPosition===ZW.StatusPosition.TOP&&u&&u.isVisible()&&(c.height=u.outerHeight(!0),c.width=this.fieldStatusWidth+qs.margins(u).horizontal(),l.width+=c.width,l.height=Math.max(l.height,c.height)),n=f.htmlComp.prefSize({widthHint:a-r.width-d.horizontal()-h.horizontal()-c.width}),l.width+=n.width+h.horizontal(),l.height=Math.max(l.height,n.height+h.vertical()),o=p.htmlComp.prefSize({widthHint:a-n.width-h.horizontal()-d.horizontal()-c.width}),l.width+=o.width+d.horizontal(),l.height=Math.max(l.height,o.height+d.vertical()),l.add(s)}}])&&E9(t.prototype,n),r&&E9(t,r),i}(Zs);function M9(e){return(M9="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function I9(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function L9(e,t,n){return(L9="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=z9(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function H9(e,t){return(H9=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function N9(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=z9(e);if(t){var o=z9(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return V9(this,n)}}function V9(e,t){return!t||"object"!==M9(t)&&"function"!=typeof t?W9(e):t}function W9(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function z9(e){return(z9=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var G9=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&H9(e,t)}(i,e);var t,n,r,o=N9(i);function i(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(e=o.call(this)).tabBox=null,e.tabArea=null,e.menuBar=null,e.$container=null,e.htmlComp=null,e.$borderBottom=null,e._tabBoxPropertyChangeHandler=e._onTabBoxPropertyChange.bind(W9(e)),e._tabAreaPropertyChangeHandler=e._onTabAreaPropertyChange.bind(W9(e)),e}return t=i,(n=[{key:"_init",value:function(e){L9(z9(i.prototype),"_init",this).call(this,e),this.tabArea=O.create("TabArea",{parent:this,tabBox:this.tabBox}),this.tabArea.on("propertyChange",this._tabAreaPropertyChangeHandler),this.menuBar=O.create("MenuBar",{parent:this,menuOrder:new zJ}),this.tabBox.on("propertyChange",this._tabBoxPropertyChangeHandler),this.menuBar.setMenuItems(this.tabBox.menus),this.setVisible(this.tabBox.labelVisible)}},{key:"_render",value:function(){this.$container=this.$parent.appendDiv("tab-box-header"),this.$borderBottom=this.$container.appendDiv("tab-box-header-bottom-border"),this.htmlComp=ea.install(this.$container,this.session),this.htmlComp.setLayout(new B9(this)),this.tabArea.render(this.$container),this.menuBar.render(this.$container),this.$container.append(this.menuBar.$container)}},{key:"_destroy",value:function(){this.tabBox.off("propertyChange",this._tabBoxPropertyChangeHandler),this.tabArea.off("propertyChange",this._tabAreaPropertyChangeHandler),L9(z9(i.prototype),"_destroy",this).call(this)}},{key:"setTabItems",value:function(e){this.tabArea.setTabItems(e)}},{key:"_setSelectedTab",value:function(e){e?this.setSelectedTabItem(e.tabItem):this.setSelectedTabItem(null)}},{key:"setSelectedTabItem",value:function(e){this.setProperty("selectedTabItem",e)}},{key:"_setSelectedTabItem",value:function(e){this._setProperty("selectedTabItem",e),this.tabArea.setSelectedTabItem(e)}},{key:"isTabItemFocused",value:function(e){return this.tabArea.isTabItemFocused(e)}},{key:"focusTabItem",value:function(e){this.tabArea.focusTabItem(e)}},{key:"_onTabBoxPropertyChange",value:function(e){"menus"===e.propertyName?this.menuBar.setMenuItems(this.tabBox.menus):"labelVisible"===e.propertyName&&this.setVisible(this.tabBox.labelVisible)}},{key:"_onTabAreaPropertyChange",value:function(e){"selectedTab"===e.propertyName&&this._setSelectedTab(e.newValue)}}])&&I9(t.prototype,n),r&&I9(t,r),i}(ve);function U9(e){return(U9="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function K9(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function q9(e,t,n){return(q9="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Q9(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function Y9(e,t){return(Y9=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function X9(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Q9(e);if(t){var o=Q9(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return J9(this,n)}}function J9(e,t){return!t||"object"!==U9(t)&&"function"!=typeof t?Z9(e):t}function Z9(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Q9(e){return(Q9=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var e8=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Y9(e,t)}(i,e);var t,n,r,o=X9(i);function i(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(e=o.call(this)).label=null,e.subLabel=null,e.selected=!1,e.overflown=!1,e._preventTabSelection=!1,e.$label=null,e.$subLabel=null,e._tabPropertyChangeHandler=e._onTabPropertyChange.bind(Z9(e)),e._statusMouseDownHandler=e._onStatusMouseDown.bind(Z9(e)),e._desktopPropertyChangeHandler=e._onDesktopPropertyChange.bind(Z9(e)),e}return t=i,(n=[{key:"_init",value:function(e){q9(Q9(i.prototype),"_init",this).call(this,e),this.visible=this.tabItem.visible,this.label=this.tabItem.label,this.subLabel=this.tabItem.subLabel,this.cssClass=this.tabItem.cssClass,this.marked=this.tabItem.marked,this.errorStatus=this.tabItem.errorStatus,this.tooltipText=this.tabItem.tooltipText,this.fieldStatus=O.create("FieldStatus",{parent:this,visible:!1}),this.fieldStatus.on("statusMouseDown",this._statusMouseDownHandler),this.tabItem.on("propertyChange",this._tabPropertyChangeHandler)}},{key:"_destroy",value:function(){q9(Q9(i.prototype),"_destroy",this).call(this),this.tabItem.off("propertyChange",this._tabPropertyChangeHandler),this.fieldStatus.off("statusMouseDown",this._statusMouseDownHandler)}},{key:"_render",value:function(){this.$container=this.$parent.appendDiv("tab-item"),this.htmlComp=ea.install(this.$container,this.session),this.$title=this.$container.appendDiv("title"),this.$label=this.$title.appendDiv("label"),xp.installForEllipsis(this.$label,{parent:this}),this.$subLabel=this.$title.appendDiv("sub-label"),xp.installForEllipsis(this.$subLabel,{parent:this}),this.fieldStatus.render(),this.fieldStatus.$container.cssWidth(Xs.get().fieldStatusWidth),this.$container.on("mousedown",this._onTabMouseDown.bind(this)),this.session.desktop.on("propertyChange",this._desktopPropertyChangeHandler)}},{key:"_renderProperties",value:function(){q9(Q9(i.prototype),"_renderProperties",this).call(this),this._renderVisible(),this._renderLabel(),this._renderSubLabel(),this._renderTabbable(),this._renderSelected(),this._renderMarked(),this._renderOverflown(),this._renderTooltipText(),this._renderErrorStatus()}},{key:"_renderVisible",value:function(){q9(Q9(i.prototype),"_renderVisible",this).call(this),this._updateStatus()}},{key:"setLabel",value:function(e){this.setProperty("label",e)}},{key:"_renderLabel",value:function(e){this.$label.textOrNbsp(this.label),this.invalidateLayoutTree()}},{key:"setSubLabel",value:function(e){this.setProperty("subLabel",e)}},{key:"_renderSubLabel",value:function(){this.$subLabel.textOrNbsp(this.subLabel),this.invalidateLayoutTree()}},{key:"setTooltipText",value:function(e){this.setProperty("tooltipText",e)}},{key:"_renderTooltipText",value:function(){this.$container.toggleClass("has-tooltip",Wn.hasText(this.tooltipText)),this._updateStatus()}},{key:"setErrorStatus",value:function(e){this.setProperty("errorStatus",e)}},{key:"_renderErrorStatus",value:function(){var e=!!this.errorStatus,t=e?"has-"+this.errorStatus.cssClass():"";this._updateErrorStatusClasses(t,e),this._updateStatus()}},{key:"_updateErrorStatusClasses",value:function(e,t){this.$container.removeClass(ZW.SEVERITY_CSS_CLASSES),this.$container.addClass(e,t)}},{key:"_updateStatus",value:function(){var e=this._computeVisible(),t=null,n=!0,r=!1;this.fieldStatus.setVisible(e),e&&(this.errorStatus?(n=!(t=this.errorStatus).isError(),r=!0):t=O.create("Status",{message:this.tooltipText,severity:Br.Severity.OK}),this.fieldStatus.update(t,null,n,r))}},{key:"_computeVisible",value:function(){return this.visible&&!this.overflown&&(this.errorStatus||Wn.hasText(this.tooltipText))}},{key:"setTabbable",value:function(e){this.setProperty("tabbable",e)}},{key:"_renderTabbable",value:function(){this.$container.setTabbable(this.tabbable&&!Kt.get().supportsOnlyTouch())}},{key:"select",value:function(){this.setSelected(!0)}},{key:"setSelected",value:function(e){this.setProperty("selected",e)}},{key:"_renderSelected",value:function(){this.$container.select(this.selected),this.$container.setTabbable(this.selected&&!Kt.get().supportsOnlyTouch())}},{key:"setMarked",value:function(e){this.setProperty("marked",e)}},{key:"_renderMarked",value:function(e){this.$container.toggleClass("marked",this.marked)}},{key:"setOverflown",value:function(e){this.setProperty("overflown",e)}},{key:"_renderOverflown",value:function(){this.$container.toggleClass("overflown",this.overflown),this._updateStatus()}},{key:"_remove",value:function(){this.session.desktop.off("propertyChange",this._desktopPropertyChangeHandler),q9(Q9(i.prototype),"_remove",this).call(this)}},{key:"_onDesktopPropertyChange",value:function(e){"dense"===e.propertyName&&this.invalidateLayout()}},{key:"_onTabMouseDown",value:function(e){this._preventTabSelection?this._preventTabSelection=!1:(this.setTabbable(!0),this.$container.focus(),this.select(),this.$label&&(xp.cancel(this.$label),xp.close(this.$label)),this.$subLabel&&(xp.cancel(this.$subLabel),xp.close(this.$subLabel)))}},{key:"_onStatusMouseDown",value:function(e){this._preventTabSelection=!0,e.preventDefault()}},{key:"_onTabPropertyChange",value:function(e){"visible"===e.propertyName?this.setVisible(e.newValue):"label"===e.propertyName?this.setLabel(this.tabItem.label):"subLabel"===e.propertyName?this.setSubLabel(this.tabItem.subLabel):"cssClass"===e.propertyName?this.setCssClass(this.tabItem.cssClass):"marked"===e.propertyName?this.setMarked(this.tabItem.marked):"errorStatus"===e.propertyName?this.setErrorStatus(e.newValue):"tooltipText"===e.propertyName&&this.setTooltipText(e.newValue)}}])&&K9(t.prototype,n),r&&K9(t,r),i}(ve);function t8(e){return(t8="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function n8(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function r8(e,t,n){return(r8="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=l8(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function o8(e,t){return(o8=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function i8(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=l8(e);if(t){var o=l8(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return s8(this,n)}}function s8(e,t){return!t||"object"!==t8(t)&&"function"!=typeof t?a8(e):t}function a8(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function l8(e){return(l8=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var u8=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&o8(e,t)}(i,e);var t,n,r,o=i8(i);function i(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(e=o.call(this)).tabBox=null,e.tabs=[],e.displayStyle=i.DisplayStyle.DEFAULT,e._tabItemPropertyChangeHandler=e._onTabItemPropertyChange.bind(a8(e)),e._tabPropertyChangeHandler=e._onTabPropertyChange.bind(a8(e)),e.ellipsis=null,e.$selectionMarker=null,e}return t=i,(n=[{key:"_init",value:function(e){r8(l8(i.prototype),"_init",this).call(this,e),this.tabBox=e.tabBox,this.ellipsis=O.create("EllipsisMenu",{parent:this,cssClass:"overflow-tab-item unfocusable",iconId:null,inheritAccessibility:!1,text:"0"})}},{key:"_createKeyStrokeContext",value:function(){return new $u}},{key:"_initKeyStrokeContext",value:function(){r8(l8(i.prototype),"_initKeyStrokeContext",this).call(this),this.keyStrokeContext.registerKeyStroke([new p9(this),new _9(this)])}},{key:"_render",value:function(){this.$container=this.$parent.appendDiv("tab-area"),this.htmlComp=ea.install(this.$container,this.session),this.htmlComp.setLayout(new b8(this)),this.ellipsis.render(this.$container),this.$selectionMarker=this.$container.appendDiv("selection-marker")}},{key:"_renderProperties",value:function(){r8(l8(i.prototype),"_renderProperties",this).call(this),this._renderTabs(),this._renderSelectedTab(),this._renderHasSubLabel(),this._renderDisplayStyle()}},{key:"_remove",value:function(){r8(l8(i.prototype),"_remove",this).call(this),this._removeTabs()}},{key:"setSelectedTabItem",value:function(e){this.setSelectedTab(this.getTabForItem(e))}},{key:"getTabForItem",value:function(e){return rt.find(this.tabs,(function(t){return t.tabItem===e}),this)}},{key:"setSelectedTab",value:function(e){this.setProperty("selectedTab",e)}},{key:"_setSelectedTab",value:function(e){this.selectedTab&&this.selectedTab.setSelected(!1),e&&e.setSelected(!0),this._setProperty("selectedTab",e),this._setTabbableItem(e)}},{key:"_renderSelectedTab",value:function(){this.selectedTab&&this.selectedTab.overflown&&this.invalidateLayoutTree()}},{key:"isTabItemFocused",value:function(e){return this.getTabForItem(e).isFocused()}},{key:"focusTabItem",value:function(e){this.focusTab(this.getTabForItem(e))}},{key:"focusTab",value:function(e){e.focus()}},{key:"setTabItems",value:function(e){this.setProperty("tabs",e),this._updateHasSubLabel(),this.invalidateLayoutTree()}},{key:"_setTabs",value:function(e){var t=this.tabs.slice(),n=e.map((function(e){var n=this.getTabForItem(e);return n?rt.remove(t,n):(n=O.create("Tab",{parent:this,tabItem:e}),e.on("propertyChange",this._tabItemPropertyChangeHandler),n.on("propertyChange",this._tabPropertyChangeHandler)),n}),this);t.forEach((function(e){e.tabItem.off("propertyChange",this._tabItemPropertyChangeHandler)}),this),this._removeTabs(t),this._setProperty("tabs",n)}},{key:"_renderTabs",value:function(){this.tabs.slice().reverse().forEach((function(e,t,n){e.rendered||e.render(),e.$container.on("blur",this._onTabItemBlur.bind(this)).on("focus",this._onTabItemFocus.bind(this)),e.$container.prependTo(this.$container),e.$container.on("blur",this._onTabItemBlur.bind(this)).on("focus",this._onTabItemFocus.bind(this))}),this)}},{key:"_removeTabs",value:function(e){(e=e||this.tabs).forEach((function(e){e.remove()}))}},{key:"setDisplayStyle",value:function(e){this.setProperty("displayStyle",e)}},{key:"_renderDisplayStyle",value:function(){this.$container.toggleClass("spread-even",this.displayStyle===i.DisplayStyle.SPREAD_EVEN),this.invalidateLayoutTree()}},{key:"_onTabItemFocus",value:function(){this.setFocused(!0)}},{key:"_onTabItemBlur",value:function(){this.setFocused(!1)}},{key:"_updateHasSubLabel",value:function(){var e=this.tabs||[];this._setHasSubLabel(e.some((function(e){return Wn.hasText(e.subLabel)})))}},{key:"_setHasSubLabel",value:function(e){this.hasSubLabel!==e&&(this._setProperty("hasSubLabel",e),this.rendered&&this._renderHasSubLabel())}},{key:"_renderHasSubLabel",value:function(){this.$container.toggleClass("has-sub-label",this.hasSubLabel),this.invalidateLayoutTree()}},{key:"selectNextTab",value:function(e){this._moveSelectionHorizontal(!0,e)}},{key:"selectPreviousTab",value:function(e){this._moveSelectionHorizontal(!1,e)}},{key:"_moveSelectionHorizontal",value:function(e,t){var n=this.tabs.slice(),r=this.$container.activeElement(),o=!1;e||(n.reverse(),o=r[0]===this.ellipsis.$container[0]),n.forEach((function(e,n){if(o&&e.visible&&!e.overflown)return this.setSelectedTab(e),this._setTabbableItem(e),t&&e.focus(),void(o=!1);r[0]===e.$container[0]&&(o=!0)}),this),e&&o&&this.ellipsis.isTabTarget()&&(this._setTabbableItem(this.ellipsis),t&&this.ellipsis.focus())}},{key:"_setTabbableItem",value:function(e){var t=this.tabs;e&&(this.ellipsis.setTabbable(!1),t.forEach((function(e){e.setTabbable(!1)})),e.setTabbable(!0))}},{key:"_onTabPropertyChange",value:function(e){"selected"===e.propertyName&&this.setSelectedTab(e.source)}},{key:"_onTabItemPropertyChange",value:function(e){"visible"===e.propertyName&&this.invalidateLayoutTree(),"subLabel"===e.propertyName&&this._updateHasSubLabel()}}])&&n8(t.prototype,n),r&&n8(t,r),i}(ve);function c8(e){return(c8="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function f8(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function h8(e,t){return(h8=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function p8(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=v8(e);if(t){var o=v8(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return d8(this,n)}}function d8(e,t){return!t||"object"!==c8(t)&&"function"!=typeof t?y8(e):t}function y8(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function v8(e){return(v8=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}!function(e,t,n){t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}(u8,"DisplayStyle",{DEFAULT:"default",SPREAD_EVEN:"spreadEven"});var b8=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&h8(e,t)}(i,e);var t,n,r,o=p8(i);function i(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(t=o.call(this)).tabArea=e,t.overflowTabs=[],t.visibleTabs=[],t._tabAreaPropertyChangeHandler=t._onTabAreaPropertyChange.bind(y8(t)),t.tabArea.on("propertyChange",t._tabAreaPropertyChangeHandler),t.tabArea.one("remove",(function(){t.tabArea.off("propertyChange",t._tabAreaPropertyChangeHandler)})),t}return t=i,(n=[{key:"layout",value:function(e){var t=this.tabArea.ellipsis,n=ea.get(e),r=n.availableSize().subtract(n.insets());this.preferredLayoutSize(e,{widthHint:r.width}),this.overflowTabs.length>0&&t.setHidden(!1),this.visibleTabs.forEach((function(e){e.setOverflown(!1)})),this.overflowTabs.forEach((function(e){e.setOverflown(!0)})),0===this.overflowTabs.length&&t.setHidden(!0),t.setText(this.overflowTabs.length+""),t.setChildActions(this.overflowTabs.map((function(e){var n=O.create("Menu",{parent:t,text:e.label,tab:e,visible:e.visible});return n.on("action",(function(n){s.a.log.isDebugEnabled()&&s.a.log.debug("(TabAreaLayout#_onClickEllipsis) tabItem="+e),t.popup.close(),e.select(),e.focus()})),n}),this)),this._layoutSelectionMarker()}},{key:"_layoutSelectionMarker",value:function(){var e,t=this.tabArea.$selectionMarker,n=this.tabArea.selectedTab;n?(t.setVisible(!0),e=qs.bounds(n.$container),t.cssLeft(e.x),t.cssWidth(e.width)):t.setVisible(!1)}},{key:"preferredLayoutSize",value:function(e,t){var n=ea.get(e),r=new $s(0,0),o=Number.MAX_VALUE,i=this.tabArea.tabs.filter((function(e){return e.isVisible()})),s=i.map((function(e,t){return e.selected?-1:t})).filter((function(e){return e>=0}));if(this.overflowTabs=[],(0===t.widthHint||t.widthHint)&&(o=t.widthHint-n.insets().horizontal()),o<=0)return this._minSize(i).add(n.insets());var a=-1;for(this._setFirstLastMarker(i),r=this._prefSize(i);r.width>o&&s.length>0;)a=s.splice(-1)[0],this.overflowTabs.splice(0,0,i[a]),i.splice(a,1),this._setFirstLastMarker(i),r=this._prefSize(i);return this.visibleTabs=i,this.tabArea.displayStyle===u8.DisplayStyle.SPREAD_EVEN?qs.prefSize(e,t):qs.exactPrefSize(r.add(n.insets()),t)}},{key:"_minSize",value:function(e){var t=[];return this.overflowTabs=e.filter((function(e){return!e.selected||(t.push(e),!1)}),this),this.visibleTabs=t,this._setFirstLastMarker(t),this._prefSize(t)}},{key:"_prefSize",value:function(e,t){var n=e.map((function(e){return this._tabItemSize(e.htmlComp)}),this).reduce((function(e,t){return e.height=Math.max(e.height,t.height),e.width+=t.width,e}),new $s(0,0)),r=new $s(0,0);return(t=O.nvl(t,this.overflowTabs.length>0))&&(r=this._tabItemSize(this.tabArea.ellipsis.htmlComp),n.height=Math.max(n.height,r.height),n.width+=r.width),n}},{key:"_setFirstLastMarker",value:function(e,t){t=O.nvl(t,this.overflowTabs.length>0),this.tabArea.tabs.forEach((function(e){e.htmlComp.$comp.removeClass("first last")})),this.tabArea.ellipsis.$container.removeClass("first last"),e.length>0&&(e[0].$container.addClass("first"),t?this.tabArea.ellipsis.$container.addClass("last"):e[e.length-1].$container.addClass("last"))}},{key:"_tabItemSize",value:function(e){var t,n=e.$comp.attr("class");return this.tabArea.displayStyle===u8.DisplayStyle.SPREAD_EVEN&&this.tabArea.$container.removeClass("spread-even"),e.$comp.removeClass("overflown"),e.$comp.removeClass("hidden"),t=e.prefSize({useCssSize:!0,exact:!0}).add(qs.margins(e.$comp)),e.$comp.attrOrRemove("class",n),this.tabArea.displayStyle===u8.DisplayStyle.SPREAD_EVEN&&this.tabArea.$container.addClass("spread-even"),t}},{key:"_onTabAreaPropertyChange",value:function(e){"selectedTab"===e.propertyName&&this._layoutSelectionMarker()}}])&&f8(t.prototype,n),r&&f8(t,r),i}(Zs);function m8(e){return(m8="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function g8(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function _8(e,t){return(_8=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function w8(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=O8(e);if(t){var o=O8(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return k8(this,n)}}function k8(e,t){return!t||"object"!==m8(t)&&"function"!=typeof t?S8(e):t}function S8(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function O8(e){return(O8=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var T8=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_8(e,t)}(i,e);var t,n,r,o=w8(i);function i(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(t=o.call(this))._tabBox=e,t._initDefaults(),t.htmlPropertyChangeHandler=t._onHtmlEnvironmentPropertyChange.bind(S8(t)),Xs.get().on("propertyChange",t.htmlPropertyChangeHandler),t._tabBox.one("remove",(function(){Xs.get().off("propertyChange",t.htmlPropertyChangeHandler)})),t}return t=i,(n=[{key:"_initDefaults",value:function(){this._statusWidth=Xs.get().fieldStatusWidth}},{key:"_onHtmlEnvironmentPropertyChange",value:function(){this._initDefaults(),this._tabBox.invalidateLayoutTree()}},{key:"layout",value:function(e){var t,n,r,o,i=ea.get(e),s=ea.get(this._tabBox._$tabContent),a=ea.get(this._tabBox.header.$container),l=0,u=new $s,c=this._tabBox._tooltip(),f=this._tabBox.$status,h=this._tabBox.statusPosition;t=i.availableSize().subtract(i.insets()),a.isVisible()&&(r=a.margins(),l=t.subtract(r).width,f&&f.isVisible()&&(this._layoutStatus(),h===ZW.StatusPosition.DEFAULT&&(l-=this._statusWidth+qs.margins(f).horizontal())),o=a.prefSize({widthHint:l}),f&&f.isVisible()&&this._layoutStatus(o.height),o.width=l,a.setSize(o),u=o.add(r)),(n=t.subtract(s.margins())).height-=u.height,s.setSize(n),c&&c.rendered&&c.position()}},{key:"_layoutStatus",value:function(e){var t=this._tabBox.htmlComp.insets({includeBorder:!1}),n=t.top,r=t.right,o=this._tabBox.header.$container,i=this._tabBox.$status,s=qs.margins(i),a=n,l=this._tabBox.statusPosition,u=e-s.vertical();l===ZW.StatusPosition.DEFAULT?a+=o.cssMarginTop():u-=i.cssBorderWidthY(),i.cssWidth(this._statusWidth).cssTop(a).cssRight(r).cssHeight(u).cssLineHeight(u)}},{key:"preferredLayoutSize",value:function(e,t){t=t||{};var n=ea.get(e),r=ea.get(this._tabBox._$tabContent),o=ea.get(this._tabBox.header.$container),i=new $s,s=new $s,a=this._tabBox.$status,l=this._tabBox.statusPosition,u=n.availableSize().subtract(n.insets()).width;return t.heightHint=null,o.isVisible()&&(a&&a.isVisible()&&l===ZW.StatusPosition.DEFAULT&&(u-=a.outerWidth(!0)),i=o.prefSize({widthHint:u}).add(o.margins())),s=r.prefSize(t).add(n.insets()).add(r.margins()),new $s(Math.max(i.width,s.width),s.height+i.height)}}])&&g8(t.prototype,n),r&&g8(t,r),i}(Zs);function C8(e){return(C8="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function P8(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function R8(e,t,n){return(R8="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=A8(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function x8(e,t){return(x8=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function E8(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=A8(e);if(t){var o=A8(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return D8(this,n)}}function D8(e,t){return!t||"object"!==C8(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function A8(e){return(A8=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var F8=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&x8(e,t)}(i,e);var t,n,r,o=E8(i);function i(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(e=o.call(this)).marked=!1,e}return t=i,(n=[{key:"_init",value:function(e){R8(A8(i.prototype),"_init",this).call(this,e),this._setMenusVisible(this.menusVisible)}},{key:"_createLayout",value:function(){return new U8(this)}},{key:"_computeTitleVisible",value:function(e){return!1}},{key:"addStatus",value:function(){}},{key:"_computeStatusVisible",value:function(){return!1}},{key:"setMarked",value:function(e){this.setProperty("marked",e)}},{key:"_setMenusVisible",value:function(){this._setProperty("menusVisible",!1)}},{key:"focus",value:function(){this.parent.selectedTab!==this&&this.parent.setSelectedTab(this),this.parent.focusTabItem(this)}},{key:"isFocused",value:function(){return this.parent.isTabItemFocused(this)}}])&&P8(t.prototype,n),r&&P8(t,r),i}(gJ);function $8(e){return($8="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function j8(e,t){return(j8=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function B8(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=I8(e);if(t){var o=I8(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return M8(this,n)}}function M8(e,t){return!t||"object"!==$8(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function I8(e){return(I8=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var L8=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&j8(e,t)}(n,e);var t=B8(n);function n(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),t.call(this)}return n}($J);function H8(e){return(H8="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function N8(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function V8(e,t){return(V8=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function W8(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=G8(e);if(t){var o=G8(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return z8(this,n)}}function z8(e,t){return!t||"object"!==H8(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function G8(e){return(G8=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var U8=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&V8(e,t)}(i,e);var t,n,r,o=W8(i);function i(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),o.call(this,e)}return t=i,(n=[{key:"_$status",value:function(){return this.groupBox.parent.$status}},{key:"_layoutStatus",value:function(){}},{key:"_menuBarSize",value:function(e,t,n){var r=ok.size(e,t),o=this.groupBox.parent;return r.width=o.header.$container.outerWidth(),r}},{key:"_titleHeight",value:function(){return 0}}])&&N8(t.prototype,n),r&&N8(t,r),i}(VJ);function K8(e){return(K8="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function q8(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Y8(e,t,n){return(Y8="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=e7(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function X8(e,t){return(X8=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function J8(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=e7(e);if(t){var o=e7(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Z8(this,n)}}function Z8(e,t){return!t||"object"!==K8(t)&&"function"!=typeof t?Q8(e):t}function Q8(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function e7(e){return(e7=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var t7=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&X8(e,t)}(i,e);var t,n,r,o=J8(i);function i(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(e=o.call(this)).gridDataHints.weightY=1,e.gridDataHints.h=3,e.eventDelegator=null,e._tableChangedHandler=e._onTableChanged.bind(Q8(e)),e._deletedRows=Pr.createMap(),e._insertedRows=Pr.createMap(),e._updatedRows=Pr.createMap(),e._checkedRows=Pr.createMap(),e._addWidgetProperties(["table"]),e}return t=i,(n=[{key:"_init",value:function(e){Y8(e7(i.prototype),"_init",this).call(this,e),this._setTable(this.table)}},{key:"_render",value:function(){this.addContainer(this.$parent,"table-field"),this.addLabel(),this.addMandatoryIndicator(),this.addStatus(),this._renderTable()}},{key:"setTable",value:function(e){this.setProperty("table",e)}},{key:"_setTable",value:function(e){this.table&&(this.table.off(i.TABLE_CHANGE_EVENTS,this._tableChangedHandler),this.eventDelegator&&(this.eventDelegator.destroy(),this.eventDelegator=null)),this._setProperty("table",e),e&&(e.on(i.TABLE_CHANGE_EVENTS,this._tableChangedHandler),this.eventDelegator=vt.create(this,e,{delegateProperties:["enabled","disabledStyle","loading"]}),e.setDisabledStyle(this.disabledStyle),e.setLoading(this.loading),e.setScrollTop(this.scrollTop))}},{key:"_renderTable",value:function(){this.table&&(this.table.render(),this.addField(this.table.$container),this.$field.addDeviceClass(),this.invalidateLayoutTree())}},{key:"_removeTable",value:function(){this.table&&(this.table.remove(),this._removeField(),this.invalidateLayoutTree())}},{key:"computeRequiresSave",value:function(){return Object.keys(this._deletedRows).length>0||Object.keys(this._insertedRows).length>0||Object.keys(this._updatedRows).length>0||Object.keys(this._checkedRows).length>0}},{key:"_onTableChanged",value:function(e){O.isOneOf(e.type,"rowsDeleted","allRowsDeleted")?this._updateDeletedRows(e.rows):"rowsInserted"===e.type?this._updateInsertedRows(e.rows):"rowsUpdated"===e.type?this._updateUpdatedRows(e.rows):"rowsChecked"===e.type&&this._updateCheckedRows(e.rows)}},{key:"_updateDeletedRows",value:function(e){e.forEach((function(e){if(e.id in this._insertedRows)return delete this._insertedRows[e.id],delete this._updatedRows[e.id],void delete this._checkedRows[e.id];this._deletedRows[e.id]=e}),this)}},{key:"_updateInsertedRows",value:function(e){e.forEach((function(e){this._insertedRows[e.id]=e}),this)}},{key:"_updateUpdatedRows",value:function(e){e.forEach((function(e){e.status!==Ix.Status.NON_CHANGED&&(this._updatedRows[e.id]=e)}),this)}},{key:"_updateCheckedRows",value:function(e){e.forEach((function(e){e.id in this._checkedRows?delete this._checkedRows[e.id]:this._checkedRows[e.id]=e}),this)}},{key:"markAsSaved",value:function(){Y8(e7(i.prototype),"markAsSaved",this).call(this),this._deletedRows=Pr.createMap(),this._insertedRows=Pr.createMap(),this._updatedRows=Pr.createMap(),this._checkedRows=Pr.createMap(),this.table.markRowsAsNonChanged()}},{key:"getValidationResult",value:function(){var e=Y8(e7(i.prototype),"getValidationResult",this).call(this);if(e&&!e.valid)return e;var t=!this.errorStatus,n=!this.mandatory||!this.empty,r=rt.ensure(this.table.rows),o=rt.ensure(this.table.columns);return r.some((function(e){return o.some((function(r){var o=r.isContentValid(e);return!(o.valid||(t=t&&o.validByErrorStatus,n=n&&o.validByMandatory,t||n))}),this)}),this),{valid:t&&n,validByErrorStatus:t,validByMandatory:n}}},{key:"getDelegateScrollable",value:function(){return this.table}}])&&q8(t.prototype,n),r&&q8(t,r),i}(ZW);function n7(e){return(n7="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function r7(e,t){return(r7=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function o7(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=s7(e);if(t){var o=s7(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return i7(this,n)}}function i7(e,t){return!t||"object"!==n7(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function s7(e){return(s7=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}!function(e,t,n){t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}(t7,"TABLE_CHANGE_EVENTS","rowsInserted rowsDeleted allRowsDeleted rowsUpdated rowsChecked");var a7=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&r7(e,t)}(n,e);var t=o7(n);function n(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),t.call(this)}return n}(sz);function l7(e){return(l7="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function u7(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function c7(e,t,n){return(c7="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=d7(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function f7(e,t){return(f7=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function h7(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=d7(e);if(t){var o=d7(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return p7(this,n)}}function p7(e,t){return!t||"object"!==l7(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function d7(e){return(d7=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var y7=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&f7(e,t)}(i,e);var t,n,r,o=h7(i);function i(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(e=o.call(this)).table=null,e}return t=i,(n=[{key:"_init",value:function(e){c7(d7(i.prototype),"_init",this).call(this,e);var t=O.create("Column",{index:0,session:this.session,text:"Tag",autoOptimizeWidth:!1});this.table=O.create("Table",{parent:this,headerVisible:!1,autoResizeColumns:!0,multiSelect:!1,scrollToSelection:!0,columns:[t],headerMenusEnabled:!1}),this.table.on("rowClick",this._onRowClick.bind(this))}},{key:"_createLayout",value:function(){return new S7(this)}},{key:"_render",value:function(){c7(d7(i.prototype),"_render",this).call(this),this.$container.addClass("tag-chooser-popup").on("mousedown",this._onContainerMouseDown.bind(this)),this._renderTable()}},{key:"_renderTable",value:function(){this.table.setVirtual(!1),this.table.render(),this.table.$container.setTabbable(!1).addClass("focused")}},{key:"setLookupResult",value:function(e){var t=[],n=e.lookupRows;this.table.deleteAllRows(),n.forEach((function(e){t.push(dQ.createTableRow(e))}),this),this.table.insertRows(t)}},{key:"_onRowClick",value:function(e){this.triggerLookupRowSelected()}},{key:"_onContainerMouseDown",value:function(e){return!1}},{key:"_isMouseDownOnAnchor",value:function(e){return this.field.$field.isOrHas(e.target)}},{key:"delegateKeyEvent",value:function(e){e.originalEvent.smartFieldEvent=!0,this.table.$container.trigger(e)}},{key:"triggerLookupRowSelected",value:function(e){(e=e||this.selectedRow())&&e.enabled&&this.trigger("lookupRowSelected",{lookupRow:e.lookupRow})}},{key:"selectedRow",value:function(){return this.table.selectedRow()}}])&&u7(t.prototype,n),r&&u7(t,r),i}(Id);function v7(e){return(v7="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function b7(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function m7(e,t,n){return(m7="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=k7(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function g7(e,t){return(g7=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function _7(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=k7(e);if(t){var o=k7(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return w7(this,n)}}function w7(e,t){return!t||"object"!==v7(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function k7(e){return(k7=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var S7=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&g7(e,t)}(i,e);var t,n,r,o=_7(i);function i(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(t=o.call(this,e)).doubleCalcPrefSize=!1,t}return t=i,(n=[{key:"layout",value:function(e){m7(k7(i.prototype),"layout",this).call(this,e);var t=this.popup.htmlComp,n=t.size().subtract(t.insets());this.popup.table.htmlComp.setSize(n),this.popup.position()}},{key:"preferredLayoutSize",value:function(e){var t=O.create("TableLayoutResetter",this.popup.table);t.modifyDom();var n=m7(k7(i.prototype),"preferredLayoutSize",this).call(this,e);return t.restoreDom(),n}}])&&b7(t.prototype,n),r&&b7(t,r),i}(Qd);function O7(e){return(O7="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function T7(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function C7(e,t,n){return(C7="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=E7(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function P7(e,t){return(P7=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function R7(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=E7(e);if(t){var o=E7(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return x7(this,n)}}function x7(e,t){return!t||"object"!==O7(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function E7(e){return(E7=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var D7=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&P7(e,t)}(i,e);var t,n,r,o=R7(i);function i(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(e=o.call(this)).$field=null,e.fieldHtmlComp=null,e.popup=null,e.lookupCall=null,e._currentLookupCall=null,e.tagBar=null,e}return t=i,r=[{key:"createFieldAdapter",value:function(e){return{$container:function(){return e.$fieldContainer},enabled:function(){return Wn.empty(e._readDisplayText())},focus:function(){e.$field.focus()},one:function(t,n){e.one(t,n)},off:function(t,n){e.off(t,n)},removeTag:function(t){e.removeTag(t)}}}}],(n=[{key:"_init",value:function(e){C7(E7(i.prototype),"_init",this).call(this,e),this.tagBar=O.create("TagBar",{parent:this,tags:this.value}),this.tagBar.on("tagRemove",this._onTagRemove.bind(this)),this.on("propertyChange",this._onValueChange.bind(this)),this._setLookupCall(this.lookupCall)}},{key:"_onTagRemove",value:function(e){this.removeTag(e.tag)}},{key:"_initKeyStrokeContext",value:function(){C7(E7(i.prototype),"_initKeyStrokeContext",this).call(this),this.keyStrokeContext.registerKeyStroke([new q7(this),new nee(this),new mee(this._createFieldAdapter()),new cee(this._createFieldAdapter()),new Cee(this)])}},{key:"_createKeyStrokeContext",value:function(){return new Vu}},{key:"_render",value:function(){this.addContainer(this.$parent,"tag-field",new Fee(this)),this.addLabel(),this.addMandatoryIndicator();var e=this.$container.appendDiv();this.fieldHtmlComp=ea.install(e,this.session),this.fieldHtmlComp.setLayout(new Hee(this)),this.tagBar.render(e);var t=e.appendElement("<input>","field").on("keydown",this._onInputKeydown.bind(this)).on("keyup",this._onInputKeyup.bind(this)).on("input",this._onFieldInput.bind(this));this.addFieldContainer(e),this.addField(t),this.addStatus()}},{key:"_renderProperties",value:function(){C7(E7(i.prototype),"_renderProperties",this).call(this),this._renderValue()}},{key:"_renderValue",value:function(){this.tagBar.updateTags()}},{key:"_setValue",value:function(e){C7(E7(i.prototype),"_setValue",this).call(this,e),this.tagBar&&this.tagBar.setTags(this.value)}},{key:"_setLookupCall",value:function(e){this._setProperty("lookupCall",ri.ensure(e,this.session))}},{key:"formatValue",value:function(e){return""}},{key:"_validateValue",value:function(e){var t=rt.ensure(e),n=[];return t.forEach((function(e){Wn.empty(e)||(e=e.toLowerCase(),n.indexOf(e)<0&&n.push(e))})),n}},{key:"_parseValue",value:function(e){var t=rt.ensure(this.value);return(t=t.slice()).push(e),t}},{key:"_renderDisplayText",value:function(){this.$field.val(this.displayText),C7(E7(i.prototype),"_renderDisplayText",this).call(this),this._updateInputVisible()}},{key:"_renderEnabled",value:function(){C7(E7(i.prototype),"_renderEnabled",this).call(this),this._updateInputVisible()}},{key:"_renderFieldStyle",value:function(){C7(E7(i.prototype),"_renderFieldStyle",this).call(this),this.rendered&&this.fieldHtmlComp.invalidateLayoutTree()}},{key:"_updateInputVisible",value:function(){var e,t=!this.$field.isVisible();e=!!this.enabledComputed||Wn.hasText(this.displayText),this.$field.setVisible(e),e!==t&&this._renderValue()}},{key:"_readDisplayText",value:function(){return this.$field.val()}},{key:"_clear",value:function(){this.$field.val("")}},{key:"acceptInput",value:function(e){this.popup?this.popup.selectedRow()?this.popup.triggerLookupRowSelected():this.closePopup():C7(E7(i.prototype),"acceptInput",this).call(this,!1)}},{key:"_triggerAcceptInput",value:function(){this.trigger("acceptInput",{displayText:this.displayText,value:this.value})}},{key:"aboutToBlurByMouseDown",value:function(e){TW.eventOutsideProposalField(this,e)&&this.acceptInput(!0)}},{key:"_onFieldBlur",value:function(e){this.closePopup(),C7(E7(i.prototype),"_onFieldBlur",this).call(this,e),this.rendered&&!this.removing&&this.tagBar.blur()}},{key:"_onFieldFocus",value:function(e){C7(E7(i.prototype),"_onFieldFocus",this).call(this,e),this.rendered&&!this.removing&&this.tagBar.focus()}},{key:"_onFieldInput",value:function(){this._updateHasText()}},{key:"addTag",value:function(e){var t=this._parseValue(e);this.setValue(t),this._triggerAcceptInput()}},{key:"removeTag",value:function(e){if(!Wn.empty(e)){e=e.toLowerCase();var t=rt.ensure(this.value);-1!==t.indexOf(e)&&(t=t.slice(),rt.remove(t,e),this.setValue(t),this._triggerAcceptInput(),this.focus())}}},{key:"_onInputKeydown",value:function(e){this._isNavigationKey(e)&&this.popup?this.popup.delegateKeyEvent(e):e.which===Ou.ESC&&this.closePopup()}},{key:"_isNavigationKey",value:function(e){return O.isOneOf(e.which,[Ou.PAGE_UP,Ou.PAGE_DOWN,Ou.UP,Ou.DOWN])}},{key:"_onInputKeyup",value:function(e){e.which!==Ou.ESC&&(this._isNavigationKey(e)||this._lookupByText(this.$field.val()))}},{key:"_lookupByText",value:function(e){var t=this;return this.lookupCall?Wn.empty(e)||e.length<2?void this.closePopup():(this._currentLookupCall=this.lookupCall.cloneForText(e),this.trigger("prepareLookupCall",{lookupCall:this._currentLookupCall}),this._currentLookupCall.execute().always((function(){t._currentLookupCall=null})).done(this._onLookupDone.bind(this))):null}},{key:"_onLookupDone",value:function(e){try{if(!this.rendered||!this.isFocused()||0===e.lookupRows.length)return void this.closePopup();this.openPopup(),this.popup.setLookupResult(e)}finally{this.trigger("lookupCallDone",{result:e})}}},{key:"openPopup",value:function(){this.popup||(this.popup=O.create("TagChooserPopup",{parent:this,$anchor:this.$field,boundToAnchor:!0,closeOnAnchorMouseDown:!1,field:this}),this.popup.on("lookupRowSelected",this._onLookupRowSelected.bind(this)),this.popup.one("close",this._onPopupClose.bind(this)),this.popup.open())}},{key:"closePopup",value:function(){this.popup&&!this.popup.destroying&&this.popup.close()}},{key:"_onLookupRowSelected",value:function(e){this._clear(),this._updateHasText(),this.addTag(e.lookupRow.key),this.closePopup()}},{key:"_onPopupClose",value:function(e){this.popup=null}},{key:"isInputFocused",value:function(){var e=this.$fieldContainer.activeElement();return this.$field.is(e)}},{key:"_onValueChange",value:function(e){"value"===e.propertyName&&this._renderLabel()}},{key:"_renderPlaceholder",value:function(e){var t=!!rt.ensure(this.value).length;(e=O.nvl(e,this.$field))&&e.placeholder(t?"":this.label)}},{key:"_createFieldAdapter",value:function(){return i.createFieldAdapter(this)}}])&&T7(t.prototype,n),r&&T7(t,r),i}(Qz);function A7(e){return(A7="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function F7(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function $7(e,t,n){return($7="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=I7(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function j7(e,t){return(j7=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function B7(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=I7(e);if(t){var o=I7(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return M7(this,n)}}function M7(e,t){return!t||"object"!==A7(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function I7(e){return(I7=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var L7=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&j7(e,t)}(i,e);var t,n,r,o=B7(i);function i(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),o.call(this)}return t=i,(n=[{key:"_initProperties",value:function(e){void 0!==e.insertText&&delete e.insertText}},{key:"_postCreateWidget",value:function(){$7(I7(i.prototype),"_postCreateWidget",this).call(this),this.widget.lookupCall=O.create("RemoteLookupCall",this)}},{key:"_syncResult",value:function(e){this.widget._currentLookupCall&&this.widget._currentLookupCall.resolveLookup(e)}},{key:"_onWidgetAcceptInput",value:function(e){this._send("acceptInput",{displayText:e.displayText,value:e.value})}}])&&F7(t.prototype,n),r&&F7(t,r),i}(wQ);function H7(e){return(H7="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function N7(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function V7(e,t,n){return(V7="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=K7(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function W7(e,t){return(W7=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function z7(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=K7(e);if(t){var o=K7(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return G7(this,n)}}function G7(e,t){return!t||"object"!==H7(t)&&"function"!=typeof t?U7(e):t}function U7(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function K7(e){return(K7=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var q7=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&W7(e,t)}(i,e);var t,n,r,o=z7(i);function i(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(t=o.call(this)).field=e,t.which=[Ou.ESC],t.stopPropagation=!0,t.preventInvokeAcceptInputOnActiveValueField=!0,t.renderingHints.$drawingArea=function(e,t){return this.field.$fieldContainer}.bind(U7(t)),t}return t=i,(n=[{key:"_accept",value:function(e){return!!V7(K7(i.prototype),"_accept",this).call(this,e)&&!!this.field.chooser}},{key:"handle",value:function(e){this.field.closeChooserPopup()}}])&&N7(t.prototype,n),r&&N7(t,r),i}(zu);function Y7(e){return(Y7="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function X7(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function J7(e,t,n){return(J7="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=tee(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function Z7(e,t){return(Z7=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Q7(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=tee(e);if(t){var o=tee(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return eee(this,n)}}function eee(e,t){return!t||"object"!==Y7(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function tee(e){return(tee=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var nee=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Z7(e,t)}(i,e);var t,n,r,o=Q7(i);function i(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(t=o.call(this)).field=e,t.which=[Ou.ENTER],t.renderingHints.render=!1,t.preventDefault=!1,t.stopPropagation=!0,t}return t=i,(n=[{key:"_accept",value:function(e){return!!J7(tee(i.prototype),"_accept",this).call(this,e)&&(this.stopPropagation=Wn.hasText(this.field._readDisplayText()),this.field.isInputFocused())}},{key:"handle",value:function(e){this.field.acceptInput()}}])&&X7(t.prototype,n),r&&X7(t,r),i}(zu);function ree(e){return(ree="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function oee(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function iee(e,t,n){return(iee="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=uee(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function see(e,t){return(see=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function aee(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=uee(e);if(t){var o=uee(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return lee(this,n)}}function lee(e,t){return!t||"object"!==ree(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function uee(e){return(uee=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var cee=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&see(e,t)}(i,e);var t,n,r,o=aee(i);function i(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(t=o.call(this)).fieldAdapter=e,t.which=[Ou.DELETE],t.renderingHints.render=!1,t.preventDefault=!1,t}return t=i,(n=[{key:"_accept",value:function(e){return!!iee(uee(i.prototype),"_accept",this).call(this,e)&&this._$focusedTag().length>0}},{key:"handle",value:function(e){var t=this._$focusedTag(),n=$ne.getTagData(t);this.fieldAdapter.removeTag(n)}},{key:"_$focusedTag",value:function(){return $ne.findFocusedTagElement(this.fieldAdapter.$container())}}])&&oee(t.prototype,n),r&&oee(t,r),i}(zu);function fee(e){return(fee="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function hee(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function pee(e,t,n){return(pee="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=bee(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function dee(e,t){return(dee=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function yee(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=bee(e);if(t){var o=bee(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return vee(this,n)}}function vee(e,t){return!t||"object"!==fee(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function bee(e){return(bee=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var mee=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&dee(e,t)}(i,e);var t,n,r,o=yee(i);function i(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(t=o.call(this)).fieldAdapter=e,t.which=[Ou.LEFT,Ou.RIGHT],t.preventDefault=!1,t.preventInvokeAcceptInputOnActiveValueField=!0,t}return t=i,(n=[{key:"_accept",value:function(e){return!!pee(bee(i.prototype),"_accept",this).call(this,e)&&this.fieldAdapter.enabled()}},{key:"handle",value:function(e){e.which===Ou.LEFT?this._focusTagElement(-1):e.which===Ou.RIGHT&&this._focusTagElement(1)}},{key:"_focusTagElement",value:function(e){var t=$ne.findFocusableTagElements(this.fieldAdapter.$container()),n=t.length;if(0!==n){var r=-1;if(t.each((function(e){s()(this).hasClass("focused")&&(r=e)})),-1===r)-1===e&&(r=n-1);else{var o=r+e;o>=n?r=-2:o<0?r=-1:($ne.unfocusTagElement(t.eq(r)),r=o)}-1===r||(-2===r?this.fieldAdapter.focus():$ne.focusTagElement(t.eq(r)))}}}])&&hee(t.prototype,n),r&&hee(t,r),i}(zu);function gee(e){return(gee="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _ee(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function wee(e,t,n){return(wee="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Tee(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function kee(e,t){return(kee=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function See(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Tee(e);if(t){var o=Tee(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Oee(this,n)}}function Oee(e,t){return!t||"object"!==gee(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Tee(e){return(Tee=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Cee=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&kee(e,t)}(i,e);var t,n,r,o=See(i);function i(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(t=o.call(this)).field=e,t.which=[Ou.ENTER,Ou.SPACE],t.renderingHints.render=!1,t.preventDefault=!1,t}return t=i,(n=[{key:"_accept",value:function(e){return!!wee(Tee(i.prototype),"_accept",this).call(this,e)&&this.field.tagBar&&this.field.tagBar.isOverflowIconFocused()}},{key:"handle",value:function(e){this.field.tagBar.openOverflowPopup()}}])&&_ee(t.prototype,n),r&&_ee(t,r),i}(zu);function Pee(e){return(Pee="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ree(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function xee(e,t){return(xee=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Eee(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Aee(e);if(t){var o=Aee(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Dee(this,n)}}function Dee(e,t){return!t||"object"!==Pee(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Aee(e){return(Aee=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Fee=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&xee(e,t)}(i,e);var t,n,r,o=Eee(i);function i(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),o.call(this,e)}return t=i,(n=[{key:"_$elementForIconLayout",value:function(){return this.formField.$fieldContainer}}])&&Ree(t.prototype,n),r&&Ree(t,r),i}(dz);function $ee(e){return($ee="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function jee(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Bee(e,t){return(Bee=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Mee(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Lee(e);if(t){var o=Lee(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Iee(this,n)}}function Iee(e,t){return!t||"object"!==$ee(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Lee(e){return(Lee=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Hee=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Bee(e,t)}(i,e);var t,n,r,o=Mee(i);function i(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(t=o.call(this)).tagField=e,t}return t=i,(n=[{key:"layout",value:function(e){var t=ea.get(e),n=this.tagField.value&&this.tagField.value.length>0,r=this.tagField.$field,o=this.tagField.tagBar.htmlComp;if(this.tagField.tagBar.setVisible(n),n){r.removeClass("fullwidth");var s=t.availableSize().subtract(t.insets()),a=s.width;r.isVisible()&&(a=s.width*(1-i.MIN_INPUT_TAG_RATIO));var l=o.prefSize(),u=Math.min(a,l.width);o.setSize(new $s(u,s.height));var c=s.width-u;r.cssWidth(c)}else r.addClass("fullwidth").removeAttr("style")}}])&&jee(t.prototype,n),r&&jee(t,r),i}(Zs);function Nee(e){return(Nee="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Vee(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Wee(e,t,n){return(Wee="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Kee(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function zee(e,t){return(zee=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Gee(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Kee(e);if(t){var o=Kee(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Uee(this,n)}}function Uee(e,t){return!t||"object"!==Nee(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Kee(e){return(Kee=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}!function(e,t,n){t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}(Hee,"MIN_INPUT_TAG_RATIO",.33);var qee=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&zee(e,t)}(i,e);var t,n,r,o=Gee(i);function i(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(e=o.call(this)).eventDelegator=null,e._addWidgetProperties(["tileGrid"]),e}return t=i,(n=[{key:"_init",value:function(e){Wee(Kee(i.prototype),"_init",this).call(this,e),this._setTileGrid(this.tileGrid)}},{key:"_createLoadingSupport",value:function(){return null}},{key:"_render",value:function(){this.addContainer(this.$parent,"tile-field"),this.addLabel(),this.addMandatoryIndicator(),this.addStatus(),this.tileGrid&&this._renderTileGrid()}},{key:"_renderProperties",value:function(){Wee(Kee(i.prototype),"_renderProperties",this).call(this),this._renderDropType()}},{key:"setTileGrid",value:function(e){this.setProperty("tileGrid",e)}},{key:"_setTileGrid",value:function(e){this.tileGrid&&this.eventDelegator&&(this.eventDelegator.destroy(),this.eventDelegator=null),this._setProperty("tileGrid",e),e&&(this.eventDelegator=vt.create(this,e,{delegateProperties:["loading"]}),e.setLoading(this.loading),e.setScrollTop(this.scrollTop))}},{key:"_renderTileGrid",value:function(){this.tileGrid&&(this.tileGrid.render(),this.addField(this.tileGrid.$container),this.invalidateLayoutTree())}},{key:"_removeTileGrid",value:function(){this.tileGrid&&(this.tileGrid.remove(),this._removeField(),this.invalidateLayoutTree())}},{key:"getDelegateScrollable",value:function(){return this.tileGrid}}])&&Vee(t.prototype,n),r&&Vee(t,r),i}(ZW);function Yee(e){return(Yee="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Xee(e,t){return(Xee=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Jee(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Qee(e);if(t){var o=Qee(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Zee(this,n)}}function Zee(e,t){return!t||"object"!==Yee(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Qee(e){return(Qee=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var ete=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Xee(e,t)}(n,e);var t=Jee(n);function n(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),t.call(this)}return n}(sz);function tte(e){return(tte="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function nte(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function rte(e,t,n){return(rte="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=ate(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function ote(e,t){return(ote=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function ite(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=ate(e);if(t){var o=ate(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return ste(this,n)}}function ste(e,t){return!t||"object"!==tte(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function ate(e){return(ate=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var lte=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ote(e,t)}(i,e);var t,n,r,o=ite(i);function i(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(e=o.call(this)).tree=null,e._populating=!1,e._addWidgetProperties(["tree","filterBox"]),e}return t=i,(n=[{key:"_init",value:function(e){rte(ate(i.prototype),"_init",this).call(this,e),this.tree.on("nodesChecked",this._onTreeNodesChecked.bind(this)),this.tree.setScrollTop(this.scrollTop)}},{key:"_initStructure",value:function(e){this.tree||(this.tree=this._createDefaultTreeBoxTree())}},{key:"_initValue",value:function(e){this.tree||(this.tree=this._createDefaultTreeBoxTree()),rte(ate(i.prototype),"_initValue",this).call(this,e)}},{key:"_render",value:function(){rte(ate(i.prototype),"_render",this).call(this),this.$container.addClass("tree-box")}},{key:"_createFieldContainerLayout",value:function(){return new _te(this,this.tree,this.filterBox)}},{key:"_renderStructure",value:function(e){this.tree.render(this.$fieldContainer),this.addField(this.tree.$container)}},{key:"_onTreeNodesChecked",value:function(e){this._populating||this._syncTreeToValue()}},{key:"_syncTreeToValue",value:function(){if(this.lookupCall&&!this._valueSyncing){this._valueSyncing=!0;var e=Pr.values(this.tree.nodesMap).filter((function(e){return e.checked})).map((function(e){return e.id}));this.setValue(e),this._valueSyncing=!1}}},{key:"_valueChanged",value:function(){rte(ate(i.prototype),"_valueChanged",this).call(this),this._syncValueToTree(this.value)}},{key:"_syncValueToTree",value:function(e){if(this.lookupCall&&!this._valueSyncing&&this.initialized){this._valueSyncing=!0;var t={checkOnlyEnabled:!1,checkChildren:!1};try{if(rt.empty(e))this.uncheckAll(t);else{if(this._ensureLookupCallExecuted())return;this.uncheckAll(t),Pr.values(this.tree.nodesMap).forEach((function(n){rt.containsAny(e,n.id)&&this.tree.checkNode(n,!0,t)}),this)}this._updateDisplayText()}finally{this._valueSyncing=!1}}}},{key:"uncheckAll",value:function(e){for(var t in this.tree.nodesMap)this.tree.nodesMap.hasOwnProperty(t)&&this.tree.uncheckNode(this.tree.nodesMap[t],e)}},{key:"_lookupByAllDone",value:function(e){rte(ate(i.prototype),"_lookupByAllDone",this).call(this,e)&&this._populateTree(e)}},{key:"_populateTree",value:function(e){var t=[];this._populating=!0,this._populateTreeRecursive(null,t,e.lookupRows),this.tree.deleteAllNodes(),this.tree.insertNodes(t),this._populating=!1,this._syncValueToTree(this.value)}},{key:"_populateTreeRecursive",value:function(e,t,n){var r;n.forEach((function(o){o.parentKey===e&&(r=this._createNode(o),this._populateTreeRecursive(r.id,r.childNodes,n),r.leaf=!r.childNodes.length,t.push(r))}),this)}},{key:"getCheckedLookupRows",value:function(){return null===this.value||rt.empty(this.value)||0===this.tree.nodes.length?[]:Pr.values(this.tree.nodesMap).filter((function(e){return e.checked})).map((function(e){return e.lookupRow}))}},{key:"_createNode",value:function(e){var t=O.create("TreeNode",{parent:this.tree,id:e.key,text:e.text,lookupRow:e});return e.iconId&&(t.iconId=e.iconId),e.tooltipText&&(t.tooltipText=e.tooltipText),e.backgroundColor&&(t.backgroundColor=e.backgroundColor),e.foregroundColor&&(t.foregroundColor=e.foregroundColor),e.font&&(t.font=e.font),!1===e.enabled&&(t.enabled=!1),!1===e.active&&(t.active=!1),e.cssClass&&(t.cssClass=e.cssClass),t}},{key:"_createDefaultTreeBoxTree",value:function(){return O.create("Tree",{parent:this,checkable:!0})}},{key:"getDelegateScrollable",value:function(){return this.tree}}])&&nte(t.prototype,n),r&&nte(t,r),i}(JG);function ute(e){return(ute="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function cte(e,t){return(cte=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function fte(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pte(e);if(t){var o=pte(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return hte(this,n)}}function hte(e,t){return!t||"object"!==ute(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function pte(e){return(pte=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var dte=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&cte(e,t)}(n,e);var t=fte(n);function n(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),t.call(this)}return n}(aG);function yte(e){return(yte="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function vte(e,t){return(vte=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function bte(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=gte(e);if(t){var o=gte(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return mte(this,n)}}function mte(e,t){return!t||"object"!==yte(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function gte(e){return(gte=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var _te=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&vte(e,t)}(n,e);var t=bte(n);function n(e,r,o){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),t.call(this,e,r,o)}return n}(oU);function wte(e){return(wte="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function kte(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Ste(e,t){return(Ste=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Ote(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Cte(e);if(t){var o=Cte(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Tte(this,n)}}function Tte(e,t){return!t||"object"!==wte(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Cte(e){return(Cte=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Pte=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ste(e,t)}(i,e);var t,n,r,o=Ote(i);function i(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(e=o.call(this)).gridDataHints.weightY=1,e.gridDataHints.h=3,e._addWidgetProperties(["tree"]),e}return t=i,(n=[{key:"_render",value:function(){this.addContainer(this.$parent,"tree-field"),this.addLabel(),this.addMandatoryIndicator(),this.addStatus(),this.tree&&this._renderTree()}},{key:"setTree",value:function(e){this.setProperty("tree",e)}},{key:"_setTree",value:function(e){this._setProperty("tree",e),e&&e.setScrollTop(this.scrollTop)}},{key:"_renderTree",value:function(){this.tree&&(this.tree.render(),this.addField(this.tree.$container),this.$field.addDeviceClass(),this.invalidateLayoutTree())}},{key:"_removeTree",value:function(){this.tree&&(this.tree.remove(),this._removeField(),this.invalidateLayoutTree())}},{key:"getDelegateScrollable",value:function(){return this.tree}}])&&kte(t.prototype,n),r&&kte(t,r),i}(ZW);function Rte(e){return(Rte="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function xte(e,t){return(xte=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Ete(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ate(e);if(t){var o=Ate(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Dte(this,n)}}function Dte(e,t){return!t||"object"!==Rte(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Ate(e){return(Ate=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Fte=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&xte(e,t)}(n,e);var t=Ete(n);function n(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),t.call(this)}return n}(sz);function $te(e){return($te="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function jte(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Bte(e,t,n){return(Bte="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Hte(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function Mte(e,t){return(Mte=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Ite(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Hte(e);if(t){var o=Hte(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Lte(this,n)}}function Lte(e,t){return!t||"object"!==$te(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Hte(e){return(Hte=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Nte=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Mte(e,t)}(i,e);var t,n,r,o=Ite(i);function i(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(e=o.call(this)).activeStepIndex=-1,e.steps=[],e.previousActiveStepIndex=-1,e.stepsMap={},e.$wizardStepsBody=null,e.keepActiveStepAtLeftBorder=Kt.get().type===Kt.Type.MOBILE,e.animateScrolling=Kt.get().type===Kt.Type.MOBILE,e}return t=i,(n=[{key:"_init",value:function(e){Bte(Hte(i.prototype),"_init",this).call(this,e),this._updateStepsMap()}},{key:"_render",value:function(){this.addContainer(this.$parent,"wizard-progress-field",new rne(this)),this.addField(this.$parent.makeDiv("wizard-steps")),this.addStatus(),this.addLabel(),this.$field.toggleClass("compact",Kt.get().type===Kt.Type.MOBILE),this.htmlComp.layout.compactFieldWidth=-1,this.$wizardStepsBody=this.$field.appendDiv("wizard-steps-body"),this._installScrollbars({axis:"x"}),this.parent instanceof gJ&&this.parent.controls[0]===this&&this.parent.parent instanceof CC&&this.parent.parent.$container.addClass("wizard-container-form")}},{key:"_renderProperties",value:function(){Bte(Hte(i.prototype),"_renderProperties",this).call(this),this._renderSteps(),this._renderActiveStepIndex()}},{key:"_setSteps",value:function(e){this._setProperty("steps",e),this._updateStepsMap()}},{key:"_renderSteps",value:function(){var e=this;this.$wizardStepsBody.children(".wizard-step").each((function(){xp.uninstall(s()(this).children(".wizard-step-content"))})),this.$wizardStepsBody.empty(),this.steps.forEach((function(t,n){var r=e.$wizardStepsBody.appendDiv("wizard-step").addClass(t.cssClass).data("wizard-step",t);t.$step=r,e._updateStepClasses(t),e.session.inspector&&(_n.applyInfo(t,r),r.attr("data-step-index",t.index));var o=r.appendDiv("wizard-step-content");Wn.hasText(t.tooltipText)&&xp.install(o,{parent:e,text:t.tooltipText,tooltipPosition:"bottom"});var i=o.appendDiv("wizard-step-content-icon-container").appendDiv("wizard-step-content-icon");t.iconId?i.icon(t.iconId):t.finished?i.icon(gn.CHECKED_BOLD):i.text(n+1);var s=o.appendDiv("wizard-step-content-text");s.appendDiv("wizard-step-title").textOrNbsp(t.title),t.subTitle&&s.appendDiv("wizard-step-sub-title").textOrNbsp(t.subTitle),n<e.steps.length-1&&e.$wizardStepsBody.appendDiv("wizard-step-separator").icon(gn.ANGLE_RIGHT)})),this.invalidateLayoutTree(!1)}},{key:"_setActiveStepIndex",value:function(e){this.previousActiveStepIndex=this.activeStepIndex,this._setProperty("activeStepIndex",O.nvl(e,-1))}},{key:"_renderActiveStepIndex",value:function(){this.steps.forEach(this._updateStepClasses.bind(this)),this.invalidateLayoutTree(!1)}},{key:"_updateStepClasses",value:function(e){var t=e.$step;t.removeClass("active-step before-active-step after-active-step first last action-enabled disabled"),t.off("click.active-step");var n=this.steps.indexOf(e),r=this.steps.indexOf(this.stepsMap[this.activeStepIndex]);this.enabledComputed&&e.enabled&&e.actionEnabled&&n!==this.activeStepIndex?(t.addClass("action-enabled"),t.on("click.active-step",this._onStepClick.bind(this))):this.enabledComputed&&e.enabled||t.addClass("disabled"),n>=0&&r>=0&&(n<r?t.addClass("before-active-step"):n>r?t.addClass("after-active-step"):t.addClass("active-step"),0===n&&t.addClass("first"),n===this.steps.length-1&&t.addClass("last")),n===this.steps.length-1&&this.$wizardStepsBody.css("background-color",t.css("background-color"))}},{key:"_stepIndex",value:function(e){if(e){var t=e.data("wizard-step");if(t)return t.index}return-1}},{key:"_updateStepsMap",value:function(){var e=this;this.stepsMap={},this.steps.forEach((function(t){e.stepsMap[t.index]=t}))}},{key:"_resolveStep",value:function(e){for(var t=0;t<this.steps.length;t++){var n=this.steps[t];if(n.index===e)return n}return null}},{key:"_onStepClick",value:function(e){var t=s()(e.currentTarget),n=this._stepIndex(t);n>=0&&n!==this.activeStepIndex&&this.trigger("stepAction",{stepIndex:n})}},{key:"scrollToActiveStep",value:function(){var e=this.stepsMap[this.activeStepIndex];if(e){var t=e.$step,n=t.position().left,r=this.animateScrolling&&this.htmlComp.layouted;if(this.keepActiveStepAtLeftBorder){var o=n-this.steps[0].$step.cssPaddingLeft()+t.cssPaddingLeft();Lh.scrollLeft(this.$field,o,{animate:r})}else{var i=this.$field.scrollLeft(),s=t.width(),a=this.$field.width(),l=this.previousActiveStepIndex>this.activeStepIndex,u=i+Math.floor(a*(l?.25:.75)),c=n+Math.floor(s/2);(l&&c<u||!l&&c>u)&&Lh.scrollLeft(this.$field,i+(c-u),{animate:r})}}}}])&&jte(t.prototype,n),r&&jte(t,r),i}(ZW);function Vte(e){return(Vte="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Wte(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function zte(e,t,n){return(zte="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=qte(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function Gte(e,t){return(Gte=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Ute(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=qte(e);if(t){var o=qte(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Kte(this,n)}}function Kte(e,t){return!t||"object"!==Vte(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function qte(e){return(qte=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Yte=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Gte(e,t)}(i,e);var t,n,r,o=Ute(i);function i(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),o.call(this)}return t=i,(n=[{key:"_onWidgetStepAction",value:function(e){this._send("doStepAction",{stepIndex:e.stepIndex})}},{key:"_onWidgetEvent",value:function(e){"stepAction"===e.type?this._onWidgetStepAction(e):zte(qte(i.prototype),"_onWidgetEvent",this).call(this,e)}}])&&Wte(t.prototype,n),r&&Wte(t,r),i}(sz);function Xte(e){return(Xte="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Jte(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Zte(e,t,n){return(Zte="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=nne(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function Qte(e,t){return(Qte=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function ene(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=nne(e);if(t){var o=nne(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return tne(this,n)}}function tne(e,t){return!t||"object"!==Xte(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function nne(e){return(nne=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var rne=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Qte(e,t)}(i,e);var t,n,r,o=ene(i);function i(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),o.call(this,e)}return t=i,(n=[{key:"layout",value:function(e){Zte(nne(i.prototype),"layout",this).call(this,e);var t=this.formField.$field.scrollLeft(),n=this.formField.$wizardStepsBody;n.width("auto");var r=n[0].scrollWidth;n.width(r),this.formField.$field.scrollLeft(t),this.formField.scrollToActiveStep()}}])&&Jte(t.prototype,n),r&&Jte(t,r),i}(dz);function one(e){return(one="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ine(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function sne(e,t,n){return(sne="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=fne(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function ane(e,t){return(ane=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function lne(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=fne(e);if(t){var o=fne(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return une(this,n)}}function une(e,t){return!t||"object"!==one(t)&&"function"!=typeof t?cne(e):t}function cne(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function fne(e){return(fne=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var hne=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ane(e,t)}(i,e);var t,n,r,o=lne(i);function i(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(e=o.call(this))._addWidgetProperties(["innerForm"]),e.innerForm=null,e.initialFocusEnabled=!1,e._formDestroyHandler=e._onInnerFormDestroy.bind(cne(e)),e}return t=i,(n=[{key:"_init",value:function(e){sne(fne(i.prototype),"_init",this).call(this,e),this._setInnerForm(this.innerForm)}},{key:"_render",value:function(){this.addContainer(this.$parent,"wrapped-form-field"),this.addLabel(),this.addStatus()}},{key:"_renderProperties",value:function(){sne(fne(i.prototype),"_renderProperties",this).call(this),this._renderInnerForm()}},{key:"setInnerForm",value:function(e){this.setProperty("innerForm",e)}},{key:"_setInnerForm",value:function(e){this.innerForm&&this.innerForm.off("destroy",this._formDestroyHandler),e&&e.on("destroy",this._formDestroyHandler),this._setProperty("innerForm",e)}},{key:"_renderInnerForm",value:function(){this.innerForm&&(this.innerForm.displayHint=CC.DisplayHint.VIEW,this.innerForm.modal=!1,this.innerForm.renderInitialFocusEnabled=this.initialFocusEnabled,this.innerForm.render(),this.addField(this.innerForm.$container),this.innerForm.invalidateLayoutTree(),this._renderInitialFocusEnabled())}},{key:"_removeInnerForm",value:function(){this.innerForm&&this.innerForm.remove(),this._removeField()}},{key:"_onInnerFormDestroy",value:function(e){this._removeInnerForm(),this._setInnerForm(null)}},{key:"_renderInitialFocusEnabled",value:function(){this.innerForm&&this.initialFocusEnabled&&this.innerForm.renderInitialFocus()}}])&&ine(t.prototype,n),r&&ine(t,r),i}(ZW);function pne(e){return(pne="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function dne(e,t){return(dne=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function yne(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=bne(e);if(t){var o=bne(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return vne(this,n)}}function vne(e,t){return!t||"object"!==pne(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function bne(e){return(bne=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var mne=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&dne(e,t)}(n,e);var t=yne(n);function n(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),t.call(this)}return n}(sz);function gne(e){return(gne="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _ne(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function wne(e,t,n){return(wne="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Tne(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function kne(e,t){return(kne=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Sne(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Tne(e);if(t){var o=Tne(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return One(this,n)}}function One(e,t){return!t||"object"!==gne(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Tne(e){return(Tne=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Cne=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&kne(e,t)}(i,e);var t,n,r,o=Sne(i);function i(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(e=o.call(this)).activated=!1,e.label=null,e.htmlEnabled=!1,e.$label=null,e.$button=null,e.tooltipText=null,e}return t=i,(n=[{key:"_init",value:function(e){wne(Tne(i.prototype),"_init",this).call(this,e),this.setTooltipText(e.tooltipText)}},{key:"_render",value:function(){this.$container=this.$parent.appendDiv("switch"),this.$label=this.$container.appendDiv("switch-label"),this.$button=this.$container.appendDiv("switch-button").on("click",this._onSwitchButtonClick.bind(this))}},{key:"_renderProperties",value:function(){wne(Tne(i.prototype),"_renderProperties",this).call(this),this._renderActivated(),this._renderLabel(),this._renderTooltipText()}},{key:"_onSwitchButtonClick",value:function(){var e=new sn;this.trigger("switch",e),e.defaultPrevented||this.setActivated(!this.activated)}},{key:"setLabel",value:function(e){this.setProperty("label",e)}},{key:"_renderLabel",value:function(){this.htmlEnabled?this.$label.html(this.label):this.$label.text(this.label)}},{key:"setActivated",value:function(e){this.setProperty("activated",e)}},{key:"_renderActivated",value:function(){this.$button.toggleClass("activated",this.activated)}},{key:"setTooltipText",value:function(e){this.setProperty("tooltipText",e)}},{key:"_renderTooltipText",value:function(){Wn.hasText(this.tooltipText)?xp.install(this.$container,{parent:this,text:this.tooltipText}):xp.uninstall(this.$container)}}])&&_ne(t.prototype,n),r&&_ne(t,r),i}(ve);function Pne(e){return(Pne="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Rne(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function xne(e,t,n){return(xne="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Fne(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function Ene(e,t){return(Ene=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Dne(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Fne(e);if(t){var o=Fne(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Ane(this,n)}}function Ane(e,t){return!t||"object"!==Pne(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Fne(e){return(Fne=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var $ne=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ene(e,t)}(i,e);var t,n,r,o=Dne(i);function i(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(e=o.call(this)).overflowEnabled=!0,e.$overflowIcon=null,e.overflowVisible=!1,e.overflow=null,e.tags=[],e.clickable=!1,e}return t=i,r=[{key:"findFocusedTagElement",value:function(e){return e.find(".tag-element.focused")}},{key:"findFocusableTagElements",value:function(e){return e.find(".tag-element:not(.hidden),.overflow-icon")}},{key:"focusFirstTagElement",value:function(e){this.focusTagElement(this.firstTagElement(e))}},{key:"firstTagElement",value:function(e){return e.find(".tag-element").first()}},{key:"focusTagElement",value:function(e){e.setTabbable(!0).addClass("focused").focus()}},{key:"unfocusTagElement",value:function(e){e.setTabbable(!1).removeClass("focused")}},{key:"getTagData",value:function(e){var t=e.data("tag");return t||e.parent().data("tag")}},{key:"renderTags",value:function(e,t,n,r,o){e.find(".tag-element").remove(),t.forEach((function(t){i.renderTag(e,t,n,r,o)}),this)}},{key:"renderTag",value:function(e,t,n,r,o){var i=e.appendDiv("tag-element").data("tag",t),s=i.appendSpan("tag-text",t);return r&&s.addClass("clickable").on("mousedown",r),n?i.appendSpan("tag-remove-icon").on("click",o):i.addClass("disabled"),i}}],(n=[{key:"_render",value:function(){this.$container=this.$parent.appendDiv("tag-bar"),this.htmlComp=ea.install(this.$container,this.session),this.htmlComp.setLayout(new Nne(this)),this._installTooltipSupport()}},{key:"_renderProperties",value:function(){xne(Fne(i.prototype),"_renderProperties",this).call(this),this._renderTags(),this._renderOverflowVisible()}},{key:"_remove",value:function(){this.$overflowIcon=null,this.overflowVisible=!1,this.closeOverflowPopup(),this._uninstallTooltipSupport(),xne(Fne(i.prototype),"_remove",this).call(this)}},{key:"setTags",value:function(e){this.setProperty("tags",e)}},{key:"updateTags",value:function(){this.rendered&&this._renderTags()}},{key:"_renderTags",value:function(){var e=rt.ensure(this.tags),t=this.clickable?this._onTagClick.bind(this):null,n=this._onTagRemoveClick.bind(this);i.renderTags(this.$container,e,this.enabledComputed,t,n),this.invalidateLayoutTree()}},{key:"_onTagClick",value:function(e){var t=i.getTagData(s()(e.currentTarget));return this._triggerTagClick(t),!1}},{key:"_triggerTagClick",value:function(e){this.trigger("tagClick",{tag:e})}},{key:"_onTagRemoveClick",value:function(e){return this.enabledComputed&&this.removeTagByElement(s()(e.currentTarget)),!1}},{key:"removeTagByElement",value:function(e){var t=i.getTagData(e);t&&this._triggerTagRemove(t,e)}},{key:"_triggerTagRemove",value:function(e,t){this.trigger("tagRemove",{tag:e,$tag:t})}},{key:"_onOverflowIconMousedown",value:function(e){return this.openOverflowPopup(),!1}},{key:"isOverflowIconFocused",value:function(){if(!this.$overflowIcon)return!1;var e=this.$container.activeElement();return this.$overflowIcon.is(e)}},{key:"openOverflowPopup",value:function(){this.overflow||(this.overflow=this._createOverflowPopup(),this.overflow.on("close",this._onOverflowPopupClose.bind(this)),this.overflow.open())}},{key:"_createOverflowPopup",value:function(){return O.create("TagBarOverflowPopup",{parent:this,closeOnAnchorMouseDown:!1,focusableContainer:!0,$anchor:this.$container,$headBlueprint:this.$overflowIcon,cssClass:this.cssClass})}},{key:"closeOverflowPopup",value:function(){this.overflow&&!this.overflow.destroying&&this.overflow.close()}},{key:"_onOverflowPopupClose",value:function(){this.overflow=null}},{key:"_installTooltipSupport",value:function(){xp.install(this.$container,{parent:this,selector:".tag-text",text:this._tagTooltipText.bind(this),arrowPosition:50,arrowPositionUnit:"%",nativeTooltip:!Kt.get().isCustomEllipsisTooltipPossible()})}},{key:"_uninstallTooltipSupport",value:function(){xp.uninstall(this.$container)}},{key:"_tagTooltipText",value:function(e){return e.isContentTruncated()?e.text():null}},{key:"_removeFocusFromTagElements",value:function(){i.findFocusableTagElements(this.$container).removeClass("focused").setTabbable(!1)}},{key:"focus",value:function(){this.$container.addClass("focused"),this._removeFocusFromTagElements(),this.closeOverflowPopup()}},{key:"blur",value:function(){this.$container.removeClass("focused"),this.overflow&&this.overflow.$container.has(event.relatedTarget)||this.closeOverflowPopup()}},{key:"setOverflowVisible",value:function(e){this.setProperty("overflowVisible",e)}},{key:"_renderOverflowVisible",value:function(){this.overflowVisible?this.$overflowIcon||(this.$overflowIcon=this.$container.prependDiv("overflow-icon").on("mousedown",this._onOverflowIconMousedown.bind(this))):this.$overflowIcon&&(this.$overflowIcon.remove(),this.$overflowIcon=null)}},{key:"_updateErrorStatusClasses",value:function(e,t){xne(Fne(i.prototype),"_updateErrorStatusClasses",this).call(this,e,t),this.$container.removeClass(ZW.SEVERITY_CSS_CLASSES),this.$container.addClass(e,t)}},{key:"visibleTags",value:function(){if(!this.rendered)return[];var e=[];return this.$container.find(".tag-element:not(.hidden)").each((function(){e.push(i.getTagData(s()(this)))})),e}}])&&Rne(t.prototype,n),r&&Rne(t,r),i}(ve);function jne(e){return(jne="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Bne(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Mne(e,t){return(Mne=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Ine(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Hne(e);if(t){var o=Hne(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Lne(this,n)}}function Lne(e,t){return!t||"object"!==jne(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Hne(e){return(Hne=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Nne=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Mne(e,t)}(i,e);var t,n,r,o=Ine(i);function i(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(t=o.call(this)).tagBar=e,t}return t=i,(n=[{key:"layout",value:function(e){var t=ea.get(e);if(this.tagBar.tags&&this.tagBar.tags.length>0){var n,r,o=t.availableSize().subtract(t.insets()).width,i=0,a=!1,l=e.find(".tag-element"),u=l.length,c=[];for(l.removeClass("hidden"),r=u-1;r>=0&&(n=s()(l[r]),c[r]=qs.size(n,{includeMargin:!0}),!(a=i+c[r].width>o));r--)i+=c[r].width;if(this.tagBar.setOverflowVisible(a),a)for(i=qs.size(this.tagBar.$overflowIcon,{includeMargin:!0}).width,r=u-1;r>=0;r--)n=s()(l[r]),c[r]?i+c[r].width>o?n.addClass("hidden"):i+=c[r].width:n.addClass("hidden")}}},{key:"preferredLayoutSize",value:function(e,t){var n=ea.get(e),r=this.tagBar.tags&&this.tagBar.tags.length>0,o=n.availableSize(),i=0;if(!r)return new $s(0,o.height);var a=e.find(".tag-element");return a.removeClass("hidden"),a.each((function(){i+=qs.size(s()(this),{includeMargin:!0}).width})),new $s(i,o.height)}}])&&Bne(t.prototype,n),r&&Bne(t,r),i}(Zs);function Vne(e){return(Vne="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Wne(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function zne(e,t,n){return(zne="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=qne(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function Gne(e,t){return(Gne=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Une(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=qne(e);if(t){var o=qne(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Kne(this,n)}}function Kne(e,t){return!t||"object"!==Vne(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function qne(e){return(qne=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Yne=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Gne(e,t)}(i,e);var t,n,r,o=Une(i);function i(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(e=o.call(this))._tagBarPropertyChangeListener=null,e.initialFocus=function(){return $ne.firstTagElement(this.$body).setTabbable(!0).addClass("focused")[0]},e}return t=i,r=[{key:"createFieldAdapter",value:function(e){return{$container:function(){return e.$body},enabled:function(){return!0},focus:function(){},one:function(t,n){e.one(t,n)},off:function(t,n){e.off(t,n)},removeTag:function(t){e.parent.parent.removeTag(t)}}}}],(n=[{key:"_init",value:function(e){zne(qne(i.prototype),"_init",this).call(this,e),this._tagBarPropertyChangeListener=this._onTagBarPropertyChange.bind(this),this.parent.on("propertyChange",this._tagBarPropertyChangeListener)}},{key:"_initKeyStrokeContext",value:function(){zne(qne(i.prototype),"_initKeyStrokeContext",this).call(this),this.keyStrokeContext.registerKeyStrokes([new mee(this._createFieldAdapter()),new cee(this._createFieldAdapter())])}},{key:"_destroy",value:function(){this.parent.off("propertyChange",this._tagBarPropertyChangeListener),zne(qne(i.prototype),"_destroy",this).call(this)}},{key:"_render",value:function(){zne(qne(i.prototype),"_render",this).call(this),this.$body.addClass("tag-overflow-popup"),this._renderTags()}},{key:"_renderTags",value:function(){var e=this.parent,t=e.visibleTags(),n=rt.ensure(e.tags).filter((function(e){return-1===t.indexOf(e)})),r=e._onTagClick.bind(e),o=e._onTagRemoveClick.bind(e);$ne.renderTags(this.$body,n,e.enabledComputed,r,o),this.rendering||this.revalidateLayout()}},{key:"_renderHead",value:function(){zne(qne(i.prototype),"_renderHead",this).call(this),this._copyCssClassToHead("overflow-icon"),this.$head.removeClass("popup-head menu-item").addClass("tag-overflow-popup-head")}},{key:"_focusFirstTagElement",value:function(){$ne.focusFirstTagElement(this.$body)}},{key:"_onTagRemoveClick",value:function(e){this.parent._onTagRemoveClick(e)}},{key:"_onTagBarPropertyChange",value:function(e){if("tags"===e.propertyName){var t=rt.ensure(this.parent.tags),n=this.parent.visibleTags(),r=t.length;0===r||r===n.length?this.close():(this._renderTags(),this._focusFirstTagElement())}}},{key:"_createFieldAdapter",value:function(){return i.createFieldAdapter(this)}}])&&Wne(t.prototype,n),r&&Wne(t,r),i}(wy);function Xne(e){return(Xne="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Jne(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Zne(e,t,n){return(Zne="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=nre(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function Qne(e,t){return(Qne=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function ere(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=nre(e);if(t){var o=nre(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return tre(this,n)}}function tre(e,t){return!t||"object"!==Xne(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function nre(e){return(nre=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var rre=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Qne(e,t)}(i,e);var t,n,r,o=ere(i);function i(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(e=o.call(this)).displayStyle=i.DisplayStyle.DEFAULT,e.filterAccepted=!0,e.gridData=null,e.gridDataHints=new Ez,e.colorScheme=null,e.selected=!1,e.selectable=!1,e}return t=i,(n=[{key:"_createLoadingSupport",value:function(){return new oe({widget:this})}},{key:"_init",value:function(e){Zne(nre(i.prototype),"_init",this).call(this,e),this._setGridDataHints(this.gridDataHints),this._setColorScheme(this.colorScheme),this._setSelectable(this.selectable)}},{key:"_render",value:function(){this.$container=this.$parent.appendDiv("tile"),this.htmlComp=ea.install(this.$container,this.session),this.htmlComp.setLayout(new Ml)}},{key:"_renderProperties",value:function(){Zne(nre(i.prototype),"_renderProperties",this).call(this),this._renderColorScheme(),this._renderSelectable(),this._renderSelected(),this._renderDisplayStyle()}},{key:"_postRender",value:function(){this.$container.addClass("tile"),this.htmlComp.layout.animateClasses=["animate-visible","animate-invisible","animate-insert","animate-remove"]}},{key:"_renderDisplayStyle",value:function(){this.$container.toggleClass("default-tile",this.displayStyle===i.DisplayStyle.DEFAULT)}},{key:"setGridDataHints",value:function(e){this.setProperty("gridDataHints",e),this.rendered&&this.parent.invalidateLogicalGrid()}},{key:"_setGridDataHints",value:function(e){e||(e=new Ez),this._setProperty("gridDataHints",Ez.ensure(e))}},{key:"setColorScheme",value:function(e){this.setProperty("colorScheme",e)}},{key:"_setColorScheme",value:function(e){var t={scheme:dt.ColorSchemeId.DEFAULT,inverted:!1};e=dt.ensureColorScheme(e,!0),e=s.a.extend({},t,e),this._setProperty("colorScheme",e)}},{key:"_renderColorScheme",value:function(){dt.toggleColorSchemeClasses(this.$container,this.colorScheme)}},{key:"setSelected",value:function(e){e&&!this.selectable||this.setProperty("selected",e)}},{key:"_renderSelected",value:function(){this.$container.toggleClass("selected",this.selected)}},{key:"setSelectable",value:function(e){this.setProperty("selectable",e)}},{key:"_setSelectable",value:function(e){this._setProperty("selectable",e),this.selectable||this.setSelected(!1)}},{key:"_renderSelectable",value:function(){this.$container.toggleClass("selectable",this.selectable)}},{key:"setFilterAccepted",value:function(e){this.setProperty("filterAccepted",e)}},{key:"_renderFilterAccepted",value:function(){this._renderVisible()}},{key:"_renderVisible",value:function(){var e=this;this.rendering?this.$container.setVisible(this.isVisible()):this.removalPending||(this.isVisible()?(this.$container.addClass("invisible"),this.$container.setVisible(!0),this.session.layoutValidator.schedulePostValidateFunction((function(){e.rendered&&e.isVisible()&&(e.$container.removeClass("invisible animate-invisible"),e.$container.addClassForAnimation("animate-visible"))}))):(this.$container.removeClass("invisible animate-visible"),this.$container.addClassForAnimation("animate-invisible"),this.$container.oneAnimationEnd((function(){e.$container.setVisible(e.isVisible())}))),this.invalidateParentLogicalGrid())}},{key:"isVisible",value:function(){return this.visible&&this.filterAccepted}}])&&Jne(t.prototype,n),r&&Jne(t,r),i}(ve);function ore(e){return(ore="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ire(e,t){return(ire=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function sre(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=lre(e);if(t){var o=lre(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return are(this,n)}}function are(e,t){return!t||"object"!==ore(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function lre(e){return(lre=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}!function(e,t,n){t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}(rre,"DisplayStyle",{DEFAULT:"default",PLAIN:"plain"});var ure=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ire(e,t)}(n,e);var t=sre(n);function n(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),t.call(this)}return n}(de);function cre(e){return(cre="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function fre(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function hre(e,t,n){return(hre="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=bre(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function pre(e,t){return(pre=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function dre(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=bre(e);if(t){var o=bre(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return yre(this,n)}}function yre(e,t){return!t||"object"!==cre(t)&&"function"!=typeof t?vre(e):t}function vre(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function bre(e){return(bre=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var mre="> .tile",gre=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&pre(e,t)}(i,e);var t,n,r,o=dre(i);function i(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(e=o.call(this)).animateTileRemoval=!0,e.animateTileInsertion=!0,e.comparator=null,e._doubleClickSupport=new Yt,e.empty=!1,e.filters=[],e.filteredTiles=[],e.filteredTilesDirty=!0,e.focusedTile=null,e.gridColumnCount=4,e.prefGridColumnCount=e.gridColumnCount,e.logicalGrid=O.create("scout.HorizontalGrid"),e.layoutConfig=null,e.menus=[],e.multiSelect=!0,e.renderAnimationEnabled=!1,e.selectable=!1,e.selectedTiles=[],e.selectionHandler=new Zre(vre(e)),e.scrollable=!0,e.scrolling=!1,e.scrollTopDirty=!1,e.startupAnimationDone=!1,e.startupAnimationEnabled=!1,e.tiles=[],e.tileRemovalPendingCount=0,e.viewRangeSize=0,e.viewRangeRendered=new Fr(0,0),e.virtual=!1,e.virtualScrolling=null,e.withPlaceholders=!1,e._filterMenusHandler=e._filterMenus.bind(vre(e)),e._renderViewPortAfterAttach=!1,e._scrollParentScrollHandler=e._onScrollParentScroll.bind(vre(e)),e._addWidgetProperties(["tiles","selectedTiles","menus"]),e._addPreserveOnPropertyChangeProperties(["selectedTiles"]),e.$fillBefore=null,e.$fillAfter=null,e}return t=i,(n=[{key:"_init",value:function(e){hre(bre(i.prototype),"_init",this).call(this,e),this._setGridColumnCount(this.gridColumnCount),this._setLayoutConfig(this.layoutConfig),this._initVirtualScrolling(),this._initTiles(),this._applyFilters(this.tiles),this._updateFilteredTiles(),this._setMenus(this.menus)}},{key:"_createKeyStrokeContext",value:function(){return new $u}},{key:"_initVirtualScrolling",value:function(){this.virtualScrolling=this._createVirtualScrolling()}},{key:"_createVirtualScrolling",value:function(){return new Nh({widget:this,enabled:this.virtual,viewRangeSize:this.viewRangeSize,rowHeight:this._heightForRow.bind(this),rowCount:this.rowCount.bind(this),_renderViewRange:this._renderViewRange.bind(this)})}},{key:"_createLoadingSupport",value:function(){return new oe({widget:this})}},{key:"_initKeyStrokeContext",value:function(){hre(bre(i.prototype),"_initKeyStrokeContext",this).call(this),this.keyStrokeContext.registerKeyStroke([new vie(this),new Oie(this),new Aie(this),new Hie(this),new qie(this),new nse(this),new cse(this),new ic(this,this.showContextMenu,this)])}},{key:"_initTiles",value:function(){this.tiles.forEach((function(e){this._initTile(e)}),this)}},{key:"_initTile",value:function(e){e.setSelectable(this.selectable),e.setSelected(this.selectedTiles.indexOf(e)>=0),e.setParent(this),e.setFilterAccepted(!0)}},{key:"_render",value:function(){this.$container=this.$parent.appendDiv("tile-grid"),this.htmlComp=ea.install(this.$container,this.session),this.htmlComp.setLayout(this._createLayout()),this.$container.on("mousedown",mre,this._onTileMouseDown.bind(this)).on("click",mre,this._onTileClick.bind(this)).on("dblclick",mre,this._onTileDoubleClick.bind(this))}},{key:"_createLayout",value:function(){return new Vre(this,this.layoutConfig)}},{key:"_renderProperties",value:function(){hre(bre(i.prototype),"_renderProperties",this).call(this),this._renderLayoutConfig(),this._renderScrollable(),this._renderVirtual(),this._renderSelectable(),this._renderEmpty()}},{key:"_remove",value:function(){this.$fillBefore=null,this.$fillAfter=null,this.viewRangeRendered=new Fr(0,0),this._updateVirtualScrollable(),hre(bre(i.prototype),"_remove",this).call(this)}},{key:"_renderOnAttach",value:function(){hre(bre(i.prototype),"_renderOnAttach",this).call(this),this._renderViewPortAfterAttach&&(this._renderViewPort(),this._renderViewPortAfterAttach=!1)}},{key:"_renderEnabled",value:function(){hre(bre(i.prototype),"_renderEnabled",this).call(this),this._updateTabbable()}},{key:"_updateTabbable",value:function(){this.$container.setTabbable(this.enabled&&this.selectable)}},{key:"insertTile",value:function(e){this.insertTiles([e])}},{key:"insertTiles",value:function(e,t){0!==(e=rt.ensure(e)).length&&this.setTiles(this.tiles.concat(e),t)}},{key:"deleteTile",value:function(e){this.deleteTiles([e])}},{key:"deleteTiles",value:function(e,t){if(0!==(e=rt.ensure(e)).length){var n=this.tiles.slice();rt.removeAll(n,e),this.setTiles(n,t)}}},{key:"deleteAllTiles",value:function(){this.setTiles([])}},{key:"setTiles",value:function(e,t){if(e=rt.ensure(e),!Pr.equals(this.tiles,e)){e=this._createChildren(e),this.withPlaceholders&&O.nvl(t,!0)&&this._deletePlaceholders(e);var n=rt.diff(e,this.tiles);if(this._insertTiles(n),this.withPlaceholders&&O.nvl(t,!0)){var r=this.placeholders();r=r.slice(Math.min(this._filterTiles(n).length,r.length),r.length),rt.pushAll(e,r)}var o=rt.diff(this.tiles,e);this._deleteTiles(o),this._sort(e),this.filteredTilesDirty=this.filteredTilesDirty||o.length>0||n.length>0||!rt.equals(this.tiles,e);var i=this.tiles;this._setProperty("tiles",e),this._updateFilteredTiles(),this.rendered&&(this._renderTileDelta(),this._renderTileOrder(i),this._renderInsertTiles(n))}}},{key:"_insertTiles",value:function(e){0!==e.length&&e.forEach((function(e){this._insertTile(e)}),this)}},{key:"_insertTile",value:function(e){this._initTile(e),this._applyFilters([e]),!this.virtual&&this.rendered&&this._renderTile(e)}},{key:"_renderTile",value:function(e){var t=this;e.removalPending?e.one("remove",(function(){e.rendered||(t._renderTile(e),t._renderTileVisibleForFilter(e),0===t.tileRemovalPendingCount&&t.invalidateLayoutTree())})):(e.render(),e.setLayoutData(new ua(e)),e.$container.addClass("newly-rendered"))}},{key:"_renderInsertTiles",value:function(e){e.forEach((function(e){var t=this;e.rendered&&(e.$container.addClass("invisible"),this.one("layoutAnimationDone",(function(){e.rendered&&(e.$container.removeClass("invisible"),t._animateTileInsertion(e)&&e.$container.addClassForAnimation("animate-insert"))})))}),this),this.htmlComp.layouting||this.invalidateLayoutTree()}},{key:"_removeAllTiles",value:function(){this.tiles.forEach((function(e){e.remove()})),this.viewRangeRendered=new Fr(0,0)}},{key:"_renderAllTiles",value:function(){this.tiles.forEach((function(e){this._renderTile(e)}),this)}},{key:"_deleteTiles",value:function(e){0!==e.length&&(e.forEach((function(e){this._deleteTile(e)}),this),this.deselectTiles(e),this.rendered&&!this.htmlComp.layouting&&this.invalidateLayoutTree())}},{key:"_deleteTile",value:function(e){this._animateTileRemoval(e)&&(e.animateRemoval=!0),e.owner===this?e.destroy():this.rendered&&e.remove(),this._onAnimatedTileRemove(e),e.animateRemoval=!1,e===this.focusedTile&&this.setFocusedTile(null)}},{key:"_animateTileRemoval",value:function(e){return this.animateTileRemoval&&!(e instanceof jse)}},{key:"_animateTileInsertion",value:function(e){return this.animateTileInsertion&&!(e instanceof jse)}},{key:"_onAnimatedTileRemove",value:function(e){var t=this;e.rendered&&e.animateRemoval&&(this.tileRemovalPendingCount++,e.one("remove",(function(){t.tileRemovalPendingCount--,t.rendered&&0===t.tileRemovalPendingCount&&!t.htmlComp.layouting&&t.invalidateLayoutTree()})))}},{key:"setComparator",value:function(e){this.comparator!==e&&(this.comparator=e)}},{key:"sort",value:function(){var e=this.tiles.slice();if(this._sort(e),!rt.equals(this.tiles,e)){var t=this.tiles;this._setProperty("tiles",e),this.filteredTilesDirty=!0,this._updateFilteredTiles(),this.rendered&&(this._renderTileDelta(),this._renderTileOrder(t),this.validateLayoutTree())}}},{key:"_sort",value:function(e){if(null!==this.comparator){var t=[];this.withPlaceholders&&(t=this._deletePlaceholders(e)),e.sort(this.comparator),rt.pushAll(e,t)}}},{key:"invalidateLayoutTree",value:function(e){this.tileRemovalPendingCount>0||hre(bre(i.prototype),"invalidateLayoutTree",this).call(this,e)}},{key:"setGridColumnCount",value:function(e){this.setProperty("gridColumnCount",e)}},{key:"_setGridColumnCount",value:function(e){this._setProperty("gridColumnCount",e),this.prefGridColumnCount=e,this.invalidateLogicalGrid()}},{key:"setLayoutConfig",value:function(e){this.setProperty("layoutConfig",e)}},{key:"_setLayoutConfig",value:function(e){e||(e=new Xre),this._setProperty("layoutConfig",Xre.ensure(e))}},{key:"_renderLayoutConfig",value:function(){var e=this.htmlComp.layout.minWidth;this.layoutConfig.applyToLayout(this.htmlComp.layout),this.virtualScrolling&&(this.virtualScrolling.setMinRowHeight(this._minRowHeight()),this.setViewRangeSize(this.virtualScrolling.viewRangeSize,!1)),e!==this.htmlComp.layout.minWidth&&this._renderScrollable(),this.invalidateLayoutTree()}},{key:"_setMenus",value:function(e,t){this.updateKeyStrokes(e,t),this._setProperty("menus",e)}},{key:"_filterMenus",value:function(e,t,n,r,o){return zm.filterAccordingToSelection("TileGrid",this.selectedTiles.length,e,t,n,r,o)}},{key:"showContextMenu",value:function(e){this.session.onRequestsDone(this._showContextMenu.bind(this,e))}},{key:"_showContextMenu",value:function(e){if(e=e||{},this.rendered&&this.attached&&0!==this.selectedTiles.length){var t=e.menuItems||this._filterMenus(this.menus,Gm.CONTEXT_MENU,!0,!1);if(0!==t.length){var n=O.nvl(e.pageX,null),r=O.nvl(e.pageY,null);if(null===n||null===r){var o,i=this.$container.scrollParent();0===i.length&&(i=this.$container);var s=qs.offsetBounds(i),a=this.focusedTile||rt.last(this.selectedTiles);n=(o=this.isTileInView(a)?a.$container.offset():this.$container.offset()).left+10,r=o.top+10,n=Math.min(Math.max(n,s.x+1),s.right()-1),r=Math.min(Math.max(r,s.y+1),s.bottom()-1)}this.contextMenu&&this.contextMenu.close(),this.contextMenu=O.create("ContextMenuPopup",{parent:this,menuItems:t,location:{x:n,y:r},$anchor:this.$container,menuFilter:e.menuFilter||this._filterMenusHandler}),this.contextMenu.open()}}}},{key:"setScrollable",value:function(e){this.setProperty("scrollable",e)}},{key:"_renderScrollable",value:function(){this._uninstallScrollbars(),this.scrollable?this._installScrollbars({axis:this.layoutConfig.minWidth>0?"both":"y"}):this.layoutConfig.minWidth>0&&this._installScrollbars({axis:"x"}),this.$container.toggleClass("scrollable",this.scrollable),this._updateVirtualScrollable(),this.invalidateLayoutTree()}},{key:"_onScroll",value:function(){var e=this.$container[0].scrollTop,t=this.$container[0].scrollLeft;this.scrollTop!==e&&this.virtual&&(this.scrolling=!0,this.revalidateLayout(),this.scrolling=!1),this.scrollTop=e,this.scrollLeft=t}},{key:"_onScrollParentScroll",value:function(e){this.scrolling=!0,this.revalidateLayoutTree(!1),this.scrolling=!1}},{key:"setWithPlaceholders",value:function(e){this.setProperty("withPlaceholders",e)}},{key:"_renderWithPlaceholders",value:function(){this.invalidateLayoutTree()}},{key:"fillUpWithPlaceholders",value:function(){this.withPlaceholders?(this._deleteObsoletePlaceholders(),this._insertMissingPlaceholders()):this._deleteAllPlaceholders()}},{key:"tilesWithoutPlaceholders",value:function(){return this.withPlaceholders?this.tiles.filter((function(e){return!(e instanceof jse)})):this.tiles}},{key:"_createPlaceholders",value:function(){var e,t,n=this.gridColumnCount,r=this.filteredTiles,o=[];if((t=r.length>0?r[r.length-1].gridData.x:-1)===n-1)return[];e=n-1-t;for(var i=0;i<e;i++)o.push(this._createPlaceholder());return o}},{key:"_createPlaceholder",value:function(){return O.create("PlaceholderTile",{parent:this})}},{key:"_deleteObsoletePlaceholders",value:function(){var e=[],t=!1;this.placeholders().forEach((function(n){0===n.gridData.x&&this.filteredTiles[0]!==n&&(t=!0),t&&e.push(n)}),this),this.deleteTiles(e,!1)}},{key:"_deleteAllPlaceholders",value:function(){this.deleteTiles(this.placeholders(),!1)}},{key:"placeholders",value:function(){var e,t=[];for(e=this.tiles.length-1;e>=0&&this.tiles[e]instanceof jse;e--)rt.insert(t,this.tiles[e],0);return t}},{key:"_insertMissingPlaceholders",value:function(){var e=this._createPlaceholders();this.insertTiles(e,!1)}},{key:"_deletePlaceholders",value:function(e){var t,n=[];for(t=e.length-1;t>=0;t--)e[t]instanceof jse&&(n.push(e[t]),rt.remove(e,e[t]));return n.reverse()}},{key:"_replacePlaceholders",value:function(e,t){for(var n=rt.findIndexFromReverse(e,e.length-1,(function(e){return!(e instanceof jse)})),r=e.length-1-n,o=1;o<=r;o++){var i=e[n+o];!t[o-1]||t[o-1]instanceof jse||rt.remove(e,i)}}},{key:"validateLogicalGrid",value:function(){this.logicalGrid.dirty&&(this.logicalGrid.validate(this),this.fillUpWithPlaceholders(),this.logicalGrid.setDirty(!0),this.logicalGrid.validate(this))}},{key:"_setLogicalGrid",value:function(e){hre(bre(i.prototype),"_setLogicalGrid",this).call(this,e),this.logicalGrid&&this.logicalGrid.setGridConfig(new $re)}},{key:"setFocusedTile",value:function(e){if(this.focusedTile!==e&&(this.focusedTile=e,this.rendered&&e&&!this.isFocused())){var t=this.$container.scrollParents();if(0!==t.length){var n=t.map((function(e,t){return t.scrollTop()})).toArray();this.focus()&&n.forEach((function(e,n){t[n].scrollTop(e)}),this)}}}},{key:"setSelectable",value:function(e){this.setProperty("selectable",e),e||this.deselectAllTiles(),this.tiles.forEach((function(t){t.setSelectable(e)}))}},{key:"_renderSelectable",value:function(){this.$container.toggleClass("selectable",this.selectable),this._updateTabbable(),this.invalidateLayoutTree()}},{key:"setMultiSelect",value:function(e){this.setProperty("multiSelect",e)}},{key:"selectTiles",value:function(e){if(e=rt.ensure(e),e=this._createChildren(e),e=this._filterTiles(e),this.selectable||(e=[]),!this.multiSelect&&e.length>1&&(e=[e[0]]),!rt.equals(this.selectedTiles,e)){var t=this.selectedTiles;rt.removeAll(t,e),t.forEach((function(e){e.setSelected(!1),e===this.focusedTile&&this.setFocusedTile(null)}),this),e.forEach((function(e){e.setSelected(!0)}),this),this.setProperty("selectedTiles",e.slice())}}},{key:"selectTile",value:function(e){this.selectTiles([e])}},{key:"selectAllTiles",value:function(){this.selectTiles(this.filteredTiles)}},{key:"deselectTiles",value:function(e){e=rt.ensure(e);var t=this.selectedTiles.slice();rt.removeAll(t,e)&&this.selectTiles(t)}},{key:"deselectTile",value:function(e){this.deselectTiles([e])}},{key:"deselectAllTiles",value:function(){this.selectTiles([])}},{key:"toggleSelection",value:function(){this.selectedTiles.length===this.filteredTiles.length?this.deselectAllTiles():this.selectAllTiles()}},{key:"addTilesToSelection",value:function(e){e=rt.ensure(e),this.selectTiles(this.selectedTiles.concat(e))}},{key:"addTileToSelection",value:function(e){this.addTilesToSelection([e])}},{key:"isTileInView",value:function(e){var t=this.$container.scrollParent();return 0===t.length&&(t=this.$container),!!(e&&e.$container&&t)&&qs.offsetBounds(e.$container).intersects(qs.offsetBounds(t))}},{key:"_onTileMouseDown",value:function(e){if(this._doubleClickSupport.mousedown(e),this._selectTileOnMouseDown(e),3===e.which)return this.showContextMenu({pageX:e.pageX,pageY:e.pageY}),!1}},{key:"_onTileClick",value:function(e){var t=s()(e.currentTarget).data("widget");if(!(t instanceof jse||this._doubleClickSupport.doubleClicked())){var n=e.which;this._triggerTileClick(t,n)}}},{key:"_triggerTileClick",value:function(e,t){var n={tile:e,mouseButton:t};this.trigger("tileClick",n)}},{key:"_onTileDoubleClick",value:function(e){var t=s()(e.currentTarget).data("widget");t instanceof jse||this.doTileAction(t)}},{key:"doTileAction",value:function(e){e&&this._triggerTileAction(e)}},{key:"_triggerTileAction",value:function(e){this.trigger("tileAction",{tile:e})}},{key:"setSelectionHandler",value:function(e){this.selectionHandler=e}},{key:"_selectTileOnMouseDown",value:function(e){this.selectionHandler.selectTileOnMouseDown(e)}},{key:"scrollTo",value:function(e,t){this.ensureTileRendered(e),this.scrolling=!0,this.scrollTopDirty=!0,this.validateLayoutTree(),this.scrolling=!1,e.reveal(t),this.scrollTopDirty=!1}},{key:"revealSelection",value:function(){this.rendered?this.selectedTiles.length>0&&this.scrollTo(this.selectedTiles[0]):this.session.layoutValidator.schedulePostValidateFunction(this.revealSelection.bind(this))}},{key:"addFilter",value:function(e){this.addFilters([e])}},{key:"addFilters",value:function(e){e=rt.ensure(e);var t=this.filters.slice();e.forEach((function(e){t.indexOf(e)>=0||t.push(e)})),t.length!==this.filters.length&&this.setFilters(t)}},{key:"removeFilter",value:function(e){this.removeFilters([e])}},{key:"removeFilters",value:function(e){e=rt.ensure(e);var t=this.filters.slice();rt.removeAll(t,e)&&this.setFilters(t)}},{key:"setFilters",value:function(e){this.setProperty("filters",e.slice())}},{key:"filter",value:function(){var e=this.tiles,t=this._applyFilters(this.tiles,!0);this._updateFilteredTiles(),this.rendered&&(this._renderTileDelta(t),this._renderTileOrder(e))}},{key:"_applyFilters",value:function(e,t){if(0!==this.filters.length||O.nvl(t,!1)){var n=[],r=[],o=!1;return e.forEach((function(e){this._applyFiltersForTile(e)&&(o=!0,e.filterAccepted?n.push(e):(r.push(e),e===this.focusedTile&&this.setFocusedTile(null)))}),this),o&&(this.filteredTilesDirty=!0),this.deselectTiles(r),{newlyHiddenTiles:r,newlyShownTiles:n}}}},{key:"_updateFilteredTiles",value:function(){var e=this.tiles;this.filters.length>0&&(e=this._filterTiles()),this.filteredTilesDirty&&(this.setProperty("filteredTiles",e),this.invalidateLogicalGrid(!1),this.filteredTilesDirty=!1),this._updateEmpty()}},{key:"_updateEmpty",value:function(){this.setEmpty(0===this.filteredTiles.length)}},{key:"setEmpty",value:function(e){this.setProperty("empty",e)}},{key:"_renderEmpty",value:function(){this.$container.toggleClass("empty",this.empty),this.invalidateLayoutTree()}},{key:"_applyFiltersForTile",value:function(e){if(this._tileAcceptedByFilters(e)){if(!e.filterAccepted)return e.setFilterAccepted(!0),!0}else if(e.filterAccepted)return e.setFilterAccepted(!1),!0;return!1}},{key:"_tileAcceptedByFilters",value:function(e){return!this.filters.some((function(t){return!(e instanceof jse||t.accept(e))}))}},{key:"_filterTiles",value:function(e){return e=O.nvl(e,this.tiles),0===this.filters.length?e.slice():e.filter((function(e){return e.filterAccepted}))}},{key:"findTileIndexAt",value:function(e,t,n,r){return n=O.nvl(n,0),rt.findIndexFrom(this.filteredTiles,n,(function(n,r){return n.gridData.x===e&&n.gridData.y===t}),r)}},{key:"findTilesInRange",value:function(e,t){if(e.equals(this.virtualScrolling.maxViewRange()))return this.filteredTiles;for(var n=[],r=e.from;r<e.to;r++)this.eachTileInRow(r,(function(e){t&&!t(e)||n.push(e)}));return n}},{key:"findTilesInRow",value:function(e){var t=[];return this.eachTileInRow(e,(function(e){t.push(e)})),t}},{key:"eachTileInRow",value:function(e,t){for(var n=e*this.gridColumnCount,r=n;r<n+this.gridColumnCount;r++)this.filteredTiles[r]&&t(this.filteredTiles[r],r);return[]}},{key:"setVirtual",value:function(e){this.setProperty("virtual",e)}},{key:"_setVirtual",value:function(e){this._setProperty("virtual",e),this.virtualScrolling.setEnabled(this.virtual)}},{key:"_renderVirtual",value:function(){this._updateVirtualScrollable(),this.rendering||this.setViewRangeSize(this.calculateViewRangeSize(),!1),this.rendered&&(this._removeAllTiles(),this.virtual&&this._renderFiller()),this.virtual||this._renderAllTiles(),this._renderViewPort(),this.invalidateLayoutTree()}},{key:"_updateVirtualScrollable",value:function(){var e=this.virtualScrolling.$scrollable;e&&e.off("scroll",this._scrollParentScrollHandler),this.virtual&&!this.removing?this.scrollable?this.virtualScrolling.set$Scrollable(this.$container):(this.virtualScrolling.set$Scrollable(this.$container.scrollParent()),this.virtualScrolling.$scrollable.on("scroll",this._scrollParentScrollHandler)):this.virtualScrolling.set$Scrollable(null)}},{key:"calculateViewRangeSize",value:function(){return this.virtualScrolling.calculateViewRangeSize()}},{key:"setViewRangeSize",value:function(e,t){this.viewRangeSize!==e&&(this._setProperty("viewRangeSize",e),this.virtualScrolling.setViewRangeSize(e,t))}},{key:"_heightForRow",value:function(e){var t=0;if(t=this.htmlComp.layout.rowHeight,e!==this.rowCount()-1&&(t+=this.htmlComp.layout.vgap),!pr.isNumber(t))throw new Error("Calculated height is not a number: "+t);return t}},{key:"_minRowHeight",value:function(){return this.htmlComp.layout.rowHeight+this.htmlComp.layout.vgap/2}},{key:"rowCount",value:function(e){return e=O.nvl(e,this.gridColumnCount),Math.ceil(this.filteredTiles.length/e)}},{key:"_renderViewPort",value:function(){this.isAttachedAndRendered()?this.virtual&&this.virtualScrolling._renderViewPort():this._renderViewPortAfterAttach=!0}},{key:"_renderViewRange",value:function(e){var t=this;e.equals(this.viewRangeRendered)?0===e.size()&&this._renderFiller():(this.viewRangeRendered.subtract(e).filter((function(e){return e.size()>0})).forEach((function(e){t._removeTilesInRange(e)})),e.subtract(this.viewRangeRendered).filter((function(e){return e.size()>0})).forEach((function(e){t._renderTilesInRange(e)})),this._renderFiller())}},{key:"_renderTilesInRange",value:function(e){var t=0;if(0!==this.filteredTiles.length){e=this.virtualScrolling.maxViewRange().intersect(e);var n=this.viewRangeRendered.union(e);if(2===n.length)throw new Error("Can only prepend or append rows to the existing range. Existing: "+this.viewRangeRendered+". New: "+n);this.viewRangeRendered=n[0];for(var r=e.from;r<e.to;r++)this.eachTileInRow(r,o.bind(this)),t++;s.a.log.isTraceEnabled()&&(s.a.log.trace(t+" new rows rendered from "+e),s.a.log.trace(this._rowsRenderedInfo()))}function o(e){e.rendered||this._renderTile(e)}}},{key:"_renderTileDelta",value:function(e){if(!this.virtual)return[];var t=this.renderedTiles(),n=this.virtualScrolling.calculateCurrentViewRange(),r=this.findTilesInRange(n),o=rt.diff(t,r),i=rt.diff(r,t);return e&&e.newlyHiddenTiles.forEach((function(e){e.rendered&&this._removeTileByFilter(e)}),this),o.forEach((function(e){e.remove()})),i.forEach((function(e){this._renderTile(e)}),this),e&&(this.htmlComp.suppressInvalidate=!0,e.newlyShownTiles.forEach((function(e){e.rendered&&this._renderTileVisibleForFilter(e)}),this),this.htmlComp.suppressInvalidate=!1),this.viewRangeRendered=n,this._renderFiller(),this.htmlComp.layouting||this.invalidateLayoutTree(),i}},{key:"_removeTileByFilter",value:function(e){e.$container.removeClass("animate-invisible"),e.animateRemoval=!0,e.animateRemovalClass="animate-invisible",e.remove(),this._onAnimatedTileRemove(e),e.animateRemoval=!1,setTimeout((function(){e.animateRemovalClass="animate-remove"}))}},{key:"_renderTileVisibleForFilter",value:function(e){e.filterAccepted&&!e.$container.hasClass("animate-visible")&&(e.removalPending||(e.$container.setVisible(!1),e._renderVisible()))}},{key:"_renderTileOrder",value:function(e){var t=!1;this.tiles.forEach((function(n,r){if(e[r]!==n||t){if(this.virtual&&!n.rendered)return;t=!0,n.$container.appendTo(this.$container)}}),this),t&&!this.virtual&&this.invalidateLayoutTree()}},{key:"_rowsRenderedInfo",value:function(){return this.$container.children(".tile").length+" tiles rendered in range ("+this.viewRangeRendered+")"}},{key:"_removeTilesInRange",value:function(e){var t=0,n=this.viewRangeRendered.subtract(e);if(2===n.length)throw new Error("Can only remove rows at the beginning or end of the existing range. "+this.viewRangeRendered+". New: "+n);this.viewRangeRendered=n[0];for(var r=e.from;r<e.to;r++)this._removeTilesInRow(r),t++;s.a.log.isTraceEnabled()&&(s.a.log.trace(t+" rows removed from "+e+"."),s.a.log.trace(this._rowsRenderedInfo()))}},{key:"_removeTilesInRow",value:function(e){this.findTilesInRow(e).forEach((function(e){e.remove()}))}},{key:"rowHasRenderedTiles",value:function(e){return this.findTilesInRow(e).some((function(e){return e.rendered&&!e.removing}))}},{key:"ensureTileRendered",value:function(e){if(!e.rendered){var t=e.gridData.y;this.virtualScrolling._renderViewRangeForRowIndex(t),this.invalidateLayoutTree()}}},{key:"_renderFiller",value:function(){this.$fillBefore||(this.$fillBefore=this.$container.prependDiv("filler"));var e=this._calculateFillerHeight(new Fr(0,this.viewRangeRendered.from));this.$fillBefore.cssHeight(e),this.$fillBefore.css("width","100%"),s.a.log.isTraceEnabled()&&s.a.log.trace("FillBefore height: "+e),this.$fillAfter||(this.$fillAfter=this.$container.appendDiv("filler")),this.$fillAfter.appendTo(this.$container);var t=this._calculateFillerHeight(new Fr(this.viewRangeRendered.from,this.viewRangeRendered.to));this.$fillAfter.cssTop(e+t);var n=this._calculateFillerHeight(new Fr(this.viewRangeRendered.to,this.rowCount()));this.$fillAfter.cssHeight(n),this.$fillAfter.css("width","100%"),s.a.log.isTraceEnabled()&&s.a.log.trace("FillAfter height: "+n)}},{key:"_calculateFillerHeight",value:function(e){for(var t=0,n=e.from;n<e.to;n++)t+=this._heightForRow(n);return t}},{key:"renderedTiles",value:function(){if(!this.rendered)return[];if(!this.virtual)return this.filteredTiles;var e=[];return this.$container.children(".tile").each((function(t,n){var r=O.widget(n);r.removalPending||e.push(r)})),e}}])&&fre(t.prototype,n),r&&fre(t,r),i}(ve);function _re(e){return(_re="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function wre(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function kre(e,t,n){return(kre="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Cre(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function Sre(e,t){return(Sre=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Ore(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Cre(e);if(t){var o=Cre(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Tre(this,n)}}function Tre(e,t){return!t||"object"!==_re(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Cre(e){return(Cre=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Pre=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Sre(e,t)}(i,e);var t,n,r,o=Ore(i);function i(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(e=o.call(this))._addRemoteProperties(["selectedTiles"]),e._tileFilter=null,e}return t=i,(n=[{key:"_syncSelectedTiles",value:function(e){this.addFilterForPropertyName("selectedTiles"),this.widget.selectTiles(e)}},{key:"_syncTiles",value:function(e){this.addFilterForPropertyName("selectedTiles"),this.widget.setTiles(e)}},{key:"_initProperties",value:function(e){kre(Cre(i.prototype),"_initProperties",this).call(this,e),Pr.isNullOrUndefined(e.filteredTiles)||(this.tileFilter=O.create("RemoteTileFilter",{tileIds:e.filteredTiles}),e.filters=[this.tileFilter]),delete e.filteredTiles}},{key:"_syncFilteredTiles",value:function(e){Pr.isNullOrUndefined(e)?(this.widget.removeFilter(this.tileFilter),this.tileFilter=null):(this.tileFilter||(this.tileFilter=O.create("RemoteTileFilter"),this.widget.addFilter(this.tileFilter)),this.tileFilter.setTileIds(e)),this.widget.filter()}},{key:"_onWidgetTileClick",value:function(e){var t={tile:e.tile.id,mouseButton:e.mouseButton};this._send("tileClick",t)}},{key:"_onWidgetTileAction",value:function(e){var t={tile:e.tile.id};this._send("tileAction",t)}},{key:"_onWidgetEvent",value:function(e){"tileClick"===e.type?this._onWidgetTileClick(e):"tileAction"===e.type?this._onWidgetTileAction(e):kre(Cre(i.prototype),"_onWidgetEvent",this).call(this,e)}}])&&wre(t.prototype,n),r&&wre(t,r),i}(de);function Rre(e){return(Rre="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function xre(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Ere(e,t){return(Ere=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Dre(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Fre(e);if(t){var o=Fre(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Are(this,n)}}function Are(e,t){return!t||"object"!==Rre(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Fre(e){return(Fre=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var $re=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ere(e,t)}(i,e);var t,n,r,o=Dre(i);function i(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),o.call(this)}return t=i,(n=[{key:"getGridWidgets",value:function(){return this.widget.filteredTiles}}])&&xre(t.prototype,n),r&&xre(t,r),i}(aa);function jre(e){return(jre="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Bre(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Mre(e,t,n){return(Mre="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Nre(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function Ire(e,t){return(Ire=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Lre(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Nre(e);if(t){var o=Nre(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Hre(this,n)}}function Hre(e,t){return!t||"object"!==jre(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Nre(e){return(Nre=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Vre=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ire(e,t)}(i,e);var t,n,r,o=Lre(i);function i(e,t){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(n=o.call(this,e,t)).containerPos=null,n.containerScrollTop=null,n.tiles=[],n._calculatingPrimitivePrefSize=!1,n}return t=i,r=[{key:"getTileDimensions",value:function(){if(!(i._DEFAULTSIZE instanceof Hs)){var e=To.getSize("tile-grid-layout-config","height","height",-1),t=To.getSize("tile-grid-layout-config","width","width",-1),n=To.getSize("tile-grid-layout-config","margin-left","marginLeft",-1),r=To.getSize("tile-grid-layout-config","margin-top","marginTop",-1);i._DEFAULTSIZE=new Hs(n,r,t,e)}return i._DEFAULTSIZE}}],(n=[{key:"_initDefaults",value:function(){Mre(Nre(i.prototype),"_initDefaults",this).call(this);var e=i.getTileDimensions();this.hgap=e.x,this.vgap=e.y,this.columnWidth=e.width,this.rowHeight=e.height,this.maxWidth=-1}},{key:"layout",value:function(e){var t=this.widget.htmlComp;if(this.widget.scrolling)return this.widget.scrollTopDirty||this.widget._renderViewPort(),this._layout(e),void this.widget.trigger("layoutAnimationDone");var n=t.layouted||this.widget.startupAnimationEnabled&&!this.widget.startupAnimationDone||this.widget.renderAnimationEnabled;this.tiles=this.widget.renderedTiles(),Lh.setVisible(e,!1),n&&this._storeBounds(this.tiles),this._updateMaxWidth(),this._resetGridColumnCount(),this.widget.invalidateLayout(),this.widget.invalidateLogicalGrid(!1);var r=!1,o=e.outerWidth();for(o=Math.max(o,this.minWidth),t.prefSize().width<=o&&(this._layout(e),r=!0);!r&&this.widget.gridColumnCount>1;)this.widget.gridColumnCount--,this.widget.invalidateLayout(),this.widget.invalidateLogicalGrid(!1),t.prefSize().width<=o&&(this._layout(e),r=!0);if(r||this._layout(e),t.layouted||this.widget._renderScrollTop(),this.widget.virtual&&(!t.layouted||this._sizeChanged(t)||this.widget.withPlaceholders)){this.widget.setViewRangeSize(this.widget.calculateViewRangeSize(),!1);var i=this.widget._renderTileDelta();this._storeBounds(i),rt.pushAll(this.tiles,i),this._layout(e)}var a=[];n&&(a=this._animateTiles()),this.widget.startupAnimationDone=!0,a.length>0?s.a.promiseAll(a).done(this._onAnimationDone.bind(this)):this._onAnimationDone()}},{key:"_sizeChanged",value:function(e){return e.sizeCached&&!e.sizeCached.equals(e.size())}},{key:"_storeBounds",value:function(e){e.forEach((function(e,t){var n=qs.cssBounds(e.$container);e.$container.data("oldBounds",n),e.$container.data("was-layouted",e.htmlComp.layouted)}),this)}},{key:"_validateGridData",value:function(e){return e.$comp.removeClass("newly-rendered"),Mre(Nre(i.prototype),"_validateGridData",this).call(this,e)}},{key:"_layoutCellBounds",value:function(e,t){return this.widget.virtual&&(t.top+=this.widget.$fillBefore.outerHeight(!0)),Mre(Nre(i.prototype),"_layoutCellBounds",this).call(this,e,t)}},{key:"_animateTiles",value:function(){var e=this.widget.htmlComp,t=e.$comp;this.containerPos=e.offset(),this.containerScrollTop=t.scrollTop(),Lh.setVisible(t,!0),Lh.opacity(t,0);var n=[];return this.tiles.forEach((function(e,t){if(e.rendered){var r=this._animateTile(e);r&&n.push(r),e.$container.removeData("oldBounds"),e.$container.removeData("was-layouted")}}),this),n}},{key:"_animateTile",value:function(e){var t=this.widget.htmlComp;if(e.$container.stop(),!e.$container.hasClass("invisible")&&!e.$container.hasClass("animate-visible")){var n=qs.cssBounds(e.$container),r=e.$container.data("oldBounds");if(e instanceof jse&&!e.$container.data("was-layouted")&&(r=n.clone()),t.layouted||!this.widget.startupAnimationDone&&this.widget.startupAnimationEnabled||!this.widget.renderAnimationEnabled||(r=new Hs(.95*n.x,.95*n.y,n.width,n.height)),!r.equals(n)&&(this._inViewport(n)||this._inViewport(r))&&(e.$container.data("was-layouted")||this._inViewport(n)))return this._animateTileBounds(e,r,n)}}},{key:"_inViewport",value:function(e){e=e.translate(this.containerPos.x,this.containerPos.y).translate(0,-this.containerScrollTop);var t=new Is(e.x,e.y),n=new Is(e.x+e.width,e.y+e.height),r=this.widget.$container.scrollParent();return Lh.isLocationInView(t,r)||Lh.isLocationInView(n,r)}},{key:"_onAnimationDone",value:function(){this._updateScrollbar(),this.widget.trigger("layoutAnimationDone")}},{key:"_animateTileBounds",value:function(e,t,n){var r=e.$container[0],o=[r.style.overflow,r.style.overflowX,r.style.overflowY],i=[];return e.$container.cssLeftAnimated(t.x,n.x,{start:function(e){i.push(e)},queue:!1}).cssTopAnimated(t.y,n.y,{start:function(e){i.push(e)},queue:!1}).cssWidthAnimated(t.width,n.width,{start:function(e){i.push(e)},queue:!1}).cssHeightAnimated(t.height,n.height,{start:function(e){i.push(e)},queue:!1}),s.a.promiseAll(i).then((function(){r.style.overflow=o[0],r.style.overflowX=o[1],r.style.overflowY=o[2]}))}},{key:"_updateScrollbar",value:function(){Lh.setVisible(this.widget.$container,!0),Lh.opacity(this.widget.$container,1);for(var e=this.widget.htmlComp;e;){if(e.scrollable){Lh.update(e.$comp,!0);break}e=e.getParent()}}},{key:"_updateMaxWidth",value:function(){var e=this.widget.htmlComp;if(e.$comp.cssPaddingRight(null),!(this.maxWidth<=0)){var t=e.$comp.cssPaddingRight(),n=e.size(),r=n.width-Math.min(n.width,this.maxWidth)-e.$comp.cssPaddingLeft()-e.$comp.cssBorderWidthX();r>t&&e.$comp.cssPaddingRight(r)}}},{key:"_resetGridColumnCount",value:function(){this.widget.gridColumnCount=this.widget.prefGridColumnCount}},{key:"preferredLayoutSize",value:function(e,t){return t=s.a.extend({},t),this.widget.virtual?this.virtualPrefSize(e,t):this.primitivePrefSize(e,t)}},{key:"virtualPrefSize",value:function(e,t){var n,r,o=ea.get(e).insets(),i=new $s,s=this.columnWidth,a=this.rowHeight,l=this.hgap,u=this.vgap;if(t.widthHint){var c=(r=Math.floor(t.widthHint/(s+l)))*(s+l);return t.widthHint-c>s&&r++,r=Math.max(Math.min(this.widget.prefGridColumnCount,r),1),n=this.widget.rowCount(r),i.width=t.widthHint,i.height=Math.max(n*a+(n-1)*u,0),i.width+=o.horizontal(),i.height+=o.vertical(),i}return r=this.widget.gridColumnCount,n=this.widget.rowCount(),i.width=Math.max(r*s+(r-1)*l,0),i.height=Math.max(n*a+(n-1)*u,0),i.width+=o.horizontal(),i.height+=o.vertical(),i}},{key:"primitivePrefSize",value:function(e,t){if(!t.widthHint||this._calculatingPrimitivePrefSize)return Mre(Nre(i.prototype),"preferredLayoutSize",this).call(this,e,t);this._calculatingPrimitivePrefSize=!0;var n=this._primitivePrefSize(t);return this._calculatingPrimitivePrefSize=!1,n}},{key:"_primitivePrefSize",value:function(e){var t,n=this.widget.htmlComp,r=!1,o=this.widget.gridColumnCount,i=e.widthHint;for(e.removeInsetsFromHints=!1,i+=n.insets().horizontal(),this._resetGridColumnCount(),this.widget.invalidateLayout(),this.widget.invalidateLogicalGrid(!1),(t=n.prefSize(e)).width<=i&&(r=!0);!r&&this.widget.gridColumnCount>1;)this.widget.gridColumnCount--,this.widget.invalidateLayout(),this.widget.invalidateLogicalGrid(!1),(t=n.prefSize(e)).width<=i&&(r=!0);return this.widget.gridColumnCount=o,t}}])&&Bre(t.prototype,n),r&&Bre(t,r),i}(ba);function Wre(e){return(Wre="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function zre(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Gre(e,t,n){return(Gre="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Yre(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function Ure(e,t){return(Ure=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Kre(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Yre(e);if(t){var o=Yre(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return qre(this,n)}}function qre(e,t){return!t||"object"!==Wre(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Yre(e){return(Yre=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}!function(e,t,n){t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}(Vre,"_DEFAULTSIZE",void 0);var Xre=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ure(e,t)}(i,e);var t,n,r,o=Kre(i);function i(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),o.call(this,e)}return t=i,r=[{key:"ensure",value:function(e){return e?e instanceof i?e:new i(e):e}}],(n=[{key:"_extend",value:function(e){Gre(Yre(i.prototype),"_extend",this).call(this,e),(e=e||{}).maxWidth>-2&&(this.maxWidth=e.maxWidth)}},{key:"applyToLayout",value:function(e){Gre(Yre(i.prototype),"applyToLayout",this).call(this,e),this.maxWidth&&(e.maxWidth=this.maxWidth)}},{key:"clone",value:function(){return new i(this)}}])&&zre(t.prototype,n),r&&zre(t,r),i}(ga);function Jre(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Zre=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.tileGrid=t}var t,n,r;return t=e,(n=[{key:"selectTileOnMouseDown",value:function(e){if(this.isSelectable()){var t=s()(e.currentTarget).data("widget");if(!(t instanceof jse||t.selected&&3===e.which)){var n=!0;if(e.ctrlKey&&(n=!t.selected),e.ctrlKey&&this.isMultiSelect())n?(this.addTilesToSelection(t),this._checkAndSetFocusedTile(e,t)):(this.deselectTile(t),this._checkAndSetFocusedTile(e,null));else if(e.shiftKey&&this.isMultiSelect()){if(!this.isHorizontalGridActive())return;var r=this.getVisibleTiles(),o=this.getFocusedTile();o||(o=r[0]);var i=this.computeSelectionBetween(r.indexOf(o),r.indexOf(t),!0);i&&(this.selectTiles(i.selectedTiles),this._checkAndSetFocusedTile(e,i.focusedTile))}else n?(this.selectTile(t),this._checkAndSetFocusedTile(e,t)):(this.deselectAllTiles(),this._checkAndSetFocusedTile(e,null))}}}},{key:"getFilteredTiles",value:function(){return this.tileGrid.filteredTiles}},{key:"getFilteredTileCount",value:function(){return this.tileGrid.filteredTiles.length}},{key:"getVisibleTiles",value:function(){return this.tileGrid.filteredTiles}},{key:"getVisibleTileCount",value:function(){return this.tileGrid.filteredTiles.length}},{key:"getGridColumnCount",value:function(){return this.tileGrid.gridColumnCount}},{key:"getVisibleGridRowCount",value:function(){return this.tileGrid.logicalGrid.gridRows}},{key:"getVisibleGridX",value:function(e){return e.gridData.x}},{key:"getVisibleGridY",value:function(e){return e.gridData.y}},{key:"getSelectedTiles",value:function(e){return this.tileGrid.selectedTiles}},{key:"isSelectable",value:function(){return this.tileGrid.selectable}},{key:"isMultiSelect",value:function(){return this.tileGrid.multiSelect}},{key:"addTilesToSelection",value:function(e){this.tileGrid.addTilesToSelection(e)}},{key:"selectTile",value:function(e){this.tileGrid.selectTile(e)}},{key:"selectTiles",value:function(e){this.tileGrid.selectTiles(e)}},{key:"deselectTile",value:function(e){this.tileGrid.deselectTile(e)}},{key:"deselectTiles",value:function(e){this.tileGrid.deselectTiles(e)}},{key:"deselectAllTiles",value:function(){this.tileGrid.deselectAllTiles()}},{key:"toggleSelection",value:function(){this.tileGrid.toggleSelection()}},{key:"getFocusedTile",value:function(){return this.tileGrid.focusedTile}},{key:"_checkAndSetFocusedTile",value:function(e,t){e.isDefaultPrevented()||t&&t.rendered&&t.$container.hasClass("unfocusable")||this.setFocusedTile(t)}},{key:"setFocusedTile",value:function(e){this.tileGrid.setFocusedTile(e)}},{key:"scrollTo",value:function(e){this.tileGrid.scrollTo(e)}},{key:"scrollToTop",value:function(){this.tileGrid.scrollToTop()}},{key:"scrollToBottom",value:function(){this.tileGrid.scrollToBottom()}},{key:"findVisibleTileIndexAt",value:function(e,t,n,r){return this.tileGrid.findTileIndexAt(e,t,n,r)}},{key:"getTileGridByRow",value:function(e){return e<0||e>=this.getVisibleGridRowCount()?null:this.tileGrid}},{key:"isHorizontalGridActive",value:function(){return this.tileGrid.logicalGrid instanceof ja}},{key:"computeSelectionX",value:function(e,t){var n,r,o=this.getVisibleTiles(),i=this._computeFocusedTile(e,t);return null!==i.selectedTiles?i:(n=i.focusedTile,r=o.indexOf(n),this.computeSelectionBetween(r,r+e,t))}},{key:"computeSelectionY",value:function(e,t){var n,r,o,i,s=this.getVisibleTiles(),a=this.getVisibleGridRowCount(),l=this._computeFocusedTile(e,t);if(null!==l.selectedTiles)return l;if(n=l.focusedTile,i=s.indexOf(n),r=this.getVisibleGridY(n),o=this.getVisibleGridX(n),!(e>0&&r===a-1||e<0&&0===r)){var u=this.findVisibleTileIndexAt(o,r+e,i,e<0);if(u<0){var c=this.getTileGridByRow(r+e);if(!c)return;u=s.indexOf(rt.last(c.filteredTiles))}return this.computeSelectionBetween(i,u,t)}}},{key:"computeSelectionToFirst",value:function(e){var t,n=this.getVisibleTiles(),r=this.getFocusedTile(),o=this.getSelectedTiles();return 0===o.length?{selectedTiles:[r=rt.first(n)],focusedTile:r}:(r||(r=rt.last(o)),t=n.indexOf(r),this.computeSelectionBetween(t,0,e))}},{key:"computeSelectionToLast",value:function(e){var t,n=this.getVisibleTiles(),r=this.getFocusedTile(),o=this.getSelectedTiles();return 0===o.length?{selectedTiles:[r=rt.last(n)],focusedTile:r}:(r||(r=rt.last(o)),t=n.indexOf(r),this.computeSelectionBetween(t,n.length-1,e))}},{key:"_computeFocusedTile",value:function(e,t){var n=this.getVisibleTiles(),r=this.getSelectedTiles(),o=this.getFocusedTile();return 0===r.length?{focusedTile:o=e>0?rt.first(n):rt.last(n),selectedTiles:[o]}:(o||(o=e>0?rt.last(r):rt.first(r)),{focusedTile:o,selectedTiles:null})}},{key:"computeSelectionBetween",value:function(e,t,n){var r=this.getVisibleTiles(),o=this.getSelectedTiles(),i=r[t];if(!(e<0||e>r.length-1||t<0||t>r.length-1||e===t)){if(!n)return{selectedTiles:[i],focusedTile:i};var s=[];return i.selected?t>e?(s=o.slice(),rt.removeAll(s,r.slice(e,t))):(s=o.slice(),rt.removeAll(s,r.slice(t+1,e+1))):t>e?(s=rt.union(o,r.slice(e,t+1)),i=this._findLastSelectedTileAfter(r,t)):(s=rt.union(r.slice(t,e+1),o),i=this._findLastSelectedTileBefore(r,t)),{selectedTiles:s,focusedTile:i}}}},{key:"executeSelection",value:function(e){if(e){if(e.selectedTiles.length>0){this.selectTiles(e.selectedTiles),this.scrollTo(e.focusedTile);var t=this.getVisibleGridY(e.focusedTile),n=this.getVisibleGridRowCount();0===t?this.scrollToTop():t===n-1&&this.scrollToBottom()}this.setFocusedTile(e.focusedTile)}}},{key:"_findLastSelectedTileBefore",value:function(e,t){if(0===t)return e[t];var n=rt.findFromReverse(e,t,(function(t,n){var r=e[n-1];return!!r&&!r.selected}));return n||(n=e[0]),n}},{key:"_findLastSelectedTileAfter",value:function(e,t){if(t===e.length-1)return e[t];var n=rt.findFrom(e,t,(function(t,n){var r=e[n+1];return!!r&&!r.selected}));return n||(n=e[e.length-1]),n}}])&&Jre(t.prototype,n),r&&Jre(t,r),e}();function Qre(e){return(Qre="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function eoe(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function toe(e,t,n){return(toe="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=ioe(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function noe(e,t){return(noe=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function roe(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=ioe(e);if(t){var o=ioe(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return ooe(this,n)}}function ooe(e,t){return!t||"object"!==Qre(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function ioe(e){return(ioe=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var soe=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&noe(e,t)}(i,e);var t,n,r,o=roe(i);function i(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(e=o.call(this)).content=null,e}return t=i,(n=[{key:"_render",value:function(){this.$container=this.$parent.appendDiv("html-tile"),this.htmlComp=ea.install(this.$container,this.session)}},{key:"_renderProperties",value:function(){toe(ioe(i.prototype),"_renderProperties",this).call(this),this._renderContent()}},{key:"setContent",value:function(e){this.setProperty("content",e)}},{key:"_renderContent",value:function(){this.content?(this.$container.html(this.content),this.$container.find("img").on("load",this._onImageLoad.bind(this)).on("error",this._onImageError.bind(this)),this.invalidateLayoutTree()):this.$container.empty()}},{key:"_onImageLoad",value:function(e){this.invalidateLayoutTree()}},{key:"_onImageError",value:function(e){this.invalidateLayoutTree()}}])&&eoe(t.prototype,n),r&&eoe(t,r),i}(rre);function aoe(e){return(aoe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function loe(e,t){return(loe=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function uoe(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=foe(e);if(t){var o=foe(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return coe(this,n)}}function coe(e,t){return!t||"object"!==aoe(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function foe(e){return(foe=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var hoe=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&loe(e,t)}(n,e);var t=uoe(n);function n(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),t.call(this)}return n}(ure);function poe(e){return(poe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function doe(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function yoe(e,t,n){return(yoe="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=goe(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function voe(e,t){return(voe=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function boe(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=goe(e);if(t){var o=goe(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return moe(this,n)}}function moe(e,t){return!t||"object"!==poe(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function goe(e){return(goe=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var _oe=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&voe(e,t)}(i,e);var t,n,r,o=boe(i);function i(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(e=o.call(this)).bean=null,e}return t=i,(n=[{key:"_render",value:function(){this.$container=this.$parent.appendDiv("bean-tile"),this.htmlComp=ea.install(this.$container,this.session)}},{key:"_renderProperties",value:function(){yoe(goe(i.prototype),"_renderProperties",this).call(this),this._renderBean()}},{key:"_renderBean",value:function(){}},{key:"triggerAppLinkAction",value:function(e){this.trigger("appLinkAction",{ref:e})}},{key:"_onAppLinkAction",value:function(e){var t=s()(e.delegateTarget).data("ref");this.triggerAppLinkAction(t)}}])&&doe(t.prototype,n),r&&doe(t,r),i}(rre);function woe(e){return(woe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function koe(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Soe(e,t,n){return(Soe="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Poe(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function Ooe(e,t){return(Ooe=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Toe(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Poe(e);if(t){var o=Poe(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Coe(this,n)}}function Coe(e,t){return!t||"object"!==woe(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Poe(e){return(Poe=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Roe=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ooe(e,t)}(i,e);var t,n,r,o=Toe(i);function i(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),o.call(this)}return t=i,(n=[{key:"_onWidgetAppLinkAction",value:function(e){this._send("appLinkAction",{ref:e.ref})}},{key:"_onWidgetEvent",value:function(e){"appLinkAction"===e.type?this._onWidgetAppLinkAction(e):Soe(Poe(i.prototype),"_onWidgetEvent",this).call(this,e)}}])&&koe(t.prototype,n),r&&koe(t,r),i}(ure);function xoe(e){return(xoe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Eoe(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Doe(e,t,n){return(Doe="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Boe(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function Aoe(e,t){return(Aoe=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Foe(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Boe(e);if(t){var o=Boe(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return $oe(this,n)}}function $oe(e,t){return!t||"object"!==xoe(t)&&"function"!=typeof t?joe(e):t}function joe(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Boe(e){return(Boe=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Moe=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Aoe(e,t)}(i,e);var t,n,r,o=Foe(i);function i(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(e=o.call(this)).exclusiveExpand=!1,e.gridColumnCount=null,e.multiSelect=null,e.selectable=null,e.takeTileFiltersFromGroup=!0,e.tileComparator=null,e.tileFilters=[],e.tileGridLayoutConfig=null,e.tileGridSelectionHandler=new Zoe(joe(e)),e.withPlaceholders=null,e.virtual=null,e._selectionUpdateLocked=!1,e._tileGridPropertyChangeHandler=e._onTileGridPropertyChange.bind(joe(e)),e._groupBodyHeightChangeHandler=e._onGroupBodyHeightChange.bind(joe(e)),e}return t=i,(n=[{key:"_render",value:function(){Doe(Boe(i.prototype),"_render",this).call(this),this.$container.addClass("tile-accordion")}},{key:"_initGroup",value:function(e){Doe(Boe(i.prototype),"_initGroup",this).call(this,e),e.body.setSelectionHandler(this.tileGridSelectionHandler),null!==this.gridColumnCount&&e.body.setGridColumnCount(this.gridColumnCount),this.setProperty("gridColumnCount",e.body.gridColumnCount),null!==this.multiSelect&&e.body.setMultiSelect(this.multiSelect),this.setProperty("multiSelect",e.body.multiSelect),null!==this.selectable&&e.body.setSelectable(this.selectable),this.setProperty("selectable",e.body.selectable),null!==this.tileGridLayoutConfig&&e.body.setLayoutConfig(this.tileGridLayoutConfig),this.setProperty("tileGridLayoutConfig",e.body.layoutConfig),null!==this.tileComparator&&(e.body.setComparator(this.tileComparator),e.body.sort()),this.setProperty("tileComparator",e.body.comparator),this.tileFilters.length>0&&(e.body.addFilters(this.tileFilters),e.body.filter()),this.takeTileFiltersFromGroup&&this.setProperty("tileFilters",e.body.filters),null!==this.withPlaceholders&&e.body.setWithPlaceholders(this.withPlaceholders),this.setProperty("withPlaceholders",e.body.withPlaceholders),null!==this.virtual&&e.body.setVirtual(this.virtual),this.setProperty("virtual",e.body.virtual),e.body.selectedTiles.length>0&&this._handleSelectionChanged(e.body),e.body.on("propertyChange",this._tileGridPropertyChangeHandler),this._handleCollapsed(e),e.body.__tileAccordionEventDelegator=vt.create(e.body,this,{delegateEvents:["tileClick","tileAction"]})}},{key:"_deleteGroup",value:function(e){e.body&&(e.body.off("propertyChange",this._tileGridPropertyChangeHandler),e.body.__tileAccordionEventDelegator.destroy(),e.body.__tileAccordionEventDelegator=null),Doe(Boe(i.prototype),"_deleteGroup",this).call(this,e)}},{key:"setGroups",value:function(e){var t=this.getTileCount(),n=this.getFilteredTileCount(),r=this.getSelectedTileCount();Doe(Boe(i.prototype),"setGroups",this).call(this,e);var o=this.getTileCount(),s=this.getFilteredTileCount(),a=this.getSelectedTileCount();o!==t&&this.triggerPropertyChange("tiles",null,null),s!==n&&this.triggerPropertyChange("filteredTiles",null,null),a!==r&&this.triggerPropertyChange("selectedTiles",null,null)}},{key:"setGridColumnCount",value:function(e){this.groups.forEach((function(t){t.body.setGridColumnCount(e)})),this.setProperty("gridColumnCount",e)}},{key:"setTileGridLayoutConfig",value:function(e){this.groups.forEach((function(t){t.body.setLayoutConfig(e),e=t.body.layoutConfig})),this.setProperty("tileGridLayoutConfig",e)}},{key:"setWithPlaceholders",value:function(e){this.groups.forEach((function(t){t.body.setWithPlaceholders(e)})),this.setProperty("withPlaceholders",e)}},{key:"setVirtual",value:function(e){this.groups.forEach((function(t){t.body.setVirtual(e)})),this.setProperty("virtual",e)}},{key:"setSelectable",value:function(e){this.groups.forEach((function(t){t.body.setSelectable(e)})),this.setProperty("selectable",e)}},{key:"setMultiSelect",value:function(e){this.groups.forEach((function(t){t.body.setMultiSelect(e)})),this.setProperty("multiSelect",e)}},{key:"getGroupById",value:function(e){return rt.find(this.groups,(function(t){return t.id===e}))}},{key:"getGroupByTile",value:function(e){return e.findParent((function(e){return e instanceof Db}))}},{key:"_groupTiles",value:function(e){var t={};return this.groups.forEach((function(e){t[e.id]=[]})),e.forEach((function(e){var n=this.getGroupByTile(e);if(!n)throw new Error("No group found for tile "+e.id);t[n.id]||(t[n.id]=[]),t[n.id].push(e)}),this),t}},{key:"deleteTile",value:function(e){this.deleteTiles([e])}},{key:"deleteTiles",value:function(e,t){if(0!==(e=rt.ensure(e)).length){var n=this.getTiles();rt.removeAll(n,e),this.setTiles(n,t)}}},{key:"deleteAllTiles",value:function(){this.setTiles([])}},{key:"setTiles",value:function(e){if(e=rt.ensure(e),!Pr.equals(this.getTiles(),e)){e=this._createChildren(e);var t=this._groupTiles(e);for(var n in t)this.getGroupById(n).body.setTiles(t[n])}}},{key:"getTiles",value:function(){var e=[];return this.groups.forEach((function(t){rt.pushAll(e,t.body.tiles)})),e}},{key:"getTileCount",value:function(){var e=0;return this.groups.forEach((function(t){e+=t.body.tiles.length})),e}},{key:"addTileFilter",value:function(e){var t=this.tileFilters.slice();t.indexOf(e)>=0||(t.push(e),this.setTileFilters(t))}},{key:"removeTileFilter",value:function(e){var t=this.tileFilters.slice();rt.remove(t,e)&&this.setTileFilters(t)}},{key:"setTileFilters",value:function(e){e=rt.ensure(e),this.groups.forEach((function(t){t.body.setFilters(e)})),this.setProperty("tileFilters",e.slice())}},{key:"filterTiles",value:function(){this.groups.forEach((function(e){e.body.filter()}))}},{key:"getFilteredTiles",value:function(){var e=[];return this.groups.forEach((function(t){rt.pushAll(e,t.body.filteredTiles)})),e}},{key:"getFilteredTileCount",value:function(){var e=0;return this.groups.forEach((function(t){e+=t.body.filteredTiles.length})),e}},{key:"getVisibleTiles",value:function(){var e=[];return this.expandedGroups().forEach((function(t){rt.pushAll(e,t.body.filteredTiles)})),e}},{key:"getVisibleTileCount",value:function(){var e=0;return this.expandedGroups().forEach((function(t){e+=t.body.filteredTiles.length})),e}},{key:"findVisibleTileIndexAt",value:function(e,t,n,r){var o=this;return n=O.nvl(n,0),rt.findIndexFrom(this.getVisibleTiles(),n,(function(n,r){return o.getVisibleGridX(n)===e&&o.getVisibleGridY(n)===t}),r)}},{key:"selectTiles",value:function(e){e=rt.ensure(e),e=this._createChildren(e);var t=this._groupTiles(e);for(var n in t)this.getGroupById(n).body.selectTiles(t[n])}},{key:"selectTile",value:function(e){this.selectTiles([e])}},{key:"selectAllTiles",value:function(){this.selectTiles(this.getVisibleTiles())}},{key:"deselectTiles",value:function(e){e=rt.ensure(e);var t=this.getSelectedTiles().slice();rt.removeAll(t,e)&&this.selectTiles(t)}},{key:"deselectTile",value:function(e){this.deselectTiles([e])}},{key:"deselectAllTiles",value:function(){this.selectTiles([])}},{key:"addTilesToSelection",value:function(e){e=rt.ensure(e),this.selectTiles(this.getSelectedTiles().concat(e))}},{key:"addTileToSelection",value:function(e){this.addTilesToSelection([e])}},{key:"getSelectedTiles",value:function(){var e=[];return this.groups.forEach((function(t){rt.pushAll(e,t.body.selectedTiles)})),e}},{key:"getSelectedTile",value:function(){return this.getSelectedTiles()[0]}},{key:"getSelectedTileCount",value:function(){var e=0;return this.groups.forEach((function(t){e+=t.body.selectedTiles.length})),e}},{key:"toggleSelection",value:function(){this.getSelectedTileCount()===this.getVisibleTileCount()?this.deselectAllTiles():this.selectAllTiles()}},{key:"setTileComparator",value:function(e){this.groups.forEach((function(t){t.body.setComparator(e)})),this.setProperty("tileComparator",e)}},{key:"sortTiles",value:function(){this.groups.forEach((function(e){e.body.sort()}))}},{key:"setFocusedTile",value:function(e){var t=null;null!==e&&(t=this.getGroupByTile(e)),this.groups.forEach((function(n){n===t?n.body.setFocusedTile(e):n.body.setFocusedTile(null)}))}},{key:"getFocusedTile",value:function(){var e=null;return this.groups.some((function(t){return!!t.body.focusedTile&&(e=t.body.focusedTile,!0)})),e}},{key:"getVisibleGridRowCount",value:function(){return this.expandedGroups().reduce((function(e,t){return e+t.body.logicalGrid.gridRows}),0)}},{key:"getVisibleGridX",value:function(e){return e.gridData.x}},{key:"getVisibleGridY",value:function(e){var t=this.getGroupByTile(e),n=this.getVisibleRowByGroup(t);return e.gridData.y+n}},{key:"getGroupByVisibleRow",value:function(e){if(e<0||e>=this.getVisibleGridRowCount())return null;var t=0;return rt.find(this.expandedGroups(),(function(n){var r=n.body.logicalGrid.gridRows;if(t<=e&&e<t+r)return!0;t+=r}))}},{key:"getVisibleRowByGroup",value:function(e){var t=0;return this.expandedGroups().some((function(n){var r=n.body.logicalGrid.gridRows;return n===e||(t+=r,!1)}))?t:-1}},{key:"expandedGroups",value:function(){return this.groups.filter((function(e){return!e.collapsed}))}},{key:"_handleSelectionChanged",value:function(e){if(!this._selectionUpdateLocked){var t=e.parent;e.selectedTiles.length>0&&t.collapsed?e.deselectAllTiles():!this.multiSelect&&e.selectedTiles.length>0&&(this._selectionUpdateLocked=!0,this.groups.forEach((function(t){t.body!==e&&t.body.deselectAllTiles()})),this._selectionUpdateLocked=!1)}}},{key:"_onTileGridPropertyChange",value:function(e){"selectedTiles"===e.propertyName?(this._handleSelectionChanged(e.source),this.triggerPropertyChange("selectedTiles",null,null)):"filteredTiles"===e.propertyName?this.triggerPropertyChange("filteredTiles",null,null):"tiles"===e.propertyName&&this.triggerPropertyChange("tiles",null,null)}},{key:"_onGroupCollapsedChange",value:function(e){Doe(Boe(i.prototype),"_onGroupCollapsedChange",this).call(this,e),this._handleCollapsed(e.source)}},{key:"_handleCollapsed",value:function(e){e.collapsed&&e.body.deselectAllTiles(),e.rendered&&(e.on("bodyHeightChange",this._groupBodyHeightChangeHandler),e.one("bodyHeightChangeDone",this._onGroupBodyHeightChangeDone.bind(this)))}},{key:"_onGroupBodyHeightChange",value:function(e){this.groups.forEach((function(t){e.source===t||t.bodyAnimating||t.body.virtual&&(t.body.scrolling=!0,t.body.revalidateLayout(),t.body.scrolling=!1)}))}},{key:"_onGroupBodyHeightChangeDone",value:function(e){e.source.off("bodyHeightChange",this._groupBodyHeightChangeHandler)}},{key:"_tileAtScrollTop",value:function(e){return rt.find(this.getTiles().filter((function(e){return e.rendered})),(function(t){return t.$container.position().top>=e}),this)}}])&&Eoe(t.prototype,n),r&&Eoe(t,r),i}(Jc);function Ioe(e){return(Ioe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Loe(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Hoe(e,t,n){return(Hoe="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=zoe(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function Noe(e,t){return(Noe=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Voe(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=zoe(e);if(t){var o=zoe(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Woe(this,n)}}function Woe(e,t){return!t||"object"!==Ioe(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function zoe(e){return(zoe=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Goe=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Noe(e,t)}(i,e);var t,n,r,o=Voe(i);function i(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),o.call(this)}return t=i,(n=[{key:"_initProperties",value:function(e){Hoe(zoe(i.prototype),"_initProperties",this).call(this,e),e.takeTileFiltersFromGroup=!1}}])&&Loe(t.prototype,n),r&&Loe(t,r),i}(rf);function Uoe(e){return(Uoe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Koe(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function qoe(e,t){return(qoe=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Yoe(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Joe(e);if(t){var o=Joe(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Xoe(this,n)}}function Xoe(e,t){return!t||"object"!==Uoe(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Joe(e){return(Joe=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Zoe=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&qoe(e,t)}(i,e);var t,n,r,o=Yoe(i);function i(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(t=o.call(this,e)).tileAccordion=t.tileGrid,t}return t=i,(n=[{key:"getFilteredTiles",value:function(){return this.tileAccordion.getFilteredTiles()}},{key:"getFilteredTileCount",value:function(){return this.tileAccordion.getFilteredTileCount()}},{key:"getVisibleTiles",value:function(){return this.tileAccordion.getVisibleTiles()}},{key:"getVisibleTileCount",value:function(){return this.tileAccordion.getVisibleTileCount()}},{key:"getSelectedTiles",value:function(e){return this.tileAccordion.getSelectedTiles()}},{key:"getFocusedTile",value:function(){return this.tileAccordion.getFocusedTile()}},{key:"getVisibleGridRowCount",value:function(){return this.tileAccordion.getVisibleGridRowCount()}},{key:"getVisibleGridX",value:function(e){return this.tileAccordion.getVisibleGridX(e)}},{key:"getVisibleGridY",value:function(e){return this.tileAccordion.getVisibleGridY(e)}},{key:"scrollTo",value:function(e){this.tileAccordion.getGroupByTile(e).body.scrollTo(e)}},{key:"getTileGridByRow",value:function(e){var t=this.tileAccordion.getGroupByVisibleRow(e);return t?t.body:null}},{key:"findVisibleTileIndexAt",value:function(e,t,n,r){return this.tileAccordion.findVisibleTileIndexAt(e,t,n,r)}},{key:"isHorizontalGridActive",value:function(){return 0!==this.tileAccordion.groups.length&&this.tileAccordion.groups[0].body.logicalGrid instanceof ja}}])&&Koe(t.prototype,n),r&&Koe(t,r),i}(Zre);function Qoe(e){return(Qoe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function eie(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function tie(e,t,n){return(tie="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=sie(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function nie(e,t){return(nie=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function rie(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=sie(e);if(t){var o=sie(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return oie(this,n)}}function oie(e,t){return!t||"object"!==Qoe(t)&&"function"!=typeof t?iie(e):t}function iie(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function sie(e){return(sie=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var aie=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&nie(e,t)}(i,e);var t,n,r,o=rie(i);function i(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(t=o.call(this)).field=e,t.shift=!!e.multiSelect&&void 0,t.renderingHints.$drawingArea=function(e,t){var n=this._computeNewSelection();if(n&&n.focusedTile)return n.focusedTile.$container}.bind(iie(t)),t}return t=i,(n=[{key:"getSelectionHandler",value:function(){return this.field.selectionHandler}},{key:"_accept",value:function(e){return!!tie(sie(i.prototype),"_accept",this).call(this,e)&&!!this.getSelectionHandler().isSelectable()&&0!==this.getSelectionHandler().getFilteredTileCount()}},{key:"handle",value:function(e){this.getSelectionHandler().executeSelection(this._computeNewSelection(e.shiftKey))}},{key:"_computeNewSelection",value:function(e){}}])&&eie(t.prototype,n),r&&eie(t,r),i}(zu);function lie(e){return(lie="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function uie(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function cie(e,t,n){return(cie="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=yie(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function fie(e,t){return(fie=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function hie(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=yie(e);if(t){var o=yie(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return pie(this,n)}}function pie(e,t){return!t||"object"!==lie(t)&&"function"!=typeof t?die(e):t}function die(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function yie(e){return(yie=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var vie=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&fie(e,t)}(i,e);var t,n,r,o=hie(i);function i(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(t=o.call(this,e)).ctrl=!0,t.shift=!1,t.which=[Ou.A],t.renderingHints.$drawingArea=function(e,t){var n=this.getSelectionHandler().getVisibleTiles()[0];if(n)return n.$container}.bind(die(t)),t}return t=i,(n=[{key:"_accept",value:function(e){return!!cie(yie(i.prototype),"_accept",this).call(this,e)&&!!this.getSelectionHandler().isMultiSelect()}},{key:"handle",value:function(e){this.getSelectionHandler().toggleSelection()}}])&&uie(t.prototype,n),r&&uie(t,r),i}(aie);function bie(e){return(bie="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function mie(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function gie(e,t,n){return(gie="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Sie(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function _ie(e,t){return(_ie=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function wie(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Sie(e);if(t){var o=Sie(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return kie(this,n)}}function kie(e,t){return!t||"object"!==bie(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Sie(e){return(Sie=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Oie=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_ie(e,t)}(i,e);var t,n,r,o=wie(i);function i(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(t=o.call(this,e)).stopPropagation=!0,t.repeatable=!0,t.which=[Ou.LEFT],t.renderingHints.text="←",t}return t=i,(n=[{key:"_accept",value:function(e){return!!gie(Sie(i.prototype),"_accept",this).call(this,e)&&!!this.getSelectionHandler().isHorizontalGridActive()}},{key:"_computeNewSelection",value:function(e){return this.getSelectionHandler().computeSelectionX(-1,e)}}])&&mie(t.prototype,n),r&&mie(t,r),i}(aie);function Tie(e){return(Tie="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Cie(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Pie(e,t,n){return(Pie="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Die(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function Rie(e,t){return(Rie=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function xie(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Die(e);if(t){var o=Die(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Eie(this,n)}}function Eie(e,t){return!t||"object"!==Tie(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Die(e){return(Die=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Aie=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Rie(e,t)}(i,e);var t,n,r,o=xie(i);function i(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(t=o.call(this,e)).stopPropagation=!0,t.repeatable=!0,t.which=[Ou.RIGHT],t.renderingHints.text="→",t}return t=i,(n=[{key:"_accept",value:function(e){return!!Pie(Die(i.prototype),"_accept",this).call(this,e)&&!!this.getSelectionHandler().isHorizontalGridActive()}},{key:"_computeNewSelection",value:function(e){return this.getSelectionHandler().computeSelectionX(1,e)}}])&&Cie(t.prototype,n),r&&Cie(t,r),i}(aie);function Fie(e){return(Fie="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function $ie(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function jie(e,t,n){return(jie="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Lie(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function Bie(e,t){return(Bie=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Mie(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Lie(e);if(t){var o=Lie(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Iie(this,n)}}function Iie(e,t){return!t||"object"!==Fie(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Lie(e){return(Lie=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Hie=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Bie(e,t)}(i,e);var t,n,r,o=Mie(i);function i(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(t=o.call(this,e)).stopPropagation=!0,t.repeatable=!0,t.which=[Ou.DOWN],t.renderingHints.text="↓",t}return t=i,(n=[{key:"_accept",value:function(e){return!!jie(Lie(i.prototype),"_accept",this).call(this,e)&&!!this.getSelectionHandler().isHorizontalGridActive()}},{key:"_computeNewSelection",value:function(e){return this.getSelectionHandler().computeSelectionY(1,e)}}])&&$ie(t.prototype,n),r&&$ie(t,r),i}(aie);function Nie(e){return(Nie="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Vie(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Wie(e,t,n){return(Wie="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Kie(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function zie(e,t){return(zie=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Gie(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Kie(e);if(t){var o=Kie(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Uie(this,n)}}function Uie(e,t){return!t||"object"!==Nie(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Kie(e){return(Kie=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var qie=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&zie(e,t)}(i,e);var t,n,r,o=Gie(i);function i(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(t=o.call(this,e)).stopPropagation=!0,t.repeatable=!0,t.which=[Ou.UP],t.renderingHints.text="↑",t}return t=i,(n=[{key:"_accept",value:function(e){return!!Wie(Kie(i.prototype),"_accept",this).call(this,e)&&!!this.getSelectionHandler().isHorizontalGridActive()}},{key:"_computeNewSelection",value:function(e){return this.getSelectionHandler().computeSelectionY(-1,e)}}])&&Vie(t.prototype,n),r&&Vie(t,r),i}(aie);function Yie(e){return(Yie="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Xie(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Jie(e,t,n){return(Jie="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=tse(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function Zie(e,t){return(Zie=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Qie(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=tse(e);if(t){var o=tse(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return ese(this,n)}}function ese(e,t){return!t||"object"!==Yie(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function tse(e){return(tse=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var nse=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Zie(e,t)}(i,e);var t,n,r,o=Qie(i);function i(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(t=o.call(this,e)).stopPropagation=!0,t.which=[Ou.HOME],t}return t=i,(n=[{key:"_accept",value:function(e){return!!Jie(tse(i.prototype),"_accept",this).call(this,e)&&!!this.getSelectionHandler().isHorizontalGridActive()}},{key:"_computeNewSelection",value:function(e){return this.getSelectionHandler().computeSelectionToFirst(e)}}])&&Xie(t.prototype,n),r&&Xie(t,r),i}(aie);function rse(e){return(rse="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ose(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ise(e,t,n){return(ise="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=use(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function sse(e,t){return(sse=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function ase(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=use(e);if(t){var o=use(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return lse(this,n)}}function lse(e,t){return!t||"object"!==rse(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function use(e){return(use=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var cse=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&sse(e,t)}(i,e);var t,n,r,o=ase(i);function i(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(t=o.call(this,e)).stopPropagation=!0,t.which=[Ou.END],t}return t=i,(n=[{key:"_accept",value:function(e){return!!ise(use(i.prototype),"_accept",this).call(this,e)&&!!this.getSelectionHandler().isHorizontalGridActive()}},{key:"_computeNewSelection",value:function(e){return this.getSelectionHandler().computeSelectionToLast(e)}}])&&ose(t.prototype,n),r&&ose(t,r),i}(aie);function fse(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var hse=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),t=t||{},this.tileMap={},t.tileIds&&this.setTileIds(t.tileIds)}var t,n,r;return t=e,(n=[{key:"setTileIds",value:function(e){this.tileMap={},e.forEach((function(e){this.tileMap[e]=e}),this)}},{key:"accept",value:function(e){return!!this.tileMap[e.id]}}])&&fse(t.prototype,n),r&&fse(t,r),e}();function pse(e){return(pse="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function dse(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function yse(e,t,n){return(yse="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=_se(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function vse(e,t){return(vse=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function bse(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=_se(e);if(t){var o=_se(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return mse(this,n)}}function mse(e,t){return!t||"object"!==pse(t)&&"function"!=typeof t?gse(e):t}function gse(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _se(e){return(_se=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var wse=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&vse(e,t)}(i,e);var t,n,r,o=bse(i);function i(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(e=o.call(this)).tileWidget=null,e._addWidgetProperties(["tileWidget"]),e._widgetPropertyChangeHandler=e._onWidgetPropertyChange.bind(gse(e)),e}return t=i,(n=[{key:"_init",value:function(e){yse(_se(i.prototype),"_init",this).call(this,e),this._setTileWidget(this.tileWidget)}},{key:"_destroy",value:function(){this.tileWidget&&this.tileWidget.off("propertyChange",this._widgetPropertyChangeHandler),yse(_se(i.prototype),"_destroy",this).call(this)}},{key:"_renderProperties",value:function(){yse(_se(i.prototype),"_renderProperties",this).call(this),this._renderTileWidget()}},{key:"_renderTileWidget",value:function(){this.tileWidget&&this.tileWidget.render()}},{key:"_removeTileWidget",value:function(){this.tileWidget&&this.tileWidget.remove()}},{key:"_onWidgetPropertyChange",value:function(e){"visible"===e.propertyName?this.setVisible(e.newValue):"enabled"===e.propertyName?this.setEnabled(e.newValue):"disabledStyle"===e.propertyName&&this.setDisabledStyle(e.newValue)}},{key:"_setTileWidget",value:function(e){this.tileWidget&&this.tileWidget.off("propertyChange",this._widgetPropertyChangeHandler),this._setProperty("tileWidget",e),e&&(this.tileWidget.visible||this.setVisible(!1),this.tileWidget.enabled||this.setEnabled(!1),this.tileWidget.disabledStyle!==ve.DisabledStyle.DEFAULT&&this.setDisabledStyle(this.tileWidget.disabledStyle),this.tileWidget.on("propertyChange",this._widgetPropertyChangeHandler)),this.invalidateLayoutTree()}}])&&dse(t.prototype,n),r&&dse(t,r),i}(rre);function kse(e){return(kse="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Sse(e,t){return(Sse=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Ose(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Cse(e);if(t){var o=Cse(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Tse(this,n)}}function Tse(e,t){return!t||"object"!==kse(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Cse(e){return(Cse=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Pse=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Sse(e,t)}(n,e);var t=Ose(n);function n(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),t.call(this)}return n}(ure);function Rse(e){return(Rse="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function xse(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Ese(e,t,n){return(Ese="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=$se(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function Dse(e,t){return(Dse=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Ase(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=$se(e);if(t){var o=$se(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Fse(this,n)}}function Fse(e,t){return!t||"object"!==Rse(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function $se(e){return($se=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var jse=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Dse(e,t)}(i,e);var t,n,r,o=Ase(i);function i(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(e=o.call(this)).cssClass="placeholder-tile",e.displayStyle=rre.DisplayStyle.PLAIN,e}return t=i,(n=[{key:"_setSelectable",value:function(e){Ese($se(i.prototype),"_setSelectable",this).call(this,!1)}}])&&xse(t.prototype,n),r&&xse(t,r),i}(rre);function Bse(e){return(Bse="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Mse(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Ise(e,t,n){return(Ise="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Vse(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function Lse(e,t){return(Lse=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Hse(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Vse(e);if(t){var o=Vse(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Nse(this,n)}}function Nse(e,t){return!t||"object"!==Bse(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Vse(e){return(Vse=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Wse=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Lse(e,t)}(i,e);var t,n,r,o=Hse(i);function i(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(e=o.call(this)).displayStyle=i.DisplayStyle.DASHBOARD,e}return t=i,(n=[{key:"_renderProperties",value:function(){Ise(Vse(i.prototype),"_renderProperties",this).call(this),this._renderFieldLabelVisible(),this._renderCompact()}},{key:"_renderDisplayStyle",value:function(){Ise(Vse(i.prototype),"_renderDisplayStyle",this).call(this),this.$container.toggleClass("dashboard",this.displayStyle===i.DisplayStyle.DASHBOARD)}},{key:"_renderFieldLabelVisible",value:function(){this.displayStyle===i.DisplayStyle.DASHBOARD&&this.tileWidget instanceof TK&&this.tileWidget.$container.toggleClass("no-padding",!this.tileWidget.labelVisible&&!this.tileWidget.errorStatus)}},{key:"_renderCompact",value:function(){this.$container.toggleClass("compact",Kt.get().type===Kt.Type.MOBILE)}},{key:"_onFieldPropertyChange",value:function(e){"labelVisible"!==e.propertyName&&"errorStatus"!==e.propertyName||this.rendered&&this._renderFieldLabelVisible()}}])&&Mse(t.prototype,n),r&&Mse(t,r),i}(wse);function zse(e){return(zse="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Gse(e,t){return(Gse=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Use(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=qse(e);if(t){var o=qse(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Kse(this,n)}}function Kse(e,t){return!t||"object"!==zse(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function qse(e){return(qse=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}!function(e,t,n){t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}(Wse,"DisplayStyle",{DEFAULT:rre.DisplayStyle.DEFAULT,PLAIN:rre.DisplayStyle.PLAIN,DASHBOARD:"dashboard"});var Yse=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Gse(e,t)}(n,e);var t=Use(n);function n(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),t.call(this)}return n}(ure);function Xse(e){return(Xse="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Jse(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Zse(e,t,n){return(Zse="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=nae(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function Qse(e,t){return(Qse=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function eae(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=nae(e);if(t){var o=nae(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return tae(this,n)}}function tae(e,t){return!t||"object"!==Xse(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function nae(e){return(nae=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var rae=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Qse(e,t)}(i,e);var t,n,r,o=eae(i);function i(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(e=o.call(this)).processButton=!1,e}return t=i,(n=[{key:"_render",value:function(){if(this.parent.displayStyle===Wse.DisplayStyle.DASHBOARD){var e=this.$parent.makeDiv();this.$buttonLabel=e.appendSpan("label"),this.addContainer(this.$parent,"tile-button"),this.addField(e),this.htmlComp.setLayout(new Sl),this.$container.on("click",this._onClick.bind(this)).unfocusable()}else Zse(nae(i.prototype),"_render",this).call(this)}},{key:"_remove",value:function(){this.$iconContainer=null,Zse(nae(i.prototype),"_remove",this).call(this)}},{key:"_renderIconId",value:function(){this.parent.displayStyle===Wse.DisplayStyle.DASHBOARD?(this.$field.removeClass("with-icon without-icon"),this.iconId?(this.$iconContainer||(this.$iconContainer=this.$field.prependDiv("icon-container")),this.$iconContainer.icon(this.iconId),this.$field.addClass("with-icon")):(this.$iconContainer&&(this.$iconContainer.remove(),this.$iconContainer=null),this.$field.addClass("without-icon")),this.invalidateLayoutTree()):Zse(nae(i.prototype),"_renderIconId",this).call(this)}},{key:"_renderTooltipText",value:function(){Wn.hasText(this.tooltipText)?xp.install(this.$container,{parent:this,text:this.tooltipText}):xp.uninstall(this.$container)}}])&&Jse(t.prototype,n),r&&Jse(t,r),i}(JK);function oae(e){return(oae="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function iae(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function sae(e,t,n){return(sae="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=fae(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function aae(e,t){return(aae=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function lae(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=fae(e);if(t){var o=fae(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return uae(this,n)}}function uae(e,t){return!t||"object"!==oae(t)&&"function"!=typeof t?cae(e):t}function cae(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function fae(e){return(fae=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var hae=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&aae(e,t)}(i,e);var t,n,r,o=lae(i);function i(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(e=o.call(this))._tableBlurHandler=e._onTableBlur.bind(cae(e)),e._tableFocusHandler=e._onTableFocus.bind(cae(e)),e._menuBarPropertyChangeHandler=e._onMenuBarPropertyChange.bind(cae(e)),e._documentMouseDownHandler=e._onDocumentMouseDown.bind(cae(e)),e}return t=i,(n=[{key:"_render",value:function(){sae(fae(i.prototype),"_render",this).call(this),this.session.focusManager.restrictedFocusGain||this.$container.document(!0).addEventListener("mousedown",this._documentMouseDownHandler,!0)}},{key:"_remove",value:function(){this.$container.document(!0).removeEventListener("mousedown",this._documentMouseDownHandler,!0),sae(fae(i.prototype),"_remove",this).call(this)}},{key:"_renderTable",value:function(){sae(fae(i.prototype),"_renderTable",this).call(this),this.parent.displayStyle===Wse.DisplayStyle.DASHBOARD&&this.table&&(this.table.setHeaderMenusEnabled(!1),this.table.setSortEnabled(!1),this.table.$container.on("blur",this._tableBlurHandler).on("focus",this._tableFocusHandler),this.table.menuBar.on("propertyChange",this._menuBarPropertyChangeHandler),this._toggleHasMenuBar(),document.activeElement!==this.table.$container[0]&&this._hideMenuBar(!0))}},{key:"_removeTable",value:function(){this.parent.displayStyle===Wse.DisplayStyle.DASHBOARD&&(this.table&&(this.table.$container.off("blur",this._tableBlurHandler).off("focus",this._tableFocusHandler),this.table.menuBar.off("propertyChange",this._menuBarPropertyChangeHandler)),sae(fae(i.prototype),"_removeTable",this).call(this))}},{key:"_onTableBlur",value:function(e){var t=s()(".popup").data("widget");this.has(t)||this._hideMenuBar(!0)}},{key:"_onTableFocus",value:function(e){this._hideMenuBar(!1)}},{key:"_hideMenuBar",value:function(e){this.table.menuBar.hiddenByUi=e,this.table.menuBar.updateVisibility()}},{key:"_onMenuBarPropertyChange",value:function(e){"visible"===e.propertyName&&this._toggleHasMenuBar()}},{key:"_toggleHasMenuBar",value:function(){(this.rendered||this.rendering)&&this.$container.toggleClass("has-menubar",this.table.menuBar.visible)}},{key:"_onDocumentMouseDown",value:function(e){var t=s()(".popup"),n=t.data("widget");this.table&&n&&this.table.has(n)&&t.has(e.target)&&e.preventDefault()}}])&&iae(t.prototype,n),r&&iae(t,r),i}(t7);function pae(e){return(pae="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function dae(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function yae(e,t,n){return(yae="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=_ae(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function vae(e,t){return(vae=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function bae(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=_ae(e);if(t){var o=_ae(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return mae(this,n)}}function mae(e,t){return!t||"object"!==pae(t)&&"function"!=typeof t?gae(e):t}function gae(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _ae(e){return(_ae=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function wae(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var kae=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&vae(e,t)}(i,e);var t,n,r,o=bae(i);function i(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(e=o.call(this)).desktopStyle=i.DisplayStyle.DEFAULT,e.title=null,e.selectViewTabsKeyStrokesEnabled=!0,e.selectViewTabsKeyStrokeModifier="control",e.cacheSplitterPosition=!0,e.browserHistoryEntry=null,e.logoId=null,e.navigationVisible=!0,e.navigationHandleVisible=!0,e.logoActionEnabled=!1,e.benchVisible=!0,e.headerVisible=!0,e.geolocationServiceAvailable=Kt.get().supportsGeolocation(),e.benchLayoutData=null,e.menus=[],e.addOns=[],e.dialogs=[],e.views=[],e.keyStrokes=[],e.viewButtons=[],e.messageBoxes=[],e.fileChoosers=[],e.outline=null,e.activeForm=null,e.selectedViewTabs=[],e.notifications=[],e.navigation=null,e.header=null,e.bench=null,e.splitter=null,e.splitterVisible=!1,e.formController=null,e.messageBoxController=null,e.fileChooserController=null,e.initialFormRendering=!1,e.offline=!1,e.inBackground=!1,e.openUriHandler=null,e.theme=null,e.dense=!1,e._glassPaneTargetFilters=[],e.url=null,e._addWidgetProperties(["viewButtons","menus","views","selectedViewTabs","dialogs","outline","messageBoxes","notifications","fileChoosers","addOns","keyStrokes","activeForm","focusedElement"]),e._addPreserveOnPropertyChangeProperties(["focusedElement"]),e._benchActiveViewChangedHandler=e._onBenchActivateViewChanged.bind(gae(e)),e}return t=i,(n=[{key:"_init",value:function(e){(e.session||e.parent.session).desktop=this,yae(_ae(i.prototype),"_init",this).call(this,e),this.url=new xo,this._initTheme(),this.formController=O.create("DesktopFormController",{displayParent:this,session:this.session}),this.messageBoxController=new TU(this,this.session),this.fileChooserController=new rT(this,this.session),this._resizeHandler=this.onResize.bind(this),this._popstateHandler=this.onPopstate.bind(this),this.updateSplitterVisibility(),this.resolveTextKeys(["title"]),this._setViews(this.views),this._setViewButtons(this.viewButtons),this._setMenus(this.menus),this._setKeyStrokes(this.keyStrokes),this._setBenchLayoutData(this.benchLayoutData),this._setDisplayStyle(this.displayStyle),this._setDense(this.dense),this.openUriHandler=O.create("OpenUriHandler",{session:this.session}),this._glassPaneTargetFilters.push((function(e,t){var n=O.widget(e);return!t.has(n)}))}},{key:"_createKeyStrokeContext",value:function(){return new $u}},{key:"_initKeyStrokeContext",value:function(){yae(_ae(i.prototype),"_initKeyStrokeContext",this).call(this),this.keyStrokeContext.invokeAcceptInputOnActiveValueField=!0,this.keyStrokeContext.registerKeyStroke([new sle(this),new rue(this)])}},{key:"_onBenchActivateViewChanged",value:function(e){if(!this.initialFormRendering){var t=e.view;t instanceof CC&&this.bench.outlineContent!==t&&!t.detailForm&&this._setFormActivated(t)}}},{key:"_render",value:function(){this.$container=this.$parent,this.$container.addClass("desktop"),this.htmlComp=ea.install(this.$container,this.session),this.htmlComp.setLayout(this._createLayout()),this.$container.window().on("resize",this._resizeHandler).on("popstate",this._popstateHandler),this.$overlaySeparator=this.$container.appendDiv("overlay-separator").setVisible(!1),this._renderNavigationVisible(),this._renderHeaderVisible(),this._renderBenchVisible(),this._renderTitle(),this._renderLogoUrl(),this._renderSplitterVisible(),this._renderInBackground(),this._renderNavigationHandleVisible(),this._renderNotifications(),this._renderBrowserHistoryEntry(),this._renderDense(),this.addOns.forEach((function(e){e.render()}),this),this._setupDragAndDrop(),this._disableContextMenu()}},{key:"_remove",value:function(){this.formController.remove(),this.messageBoxController.remove(),this.fileChooserController.remove(),this.$container.window().off("resize",this._resizeHandler).off("popstate",this._popstateHandler),yae(_ae(i.prototype),"_remove",this).call(this)}},{key:"_postRender",value:function(){yae(_ae(i.prototype),"_postRender",this).call(this),this.initialFormRendering=!0,this._renderDisplayChildrenOfOutline(),this.formController.render(),this.messageBoxController.render(),this.fileChooserController.render(),this.initialFormRendering=!1}},{key:"_setDisplayStyle",value:function(e){this._setProperty("displayStyle",e);var t=this.displayStyle===i.DisplayStyle.COMPACT;if(this.header){if(this.header.tabArea){var n=Upe.DisplayStyle;this.header.tabArea.setDisplayStyle(t?n.SPREAD_EVEN:n.DEFAULT)}this.header.setToolBoxVisible(!t),this.header.animateRemoval=t}this.navigation&&(this.navigation.setToolBoxVisible(t),this.navigation.htmlComp.layoutData.fullWidth=t),this.bench&&this.bench.setOutlineContentVisible(!t),this.outline&&(this.outline.setCompact(t),this.outline.setEmbedDetailContent(t))}},{key:"setDense",value:function(e){this.setProperty("dense",e)}},{key:"_setDense",value:function(e){this._setProperty("dense",e),To.clearCache(),Xs.get().init(this.dense?"dense":null)}},{key:"_renderDense",value:function(){this.$container.toggleClass("dense",this.dense)}},{key:"_createLayout",value:function(){return new Uae(this)}},{key:"_renderDisplayChildrenOfOutline",value:function(){var e=this;this.outline&&(this.outline.formController.render(),this.outline.messageBoxController.render(),this.outline.fileChooserController.render(),this.outline.selectedViewTabs?this.outline.selectedViewTabs.forEach((function(t){e.formController._activateView(t)})):this.outline.views.filter((function(e){return e.modal})).forEach(this.formController._activateView.bind(this.formController)))}},{key:"_removeDisplayChildrenOfOutline",value:function(){this.outline&&(this.outline.formController.remove(),this.outline.messageBoxController.remove(),this.outline.fileChooserController.remove())}},{key:"computeParentForDisplayParent",value:function(e){var t=e;return e instanceof fde&&(t=this),t}},{key:"_renderTitle",value:function(){var e=this.title;if(null!=e){var t=s()("div.scout");t.length<=1&&(t.document(!0).title=e)}}},{key:"_renderActiveForm",value:function(){}},{key:"_renderBench",value:function(){this.bench||(this.bench=this._createBench(),this.bench.on("viewActivate",this._benchActiveViewChangedHandler),this.bench.render(),this.bench.$container.insertBefore(this.$overlaySeparator),this.invalidateLayoutTree())}},{key:"_createBench",value:function(){return O.create("DesktopBench",{parent:this,animateRemoval:!0,headerTabArea:this.header?this.header.tabArea:void 0,outlineContentVisible:this.displayStyle!==i.DisplayStyle.COMPACT})}},{key:"_removeBench",value:function(){var e=this;this.bench&&(this.bench.off("viewActivate",this._benchActiveViewChangedHandler),this.bench.on("destroy",(function(){e.bench=null,e.invalidateLayoutTree()})),this.bench.destroy())}},{key:"_renderBenchVisible",value:function(){this.animateLayoutChange=this.rendered,this.benchVisible?(this._renderBench(),this._renderInBackground()):this._removeBench()}},{key:"_renderNavigation",value:function(){this.navigation||(this.navigation=this._createNavigation(),this.navigation.render(),this.navigation.$container.prependTo(this.$container),this.invalidateLayoutTree())}},{key:"_createNavigation",value:function(){return O.create("DesktopNavigation",{parent:this,outline:this.outline,toolBoxVisible:this.displayStyle===i.DisplayStyle.COMPACT,layoutData:{fullWidth:this.displayStyle===i.DisplayStyle.COMPACT}})}},{key:"_removeNavigation",value:function(){this.navigation&&(this.navigation.destroy(),this.navigation=null,this.invalidateLayoutTree())}},{key:"_renderNavigationVisible",value:function(){this.animateLayoutChange=this.rendered,this.navigationVisible?this._renderNavigation():this.animateLayoutChange?this.invalidateLayoutTree():this._removeNavigation()}},{key:"_renderHeader",value:function(){this.header||(this.header=this._createHeader(),this.header.render(),this.navigation&&this.navigation.rendered?this.header.$container.insertAfter(this.navigation.$container):this.header.$container.prependTo(this.$container),this.bench&&this.bench._setTabArea(this.header.tabArea),this.invalidateLayoutTree())}},{key:"_createHeader",value:function(){var e=this.displayStyle===i.DisplayStyle.COMPACT;return O.create("DesktopHeader",{parent:this,logoUrl:this.logoUrl,animateRemoval:e,toolBoxVisible:!e,tabArea:{displayStyle:e?Upe.DisplayStyle.SPREAD_EVEN:Upe.DisplayStyle.DEFAULT}})}},{key:"_removeHeader",value:function(){var e=this;this.header&&(this.header.on("destroy",(function(){e.invalidateLayoutTree(),e.header=null})),this.header.destroy())}},{key:"_renderHeaderVisible",value:function(){this.headerVisible?this._renderHeader():this._removeHeader()}},{key:"_renderLogoUrl",value:function(){this.header&&this.header.setLogoUrl(this.logoUrl)}},{key:"_renderSplitterVisible",value:function(){this.splitterVisible?this._renderSplitter():this._removeSplitter()}},{key:"_renderSplitter",value:function(){!this.splitter&&this.navigation&&(this.splitter=O.create("Splitter",{parent:this,$anchor:this.navigation.$container,$root:this.$container}),this.splitter.render(),this.splitter.$container.insertBefore(this.$overlaySeparator),this.splitter.on("move",this._onSplitterMove.bind(this)),this.splitter.on("moveEnd",this._onSplitterMoveEnd.bind(this)),this.splitter.on("positionChange",this._onSplitterPositionChange.bind(this)),this.updateSplitterPosition())}},{key:"_removeSplitter",value:function(){this.splitter&&(this.splitter.destroy(),this.splitter=null)}},{key:"_renderInBackground",value:function(){this.bench&&this.bench.$container.toggleClass("drop-shadow",this.inBackground)}},{key:"_renderBrowserHistoryEntry",value:function(){if(Kt.get().supportsHistoryApi()){var e=this.$container.window(!0),t=this.browserHistoryEntry;if(t){var n=this._createHistoryPath(t);(this.rendered?e.history.pushState:e.history.replaceState).bind(e.history)({deepLinkPath:t.deepLinkPath},t.title,n)}}}},{key:"_createHistoryPath",value:function(e){if(!e.pathVisible)return"";var t=e.path,n=this.url.clone();if(n.removeParameter("dl"),n.removeParameter("i"),Pr.countOwnProperties(n.parameterMap)>0){var r=new xo(t);for(var o in n.parameterMap)r.addParameter(o,n.getParameter(o));t=r.toString({alwaysFirst:["dl","i"]})}return t}},{key:"_setupDragAndDrop",value:function(){var e=function(e){e.stopPropagation(),e.preventDefault(),e.originalEvent.dataTransfer.dropEffect="none"};this.$container.on("dragenter",e),this.$container.on("dragover",e),this.$container.on("drop",(function(e){e.stopPropagation(),e.preventDefault()}))}},{key:"updateSplitterVisibility",value:function(){this.setSplitterVisible(this.navigationVisible&&this.benchVisible&&this.displayStyle!==i.DisplayStyle.COMPACT)}},{key:"setSplitterVisible",value:function(e){this.setProperty("splitterVisible",e)}},{key:"updateSplitterPosition",value:function(){if(this.splitter){var e=this.cacheSplitterPosition&&this._loadCachedSplitterPosition();if(e){var t=parseInt(e,10);this.splitter.setPosition(t),this.invalidateLayoutTree()}else this.splitter.setPosition(),this.invalidateLayoutTree()}}},{key:"_disableContextMenu",value:function(){this.$container.on("contextmenu",(function(e){"INPUT"===e.target.nodeName||"TEXTAREA"===e.target.nodeName||e.target.isContentEditable||e.preventDefault()}))}},{key:"setOutline",value:function(e){if(this.outline!==e)try{this.bench&&this.bench.setChanging(!0),this.rendered&&this._removeDisplayChildrenOfOutline(),this.outline=e,this._setDisplayStyle(this.displayStyle),this._setOutlineActivated(),this.navigation&&this.navigation.setOutline(this.outline),this.trigger("outlineChange"),this.rendered&&this._renderDisplayChildrenOfOutline()}finally{this.bench&&this.bench.setChanging(!1)}}},{key:"_setViews",value:function(e){var t=this;e&&e.forEach((function(e){e.setDisplayParent(t)})),this._setProperty("views",e)}},{key:"_setViewButtons",value:function(e){this.updateKeyStrokes(e,this.viewButtons),this._setProperty("viewButtons",e)}},{key:"setMenus",value:function(e){this.header&&this.header.setMenus(e)}},{key:"_setMenus",value:function(e){this.updateKeyStrokes(e,this.menus),this._setProperty("menus",e)}},{key:"_setKeyStrokes",value:function(e){this.updateKeyStrokes(e,this.keyStrokes),this._setProperty("keyStrokes",e)}},{key:"setNavigationHandleVisible",value:function(e){this.setProperty("navigationHandleVisible",e)}},{key:"_renderNavigationHandleVisible",value:function(){this.$container.toggleClass("has-navigation-handle",this.navigationHandleVisible)}},{key:"setNavigationVisible",value:function(e){this.setProperty("navigationVisible",e),this.updateSplitterVisibility()}},{key:"setBenchVisible",value:function(e){this.setProperty("benchVisible",e),this.updateSplitterVisibility()}},{key:"setHeaderVisible",value:function(e){this.setProperty("headerVisible",e)}},{key:"_setBenchLayoutData",value:function(e){e=Hle.ensure(e),this._setProperty("benchLayoutData",e)}},{key:"_setInBackground",value:function(e){this._setProperty("inBackground",e)}},{key:"outlineDisplayStyle",value:function(){if(this.outline)return this.outline.displayStyle}},{key:"shrinkNavigation",value:function(){this.outline&&this.outline.toggleBreadcrumbStyleEnabled&&this.navigationVisible&&this.outlineDisplayStyle()===KH.DisplayStyle.DEFAULT?this.outline.setDisplayStyle(KH.DisplayStyle.BREADCRUMB):this.setNavigationVisible(!1)}},{key:"enlargeNavigation",value:function(){this.outline&&this.navigationVisible&&this.outlineDisplayStyle()===KH.DisplayStyle.BREADCRUMB?this.outline.setDisplayStyle(KH.DisplayStyle.DEFAULT):(this.setNavigationVisible(!0),this.validateLayoutTree())}},{key:"switchToBench",value:function(e){this.setHeaderVisible(O.nvl(e,!0)),this.setBenchVisible(!0),this.setNavigationVisible(!1)}},{key:"switchToNavigation",value:function(){this.setNavigationVisible(!0),this.setHeaderVisible(!1),this.setBenchVisible(!1)}},{key:"revalidateHeaderLayout",value:function(){this.header&&this.header.revalidateLayout()}},{key:"goOffline",value:function(){this.offline||(this.offline=!0,this._removeOfflineNotification(),this._offlineNotification=O.create("DesktopNotification:Offline",{parent:this}),this._offlineNotification.show())}},{key:"goOnline",value:function(){this._removeOfflineNotification()}},{key:"_removeOfflineNotification",value:function(){this._offlineNotification&&(setTimeout(this.removeNotification.bind(this,this._offlineNotification),3e3),this._offlineNotification=null)}},{key:"addNotification",value:function(e){e&&(this.notifications.push(e),this.rendered&&this._renderNotification(e))}},{key:"_renderNotification",value:function(e){var t=this;this.$notifications?this.$notifications.appendTo(this.$container):this.$notifications=this.$container.appendDiv("desktop-notifications"),e.fadeIn(this.$notifications),e.duration>0&&(e.removeTimeout=setTimeout(e.hide.bind(e),e.duration),e.one("remove",(function(){t.removeNotification(e)})))}},{key:"_renderNotifications",value:function(){var e=this;this.notifications.forEach((function(t){e._renderNotification(t)}))}},{key:"removeNotification",value:function(e){if("string"==typeof e){var t=e;e=rt.find(this.notifications,(function(e){return t===e.id}))}e&&(e.removeTimeout&&clearTimeout(e.removeTimeout),rt.remove(this.notifications,e),this.rendered&&this.$notifications&&(e.fadeOut(),e.one("remove",this._onNotificationRemove.bind(this,e))))}},{key:"getPopupsFor",value:function(e){var t=[];return this.$container.children(".popup").each((function(n,r){var o=s()(r),i=me.get(o);e.has(i)&&t.push(i)})),t}},{key:"destroyPopupsFor",value:function(e){this.getPopupsFor(e).forEach((function(e){e.destroy()}))}},{key:"openUri",value:function(e,t){this.rendered?this.openUriHandler.openUri(e,t):this._postRenderActions.push(this.openUri.bind(this,e,t))}},{key:"bringOutlineToFront",value:function(){this.rendered?this.inBackground&&this.displayStyle!==i.DisplayStyle.BENCH&&(this._setInBackground(!1),this._setOutlineActivated(),this.navigationVisible&&this.navigation.bringToFront(),this.benchVisible&&this.bench.bringToFront(),this.headerVisible&&this.header.bringToFront(),this._renderInBackground()):this._postRenderActions.push(this.bringOutlineToFront.bind(this))}},{key:"sendOutlineToBack",value:function(){this.inBackground||(this._setInBackground(!0),this.navigationVisible&&this.navigation.sendToBack(),this.benchVisible&&this.bench.sendToBack(),this.headerVisible&&this.header.sendToBack(),this._renderInBackground())}},{key:"inFront",value:function(){return!0}},{key:"_glassPaneTargets",value:function(e){var t,n=this,r=this.$container.children().not(".splitter").not(".desktop-notifications").not(".overlay-separator");if(e){e.$container&&(r=r.not(e.$container));var o=this.$overlaySeparator.nextAll().toArray(),i=[];e.$container&&o.indexOf(e.$container[0])>-1&&(i=e.$container.nextAll().toArray());var a=null;if(o.length)for(var l=o.length-1;l>=0;l--){var u=o[l];if(this._isGlassPaneTargetFiltered(u,e)){a=u;break}}r=r.filter((function(t,r){return!(i.indexOf(r)>-1)&&r!==a&&n._isGlassPaneTargetFiltered(r,e)}))}return e instanceof CC&&e.displayHint===CC.DisplayHint.VIEW?(r=r.not(".desktop-bench").not(".desktop-header"),this.header&&this.header.toolBox&&this.header.toolBox.$container&&r.push(this.header.toolBox.$container),t=s.a.makeArray(r),rt.pushAll(t,this._getBenchGlassPaneTargetsForView(e))):t=s.a.makeArray(r),this._pushPopupWindowGlassPaneTargets(t,e),t}},{key:"_isGlassPaneTargetFiltered",value:function(e,t){return this._glassPaneTargetFilters.every((function(n){return n(e,t)}),this)}},{key:"addGlassPaneTargetFilter",value:function(e){this._glassPaneTargetFilters.push(e)}},{key:"removeGlassPaneTargetFilter",value:function(e){rt.remove(this._glassPaneTargetFilters,e)}},{key:"_deferredGlassPaneTarget",value:function(e){var t=new rh;return e.one("init",(function(){t.ready([e.$container])})),t}},{key:"_getBenchGlassPaneTargetsForView",value:function(e){var t=[];return t=t.concat(this._getTabGlassPaneTargetsForView(e,this.header)),this.bench&&this.bench.visibleTabBoxes().forEach((function(n){n.rendered&&(n.hasView(e)?t=t.concat(this._getTabGlassPaneTargetsForView(e,n)):t.push(n.$container))}),this),t}},{key:"_getTabGlassPaneTargetsForView",value:function(e,t){var n=[];return t&&t.tabArea&&t.tabArea.tabs.forEach((function(t){t.view!==e&&(n.push(t.$container),t.$container.addClass("no-hover"))})),n}},{key:"_pushPopupWindowGlassPaneTargets",value:function(e,t){this.formController._popupWindows.forEach((function(n){t!==n.form&&e.push(n.initialized?n.$container[0]:this._deferredGlassPaneTarget(n))}),this)}},{key:"showForm",value:function(e,t){var n=e.displayParent||this;e.setDisplayParent(n),this._setFormActivated(e),n.formController.registerAndRender(e,t,!0)}},{key:"hideForm",value:function(e){if(e.displayParent){if(this.displayStyle===i.DisplayStyle.COMPACT&&e.isView()&&this.benchVisible){var t=this.bench.getViews().slice();rt.remove(t,e),0===t.length&&this.switchToNavigation()}e.displayParent.formController.unregisterAndRemove(e),this.benchVisible&&0!==this.bench.getViews().length||this.bringOutlineToFront()}}},{key:"activateForm",value:function(e){(e.displayParent||this).formController.activateForm(e),this._setFormActivated(e),e.dialogs.forEach((function(e){e.modal&&this.activateForm(e)}),this)}},{key:"_setOutlineActivated",value:function(){this._setFormActivated(null),this.outline&&this.outline.activateCurrentPage()}},{key:"_setFormActivated",value:function(e){this.rendered&&!this.initialFormRendering&&this.activeForm!==e&&(this.activeForm=e,e?e.displayHint===CC.DisplayHint.VIEW&&!e.detailForm&&this.bench&&this.bench.hasView(e)&&this.sendOutlineToBack():this.bringOutlineToFront(),this.triggerFormActivate(e))}},{key:"triggerFormActivate",value:function(e){this.trigger("formActivate",{form:e})}},{key:"cancelViews",value:function(e){var t=new sn;t.forms=e,this.trigger("cancelForms",t),t.defaultPrevented||this._cancelViews(e)}},{key:"_cancelViews",value:function(e){if(1!==(e=e.filter((function(e){return!rt.find(e.views,(function(e){return e.modal}))}))).length){var t=e.filter((function(e){var t=!1;return e.visitDisplayChildren((function(e){e.lifecycle.requiresSave()&&(t=!0)}),(function(e){return e instanceof CC})),e.lifecycle.requiresSave()||t})),n=s.a.resolvedPromise();if(t.length>0){var r=O.create("scout.UnsavedFormChangesForm",{parent:this,session:this.session,displayParent:this,unsavedForms:t});r.open(),n=r.whenSave().then((function(){var e=r.openFormsField.value;return e.forEach((function(e){e.visitDisplayChildren((function(e){e instanceof CC?e.ok():e.close()})),e.ok()})),e}))}n.then((function(t){t&&rt.removeAll(e,t),e.forEach((function(e){e.visitDisplayChildren((function(e){e.close()})),e.close()}))}))}else e[0].cancel()}},{key:"onLayoutAnimationComplete",value:function(){this.headerVisible||this._removeHeader(),this.navigationVisible||this._removeNavigation(),this.benchVisible||this._removeBench(),this.trigger("animationEnd"),this.animateLayoutChange=!1}},{key:"onLayoutAnimationStep",value:function(){this.repositionTooltips()}},{key:"onResize",value:function(e){this.revalidateLayoutTree()}},{key:"resetPopstateHandler",value:function(){this.setPopstateHandler(this.onPopstate.bind(this))}},{key:"setPopstateHandler",value:function(e){if(this.rendered||this.rendering){var t=this.$container.window();this._popstateHandler&&t.off("popstate",this._popstateHandler),e&&t.on("popstate",e)}this._popstateHandler=e}},{key:"onPopstate",value:function(e){var t=e.originalEvent.state;t&&t.deepLinkPath&&this.trigger("historyEntryActivate",t)}},{key:"_onSplitterMove",value:function(e){this.resizing=!0;var t=Math.floor(this.$container.outerWidth(!0)/2);e.position>t&&e.setPosition(t)}},{key:"_onSplitterPositionChange",value:function(e){this.htmlComp.layouting||this.revalidateLayout()}},{key:"_onSplitterMoveEnd",value:function(e){var t=e.position;this.cacheSplitterPosition&&this._storeCachedSplitterPosition(this.splitter.position),t<Iue.BREADCRUMB_STYLE_WIDTH?this.navigation.$container.animate({width:Iue.BREADCRUMB_STYLE_WIDTH},{progress:function(){this.resizing=!0,this.splitter.setPosition(),this.revalidateLayout(),this.resizing=!1}.bind(this),complete:function(){this.resizing=!0,this.splitter.setPosition(),this._storeCachedSplitterPosition(this.splitter.position),this.revalidateLayout(),this.resizing=!1}.bind(this)}):this.resizing=!1}},{key:"_loadCachedSplitterPosition",value:function(){return Ho.getItemFromSessionStorage("scout:desktopSplitterPosition")||Ho.getItemFromLocalStorage("scout:desktopSplitterPosition:"+window.location.pathname)}},{key:"_storeCachedSplitterPosition",value:function(e){Ho.setItemToSessionStorage("scout:desktopSplitterPosition",e),Ho.setItemToLocalStorage("scout:desktopSplitterPosition:"+window.location.pathname,e)}},{key:"_onNotificationRemove",value:function(e){0===this.notifications.length&&this.$notifications&&(this.$notifications.remove(),this.$notifications=null)}},{key:"onReconnecting",value:function(){this.offline&&this._offlineNotification.reconnect()}},{key:"onReconnectingSucceeded",value:function(){this.offline&&(this.offline=!1,this._offlineNotification.reconnectSucceeded(),this._removeOfflineNotification())}},{key:"onReconnectingFailed",value:function(){this.offline&&this._offlineNotification.reconnectFailed()}},{key:"dataChange",value:function(e){this.events.trigger("dataChange",e)}},{key:"_activeTheme",value:function(){return No.get("scout.ui.theme")||i.DEFAULT_THEME}},{key:"logoAction",value:function(){this.logoActionEnabled&&this.trigger("logoAction")}},{key:"_initTheme",value:function(){var e=this.theme;this.url.hasParameter("theme")?e=Wn.nullIfEmpty(this.url.getParameter("theme"))||i.DEFAULT_THEME:null===e&&(e=this._activeTheme()),this.setTheme(e)}},{key:"setTheme",value:function(e){this.setProperty("theme",e),this.theme!==this._activeTheme()&&this._switchTheme(e)}},{key:"_switchTheme",value:function(e){No.set("scout.ui.theme",e,2592e3),s()("body").setVisible(!1);var t={clearBody:!1};this.url.hasParameter("theme")&&(this.url.removeParameter("theme"),t.redirectUrl=this.url.toString()),O.reloadPage(t)}},{key:"moveOverlaysBehindAndFocus",value:function(e,t){(t=s.a.ensure(t)).nextAll().toArray().forEach((function(n){rt.containsAll(e,[n])&&s()(n).insertBefore(t)})),t.isOrHas(t.activeElement())||this.session.focusManager.activateFocusContext(t)}},{key:"repositionTooltips",value:function(){this.$container.children(".tooltip").each((function(){O.widget(s()(this)).position()}))}},{key:"_renderTrackFocus",value:function(){this.trackFocus?this.$container[0].addEventListener("focusin",this._focusInListener,!0):this.$container[0].removeEventListener("focusin",this._focusInListener,!0)}},{key:"_onFocusIn",value:function(e){yae(_ae(i.prototype),"_onFocusIn",this).call(this,e);var t=s()(e.target),n=O.widget(t);this.setProperty("focusedElement",n)}}])&&dae(t.prototype,n),r&&dae(t,r),i}(ve);function Sae(e){return(Sae="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Oae(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Tae(e,t,n){return(Tae="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=xae(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function Cae(e,t){return(Cae=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Pae(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=xae(e);if(t){var o=xae(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Rae(this,n)}}function Rae(e,t){return!t||"object"!==Sae(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function xae(e){return(xae=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}wae(kae,"DisplayStyle",{DEFAULT:"default",BENCH:"bench",COMPACT:"compact"}),wae(kae,"UriAction",{DOWNLOAD:"download",OPEN:"open",NEW_WINDOW:"newWindow",POPUP_WINDOW:"popupWindow",SAME_WINDOW:"sameWindow"}),wae(kae,"DEFAULT_THEME","default");var Eae=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Cae(e,t)}(i,e);var t,n,r,o=Pae(i);function i(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(e=o.call(this))._addRemoteProperties(["benchVisible","navigationVisible","navigationHandleVisible","headerVisible","geolocationServiceAvailable","inBackground","focusedElement"]),e}return t=i,(n=[{key:"_goOffline",value:function(){this.widget.goOffline()}},{key:"_goOnline",value:function(){this.widget.goOnline()}},{key:"_onWidgetHistoryEntryActivate",value:function(e){this._send("historyEntryActivate",{deepLinkPath:e.deepLinkPath})}},{key:"_onWidgetFormActivate",value:function(e){e.form&&!e.form.modelAdapter||this._sendFormActivate(e.form)}},{key:"_sendFormActivate",value:function(e){var t={formId:e?e.modelAdapter.id:null};this._send("formActivate",t,{coalesce:function(e){return this.target===e.target&&this.type===e.type&&!(null===e.formId&&null!==this.formId)}})}},{key:"_prepareRemoteProperty",value:function(e,t){return"focusedElement"===e?t:Tae(xae(i.prototype),"_prepareRemoteProperty",this).call(this,e,t)}},{key:"_sendFocusedElement",value:function(e){for(;e&&!e.modelAdapter;)e=e.parent;e=e?e.id:null,this._sendProperty("focusedElement",e)}},{key:"_logoAction",value:function(e){this._send("logoAction")}},{key:"_onWidgetEvent",value:function(e){"formActivate"===e.type?this._onWidgetFormActivate(e):"historyEntryActivate"===e.type?this._onWidgetHistoryEntryActivate(e):"logoAction"===e.type?this._logoAction(e):"cancelForms"===e.type?this._onWidgetCancelAllForms(e):Tae(xae(i.prototype),"_onWidgetEvent",this).call(this,e)}},{key:"_onFormShow",value:function(e){var t,n=this.session.getModelAdapter(e.displayParent);n&&((t=this.session.getOrCreateWidget(e.form,n.widget)).setDisplayParent(n.widget),this.session.asyncEvents.some((function(e){return"formActivate"===e.type&&e.target===this.id}),this)||this.addFilterForWidgetEvent((function(e){return"formActivate"===e.type&&e.form===t})),this.widget.showForm(t,e.position))}},{key:"_onFormHide",value:function(e){var t;this.session.getModelAdapter(e.displayParent)&&(t=this.session.getModelAdapter(e.form),this.widget.hideForm(t.widget))}},{key:"_onFormActivate",value:function(e){var t=this.session.getWidget(e.form);this.widget.activateForm(t)}},{key:"_onWidgetCancelAllForms",value:function(e){e.preventDefault();var t=[];e.forms&&(t=e.forms.map((function(e){return e.modelAdapter.id}))),this._send("cancelForms",{formIds:t})}},{key:"_onMessageBoxShow",value:function(e){var t,n=this.session.getModelAdapter(e.displayParent);n&&((t=this.session.getOrCreateWidget(e.messageBox,n.widget)).setDisplayParent(n.widget),n.widget.messageBoxController.registerAndRender(t))}},{key:"_onMessageBoxHide",value:function(e){var t,n=this.session.getModelAdapter(e.displayParent);n&&(t=this.session.getModelAdapter(e.messageBox),n.widget.messageBoxController.unregisterAndRemove(t.widget))}},{key:"_onFileChooserShow",value:function(e){var t,n=this.session.getModelAdapter(e.displayParent);n&&((t=this.session.getOrCreateWidget(e.fileChooser,n.widget)).setDisplayParent(n.widget),n.widget.fileChooserController.registerAndRender(t))}},{key:"_onFileChooserHide",value:function(e){var t,n=this.session.getModelAdapter(e.displayParent);n&&(t=this.session.getModelAdapter(e.fileChooser),n.widget.fileChooserController.unregisterAndRemove(t.widget))}},{key:"_onOpenUri",value:function(e){this.widget.openUri(e.uri,e.action)}},{key:"_onOutlineChanged",value:function(e){var t=this.session.getOrCreateWidget(e.outline,this.widget);this.widget.setOutline(t)}},{key:"_onAddNotification",value:function(e){var t=this.session.getOrCreateWidget(e.notification,this.widget);this.widget.addNotification(t)}},{key:"_onRemoveNotification",value:function(e){this.widget.removeNotification(e.notification)}},{key:"_onOutlineContentActivate",value:function(e){this.widget.bringOutlineToFront()}},{key:"_onRequestGeolocation",value:function(e){if(navigator.geolocation){var t=function(e){this._send("geolocationDetermined",{latitude:e.coords.latitude,longitude:e.coords.longitude})}.bind(this),n=function(e){this._send("geolocationDetermined",{errorCode:e.code,errorMessage:e.message})}.bind(this);navigator.geolocation.getCurrentPosition(t,n)}}},{key:"onModelAction",value:function(e){"formShow"===e.type?this._onFormShow(e):"formHide"===e.type?this._onFormHide(e):"formActivate"===e.type?this._onFormActivate(e):"messageBoxShow"===e.type?this._onMessageBoxShow(e):"messageBoxHide"===e.type?this._onMessageBoxHide(e):"fileChooserShow"===e.type?this._onFileChooserShow(e):"fileChooserHide"===e.type?this._onFileChooserHide(e):"openUri"===e.type?this._onOpenUri(e):"outlineChanged"===e.type?this._onOutlineChanged(e):"outlineContentActivate"===e.type?this._onOutlineContentActivate(e):"addNotification"===e.type?this._onAddNotification(e):"removeNotification"===e.type?this._onRemoveNotification(e):"requestGeolocation"===e.type?this._onRequestGeolocation(e):Tae(xae(i.prototype),"onModelAction",this).call(this,e)}}])&&Oae(t.prototype,n),r&&Oae(t,r),i}(de);function Dae(e){return(Dae="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Aae(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Fae(e,t,n){return(Fae="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Iae(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function $ae(e,t){return($ae=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function jae(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Iae(e);if(t){var o=Iae(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Bae(this,n)}}function Bae(e,t){return!t||"object"!==Dae(t)&&"function"!=typeof t?Mae(e):t}function Mae(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Iae(e){return(Iae=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Lae=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&$ae(e,t)}(i,e);var t,n,r,o=jae(i);function i(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(e=o.call(this)).desktop=null,e.clickable=!1,e._desktopPropertyChangeHandler=e._onDesktopPropertyChange.bind(Mae(e)),e._clickHandler=e._onClick.bind(Mae(e)),e}return t=i,(n=[{key:"_init",value:function(e){Fae(Iae(i.prototype),"_init",this).call(this,e),this.desktop=this.session.desktop,this.clickable=this.desktop.logoActionEnabled,this.url=e.url}},{key:"_render",value:function(){this.$container=this.$parent.appendDiv("desktop-logo"),this.desktop.on("propertyChange",this._desktopPropertyChangeHandler)}},{key:"_renderProperties",value:function(){Fae(Iae(i.prototype),"_renderProperties",this).call(this),this._renderUrl(),this._renderClickable()}},{key:"_remove",value:function(){this.desktop.off("propertyChange",this._desktopPropertyChangeHandler),Fae(Iae(i.prototype),"_remove",this).call(this)}},{key:"_renderUrl",value:function(){this.$container.css("backgroundImage","url("+this.url+")")}},{key:"_renderClickable",value:function(){this.$container.toggleClass("clickable",this.clickable),this.clickable?this.$container.on("click",this._clickHandler):this.$container.off("click",this._clickHandler)}},{key:"setUrl",value:function(e){this.setProperty("url",e)}},{key:"setClickable",value:function(e){this.setProperty("clickable",e)}},{key:"_onDesktopPropertyChange",value:function(e){"logoActionEnabled"===e.propertyName&&this.setClickable(e.newValue)}},{key:"_onClick",value:function(e){this.desktop.logoAction()}}])&&Aae(t.prototype,n),r&&Aae(t,r),i}(ve);function Hae(e){return(Hae="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Nae(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Vae(e,t){return(Vae=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Wae(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Gae(e);if(t){var o=Gae(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return zae(this,n)}}function zae(e,t){return!t||"object"!==Hae(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Gae(e){return(Gae=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Uae=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Vae(e,t)}(i,e);var t,n,r,o=Wae(i);function i(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(t=o.call(this)).desktop=e,t}return t=i,(n=[{key:"layout",value:function(e){var t,n,r,o,i,s,a,l=0,u=0,c=this.desktop,f=c.navigation,h=c.header,p=c.bench,d=c.animateLayoutChange,y=this.containerSize(),v=f&&f.htmlComp.layoutData.fullWidth;if(MR.get().handleResponsive(c,e.width()),f&&(l=this.calculateNavigationWidth(y),c.splitter&&c.splitter.setPosition(l),c.navigationVisible&&(s=f.htmlComp,t=new $s(l,y.height).subtract(s.margins()),s.setSize(t))),h&&(u=(r=h.htmlComp).$comp.outerHeight(!0),c.headerVisible&&(d||h.$container.cssLeft(l),n=new $s(y.width-l,u).subtract(r.margins()),d&&!v||r.setSize(n),d&&(m(a={left:y.width},r,n),this._animate(a,r,n)))),p&&(o=p.htmlComp,c.benchVisible)){if(p.$container.cssTop(u),d||p.$container.cssLeft(l),i=new $s(y.width-l,y.height-u).subtract(o.margins()),!d||v){var b=o.size();o.setSize(i),o.size().equals(b)||c.repositionTooltips()}d&&(m(a={left:y.width},o,i),this._animate(a,o,i))}function m(e,t,n){v?t.$comp.cssLeft(y.width):(e.width=n.width,t.setSize(n)),e.left=l}}},{key:"_animate",value:function(e,t,n){function r(){t.$comp.stop().animate(e,{complete:this.desktop.onLayoutAnimationComplete.bind(this.desktop),step:this.desktop.onLayoutAnimationStep.bind(this.desktop)})}t.$comp.is(":animated")?r.call(this):setTimeout(r.bind(this))}},{key:"containerSize",value:function(){var e=this.desktop.htmlComp,t=e.availableSize({exact:!0});return t.subtract(e.insets())}},{key:"calculateNavigationWidth",value:function(e){if(!this.desktop.navigationVisible)return 0;if(this.desktop.navigation.htmlComp.layoutData.fullWidth)return e.width;var t=0;this.desktop.splitter&&(t=this.desktop.splitter.position);var n=this.desktop.outline;return!this.desktop.resizing&&n&&n.toggleBreadcrumbStyleEnabled&&(n.displayStyle===KH.DisplayStyle.BREADCRUMB?t=Iue.BREADCRUMB_STYLE_WIDTH:Math.floor(t)<=Iue.BREADCRUMB_STYLE_WIDTH&&(t=Iue.DEFAULT_STYLE_WIDTH)),Math.max(t,Iue.MIN_WIDTH)}}])&&Nae(t.prototype,n),r&&Nae(t,r),i}(Zs);function Kae(e){return(Kae="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function qae(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Yae(e,t){return(Yae=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Xae(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Zae(e);if(t){var o=Zae(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Jae(this,n)}}function Jae(e,t){return!t||"object"!==Kae(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Zae(e){return(Zae=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Qae=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Yae(e,t)}(i,e);var t,n,r,o=Xae(i);function i(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),o.call(this)}return t=i,(n=[{key:"_createTab",value:function(e){return O.create("DesktopTab",{parent:this.tabArea,view:e})}},{key:"_shouldCreateTabForView",value:function(e){return!e.headerVisible}}])&&qae(t.prototype,n),r&&qae(t,r),i}(ql);function ele(e){return(ele="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function tle(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function nle(e,t){return(nle=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function rle(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=ile(e);if(t){var o=ile(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return ole(this,n)}}function ole(e,t){return!t||"object"!==ele(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function ile(e){return(ile=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var sle=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&nle(e,t)}(i,e);var t,n,r,o=rle(i);function i(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(t=o.call(this)).field=e,t.which=[Ou.F5],t.preventDefault=!0,t.keyStrokeFirePolicy=Up.KeyStrokeFirePolicy.ALWAYS,t.renderingHints.render=!1,t}return t=i,(n=[{key:"handle",value:function(e){}}])&&tle(t.prototype,n),r&&tle(t,r),i}(zu);function ale(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var lle=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.myWindow=t,this.form=n,this.session=n.session,this.events=new ln,this.initialized=!1,this.$container=null,this.htmlComp=null,n.popupWindow=this,t.popupWindow=this,t.name="Scout popup-window "+n.modelClass}var t,n,r;return t=e,(n=[{key:"_onUnload",value:function(){s.a.log.isDebugEnabled()&&s.a.log.debug("stored form ID "+this.form.id+" to session storage"),this.form.destroyed?s.a.log.isDebugEnabled()&&s.a.log.debug("form ID "+this.form.id+" is already destroyed - don't trigger unload event"):this.events.trigger("popupWindowUnload",this)}},{key:"_onReady",value:function(){var e=this.myWindow.document,t=s()(this.myWindow),n=s()(e);if(this.myWindow.popupWindow=this,Rr.install(this.myWindow),O.prepareDOM(e),this.$container=s()(".scout",e),this.htmlComp=ea.install(this.$container,this.session),this.htmlComp.setLayout(new Ml),this.$container.height(t.height()),this.form.render(this.$container),this.resizeToPrefSize){var r=this.htmlComp.prefSize(),o=new $s(this.myWindow.outerWidth,this.myWindow.outerHeight),i=new $s(n.width(),n.height()),a=o.width-i.width,l=o.height-i.height;this.myWindow.resizeTo(r.width+a,r.height+l),this.resizeToPrefSize=!1}this.form.htmlComp.validateLayout(),this.session.keyStrokeManager.installTopLevelKeyStrokeHandlers(this.$container),this.session.focusManager.installTopLevelMouseHandlers(this.$container),O.installGlobalMouseDownInterceptor(e),s()(this.myWindow).on("unload",this._onUnload.bind(this)).on("resize",this._onResize.bind(this)),this.myWindow.opener&&(this.myWindow.onerror=this.myWindow.opener.onerror),this.initialized=!0,this.events.trigger("init")}},{key:"_onResize",value:function(){var e=s()(this.myWindow),t=e.width(),n=e.height(),r=this.myWindow.screenX,o=this.myWindow.screenY;s.a.log.isDebugEnabled()&&s.a.log.debug("popup-window resize: width="+t+" height="+n+" top="+o+" left="+r),this.form.storeCacheBounds(new Hs(r,o,t,n));var i=new $s(e.width(),e.height());this.htmlComp.setSize(i)}},{key:"isClosed",value:function(){return this.myWindow.closed}},{key:"one",value:function(e,t){this.events.one(e,t)}},{key:"close",value:function(){this.myWindow.close()}},{key:"title",value:function(e){this.myWindow.document.title=e}}])&&ale(t.prototype,n),r&&ale(t,r),e}();function ule(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var cle=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,(n=[{key:"init",value:function(e){this.session=e.session}},{key:"openUri",value:function(e,t){s.a.log.isDebugEnabled()&&s.a.log.debug("(OpenUriHandler#openUri) uri="+e+" action="+t),e&&((t=O.nvl(t,kae.UriAction.OPEN))===kae.UriAction.DOWNLOAD?this.handleUriActionDownload(e):t===kae.UriAction.OPEN?this.handleUriActionOpen(e):t===kae.UriAction.NEW_WINDOW?this.handleUriActionNewWindow(e):t===kae.UriAction.POPUP_WINDOW?this.handleUriActionPopupWindow(e):t===kae.UriAction.SAME_WINDOW&&this.handleUriActionSameWindow(e))}},{key:"handleUriActionDownload",value:function(e){Kt.get().isIos()?Kt.get().isStandalone()?this.openUriInSameWindow(e):this.openUriAsNewWindow(e):Kt.get().browser===Kt.Browser.CHROME?this.openUriInSameWindow(e):this.openUriInIFrame(e)}},{key:"isUriWithExternallyHandledProtocol",value:function(e){return/^(callto|facetime|fax|geo|mailto|maps|notes|sip|skype|tel|google.navigation):/.test(e)}},{key:"handleUriActionOpen",value:function(e){Kt.get().isIos()?this.openUriInSameWindow(e):this.isUriWithExternallyHandledProtocol(e)?Kt.get().browser===Kt.Browser.CHROME?this.openUriInSameWindow(e):this.openUriInIFrame(e):this.openUriAsNewWindow(e)}},{key:"handleUriActionNewWindow",value:function(e){this.openUriAsNewWindow(e)}},{key:"handleUriActionPopupWindow",value:function(e){this.openUriAsPopupWindow(e)}},{key:"handleUriActionSameWindow",value:function(e){this.openUriInSameWindow(e)}},{key:"openUriInSameWindow",value:function(e){window.location.assign(e)}},{key:"openUriInIFrame",value:function(e){var t=this.session.$entryPoint.appendElement("<iframe>","download-frame").attr("tabindex",-1).attr("src",e);setTimeout((function(){t.remove()}),1e4)}},{key:"openUriAsNewWindow",value:function(e){var t=O.create("PopupBlockerHandler",{session:this.session});Kt.get().isInternetExplorer()?t.openWindow(e,null,"location=yes,toolbar=yes,menubar=yes,resizable=yes,scrollbars=yes"):t.openWindow(e)}},{key:"openUriAsPopupWindow",value:function(e){O.create("PopupBlockerHandler",{session:this.session}).openWindow(e,null,"location=no,toolbar=no,menubar=no,resizable=yes,scrollbars=yes")}}])&&ule(t.prototype,n),r&&ule(t,r),e}();function fle(e){return(fle="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function hle(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ple(e,t,n){return(ple="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=mle(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function dle(e,t){return(dle=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function yle(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=mle(e);if(t){var o=mle(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return vle(this,n)}}function vle(e,t){return!t||"object"!==fle(t)&&"function"!=typeof t?ble(e):t}function ble(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function mle(e){return(mle=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function gle(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var _le=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&dle(e,t)}(i,e);var t,n,r,o=yle(i);function i(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(e=o.call(this)).columns=[],e.components=null,e.tabBoxMap={},e._removeViewInProgress=0,e.changingCounter=0,e.changed=!1,e.layoutCacheKey=[],e._desktopOutlineChangeHandler=e._onDesktopOutlineChange.bind(ble(e)),e._desktopPropertyChangeHandler=e._onDesktopPropertyChange.bind(ble(e)),e._outlineNodesSelectedHandler=e._onOutlineNodesSelected.bind(ble(e)),e._outlinePageChangedHandler=e._onOutlinePageChanged.bind(ble(e)),e._outlinePropertyChangeHandler=e._onOutlinePropertyChange.bind(ble(e)),e._outlineContentDestroyHandler=e._onoutlineContentDestroy.bind(ble(e)),e._viewAddHandler=e._onViewAdd.bind(ble(e)),e._viewRemoveHandler=e._onViewRemove.bind(ble(e)),e._viewActivateHandler=e._onViewActivate.bind(ble(e)),e._viewDeactivateHandler=e._onViewDeactivate.bind(ble(e)),e._desktopAnimationEndHandler=e._onDesktopAnimationEnd.bind(ble(e)),e}return t=i,(n=[{key:"_init",value:function(e){ple(mle(i.prototype),"_init",this).call(this,e),i.VIEW_MIN_HEIGHT=s.a.pxToNumber(To.get("view-tab-box","min-height").minHeight),i.VIEW_MIN_WIDTH=s.a.pxToNumber(To.get("view-tab-box","min-width").minWidth),this.desktop=this.session.desktop,this.setLayoutData(this.desktop.benchLayoutData),this._createColumns(),this.headerTabArea=e.headerTabArea,this.headerTabArea&&(this.headerTabAreaController=O.create("HeaderTabBoxController"),this.headerTabAreaController.install(this,this.headerTabArea)),this.outlineContentVisible=O.nvl(e.outlineContentVisible,!0),this.setOutline(this.desktop.outline),this.updateNavigationHandleVisibility()}},{key:"_setTabArea",value:function(e){if(this.headerTabArea=e,this.headerTabAreaController){this.headerTabAreaController.install(this,this.headerTabArea);var t=this.getTabBox("C");t.viewStack.slice().reverse().forEach((function(e){this.headerTabAreaController._onViewAdd({view:e}),t.currentView===e&&this.headerTabAreaController._onViewActivate({view:e})}),this),this.headerTabAreaController._onViewsChanged(),this.validateLayoutTree()}}},{key:"_createColumns",value:function(){var e=[];this.getLayoutData()&&(e=this.getLayoutData().getColumns());for(var t=0;t<3;t++){var n=this.layoutCacheKey.slice();n.length>0&&n.push("column"+t);var r=O.create("BenchColumn",{parent:this,layoutData:e[t],cacheKey:n,cssClass:i.VIEW_AREA_COLUMN_CLASSES[t]});r.on("viewAdd",this._viewAddHandler),r.on("viewRemove",this._viewRemoveHandler),r.on("viewActivate",this._viewActivateHandler),r.on("viewDeactivate",this._viewDeactivateHandler),this.columns.push(r)}}},{key:"_initKeyStrokeContext",value:function(){ple(mle(i.prototype),"_initKeyStrokeContext",this).call(this),this.desktopKeyStrokeContext=new $u,this.desktopKeyStrokeContext.invokeAcceptInputOnActiveValueField=!0,this.desktopKeyStrokeContext.$bindTarget=this.desktop.$container,this.desktopKeyStrokeContext.$scopeTarget=this.desktop.$container,this.desktopKeyStrokeContext.registerKeyStroke(new Yle(this.desktop))}},{key:"_render",value:function(){this.$container=this.$parent.appendDiv("desktop-bench"),this.htmlComp=ea.install(this.$container,this.session),this.htmlComp.setLayout(this._createLayout()),this.htmlComp.layoutData=this.getLayoutData(),this._renderColumns(),this._revalidateSplitters(),this._renderNavigationHandleVisible(),this.session.keyStrokeManager.installKeyStrokeContext(this.desktopKeyStrokeContext),this.desktop.on("propertyChange",this._desktopPropertyChangeHandler),this.desktop.on("outlineChange",this._desktopOutlineChangeHandler),this.desktop.on("animationEnd",this._desktopAnimationEndHandler)}},{key:"_createLayout",value:function(){return new zl(zl.Direction.ROW,this.layoutCacheKey)}},{key:"visibleColumns",value:function(){return this.columns.filter((function(e){return e.hasViews()}))}},{key:"_renderColumns",value:function(){this.visibleColumns().forEach((function(e){this._renderColumn(e)}),this),this.updateFirstLastMarker()}},{key:"_renderColumn",value:function(e){e&&!e.rendered&&e.render()}},{key:"_remove",value:function(){this.desktop.off("propertyChange",this._desktopPropertyChangeHandler),this.desktop.off("outlineChange",this._desktopOutlineChangeHandler),this.desktop.off("animationEnd",this._desktopAnimationEndHandler),this.session.keyStrokeManager.uninstallKeyStrokeContext(this.desktopKeyStrokeContext),ple(mle(i.prototype),"_remove",this).call(this)}},{key:"updateFirstLastMarker",value:function(){me.updateFirstLastMarker(this.visibleColumns())}},{key:"_renderOutlineContent",value:function(){this.outlineContent&&(delete this.outlineContent.title,delete this.outlineContent.subTitle,delete this.outlineContent.iconId,this.addView(this.outlineContent,!this.desktop.inBackground),this.desktop.rendered&&this.session.focusManager.validateFocus())}},{key:"_removeOutlineContent",value:function(){this.outlineContent&&this.removeView(this.outlineContent,!1)}},{key:"_createNavigationHandle",value:function(){return O.create("DesktopNavigationHandle",{parent:this,leftVisible:!1})}},{key:"_renderNavigationHandle",value:function(){this.navigationHandle||(this.navigationHandle=this._createNavigationHandle(),this.navigationHandle.render(),this.navigationHandle.addCssClass("navigation-closed"),this.navigationHandle.on("action",this._onNavigationHandleAction.bind(this)))}},{key:"_removeNavigationHandle",value:function(){this.navigationHandle&&(this.navigationHandle.destroy(),this.navigationHandle=null)}},{key:"_renderNavigationHandleVisible",value:function(){this.navigationHandleVisible?this._renderNavigationHandle():this._removeNavigationHandle(),this.$container.toggleClass("has-navigation-handle",this.navigationHandleVisible)}},{key:"postRender",value:function(){this.columns.forEach((function(e){e.postRender()}))}},{key:"setChanging",value:function(e){e?this.changingCounter++:this.changingCounter--,0===this.changingCounter&&this.changed&&this.rendered&&(this.htmlComp.layout.reset(),this.htmlComp.invalidateLayoutTree(),this.htmlComp.validateLayoutTree(),this.changed=!1)}},{key:"updateLayoutData",value:function(e){var t=this;if(this.getLayoutData()!==e){this.setLayoutData(e);var n=e.getColumns();this.columns.forEach((function(e,r){var o;t.layoutCacheKey&&t.layoutCacheKey.length>0&&(o=t.layoutCacheKey.slice()).push("column"+r),e.updateLayoutData(n[r],o)})),this.rendered&&(this.htmlComp.layout.setCacheKey(this.layoutCacheKey),this.htmlComp.layout.reset(),this.htmlComp.invalidateLayoutTree(),this.htmlComp.validateLayoutTree()),this._updateSplitterMovable()}}},{key:"setLayoutData",value:function(e){this.layoutData!==e&&(ple(mle(i.prototype),"setLayoutData",this).call(this,e),this.layoutData=e,this.layoutCacheKey=[],e.cacheKey&&this.layoutCacheKey.push(e.cacheKey))}},{key:"getLayoutData",value:function(){return this.layoutData}},{key:"setNavigationHandleVisible",value:function(e){this.setProperty("navigationHandleVisible",e)}},{key:"setOutline",value:function(e){this.outline&&(this.outline.off("nodesSelected",this._outlineNodesSelectedHandler),this.outline.off("pageChanged",this._outlinePageChangedHandler),this.outline.off("propertyChange",this._outlinePropertyChangeHandler)),this._setProperty("outline",e),this.outline&&(this.outline.on("nodesSelected",this._outlineNodesSelectedHandler),this.outline.on("pageChanged",this._outlinePageChangedHandler),this.outline.on("propertyChange",this._outlinePropertyChangeHandler)),this.updateOutlineContent()}},{key:"setOutlineContent",value:function(e){var t=this.outlineContent;this.outlineContent!==e&&(t&&t.off("destroy",this._outlineContentDestroyHandler),this.rendered&&this._removeOutlineContent(),e&&e.one("destroy",this._outlineContentDestroyHandler),this._setProperty("outlineContent",e),this.desktop.header&&this.desktop.header.onBenchOutlineContentChange(e,t),this._renderOutlineContent())}},{key:"setOutlineContentVisible",value:function(e){e!==this.outlineContentVisible&&(this._setProperty("outlineContentVisible",e),this.updateOutlineContent())}},{key:"bringToFront",value:function(){this.outlineContent&&this._renderOutlineContent()}},{key:"sendToBack",value:function(){}},{key:"_computeDetailContentForPage",value:function(e){if(!e)throw new Error("called _showDetailContentForPage without node");var t;return e.detailForm&&e.detailFormVisible&&e.detailFormVisibleByUi?(t=e.detailForm).uiCssClass="detail-form":e.detailTable&&e.detailTableVisible&&((t=e.detailTable).uiCssClass="detail-table"),t}},{key:"updateOutlineContent",value:function(){if(this.outlineContentVisible&&this.outline){var e,t=this.outline.selectedNode();(e=t?this._computeDetailContentForPage(t):this.outline._computeRootContent())&&(e instanceof Cx&&e.menuBar.setCssClass("main-menubar"),e.displayViewId="C"),this.setOutlineContent(e)}}},{key:"updateOutlineContentDebounced",value:function(){var e=this;clearTimeout(this._updateOutlineContentTimeout),this._updateOutlineContentTimeout=setTimeout((function(){e.updateOutlineContent()}),300)}},{key:"updateNavigationHandleVisibility",value:function(){this.setNavigationHandleVisible(this.desktop.navigationHandleVisible&&!this.desktop.navigationVisible)}},{key:"_onDesktopOutlineChange",value:function(e){this.setOutline(this.desktop.outline),this.updateNavigationHandleVisibility()}},{key:"_onoutlineContentDestroy",value:function(e){this.setOutlineContent(null)}},{key:"_onOutlineNodesSelected",value:function(e){e.debounce?this.updateOutlineContentDebounced():this.updateOutlineContent()}},{key:"_onOutlinePageChanged",value:function(e){var t=this.outline.selectedNode();(e.page||t)&&e.page!==t||this.updateOutlineContent()}},{key:"_onOutlinePropertyChange",value:function(e){O.isOneOf(e.propertyName,["defaultDetailForm","outlineOverview"])&&this.updateOutlineContent()}},{key:"_onDesktopNavigationVisibleChange",value:function(e){this.desktop.navigationVisible&&this.updateNavigationHandleVisibility()}},{key:"_onDesktopNavigationHandleVisibleChange",value:function(e){this.updateNavigationHandleVisibility()}},{key:"_onDesktopAnimationEnd",value:function(e){this.desktop.navigationVisible||this.updateNavigationHandleVisibility()}},{key:"_onBenchLayoutDataChange",value:function(e){this.updateLayoutData(this.desktop.benchLayoutData)}},{key:"_onDesktopPropertyChange",value:function(e){"navigationVisible"===e.propertyName?this._onDesktopNavigationVisibleChange():"navigationHandleVisible"===e.propertyName&&this._onDesktopNavigationHandleVisibleChange(),"benchLayoutData"===e.propertyName&&this._onBenchLayoutDataChange()}},{key:"_onNavigationHandleAction",value:function(e){this.desktop.enlargeNavigation()}},{key:"_revalidateSplitters",value:function(){var e=this;this.components&&this.components.forEach((function(e){e instanceof Xh&&e.destroy()})),this.components=this.visibleColumns().reduce((function(t,n){if(t.length>0){var r=O.create("Splitter",{parent:e,$anchor:t[t.length-1].$container,$root:e.$container,maxRatio:1});r.render(),r.setLayoutData(Ul.fixed().withOrder(n.getLayoutData().order-1)),r.$container.addClass("line"),t.push(r)}return t.push(n),t}),[]),this.components.filter((function(e){return e instanceof Ele})).reduce((function(e,t,n){return n>0&&t.$container.insertAfter(e.$container),t}),void 0),this._updateSplitterMovable()}},{key:"_updateSplitterMovable",value:function(){var e=this;this.components&&this.components.forEach((function(t,n){if(t instanceof Xh){var r=e.components.slice(0,n).reverse(),o=e.components.slice(n+1);if(r.filter((function(e){return e.getLayoutData().shrink>0})).length>0&&o.filter((function(e){return e.getLayoutData().grow>0})).length>0)return t.setEnabled(!0),void t.on("move",e._onSplitterMove.bind(e));if(r.filter((function(e){return e.getLayoutData().grow>0})).length>0&&o.filter((function(e){return e.getLayoutData().shrink>0})).length>0)return t.setEnabled(!0),void t.on("move",e._onSplitterMove.bind(e));t.setEnabled(!1)}}))}},{key:"_onSplitterMove",value:function(e){var t=e.source,n=e.position-t.htmlComp.location().x-t.htmlComp.margins().left-t.htmlComp.insets().left;t.getLayoutData().diff=n,this.revalidateLayout(),t.getLayoutData().diff=null,e.preventDefault()}},{key:"_onViewAdd",value:function(e){this.trigger("viewAdd",{view:e.view})}},{key:"_onViewRemove",value:function(e){this.trigger("viewRemove",{view:e.view})}},{key:"_onViewActivate",value:function(e){var t=e.view;this.outlineContent===t&&this.desktop.bringOutlineToFront(),this.trigger("viewActivate",{view:t})}},{key:"_onViewDeactivate",value:function(e){this.outlineContent===e.view&&this.desktop.sendOutlineToBack(),this.trigger("viewDeactivate",{view:e.view})}},{key:"addView",value:function(e,t){switch(e.displayViewId){case"NW":case"W":case"SW":case"N":case"C":case"S":case"NE":case"E":case"SE":break;default:e.displayViewId="C"}var n=this._getColumn(e.displayViewId);this.tabBoxMap[e.id]=n,n.addView(e,t),this.rendered&&1===n.viewCount()&&(this._renderColumn(n),this._revalidateSplitters(),this.updateFirstLastMarker(),this.changingCounter>0?this.changed=!0:(this.htmlComp.layout.reset(),this.htmlComp.invalidateLayoutTree(),this.htmlComp.validateLayoutTree()))}},{key:"activateView",value:function(e){if(this.hasView(e)){var t=this._getColumn(e.displayViewId);t&&t.activateView(e)}}},{key:"_getColumn",value:function(e){var t;switch(e){case"NW":case"W":case"SW":t=this.columns[i.VIEW_AREA_COLUMN_INDEX.LEFT];break;case"NE":case"E":case"SE":t=this.columns[i.VIEW_AREA_COLUMN_INDEX.RIGHT];break;default:t=this.columns[i.VIEW_AREA_COLUMN_INDEX.CENTER]}return t}},{key:"removeView",value:function(e,t){var n=this.tabBoxMap[e.id];n&&(this._removeViewInProgress++,n.removeView(e,t),this._removeViewInProgress--,delete this.tabBoxMap[e.id],this.rendered&&0===n.viewCount()&&0===this._removeViewInProgress&&(n.remove(),this._revalidateSplitters(),this.updateFirstLastMarker(),this.changingCounter>0?this.changed=!0:(this.htmlComp.layout.reset(),this.htmlComp.invalidateLayoutTree(),this.htmlComp.validateLayoutTree())))}},{key:"getComponents",value:function(){return this.components}},{key:"getTabBox",value:function(e){var t=this._getColumn(e);if(t)return t.getTabBox(e)}},{key:"visibleTabBoxes",value:function(){return this.visibleColumns().reduce((function(e,t){return rt.pushAll(e,t.visibleTabBoxes()),e}),[])}},{key:"hasView",value:function(e){return this.columns.filter((function(t){return t.hasView(e)})).length>0}},{key:"getViews",value:function(e){return this.columns.reduce((function(t,n){return rt.pushAll(t,n.getViews(e)),t}),[])}},{key:"getViewTab",value:function(e){var t=null;return this.getTabs().some((function(n){return n.view===e&&(t=n,!0)})),t}},{key:"getTabs",value:function(){var e=[];return e=(e=(e=(e=e.concat(this.getTabBox("NW").getController().getTabs())).concat(this.getTabBox("W").getController().getTabs())).concat(this.getTabBox("SW").getController().getTabs())).concat(this.getTabBox("N").getController().getTabs()),e=(e=(e=(e=(e=this.headerTabAreaController?e.concat(this.headerTabAreaController.getTabs()):e.concat(this.getTabBox("C").getController().getTabs())).concat(this.getTabBox("S").getController().getTabs())).concat(this.getTabBox("NE").getController().getTabs())).concat(this.getTabBox("E").getController().getTabs())).concat(this.getTabBox("SE").getController().getTabs())}},{key:"activeViews",value:function(){var e=[];return this.visibleColumns().forEach((function(t){t.visibleTabBoxes().forEach((function(t){e.push(t.currentView)}))})),e}}])&&hle(t.prototype,n),r&&hle(t,r),i}(ve);function wle(e){return(wle="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function kle(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Sle(e,t,n){return(Sle="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Rle(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function Ole(e,t){return(Ole=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Tle(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Rle(e);if(t){var o=Rle(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Cle(this,n)}}function Cle(e,t){return!t||"object"!==wle(t)&&"function"!=typeof t?Ple(e):t}function Ple(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Rle(e){return(Rle=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function xle(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}gle(_le,"VIEW_MIN_HEIGHT",null),gle(_le,"VIEW_MIN_WIDTH",null),gle(_le,"VIEW_AREA_COLUMN_INDEX",{LEFT:0,CENTER:1,RIGHT:2}),gle(_le,"VIEW_AREA_COLUMN_CLASSES",["west","center","east"]);var Ele=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ole(e,t)}(i,e);var t,n,r,o=Tle(i);function i(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(e=o.call(this)).tabBoxes=[],e._widgetToTabBox={},e.components=null,e._removeViewInProgress=0,e.layoutData,e._viewAddHandler=e._onViewAdd.bind(Ple(e)),e._viewRemoveHandler=e._onViewRemove.bind(Ple(e)),e._viewActivateHandler=e._onViewActivate.bind(Ple(e)),e._viewDeactivateHandler=e._onViewDeactivate.bind(Ple(e)),e}return t=i,(n=[{key:"_init",value:function(e){Sle(Rle(i.prototype),"_init",this).call(this,e),this.layoutData=e.layoutData,this.layoutCacheKey=e.cacheKey,this.cssClass=e.cssClass,this._createTabBoxes()}},{key:"_keyStrokeBindTarget",value:function(){return this.$container}},{key:"_render",value:function(){this.$container=this.$parent.appendDiv("bench-column"),this.cssClass&&this.$container.addClass(this.cssClass),this.htmlComp=ea.install(this.$container,this.session),this.htmlComp.setLayout(this._createLayout()),this.htmlComp.layoutData=this.getLayoutData()}},{key:"_renderProperties",value:function(){Sle(Rle(i.prototype),"_renderProperties",this).call(this),this._renderTabBoxes(),this._revalidateSplitters()}},{key:"_renderTabBoxes",value:function(){var e=this;this.visibleTabBoxes().forEach((function(t){e._renderTabBox(t)})),this.updateFirstLastMarker()}},{key:"_renderTabBox",value:function(e){e.rendered||e.render()}},{key:"postRender",value:function(){this.tabBoxes.forEach((function(e){e.postRender()}))}},{key:"_createLayout",value:function(){return new zl(zl.Direction.COLUMN,this.layoutCacheKey)}},{key:"updateLayoutData",value:function(e,t){if(this.getLayoutData()!==e){this.layoutCacheKey=t,this.setLayoutData(e);var n=this.layoutData.getRows();this.tabBoxes.forEach((function(e,t){e.setLayoutData(n[t])})),this._updateSplitterMovable(),this.rendered&&(this.htmlComp.layout.setCacheKey(this.layoutCacheKey),this.htmlComp.layout.reset(),this.htmlComp.invalidateLayoutTree())}}},{key:"setLayoutData",value:function(e){Sle(Rle(i.prototype),"setLayoutData",this).call(this,e),this.layoutData=e}},{key:"getLayoutData",value:function(){return this.layoutData}},{key:"_onViewAdd",value:function(e){this.trigger("viewAdd",{view:e.view})}},{key:"_onViewRemove",value:function(e){this.trigger("viewRemove",{view:e.view})}},{key:"_onViewActivate",value:function(e){this.trigger("viewActivate",{view:e.view})}},{key:"_onViewDeactivate",value:function(e){this.trigger("viewDeactivate",{view:e.view})}},{key:"activateView",value:function(e){this.getTabBox(e.displayViewId).activateView(e)}},{key:"_createTabBoxes",value:function(){var e=[];this.layoutData&&(e=this.layoutData.getRows());for(var t=0;t<3;t++){var n=O.create("SimpleTabBox",{parent:this,cssClass:Wn.join(" ","view-tab-box",i.TAB_BOX_CLASSES[t]),controller:O.create("DesktopTabBoxController")});n.setLayoutData(e[t]),n.on("viewAdd",this._viewAddHandler),n.on("viewRemove",this._viewRemoveHandler),n.on("viewActivate",this._viewActivateHandler),n.on("viewDeactivate",this._viewDeactivateHandler),this.tabBoxes.push(n)}}},{key:"_revalidateSplitters",value:function(e){var t=this;this.components&&this.components.forEach((function(e){e instanceof Xh&&e.destroy()})),this.components=this.visibleTabBoxes().reduce((function(e,n){if(e.length>0){var r=O.create("Splitter",{parent:t,$anchor:e[e.length-1].$container,$root:t.$container,splitHorizontal:!1,maxRatio:1});r.render(),r.setLayoutData(Ul.fixed().withOrder(n.getLayoutData().order-1)),r.$container.addClass("line"),e.push(r)}return e.push(n),e}),[]),this.components.filter((function(e){return e instanceof nu})).reduce((function(e,t,n){return n>0&&t.$container.insertAfter(e.$container),t}),void 0),this._updateSplitterMovable()}},{key:"_updateSplitterMovable",value:function(){var e=this;this.components&&this.components.forEach((function(t,n){if(t instanceof Xh){var r=e.components.slice(0,n).reverse(),o=e.components.slice(n+1);if(r.filter((function(e){return e.getLayoutData().shrink>0})).length>0&&o.filter((function(e){return e.getLayoutData().grow>0})).length>0)return t.setEnabled(!0),void t.on("move",e._onSplitterMove.bind(e));if(r.filter((function(e){return e.getLayoutData().grow>0})).length>0&&o.filter((function(e){return e.getLayoutData().shrink>0})).length>0)return t.setEnabled(!0),void t.on("move",e._onSplitterMove.bind(e));t.setEnabled(!1)}}))}},{key:"_onSplitterMove",value:function(e){var t=e.source,n=e.position-t.htmlComp.location().y-t.htmlComp.margins().top-t.htmlComp.insets().top;t.getLayoutData().diff=n,this.revalidateLayout(),t.getLayoutData().diff=null,e.preventDefault()}},{key:"addView",value:function(e,t){var n=this.getTabBox(e.displayViewId);this._widgetToTabBox[e.id]=n,n.addView(e,t),this.rendered&&1===n.viewCount()&&(n.rendered||n.render(),this._revalidateSplitters(!0),this.updateFirstLastMarker(),this.htmlComp.layout.reset(),this.htmlComp.invalidateLayoutTree())}},{key:"getTabBox",value:function(e){var t;switch(e){case"NW":case"N":case"NE":t=this.tabBoxes[i.TAB_BOX_INDEX.TOP];break;case"SW":case"S":case"SE":t=this.tabBoxes[i.TAB_BOX_INDEX.BOTTOM];break;default:t=this.tabBoxes[i.TAB_BOX_INDEX.CENTER]}return t}},{key:"removeView",value:function(e,t){var n=this._widgetToTabBox[e.id];n&&(this._removeViewInProgress++,n.removeView(e,t),this._removeViewInProgress--,delete this._widgetToTabBox[e.id],this.rendered&&0===n.viewCount()&&0===this._removeViewInProgress&&(n.remove(),this._revalidateSplitters(!0),this.updateFirstLastMarker(),this.htmlComp.layout.reset(),this.htmlComp.invalidateLayoutTree()))}},{key:"viewCount",value:function(){return this.tabBoxes.map((function(e){return e.viewCount()})).reduce((function(e,t){return e+t}),0)}},{key:"hasView",value:function(e){return this.tabBoxes.filter((function(t){return t.hasView(e)})).length>0}},{key:"hasViews",value:function(){return this.viewCount()>0}},{key:"getViews",value:function(e){return this.tabBoxes.reduce((function(t,n){return rt.pushAll(t,n.getViews(e)),t}),[])}},{key:"getComponents",value:function(){return this.components}},{key:"visibleTabBoxes",value:function(){return this.tabBoxes.filter((function(e){return e.hasViews()}))}},{key:"updateFirstLastMarker",value:function(){me.updateFirstLastMarker(this.visibleTabBoxes())}}])&&kle(t.prototype,n),r&&kle(t,r),i}(ve);function Dle(e){return(Dle="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ale(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Fle(e,t,n){return(Fle="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Mle(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function $le(e,t){return($le=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function jle(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Mle(e);if(t){var o=Mle(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Ble(this,n)}}function Ble(e,t){return!t||"object"!==Dle(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Mle(e){return(Mle=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}xle(Ele,"TAB_BOX_INDEX",{TOP:0,CENTER:1,BOTTOM:2}),xle(Ele,"TAB_BOX_CLASSES",["north","center","south"]);var Ile=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&$le(e,t)}(i,e);var t,n,r,o=jle(i);function i(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(t=o.call(this,e))._ensureRows(),t}return t=i,(n=[{key:"_prepare",value:function(){Fle(Mle(i.prototype),"_prepare",this).call(this),this.rows=[null,null,null]}},{key:"getRows",value:function(){return this.rows}},{key:"_ensureRows",value:function(){this.rows=this.rows.map((function(e,t){return new Ul(e).withOrder(2*t)}))}},{key:"updateVisibilities",value:function(e){var t=this;e.forEach((function(e,n){t.rows[n].visible=e.rendered}))}}])&&Ale(t.prototype,n),r&&Ale(t,r),i}(Ul);function Lle(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Hle=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.columns=[null,null,null],s.a.extend(this,t),this._ensureColumns()}var t,n,r;return t=e,r=[{key:"ensure",value:function(t){return t?t instanceof e?t:new e(t):t=new e}}],(n=[{key:"_ensureColumns",value:function(){this.columns=this.columns.map((function(e,t){return new Ile(e).withOrder(2*t)}))}},{key:"getColumns",value:function(){return this.columns}}])&&Lle(t.prototype,n),r&&Lle(t,r),e}();function Nle(e){return(Nle="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Vle(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Wle(e,t,n){return(Wle="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=qle(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function zle(e,t){return(zle=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Gle(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=qle(e);if(t){var o=qle(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Ule(this,n)}}function Ule(e,t){return!t||"object"!==Nle(t)&&"function"!=typeof t?Kle(e):t}function Kle(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function qle(e){return(qle=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Yle=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&zle(e,t)}(i,e);var t,n,r,o=Gle(i);function i(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(t=o.call(this)).field=e,t.parseAndSetKeyStroke(e.selectViewTabsKeyStrokeModifier),t.registerRange(Ou[1],(function(){return Ou[Math.min(t._viewTabs().length,9)]})),t.renderingHints.hAlign=Do.RIGHT,t.renderingHints.$drawingArea=function(e,t){var n=t.which-Ou[1];return this._viewTabs()[n].$container}.bind(Kle(t)),t}return t=i,(n=[{key:"_isEnabled",value:function(){return Wle(qle(i.prototype),"_isEnabled",this).call(this)&&this.field.selectViewTabsKeyStrokesEnabled&&this._viewTabs().length>0}},{key:"handle",value:function(e){var t=e.which-Ou[1];if(this._viewTabs().length&&t<this._viewTabs().length){var n=this._viewTabs()[t];this.field.bench&&this.field.bench.activateView(n.view)}}},{key:"_viewTabs",value:function(){return this.field.bench?this.field.bench.getTabs():[]}}])&&Vle(t.prototype,n),r&&Vle(t,r),i}(Ju);function Xle(e){return(Xle="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Jle(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Zle(e,t,n){return(Zle="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=nue(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function Qle(e,t){return(Qle=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function eue(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=nue(e);if(t){var o=nue(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return tue(this,n)}}function tue(e,t){return!t||"object"!==Xle(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function nue(e){return(nue=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var rue=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Qle(e,t)}(i,e);var t,n,r,o=eue(i);function i(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(t=o.call(this)).field=e,t.parseAndSetKeyStroke(e.selectViewTabsKeyStrokeModifier),t.registerRange(Ou[1],Ou[9]),t.renderingHints.render=!1,t.preventDefault=!0,t}return t=i,(n=[{key:"_isEnabled",value:function(){return Zle(nue(i.prototype),"_isEnabled",this).call(this)&&this.field.selectViewTabsKeyStrokesEnabled}},{key:"handle",value:function(e){}}])&&Jle(t.prototype,n),r&&Jle(t,r),i}(Ju);function oue(e){return(oue="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function iue(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function sue(e,t,n){return(sue="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=fue(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function aue(e,t){return(aue=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function lue(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=fue(e);if(t){var o=fue(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return uue(this,n)}}function uue(e,t){return!t||"object"!==oue(t)&&"function"!=typeof t?cue(e):t}function cue(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function fue(e){return(fue=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var hue=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&aue(e,t)}(i,e);var t,n,r,o=lue(i);function i(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(e=o.call(this)).tabArea=null,e.toolBoxVisible=!0,e.viewButtonBox=null,e.viewButtonBoxVisible=!1,e._desktopPropertyChangeHandler=e._onDesktopPropertyChange.bind(cue(e)),e._desktopAnimationEndHandler=e._onDesktopAnimationEnd.bind(cue(e)),e._outlineContentMenuBarPropertyChangeHandler=e._onOutlineContentMenuBarPropertyChange.bind(cue(e)),e._viewButtonBoxPropertyChangeHandler=e._onViewButtonBoxPropertyChange.bind(cue(e)),e}return t=i,(n=[{key:"_init",value:function(e){sue(fue(i.prototype),"_init",this).call(this,e),this.desktop=this.session.desktop,this.updateViewButtonBoxVisibility(),this.tabArea=this._createTabArea()}},{key:"_createTabArea",value:function(){return O.create("SimpleTabArea",$.extend({parent:this},this.tabArea))}},{key:"_render",value:function(){this.$container=this.$parent.appendDiv("desktop-header"),this.htmlComp=ea.install(this.$container,this.session),this.htmlComp.setLayout(new Rue(this)),this._renderViewButtonBoxVisible(),this._renderViewTabs(),this._renderToolBoxVisible(),this._renderLogoUrl(),this._renderInBackground(),this.desktop.on("propertyChange",this._desktopPropertyChangeHandler),this.desktop.on("animationEnd",this._desktopAnimationEndHandler),this.desktop.bench&&(this.outlineContent=this.desktop.bench.outlineContent),this._attachOutlineContentMenuBarHandler()}},{key:"_remove",value:function(){this.desktop.off("propertyChange",this._desktopPropertyChangeHandler),this.desktop.off("animationEnd",this._desktopAnimationEndHandler),this._detachOutlineContentMenuBarHandler(),this.outlineContent=null,sue(fue(i.prototype),"_remove",this).call(this)}},{key:"_renderViewTabs",value:function(){this.tabArea.render()}},{key:"_renderToolBox",value:function(){this.toolBox||(this.toolBox=this._createToolBox(),this.toolBox.render())}},{key:"_createToolBox",value:function(){return O.create("DesktopToolBox",{parent:this,menus:this.desktop.menus})}},{key:"_removeToolBox",value:function(){this.toolBox&&(this.toolBox.destroy(),this.toolBox=null)}},{key:"_renderToolBoxVisible",value:function(){this.toolBoxVisible?this._renderToolBox():this._removeToolBox(),this.invalidateLayoutTree()}},{key:"_renderLogoUrl",value:function(){this.logoUrl?this._renderLogo():this._removeLogo(),this.invalidateLayoutTree()}},{key:"_renderLogo",value:function(){this.desktop.displayStyle!==kae.DisplayStyle.COMPACT&&(this.logo?this.logo.setUrl(this.logoUrl):(this.logo=this._createLogo(),this.logo.render()))}},{key:"_createLogo",value:function(){return O.create("DesktopLogo",{parent:this,url:this.logoUrl})}},{key:"_removeLogo",value:function(){this.logo&&(this.logo.destroy(),this.logo=null)}},{key:"_renderViewButtonBox",value:function(){this.viewButtonBox||(this.viewButtonBox=this._createViewButtonBox(),this.viewButtonBox.on("propertyChange",this._viewButtonBoxPropertyChangeHandler),this.viewButtonBox.render(),this.viewButtonBox.$container.prependTo(this.$container),this.desktop.inBackground&&this.viewButtonBox.sendToBack(),this.updateViewButtonStyling())}},{key:"_createViewButtonBox",value:function(){return O.create("ViewButtonBox",{parent:this,viewButtons:this.desktop.viewButtons})}},{key:"_removeViewButtonBox",value:function(){this.viewButtonBox&&(this.viewButtonBox.off("propertyChange",this._viewButtonBoxPropertyChangeHandler),this.viewButtonBox.destroy(),this.viewButtonBox=null)}},{key:"_renderViewButtonBoxVisible",value:function(){this.viewButtonBoxVisible?this._renderViewButtonBox():this._removeViewButtonBox(),this.invalidateLayoutTree()}},{key:"sendToBack",value:function(){this.viewButtonBox&&this.viewButtonBox.sendToBack(),this.rendered&&this._renderInBackground()}},{key:"bringToFront",value:function(){this.viewButtonBox&&this.viewButtonBox.bringToFront(),this.rendered&&this._renderInBackground()}},{key:"_renderInBackground",value:function(){this.$container.toggleClass("in-background",this.desktop.inBackground)}},{key:"setLogoUrl",value:function(e){this.setProperty("logoUrl",e)}},{key:"setToolBoxVisible",value:function(e){this.setProperty("toolBoxVisible",e)}},{key:"setViewButtonBoxVisible",value:function(e){this.setProperty("viewButtonBoxVisible",e)}},{key:"setMenus",value:function(e){this.toolBox&&this.toolBox.setMenus(e)}},{key:"updateViewButtonBoxVisibility",value:function(){this.setViewButtonBoxVisible(this.desktop.viewButtons.length>0&&!this.desktop.navigationVisible&&this.desktop.displayStyle!==kae.DisplayStyle.COMPACT)}},{key:"_attachOutlineContentMenuBarHandler",value:function(){if(this.outlineContent){var e=this._outlineContentMenuBar(this.outlineContent);e&&e.on("propertyChange",this._outlineContentMenuBarPropertyChangeHandler)}}},{key:"_detachOutlineContentMenuBarHandler",value:function(){if(this.outlineContent){var e=this._outlineContentMenuBar(this.outlineContent);e&&e.off("propertyChange",this._outlineContentMenuBarPropertyChangeHandler)}}},{key:"_outlineContentMenuBar",value:function(e){return e instanceof CC?e.rootGroupBox.menuBar:e.menuBar}},{key:"updateViewButtonStyling",value:function(){if(this.viewButtonBoxVisible&&this.desktop.bench&&this.desktop.bench.outlineContentVisible){var e=this.desktop.bench.outlineContent;if(e){var t=!1;if(e instanceof CC&&e.detailForm){var n=e.rootGroupBox;t=n.menuBar&&n.menuBarVisible&&n.menuBar.visible}else t=e.menuBar&&e.menuBar.visible;this.$container.toggleClass("outline-content-has-menubar",!!t)}}}},{key:"_onDesktopNavigationVisibleChange",value:function(e){this.desktop.navigationVisible&&this.updateViewButtonBoxVisibility()}},{key:"_onDesktopAnimationEnd",value:function(e){this.updateViewButtonBoxVisibility()}},{key:"onBenchOutlineContentChange",value:function(e){this._detachOutlineContentMenuBarHandler(),this.outlineContent=e,this.updateViewButtonStyling(),this._attachOutlineContentMenuBarHandler()}},{key:"_onDesktopPropertyChange",value:function(e){"navigationVisible"===e.propertyName&&this._onDesktopNavigationVisibleChange()}},{key:"_onOutlineContentMenuBarPropertyChange",value:function(e){"visible"===e.propertyName&&this.updateViewButtonStyling()}},{key:"_onViewButtonBoxPropertyChange",value:function(e){"menuButtons"!==e.propertyName&&"tabButtons"!==e.propertyName||this.invalidateLayoutTree()}}])&&iue(t.prototype,n),r&&iue(t,r),i}(ve);function pue(e){return(pue="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function due(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function yue(e,t,n){return(yue="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=_ue(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function vue(e,t){return(vue=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function bue(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=_ue(e);if(t){var o=_ue(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return mue(this,n)}}function mue(e,t){return!t||"object"!==pue(t)&&"function"!=typeof t?gue(e):t}function gue(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _ue(e){return(_ue=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var wue=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&vue(e,t)}(i,e);var t,n,r,o=bue(i);function i(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(e=o.call(this)).bench=null,e._viewsChangedHandler=e._onViewsChanged.bind(gue(e)),e.tabAreaCenter=null,e.tabAreaInHeader=!1,e}return t=i,(n=[{key:"install",value:function(e,t){this.bench=O.assertParameter("bench",e);var n=this.bench.getTabBox("C");this.tabAreaCenter=n.tabArea,yue(_ue(i.prototype),"install",this).call(this,n,t)}},{key:"_installListeners",value:function(){yue(_ue(i.prototype),"_installListeners",this).call(this),this.bench.on("viewAdd",this._viewsChangedHandler),this.bench.on("viewRemove",this._viewsChangedHandler)}},{key:"_onViewsChanged",value:function(){this.bench.getViews().some((function(e){return"C"!==e.displayViewId}))?this._setViewTabAreaInHeader(!1):this._setViewTabAreaInHeader(!0)}},{key:"_setViewTabAreaInHeader",value:function(e){this.tabAreaInHeader=e,this.tabAreaCenter.setVisible(!e),this.tabArea.setVisible(e)}},{key:"getTabs",value:function(){return this.tabAreaInHeader?this.tabArea.getTabs():this.tabAreaCenter.getTabs()}}])&&due(t.prototype,n),r&&due(t,r),i}(Qae);function kue(e){return(kue="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Sue(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Oue(e,t){return(Oue=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Tue(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Pue(e);if(t){var o=Pue(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Cue(this,n)}}function Cue(e,t){return!t||"object"!==kue(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Pue(e){return(Pue=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Rue=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Oue(e,t)}(i,e);var t,n,r,o=Tue(i);function i(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(t=o.call(this)).header=e,t.desktop=e.desktop,t}return t=i,(n=[{key:"layout",value:function(e){var t,n,r,o,i=this.header.htmlComp,s=i.size(),a=this.header.toolBox,l=this.header.viewButtonBox,u=this.header.tabArea,c=0,f=0,h=0,p=0;if(s=s.subtract(i.insets()),this.header.logo&&(f=qs.size(this.header.logo.$container,!0).width),l&&(t=l.htmlComp.prefSize(),h=t.width,l.htmlComp.setSize(t.subtract(l.htmlComp.margins()))),u.htmlComp.$comp.cssLeft(h),a&&(n=a.htmlComp.prefSize(),p=n.width,v(),b()),c=d(),o=u.htmlComp.layout.smallPrefSize({widthHint:c}),r=u.htmlComp.prefSize({widthHint:c}),c>=o.width)return c=Math.min(r.width,c),void u.htmlComp.setSize(new $s(c,r.height));if(a&&(n=a.htmlComp.layout.compactPrefSize(),p=n.width,v(),b()),(c=d())>=o.width)return u.htmlComp.setSize(o),void y();function d(){return s.width-p-f-h}function y(){u.htmlComp.setSize(new $s(c,r.height))}function v(){a.htmlComp.setSize(new $s(p,n.height).subtract(a.htmlComp.margins()))}function b(){a.htmlComp.$comp.cssLeft(s.width-p-f)}a&&(n=a.htmlComp.layout.shrinkPrefSize(),p=n.width,v(),b()),c=d(),u.displayStyle!==Upe.DisplayStyle.SPREAD_EVEN&&(c=Math.min(o.width,c)),c=Math.max(c,u.tabs.length?ede.OVERFLOW_MENU_WIDTH:0),y(),a&&c<=ede.OVERFLOW_MENU_WIDTH&&(p=s.width-c-f-h,v(),p=a.htmlComp.layout.actualPrefSize().width,v(),b())}}])&&Sue(t.prototype,n),r&&Sue(t,r),i}(Zs);function xue(e){return(xue="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Eue(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Due(e,t,n){return(Due="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Bue(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function Aue(e,t){return(Aue=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Fue(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Bue(e);if(t){var o=Bue(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return $ue(this,n)}}function $ue(e,t){return!t||"object"!==xue(t)&&"function"!=typeof t?jue(e):t}function jue(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Bue(e){return(Bue=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Mue(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Iue=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Aue(e,t)}(i,e);var t,n,r,o=Fue(i);function i(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(e=o.call(this)).$body=null,e.layoutData={},e.toolBoxVisible=!1,e.viewButtonBox=null,e._outlinePropertyChangeHandler=e._onOutlinePropertyChange.bind(jue(e)),e._desktopPropertyChangeHandler=e._onDesktopPropertyChange.bind(jue(e)),e._viewButtonBoxPropertyChangeHandler=e._onViewButtonBoxPropertyChange.bind(jue(e)),e}return t=i,(n=[{key:"_init",value:function(e){Due(Bue(i.prototype),"_init",this).call(this,e),i.MIN_WIDTH=To.getSize("desktop-navigation","min-width","minWidth",49),i.DEFAULT_STYLE_WIDTH=To.getSize("desktop-navigation","width","width",290),i.BREADCRUMB_STYLE_WIDTH=To.getSize("desktop-navigation-breadcrumb","width","width",240),this.desktop=this.parent,this.updateHandleVisibility(),this._setOutline(e.outline),this.viewButtonBox=O.create("ViewButtonBox",{parent:this,viewButtons:this.desktop.viewButtons,singleViewButton:this.singleViewButton}),this.viewButtonBox.on("propertyChange",this._viewButtonBoxPropertyChangeHandler),this._updateSingleViewButton()}},{key:"_render",value:function(){this.$container=this.$parent.appendDiv("desktop-navigation"),this.htmlComp=ea.install(this.$container,this.session),this.htmlComp.setLayout(new Que(this)),this.htmlComp.layoutData=this.layoutData,this.$body=this.$container.appendDiv("navigation-body").on("mousedown",this._onNavigationBodyMouseDown.bind(this)),this.htmlCompBody=ea.install(this.$body,this.session),this.htmlCompBody.setLayout(new Ml(null,{exact:!0})),this.desktop.on("propertyChange",this._desktopPropertyChangeHandler)}},{key:"_remove",value:function(){this.desktop.off("propertyChange",this._desktopPropertyChangeHandler),Due(Bue(i.prototype),"_remove",this).call(this)}},{key:"_renderProperties",value:function(){Due(Bue(i.prototype),"_renderProperties",this).call(this),this._renderViewButtonBox(),this._renderToolBoxVisible(),this._renderOutline(),this._renderHandleVisible(),this._renderSingleViewButton()}},{key:"_renderViewButtonBox",value:function(){this.viewButtonBox.render()}},{key:"_removeOutline",value:function(){this.outline&&this.outline.remove()}},{key:"_renderOutline",value:function(){this.outline&&(this.outline.render(this.$body),this.outline.invalidateLayoutTree(),this.rendered&&(this.outline.validateLayoutTree(),this.outline.validateFocus()))}},{key:"setOutline",value:function(e){this.setProperty("outline",e)}},{key:"_setOutline",value:function(e){var t=this.outline;this.outline&&this.outline.off("propertyChange",this._outlinePropertyChangeHandler),this.rendered&&this._removeOutline(),this.outline=e,this.outline&&(this.outline.setIconVisible(this.singleViewButton),this.outline.setParent(this),this.outline.setBreadcrumbTogglingThreshold(i.BREADCRUMB_STYLE_WIDTH),this.outline.toggleBreadcrumbStyleEnabled&&t&&t.toggleBreadcrumbStyleEnabled&&t.displayStyle&&this.outline.setDisplayStyle(t.displayStyle),this.outline.inBackground=this.desktop.inBackground,this.outline.on("propertyChange",this._outlinePropertyChangeHandler),this._updateHandle())}},{key:"_updateSingleViewButton",value:function(){if(this.desktop.displayStyle!==kae.DisplayStyle.COMPACT){var e=this.viewButtonBox.menuButtons.length,t=this.viewButtonBox.tabButtons.length;e+t>1?(e>0&&t++,this.setSingleViewButton(t<2)):this.setSingleViewButton(!1)}else this.setSingleViewButton(!1)}},{key:"setSingleViewButton",value:function(e){this.setProperty("singleViewButton",e),this.outline&&this.outline.setIconVisible(this.singleViewButton),this.viewButtonBox.setMenuTabVisible(!e)}},{key:"_renderSingleViewButton",value:function(){this.$container.toggleClass("single-view-button",this.singleViewButton),this.invalidateLayoutTree()}},{key:"sendToBack",value:function(){this.viewButtonBox&&this.viewButtonBox.sendToBack(),this.outline&&this.outline.sendToBack()}},{key:"bringToFront",value:function(){this.viewButtonBox&&this.viewButtonBox.bringToFront(),this.outline&&this.outline.bringToFront()}},{key:"setToolBoxVisible",value:function(e){this.setProperty("toolBoxVisible",e)}},{key:"setHandleVisible",value:function(e){this.setProperty("handleVisible",e)}},{key:"_updateHandle",value:function(){this.handle&&this.handle.setRightVisible(this.outline&&this.outline.toggleBreadcrumbStyleEnabled&&this.desktop.outlineDisplayStyle()===KH.DisplayStyle.BREADCRUMB)}},{key:"updateHandleVisibility",value:function(){this.setHandleVisible(this.desktop.navigationHandleVisible)}},{key:"_renderToolBoxVisible",value:function(){this.toolBoxVisible?this._renderToolBox():this._removeToolBox()}},{key:"_renderToolBox",value:function(){this.toolBox||(this.toolBox=O.create("DesktopToolBox",{parent:this,menus:this.desktop.menus}),this.toolBox.render())}},{key:"_removeToolBox",value:function(){this.toolBox&&(this.toolBox.destroy(),this.toolBox=null)}},{key:"_renderHandleVisible",value:function(){this.handleVisible?this._renderHandle():this._removeHandle()}},{key:"_createHandle",value:function(){return O.create("DesktopNavigationHandle",{parent:this,rightVisible:!1,horizontalAlignment:Hf.HorizontalAlignment.RIGHT})}},{key:"_renderHandle",value:function(){this.handle||(this.handle=this._createHandle(),this.handle.render(),this.handle.addCssClass("navigation-open"),this.handle.on("action",this._onHandleAction.bind(this)),this._updateHandle())}},{key:"_removeHandle",value:function(){this.handle&&(this.handle.destroy(),this.handle=null)}},{key:"_onNavigationBodyMouseDown",value:function(e){this.desktop.bringOutlineToFront()}},{key:"_onViewButtonBoxPropertyChange",value:function(e){"menuButtons"!==e.propertyName&&"tabButtons"!==e.propertyName||this._updateSingleViewButton()}},{key:"_onOutlinePropertyChange",value:function(e){"displayStyle"===e.propertyName&&this._updateHandle()}},{key:"_onDesktopPropertyChange",value:function(e){"navigationHandleVisible"===e.propertyName&&this.updateHandleVisibility()}},{key:"_onHandleAction",value:function(e){e.left?this.desktop.shrinkNavigation():this.desktop.enlargeNavigation()}}])&&Eue(t.prototype,n),r&&Eue(t,r),i}(ve);function Lue(e){return(Lue="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Hue(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Nue(e,t,n){return(Nue="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Gue(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function Vue(e,t){return(Vue=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Wue(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Gue(e);if(t){var o=Gue(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return zue(this,n)}}function zue(e,t){return!t||"object"!==Lue(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Gue(e){return(Gue=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}Mue(Iue,"DEFAULT_STYLE_WIDTH",null),Mue(Iue,"BREADCRUMB_STYLE_WIDTH",null),Mue(Iue,"MIN_WIDTH",null);var Uue=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Vue(e,t)}(i,e);var t,n,r,o=Wue(i);function i(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),o.call(this)}return t=i,(n=[{key:"_initKeyStrokeContext",value:function(){Nue(Gue(i.prototype),"_initKeyStrokeContext",this).call(this),this.desktopKeyStrokeContext=new $u,this.desktopKeyStrokeContext.$bindTarget=this.session.desktop.$container,this.desktopKeyStrokeContext.$scopeTarget=this.session.desktop.$container,this.desktopKeyStrokeContext.registerKeyStroke([new ace(this),new yce(this)])}},{key:"_render",value:function(){Nue(Gue(i.prototype),"_render",this).call(this),this.$container.addClass("desktop-navigation-handle"),this.session.keyStrokeManager.installKeyStrokeContext(this.desktopKeyStrokeContext)}},{key:"_remove",value:function(){Nue(Gue(i.prototype),"_remove",this).call(this),this.session.keyStrokeManager.uninstallKeyStrokeContext(this.desktopKeyStrokeContext)}}])&&Hue(t.prototype,n),r&&Hue(t,r),i}(Hf);function Kue(e){return(Kue="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function que(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Yue(e,t){return(Yue=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Xue(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Zue(e);if(t){var o=Zue(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Jue(this,n)}}function Jue(e,t){return!t||"object"!==Kue(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Zue(e){return(Zue=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Que=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Yue(e,t)}(i,e);var t,n,r,o=Xue(i);function i(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(t=o.call(this)).navigation=e,t}return t=i,(n=[{key:"layout",value:function(e){var t,n,r,o=this.navigation.htmlComp,i=o.size({exact:!0}),s=this.navigation.htmlCompBody,a=this.navigation.toolBox,l=this.navigation.viewButtonBox,u=0,c=0;i=i.subtract(o.insets()),l.visible&&(u=(r=l.htmlComp.prefSize()).height,c=i.width,a&&(c=r.width),n=new $s(c,u).subtract(l.htmlComp.margins()),l.htmlComp.setSize(n)),a&&(a.$container.cssLeft(c),a.htmlComp.setSize(new $s(i.width-c,u))),t=new $s(i.width,i.height).subtract(s.margins()),this.navigation.singleViewButton?s.$comp.cssTop(0):(s.$comp.cssTop(u),t.height-=u),s.setSize(t)}},{key:"preferredLayoutSize",value:function(e){var t=this.navigation.htmlComp,n=this.navigation.htmlCompBody,r=this.navigation.toolBox,o=this.navigation.viewButtonBox,i=n.prefSize(),s=new $s(0,0);if(o){var a=o.htmlComp.prefSize();s.width+=a.width,s.height=Math.max(s.height,a.height)}if(r){var l=r.htmlComp.prefSize();s.width+=l.width,s.height=Math.max(s.height,l.height)}return i.height+=s.height,i.width=Math.max(i.width,s.width),i=i.add(t.insets())}}])&&que(t.prototype,n),r&&que(t,r),i}(Zs);function ece(e){return(ece="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function tce(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function nce(e,t,n){return(nce="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=sce(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function rce(e,t){return(rce=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function oce(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=sce(e);if(t){var o=sce(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return ice(this,n)}}function ice(e,t){return!t||"object"!==ece(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function sce(e){return(sce=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var ace=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&rce(e,t)}(i,e);var t,n,r,o=oce(i);function i(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(t=o.call(this)).field=e,t.desktop=e.session.desktop,t.ctrl=!0,t.which=[Ou.forBrowser(Ou.ANGULAR_BRACKET)],t.renderingHints.$drawingArea=function(e,n){return t.desktop.$container},t}return t=i,(n=[{key:"_accept",value:function(e){return nce(sce(i.prototype),"_accept",this).call(this,e)||zu.acceptModifiers(this,e)&&O.isOneOf(e.which,Ou.forBrowser(Ou.ANGULAR_BRACKET,"ctrl"))}},{key:"_isEnabled",value:function(){return nce(sce(i.prototype),"_isEnabled",this).call(this)&&this.field.leftVisible}},{key:"handle",value:function(e){this.desktop.shrinkNavigation()}},{key:"_postRenderKeyBox",value:function(e,t){var n,r,o,i=this.field;t.addClass("navigation-handle-key-box left"),r=(n=i.$left.offsetTo(this.desktop.$container)).left-t.outerWidth(!0),o=n.top,t.cssLeft(r).cssTop(o)}}])&&tce(t.prototype,n),r&&tce(t,r),i}(zu);function lce(e){return(lce="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function uce(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function cce(e,t,n){return(cce="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=dce(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function fce(e,t){return(fce=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function hce(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=dce(e);if(t){var o=dce(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return pce(this,n)}}function pce(e,t){return!t||"object"!==lce(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function dce(e){return(dce=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var yce=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&fce(e,t)}(i,e);var t,n,r,o=hce(i);function i(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(t=o.call(this)).field=e,t.desktop=e.session.desktop,t.ctrl=!0,t.shift=!0,t.which=[Ou.forBrowser(Ou.ANGULAR_BRACKET)],t.renderingHints.$drawingArea=function(e,n){return t.desktop.$container},t}return t=i,(n=[{key:"_accept",value:function(e){return cce(dce(i.prototype),"_accept",this).call(this,e)||zu.acceptModifiers(this,e)&&O.isOneOf(e.which,Ou.forBrowser(Ou.ANGULAR_BRACKET,"ctrl"))}},{key:"_isEnabled",value:function(){return cce(dce(i.prototype),"_isEnabled",this).call(this)&&this.field.rightVisible}},{key:"handle",value:function(e){this.desktop.enlargeNavigation()}},{key:"_postRenderKeyBox",value:function(e,t){var n,r,o,i=this.field;t.addClass("navigation-handle-key-box right"),r=(n=i.$right.offsetTo(this.desktop.$container)).left+i.$right.outerWidth(),o=n.top,t.cssLeft(r).cssTop(o)}}])&&uce(t.prototype,n),r&&uce(t,r),i}(zu);function vce(e){return(vce="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function bce(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function mce(e,t,n){return(mce="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=kce(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function gce(e,t){return(gce=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function _ce(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=kce(e);if(t){var o=kce(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return wce(this,n)}}function wce(e,t){return!t||"object"!==vce(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function kce(e){return(kce=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Sce=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&gce(e,t)}(i,e);var t,n,r,o=_ce(i);function i(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(e=o.call(this)).closable=!0,e.duration=5e3,e.removeTimeout,e._removing=!1,e}return t=i,(n=[{key:"_init",value:function(e){mce(kce(i.prototype),"_init",this).call(this,e)}},{key:"_render",value:function(){this.$container=this.$parent.prependDiv("desktop-notification"),this.$content=this.$container.appendDiv("desktop-notification-content"),this.$messageText=this.$content.appendDiv("desktop-notification-message"),this.$loader=this.$content.appendDiv("desktop-notification-loader"),Kt.get().supportsCssAnimation()&&this.$loader.addClass("animated")}},{key:"_renderProperties",value:function(){mce(kce(i.prototype),"_renderProperties",this).call(this)}},{key:"_renderLoading",value:function(){this.$container.toggleClass("loading",this.loading),this.$loader.setVisible(this.loading)}},{key:"_onCloseIconClick",value:function(){this.hide()}},{key:"show",value:function(){this.session.desktop.addNotification(this)}},{key:"hide",value:function(){this._removing||(this.trigger("close"),this.session.desktop.removeNotification(this))}},{key:"fadeIn",value:function(e){this.render(e),Kt.get().supportsCssAnimation()&&this.$container.addClassForAnimation("desktop-notification-slide-in")}},{key:"fadeOut",value:function(){var e=this;Kt.get().supportsCssAnimation()?this.rendered&&(this._removing||(this._removing=!0,this.$container.addClass("desktop-notification-fade-out"),this.$container.oneAnimationEnd((function(){e.destroy()})))):this.destroy()}},{key:"invalidateLayoutTree",value:function(){}}])&&bce(t.prototype,n),r&&bce(t,r),i}(Am);function Oce(e){return(Oce="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Tce(e,t){return(Tce=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Cce(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Rce(e);if(t){var o=Rce(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Pce(this,n)}}function Pce(e,t){return!t||"object"!==Oce(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Rce(e){return(Rce=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}!function(e,t,n){t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}(Sce,"INFINITE",-1);var xce=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Tce(e,t)}(n,e);var t=Cce(n);function n(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),t.call(this)}return n}(Hm);function Ece(e){return(Ece="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Dce(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Ace(e,t,n){return(Ace="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Bce(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function Fce(e,t){return(Fce=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function $ce(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Bce(e);if(t){var o=Bce(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return jce(this,n)}}function jce(e,t){return!t||"object"!==Ece(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Bce(e){return(Bce=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Mce=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Fce(e,t)}(i,e);var t,n,r,o=$ce(i);function i(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(e=o.call(this)).connectFailedReset=null,e}return t=i,(n=[{key:"_init",value:function(e){Ace(Bce(i.prototype),"_init",this).call(this,e),this.closable=!1,this.duration=Sce.INFINITE,this.status=new Br({message:this.session.text("ui.ConnectionInterrupted"),severity:Br.Severity.ERROR})}},{key:"_render",value:function(){Ace(Bce(i.prototype),"_render",this).call(this),this.$content.addClass("offline-message"),this.$messageText.addClass("offline-message-text"),this.$loader.text(this.session.text("ui.Reconnecting_"))}},{key:"reconnect",value:function(){this.setLoading(!0),this.connectFailedReset&&clearTimeout(this.connectFailedReset),this.$messageText.hide()}},{key:"reconnectFailed",value:function(){var e=this;this.connectFailedReset=setTimeout((function(){e.connectFailedReset=null,e.setLoading(!1),e.$messageText.show()}),1100)}},{key:"reconnectSucceeded",value:function(){this.setLoading(!1),this.connectFailedReset&&clearTimeout(this.connectFailedReset),this.setStatus({message:this.session.text("ui.ConnectionReestablished"),severity:Br.Severity.OK}),this.$messageText.show()}}])&&Dce(t.prototype,n),r&&Dce(t,r),i}(Sce);function Ice(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Lce=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.session=t,this.preserveOpener=n}var t,n,r;return t=e,(n=[{key:"init",value:function(e){s.a.extend(this,e)}},{key:"openWindow",value:function(e,t,n,r){var o=this;t=t||"scout_"+(new Date).getTime();var i=window.open("",t,n);if(i){this.preserveOpener||(i.opener=null);try{i.window.location.href=e}catch(t){return void this._handleInvalidUri(e,i,t)}r&&r(i)}else s.a.log.warn("Popup-blocker detected! Show link to open window manually"),this.showNotification((function(){o.openWindow(e,t,n,r)}))}},{key:"showNotification",value:function(e){var t,n,r=this.session.desktop;"string"==typeof e&&(n=e),t=O.create("DesktopNotification:PopupBlocker",{parent:r,linkUrl:n,preserveOpener:this.preserveOpener}),!n&&s.a.isFunction(e)&&t.on("linkClick",e),t.show()}},{key:"_handleInvalidUri",value:function(e,t,n){O.create("ErrorHandler",{logError:!0,displayError:!1,sendError:!1}).handle(n),t.close(),PU.createOk(this.session.desktop).withHeader(this.session.text("ui.UnexpectedProblem")).withBody(this.session.text("ui.InvalidUriMsg")).withSeverity(Br.Severity.ERROR).buildAndOpen()}}])&&Ice(t.prototype,n),r&&Ice(t,r),e}();function Hce(e){return(Hce="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Nce(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Vce(e,t,n){return(Vce="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Uce(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function Wce(e,t){return(Wce=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function zce(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Uce(e);if(t){var o=Uce(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Gce(this,n)}}function Gce(e,t){return!t||"object"!==Hce(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Uce(e){return(Uce=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Kce=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Wce(e,t)}(i,e);var t,n,r,o=zce(i);function i(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(e=o.call(this)).duration=Sce.INFINITE,e.linkUrl,e.preserveOpener=!1,e}return t=i,(n=[{key:"_init",value:function(e){Vce(Uce(i.prototype),"_init",this).call(this,e),this.linkText=O.nvl(this.linkText,this.session.text("ui.OpenManually")),this._setStatus({message:this.session.text("ui.PopupBlockerDetected"),severity:Br.Severity.WARNING})}},{key:"_render",value:function(){Vce(Uce(i.prototype),"_render",this).call(this),this.$messageText.addClass("popup-blocked-title"),this.$link=this.$content.appendElement("<a>","popup-blocked-link").text(this.linkText).on("click",this._onLinkClick.bind(this))}},{key:"_renderProperties",value:function(){Vce(Uce(i.prototype),"_renderProperties",this).call(this),this._renderLinkUrl()}},{key:"_renderLinkUrl",value:function(){this.linkUrl?(this.$link.attr("href",this.linkUrl).attr("target","_blank"),this.preserveOpener||this.$link.attr("rel","noreferrer noopener")):this.$link.removeAttr("href").removeAttr("target")}},{key:"_onLinkClick",value:function(){this.trigger("linkClick"),this.hide()}}])&&Nce(t.prototype,n),r&&Nce(t,r),i}(Sce);function qce(e){return(qce="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Yce(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Xce(e,t,n){return(Xce="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=efe(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function Jce(e,t){return(Jce=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Zce(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=efe(e);if(t){var o=efe(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Qce(this,n)}}function Qce(e,t){return!t||"object"!==qce(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function efe(e){return(efe=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var tfe=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Jce(e,t)}(i,e);var t,n,r,o=Zce(i);function i(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),o.call(this)}return t=i,(n=[{key:"_init",value:function(e){e.uiMenuCssClass=Wn.join(" ",e.uiMenuCssClass,"desktop-tool-box-item"),Xce(efe(i.prototype),"_init",this).call(this,e)}},{key:"_initMenu",value:function(e){Xce(efe(i.prototype),"_initMenu",this).call(this,e),e.popupHorizontalAlignment=Id.Alignment.RIGHTEDGE}},{key:"_render",value:function(){Xce(efe(i.prototype),"_render",this).call(this),this.$container.addClass("desktop-tool-box")}}])&&Yce(t.prototype,n),r&&Yce(t,r),i}(Aw);function nfe(e){return(nfe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function rfe(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ofe(e,t,n){return(ofe="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=lfe(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function ife(e,t){return(ife=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function sfe(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=lfe(e);if(t){var o=lfe(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return afe(this,n)}}function afe(e,t){return!t||"object"!==nfe(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function lfe(e){return(lfe=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var ufe=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ife(e,t)}(i,e);var t,n,r,o=sfe(i);function i(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),o.call(this,e)}return t=i,(n=[{key:"_postRenderKeyBox",value:function(e){if(this.field.iconId&&!this.field._isMenuItem){var t=e.outerWidth()/2-e.find(".key-box").outerWidth()/2;e.find(".key-box").cssLeft(t)}}},{key:"renderKeyBox",value:function(e,t){return this.field._isMenuItem&&(this.renderingHints.hAlign=Do.RIGHT),ofe(lfe(i.prototype),"renderKeyBox",this).call(this,e,t)}}])&&rfe(t.prototype,n),r&&rfe(t,r),i}(ld);function cfe(e){return(cfe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ffe(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function hfe(e,t,n){return(hfe="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=vfe(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function pfe(e,t){return(pfe=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function dfe(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=vfe(e);if(t){var o=vfe(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return yfe(this,n)}}function yfe(e,t){return!t||"object"!==cfe(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function vfe(e){return(vfe=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var bfe=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&pfe(e,t)}(i,e);var t,n,r,o=dfe(i);function i(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(e=o.call(this)).showTooltipWhenSelected=!1,e.displayStyle="TAB",e.selectedAsMenu=!1,e._renderedAsMenu=!1,e}return t=i,(n=[{key:"renderAsMenuItem",value:function(e){this._renderedAsMenu=!0,hfe(vfe(i.prototype),"render",this).call(this,e)}},{key:"renderAsTab",value:function(e){this._renderedAsMenu=!1,hfe(vfe(i.prototype),"render",this).call(this,e)}},{key:"_render",value:function(){this._renderedAsMenu?this._renderAsMenuItem():this._renderAsTab()}},{key:"_renderAsMenuItem",value:function(){this.$container=this.$parent.appendDiv("view-menu-item").on("click",this._onMouseEvent.bind(this))}},{key:"_renderAsTab",value:function(){this.$container=this.$parent.appendDiv("view-button-tab").on("mousedown",this._onMouseEvent.bind(this))}},{key:"_renderText",value:function(){this._renderedAsMenu&&hfe(vfe(i.prototype),"_renderText",this).call(this)}},{key:"setDisplayStyle",value:function(e){this.setProperty("displayStyle",e)}},{key:"last",value:function(){this.$container.addClass("last")}},{key:"tab",value:function(){this.$container.addClass("view-tab")}},{key:"_onMouseEvent",value:function(e){this.doAction()}},{key:"_createActionKeyStroke",value:function(){return new ufe(this)}},{key:"setSelectedAsMenu",value:function(e){this.selectedAsMenu=e}}])&&ffe(t.prototype,n),r&&ffe(t,r),i}(Up);function mfe(e){return(mfe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function gfe(e,t){return(gfe=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function _fe(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=kfe(e);if(t){var o=kfe(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return wfe(this,n)}}function wfe(e,t){return!t||"object"!==mfe(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function kfe(e){return(kfe=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Sfe=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&gfe(e,t)}(n,e);var t=_fe(n);function n(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),t.call(this)}return n}(ed);function Ofe(e){return(Ofe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Tfe(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Cfe(e,t,n){return(Cfe="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Dfe(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function Pfe(e,t){return(Pfe=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Rfe(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Dfe(e);if(t){var o=Dfe(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return xfe(this,n)}}function xfe(e,t){return!t||"object"!==Ofe(t)&&"function"!=typeof t?Efe(e):t}function Efe(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Dfe(e){return(Dfe=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Afe=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Pfe(e,t)}(i,e);var t,n,r,o=Rfe(i);function i(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(e=o.call(this)).viewMenuTab=null,e.viewButtons=[],e.menuButtons=[],e.tabButtons=[],e._desktopOutlineChangeHandler=e._onDesktopOutlineChange.bind(Efe(e)),e._viewButtonPropertyChangeHandler=e._onViewButtonPropertyChange.bind(Efe(e)),e._addWidgetProperties(["tabButtons"]),e}return t=i,(n=[{key:"_init",value:function(e){Cfe(Dfe(i.prototype),"_init",this).call(this,e),this.desktop=this.session.desktop,this.viewMenuTab=O.create("ViewMenuTab",{parent:this}),this._setViewButtons(this.viewButtons),this.desktop.on("outlineChange",this._desktopOutlineChangeHandler)}},{key:"_render",value:function(){this.$container=this.$parent.appendDiv("view-button-box"),this.htmlComp=ea.install(this.$container,this.session),this.htmlComp.setLayout(new Lfe(this)),this.viewMenuTab.render(),this._onDesktopOutlineChange()}},{key:"_renderProperties",value:function(){Cfe(Dfe(i.prototype),"_renderProperties",this).call(this),this._renderTabButtons()}},{key:"_remove",value:function(){this.desktop.off("outlineChange",this._desktopOutlineChangeHandler),this.viewButtons.forEach((function(e){e.off("selected",this._viewButtonPropertyChangeHandler)}),this),Cfe(Dfe(i.prototype),"_remove",this).call(this)}},{key:"setMenuTabVisible",value:function(e){this.viewMenuTab.setViewTabVisible(e),this.invalidateLayoutTree()}},{key:"setViewButtons",value:function(e){this.setProperty("viewButtons",e)}},{key:"_setViewButtons",value:function(e){this.viewButtons&&this.viewButtons.forEach((function(e){e.off("propertyChange",this._viewButtonPropertyChangeHandler)}),this),this._setProperty("viewButtons",e),this.viewButtons.forEach((function(e){e.on("propertyChange",this._viewButtonPropertyChangeHandler)}),this),this._updateViewButtons()}},{key:"setTabButtons",value:function(e){this.setProperty("tabButtons",e)}},{key:"_renderTabButtons",value:function(){this.tabButtons.forEach((function(e,t){e.renderAsTab(),e.tab(),t===this.tabButtons.length-1&&e.last()}),this)}},{key:"_updateViewButtons",value:function(){var e=this.viewButtons.filter((function(e){return e.visible})),t=e.filter((function(e){return"MENU"===e.displayStyle})),n=null;t.length>1?n=e.filter((function(e){return"TAB"===e.displayStyle})):(n=e,t=[]),this._setMenuButtons(t),this.setTabButtons(n),this._updateVisibility()}},{key:"_updateVisibility",value:function(e){this.setVisible(this.tabButtons.length+this.menuButtons.length>1)}},{key:"setMenuButtons",value:function(e){this.setProperty("menuButtons",e),this._updateVisibility()}},{key:"_setMenuButtons",value:function(e){this._setProperty("menuButtons",e),this.viewMenuTab.setViewButtons(this.menuButtons)}},{key:"sendToBack",value:function(){this.viewMenuTab.sendToBack()}},{key:"bringToFront",value:function(){this.viewMenuTab.bringToFront()}},{key:"_onDesktopOutlineChange",value:function(e){var t=this.desktop.outline;this.viewButtons.forEach((function(e){e instanceof Ide&&e.onOutlineChange(t)}))}},{key:"_onViewButtonSelected",value:function(e){this.viewButtons.forEach((function(t){t!==e.source&&t.isToggleAction()&&t.setSelected(!1)}),this),this.viewMenuTab.onViewButtonSelected()}},{key:"_onViewButtonPropertyChange",value:function(e){"selected"===e.propertyName?this._onViewButtonSelected(e):"visible"!==e.propertyName&&"displayStyle"!==e.propertyName||this._updateViewButtons()}}])&&Tfe(t.prototype,n),r&&Tfe(t,r),i}(ve);function Ffe(e){return(Ffe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function $fe(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function jfe(e,t){return(jfe=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Bfe(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ife(e);if(t){var o=Ife(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Mfe(this,n)}}function Mfe(e,t){return!t||"object"!==Ffe(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Ife(e){return(Ife=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Lfe=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&jfe(e,t)}(i,e);var t,n,r,o=Bfe(i);function i(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(t=o.call(this)).viewButtonBox=e,t}return t=i,(n=[{key:"layout",value:function(e){var t=this.viewButtonBox.tabButtons.filter((function(e){return e.visible})),n=this.viewButtonBox.viewMenuTab,r=this.viewButtonBox.htmlComp.size().width,o=r/t.length;n.visible&&n.selectedButton.rendered&&(n.selectedButton&&(o=(r-qs.size(n.dropdown.$container,{exact:!0}).width)/(t.length+1),n.selectedButton.$container.cssWidth(o)),r-=qs.size(n.$container,{exact:!0}).width),t.forEach((function(e,n){t.length-1===n?e.$container.cssWidth(Math.ceil(100*r)/100):(e.$container.cssWidth(o),r-=e.$container.cssWidth())}),this)}},{key:"preferredLayoutSize",value:function(e){return qs.prefSize(e,{useCssSize:!0})}}])&&$fe(t.prototype,n),r&&$fe(t,r),i}(Zs);function Hfe(e){return(Hfe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Nfe(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Vfe(e,t){return(Vfe=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Wfe(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ufe(e);if(t){var o=Ufe(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return zfe(this,n)}}function zfe(e,t){return!t||"object"!==Hfe(t)&&"function"!=typeof t?Gfe(e):t}function Gfe(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Ufe(e){return(Ufe=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Kfe=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Vfe(e,t)}(i,e);var t,n,r,o=Wfe(i);function i(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(t=o.call(this)).field=e,t.which=[Ou.F2],t.stopPropagation=!0,t.renderingHints.$drawingArea=function(e,t){return this.field.$container}.bind(Gfe(t)),t}return t=i,(n=[{key:"handle",value:function(e){this.field.selected&&!this.field.inBackground?this.field.togglePopup():this.field.selectedButton&&this.field.selectedButton.doAction()}},{key:"_postRenderKeyBox",value:function(e){var t=e.find(".key-box").outerWidth(),n=this.field.dropdown.$container.outerWidth();this.field.selected&&!this.field.inBackground?n/=2:this.field.selectedButton&&(n+=this.field.selectedButton.$container.outerWidth()/2),n-=t/2,e.find(".key-box").cssLeft(n)}}])&&Nfe(t.prototype,n),r&&Nfe(t,r),i}(zu);function qfe(e){return(qfe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Yfe(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Xfe(e,t,n){return(Xfe="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=the(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function Jfe(e,t){return(Jfe=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Zfe(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=the(e);if(t){var o=the(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Qfe(this,n)}}function Qfe(e,t){return!t||"object"!==qfe(t)&&"function"!=typeof t?ehe(e):t}function ehe(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function the(e){return(the=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var nhe=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Jfe(e,t)}(i,e);var t,n,r,o=Zfe(i);function i(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(e=o.call(this)).$tab,e.$headBlueprint,e.viewMenus,e.viewButtonBoxBounds,e._addWidgetProperties("viewMenus"),e._viewMenuActionHandler=e._onViewMenuAction.bind(ehe(e)),e}return t=i,(n=[{key:"_init",value:function(e){e.focusableContainer=!0,Xfe(the(i.prototype),"_init",this).call(this,e),this.$tab=e.$tab,this.$headBlueprint=this.$tab,this.viewButtonBoxBounds=e.naviBounds}},{key:"_createLayout",value:function(){return new che(this)}},{key:"_initKeyStrokeContext",value:function(){Xfe(the(i.prototype),"_initKeyStrokeContext",this).call(this),Q_.registerKeyStrokes(this.keyStrokeContext,this,"view-menu-item")}},{key:"_render",value:function(){Xfe(the(i.prototype),"_render",this).call(this),this.viewMenus.forEach((function(e){e.renderAsMenuItem(this.$body),e.on("action",this._viewMenuActionHandler)}),this),rt.findFromReverse(this.viewMenus,this.viewMenus.length-1,(function(e){return e.visible}),this).$container.addClass("last"),this._installScrollbars({axis:"y"})}},{key:"_remove",value:function(){this.viewMenus.forEach((function(e){e.off("action",this._viewMenuActionHandler)}),this),Xfe(the(i.prototype),"_remove",this).call(this)}},{key:"get$Scrollable",value:function(){return this.$body}},{key:"_renderHead",value:function(){Xfe(the(i.prototype),"_renderHead",this).call(this),this._copyCssClassToHead("view-menu"),this._copyCssClassToHead("unfocusable"),this.$head.removeClass("popup-head"),this.$head.addClass("view-menu-popup-head")}},{key:"_modifyBody",value:function(){this.$body.removeClass("popup-body"),this.$body.addClass("view-menu-popup-body")}},{key:"position",value:function(){var e=this.$tab.offset(),t=qs.size(this.$tab,!0),n=t.height;qs.setBounds(this.$head,e.left,e.top,t.width,t.height),this.$deco.cssLeft(e.left),this.$deco.cssTop(0),this.$deco.cssWidth(t.width-1),this.$head.cssTop(-n),this.$body.cssTop(0),this.$container.cssMarginTop(t.height),this.setLocation(new Is(0,0))}},{key:"_onViewMenuAction",value:function(e){this.close()}}])&&Yfe(t.prototype,n),r&&Yfe(t,r),i}(wy);function rhe(e){return(rhe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ohe(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ihe(e,t,n){return(ihe="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=uhe(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function she(e,t){return(she=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function ahe(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=uhe(e);if(t){var o=uhe(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return lhe(this,n)}}function lhe(e,t){return!t||"object"!==rhe(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function uhe(e){return(uhe=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}!function(e,t,n){t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}(nhe,"MAX_MENU_WIDTH",300);var che=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&she(e,t)}(i,e);var t,n,r,o=ahe(i);function i(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),o.call(this,e)}return t=i,(n=[{key:"preferredLayoutSize",value:function(e){var t=ihe(uhe(i.prototype),"preferredLayoutSize",this).call(this,e);return t.width>=this.popup.viewButtonBoxBounds.width||(t.width=Math.min(nhe.MAX_MENU_WIDTH,this.popup.viewButtonBoxBounds.width)),t}}])&&ohe(t.prototype,n),r&&ohe(t,r),i}(xy);function fhe(e){return(fhe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function hhe(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function phe(e,t,n){return(phe="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=bhe(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function dhe(e,t){return(dhe=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function yhe(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=bhe(e);if(t){var o=bhe(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return vhe(this,n)}}function vhe(e,t){return!t||"object"!==fhe(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function bhe(e){return(bhe=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var mhe=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&dhe(e,t)}(i,e);var t,n,r,o=yhe(i);function i(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(e=o.call(this)).viewButtons=[],e.selected=!1,e.selectedButton=null,e.viewTabVisible=!0,e.defaultIconId=gn.FOLDER,e._addWidgetProperties(["selectedButton"]),e}return t=i,(n=[{key:"_init",value:function(e){phe(bhe(i.prototype),"_init",this).call(this,e),this.dropdown=O.create("Menu",{parent:this,iconId:gn.ANGLE_DOWN,tabbable:!1,cssClass:"view-menu"}),this.dropdown.on("action",this.togglePopup.bind(this)),this._setViewButtons(this.viewButtons)}},{key:"_initKeyStrokeContext",value:function(){phe(bhe(i.prototype),"_initKeyStrokeContext",this).call(this),this.desktopKeyStrokeContext=new $u,this.desktopKeyStrokeContext.invokeAcceptInputOnActiveValueField=!0,this.desktopKeyStrokeContext.$bindTarget=this.session.desktop.$container,this.desktopKeyStrokeContext.$scopeTarget=this.session.desktop.$container,this.desktopKeyStrokeContext.registerKeyStroke([new Kfe(this)])}},{key:"_render",value:function(){this.$container=this.$parent.appendDiv("view-tab"),this.htmlComp=ea.install(this.$container,this.session),this.dropdown.render(this.$container),this.session.keyStrokeManager.installKeyStrokeContext(this.desktopKeyStrokeContext)}},{key:"_remove",value:function(){this.session.keyStrokeManager.uninstallKeyStrokeContext(this.desktopKeyStrokeContext),phe(bhe(i.prototype),"_remove",this).call(this),this.selectedButton&&this.selectedButton.remove()}},{key:"_renderProperties",value:function(){phe(bhe(i.prototype),"_renderProperties",this).call(this),this._updateSelectedButton()}},{key:"setViewButtons",value:function(e){this.setProperty("viewButtons",e)}},{key:"_setViewButtons",value:function(e){this._setProperty("viewButtons",e),this.setVisible(this.viewButtons.length>0);var t=this._findSelectedViewButton();t?this.setSelectedButton(t):this.setSelectedButton(rt.find(this.viewButtons,(function(e){return e.selectedAsMenu}))||this.viewButtons[0]),this.setSelected(!!t)}},{key:"setSelectedButton",value:function(e){this.selectedButton&&this.selectedButton.cloneOf===e||e&&this.setProperty("selectedButton",e)}},{key:"_setSelectedButton",value:function(e){this.viewButtons.forEach((function(t){return t.setSelectedAsMenu(t===e)})),(e=e.clone({parent:this,displayStyle:"TAB"},{delegateEventsToOriginal:["acceptInput","action"],delegateAllPropertiesToClone:!0,delegateAllPropertiesToOriginal:!0,excludePropertiesToOriginal:["selected"]})).iconId=e.iconId||this.defaultIconId,this._setProperty("selectedButton",e)}},{key:"_renderSelectedButton",value:function(){this._updateSelectedButton()}},{key:"_updateSelectedButton",value:function(){this.selectedButton&&(this.viewTabVisible?this.selectedButton.rendered||(this.selectedButton.render(this.$container),this.invalidateLayoutTree()):this.selectedButton.rendered&&(this.selectedButton.remove(),this.invalidateLayoutTree()))}},{key:"setViewTabVisible",value:function(e){this.setProperty("viewTabVisible",e),this.rendered&&this._updateSelectedButton()}},{key:"_renderSelected",value:function(){this.$container.select(this.selected)}},{key:"_findSelectedViewButton",value:function(){return rt.find(this.viewButtons,(function(e){return e.selected}))}},{key:"togglePopup",value:function(){this.popup?this._closePopup():this._openPopup()}},{key:"_openPopup",value:function(){var e=this;if(!this.popup){var t=qs.bounds(this.$container.parent(),!0);this.popup=O.create("ViewMenuPopup",{parent:this,$tab:this.dropdown.$container,viewMenus:this.viewButtons,naviBounds:t}),this.$container.addClass("popup-open"),this.popup.headText=this.text,this.popup.open(),this.popup.on("remove",(function(t){e.$container.removeClass("popup-open"),e.popup=null}))}}},{key:"_closePopup",value:function(){this.popup&&this.popup.close()}},{key:"setSelected",value:function(e){this.setProperty("selected",e)}},{key:"sendToBack",value:function(){this._closePopup()}},{key:"bringToFront",value:function(){}},{key:"onViewButtonSelected",value:function(){var e=this._findSelectedViewButton();e&&this.setSelectedButton(e),this.setSelected(!!e),this._closePopup()}}])&&hhe(t.prototype,n),r&&hhe(t,r),i}(ve);function ghe(e){return(ghe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _he(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function whe(e,t,n){return(whe="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=The(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function khe(e,t){return(khe=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function She(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=The(e);if(t){var o=The(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Ohe(this,n)}}function Ohe(e,t){return!t||"object"!==ghe(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function The(e){return(The=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Che=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&khe(e,t)}(i,e);var t,n,r,o=She(i);function i(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(e=o.call(this)).nodeType=null,e.compactRoot=!1,e.detailTable=null,e.detailTableVisible=!0,e.detailForm=null,e.detailFormVisible=!0,e.detailFormVisibleByUi=!0,e.navigateButtonsVisible=!0,e.detailFormType=null,e.tableStatusVisible=!0,e.drillDownOnRowClick=!1,e.overviewIconId=null,e.showTileOverview=!1,e}return t=i,(n=[{key:"createDetailForm",value:function(){return null}},{key:"_init",value:function(e){whe(The(i.prototype),"_init",this).call(this,e),gn.resolveIconProperty(this,"overviewIconId"),this._internalInitTable(),this._internalInitDetailForm()}},{key:"_destroy",value:function(){whe(The(i.prototype),"_destroy",this).call(this),this.detailTable&&this.detailTable.destroy(),this.detailForm&&this.detailForm.destroy()}},{key:"_internalInitTable",value:function(){var e=this.detailTable;e=e?this.getOutline()._createChild(e):this._createTable(),this.setDetailTable(e)}},{key:"_internalInitDetailForm",value:function(){var e=this.detailForm;e&&(e=this.getOutline()._createChild(e)),this.setDetailForm(e)}},{key:"_createTable",value:function(){return null}},{key:"_initTable",value:function(e){e.menuBar.setPosition(Yw.Position.TOP),e.on("filter",this._onTableFilter.bind(this)),this.drillDownOnRowClick&&(e.on("rowClick",this._onTableRowClick.bind(this)),e.setMultiSelect(!1))}},{key:"_ensureDetailForm",value:function(){if(!this.detailForm){var e=this.createDetailForm();e&&!e.displayParent&&e.setDisplayParent(this.getOutline()),this.setDetailForm(e)}}},{key:"_decorate",value:function(){whe(The(i.prototype),"_decorate",this).call(this),this.$node&&(this.session.inspector&&_n.applyInfo(this,this.$node),this.$node.toggleClass("compact-root",this.compactRoot),this.$node.toggleClass("has-tile-overview",this.showTileOverview||this.compactRoot&&this.getOutline().detailContent instanceof Ive))}},{key:"activate",value:function(){this._ensureDetailForm()}},{key:"deactivate",value:function(){}},{key:"getOutline",value:function(){return this.parent}},{key:"pagesForTableRows",value:function(e){return e.map(this.pageForTableRow)}},{key:"pageForTableRow",value:function(e){if(!e.page)throw new Error("Table-row is not linked to a page");return e.page}},{key:"setDetailForm",value:function(e){this.detailForm=e,this.detailForm&&this.detailForm.setModal(!1),this.detailForm instanceof scout.TileOverviewForm&&this.detailForm.setPage(this)}},{key:"setDetailTable",value:function(e){e&&(this._initTable(e),e.setTableStatusVisible(this.tableStatusVisible)),this.detailTable=e}},{key:"updatePagesFromTableRows",value:function(e){return e.map((function(e){var t=e.page;return t.updatePageFromTableRow(e),t}))}},{key:"updatePageFromTableRow",value:function(e){var t=e.page;return t.enabled=e.enabled,t.text=t.computeTextForRow(e),e.cells.length>=1&&(t.htmlEnabled=e.cells[0].htmlEnabled,t.cssClass=e.cells[0].cssClass),t}},{key:"computeTextForRow",value:function(e){var t="";return e.cells.length>=1&&(t=e.cells[0].text),t}},{key:"_pageParam",value:function(e){var t={parent:this.getOutline()};return s.a.extend(t,e),t}},{key:"reloadPage",value:function(){this.getOutline()&&this.loadChildren()}},{key:"linkWithRow",value:function(e){this.row=e,e.page=this,this.getOutline().trigger("pageRowLink",{page:this,row:e})}},{key:"unlinkWithRow",value:function(e){delete this.row,delete e.page}},{key:"_onTableFilter",value:function(e){this.getOutline().mediator.onTableFilter(e,this)}},{key:"_onTableRowClick",value:function(e){if(this.drillDownOnRowClick){var t=e.row,n=this.pageForTableRow(t);this.getOutline().selectNode(n),this.detailTable.deselectRow(t)}}}])&&_he(t.prototype,n),r&&_he(t,r),i}(rN);function Phe(e){return(Phe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Rhe(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function xhe(e,t){return(xhe=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Ehe(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ahe(e);if(t){var o=Ahe(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Dhe(this,n)}}function Dhe(e,t){return!t||"object"!==Phe(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Ahe(e){return(Ahe=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}!function(e,t,n){t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}(Che,"NodeType",{NODES:"nodes",TABLE:"table"});var Fhe=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&xhe(e,t)}(i,e);var t,n,r,o=Ehe(i);function i(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(e=o.call(this)).nodeType=Che.NodeType.NODES,e}return t=i,(n=[{key:"_createTable",value:function(){var e=O.create("Column",{id:"NodeColumn",session:this.session}),t=O.create("Table",{parent:this.parent,id:"PageWithNodesTable",autoResizeColumns:!0,headerVisible:!1,columns:[e]});return t.menuBar.setPosition(Yw.Position.TOP),t.on("rowAction",this._onDetailTableRowAction.bind(this)),t}},{key:"_onDetailTableRowAction",value:function(e){this.getOutline().mediator.onTableRowAction(e,this)}},{key:"_rebuildDetailTable",value:function(e){var t=this.detailTable;this._unlinkAllTableRows(t.rows),t.deleteAllRows();var n=this._createTableRowsForChildPages(e);t.insertRows(n)}},{key:"_unlinkAllTableRows",value:function(e){e.forEach((function(e){e.page&&e.page.unlinkWithRow(e)}))}},{key:"_createTableRowsForChildPages",value:function(e){return e.map((function(e){var t=O.create("TableRow",{parent:this.detailTable,cells:[e.text]});return e.linkWithRow(t),t}),this)}},{key:"loadChildren",value:function(){var e=this;return this.childrenLoaded=!1,this._createChildPages().done((function(t){e._rebuildDetailTable(t),t.length>0&&e.getOutline().insertNodes(t,e),e.childrenLoaded=!0}))}},{key:"_createChildPages",value:function(){return s.a.resolvedDeferred(this.childNodes)}}])&&Rhe(t.prototype,n),r&&Rhe(t,r),i}(Che);function $he(e){return($he="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function jhe(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Bhe(e,t,n){return(Bhe="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Hhe(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function Mhe(e,t){return(Mhe=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Ihe(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Hhe(e);if(t){var o=Hhe(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Lhe(this,n)}}function Lhe(e,t){return!t||"object"!==$he(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Hhe(e){return(Hhe=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Nhe=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Mhe(e,t)}(i,e);var t,n,r,o=Ihe(i);function i(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(e=o.call(this)).nodeType=Che.NodeType.TABLE,e.alwaysCreateChildPage=!1,e}return t=i,(n=[{key:"_initTable",value:function(e){Bhe(Hhe(i.prototype),"_initTable",this).call(this,e),e.on("rowsDeleted allRowsDeleted",this._onTableRowsDeleted.bind(this)),e.on("rowsInserted",this._onTableRowsInserted.bind(this)),e.on("rowsUpdated",this._onTableRowsUpdated.bind(this)),e.on("rowAction",this._onTableRowAction.bind(this)),e.on("rowOrderChanged",this._onTableRowOrderChanged.bind(this)),e.on("reload",this.loadTableData.bind(this)),e.hasReloadHandler=!0}},{key:"_onTableRowsDeleted",value:function(e){if(!this.leaf){var t=rt.ensure(e.rows),n=t.map((function(e){var t=e.page;return t.unlinkWithRow(e),t}),this);this.getOutline().mediator.onTableRowsDeleted(t,n,this)}}},{key:"_onTableRowsInserted",value:function(e){if(!this.leaf){var t=rt.ensure(e.rows),n=t.map((function(e){return this._createChildPageInternal(e)}),this);this.getOutline().mediator.onTableRowsInserted(t,n,this)}}},{key:"_onTableRowsUpdated",value:function(e){this.getOutline().mediator.onTableRowsUpdated(e,this)}},{key:"_onTableRowAction",value:function(e){this.getOutline().mediator.onTableRowAction(e,this)}},{key:"_onTableRowOrderChanged",value:function(e){e.animating||this.getOutline().mediator.onTableRowOrderChanged(e,this)}},{key:"_createChildPageInternal",value:function(e){var t=this.createChildPage(e);return null===t&&this.alwaysCreateChildPage&&(t=this.createDefaultChildPage(e)),t.linkWithRow(e),t=t.updatePageFromTableRow(e)}},{key:"createChildPage",value:function(e){return null}},{key:"createDefaultChildPage",value:function(e){return O.create("AutoLeafPageWithNodes",{parent:this.getOutline(),row:e})}},{key:"loadChildren",value:function(){return this.detailTable?this.loadTableData():s.a.resolvedDeferred()}},{key:"_createSearchFilter",value:function(){var e=rt.find(this.detailTable.tableControls,(function(e){return e.form}));return e?e.form.exportData():null}},{key:"loadTableData",value:function(){return this.detailTable.deleteAllRows(),this.detailTable.setLoading(!0),this._loadTableData(this._createSearchFilter()).then(this._onLoadTableDataDone.bind(this)).catch(this._onLoadTableDataFail.bind(this)).then(this._onLoadTableDataAlways.bind(this))}},{key:"_loadTableData",value:function(e){return s.a.resolvedDeferred()}},{key:"_onLoadTableDataDone",value:function(e){var t=this._transformTableDataToTableRows(e);t&&t.length>0&&this.detailTable.insertRows(t)}},{key:"_onLoadTableDataFail",value:function(e){this.detailTable.setTableStatus(Br.error({message:this.session.text("ErrorWhileLoadingData")})),s.a.log.error("Failed to load tableData. error=",e)}},{key:"_onLoadTableDataAlways",value:function(){this.childrenLoaded=!0,this.detailTable.setLoading(!1)}},{key:"_transformTableDataToTableRows",value:function(e){return e}}])&&jhe(t.prototype,n),r&&jhe(t,r),i}(Che);function Vhe(e){return(Vhe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Whe(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function zhe(e,t,n){return(zhe="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=qhe(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function Ghe(e,t){return(Ghe=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Uhe(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=qhe(e);if(t){var o=qhe(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Khe(this,n)}}function Khe(e,t){return!t||"object"!==Vhe(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function qhe(e){return(qhe=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Yhe=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ghe(e,t)}(i,e);var t,n,r,o=Uhe(i);function i(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(e=o.call(this)).page=null,e}return t=i,(n=[{key:"_init",value:function(e){var t=this;zhe(qhe(i.prototype),"_init",this).call(this,e),this.label=this.page.text,this.iconId=this.page.overviewIconId,this.labelHtmlEnabled=this.page.htmlEnabled,this.on("click",(function(e){t.outline.selectNode(t.page)}))}},{key:"notifyPageChanged",value:function(){this.setLabel(this.page.text),this.setIconId(this.page.overviewIconId),this.setLabelHtmlEnabled(this.page.htmlEnabled)}}])&&Whe(t.prototype,n),r&&Whe(t,r),i}(rae);function Xhe(e){return(Xhe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Jhe(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Zhe(e,t,n){return(Zhe="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=rpe(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function Qhe(e,t){return(Qhe=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function epe(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=rpe(e);if(t){var o=rpe(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return tpe(this,n)}}function tpe(e,t){return!t||"object"!==Xhe(t)&&"function"!=typeof t?npe(e):t}function npe(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function rpe(e){return(rpe=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var ope=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Qhe(e,t)}(i,e);var t,n,r,o=epe(i);function i(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(e=o.call(this)).compact=!1,e.compactLayoutConfig=new Xre({columnWidth:120,rowHeight:100,hgap:15,vgap:15}),e.outline=null,e.page=null,e.nodes=null,e.withPlaceholders=!0,e.scrollable=!1,e.renderAnimationEnabled=!0,e.startupAnimationEnabled=!0,e._outlineNodeChangedHandler=e._onOutlineNodeChanged.bind(npe(e)),e._outlineStructureChangedHandler=e._onOutlineStructureChanged.bind(npe(e)),e}return t=i,(n=[{key:"_init",value:function(e){Zhe(rpe(i.prototype),"_init",this).call(this,e),this.nodes=this.nodes||this.page&&this.page.childNodes||this.outline&&this.outline.nodes,this._setCompact(this.compact),this.setOutline(this.outline),this.setPage(this.page),this.setNodes(this.nodes),this._setCompactLayoutConfig(this.compactLayoutConfig)}},{key:"_destroy",value:function(){this.setOutline(null),this.setPage(null),this.setNodes(null),Zhe(rpe(i.prototype),"_destroy",this).call(this)}},{key:"_createKeyStrokeContext",value:function(){return new $u}},{key:"_initKeyStrokeContext",value:function(){Zhe(rpe(i.prototype),"_initKeyStrokeContext",this).call(this),this.keyStrokeContext.$bindTarget=this.session.$entryPoint,this.keyStrokeContext.registerKeyStroke([new ppe(this)])}},{key:"setOutline",value:function(e){this.outline&&(this.outline.off("nodeChanged pageChanged",this._outlineNodeChangedHandler),this.outline.off("nodesDeleted",this._outlineStructureChangedHandler),this.outline.off("nodesInserted",this._outlineStructureChangedHandler),this.outline.off("allChildNodesDeleted",this._outlineStructureChangedHandler),this.outline.off("childNodeOrderChanged",this._outlineStructureChangedHandler)),this._setProperty("outline",e),this.outline&&(this.outline.on("nodeChanged pageChanged",this._outlineNodeChangedHandler),this.outline.on("nodesDeleted",this._outlineStructureChangedHandler),this.outline.on("nodesInserted",this._outlineStructureChangedHandler),this.outline.on("allChildNodesDeleted",this._outlineStructureChangedHandler),this.outline.on("childNodeOrderChanged",this._outlineStructureChangedHandler))}},{key:"setCompact",value:function(e){this.setProperty("compact",e)}},{key:"_setCompact",value:function(e){this._setProperty("compact",e),this.compact?this.setLayoutConfig(this.compactLayoutConfig):this.initialized&&this.setLayoutConfig(new Xre),this.setWithPlaceholders(!this.compact),this.setGridColumnCount(this.compact?3:4),this.startupAnimationEnabled=!this.compact,this.initialized&&this._rebuild()}},{key:"_setCompactLayoutConfig",value:function(e){e||(e=new Xre),this._setProperty("compactLayoutConfig",Xre.ensure(e))}},{key:"setPage",value:function(e){this._setProperty("page",e)}},{key:"setNodes",value:function(e){this._setProperty("nodes",e),this._rebuild()}},{key:"_createPageTiles",value:function(e){return(e||[]).map((function(e){return this._createPageTile(e)}),this)}},{key:"_createPageTile",value:function(e){var t=O.create("PageTileButton",{parent:this,outline:this.outline,page:e}),n=O.create("FormFieldTile",{parent:this,colorScheme:"default-inverted",cssClass:this.compact?"compact":null,tileWidget:t});return e.tile=n,n}},{key:"_rebuild",value:function(){this.setTiles(this._createPageTiles(this.nodes))}},{key:"_onOutlineNodeChanged",value:function(e){var t=(e.node||e.page).tile;t&&t.tileWidget.notifyPageChanged()}},{key:"_onOutlineStructureChanged",value:function(e){this.page?this.page===e.parentNode&&this.setNodes(this.page.childNodes):(e.nodes&&e.nodes.some((function(e){return!e.parentNode}))||"allChildNodesDeleted"===e.type)&&this.setNodes(this.outline.nodes)}}])&&Jhe(t.prototype,n),r&&Jhe(t,r),i}(gre);function ipe(e){return(ipe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function spe(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ape(e,t,n){return(ape="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=hpe(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function lpe(e,t){return(lpe=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function upe(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=hpe(e);if(t){var o=hpe(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return cpe(this,n)}}function cpe(e,t){return!t||"object"!==ipe(t)&&"function"!=typeof t?fpe(e):t}function fpe(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function hpe(e){return(hpe=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var ppe=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&lpe(e,t)}(i,e);var t,n,r,o=upe(i);function i(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(t=o.call(this)).field=e,t.registerRange(Ou[1],(function(){return Ou[Math.min(t._tiles().length,9)]})),t.renderingHints.$drawingArea=function(e,t){var n=t.which-Ou[1],r=this._tiles();return n<r.length&&r[n].tileWidget instanceof rae?r[n].tileWidget.$fieldContainer:null}.bind(fpe(t)),t}return t=i,(n=[{key:"_accept",value:function(e){if(!ape(hpe(i.prototype),"_accept",this).call(this,e))return!1;if(this.field&&this.field.outline&&this.field.outline.inBackground)return!1;var t=Ou.codesToKeys[e.which]-1,n=this._tiles();return!!(t<n.length&&n[t].tileWidget instanceof rae&&(e._$element=n[t].$container,e._$element))}},{key:"handle",value:function(e){e._$element.data("widget").tileWidget.doAction()}},{key:"_tiles",value:function(){return this.field.tiles}}])&&spe(t.prototype,n),r&&spe(t,r),i}(Ju);function dpe(e){return(dpe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ype(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function vpe(e,t,n){return(vpe="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=_pe(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function bpe(e,t){return(bpe=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function mpe(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=_pe(e);if(t){var o=_pe(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return gpe(this,n)}}function gpe(e,t){return!t||"object"!==dpe(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function _pe(e){return(_pe=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var wpe=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&bpe(e,t)}(i,e);var t,n,r,o=mpe(i);function i(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(e=o.call(this)).leaf=!0,e}return t=i,(n=[{key:"_init",value:function(e){O.assertParameter("row",e.row,Ix),vpe(_pe(i.prototype),"_init",this).call(this,e),this.text=this.row.cells[0].text}}])&&ype(t.prototype,n),r&&ype(t,r),i}(Che);function kpe(e){return(kpe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Spe(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Ope(e,t,n){return(Ope="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=xpe(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function Tpe(e,t){return(Tpe=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Cpe(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=xpe(e);if(t){var o=xpe(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Ppe(this,n)}}function Ppe(e,t){return!t||"object"!==kpe(t)&&"function"!=typeof t?Rpe(e):t}function Rpe(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function xpe(e){return(xpe=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Epe=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Tpe(e,t)}(i,e);var t,n,r,o=Cpe(i);function i(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(e=o.call(this)).view=null,e.title=null,e.subTitle=null,e.iconId=null,e.cssClass=null,e.closable=!1,e.saveNeeded=!1,e.saveNeededVisible=!1,e.status=null,e.selected=!1,e.$title=null,e.$subTitle=null,e.$iconContainer=null,e.$statusContainer=null,e._statusContainerUsageCounter=0,e._statusIconDivs=[],e._viewPropertyChangeListener=e._onViewPropertyChange.bind(Rpe(e)),e._viewRemoveListener=e._onViewRemove.bind(Rpe(e)),e._glassPaneContribution=function(e){return this.$statusContainer}.bind(Rpe(e)),e}return t=i,(n=[{key:"_init",value:function(e){Ope(xpe(i.prototype),"_init",this).call(this,e),this.view=e.view,this.title=this.view?this.view.title:e.title,this.subTitle=this.view?this.view.subTitle:e.subTitle,this.iconId=this.view?this.view.iconId:e.iconId,this.cssClass=this.view?this.view.cssClass:e.cssClass,this.closable=this.view?this.view.closable:e.closable,this.saveNeeded=this.view?this.view.saveNeeded:e.saveNeeded,this.saveNeededVisible=this.view?this.view.saveNeededVisible:e.saveNeededVisible,this.status=this.view?this.view.status:e.status,this.view&&(this._installViewListeners(),this.view.addGlassPaneContribution(this._glassPaneContribution))}},{key:"renderAfter",value:function(e,t){this.render(e),t&&this.$container.insertAfter(t.$container)}},{key:"_render",value:function(){this.$container=this.$parent.prependDiv("simple-tab"),this.$container.on("mousedown",this._onMouseDown.bind(this))}},{key:"_renderProperties",value:function(){Ope(xpe(i.prototype),"_renderProperties",this).call(this),this._renderTitle(),this._renderSubTitle(),this._renderIconId(),this._renderCssClass(),this._renderClosable(),this._renderSaveNeeded(),this._renderStatus(),this._renderSelected()}},{key:"_remove",value:function(){this._remove$Title(),this._remove$SubTitle(),this._remove$IconContainer(),this._remove$StatusContainer(),this.$close=null,Ope(xpe(i.prototype),"_remove",this).call(this)}},{key:"_getOrCreate$Title",value:function(){return this.$title||(this.$title=this.$container.makeDiv("title"),xp.installForEllipsis(this.$title,{parent:this}),this.$subTitle?this.$title.insertBefore(this.$subTitle):this.$iconContainer?this.$title.insertAfter(this.$iconContainer):this.$statusContainer?this.$title.insertAfter(this.$statusContainer):this.$title.appendTo(this.$container)),this.$title}},{key:"_getOrCreate$SubTitle",value:function(){return this.$subTitle||(this.$subTitle=this.$container.makeDiv("sub-title"),xp.installForEllipsis(this.$subTitle,{parent:this}),this.$title?this.$subTitle.insertAfter(this.$title):this.$iconContainer?this.$subTitle.insertAfter(this.$iconContainer):this.$statusContainer?this.$subTitle.insertAfter(this.$statusContainer):this.$subTitle.appendTo(this.$container)),this.$subTitle}},{key:"_getOrCreate$IconContainer",value:function(){return this.$iconContainer||(this.$iconContainer=this.$container.makeDiv("icon-container"),this.$title?this.$iconContainer.insertBefore(this.$title):this.$subTitle?this.$iconContainer.insertBefore(this.$subTitle):this.$statusContainer?this.$iconContainer.insertAfter(this.$statusContainer):this.$iconContainer.appendTo(this.$container)),this.$iconContainer}},{key:"_getOrCreate$StatusContainer",value:function(){return this.$statusContainer||(this.$statusContainer=this.$container.prependDiv("status-container")),this.$statusContainer}},{key:"_remove$Title",value:function(){this.$title&&(xp.uninstall(this.$title),this.$title.remove(),this.$title=null)}},{key:"_remove$SubTitle",value:function(){this.$subTitle&&(xp.uninstall(this.$subTitle),this.$subTitle.remove(),this.$subTitle=null)}},{key:"_remove$IconContainer",value:function(){this.$iconContainer&&(this.$iconContainer.remove(),this.$iconContainer=null)}},{key:"_remove$StatusContainer",value:function(){this.$statusContainer&&(this.$statusContainer.remove(),this.$statusContainer=null)}},{key:"setTitle",value:function(e){this.setProperty("title",e)}},{key:"_renderTitle",value:function(){this.title||this.subTitle?this._getOrCreate$Title().textOrNbsp(this.title):this._remove$Title()}},{key:"setSubTitle",value:function(e){this.setProperty("subTitle",e)}},{key:"_renderSubTitle",value:function(){this.subTitle?(this.title||this._renderTitle(),this._getOrCreate$SubTitle().textOrNbsp(this.subTitle)):(this.title||this._renderTitle(),this._remove$SubTitle())}},{key:"setIconId",value:function(e){this.setProperty("iconId",e)}},{key:"_renderIconId",value:function(e){this.iconId?this._getOrCreate$IconContainer().icon(this.iconId):this._remove$IconContainer()}},{key:"setClosable",value:function(e){this.setProperty("closable",e)}},{key:"_renderClosable",value:function(){if(this.closable){if(this.$close)return;this.$container.addClass("closable"),this.$close=this._getOrCreate$StatusContainer().appendDiv("status closer").on("click",this._onClose.bind(this)),this._statusContainerUsageCounter++}else{if(!this.$close)return;this.$container.removeClass("closable"),this.$close.remove(),this.$close=null,this._statusContainerUsageCounter--,0===this._statusContainerUsageCounter&&this._remove$StatusContainer()}}},{key:"setSaveNeededVisible",value:function(e){this.saveNeededVisible!==e&&(this._setProperty("saveNeededVisible",e),this.rendered&&this._renderSaveNeeded())}},{key:"setSaveNeeded",value:function(e){this.saveNeeded!==e&&(this._setProperty("saveNeeded",e),this.rendered&&this._renderSaveNeeded())}},{key:"_renderSaveNeeded",value:function(){if(this.saveNeeded&&this.saveNeededVisible){if(this.$container.addClass("save-needed"),this.$saveNeeded)return;this.$saveNeeded=this._getOrCreate$StatusContainer().prependDiv("status save-needer"),this._statusContainerUsageCounter++}else{if(!this.$saveNeeded)return;this.$container.removeClass("save-needed"),this.$saveNeeded.remove(),this.$saveNeeded=null,this._statusContainerUsageCounter--,0===this._statusContainerUsageCounter&&this._remove$StatusContainer()}}},{key:"setStatus",value:function(e){this.setProperty("status",e)}},{key:"_renderStatus",value:function(){var e=this;this._statusContainerUsageCounter-=0===this._statusIconDivs.length?0:1,this._statusIconDivs.forEach((function(e){e.remove()})),this._statusIconDivs=[],this.status&&this.status.asFlatList().forEach((function(t){if(t&&t.iconId){var n=e._getOrCreate$StatusContainer().appendIcon(t.iconId,"status");t.cssClass()&&n.addClass(t.cssClass()),e._statusIconDivs.push(n)}})),this._statusContainerUsageCounter+=0===this._statusIconDivs.length?0:1,0===this._statusContainerUsageCounter&&this._remove$StatusContainer()}},{key:"select",value:function(){this.setSelected(!0)}},{key:"deselect",value:function(){this.setSelected(!1)}},{key:"setSelected",value:function(e){this.setProperty("selected",e)}},{key:"_renderSelected",value:function(){this.$container.select(this.selected)}},{key:"_onMouseDown",value:function(e){this.trigger("click"),this.$title&&(xp.cancel(this.$title),xp.close(this.$title)),this.$subTitle&&(xp.cancel(this.$subTitle),xp.close(this.$subTitle)),e.preventDefault()}},{key:"_onClose",value:function(){this.view&&this.view.abort()}},{key:"getMenuText",value:function(){return Wn.join(" – ",this.title,this.subTitle)}},{key:"_installViewListeners",value:function(){this.view.on("propertyChange",this._viewPropertyChangeListener),this.view.on("remove",this._viewRemoveListener)}},{key:"_uninstallViewListeners",value:function(){this.view.off("propertyChange",this._viewPropertyChangeListener),this.view.off("remove",this._viewRemoveListener)}},{key:"_onViewPropertyChange",value:function(e){"title"===e.propertyName?this.setTitle(this.view.title):"subTitle"===e.propertyName?this.setSubTitle(this.view.subTitle):"iconId"===e.propertyName?this.setIconId(this.view.iconId):"cssClass"===e.propertyName?this.setCssClass(e.newValue):"saveNeeded"===e.propertyName?this.setSaveNeeded(e.newValue):"saveNeededVisible"===e.propertyName?this.setSaveNeededVisible(e.newValue):"closable"===e.propertyName?this.setClosable(e.newValue):"status"===e.propertyName&&this.setStatus(e.newValue)}},{key:"_onViewRemove",value:function(){this._uninstallViewListeners(),this.rendered?this.remove():this.trigger("remove")}}])&&Spe(t.prototype,n),r&&Spe(t,r),i}(ve);function Dpe(e){return(Dpe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ape(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Fpe(e,t,n){return(Fpe="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Mpe(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function $pe(e,t){return($pe=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function jpe(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Mpe(e);if(t){var o=Mpe(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Bpe(this,n)}}function Bpe(e,t){return!t||"object"!==Dpe(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Mpe(e){return(Mpe=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Ipe=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&$pe(e,t)}(i,e);var t,n,r,o=jpe(i);function i(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),o.call(this)}return t=i,(n=[{key:"_render",value:function(){Fpe(Mpe(i.prototype),"_render",this).call(this),this.$container.addClass("desktop-tab"),this.$container.on("contextmenu",this._onContextMenu.bind(this))}},{key:"_onContextMenu",value:function(e){var t=O.create("Menu",{parent:this,text:this.session.text("ui.CloseAllTabs")});t.on("action",this._onCloseAll.bind(this));var n=O.create("Menu",{parent:this,text:this.session.text("ui.CloseOtherTabs"),enabled:this.parent.tabs.length>1});n.on("action",this._onCloseOther.bind(this)),O.create("ContextMenuPopup",{parent:this,menuItems:[t,n],cloneMenuItems:!1,location:{x:e.pageX,y:e.pageY}}).open()}},{key:"_onCloseAll",value:function(){var e=this.parent.tabs.map((function(e){return e.view}));this.session.desktop.cancelViews(e)}},{key:"_onCloseOther",value:function(){var e=this.parent.tabs.map((function(e){return e.view}));rt.remove(e,this.view),this.session.desktop.cancelViews(e)}}])&&Ape(t.prototype,n),r&&Ape(t,r),i}(Epe);function Lpe(e){return(Lpe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Hpe(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Npe(e,t,n){return(Npe="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Gpe(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function Vpe(e,t){return(Vpe=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Wpe(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Gpe(e);if(t){var o=Gpe(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return zpe(this,n)}}function zpe(e,t){return!t||"object"!==Lpe(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Gpe(e){return(Gpe=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Upe=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Vpe(e,t)}(i,e);var t,n,r,o=Wpe(i);function i(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(e=o.call(this)).displayStyle=i.DisplayStyle.DEFAULT,e.tabs=[],e._selectedViewTab=null,e}return t=i,(n=[{key:"_init",value:function(e){Npe(Gpe(i.prototype),"_init",this).call(this,e),this._tabClickHandler=this._onTabClick.bind(this)}},{key:"_render",value:function(){this.$container=this.$parent.appendDiv("simple-tab-area"),this.htmlComp=ea.install(this.$container,this.session),this.htmlComp.setLayout(new ede(this))}},{key:"_renderProperties",value:function(){Npe(Gpe(i.prototype),"_renderProperties",this).call(this),this._renderDisplayStyle(),this._renderTabs()}},{key:"setDisplayStyle",value:function(e){this.setProperty("displayStyle",e)}},{key:"_renderDisplayStyle",value:function(){this.$container.toggleClass("spread-even",this.displayStyle===i.DisplayStyle.SPREAD_EVEN),this.invalidateLayoutTree()}},{key:"_renderTabs",value:function(){var e=this;this.tabs.slice().reverse().forEach((function(t){e._renderTab(t)}))}},{key:"_renderTab",value:function(e){e.renderAfter(this.$container)}},{key:"_renderVisible",value:function(){this.visible&&this.tabs.length>0?this.attach():this.detach(),this.invalidateLayoutTree()}},{key:"_attach",value:function(){this.$parent.prepend(this.$container),this.invalidateLayoutTree(!1),Npe(Gpe(i.prototype),"_attach",this).call(this)}},{key:"_detach",value:function(){this.$container.detach(),Npe(Gpe(i.prototype),"_detach",this).call(this),this.invalidateLayoutTree(!1)}},{key:"_onTabClick",value:function(e){this.selectTab(e.source)}},{key:"getTabs",value:function(){return this.tabs}},{key:"selectTab",value:function(e){this._selectedViewTab!==e&&(this.deselectTab(this._selectedViewTab),this._selectedViewTab=e,e&&e.select(),this.trigger("tabSelect",{viewTab:e}),e&&e.rendered&&!e.$container.isVisible()&&this.invalidateLayoutTree())}},{key:"deselectTab",value:function(e){e&&this._selectedViewTab===e&&this._selectedViewTab.deselect()}},{key:"getSelectedTab",value:function(){return this._selectedViewTab}},{key:"addTab",value:function(e,t){var n=-1;t&&(n=this.tabs.indexOf(t)),this.tabs.splice(n+1,0,e),e.on("click",this._tabClickHandler),this.rendered&&(this._renderVisible(),e.renderAfter(this.$container,t),me.updateFirstLastMarker(this.getTabs()),this.invalidateLayoutTree())}},{key:"destroyTab",value:function(e){var t=this.tabs.indexOf(e);t>-1&&(this.tabs.splice(t,1),e.destroy(),e.off("click",this._tabClickHandler),this._renderVisible(),me.updateFirstLastMarker(this.getTabs()),this.invalidateLayoutTree())}}])&&Hpe(t.prototype,n),r&&Hpe(t,r),i}(ve);function Kpe(e){return(Kpe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function qpe(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Ype(e,t){return(Ype=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Xpe(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Zpe(e);if(t){var o=Zpe(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Jpe(this,n)}}function Jpe(e,t){return!t||"object"!==Kpe(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Zpe(e){return(Zpe=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Qpe(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}!function(e,t,n){t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}(Upe,"DisplayStyle",{DEFAULT:"default",SPREAD_EVEN:"spreadEven"});var ede=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ype(e,t)}(i,e);var t,n,r,o=Xpe(i);function i(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(t=o.call(this)).tabArea=e,t._$overflowTab=null,t._overflowTabsIndizes=[],t}return t=i,(n=[{key:"layout",value:function(e){var t,n=this.tabArea.htmlComp,r=n.size({exact:!0}),o=n.$comp.find(".simple-tab"),a=this.tabArea.getTabs().length,l=this.smallPrefSize();if(r=r.subtract(n.insets()),this._$overflowTab&&this._$overflowTab.remove(),o.setVisible(!0),this._overflowTabsIndizes=[],l.width<=r.width)return t=this.tabArea.displayStyle===Upe.DisplayStyle.SPREAD_EVEN?r.width/a:Math.min(i.TAB_WIDTH_LARGE,r.width/a),o.each((function(){s()(this).outerWidth(t)})),void e.removeClass("overflown");e.addClass("overflown"),r.width-=i.OVERFLOW_MENU_WIDTH;var u=Math.floor(r.width/i.TAB_WIDTH_SMALL),c=a-u,f=0,h=0;o.each((function(){s()(this).hasClass("selected")&&(h=f),f++}));var p,d=h-Math.floor(u/2);d<0?(d=0,p=u-1):(p=d+u-1)>a-1&&(d=(p=a-1)-u+1),this._$overflowTab=n.$comp.appendDiv("simple-overflow-tab-item").on("mousedown",this._onMouseDownOverflow.bind(this)),this._$overflowTab.appendDiv("num-tabs").text(c);var y=this;t=this.tabArea.displayStyle===Upe.DisplayStyle.SPREAD_EVEN?r.width/u:i.TAB_WIDTH_SMALL,f=0,o.each((function(){f>=d&&f<=p?s()(this).outerWidth(t):(s()(this).setVisible(!1),y._overflowTabsIndizes.push(f)),f++}))}},{key:"smallPrefSize",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return e=s.a.extend({minTabWidth:i.TAB_WIDTH_SMALL},e),this.preferredLayoutSize(this.tabArea.$container,e)}},{key:"preferredLayoutSize",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.minTabWidth||i.TAB_WIDTH_LARGE,r=this.tabArea.getTabs().length,o=r*n;t=s.a.extend({useCssSize:!0},t);var a=qs.prefSize(this.tabArea.$container,t);return t.widthHint&&this.tabArea.displayStyle===Upe.DisplayStyle.SPREAD_EVEN&&(o=Math.max(t.widthHint,o)),new $s(o,a.height)}},{key:"_onMouseDownOverflow",value:function(e){var t,n,r=this.tabArea,o=[];this._overflowTabsIndizes.forEach((function(e){n=this.tabArea.getTabs()[e],(t=O.create("Menu",{parent:this.tabArea,text:n.getMenuText(),tab:n})).on("action",function(){s.a.log.isDebugEnabled()&&s.a.log.debug("(SimpleTabAreaLayout#_onMouseDownOverflow) tab="+this),r.selectTab(this)}.bind(n)),o.push(t)}),this),O.create("ContextMenuPopup",{parent:this.tabArea,menuItems:o,cloneMenuItems:!1,location:{x:e.pageX,y:e.pageY}}).open()}}])&&qpe(t.prototype,n),r&&qpe(t,r),i}(Zs);function tde(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}Qpe(ede,"TAB_WIDTH_LARGE",220),Qpe(ede,"TAB_WIDTH_SMALL",130),Qpe(ede,"OVERFLOW_MENU_WIDTH",30);var nde=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,(n=[{key:"accept",value:function(e){return!e.parentNode||!!e.parentNode.filterAccepted&&(!e.parentNode.detailTable||!e.row||e.row.filterAccepted)}}])&&tde(t.prototype,n),r&&tde(t,r),e}();function rde(e){return(rde="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ode(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ide(e,t,n){return(ide="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=cde(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function sde(e,t){return(sde=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function ade(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=cde(e);if(t){var o=cde(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return lde(this,n)}}function lde(e,t){return!t||"object"!==rde(t)&&"function"!=typeof t?ude(e):t}function ude(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function cde(e){return(cde=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var fde=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&sde(e,t)}(i,e);var t,n,r,o=ade(i);function i(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(e=o.call(this)).compact=!1,e.defaultDetailForm=null,e.detailContent=null,e.embedDetailContent=!1,e.inBackground=!1,e.iconId=null,e.iconVisible=!1,e.mediator=null,e.navigateButtonsVisible=!0,e.navigateUpInProgress=!1,e.outlineOverview=null,e.outlineOverviewVisible=!0,e.toggleBreadcrumbStyleEnabled=!0,e.title=null,e.titleVisible=!0,e.menus=[],e.titleMenuBar=null,e.nodeMenuBar=null,e.nodeMenuBarVisible=!1,e.detailMenuBar=null,e.detailMenuBarVisible=!1,e.detailContent=null,e.dialogs=[],e.views=[],e.messageBoxes=[],e.fileChoosers=[],e.formController=null,e.messageBoxController=null,e.fileChooserController=null,e._detailContentDestroyHandler=e._onDetailContentDestroy.bind(ude(e)),e._detailMenusNodesSelectedHandler=null,e._additionalContainerClasses+=" outline",e.nodePaddingLevelCheckable=20,e.nodePaddingLevelNotCheckable=20,e._scrolldirections="y",e._addWidgetProperties(["defaultDetailForm","views","selectedViewTabs","dialogs","messageBoxes","fileChoosers"]),e}return t=i,(n=[{key:"_init",value:function(e){this.compact=O.nvl(e.compact,e.parent.session.desktop.displayStyle===kae.DisplayStyle.COMPACT),this.embedDetailContent=O.nvl(e.embedDetailContent,this.compact),this.addFilter(new nde,!0),ide(cde(i.prototype),"_init",this).call(this,e),this.mediator=this._createMediator(),this.formController=O.create("FormController",{displayParent:this,session:this.session}),this.messageBoxController=new TU(this,this.session),this.fileChooserController=new rT(this,this.session),this.resolveTextKeys(["title"]),this.titleMenuBar=O.create("MenuBar",{parent:this,menuOrder:new zJ}),this.nodeMenuBar=O.create("MenuBar",{parent:this,position:Yw.Position.BOTTOM,menuOrder:new zJ}),this.detailMenuBar=O.create("MenuBar",{parent:this,position:Yw.Position.BOTTOM,menuOrder:new zJ}),this._setDefaultDetailForm(this.defaultDetailForm),this._setOutlineOverviewVisible(this.outlineOverviewVisible),this._setOutlineOverview(this.outlineOverview),this._updateOutlineOverview(),this._setViews(this.views),this._setMenus(this.menus),this.updateDetailContent()}},{key:"_createMediator",value:function(){return O.create("OutlineMediator")}},{key:"_createTreeNode",value:function(e){var t=s.a.extend({objectType:"Page"},e);return this._createChild(t)}},{key:"_applyNodeDefaultValues",value:function(e){Mt.applyTo(e,"Page")}},{key:"_createKeyStrokeContext",value:function(){return new dve(this)}},{key:"_filterMenus",value:function(e,t,n,r){return[]}},{key:"_initTreeKeyStrokeContext",value:function(){var e=Ru.CTRL|Ru.SHIFT;this.keyStrokeContext.registerKeyStroke([new IN(this,e),new UN(this,e),new kve(this,e),new eV(this,e),new vV(this,e),new TV(this,e)]),this.keyStrokeContext.$bindTarget=function(){return this.session.$entryPoint}.bind(this)}},{key:"_render",value:function(){ide(cde(i.prototype),"_render",this).call(this),this.htmlComp.setLayout(new Ede(this)),this._renderCompact(),this._renderEmbedDetailContent(),this._renderDetailContent(),this._renderDetailMenuBarVisible(),this._renderNodeMenuBarVisible()}},{key:"_renderProperties",value:function(){ide(cde(i.prototype),"_renderProperties",this).call(this),this._renderTitle(),this._updateIcon(),this._renderTitleMenuBar()}},{key:"_computeNodePaddingLeft",value:function(e){return this._computeNodePaddings(),this.compact?e.row&&e.getOutline().selectedNode()!==e?e.row._hierarchyLevel*this.nodePaddingLevel:0:ide(cde(i.prototype),"_computeNodePaddingLeft",this).call(this,e)}},{key:"_remove",value:function(){ide(cde(i.prototype),"_remove",this).call(this),this._removeTitle(),this._removeIcon()}},{key:"_renderTitle",value:function(){this.titleVisible&&(this.$title||(this.$title=this.$container.prependDiv("outline-title").on("mousedown",this._onTitleMouseDown.bind(this)).toggleClass("touch",Kt.get().supportsOnlyTouch()),this.$titleText=this.$title.prependDiv("outline-title-text")),this.$titleText.text(this.title))}},{key:"_removeTitle",value:function(){this.titleVisible&&(this.$title.remove(),this.$title=null)}},{key:"setIconVisible",value:function(e){this.setProperty("iconVisible",e),this.rendered&&this._updateIcon()}},{key:"setIconId",value:function(e){this.setProperty("iconId",e),this.rendered&&this._updateIcon()}},{key:"_updateIcon",value:function(){if(this.titleVisible&&this.iconVisible&&this.iconId){if(this.icon)return void this.icon.setIconDesc(this.iconId);this.icon=O.create("Icon",{parent:this,iconDesc:this.iconId,prepend:!0}),this.icon.render(this.$title)}else{if(!this.icon)return;this.icon.remove(),this.icon=null}}},{key:"_removeIcon",value:function(){this.icon&&(this.icon.remove(),this.icon=null)}},{key:"_renderTitleMenuBar",value:function(){this.titleVisible&&(this.titleMenuBar.render(this.$title),this.titleMenuBar.$container.addClass("prevent-initial-focus"))}},{key:"_renderEnabled",value:function(){ide(cde(i.prototype),"_renderEnabled",this).call(this),this.$container.setTabbable(!1)}},{key:"_initTreeNodeInternal",value:function(e,t){ide(cde(i.prototype),"_initTreeNodeInternal",this).call(this,e,t),this._initDetailTableAndForm(e),this.trigger("pageInit",{page:e})}},{key:"_initDetailTableAndForm",value:function(e){e.detailTable&&this._initDetailTable(e),e.detailForm&&this._initDetailForm(e)}},{key:"_initDetailTable",value:function(e){this.navigateButtonsVisible&&e.navigateButtonsVisible&&this._appendNavigateButtonsForDetailTable(e)}},{key:"_initDetailForm",value:function(e){var t=this;this.navigateButtonsVisible&&e.navigateButtonsVisible&&this._appendNavigateButtonsForDetailForm(e),e.detailForm.detailForm=!0,e.detailForm.one("destroy",(function(){e.detailForm=null,t._triggerPageChanged(e)}))}},{key:"_createNavigateButtons",value:function(e,t){var n=rt.ensure(t.staticMenus);if(!this._hasMenu(n,sve)){var r=O.create("NavigateUpButton",{parent:t,altKeyStrokeContext:t.keyStrokeContext,outline:this,node:e});n.push(r)}if(!this._hasMenu(n,Zye)){var o=O.create("NavigateDownButton",{parent:t,altKeyStrokeContext:t.keyStrokeContext,outline:this,node:e});n.push(o)}return n}},{key:"_getMenu",value:function(e,t){for(var n=0;n<e.length;n++)if(e[n]instanceof t)return e[n];return null}},{key:"_hasMenu",value:function(e,t){return null!==this._getMenu(e,t)}},{key:"_onTitleMouseDown",value:function(e){this.titleMenuBar.rendered&&this.titleMenuBar.$container.isOrHas(e.target)||this.navigateToTop()}},{key:"navigateToTop",value:function(){this.compact&&this.embedDetailContent?this.selectNode(this.compactRootNode()||[]):this.deselectAll(),this.handleInitialExpanded(),this.setScrollTop(0)}},{key:"compactRootNode",value:function(){return this.nodes[0]&&this.nodes[0].compactRoot?this.nodes[0]:null}},{key:"handleInitialExpanded",value:function(){var e=this;this.visitNodes((function(t){e.setNodeExpanded(t,t.initialExpanded,{renderExpansion:!0})}))}},{key:"_onNodeDeleted",value:function(e){e.detailTable&&(e.detailTable.destroy(),e.detailTable=null)}},{key:"selectNodes",value:function(e,t){(e=rt.ensure(e)).length>0&&this.isNodeSelected(e[0])||0===e.length&&0===this.selectedNodes.length||(this.navigateUpInProgress?this.navigateUpInProgress=!1:1===e.length&&this.setDetailFormVisibleByUi(e[0],!0),ide(cde(i.prototype),"selectNodes",this).call(this,e,t))}},{key:"_setSelectedNodes",value:function(e,t){ide(cde(i.prototype),"_setSelectedNodes",this).call(this,e,t),this.updateDetailContent()}},{key:"_nodesSelectedInternal",value:function(){var e=this.activePage();e&&(e.activate(),e.ensureLoadChildren().done(this._onLoadChildrenDone.bind(this,e)))}},{key:"_renderSelection",value:function(){ide(cde(i.prototype),"_renderSelection",this).call(this),this.$container.toggleClass("node-selected",this.selectedNodes.length>0);var e=this.prevSelectedNode;this.embedDetailContent&&e&&e.$node&&(e.$node.cssHeight(null).cssWidth(null),e.height=e.$node.outerHeight(!0))}},{key:"_removeNodeSelection",value:function(e){e.$text&&!this.isHorizontalScrollingEnabled()&&e.$text.cssWidth(null),ide(cde(i.prototype),"_removeNodeSelection",this).call(this,e)}},{key:"setDefaultDetailForm",value:function(e){this.setProperty("defaultDetailForm",e)}},{key:"_setDefaultDetailForm",value:function(e){this.defaultDetailForm&&(this.defaultDetailForm.detailForm=!1),this._setProperty("defaultDetailForm",e),this.defaultDetailForm&&(this.defaultDetailForm.detailForm=!0),this.initialized&&(this._updateOutlineOverview(),this.updateDetailContent())}},{key:"setOutlineOverviewVisible",value:function(e){this.setProperty("outlineOverviewVisible",e),this._updateOutlineOverview()}},{key:"_setOutlineOverviewVisible",value:function(e){this._setProperty("outlineOverviewVisible",e)}},{key:"setOutlineOverview",value:function(e){this.setProperty("outlineOverview",e),this._updateOutlineOverview()}},{key:"_setOutlineOverview",value:function(e){e&&(e=this._createChild(e)),this._setProperty("outlineOverview",e)}},{key:"_updateOutlineOverview",value:function(){this.defaultDetailForm?this.outlineOverview&&(this.outlineOverview.destroy(),this._setOutlineOverview(null)):this.outlineOverviewVisible?this.outlineOverview||this._setOutlineOverview(this._createOutlineOverview()):this.outlineOverview&&(this.outlineOverview.destroy(),this._setOutlineOverview(null))}},{key:"_createOutlineOverview",value:function(){return O.create("TileOutlineOverview",{parent:this,outline:this,page:this.compact?this.compactRootNode():null})}},{key:"setNavigateButtonsVisible",value:function(e){this.setProperty("navigateButtonsVisible",e)}},{key:"_setNavigateButtonsVisible",value:function(e){this._setProperty("navigateButtonsVisible",e),this.visitNodes(this._setNavigateButtonsVisibleForNode.bind(this))}},{key:"_setNavigateButtonsVisibleForNode",value:function(e,t){this.navigateButtonsVisible?(e.detailForm&&this._appendNavigateButtonsForDetailForm(e),e.detailTable&&this._appendNavigateButtonsForDetailTable(e)):(e.detailForm&&this._removeNavigateButtonsForDetailForm(e),e.detailTable&&this._removeNavigateButtonsForDetailTable(e))}},{key:"_appendNavigateButtonsForDetailForm",value:function(e){var t=this._createNavigateButtons(e,e.detailForm.rootGroupBox);e.detailForm.rootGroupBox.setStaticMenus(t)}},{key:"_appendNavigateButtonsForDetailTable",value:function(e){var t=this._createNavigateButtons(e,e.detailTable);e.detailTable.setStaticMenus(t)}},{key:"_removeNavigateButtonsForDetailForm",value:function(e){var t=e.detailForm.rootGroupBox.staticMenus.filter((function(e){return!(e instanceof Wye)}));e.detailForm.rootGroupBox.setStaticMenus(t)}},{key:"_removeNavigateButtonsForDetailTable",value:function(e){var t=e.detailTable.staticMenus.filter((function(e){return!(e instanceof Wye)}));e.detailTable.setStaticMenus(t)}},{key:"selectedRow",value:function(){var e=this.selectedNode();return e&&e.detailTable?e.detailTable.selectedRow():null}},{key:"_isGroupingEnd",value:function(e){return e.nodeType===Che.NodeType.TABLE}},{key:"_isTruncatedNodeTooltipEnabled",value:function(){return!1}},{key:"setDetailFormVisibleByUi",value:function(e,t){e.detailFormVisibleByUi=t,this._triggerPageChanged(e)}},{key:"validateFocus",value:function(){this.session.focusManager.validateFocus()}},{key:"sendToBack",value:function(){this.inBackground=!0,this._renderInBackground(),this.formController.detachDialogs(),this.messageBoxController.detach(),this.fileChooserController.detach()}},{key:"bringToFront",value:function(){this.inBackground=!1,this._renderInBackground(),this.formController.attachDialogs(),this.messageBoxController.attach(),this.fileChooserController.attach()}},{key:"_renderInBackground",value:function(){this.$container.toggleClass("in-background",this.inBackground)}},{key:"_renderCompact",value:function(){this.$container.toggleClass("compact",this.compact),this.invalidateLayoutTree()}},{key:"_renderEmbedDetailContent",value:function(){this.$data.toggleClass("has-detail-content",this.embedDetailContent),this.invalidateLayoutTree()}},{key:"_renderDetailContent",value:function(){if(this.detailContent&&!this.detailContent.rendered){var e=this.selectedNode();e.rendered&&(e.$text.setVisible(!!e.text),e._decorate(),this.detailContent.render(e.$node),this.detailContent.htmlComp&&(this.detailContent.htmlComp.validateRoot=!1),this._ensurePageLayout(e),this.$data.addClass("detail-content-visible"))}}},{key:"_ensurePageLayout",value:function(e){e.htmlComp=ea.install(e.$node,this.session),e.htmlComp.setLayout(new fye(this,e))}},{key:"_removeDetailContent",value:function(){this.detailContent&&(this.detailContent.remove(),this.$data.removeClass("detail-content-visible"))}},{key:"_postRenderViewRange",value:function(){ide(cde(i.prototype),"_postRenderViewRange",this).call(this),this._renderDetailContent(),this._renderDetailMenuBarVisible(),this._renderNodeMenuBarVisible()}},{key:"setCompact",value:function(e){this.setProperty("compact",e)}},{key:"setEmbedDetailContent",value:function(e){this.setProperty("embedDetailContent",e)}},{key:"_setEmbedDetailContent",value:function(e){this._setProperty("embedDetailContent",e),this.updateDetailContent()}},{key:"_onDetailContentDestroy",value:function(e){this.setDetailContent(null),this.updateDetailMenus()}},{key:"setDetailContent",value:function(e){this.detailContent!==e&&(this.rendered&&this._removeDetailContent(),this.detailContent&&this.detailContent.off("destroy",this._detailContentDestroyHandler),this.detailContent instanceof oA&&this.detailContent.destroy(),this._setProperty("detailContent",e),e&&e.on("destroy",this._detailContentDestroyHandler),this.rendered&&this._renderDetailContent(),this.invalidateLayoutTree())}},{key:"updateDetailContent",value:function(){if(!this.embedDetailContent)return this.setDetailContent(null),void this.setDetailMenus([]);this.setDetailMenuBarVisible(!1),this.setNodeMenuBarVisible(!1),this.setDetailContent(this._computeDetailContent()),this.updateDetailMenus()}},{key:"_updateScrollTopAfterSelection",value:function(){if(this.embedDetailContent){if(this.validateLayoutTree(),ide(cde(i.prototype),"_updateScrollTopAfterSelection",this).call(this),this.selectedNodes[0]&&this.selectedNodes[0].parentNode){if(this.prevSelectedNode&&this.prevSelectedNode.isDescendantOf(this.selectedNodes[0]))return;this.scrollTo(this.selectedNodes[0].parentNode,{align:"top",animate:!0})}}else ide(cde(i.prototype),"_updateScrollTopAfterSelection",this).call(this)}},{key:"_computeDetailContent",value:function(){var e=this.selectedNode();if(!e)return null;if(e.detailForm&&e.detailFormVisible&&e.detailFormVisibleByUi)return e.detailForm;if(e===this.compactRootNode()){var t=this._computeRootContent();if(t)return t}return e.row&&e.parentNode.nodeType===Che.NodeType.TABLE?O.create("TableRowDetail",{parent:this,table:e.parentNode.detailTable,page:e}):null}},{key:"_computeRootContent",value:function(){return this.defaultDetailForm?this.defaultDetailForm:this.outlineOverview}},{key:"updateDetailMenus",value:function(){if(this.embedDetailContent){var e,t=this.selectedNodes[0],n=[],r=[],o=[],i=[];if(this.detailContent&&this.detailContent instanceof CC){var s=this.detailContent.rootGroupBox;n=s.processMenus.concat(s.menus),s.setMenuBarVisible(!1),this._attachDetailMenusListener(s)}else if(t&&!(this.detailContent instanceof Eve)){t.detailTable&&(e=t.detailTable,n=zm.filter(e.menus,["Table.EmptySpace"],!1,!0),r=e.tableControls,e.setMenuBarVisible(!1),this._attachDetailMenusListener(e));var a=t.parentNode;a&&a.detailTable&&(e=a.detailTable,n=n.concat(zm.filter(e.menus,["Table.SingleSelection"],!1,!0)),e.setMenuBarVisible(!1),this._attachDetailMenusListener(e))}this.nodeMenuBar.menuItems.filter((function(e){return e instanceof W$})).forEach((function(e){return e.destroy()})),r.forEach((function(e){var t=O.create("TableControlAdapterMenu",W$.adaptTableControlProperties(e,{parent:this,tableControl:e,horizontalAlignment:1}));o.push(t)}),this),n.forEach((function(e){1===e.horizontalAlignment?o.push(e):i.push(e)}),this),this.setNodeMenus(o),this.setDetailMenus(i)}}},{key:"_attachDetailMenusListener",value:function(e){this._detailMenusChangeHandler||(this._detailMenusChangeHandler=function(e){"menus"!==e.propertyName&&"tableControls"!==e.propertyName||this.updateDetailMenus()}.bind(this)),this._detailMenusDestroyHandler||(this._detailMenusDestroyHandler=function(){e.off("propertyChange",this._detailMenusChangeHandler)}.bind(this)),e.off("propertyChange",this._detailMenusChangeHandler),e.on("propertyChange",this._detailMenusChangeHandler),e.off("destroy",this._detailMenusDestroyHandler),e.one("destroy",this._detailMenusDestroyHandler),this._detailMenusNodesSelectedHandler||(this._detailMenusNodesSelectedHandler={outline:this,menuContainers:[],addMenuContainer:function(e){this.menuContainers.indexOf(e)>-1||this.menuContainers.push(e)},func:function(e){"nodesSelected"===e.type&&(this.menuContainers.forEach((function(e){e.off("propertyChange",this.outline._detailMenusChangeHandler),e.off("destroy",this.outline._detailMenusDestroyHandler)}),this),this.menuContainers=[])}},this.addListener(this._detailMenusNodesSelectedHandler)),this._detailMenusNodesSelectedHandler.addMenuContainer(e)}},{key:"setDetailMenus",value:function(e){this.detailMenuBar.setMenuItems([]),this.detailMenuBar.setMenuItems(e),this.setDetailMenuBarVisible(this.detailMenuBar.menuItems.length>0)}},{key:"_renderDetailMenuBarVisible",value:function(){this.detailMenuBarVisible?this._renderDetailMenuBar():this._removeDetailMenuBar()}},{key:"_renderDetailMenuBar",value:function(){if(!this.detailMenuBar.rendered){var e=this.selectedNode();e&&e.rendered&&(this.detailMenuBar.render(e.$node),this.detailMenuBar.$container.addClass("detail-menubar"),this.detailContent&&this.detailContent.rendered&&this.detailMenuBar.$container.insertBefore(this.detailContent.$container),this._ensurePageLayout(e),this.invalidateLayoutTree())}}},{key:"_removeDetailMenuBar",value:function(){this.detailMenuBar.rendered&&(this.detailMenuBar.remove(),this.invalidateLayoutTree())}},{key:"setDetailMenuBarVisible",value:function(e){this.setProperty("detailMenuBarVisible",e)}},{key:"setNodeMenus",value:function(e){this.nodeMenuBar.setMenuItems([]),this.nodeMenuBar.setMenuItems(e),this.setNodeMenuBarVisible(this.nodeMenuBar.menuItems.length>0)}},{key:"_renderNodeMenuBarVisible",value:function(){this.nodeMenuBarVisible?this._renderNodeMenuBar():this._removeNodeMenuBar()}},{key:"_renderNodeMenuBar",value:function(){if(!this.nodeMenuBar.rendered){var e=this.selectedNode();if(e&&e.rendered){var t=e.$text;this.nodeMenuBar.render(e.$node),this.nodeMenuBar.$container.addClass("node-menubar"),this.nodeMenuBar.$container.insertAfter(t),this.invalidateLayoutTree()}}}},{key:"_removeNodeMenuBar",value:function(){this.nodeMenuBar.rendered&&(this.nodeMenuBar.remove(),this.invalidateLayoutTree())}},{key:"setNodeMenuBarVisible",value:function(e){this.setProperty("nodeMenuBarVisible",e)}},{key:"glassPaneTargets",value:function(){return this._glassPaneTargets()}},{key:"_glassPaneTargets",value:function(e){var t=this.session.desktop,n=[];return t.navigation&&n.push(t.navigation.$body),t.bench&&e instanceof CC&&e.displayHint===CC.DisplayHint.VIEW&&rt.pushAll(n,this._getBenchGlassPaneTargetsForView(e)),t.bench&&t.bench.outlineContent&&rt.pushAll(n,t.bench.outlineContent.glassPaneTargets(e)),n}},{key:"_getBenchGlassPaneTargetsForView",value:function(e){var t=[];return t=t.concat(this._getTabGlassPaneTargetsForView(e,this.session.desktop.header)),this.session.desktop.bench.visibleTabBoxes().forEach((function(n){n.hasView(e)?rt.pushAll(t,this._getTabGlassPaneTargetsForView(e,n)):n.$container&&t.push(n.$container)}),this),t}},{key:"_getTabGlassPaneTargetsForView",value:function(e,t){var n=this,r=[];return t.tabArea.tabs.forEach((function(t){t.view!==e&&t.view.displayParent===n&&(r.push(t.$container),t.$container.addClass("no-hover"))})),r}},{key:"_onGlassPaneMouseDown",value:function(e,t){var n=this.session.desktop;n.navigation&&t.parent()[0]===n.navigation.$body[0]&&n.bringOutlineToFront()}},{key:"inFront",value:function(){return this.session.desktop.outline===this&&!this.inBackground}},{key:"acceptDialog",value:function(e){return this.session.desktop.outline===this}},{key:"acceptView",value:function(e){return this.session.desktop.outline===this}},{key:"activateCurrentPage",value:function(){var e=this.activePage();e&&e.activate()}},{key:"activePage",value:function(){return this.selectedNode()}},{key:"_setViews",value:function(e){var t=this;e&&e.forEach((function(e){e.setDisplayParent(t)})),this._setProperty("views",e)}},{key:"_setMenus",value:function(e){var t=this.menus;if(this.updateKeyStrokes(e,t),this._setProperty("menus",e),this.titleMenuBar){var n=zm.filter(this.menus,["Tree.Header"]);this.titleMenuBar.setMenuItems(n)}}},{key:"_triggerPageChanged",value:function(e){this.trigger("pageChanged",{page:e})}},{key:"_onLoadChildrenDone",value:function(e){e&&this._initDetailTableAndForm(e)}},{key:"pageChanged",value:function(e){e&&this._initDetailTableAndForm(e);var t=this.selectedNode();(e||t)&&e!==t||this.updateDetailContent(),this._triggerPageChanged(e)}}])&&ode(t.prototype,n),r&&ode(t,r),i}(KH);function hde(e){return(hde="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function pde(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function dde(e,t,n){return(dde="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=gde(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function yde(e,t){return(yde=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function vde(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=gde(e);if(t){var o=gde(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return bde(this,n)}}function bde(e,t){return!t||"object"!==hde(t)&&"function"!=typeof t?mde(e):t}function mde(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function gde(e){return(gde=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var _de=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&yde(e,t)}(i,e);var t,n,r,o=vde(i);function i(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(e=o.call(this))._filterDirty=!1,e._nodeIdToRowMap={},e._detailTableRowInitHandler=e._onDetailTableRowInit.bind(mde(e)),e._detailTableRowsInsertedHandler=e._onDetailTableRowsInserted.bind(mde(e)),e._detailTableFilterRemoved=e._onDetailTableFilterRemoved.bind(mde(e)),e}return t=i,r=[{key:"modifyOutlinePrototype",value:function(){E.get().remote&&(Pr.replacePrototypeFunction(fde,"_computeDetailContent",i._computeDetailContentRemote,!0),Pr.replacePrototypeFunction(fde,"updateDetailMenus",i.updateDetailMenusRemote,!0),Pr.replacePrototypeFunction(fde,"_initTreeNodeInternal",i._initTreeNodeInternalRemote,!0))}},{key:"_computeDetailContentRemote",value:function(){if(!this.modelAdapter)return this._computeDetailContentOrig();var e=this.selectedNode();return e?e.detailForm||e.detailFormResolved?(e.detailFormResolved=!0,this._computeDetailContentOrig()):this.session.areRequestsPending()||this.session.areEventsQueued()?void this.session.listen().done(function(e){e.detailFormResolved||(e.detailFormResolved=!0,this.updateDetailContent())}.bind(this,e)):(e.detailFormResolved=!0,this._computeDetailContentOrig()):null}},{key:"updateDetailMenusRemote",value:function(){return this.modelAdapter?this.selectedNode()&&this.selectedNode().detailFormResolved?this.updateDetailMenusOrig():void 0:this.updateDetailMenusOrig()}},{key:"_initTreeNodeInternalRemote",value:function(e,t){this._initTreeNodeInternalOrig(e,t),this.modelAdapter&&(this.modelAdapter.widget=this,e.detailTable&&this.modelAdapter._initDetailTable(e),this.modelAdapter._linkNodeWithRowLater(e))}}],(n=[{key:"_onPageChanged",value:function(e){var t=this.widget._nodeById(e.nodeId);t.overviewIconId=e.overviewIconId,t.detailFormVisible=e.detailFormVisible;var n=this.session.getOrCreateWidget(e.detailForm,this.widget);n!==t.detailForm&&t.setDetailForm(n),t.navigateButtonsVisible=e.navigateButtonsVisible,t.detailTableVisible=e.detailTableVisible;var r=this.session.getOrCreateWidget(e.detailTable,this.widget);t.detailTable!==r&&(t.detailTable&&this._destroyDetailTable(t),t.setDetailTable(r),t.detailTable&&this._initDetailTable(t)),this.widget.pageChanged(t)}},{key:"onModelAction",value:function(e){"pageChanged"===e.type?this._onPageChanged(e):dde(gde(i.prototype),"onModelAction",this).call(this,e)}},{key:"_initDetailTable",value:function(e){e.detailTable.rows.forEach(this._linkNodeWithRow.bind(this)),e.detailTable.on("rowInit",this._detailTableRowInitHandler),e.detailTable.on("rowsInserted",this._detailTableRowsInsertedHandler),e.detailTable.on("filterRemoved",this._detailTableFilterRemoved)}},{key:"_destroyDetailTable",value:function(e){this._nodeIdToRowMap={},e.detailTable.rows.forEach(this._unlinkNodeWithRow.bind(this)),e.detailTable.off("rowInit",this._detailTableRowInitHandler),e.detailTable.off("rowsInserted",this._detailTableRowsInsertedHandler),e.detailTable.off("filterRemoved",this._detailTableFilterRemoved)}},{key:"_linkNodeWithRow",value:function(e){O.assertParameter("row",e);var t,n=e.nodeId;void 0!==n&&((t=this.widget.nodesMap[n])?t.linkWithRow(e):this._nodeIdToRowMap[n]=e)}},{key:"_unlinkNodeWithRow",value:function(e){var t=this.widget.nodesMap[e.nodeId];t&&t.unlinkWithRow(e)}},{key:"_onDetailTableRowInit",value:function(e){this._linkNodeWithRow(e.row);var t=this.widget.nodesMap[e.row.nodeId];this.widget.isSelectedNode(t)&&!this.widget.detailContent&&this.widget.updateDetailContent()}},{key:"_onDetailTableRowsInserted",value:function(e){var t=e.source;(this._filterDirty||t._filterCount()>0&&e.rows.some((function(e){return!e.filterAccepted})))&&(this._filterDirty=!1,this.widget.filter(!0))}},{key:"_onDetailTableFilterRemoved",value:function(e){var t=e.source;t.modelAdapter&&t.modelAdapter._rebuildingTable&&(this._filterDirty=!0)}},{key:"_linkNodeWithRowLater",value:function(e){if(e.parentNode&&e.parentNode.detailTable&&this._nodeIdToRowMap.hasOwnProperty(e.id)){var t=this._nodeIdToRowMap[e.id];e.linkWithRow(t),delete this._nodeIdToRowMap[e.id]}}}])&&pde(t.prototype,n),r&&pde(t,r),i}(tN);function wde(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}E.addListener("bootstrap",_de.modifyOutlinePrototype);var kde=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,(n=[{key:"init",value:function(e){}},{key:"_skipEvent",value:function(e){return null===e||null===e.getOutline()||e.leaf}},{key:"onTableRowsInserted",value:function(e,t,n){this._skipEvent(n)||n.getTree().insertNodes(t,n)}},{key:"onTableRowsDeleted",value:function(e,t,n){this._skipEvent(n)||n.getTree().deleteNodes(t,n)}},{key:"onTableRowsUpdated",value:function(e,t){if(!this._skipEvent(t)){var n=t.updatePagesFromTableRows(e.rows);t.getTree().updateNodes(n)}}},{key:"onTableRowAction",value:function(e,t){var n=e.row.page;if(n){var r=n.getOutline();r&&(r.selectNode(n),r.setNodeExpanded(n,!0))}}},{key:"onTableRowOrderChanged",value:function(e,t){if(!this._skipEvent(t)){var n=e.source,r=t.pagesForTableRows(n.rows);t.getOutline().updateNodeOrder(r,t)}}},{key:"onTableFilter",value:function(e,t){t.getOutline().filter()}}])&&wde(t.prototype,n),r&&wde(t,r),e}();function Sde(e){return(Sde="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ode(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Tde(e,t,n){return(Tde="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=xde(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function Cde(e,t){return(Cde=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Pde(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=xde(e);if(t){var o=xde(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Rde(this,n)}}function Rde(e,t){return!t||"object"!==Sde(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function xde(e){return(xde=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Ede=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Cde(e,t)}(i,e);var t,n,r,o=Pde(i);function i(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(t=o.call(this,e)).outline=e,t}return t=i,(n=[{key:"_layout",value:function(e){var t,n=this.outline.htmlComp;if(Tde(xde(i.prototype),"_layout",this).call(this,e),t=n.availableSize().subtract(n.insets()),this.outline.embedDetailContent){var r=this.outline.selectedNodes[0];if(r&&r.rendered){var o=r.htmlComp;if(o){var s=o.prefSize({widthHint:t.width});o.setSize(new $s(t.width,s.height)),r.height=s.height+o.margins().vertical()}}}this.outline.titleMenuBar.validateLayout(),this.outline.nodeMenuBar.validateLayout(),this.outline.detailMenuBar.validateLayout()}},{key:"_setDataHeight",value:function(e){var t=null;this.outline.titleVisible&&(t=qs.size(this.outline.$title,!0)),Tde(xde(i.prototype),"_setDataHeight",this).call(this,e+(null===t?0:t.height))}}])&&Ode(t.prototype,n),r&&Ode(t,r),i}(cN);function Dde(e){return(Dde="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ade(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Fde(e,t,n){return(Fde="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Mde(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function $de(e,t){return($de=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function jde(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Mde(e);if(t){var o=Mde(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Bde(this,n)}}function Bde(e,t){return!t||"object"!==Dde(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Mde(e){return(Mde=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Ide=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&$de(e,t)}(i,e);var t,n,r,o=jde(i);function i(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(e=o.call(this))._addWidgetProperties("outline"),e._addPreserveOnPropertyChangeProperties(["outline"]),e._addCloneProperties(["outline"]),e}return t=i,(n=[{key:"_init",value:function(e){Fde(Mde(i.prototype),"_init",this).call(this,e),this._setOutline(this.outline)}},{key:"_setOutline",value:function(e){this._setProperty("outline",e),this.outline&&this.outline.setIconId(this.iconId)}},{key:"_setIconId",value:function(e){this._setProperty("iconId",e),this.outline&&this.outline.setIconId(this.iconId)}},{key:"_doAction",value:function(){Fde(Mde(i.prototype),"_doAction",this).call(this),this.outline&&(this.session.desktop.setOutline(this.outline),this.session.desktop.bringOutlineToFront())}},{key:"onOutlineChange",value:function(e){var t=!!e&&this.outline===e;this.setSelected(t)}}])&&Ade(t.prototype,n),r&&Ade(t,r),i}(bfe);function Lde(e){return(Lde="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Hde(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Nde(e,t){return(Nde=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Vde(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=zde(e);if(t){var o=zde(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Wde(this,n)}}function Wde(e,t){return!t||"object"!==Lde(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function zde(e){return(zde=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Gde=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Nde(e,t)}(i,e);var t,n,r,o=Vde(i);function i(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),o.call(this)}return t=i,(n=[{key:"_goOffline",value:function(){this.widget.outline||(this._enabledBeforeOffline=this.widget.enabled,this.widget.setEnabled(!1))}},{key:"_goOnline",value:function(){this.widget.outline||this.widget.setEnabled(this._enabledBeforeOffline)}}])&&Hde(t.prototype,n),r&&Hde(t,r),i}(Sfe);function Ude(e){return(Ude="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Kde(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function qde(e,t){return(qde=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Yde(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Jde(e);if(t){var o=Jde(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Xde(this,n)}}function Xde(e,t){return!t||"object"!==Ude(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Jde(e){return(Jde=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Zde=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&qde(e,t)}(i,e);var t,n,r,o=Yde(i);function i(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(e=o.call(this)).outline=null,e.tileOutlineOverview=null,e}return t=i,(n=[{key:"_render",value:function(){this._ensureTileOutlineOverview(),this.addContainer(this.$parent,"outline-tile-field"),this.tileOutlineOverview.render(this.$container),this.addField(this.tileOutlineOverview.$container)}},{key:"_ensureTileOutlineOverview",value:function(){if(!this.tileOutlineOverview){var e=this.outline?this.session.getWidget(this.outline):null;this.tileOutlineOverview=O.create("TileOutlineOverview",{parent:this,outline:e})}}}])&&Kde(t.prototype,n),r&&Kde(t,r),i}(ZW);function Qde(e){return(Qde="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function eye(e,t){return(eye=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function tye(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=rye(e);if(t){var o=rye(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return nye(this,n)}}function nye(e,t){return!t||"object"!==Qde(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function rye(e){return(rye=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var oye=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&eye(e,t)}(n,e);var t=tye(n);function n(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),t.call(this)}return n}(sz);function iye(e){return(iye="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function sye(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function aye(e,t){return(aye=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function lye(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=cye(e);if(t){var o=cye(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return uye(this,n)}}function uye(e,t){return!t||"object"!==iye(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function cye(e){return(cye=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var fye=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&aye(e,t)}(i,e);var t,n,r,o=lye(i);function i(e,t){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(n=o.call(this)).outline=e,n.page=t,n}return t=i,(n=[{key:"layout",value:function(e){var t,n,r=this.page.htmlComp,o=this.page.$text,i=this.page.$icon(),s=0,a=0,l=this.outline.nodeMenuBar,u=0,c=this.outline.detailMenuBar,f=0,h=0;h=(t=r.availableSize().subtract(r.insets())).width,i.length>0&&(h-=qs.prefSize(i).width),l.visible&&(u=l.htmlComp.prefSize(),l.htmlComp.setSize(u),h-=u.add(l.htmlComp.margins()).width),o.cssWidth(h),c.visible&&(f=c.htmlComp.prefSize().height,n=new $s(t.width,f).subtract(c.htmlComp.margins()),c.htmlComp.setSize(n)),this.outline.detailContent&&(i.length>0&&(a=i.outerHeight(!0)),o.isVisible()&&(s=o.outerHeight(!0)),s=Math.max(s,a),this.outline.detailContent.htmlComp.setSize(new $s(t.width,t.height-s-f)))}},{key:"preferredLayoutSize",value:function(e,t){var n,r,o=0,i=this.page.htmlComp,s=new $s,a=this.page.$text,l=this.page.$icon(),u=this.outline.detailMenuBar,c=new $s,f=this.outline.nodeMenuBar,h=0;return h=t.widthHint,l.length>0&&(h-=qs.prefSize(l).width),f.visible&&f.rendered&&(h-=f.htmlComp.prefSize().width),n=qs.prefSize(a,{includeMargin:!0,widthHint:h}).height,l.length>0&&(o=l.outerHeight(!0)),r=Math.max(n,o),u.visible&&u.rendered&&(c=u.htmlComp.prefSize()),this.outline.detailContent&&(s=this.outline.detailContent.htmlComp.prefSize(t)),new $s(Math.max(s.width,c.width),r+c.height+s.height).add(i.insets())}}])&&sye(t.prototype,n),r&&sye(t,r),i}(Zs);function hye(e){return(hye="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function pye(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function dye(e,t,n){return(dye="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=mye(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function yye(e,t){return(yye=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function vye(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=mye(e);if(t){var o=mye(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return bye(this,n)}}function bye(e,t){return!t||"object"!==hye(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function mye(e){return(mye=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var gye=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&yye(e,t)}(i,e);var t,n,r,o=vye(i);function i(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(e=o.call(this)).hasText=!1,e.$searchPanel=null,e.$clearIcon=null,e.$searchStatus=null,e.$queryField=null,e}return t=i,(n=[{key:"_initKeyStrokeContext",value:function(){dye(mye(i.prototype),"_initKeyStrokeContext",this).call(this),this.searchFieldKeyStrokeContext=this._createKeyStrokeContextForSearchField()}},{key:"_createKeyStrokeContextForSearchField",value:function(){var e=new Vu;return e.$scopeTarget=function(){return this.$searchPanel}.bind(this),e.$bindTarget=function(){return this.$queryField}.bind(this),e.registerStopPropagationKeys(Ru.NONE,[Ou.ENTER,Ou.BACKSPACE]),e}},{key:"_render",value:function(){dye(mye(i.prototype),"_render",this).call(this),this.htmlComp.setLayout(new jye(this)),this.$container.addClass("search-outline"),this.$searchPanel=this.$container.prependDiv("search-outline-panel"),this.$queryField=this.$searchPanel.appendElement("<input>","search-outline-field").on("input",this._createOnQueryFieldInputFunction().bind(this)).on("keypress",this._onQueryFieldKeyPress.bind(this)),this.$clearIcon=this.$searchPanel.appendSpan("clear-icon unfocusable needsclick").on("mousedown",this._onClearIconMouseDown.bind(this)),this.$searchStatus=this.$searchPanel.appendDiv("search-outline-status").on("mousedown",this._onTitleMouseDown.bind(this)),this.session.keyStrokeManager.installKeyStrokeContext(this.searchFieldKeyStrokeContext)}},{key:"_remove",value:function(){this.session.keyStrokeManager.uninstallKeyStrokeContext(this.searchFieldKeyStrokeContext),this.$searchPanel.remove(),dye(mye(i.prototype),"_remove",this).call(this)}},{key:"_renderProperties",value:function(){dye(mye(i.prototype),"_renderProperties",this).call(this),this._renderSearchQuery(),this._renderSearchStatus(),this._updateHasText()}},{key:"_renderTitle",value:function(){dye(mye(i.prototype),"_renderTitle",this).call(this),this.titleVisible&&this.$title.insertBefore(this.$searchPanel)}},{key:"_renderSearchQuery",value:function(){this.$queryField.val(this.searchQuery)}},{key:"_renderSearchStatus",value:function(){var e=this.rendered;this.searchStatus&&!this.$searchStatus.isVisible()?e?this.$searchStatus.slideDown({duration:200,progress:this.revalidateLayout.bind(this)}):this.$searchStatus.show():!this.searchStatus&&this.$searchStatus.isVisible()&&(e?this.$searchStatus.slideUp({duration:200,progress:this.revalidateLayout.bind(this)}):this.$searchStatus.hide()),this.$searchStatus.textOrNbsp(this.searchStatus),this.$searchPanel.toggleClass("has-status",!!this.searchStatus)}},{key:"focusQueryField",value:function(){this.validateFocus()}},{key:"_triggerSearch",value:function(){this.trigger("search",{query:O.nvl(this.searchQuery,"")})}},{key:"_createOnQueryFieldInputFunction",value:function(e){var t=s.a.debounce(this._search.bind(this));return function(e){this._updateHasText(),t()}}},{key:"_onClearIconMouseDown",value:function(e){this.$queryField.val(""),this._updateHasText(),this._search(),this.$queryField.focus(),e.preventDefault()}},{key:"_onQueryFieldKeyPress",value:function(e){e.which===Ou.ENTER&&(this._setSearchQuery(this.$queryField.val()),this._triggerSearch())}},{key:"_search",value:function(e){var t=this.$queryField.val();this.searchQuery!==t&&(this._setSearchQuery(t),this._triggerSearch())}},{key:"_setSearchQuery",value:function(e){this.searchQuery=e}},{key:"_updateHasText",value:function(){this.$queryField.toggleClass("has-text",!!this.$queryField.val())}},{key:"validateFocus",value:function(){if(this.rendered){var e=this.$queryField[0];this.session.focusManager.requestFocus(e)&&e.select()}}}])&&pye(t.prototype,n),r&&pye(t,r),i}(fde);function _ye(e){return(_ye="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function wye(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function kye(e,t,n){return(kye="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Cye(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function Sye(e,t){return(Sye=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Oye(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Cye(e);if(t){var o=Cye(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Tye(this,n)}}function Tye(e,t){return!t||"object"!==_ye(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Cye(e){return(Cye=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Pye=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Sye(e,t)}(i,e);var t,n,r,o=Oye(i);function i(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),o.call(this)}return t=i,(n=[{key:"_initProperties",value:function(e){void 0!==e.requestFocusQueryField&&delete e.requestFocusQueryField}},{key:"_syncRequestFocusQueryField",value:function(){this.widget.focusQueryField()}},{key:"_onWidgetSearch",value:function(e){this._send("search",{query:e.query},{showBusyIndicator:!1})}},{key:"_onWidgetEvent",value:function(e){"search"===e.type?this._onWidgetSearch(e):kye(Cye(i.prototype),"_onWidgetEvent",this).call(this,e)}}])&&wye(t.prototype,n),r&&wye(t,r),i}(_de);function Rye(e){return(Rye="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function xye(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Eye(e,t,n){return(Eye="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=$ye(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function Dye(e,t){return(Dye=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Aye(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=$ye(e);if(t){var o=$ye(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Fye(this,n)}}function Fye(e,t){return!t||"object"!==Rye(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function $ye(e){return($ye=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var jye=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Dye(e,t)}(i,e);var t,n,r,o=Aye(i);function i(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(t=o.call(this,e)).outline=e,t}return t=i,(n=[{key:"_setDataHeight",value:function(e){e+=qs.size(this.outline.$searchPanel,!0).height,Eye($ye(i.prototype),"_setDataHeight",this).call(this,e)}}])&&xye(t.prototype,n),r&&xye(t,r),i}(Ede);function Bye(e){return(Bye="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Mye(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Iye(e,t,n){return(Iye="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Vye(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function Lye(e,t){return(Lye=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Hye(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Vye(e);if(t){var o=Vye(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Nye(this,n)}}function Nye(e,t){return!t||"object"!==Bye(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Vye(e){return(Vye=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Wye=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Lye(e,t)}(i,e);var t,n,r,o=Hye(i);function i(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(e=o.call(this)).node=null,e.outline=null,e.actionStyle=Up.ActionStyle.BUTTON,e._additionalCssClass="",e._addCloneProperties(["node","outline","altKeyStrokeContext"]),e.inheritAccessibility=!1,e}return t=i,(n=[{key:"_render",value:function(){this.overflow?(this.text=this.session.text(this._defaultText),this.iconId=null):(this.text=null,this.iconId=this._defaultIconId),this.updateEnabled(),Iye(Vye(i.prototype),"_render",this).call(this),this.$container.addClass("navigate-button small"),this.$container.addClass(this._additionalCssClass),this.altKeyStrokeContext.registerKeyStroke(this)}},{key:"_remove",value:function(){Iye(Vye(i.prototype),"_remove",this).call(this),this.altKeyStrokeContext.unregisterKeyStroke(this)}},{key:"_setDetailVisible",value:function(){var e=this._toggleDetail();s.a.log.isDebugEnabled()&&s.a.log.debug("show detail-"+(e?"form":"table")),this.outline.setDetailFormVisibleByUi(this.node,e)}},{key:"_doAction",value:function(){Iye(Vye(i.prototype),"_doAction",this).call(this),this._isDetail()?this._setDetailVisible():this._drill()}},{key:"updateEnabled",value:function(){this.setEnabled(this._buttonEnabled())}}])&&Mye(t.prototype,n),r&&Mye(t,r),i}(eg);function zye(e){return(zye="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Gye(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Uye(e,t,n){return(Uye="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Jye(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function Kye(e,t){return(Kye=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function qye(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Jye(e);if(t){var o=Jye(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Yye(this,n)}}function Yye(e,t){return!t||"object"!==zye(t)&&"function"!=typeof t?Xye(e):t}function Xye(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Jye(e){return(Jye=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Zye=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Kye(e,t)}(i,e);var t,n,r,o=qye(i);function i(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(e=o.call(this))._defaultIconId=gn.ANGLE_DOWN,e._defaultText="ui.Continue",e.iconId=e._defaultIconId,e.keyStroke="enter",e._detailTableRowsSelectedHandler=e._onDetailTableRowsSelected.bind(Xye(e)),e._outlinePageRowLinkHandler=e._onOutlinePageRowLink.bind(Xye(e)),e}return t=i,(n=[{key:"_init",value:function(e){Uye(Jye(i.prototype),"_init",this).call(this,e),this.node.detailTable&&this.node.detailTable.on("rowsSelected",this._detailTableRowsSelectedHandler),this.outline.on("pageRowLink",this._outlinePageRowLinkHandler)}},{key:"_destroy",value:function(){this.node.detailTable&&this.node.detailTable.off("rowsSelected",this._detailTableRowsSelectedHandler),this.outline.off("pageRowLink",this._outlinePageRowLinkHandler),Uye(Jye(i.prototype),"_destroy",this).call(this)}},{key:"_render",value:function(){Uye(Jye(i.prototype),"_render",this).call(this),this.$container.addClass("down")}},{key:"_isDetail",value:function(){return!!(this.node.detailFormVisible&&this.node.detailForm&&this.node.detailTableVisible&&this.node.detailTable&&this.node.detailFormVisibleByUi)}},{key:"_toggleDetail",value:function(){return!1}},{key:"_buttonEnabled",value:function(){if(this._isDetail())return!0;if(this.node.leaf)return!1;var e=this.node.detailTable;return!e||1===e.selectedRows.length&&!!e.selectedRows[0].page}},{key:"_drill",value:function(){var e,t=this;if(this.node.detailTable){var n=this.node.detailTable.selectedRow();e=this.node.pageForTableRow(n)}else e=this.node.childNodes[0];if(e){s.a.log.isDebugEnabled()&&s.a.log.debug("drill down to node "+e);var r=e.parentNode;r&&r.childNodes.forEach((function(n){n.expanded&&n!==e&&t.outline.collapseNode(n,{animateExpansion:!1})})),this.outline.selectNodes(e),r&&r.nodeType===Che.NodeType.TABLE&&this.outline.expandNode(e)}}},{key:"_onDetailTableRowsSelected",value:function(e){this.updateEnabled()}},{key:"_onOutlinePageRowLink",value:function(e){var t=this.node.detailTable;t&&1===t.selectedRows.length&&t.selectedRows[0].page===e.page&&this.updateEnabled()}}])&&Gye(t.prototype,n),r&&Gye(t,r),i}(Wye);function Qye(e){return(Qye="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function eve(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function tve(e,t,n){return(tve="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=ive(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function nve(e,t){return(nve=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function rve(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=ive(e);if(t){var o=ive(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return ove(this,n)}}function ove(e,t){return!t||"object"!==Qye(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function ive(e){return(ive=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var sve=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&nve(e,t)}(i,e);var t,n,r,o=rve(i);function i(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(e=o.call(this))._defaultIconId=gn.ANGLE_UP,e._defaultText="ui.Up",e._additionalCssClass="small-gap",e.iconId=e._defaultIconId,e.keyStroke="backspace",e}return t=i,(n=[{key:"_render",value:function(){tve(ive(i.prototype),"_render",this).call(this),this.$container.addClass("up")}},{key:"_isDetail",value:function(){return!(!(this.node.detailFormVisible&&this.node.detailForm&&this.node.detailTableVisible&&this.node.detailTable)||this.node.detailFormVisibleByUi)}},{key:"_toggleDetail",value:function(){return!0}},{key:"_buttonEnabled",value:function(){return!!this.node.parentNode||!!this.outline.defaultDetailForm||!!this.outline.outlineOverview}},{key:"_drill",value:function(){var e=this.node.parentNode;e?(s.a.log.isDebugEnabled()&&s.a.log.debug("drill up to node "+e),this.outline.navigateUpInProgress=!0,this.outline.selectNodes(e),this.outline.collapseNode(e,{collapseChildNodes:!0})):(s.a.log.isDebugEnabled()&&s.a.log.debug("drill up to top"),this.outline.navigateToTop())}}])&&eve(t.prototype,n),r&&eve(t,r),i}(Wye);function ave(e){return(ave="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function lve(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function uve(e,t,n){return(uve="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=pve(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function cve(e,t){return(cve=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function fve(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pve(e);if(t){var o=pve(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return hve(this,n)}}function hve(e,t){return!t||"object"!==ave(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function pve(e){return(pve=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var dve=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&cve(e,t)}(i,e);var t,n,r,o=fve(i);function i(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(t=o.call(this))._outline=e,t}return t=i,(n=[{key:"accept",value:function(e){return!this._outline.inBackground&&!this.isFormMenuOpen()&&uve(pve(i.prototype),"accept",this).call(this,e)}},{key:"isFormMenuOpen",value:function(){return this._outline.session.desktop.menus.some((function(e){return e.popup&&e.popup.$container&&e.popup.$container.isAttached()}),this)}}])&&lve(t.prototype,n),r&&lve(t,r),i}($u);function yve(e){return(yve="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function vve(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function bve(e,t){return(bve=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function mve(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=wve(e);if(t){var o=wve(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return gve(this,n)}}function gve(e,t){return!t||"object"!==yve(t)&&"function"!=typeof t?_ve(e):t}function _ve(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function wve(e){return(wve=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var kve=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&bve(e,t)}(i,e);var t,n,r,o=mve(i);function i(e,t){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(n=o.call(this,e,t)).which=[Ou.HOME],n.renderingHints.hAlign=Do.RIGHT,n.renderingHints.$drawingArea=function(e,t){return this.field.$title||this.field.$data}.bind(_ve(n)),n}return t=i,(n=[{key:"handle",value:function(e){this.field.navigateToTop()}}])&&vve(t.prototype,n),r&&vve(t,r),i}(kN);function Sve(e){return(Sve="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ove(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Tve(e,t,n){return(Tve="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=xve(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function Cve(e,t){return(Cve=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Pve(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=xve(e);if(t){var o=xve(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Rve(this,n)}}function Rve(e,t){return!t||"object"!==Sve(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function xve(e){return(xve=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Eve=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Cve(e,t)}(i,e);var t,n,r,o=Pve(i);function i(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(e=o.call(this)).outline=null,e}return t=i,(n=[{key:"_init",value:function(e){Tve(xve(i.prototype),"_init",this).call(this,e),!this.outline&&this.parent instanceof fde&&(this.outline=this.parent),O.assertProperty(this,"outline",fde)}},{key:"_render",value:function(){this.$container=this.$parent.appendDiv("outline-overview"),this.htmlComp=ea.install(this.$container,this.session),this.$content=this.$container.appendDiv("outline-overview-content"),this.$content.appendDiv("outline-overview-icon").icon(this.outline.iconId),this.$content.appendDiv("outline-overview-title").text(this.outline.title)}},{key:"_attach",value:function(){this.$parent.append(this.$container);var e=this.htmlComp.getParent();this.htmlComp.setSize(e.size()),Tve(xve(i.prototype),"_attach",this).call(this)}},{key:"_detach",value:function(){this.$container.detach(),Tve(xve(i.prototype),"_detach",this).call(this)}}])&&Ove(t.prototype,n),r&&Ove(t,r),i}(ve);function Dve(e){return(Dve="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ave(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Fve(e,t,n){return(Fve="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Mve(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function $ve(e,t){return($ve=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function jve(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Mve(e);if(t){var o=Mve(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Bve(this,n)}}function Bve(e,t){return!t||"object"!==Dve(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Mve(e){return(Mve=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Ive=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&$ve(e,t)}(i,e);var t,n,r,o=jve(i);function i(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(e=o.call(this)).pageTileGrid=null,e.scrollable=!0,e._addWidgetProperties(["pageTileGrid"]),e}return t=i,(n=[{key:"_init",value:function(e){Fve(Mve(i.prototype),"_init",this).call(this,e),this.pageTileGrid||(this.pageTileGrid=this._createPageTileGrid()),this.scrollable=!this.outline.compact}},{key:"_render",value:function(){this.$container=this.$parent.appendDiv("tile-overview"),this.htmlComp=ea.install(this.$container,this.session),this.htmlComp.setLayout(new El({stretch:this.outline.compact})),this.$content=this.$container.appendDiv("tile-overview-content"),this.contentHtmlComp=ea.install(this.$content,this.session),this.contentHtmlComp.setLayout(new El({stretch:this.outline.compact})),this.$title=this.$content.appendDiv("tile-overview-title").text(this.outline.title),ea.install(this.$title,this.session)}},{key:"_renderProperties",value:function(){Fve(Mve(i.prototype),"_renderProperties",this).call(this),this._renderPageTileGrid(),this._renderScrollable()}},{key:"_renderPageTileGrid",value:function(){this.pageTileGrid.render(this.$content)}},{key:"_createPageTileGrid",value:function(){var e,t;return this.outline.compact&&(e=this.outline.compactRootNode())&&(t=e.childNodes),O.create("PageTileGrid",{parent:this,outline:this.outline,compact:this.outline.compact,page:e,nodes:t})}},{key:"setScrollable",value:function(e){this.setProperty("scrollable",e)}},{key:"_renderScrollable",value:function(){this.scrollable?this._installScrollbars({axis:"y"}):this._uninstallScrollbars()}}])&&Ave(t.prototype,n),r&&Ave(t,r),i}(Eve);function Lve(e){return(Lve="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Hve(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Nve(e,t,n){return(Nve="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Uve(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function Vve(e,t){return(Vve=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Wve(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Uve(e);if(t){var o=Uve(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return zve(this,n)}}function zve(e,t){return!t||"object"!==Lve(t)&&"function"!=typeof t?Gve(e):t}function Gve(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Uve(e){return(Uve=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Kve=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Vve(e,t)}(i,e);var t,n,r,o=Wve(i);function i(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(t=o.call(this,e)).desktop=e.displayParent,t._popupWindows=[],t._documentPopupWindowReadyHandler=t._onDocumentPopupWindowReady.bind(Gve(t)),s()(document).on("popupWindowReady",t._documentPopupWindowReadyHandler),t}return t=i,(n=[{key:"render",value:function(){Nve(Uve(i.prototype),"render",this).call(this);var e=this.desktop.activeForm;e?e.activate():this.desktop.bringOutlineToFront()}},{key:"_renderViews",value:function(){var e=this;Nve(Uve(i.prototype),"_renderViews",this).call(this),this.desktop.selectedViewTabs&&this.desktop.selectedViewTabs.forEach((function(t){e._activateView(t)})),this.desktop.bench&&(this.desktop.bench.postRender(),this.desktop.bench.htmlComp.validateLayoutTree())}},{key:"_renderPopupWindow",value:function(e){var t,n,r=this,o=e.readCacheBounds();if(o)t="left="+o.x+",top="+o.y+",width="+o.width+",height="+o.height,n=!1;else{var i=s()(document),a=new $s(i.width(),i.height());t="left=0,top=0,width="+a.width+",height="+a.height,n=!0}t+=",location=no,toolbar=no,menubar=no,resizable=yes";var l=O.create("PopupBlockerHandler",{session:this.session,preserveOpener:!0}),u="popup-window.html?formId="+e.id;l.openWindow(u,"_blank",t,(function(t){r._addPopupWindow(t,e,n)}))}},{key:"_addPopupWindow",value:function(e,t,n){var r=new lle(e,t);r.resizeToPrefSize=n,r.events.on("popupWindowUnload",this._onPopupWindowUnload.bind(this)),this._popupWindows.push(r),s.a.log.isDebugEnabled()&&s.a.log.debug("Opened new popup window for form ID "+t.id)}},{key:"_onDocumentPopupWindowReady",value:function(e,t){var n;if(s.a.log.isDebugEnabled()&&s.a.log.debug("(FormController#_onDocumentPopupWindowReady) data="+t),t.formId){var r,o=t.formId;for(s.a.log.isDebugEnabled()&&s.a.log.debug("Popup window for form ID "+o+" has been reloaded"),r=0;r<this._popupWindows.length&&(n=this._popupWindows[r]).form.id!==o;r++);if(!n)throw new Error("Couldn't find popupWindow reference while popup window was reloaded")}else{if(!t.popupWindow)throw new Error("Neither property 'formId' nor 'popupWindow' exists on data parameter");n=t.popupWindow}n._onReady()}},{key:"_onPopupWindowUnload",value:function(e){var t=e.form;s.a.log.isDebugEnabled()&&s.a.log.debug("Popup window for form ID "+t.id+" is unloaded - don't know if its closed or reloaded yet"),t.remove(),setTimeout((function(){e.isClosed()&&(s.a.log.isDebugEnabled()&&s.a.log.debug("Popup window for form ID "+t.id+" has been closed"),t.close())}),250)}},{key:"closePopupWindows",value:function(){this._popupWindows.forEach((function(e){this._removePopupWindow(e.form)}),this),this._popupWindows=[]}},{key:"_removePopupWindow",value:function(e){var t=e.popupWindow;if(!t)throw new Error("Form has no popupWindow reference");delete e.popupWindow,rt.remove(this._popupWindows,t),e.rendered&&(e.remove(),t.close())}},{key:"dispose",value:function(){s()(document).off("popupWindowReady",this._documentPopupWindowReadyHandler)}}])&&Hve(t.prototype,n),r&&Hve(t,r),i}(aU);function qve(e){return(qve="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Yve(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Xve(e,t,n){return(Xve="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=ebe(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function Jve(e,t){return(Jve=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Zve(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=ebe(e);if(t){var o=ebe(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Qve(this,n)}}function Qve(e,t){return!t||"object"!==qve(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function ebe(e){return(ebe=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var tbe=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Jve(e,t)}(i,e);var t,n,r,o=Zve(i);function i(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(e=o.call(this)).gridColumnCount=1,e.cssClass="filter-fields",e}return t=i,(n=[{key:"_init",value:function(e){Xve(ebe(i.prototype),"_init",this).call(this,e),this.filter.addFilterFields(this)}},{key:"_renderProperties",value:function(e){Xve(ebe(i.prototype),"_renderProperties",this).call(this,e),this.filter.modifyFilterFields()}},{key:"addFilterField",value:function(e,t){var n=O.create(e,{parent:this,label:this.session.text(t),statusVisible:!1,labelWidthInPixel:50,maxLength:100,updateDisplayTextOnModify:!0});return this.addField0(n),n}},{key:"addField0",value:function(e){this.fields.push(e),this._prepareFields()}}])&&Yve(t.prototype,n),r&&Yve(t,r),i}(gJ);function nbe(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function rbe(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var obe=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),O.assertParameter("model",t),O.assertParameter("$container",t.$container),this.$container=t.$container,this.$window=t.$container.window(),this.setModes(t.modes),this.setBoundaries(t.boundaries),this.$resizableS=null,this.$resizableE=null,this.$resizableSE=null,this.$resizableW=null,this.$resizableSW=null,this.$resizableN=null,this.$resizableNW=null,this.$resizableNE=null,this._context=null,this._mouseDownHandler=this._onMouseDown.bind(this),this._mouseUpHandler=this._onMouseUp.bind(this),this._mousemoveHandler=this._onMousemove.bind(this),this._resizeHandler=this._resize.bind(this)}var t,n,r;return t=e,(n=[{key:"setModes",value:function(t){var n=t||[e.MODES.SOUTH,e.MODES.EAST,e.MODES.WEST,e.MODES.NORTH];rt.equals(n,this.modes)||(this.modes=n,this._calculateResizeHandlersVisibility())}},{key:"setBoundaries",value:function(e){this.boundaries=s.a.extend(new Bs,e),this._boundaryValueSet(this.boundaries.left)&&(this.boundaries.left-=this.$container.cssMarginLeft()),this._boundaryValueSet(this.boundaries.right)&&(this.boundaries.right-=this.$container.cssMarginRight()),this._boundaryValueSet(this.boundaries.top)&&(this.boundaries.top-=this.$container.cssMarginTop()),this._boundaryValueSet(this.boundaries.bottom)&&(this.boundaries.bottom-=this.$container.cssMarginBottom())}},{key:"_appendResizeHandles",value:function(){this.$resizableS=this.$container.appendDiv("resizable-handle resizable-s").data("edge","s").on("mousedown.resizable",this._mouseDownHandler),this.$resizableE=this.$container.appendDiv("resizable-handle resizable-e").data("edge","e").on("mousedown.resizable",this._mouseDownHandler),this.$resizableSE=this.$container.appendDiv("resizable-handle resizable-se").data("edge","se").on("mousedown.resizable",this._mouseDownHandler),this.$resizableW=this.$container.appendDiv("resizable-handle resizable-w").data("edge","w").on("mousedown.resizable",this._mouseDownHandler),this.$resizableSW=this.$container.appendDiv("resizable-handle resizable-sw").data("edge","sw").on("mousedown.resizable",this._mouseDownHandler),this.$resizableN=this.$container.appendDiv("resizable-handle resizable-n").data("edge","n").on("mousedown.resizable",this._mouseDownHandler),this.$resizableNW=this.$container.appendDiv("resizable-handle resizable-nw").data("edge","nw").on("mousedown.resizable",this._mouseDownHandler),this.$resizableNE=this.$container.appendDiv("resizable-handle resizable-ne").data("edge","ne").on("mousedown.resizable",this._mouseDownHandler),this._calculateResizeHandlersVisibility()}},{key:"_calculateResizeHandlersVisibility",value:function(){this.$resizableS&&this.$resizableS.setVisible(this._hasMode(e.MODES.SOUTH)),this.$resizableE&&this.$resizableE.setVisible(this._hasMode(e.MODES.EAST)),this.$resizableSE&&this.$resizableSE.setVisible(this._hasMode(e.MODES.SOUTH)&&this._hasMode(e.MODES.EAST)),this.$resizableW&&this.$resizableW.setVisible(this._hasMode(e.MODES.WEST)),this.$resizableSW&&this.$resizableSW.setVisible(this._hasMode(e.MODES.SOUTH)&&this._hasMode(e.MODES.WEST)),this.$resizableN&&this.$resizableN.setVisible(this._hasMode(e.MODES.NORTH)),this.$resizableNW&&this.$resizableNW.setVisible(this._hasMode(e.MODES.NORTH)&&this._hasMode(e.MODES.WEST)),this.$resizableNE&&this.$resizableNE.setVisible(this._hasMode(e.MODES.NORTH)&&this._hasMode(e.MODES.EAST))}},{key:"_hasMode",value:function(e){return this.modes.some((function(t){return t===e}))}},{key:"init",value:function(){this.$container.addClass("resizable"),this._appendResizeHandles(),this._installRemoveHandler()}},{key:"_installRemoveHandler",value:function(){this.$container.on("remove",this.destroy.bind(this))}},{key:"destroy",value:function(){this.$resizableS&&(this.$resizableS.remove(),this.$resizableS=null),this.$resizableE&&(this.$resizableE.remove(),this.$resizableE=null),this.$resizableSE&&(this.$resizableSE.remove(),this.$resizableSE=null),this.$resizableW&&(this.$resizableW.remove(),this.$resizableW=null),this.$resizableSW&&(this.$resizableSW.remove(),this.$resizableSW=null),this.$resizableN&&(this.$resizableN.remove(),this.$resizableN=null),this.$resizableNW&&(this.$resizableNW.remove(),this.$resizableNW=null),this.$resizableNE&&(this.$resizableNE.remove(),this.$resizableNE=null),this.$container&&this.$container.removeClass("resizable"),this.$window.off("mouseup.resizable",this._mouseUpHandler).off("mousemove.resizable",this._mousemoveHandler)}},{key:"_onMouseDown",value:function(e){var t=this.$container,n=t.window(),r=s()(e.target),o=t.cssMinWidth(),i=t.cssMinHeight(),a=t.cssMaxWidth(),l=t.cssMaxHeight(),u=qs.bounds(t,{exact:!0});this._context={initialBounds:u,minBounds:new Hs(u.right()-o,u.bottom()-i,o,i),maxBounds:new Hs(Math.max(-t.cssMarginLeft(),u.right()-a),Math.max(-t.cssMarginTop(),u.bottom()-l),Math.min(n.width()-t[0].offsetLeft,a),Math.min(n.height()-t[0].offsetTop,l)),distance:[0,0],edge:r.data("edge"),mousedownEvent:e},t.addClass("resizable-resizing"),this.$window.off("mouseup.resizable",this._mouseUpHandler).off("mousemove.resizable",this._mousemoveHandler).on("mouseup.resizable",this._mouseUpHandler).on("mousemove.resizable",this._mousemoveHandler),s()("iframe").addClass("dragging-in-progress")}},{key:"_onMouseUp",value:function(e){this.$container.removeClass("resizable-resizing"),this.$window.off("mouseup.resizable",this._mouseUpHandler).off("mousemove.resizable",this._mousemoveHandler),s()("iframe").removeClass("dragging-in-progress"),this._context=null}},{key:"_onMousemove",value:function(t){var n=this._context,r=n.initialBounds.clone(),o=this._calcDistance(n.mousedownEvent,t);O.isOneOf(n.edge,"ne","e","se")?r.width=Math.max(n.minBounds.width,Math.min(n.maxBounds.width,n.initialBounds.width+o[0])):O.isOneOf(n.edge,"nw","w","sw")&&(r.x=Math.min(n.minBounds.x,Math.max(n.maxBounds.x,n.initialBounds.x+o[0])),r.width+=n.initialBounds.x-r.x),O.isOneOf(n.edge,"sw","s","se")?r.height=Math.max(n.minBounds.height,Math.min(n.maxBounds.height,n.initialBounds.height+o[1])):O.isOneOf(n.edge,"nw","n","ne")&&(r.y=Math.min(n.minBounds.y,Math.max(n.maxBounds.y,n.initialBounds.y+o[1])),r.height+=n.initialBounds.y-r.y),s.a.throttle(this._resizeHandler,e.FPS)(r)}},{key:"_resize",value:function(e){this._cropToBoundaries(e),qs.setBounds(this.$container,e),this.$container.trigger("resize",{newBounds:e,initialBounds:this._context.initialBounds})}},{key:"_cropToBoundaries",value:function(e){this._boundaryValueSet(this.boundaries.left)&&e.x>this.boundaries.left&&(e.width-=this.boundaries.left-e.x,e.x=this.boundaries.left),this._boundaryValueSet(this.boundaries.right)&&e.x+e.width<this.boundaries.right&&(e.width=this.boundaries.right-e.x),this._boundaryValueSet(this.boundaries.top)&&e.y>this.boundaries.top&&(e.height-=this.boundaries.top-e.y,e.y=this.boundaries.top),this._boundaryValueSet(this.boundaries.bottom)&&e.y+e.height<this.boundaries.bottom&&(e.height=this.boundaries.bottom-e.y)}},{key:"_boundaryValueSet",value:function(e){return e>0}},{key:"_calcDistance",value:function(e,t){return[t.pageX-e.pageX,t.pageY-e.pageY]}}])&&nbe(t.prototype,n),r&&nbe(t,r),e}();function ibe(e){return(ibe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function sbe(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function abe(e,t,n){return(abe="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=fbe(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function lbe(e,t){return(lbe=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function ube(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=fbe(e);if(t){var o=fbe(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return cbe(this,n)}}function cbe(e,t){return!t||"object"!==ibe(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function fbe(e){return(fbe=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}rbe(obe,"MODES",{SOUTH:"s",EAST:"e",WEST:"w",NORTH:"n"}),rbe(obe,"FPS",1e3/15);var hbe=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&lbe(e,t)}(i,e);var t,n,r,o=ube(i);function i(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(e=o.call(this)).unsavedForms=[],e}return t=i,r=[{key:"getFormDisplayName",value:function(e){return[e.title,e.name,e.subTitle].filter(Boolean).join(" - ")}}],(n=[{key:"_jsonModel",value:function(){return{id:"scout.UnsavedFormChangesForm",objectType:"Form",type:"model",title:"${textKey:SaveChangesOfSelectedItems}",askIfNeedSave:!1,rootGroupBox:{id:"MainBox",objectType:"GroupBox",menus:[{id:"OkMenu",objectType:"OkMenu"},{id:"CancelMenu",objectType:"CancelMenu"}],fields:[{id:"UnsavedChangesBox",objectType:"GroupBox",labelVisible:!1,gridColumnCount:1,fields:[{id:"OpenFormsField",objectType:"ListBox",gridDataHints:{h:5},labelVisible:!1}]}]}}}},{key:"_init",value:function(e){var t=this;abe(fbe(i.prototype),"_init",this).call(this,e),this.openFormsField=this.widget("OpenFormsField"),this.openFormsField.setLookupCall(O.create("scout.UnsavedFormsLookupCall",{session:this.session,unsavedForms:this.unsavedForms})),this.openFormsField.table.one("rowsInserted",(function(e){e.source.checkAll(!0)}));var n=O.create("Menu",{parent:this.openFormsField.table,id:"CheckAllMenu",menuTypes:["Table.EmptySpace"],text:"${textKey:CheckAll}"});n.on("action",(function(e){t.openFormsField.table.checkAll(!0)}));var r=O.create("Menu",{parent:this.openFormsField.table,id:"UncheckAllMenu",menuTypes:["Table.EmptySpace"],text:"${textKey:UncheckAll}"});r.on("action",(function(e){t.openFormsField.table.uncheckAll()})),this.openFormsField.table.setMenus([n,r]),this.on("postLoad",(function(e){t.touch()}))}},{key:"_validate",value:function(e){var t=this.getInvalidForms();if(t.length>0){var n=[];return n.push("<p><b>",this.session.text("NotAllCheckedFormsCanBeSaved"),"</b></p>"),n.push(this.session.text("FormsCannotBeSaved"),"<br><br>"),t.forEach((function(e){n.push("- ",i.getFormDisplayName(e),"<br>")}),this),Br.error({message:n.join("")})}return Br.ok()}},{key:"getInvalidForms",value:function(){var e=[];return this.openFormsField.value.forEach((function(t){var n=t.lifecycle._invalidElements().missingElements.slice(),r=t.lifecycle._invalidElements().invalidElements.slice();t.visitDisplayChildren((function(e){var t=e.lifecycle._invalidElements();rt.pushAll(n,t.missingElements),rt.pushAll(r,t.invalidElements)}),(function(e){return e instanceof CC})),(n.length>0||r.length>0)&&e.push(t)})),e}}])&&sbe(t.prototype,n),r&&sbe(t,r),i}(CC);function pbe(e){return(pbe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function dbe(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ybe(e,t){return(ybe=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function vbe(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=mbe(e);if(t){var o=mbe(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return bbe(this,n)}}function bbe(e,t){return!t||"object"!==pbe(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function mbe(e){return(mbe=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var gbe=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ybe(e,t)}(i,e);var t,n,r,o=vbe(i);function i(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(e=o.call(this)).unsavedForms=[],e}return t=i,(n=[{key:"_data",value:function(){return this.unsavedForms.map((function(e){return[e,hbe.getFormDisplayName(e)]}))}}])&&dbe(t.prototype,n),r&&dbe(t,r),i}(Di);function _be(e){return(_be="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function wbe(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function kbe(e,t,n){return(kbe="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Pbe(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function Sbe(e,t){return(Sbe=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Obe(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Pbe(e);if(t){var o=Pbe(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Tbe(this,n)}}function Tbe(e,t){return!t||"object"!==_be(t)&&"function"!=typeof t?Cbe(e):t}function Cbe(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Pbe(e){return(Pbe=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Rbe=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Sbe(e,t)}(i,e);var t,n,r,o=Obe(i);function i(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(e=o.call(this)).table=null,e.labelVisible=!1,e.statusVisible=!1,e.gridColumnCount=7,e.bodyLayoutConfig={hgap:8},e.groupByField=null,e.sortByField=null,e._tableGroupHandler=e._onTableGroup.bind(Cbe(e)),e._tableSortHandler=e._onTableSort.bind(Cbe(e)),e._destroyHandler=e._uninstallListeners.bind(Cbe(e)),e}return t=i,(n=[{key:"_installListeners",value:function(){this.table.on("group",this._tableGroupHandler),this.table.on("sort",this._tableSortHandler),this.table.one("destroy",this._destroyHandler)}},{key:"_uninstallListeners",value:function(){this.table.off("group",this._tableGroupHandler),this.table.off("sort",this._tableSortHandler)}},{key:"_init",value:function(e){kbe(Pbe(i.prototype),"_init",this).call(this,e),this.table=this.parent,this._installListeners(),this.insertField(O.create("PlaceholderField",{id:"PlaceholderField",parent:this,gridDataHints:{w:5}})),this.groupByField=O.create("SmartField",{id:"GroupByField",parent:this,label:this.session.text("GroupBy"),labelPosition:ZW.LabelPosition.ON_FIELD,clearable:Qz.Clearable.ALWAYS,statusVisible:!1,displayStyle:e3.DisplayStyle.DROPDOWN}),this.groupByField.setLookupCall(this._createGroupByLookupCall()),this.groupByField.setVisible(!rt.empty(this.groupByField.lookupCall.data)),this.groupByField.on("propertyChange",this._onGroupingChange.bind(this)),this.insertField(this.groupByField),this.sortByField=O.create("SmartField",{id:"SortByField",parent:this,label:this.session.text("SortBy"),labelPosition:ZW.LabelPosition.ON_FIELD,clearable:Qz.Clearable.ALWAYS,statusVisible:!1,displayStyle:e3.DisplayStyle.DROPDOWN}),this.sortByField.setLookupCall(this._createSortByLookupCall()),this.sortByField.setVisible(!rt.empty(this.sortByField.lookupCall.data)),this.sortByField.on("propertyChange",this._onSortingChange.bind(this)),this.insertField(this.sortByField),this._syncSortingGroupingFields()}},{key:"_findSortByLookupRowForKey",value:function(e){return this.sortByField.lookupCall.data.map((function(e){return e[0]})).find((function(t){return t.column===e.column&&t.asc===e.asc}),this)}},{key:"_createGroupByLookupCall",value:function(){return O.create("TileTableHeaderGroupByLookupCall",{session:this.session,table:this.table})}},{key:"_createSortByLookupCall",value:function(){return O.create("TileTableHeaderSortByLookupCall",{session:this.session,table:this.table})}},{key:"_onGroupingChange",value:function(e){if(this.table.tileMode&&"value"===e.propertyName){var t;if(this.isGrouping=!0,null!==e.newValue){var n=(t=e.newValue).sortIndex>=0&&!t.sortAscending?"desc":"asc";this.table.groupColumn(t,!1,n,!1)}else t=e.oldValue,this.table.groupColumn(t,!1,null,!0);this.isGrouping=!1}}},{key:"_onSortingChange",value:function(e){this.table.tileMode&&"value"===e.propertyName&&(this.isSorting=!0,null!==e.newValue?(e.newValue.column,e.newValue.column,this.table.sort(e.newValue.column,e.newValue.asc?"asc":"desc",!1,!1)):this.table.sort(e.oldValue,null,!1,!0),this.isSorting=!1)}},{key:"_syncSortingGroupingFields",value:function(){var e=rt.find(this.table.visibleColumns(),(function(e){return e.grouped&&0===e.sortIndex}));e?this.groupByField.setValue(e):this.groupByField.setValue(null);var t=rt.find(this.table.visibleColumns(),(function(e){return e.sortActive&&0===e.sortIndex}));t?this.sortByField.setValue(this._findSortByLookupRowForKey({column:t,asc:t.sortAscending})):this.sortByField.setValue(null)}},{key:"_onTableGroup",value:function(e){this.isGrouping||this._syncSortingGroupingFields()}},{key:"_onTableSort",value:function(e){this.isSorting||this._syncSortingGroupingFields()}}])&&wbe(t.prototype,n),r&&wbe(t,r),i}(gJ);function xbe(e){return(xbe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ebe(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Dbe(e,t,n){return(Dbe="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=jbe(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function Abe(e,t){return(Abe=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Fbe(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=jbe(e);if(t){var o=jbe(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return $be(this,n)}}function $be(e,t){return!t||"object"!==xbe(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function jbe(e){return(jbe=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Bbe=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Abe(e,t)}(i,e);var t,n,r,o=Fbe(i);function i(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),o.call(this)}return t=i,(n=[{key:"init",value:function(e){return Dbe(jbe(i.prototype),"init",this).call(this,e)}},{key:"_prepareEssentials",value:function(e){te.get().init()}},{key:"_doBootstrap",value:function(e){return[]}},{key:"_init",value:function(e){(e=e||{}).texts=s.a.extend({},bp.readFromDOM(),e.texts),this._prepareDOM(),O.create("LoginBox",e).render(s()("body").addClass("login-body"))}}])&&Ebe(t.prototype,n),r&&Ebe(t,r),i}(E);function Mbe(e){return(Mbe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ibe(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Lbe(e,t,n){return(Lbe="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=zbe(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function Hbe(e,t){return(Hbe=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Nbe(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=zbe(e);if(t){var o=zbe(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Vbe(this,n)}}function Vbe(e,t){return!t||"object"!==Mbe(t)&&"function"!=typeof t?Wbe(e):t}function Wbe(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function zbe(e){return(zbe=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Gbe=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Hbe(e,t)}(i,e);var t,n,r,o=Nbe(i);function i(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(e=o.call(this)).ajaxOptions={type:"POST"},e.authUrl="auth",e.onPostDoneFunc=e.redirect.bind(Wbe(e)),e.redirectUrl=null,e.logoUrl="logo.png",e.userDataKey="user",e.passwordDataKey="password",e.additionalData={},e.prepareRedirectUrlFunc=i.prepareRedirectUrl,e.messageKey=null,e.texts={"ui.Login":"Login","ui.LoginFailed":"Login failed","ui.User":"Username","ui.Password":"Password"},e}return t=i,r=[{key:"prepareRedirectUrl",value:function(e){var t=/^([^?#]*)(\?[^#]*)?(#.*)?$/.exec(e||"");return t[1].replace(/login.html$/,"").replace(/login$/,"").replace(/logout$/,"")+(t[2]?t[2]:"")+(t[3]?t[3]:"")}}],(n=[{key:"init",value:function(e){(e=e||{}).texts=new ip(s.a.extend(this.texts,e.texts)),e.ajaxOptions=s.a.extend(this.ajaxOptions,e.ajaxOptions),s.a.extend(this,e)}},{key:"_render",value:function(){Lbe(zbe(i.prototype),"_render",this).call(this),this.$container.addClass("login-box"),this.$content.addClass("login-box-content "),this.$form=s()("<form>").attr("action",this.authUrl).attr("method","post").submit(this._onLoginFormSubmit.bind(this)).appendTo(this.$content),this.messageKey&&(this.$message=s()("<div>").attr("id","message-box").html(Wn.nl2br(this.texts.get(this.messageKey))).appendTo(this.$form)),this.$user=s()("<input>").attr("type","text").attr("autocapitalize","off").attr("autocorrect","off").placeholder(this.texts.get("ui.User")).addClass("alternative").appendTo(this.$form),this.$password=s()("<input>").attr("type","password").placeholder(this.texts.get("ui.Password")).addClass("alternative").appendTo(this.$form),this.$button=s()("<button>").attr("type","submit").addClass("login-button button default").text(this.texts.get("ui.Login")).appendTo(this.$form),this.$user.focus()}},{key:"_resetButtonText",value:function(){this.$button.text(this.texts.get("ui.Login")).removeClass("login-error")}},{key:"data",value:function(){var e={};return e[this.userDataKey]=this.$user.val(),e[this.passwordDataKey]=this.$password.val(),s.a.extend(e,this.additionalData),e}},{key:"_onLoginFormSubmit",value:function(e){e.preventDefault();var t=this.$form.attr("action"),n=this.data();this.$button.removeClass("login-error").setEnabled(!1),this.$user.off("input.resetLoginError"),this.$password.off("input.resetLoginError"),Kt.get().supportsCssAnimation()&&this.$button.html("").append(s()("<div>").addClass("login-button-loading"));var r=s.a.extend({},this.ajaxOptions,{url:t,data:n});s.a.ajax(r).done(this._onPostDone.bind(this)).fail(this._onPostFail.bind(this))}},{key:"redirect",value:function(e){var t=this.redirectUrl;t||(t=(window.location.href||"").trim(),t=this.prepareRedirectUrlFunc(t)),t?window.location.href=t:window.location.reload()}},{key:"_onPostDone",value:function(e){this.remove(),this.onPostDoneFunc.call(this,e)}},{key:"_onPostFail",value:function(e,t,n){setTimeout(this._onPostFailImpl.bind(this,e,t,n),300)}},{key:"_onPostFailImpl",value:function(e,t,n){var r=this;this.$button.setEnabled(!0).html("").text(this.texts.get("ui.LoginFailed")).addClass("login-error"),this.$user.val("").focus(),this.$password.val(""),setTimeout((function(){r.$user.one("input.resetLoginError",r._resetButtonText.bind(r)),r.$password.one("input.resetLoginError",r._resetButtonText.bind(r))}))}}])&&Ibe(t.prototype,n),r&&Ibe(t,r),i}(cd);function Ube(e){return(Ube="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Kbe(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function qbe(e,t,n){return(qbe="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Zbe(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function Ybe(e,t){return(Ybe=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Xbe(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Zbe(e);if(t){var o=Zbe(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Jbe(this,n)}}function Jbe(e,t){return!t||"object"!==Ube(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Zbe(e){return(Zbe=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Qbe=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ybe(e,t)}(i,e);var t,n,r,o=Xbe(i);function i(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),o.call(this)}return t=i,(n=[{key:"init",value:function(e){return qbe(Zbe(i.prototype),"init",this).call(this,e)}},{key:"_prepareEssentials",value:function(e){te.get().init()}},{key:"_doBootstrap",value:function(e){return[]}},{key:"_init",value:function(e){(e=e||{}).texts=s.a.extend({},bp.readFromDOM(),e.texts),this._prepareDOM(),O.create("LogoutBox",e).render(s()("body").addClass("logout-body"))}}])&&Kbe(t.prototype,n),r&&Kbe(t,r),i}(E);function eme(e){return(eme="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function tme(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function nme(e,t,n){return(nme="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=sme(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function rme(e,t){return(rme=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function ome(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=sme(e);if(t){var o=sme(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return ime(this,n)}}function ime(e,t){return!t||"object"!==eme(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function sme(e){return(sme=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var ame=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&rme(e,t)}(i,e);var t,n,r,o=ome(i);function i(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),o.call(this)}return t=i,(n=[{key:"init",value:function(e){var t={loginUrl:Ho.getItemFromSessionStorage("scout:loginUrl")||"./",logoUrl:"logo.png"};this.options=s.a.extend({},t,e),this.options.texts=s.a.extend({},{"ui.LogoutSuccessful":"Good bye!","ui.LoginAgain":"Login again"},e.texts),this.texts=new ip(this.options.texts),this.loginUrl=this.options.loginUrl,this.logoUrl=this.options.logoUrl}},{key:"_render",value:function(){nme(sme(i.prototype),"_render",this).call(this),this.$content.addClass("small centered").appendDiv().html(Wn.nl2br(this.texts.get("ui.LogoutSuccessful"))),this.$buttonBar=s()("<div>").addClass("button-bar").appendTo(this.$content),s()("<button>").addClass("button").text(this.texts.get("ui.LoginAgain")).on("click",this._loginAgain.bind(this)).appendTo(this.$buttonBar)}},{key:"_loginAgain",value:function(){window.location=this.loginUrl}}])&&tme(t.prototype,n),r&&tme(t,r),i}(cd);function lme(e){return(lme="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ume(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function cme(e,t,n){return(cme="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=dme(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function fme(e,t){return(fme=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function hme(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=dme(e);if(t){var o=dme(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return pme(this,n)}}function pme(e,t){return!t||"object"!==lme(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function dme(e){return(dme=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var yme=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&fme(e,t)}(i,e);var t,n,r,o=hme(i);function i(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(e=o.call(this)).ref=null,e}return t=i,(n=[{key:"_render",value:function(){cme(dme(i.prototype),"_render",this).call(this),this.$container.addClass("breadcrumb-item")}},{key:"_renderText",value:function(){var e=this.text||"";e&&this.textVisible?(this.$text||(this.$text=this.$container.appendSpan("content text"),ea.install(this.$text,this.session)),this.$text.text(e)):this._removeText()}}])&&ume(t.prototype,n),r&&ume(t,r),i}(Up);function vme(e){return(vme="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function bme(e,t){return(bme=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function mme(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=_me(e);if(t){var o=_me(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return gme(this,n)}}function gme(e,t){return!t||"object"!==vme(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function _me(e){return(_me=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var wme=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&bme(e,t)}(n,e);var t=mme(n);function n(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),t.call(this)}return n}(ed);function kme(e){return(kme="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Sme(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Ome(e,t,n){return(Ome="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Rme(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function Tme(e,t){return(Tme=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Cme(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Rme(e);if(t){var o=Rme(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Pme(this,n)}}function Pme(e,t){return!t||"object"!==kme(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Rme(e){return(Rme=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var xme=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Tme(e,t)}(i,e);var t,n,r,o=Cme(i);function i(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(e=o.call(this)).breadcrumbItems=[],e._ellipsisBreadcrumbItem=null,e._addWidgetProperties(["breadcrumbItems"]),e}return t=i,(n=[{key:"_init",value:function(e){Ome(Rme(i.prototype),"_init",this).call(this,e),this._setBreadcrumbItems(this.breadcrumbItems)}},{key:"_render",value:function(){this.$container=this.$parent.appendDiv("breadcrumb-bar"),this.htmlComp=ea.install(this.$container,this.session),this.htmlComp.setLayout(new Ime(this))}},{key:"_renderProperties",value:function(){Ome(Rme(i.prototype),"_renderProperties",this).call(this),this._renderBreadcrumbItems()}},{key:"setBreadcrumbItems",value:function(e){this.setProperty("breadcrumbItems",e)}},{key:"_setBreadcrumbItems",value:function(e){this._setProperty("breadcrumbItems",rt.ensure(e))}},{key:"_renderBreadcrumbItems",value:function(){var e=this;this.breadcrumbItems.forEach((function(t,n){1===n&&e._renderEllipsis(),t.render()}),this),this._updateMarkers(),this.htmlComp.invalidateLayoutTree()}},{key:"_renderEllipsis",value:function(){this._ellipsisBreadcrumbItem&&this._ellipsisBreadcrumbItem.destroy(),this.breadcrumbItems.length<=2||(this._ellipsisBreadcrumbItem=O.create("BreadcrumbItem",{parent:this,text:"...",enabled:!1}),this._ellipsisBreadcrumbItem.render())}},{key:"_updateMarkers",value:function(){var e=[];this.breadcrumbItems.forEach((function(t){t.rendered&&(t.$container.removeClass("first last"),t.isVisible()&&e.push(t))})),e.length&&(e[0].$container.addClass("first"),e[e.length-1].$container.addClass("last"))}}])&&Sme(t.prototype,n),r&&Sme(t,r),i}(ve);function Eme(e){return(Eme="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Dme(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Ame(e,t){return(Ame=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Fme(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Bme(e);if(t){var o=Bme(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return $me(this,n)}}function $me(e,t){return!t||"object"!==Eme(t)&&"function"!=typeof t?jme(e):t}function jme(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Bme(e){return(Bme=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Mme(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Ime=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ame(e,t)}(i,e);var t,n,r,o=Fme(i);function i(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),Mme(jme(t=o.call(this)),"_collapse",(function(e,t){for(var n=this._visibleBreadcrumbItems(),r=this._actualPrefSize(n,!0);r.width>t.width&&1<n.length-1;){var o=n[1];o.$container.hide(),o._layHidden=!0,n.splice(1,1),r=this._actualPrefSize(n,!0)}})),Mme(jme(t),"_breadcrumbItemsWidth",(function(e,t){var n=0;return(e=e||this._visibleBreadcrumbItems()).forEach((function(e){e.rendered&&(n+=e.$container.outerWidth(!0))}),this),t&&this._breadcrumbBar._ellipsisBreadcrumbItem&&this._breadcrumbBar._ellipsisBreadcrumbItem.rendered&&(n+=this._breadcrumbBar._ellipsisBreadcrumbItem.$container.outerWidth(!0)),n})),t._breadcrumbBar=e,t}return t=i,(n=[{key:"layout",value:function(e){this._undoCollapse(this._breadcrumbBar.breadcrumbItems);var t=this._visibleBreadcrumbItems(),n=this._breadcrumbBar.htmlComp.size();this._actualPrefSize(t,!1).width<=n.width?this._applyToEllipsis((function(e){e.setVisible(!1)})):(this._applyToEllipsis((function(e){e.setVisible(!0)})),this._collapse(t,n))}},{key:"_applyToEllipsis",value:function(e){this._breadcrumbBar._ellipsisBreadcrumbItem&&e(this._breadcrumbBar._ellipsisBreadcrumbItem)}},{key:"_undoCollapse",value:function(){rt.ensure(this._breadcrumbBar.breadcrumbItems).forEach((function(e){e.$container.show(),e._layHidden=!1}))}},{key:"preferredLayoutSize",value:function(e){var t=this._visibleBreadcrumbItems();return this._undoCollapse(t),this._actualPrefSize()}},{key:"_breadcrumbSize",value:function(e){var t=e.$container.attr("class");e.$container.removeClass("hidden"),e.htmlComp.invalidateLayout();var n=e.htmlComp.prefSize({useCssSize:!0,exact:!0}).add(qs.margins(e.$container));return e.$container.attrOrRemove("class",t),n}},{key:"_visibleBreadcrumbItems",value:function(){return this._breadcrumbBar.breadcrumbItems.filter((function(e){return e.visible}),this)}},{key:"_actualPrefSize",value:function(e,t){e=e||this._visibleBreadcrumbItems();var n=this._breadcrumbItemsWidth(e,t),r=qs.prefSize(this._breadcrumbBar.$container,{includeMargin:!0,useCssSize:!0});return r.width=n+this._breadcrumbBar.htmlComp.insets().horizontal(),r}}])&&Dme(t.prototype,n),r&&Dme(t,r),i}(Zs);function Lme(e){return(Lme="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Hme(e,t){return(Hme=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Nme(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Wme(e);if(t){var o=Wme(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Vme(this,n)}}function Vme(e,t){return!t||"object"!==Lme(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Wme(e){return(Wme=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var zme=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Hme(e,t)}(n,e);var t=Nme(n);function n(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),t.call(this)}return n}(de);function Gme(e){return(Gme="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ume(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Kme(e,t){return(Kme=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function qme(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Xme(e);if(t){var o=Xme(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Yme(this,n)}}function Yme(e,t){return!t||"object"!==Gme(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Xme(e){return(Xme=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Jme=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Kme(e,t)}(i,e);var t,n,r,o=qme(i);function i(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(e=o.call(this)).breadcrumbBar=null,e._addWidgetProperties(["breadcrumbBar"]),e}return t=i,(n=[{key:"_render",value:function(){this.addContainer(this.$parent,"breadcrumb-bar-field"),this.addLabel(),this.addMandatoryIndicator(),this.addStatus(),this._renderBreadcrumbBar()}},{key:"setBreadcrumbItems",value:function(e){this.breadcrumbBar&&this.breadcrumbBar.setBreadcrumbItems(e)}},{key:"setBreadcrumbBar",value:function(e){this.setProperty("breadcrumbBar",e)}},{key:"_renderBreadcrumbBar",value:function(){this.breadcrumbBar&&(this.breadcrumbBar.render(),this.addField(this.breadcrumbBar.$container),this.invalidateLayoutTree())}},{key:"_removeBreadcrumbBar",value:function(){this.breadcrumbBar&&(this.breadcrumbBar.remove(),this._removeField(),this.invalidateLayoutTree())}}])&&Ume(t.prototype,n),r&&Ume(t,r),i}(ZW);function Zme(e){return(Zme="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Qme(e,t){return(Qme=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function ege(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=nge(e);if(t){var o=nge(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return tge(this,n)}}function tge(e,t){return!t||"object"!==Zme(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function nge(e){return(nge=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var rge=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Qme(e,t)}(n,e);var t=ege(n);function n(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),t.call(this)}return n}(sz);function oge(e){return(oge="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ige(e){return function(e){if(Array.isArray(e))return sge(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return sge(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return sge(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function sge(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function age(e){var t=[];return e.forEach((function(e){"margin"===e||"padding"===e?(t.push(e+"-top"),t.push(e+"-right"),t.push(e+"-bottom"),t.push(e+"-left")):"border"===e?(t.push("border-top-style"),t.push("border-right-style"),t.push("border-bottom-style"),t.push("border-left-style"),t.push("border-top-color"),t.push("border-right-color"),t.push("border-bottom-color"),t.push("border-left-color"),t.push("border-top-width"),t.push("border-right-width"),t.push("border-bottom-width"),t.push("border-left-width")):t.push(e)})),t}function lge(e){return Pr.isNumber(e)?Math.ceil(e):e}O.addObjectFactories({KeyStroke:function(){return new Up},KeyStrokeAdapter:function(){return new ed},ComposerField:function(){return new Pte},ComposerFieldAdapter:function(){return new Fte}});var uge=s.a.cleanData;s.a.cleanData=function(e){var t,n,r;for(r=0;n=e[r];r++)try{(t=s.a._data(n,"events"))&&t.remove&&s()(n).triggerHandler("remove")}catch(e){}uge(e)},s.a.removeThis=function(){s()(this).remove()},s.a.suppressEvent=function(e){e&&(e.preventDefault(),e.stopPropagation(),e.stopImmediatePropagation())},s.a.suppressEventIfDisabled=function(e,t){return!(t=t||s()(e.target)).isEnabled()&&(s.a.suppressEvent(e),!0)},s.a.debounce=function(e,t){"number"==typeof t&&(t={delay:t}),t=s.a.extend({delay:250,reschedule:!0},t);var n=null,r=function(){for(var r=arguments.length,o=new Array(r),i=0;i<r;i++)o[i]=arguments[i];var s=this;n&&!t.reschedule||(n&&clearTimeout(n),n=setTimeout((function(){n=null,e.apply(s,o)}),t.delay))};return r.cancel=function(){return!!n&&(clearTimeout(n),n=null,!0)},r},s.a.throttle=function(e,t){t=void 0!==t?t:250;var n,r=null;return function(){for(var o=arguments.length,i=new Array(o),s=0;s<o;s++)i[s]=arguments[s];var a=this,l=(new Date).getTime(),u=function(){n=l,e.apply(a,i)};n&&n+t>l?(clearTimeout(r),r=setTimeout((function(){u()}),t)):u()}},s.a.negate=function(e){return function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return!e.apply(this,n)}},s.a.colorOpacity=function(e,t){(e=String(e).replace(/[^0-9a-f]/gi,"")).length<6&&(e=e[0]+e[0]+e[1]+e[1]+e[2]+e[2]),t=t||0;for(var n="#",r=0;r<3;r++){var o=parseInt(e.substr(2*r,2),16);n+=("00"+(o=Math.round(Math.min(Math.max(0,255-(255-o)*t),255)).toString(16))).substr(o.length)}return n},s.a.injectScript=function(e,t){t=t||{};var n=s.a.Deferred(),r=t.document||window.document,o=r.createElement("script");return s()(o).attr("src",e).attr("async",!0).on("load error",(function(e){t.removeTag&&r.head.removeChild(o),"error"===e.type?n.reject(s()(o)):n.resolve(s()(o))})),r.head.appendChild(o),n.promise()},s.a.injectStyleSheet=function(e,t){t=t||{};var n=s.a.Deferred(),r=t.document||window.document,o=r.createElement("link");return s()(o).attr("rel","stylesheet").attr("type","text/css").attr("href",e).on("load error",(function(e){"error"===e.type?n.reject(s()(o)):n.resolve(s()(o))})),r.head.appendChild(o),n.promise()},s.a.injectStyle=function(e,t){var n=(t=t||{}).document||window.document,r=n.createElement("style"),o=s()(r);return o.attr("type","text/css").html(e),n.head.appendChild(r),o},s.a.pxToNumber=function(e){return e?parseFloat(e):0},s.a.resolvedDeferred=function(){var e=s.a.Deferred();return e.resolve.apply(e,arguments),e},s.a.resolvedPromise=function(){var e=s.a.Deferred();return e.resolve.apply(e,arguments),e.promise()},s.a.rejectedPromise=function(){var e=s.a.Deferred();return e.reject.apply(e,arguments),e.promise()},s.a.promiseAll=function(e,t){t=O.nvl(t,!1),e=rt.ensure(e);var n=s.a.Deferred();return s.a.when.apply(s.a,ige(e)).done((function(){for(var e=arguments.length,r=new Array(e),o=0;o<e;o++)r[o]=arguments[o];t?n.resolve(r):n.resolve.apply(n,r)})).fail((function(){n.reject.apply(n,arguments)})),n.promise()},s.a.ajaxJson=function(e){return s.a.ajax({url:e,dataType:"json",contentType:"application/json; charset=UTF-8"}).catch((function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.push(this),s.a.rejectedPromise.apply(s.a,t)}))},s.a.ensure=function(e){return e instanceof s.a?e:s()(e)},s.a.isJqXHR=function(e){return"object"===oge(e)&&e.hasOwnProperty("readyState")&&e.hasOwnProperty("status")&&e.hasOwnProperty("statusText")},s.a.fn.nvl=function(e){return!this.length&&e instanceof s.a?e:this},s.a.fn.makeElement=function(e,t,n){var r=this.document(!0);if(void 0===r||void 0===e)return new Error("missing arguments: document, element");var o=s()(e,r);return t&&o.addClass(t),n&&o.text(n),o},s.a.fn.makeDiv=function(e,t){return this.makeElement("<div>",e,t)},s.a.fn.makeSpan=function(e,t){return this.makeElement("<span>",e,t)},s.a.fn.document=function(e){var t=this.length?this[0]instanceof Document?this[0]:this[0].ownerDocument:null;return e?t:s()(t)},s.a.fn.window=function(e){var t=this.document(!0),n=t?t.defaultView:null;return e?n:s()(n)},s.a.fn.activeElement=function(e){var t=this.document(!0),n=t?t.activeElement:null;return e?n:s()(n)},s.a.fn.body=function(e){var t=s()("body",this.document(!0));return e?t[0]:t},s.a.fn.entryPoint=function(e){var t=this.closest(".scout");return e?t[0]:t},s.a.fn.windowSize=function(){var e=this.window();return new $s(e.width(),e.height())},s.a.fn.elementFromPoint=function(e,t,n){var r,o=s()(this),i=o.document(!0),a=[],l=0;if(i||(i=o[0]),!i)return s()();for(;0!==(r=s()(i.elementFromPoint(e,t))).length&&r[0]!==i.documentElement&&(!o.isOrHas(r)||n&&!r.is(n));)if(a.push(r),r.addClass("invisible"),++l>1e3){s.a.log.warn("Infinite loop aborted",r),r=s()();break}return r[0]===i.documentElement&&o[0]!==i&&(r=s()()),a.forEach((function(e){e.removeClass("invisible")})),r},s.a.fn.prependDiv=function(e,t){return this.makeDiv(e,t).prependTo(this)},s.a.fn.appendDiv=function(e,t){return this.makeDiv(e,t).appendTo(this)},s.a.fn.prependElement=function(e,t,n){return this.makeElement(e,t,n).prependTo(this)},s.a.fn.appendElement=function(e,t,n){return this.makeElement(e,t,n).appendTo(this)},s.a.fn.afterDiv=function(e,t){return this.makeDiv(e,t).insertAfter(this)},s.a.fn.beforeDiv=function(e,t){return this.makeDiv(e,t).insertBefore(this)},s.a.fn.appendSpan=function(e,t){return this.makeSpan(e,t).appendTo(this)},s.a.fn.appendBr=function(e){return this.makeElement("<br>",e).appendTo(this)},s.a.fn.appendTextNode=function(e){return s()(this.document(!0).createTextNode(e)).appendTo(this)},s.a.fn.appendIcon=function(e,t){return e?(n=e instanceof lm?e:gn.parseIconId(e)).isFontIcon()?this.makeSpan(t,n.iconCharacter).addClass("icon").addClass(n.appendCssClass("font-icon")).appendTo(this):this.appendImg(n.iconUrl,t).addClass("icon image-icon"):this.appendSpan(t).addClass("icon");var n},s.a.fn.appendImg=function(e,t){var n=this.appendElement("<img>",t);return e&&n.attr("src",e),n},s.a.fn.makeSVG=function(e,t,n,r){var o=this.document(!0);if(void 0===o||void 0===e)return new Error("missing arguments: document, type");var i=s()(o.createElementNS("http://www.w3.org/2000/svg",e));return t&&i.attr("class",t),n&&i.text(n),void 0!==r&&i.attr("id",r),i},s.a.fn.appendSVG=function(e,t,n,r){return this.makeSVG(e,t,n,r).appendTo(this)},s.a.fn.attrXLINK=function(e,t){return 0===this.length?this:1===this.length?(this[0].setAttributeNS("http://www.w3.org/1999/xlink","xlink:"+e,t),this):this.each((function(){this.setAttributeNS("http://www.w3.org/1999/xlink","xlink:"+e,t)}))},s.a.fn.addDeviceClass=function(){var e=Kt.get();return e.isInternetExplorer()&&(this.addClass("ie"),9===e.browserVersion&&this.addClass("ie9")),e.isIos()&&this.addClass("ios"),this},s.a.fn.selectOne=function(){return this.siblings().removeClass("selected"),this.addClass("selected"),this},s.a.fn.select=function(e){return this.toggleClass("selected",!!e)},s.a.fn.isSelected=function(){return this.hasClass("selected")},s.a.fn.setEnabled=function(e){return e=!!e,this.toggleClass("disabled",!e),this.is("button, input, select, textarea, optgroup, option, fieldset")&&this.toggleAttr("disabled",!e),this.trigger(e?"enable":"disable"),this},s.a.fn.isEnabled=function(){return!this.hasClass("disabled")},s.a.fn.setVisible=function(e){return!this.hasClass("hidden")===e||(e?(this.removeClass("hidden"),this.trigger("show")):(this.addClass("hidden"),this.trigger("hide"))),this},s.a.fn.isDisplayNone=function(){return"none"===this.css("display")},s.a.fn.setTabbable=function(e){return this.attr("tabIndex",e?0:null)},s.a.fn.isTabbable=function(){return this.attr("tabIndex")>=0},s.a.fn.icon=function(e,t){var n,r=this.data("$icon");return e?(n=gn.parseIconId(e)).isFontIcon()?o.call(this,r,"<span>",t).addClass("icon").addClass(n.appendCssClass("font-icon")).text(n.iconCharacter):o.call(this,r,"<img>",t).attr("src",n.iconUrl).addClass("icon image-icon"):i.call(this,r),this;function o(e,t,n){return e&&!e.is(t.replace(/[<>]/g,""))&&(i.call(this,e),e=null),e||(e=s()(t),this.data("$icon",e),n?n.call(this,e):this.prepend(e)),e}function i(e){e&&e.remove(),this.removeData("$icon")}},s.a.fn.placeholder=function(e){return this.toggleAttr("placeholder",!!e,e)},s.a.fn.isVisible=function(){return!this.hasClass("hidden")&&function(e){if(!e||n(e.style))return!1;var t=(e instanceof Document?e:e.ownerDocument).defaultView;return!!t&&!n(t.getComputedStyle(e));function n(e){return"none"===e.display}}(this[0])},s.a.fn.isEveryParentVisible=function(){var e=!0;return this.parents().each((function(){if(!s()(this).isVisible())return e=!1,!1})),e},s.a.fn.isAttached=function(){return s.a.contains(this.document(!0).documentElement,this[0])},s.a.fn.scrollParent=function(){for(var e=this;e.length>0;){if(e.data("scrollable"))return e;e=e.parent()}return s()()},s.a.fn.scrollParents=function(){for(var e=s()(),t=this;t.length>0;)t.data("scrollable")&&e.push(t),t=t.parent();return e},s.a.fn.findUp=function(e,t){for(var n=s()(this);n.length>0;){if(e(n))return n;if(t&&n[0]===t[0])return s()();n=n.parent()}return s()()},s.a.fn.animateAVCSD=function(e,t,n,r,o){var i={},s={};return i[e]=t,n&&(s.complete=n),r&&(s.step=r),o&&(s.duration=o),s.queue=!1,this.animate(i,s),this},s.a.fn.animateSVG=function(e,t,n,r,o){return this.each((function(){var i=parseFloat(s()(this).attr(e));if(o){var a=r;r=function(){a&&a.call(this),s()(this).removeAttr("tabindex")}}s()(this).animate({tabIndex:0},{step:function(n,r){this.setAttribute(e,i+(t-i)*r.pos)},duration:n,complete:r,queue:!1})}))},s.a.fn.addClassForAnimation=function(e,t){var n=this,r={classesToRemove:e};return t=s.a.extend({},r,t),this.addClass(e),this.oneAnimationEnd((function(){n.removeClass(t.classesToRemove)})),this},s.a.fn.oneAnimationEnd=function(e,t,n){return this.one("animationend webkitAnimationEnd",e,t,n)},s.a.fn.hasAnimationClass=function(){return/(^|\s)animate-/.test(this.attr("class"))},s.a.fn.cssWidthAnimated=function(e,t,n){return(n=n||{}).duration=O.nvl(n.duration,300),this.cssWidth(e),this.animate({width:t},n),this},s.a.fn.cssHeightAnimated=function(e,t,n){return(n=n||{}).duration=O.nvl(n.duration,300),this.cssHeight(e),this.animate({height:t},n),this},s.a.fn.cssLeftAnimated=function(e,t,n){return(n=n||{}).duration=O.nvl(n.duration,300),this.cssLeft(e),this.animate({left:t},n),this},s.a.fn.cssTopAnimated=function(e,t,n){return(n=n||{}).duration=O.nvl(n.duration,300),this.cssTop(e),this.animate({top:t},n),this},s.a.fn.cssAnimated=function(e,t,n){return(n=n||{}).duration=O.nvl(n.duration,300),this.css(e),this.animate(t,n),this},s.a.fn.widthToContent=function(e){var t=this.outerWidth(),n=this.css("width","auto").outerWidth();return this.cssWidthAnimated(t,n,e),this},s.a.fn.offsetTo=function(e){var t=e.offset(),n=this.offset();return{top:n.top-t.top,left:n.left-t.left}},s.a.fn.cssPxValue=function(e,t){return void 0===t?s.a.pxToNumber(this.css(e)):(null===t&&(t=""),"string"==typeof t?this.css(e,t):this.css(e,t+"px"))},s.a.fn.cssLeft=function(e){return this.cssPxValue("left",e)},s.a.fn.cssTop=function(e){return this.cssPxValue("top",e)},s.a.fn.cssPosition=function(e){return this.cssLeft(e.x).cssTop(e.y)},s.a.fn.cssBottom=function(e){return this.cssPxValue("bottom",e)},s.a.fn.cssRight=function(e){return this.cssPxValue("right",e)},s.a.fn.cssWidth=function(e){return this.cssPxValue("width",e)},s.a.fn.cssMinWidth=function(e){if(void 0===e){var t=this.css("min-width");return"auto"===t||-1!==t.indexOf("%")?0:s.a.pxToNumber(t)}return this.cssPxValue("min-width",e)},s.a.fn.cssMaxWidth=function(e){if(void 0===e){var t=this.css("max-width");return"none"===t||-1!==t.indexOf("%")?Number.MAX_VALUE:s.a.pxToNumber(t)}return this.cssPxValue("max-width",e)},s.a.fn.cssHeight=function(e){return this.cssPxValue("height",e)},s.a.fn.cssMinHeight=function(e){if(void 0===e){var t=this.css("min-height");return"auto"===t||-1!==t.indexOf("%")?0:s.a.pxToNumber(t)}return this.cssPxValue("min-height",e)},s.a.fn.cssMaxHeight=function(e){if(void 0===e){var t=this.css("max-height");return"none"===t||-1!==t.indexOf("%")?Number.MAX_VALUE:s.a.pxToNumber(t)}return this.cssPxValue("max-height",e)},s.a.fn.cssLineHeight=function(e){return this.cssPxValue("line-height",e)},s.a.fn.cssMarginLeft=function(e){return this.cssPxValue("margin-left",e)},s.a.fn.cssMarginBottom=function(e){return this.cssPxValue("margin-bottom",e)},s.a.fn.cssMarginRight=function(e){return this.cssPxValue("margin-right",e)},s.a.fn.cssMarginTop=function(e){return this.cssPxValue("margin-top",e)},s.a.fn.cssMarginX=function(e){return void 0===e?this.cssMarginLeft()+this.cssMarginRight():(this.cssMarginLeft(e),this.cssMarginRight(e),this)},s.a.fn.cssMarginY=function(e){return void 0===e?this.cssMarginTop()+this.cssMarginBottom():(this.cssMarginTop(e),this.cssMarginBottom(e),this)},s.a.fn.cssPaddingTop=function(e){return this.cssPxValue("padding-top",e)},s.a.fn.cssPaddingRight=function(e){return this.cssPxValue("padding-right",e)},s.a.fn.cssPaddingBottom=function(e){return this.cssPxValue("padding-bottom",e)},s.a.fn.cssPaddingLeft=function(e){return this.cssPxValue("padding-left",e)},s.a.fn.cssPaddingX=function(e){return void 0===e?this.cssPaddingLeft()+this.cssPaddingRight():(this.cssPaddingLeft(e),this.cssPaddingRight(e),this)},s.a.fn.cssPaddingY=function(e){return void 0===e?this.cssPaddingTop()+this.cssPaddingBottom():(this.cssPaddingTop(e),this.cssPaddingBottom(e),this)},s.a.fn.cssBorderBottomWidth=function(e){return this.cssPxValue("border-bottom-width",e)},s.a.fn.cssBorderLeftWidth=function(e){return this.cssPxValue("border-left-width",e)},s.a.fn.cssBorderRightWidth=function(e){return this.cssPxValue("border-right-width",e)},s.a.fn.cssBorderTopWidth=function(e){return this.cssPxValue("border-top-width",e)},s.a.fn.cssBorderWidthY=function(e){if(void 0===e)return this.cssBorderTopWidth()+this.cssBorderBottomWidth();this.cssBorderTopWidth(e),this.cssBorderBottomWidth(e)},s.a.fn.cssBorderWidthX=function(e){if(void 0===e)return this.cssBorderLeftWidth()+this.cssBorderRightWidth();this.cssBorderLeftWidth(e),this.cssBorderRightWidth(e)},s.a.fn.innerBottom=function(){return this.position().top+this.outerHeight(!0)-this.cssMarginBottom()-this.cssBorderBottomWidth()},s.a.fn.innerRight=function(){return this.position().left+this.outerWidth(!0)-this.cssMarginRight()-this.cssBorderRightWidth()},s.a.fn.copyCss=function(e,t){var n=t.split(" "),r=this;return(n=age(n)).forEach((function(t){r.css(t,e.css(t))})),r},s.a.fn.copyCssIfGreater=function(e,t){var n=t.split(" "),r=this;return(n=age(n)).forEach((function(t){var n=s.a.pxToNumber(e.css(t));n>s.a.pxToNumber(r.css(t))&&r.css(t,n+"px")})),r},s.a.fn.copyCssClasses=function(e,t){var n=t.split(" "),r=this;return n.forEach((function(t){e.hasClass(t)&&r.addClass(t)})),r},s.a.fn.disableSpellcheck=function(){return this.attr("spellcheck",!1)},s.a.fn.isOrHas=function(e){return e instanceof s.a&&(e=e[0]),this[0]===e||this.has(e).length>0},s.a.fn.resizable=function(e){var t=s()(this),n=t.data("resizable");return n||(n=O.create("Resizable",s.a.extend(e,{$container:t})),t.data("resizable",n)),this},s.a.fn.unresizable=function(){var e=s()(this),t=e.data("resizable");return t&&(t.destroy(),e.removeData("resizable")),this},s.a.fn.draggable=function(e,t){var n=this;return(e=e||n).on("mousedown.draggable",(function(r){s()("iframe").addClass("dragging-in-progress");var o=n.offset(),i=r,a=e.width(),l=e.window().width(),u=e.window().height();e.parents().on("mousemove.dragging",(function(e){var r=o.top+(e.pageY-i.pageY),s=o.left+(e.pageX-i.pageX);s=Math.max(100-a,s),s=Math.min(l-100,s),r=Math.max(0,r);var c={top:r=Math.min(u-100,r),left:s};n.offset(c),t&&t(c)})).on("mouseup.dragging",(function(t){e.parents().off(".dragging"),s()("iframe").removeClass("dragging-in-progress")})),r.preventDefault()}))},s.a.fn.undraggable=function(e){return(e=e||this).off("mousedown.draggable")},s.a.fn.fadeOutAndRemove=function(e,t){return void 0===t&&"function"==typeof e&&(t=e,e=void 0),e=O.nvl(e,150),this.stop(!0).fadeOut(e,(function(){s()(this).remove(),t&&t.call(this)}))},s.a.fn.removeAnimated=function(e,t){void 0===t&&"function"==typeof e&&(t=e,e=void 0),this.isDisplayNone()?(this.remove(),t&&t.call(this)):Kt.get().supportsCssAnimation()?(this.addClass(e||"animate-remove"),this.oneAnimationEnd((function(){s()(this).remove(),t&&t.call(this)}))):this.fadeOutAndRemove(t)};var cge=s.a.fn.hide;s.a.fn.hide=function(){this.trigger("hide");for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return cge.apply(this,t)};var fge=s.a.fn.width;s.a.fn.width=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return lge(fge.apply(this,t))};var hge=s.a.fn.outerWidth;s.a.fn.outerWidth=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return lge(hge.apply(this,t))};var pge=s.a.fn.height;s.a.fn.height=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return lge(pge.apply(this,t))};var dge=s.a.fn.outerHeight;function yge(e,t){var n=e.nodeName.toLowerCase();return(/input|select|textarea|button|object/.test(n)?!e.disabled:"a"===n&&e.href||t)&&function(e){return s.a.expr.filters.visible(e)&&!s()(e).parents().addBack().filter((function(){return"hidden"===s.a.css(this,"visibility")})).length}(e)}function vge(){return(vge=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function bge(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function mge(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?bge(Object(n),!0).forEach((function(t){gge(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):bge(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function gge(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}s.a.fn.outerHeight=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return lge(dge.apply(this,t))},s.a.fn.textOrNbsp=function(e,t){return this.contentOrNbsp(!1,e,t)},s.a.fn.htmlOrNbsp=function(e,t){return this.contentOrNbsp(!0,e,t)},s.a.fn.contentOrNbsp=function(e,t,n){var r=e?this.html:this.text;return Wn.hasText(t)?(r.call(this,t),n&&this.removeClass(n)):(this.html("&nbsp;"),n&&this.addClass(n)),this},s.a.fn.toggleAttr=function(e,t,n){return e?(void 0===n&&(n=e),this.each((function(){var r=s()(this);void 0===t&&(t=void 0===r.attr(e)),t?r.attr(e,n):r.removeAttr(e)}))):this},s.a.fn.backupSelection=function(){var e=this[0];return e&&e===this.activeElement(!0)?{selectionStart:e.selectionStart,selectionEnd:e.selectionEnd,selectionDirection:e.selectionDirection}:null},s.a.fn.restoreSelection=function(e){var t=this[0];return t&&t===this.activeElement(!0)&&e&&t.setSelectionRange(e.selectionStart,e.selectionEnd,e.selectionDirection),this},s.a.fn.attrOrRemove=function(e,t){return t?this.attr(e,t):this.removeAttr(e),this},s.a.fn.appendAppLink=function(e,t){return this.appendSpan().appLink(e,t)},s.a.fn.appLink=function(e,t){return t?"object"===oge(t)&&t._onAppLinkAction&&(t=t._onAppLinkAction.bind(t)):t=function(e){var t=O.widget(this);t&&t._onAppLinkAction&&t._onAppLinkAction(e)}.bind(this),this.addClass("app-link").attr("tabindex","0").unfocusable().on("click",t),"string"==typeof e?this.attr("data-ref",e):this.text(e.name).attr("data-ref",e.ref),this},s.a.fn.unfocusable=function(){return this.addClass("unfocusable")},s.a.fn.selectAllText=function(){var e,t=this.document(!0),n=this.window(!0),r=this[0];return t&&t.body&&n&&r?t.body.createTextRange?((e=t.body.createTextRange()).moveToElementText(r),e.select(),this):(n.getSelection&&((e=t.createRange()).selectNodeContents(r),n.getSelection().removeAllRanges(),n.getSelection().addRange(e)),this):this},s.a.fn._getClientAndScrollWidthRounded=function(){var e=this[0],t=Kt.get();return t.isInternetExplorer()||t.isEdge()?{clientWidth:Math.ceil(e.getBoundingClientRect().width)-this.cssBorderWidthX(),scrollWidth:e.scrollWidth}:{clientWidth:e.clientWidth,scrollWidth:e.scrollWidth}},s.a.fn._getClientAndScrollWidthReliable=function(){var e=this._getClientAndScrollWidthRounded();if(!Kt.get().isScrollWidthIncludingPadding())return e;if(e.scrollWidth>e.clientWidth)return e;var t=this.cssPaddingRight(),n=this.attr("style");if(t>0&&(this.css({width:e.clientWidth-t,paddingRight:"0px"}),e=this._getClientAndScrollWidthRounded(),this.attrOrRemove("style",n),e.scrollWidth>e.clientWidth))return e;var r=this[0].getBoundingClientRect().width;this.css("width","auto"),this.css("max-width","none");var o=this[0].getBoundingClientRect().width;return this.attrOrRemove("style",n),{clientWidth:r,scrollWidth:o}},s.a.fn.isContentTruncated=function(){var e=this._getClientAndScrollWidthReliable();return e.scrollWidth>e.clientWidth},s.a.fn.onSingleOrDoubleClick=function(e,t,n){return this.each((function(){var n=this,r=0,o=O.nvl(o,300);s()(this).on("click",(function(i){1===++r&&setTimeout((function(){1===r?e.call(n,i):t.call(n,i),r=0}),o)}))}))},s.a.fn.onPassive=function(e,t){var n=Nt.passiveOptions();return this[0].addEventListener(e,t,n),this},s.a.fn.offPassive=function(e,t){var n=Nt.passiveOptions();return this[0].removeEventListener(e,t,n),this},s.a.fn.appendTable=function(e){return this.appendElement("<table>",e)},s.a.fn.appendColgroup=function(e){return this.appendElement("<colgroup>",e)},s.a.fn.appendCol=function(e){return this.appendElement("<col>",e)},s.a.fn.appendTr=function(e){return this.appendElement("<tr>",e)},s.a.fn.appendTd=function(e,t){return this.appendElement("<td>",e,t)},s.a.fn.appendTh=function(e,t){return this.appendElement("<th>",e,t)},s.a.fn.appendUl=function(e){return this.appendElement("<ul>",e)},s.a.fn.appendLi=function(e,t){return this.appendElement("<li>",e,t)},s.a.extend(s.a.easing,{easeOutQuart:function(e){return 1-Math.pow(1-e,4)}}),s.a.ajaxTransport("+binary",(function(e,t,n){if(window.FormData&&(e.dataType&&"binary"===e.dataType||e.data&&(window.ArrayBuffer&&e.data instanceof ArrayBuffer||window.Blob&&e.data instanceof Blob)))return{send:function(t,n){var r=new XMLHttpRequest,o=e.url,i=e.type,s=e.async||!0,a=e.responseType||"blob",l=e.data||null,u=e.username||null,c=e.password||null;for(var f in r.addEventListener("load",(function(){var t={};t[e.dataType]=r.response,n(r.status,r.statusText,t,r.getAllResponseHeaders())})),r.open(i,o,s,u,c),t)r.setRequestHeader(f,t[f]);if(e.xhrFields)for(var h in e.xhrFields)r[h]=e.xhrFields[h];r.responseType=a,r.send(l)},abort:function(){}}})),window.$!==s.a&&(window.$=s.a),s.a.extend(s.a.expr[":"],{focusable:function(e){return yge(e,!isNaN(s.a.attr(e,"tabindex")))},tabbable:function(e){var t=s.a.attr(e,"tabindex"),n=isNaN(t);return(n||t>=0)&&yge(e,!n)}});var _ge=t.default=o,wge=mge(mge({},o),r);window.scout=vge(window.scout||{},wge)}]);
//# sourceMappingURL=eclipse-scout-core-2cd3cdf9005883c97db3.min.js.map